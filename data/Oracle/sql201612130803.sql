CREATE OR REPLACE PROCEDURE Doc_SecCategory_Insert_New
  (  subcategoryid   integer,
     categoryname_2   varchar2,
     docmouldid   integer,
     publishable   char,
     replyable   char,
     shareable   char ,
     cusertype   integer,
     cuserseclevel   smallint,
     cdepartmentid1   integer,
     cdepseclevel1   smallint,
     cdepartmentid2   integer,
     cdepseclevel2   smallint,
     croleid1       integer,
     crolelevel1     char ,
     croleid2     integer,
     crolelevel2   char ,
     croleid3     integer,
     crolelevel3   char ,
     hasaccessory     char ,
     accessorynum     smallint,
     hasasset       char ,
     assetlabel     varchar2 ,
     hasitems     char ,
     itemlabel   varchar2 ,
     hashrmres   char ,
     hrmreslabel   varchar2 ,
     hascrm     char ,
     crmlabel     varchar2 ,
     hasproject   char ,
     projectlabel   varchar2 ,
     hasfinance   char ,
     financelabel   varchar2 ,
     approveworkflowid  integer,
     markable  char ,
     markAnonymity char ,
     orderable char ,
     defaultLockedDoc integer,
     allownModiMShareL integer,
     allownModiMShareW integer,
     maxUploadFileSize integer,
     wordmouldid integer,
     isSetShare integer,
     noDownload integer,
     noRepeatedName integer,
     isControledByDir integer,
     pubOperation integer,
     childDocReadRemind integer,
     readOpterCanPrint integer,
     isLogControl char ,
     subcompanyId integer,
     level_1 integer,
     parentid integer,
     secorder float,
     flag   out integer,
     msg  out varchar2,
     thecursor IN OUT cursor_define.weavercursor) as
 dirid integer;
 dirtype integer;
 begin
  

  insert into docseccategory(
    subcategoryid,
    categoryname,
    docmouldid,
    publishable,
    replyable,
    shareable,
    cusertype,
    cuserseclevel,
    cdepartmentid1,
    cdepseclevel1,
    cdepartmentid2,
    cdepseclevel2,
    croleid1,
    crolelevel1,
    croleid2,
    crolelevel2,
    croleid3,
    crolelevel3,
    hasaccessory,
    accessorynum,
    hasasset,
    assetlabel,
    hasitems,
    itemlabel,
    hashrmres,
    hrmreslabel,
    hascrm,
    crmlabel,
    hasproject,
    projectlabel,
    hasfinance,
    financelabel,
    approveworkflowid,
    markable,
    markAnonymity,
    orderable,
    defaultLockedDoc,
    allownModiMShareL,
    allownModiMShareW,
    maxUploadFileSize,
    wordmouldid,
    isSetShare,
    nodownload,
    norepeatedname,
    iscontroledbydir,
    puboperation,
    childdocreadremind,
    readoptercanprint,
    isLogControl,
    subcompanyId,
    parentid,
    dirid,
    dirType
    )
  values(
     subcategoryid,
     categoryname_2,
     docmouldid,
     publishable,
     replyable,
     shareable,
     cusertype,
     cuserseclevel,
     cdepartmentid1,
     cdepseclevel1,
     cdepartmentid2,
     cdepseclevel2,
     croleid1,
     crolelevel1,
     croleid2,
     crolelevel2,
     croleid3,
     crolelevel3,
     hasaccessory,
     accessorynum,
     hasasset,
     assetlabel,
     hasitems,
     itemlabel,
     hashrmres,
     hrmreslabel,
     hascrm,
     crmlabel,
     hasproject,
     projectlabel,
     hasfinance,
     financelabel,
     approveworkflowid,
     markable,
     markAnonymity,
     orderable,
     defaultLockedDoc,
     allownModiMShareL,
     allownModiMShareW,
     maxUploadFileSize,
     wordmouldid,
     isSetShare,
     noDownload,
     noRepeatedName,
     isControledByDir,
     pubOperation,
     childDocReadRemind,
     readOpterCanPrint,
     isLogControl,
     subcompanyId,
     parentid,
     dirid,
     dirtype
    ) ;
  open thecursor for
  select max(id) from docseccategory where categoryname =  categoryname_2;

  end;
/