UPDATE hrm_formfield SET type=2 WHERE fieldid IN (47,48,49,50)
GO
ALTER table HrmUserDefine
ADD hasvirtualdepartment CHAR(1) 
GO
ALTER PROCEDURE HrmUserDefine_Insert
    (
      @userid_1 [int] ,
      @hasresourceid_2 [char](1) ,
      @hasresourcename_3 [char](1) ,
      @hasjobtitle_4 [char](1) ,
      @hasactivitydesc_5 [char](1) ,
      @hasjobgroup_6 [char](1) ,
      @hasjobactivity_7 [char](1) ,
      @hascostcenter_8 [char](1) ,
      @hascompetency_9 [char](1) ,
      @hasresourcetype_10 [char](1) ,
      @hasstatus_11 [char](1) ,
      @hassubcompany_12 [char](1) ,
      @hasdepartment_13 [char](1) ,
      @haslocation_14 [char](1) ,
      @hasmanager_15 [char](1) ,
      @hasassistant_16 [char](1) ,
      @hasroles_17 [char](1) ,
      @hasseclevel_18 [char](1) ,
      @hasjoblevel_19 [char](1) ,
      @hasworkroom_20 [char](1) ,
      @hastelephone_21 [char](1) ,
      @hasstartdate_22 [char](1) ,
      @hasenddate_23 [char](1) ,
      @hascontractdate_24 [char](1) ,
      @hasbirthday_25 [char](1) ,
      @hassex_26 [char](1) ,
      @projectable_27 [char](1) ,
      @crmable_28 [char](1) ,
      @itemable_29 [char](1) ,
      @docable_30 [char](1) ,
      @workflowable_31 [char](1) ,
      @subordinateable_32 [char](1) ,
      @trainable_33 [char](1) ,
      @budgetable_34 [char](1) ,
      @fnatranable_35 [char](1) ,
      @dspperpage_36 [tinyint] ,
      @hasage_37 [char](1) ,
      @hasworkcode_38 [char](1) ,
      @hasjobcall_39 [char](1) ,
      @hasmobile_40 [char](1) ,
      @hasmobilecall_41 [char](1) ,
      @hasfax_42 [char](1) ,
      @hasemail_43 [char](1) ,
      @hasfolk_44 [char](1) ,
      @hasregresidentplace_45 [char](1) ,
      @hasnativeplace_46 [char](1) ,
      @hascertificatenum_47 [char](1) ,
      @hasmaritalstatus_48 [char](1) ,
      @haspolicy_49 [char](1) ,
      @hasbememberdate_50 [char](1) ,
      @hasbepartydate_51 [char](1) ,
      @hasislabouunion_52 [char](1) ,
      @haseducationlevel_53 [char](1) ,
      @hasdegree_54 [char](1) ,
      @hashealthinfo_55 [char](1) ,
      @hasheight_56 [char](1) ,
      @hasweight_57 [char](1) ,
      @hasresidentplace_58 [char](1) ,
      @hashomeaddress_59 [char](1) ,
      @hastempresidentnumber_60 [char](1) ,
      @hasusekind_61 [char](1) ,
      @hasbankid1_62 [char](1) ,
      @hasaccountid1_63 [char](1) ,
      @hasaccumfundaccount_64 [char](1) ,
      @hasloginid_65 [char](1) ,
      @hassystemlanguage_66 [char](1) ,
      @hasaccounttype_67 [char](1) ,
      @workplanable_68 [char](1) ,
      @hasvirtualdepartment_69 [char](1) ,
      @flag INTEGER OUTPUT ,
      @msg VARCHAR(80) OUTPUT 
    )
AS 
    DECLARE @recordercount INTEGER
    SELECT  @recordercount = COUNT(userid)
    FROM    HrmUserDefine
    WHERE   userid = CONVERT(INT, @userid_1)
    IF @recordercount = 0 
        BEGIN
            INSERT  INTO [HrmUserDefine]
                    ( [userid] ,
                      [hasresourceid] ,
                      [hasresourcename] ,
                      [hasjobtitle] ,
                      [hasactivitydesc] ,
                      [hasjobgroup] ,
                      [hasjobactivity] ,
                      [hascostcenter] ,
                      [hascompetency] ,
                      [hasresourcetype] ,
                      [hasstatus] ,
                      [hassubcompany] ,
                      [hasdepartment] ,
                      [haslocation] ,
                      [hasmanager] ,
                      [hasassistant] ,
                      [hasroles] ,
                      [hasseclevel] ,
                      [hasjoblevel] ,
                      [hasworkroom] ,
                      [hastelephone] ,
                      [hasstartdate] ,
                      [hasenddate] ,
                      [hascontractdate] ,
                      [hasbirthday] ,
                      [hassex] ,
                      [projectable] ,
                      [crmable] ,
                      [itemable] ,
                      [docable] ,
                      [workflowable] ,
                      [subordinateable] ,
                      [trainable] ,
                      [budgetable] ,
                      [fnatranable] ,
                      [dspperpage] ,
                      [hasage] ,
                      [hasworkcode] ,
                      [hasjobcall] ,
                      [hasmobile] ,
                      [hasmobilecall] ,
                      [hasfax] ,
                      [hasemail] ,
                      [hasfolk] ,
                      [hasregresidentplace] ,
                      [hasnativeplace] ,
                      [hascertificatenum] ,
                      [hasmaritalstatus] ,
                      [haspolicy] ,
                      [hasbememberdate] ,
                      [hasbepartydate] ,
                      [hasislabouunion] ,
                      [haseducationlevel] ,
                      [hasdegree] ,
                      [hashealthinfo] ,
                      [hasheight] ,
                      [hasweight] ,
                      [hasresidentplace] ,
                      [hashomeaddress] ,
                      [hastempresidentnumber] ,
                      [hasusekind] ,
                      [hasbankid1] ,
                      [hasaccountid1] ,
                      [hasaccumfundaccount] ,
                      [hasloginid] ,
                      [hassystemlanguage] ,
                      [hasaccounttype] ,
                      [workplanable],
                      [hasvirtualdepartment]
                    )
            VALUES  ( @userid_1 ,
                      @hasresourceid_2 ,
                      @hasresourcename_3 ,
                      @hasjobtitle_4 ,
                      @hasactivitydesc_5 ,
                      @hasjobgroup_6 ,
                      @hasjobactivity_7 ,
                      @hascostcenter_8 ,
                      @hascompetency_9 ,
                      @hasresourcetype_10 ,
                      @hasstatus_11 ,
                      @hassubcompany_12 ,
                      @hasdepartment_13 ,
                      @haslocation_14 ,
                      @hasmanager_15 ,
                      @hasassistant_16 ,
                      @hasroles_17 ,
                      @hasseclevel_18 ,
                      @hasjoblevel_19 ,
                      @hasworkroom_20 ,
                      @hastelephone_21 ,
                      @hasstartdate_22 ,
                      @hasenddate_23 ,
                      @hascontractdate_24 ,
                      @hasbirthday_25 ,
                      @hassex_26 ,
                      @projectable_27 ,
                      @crmable_28 ,
                      @itemable_29 ,
                      @docable_30 ,
                      @workflowable_31 ,
                      @subordinateable_32 ,
                      @trainable_33 ,
                      @budgetable_34 ,
                      @fnatranable_35 ,
                      @dspperpage_36 ,
                      @hasage_37 ,
                      @hasworkcode_38 ,
                      @hasjobcall_39 ,
                      @hasmobile_40 ,
                      @hasmobilecall_41 ,
                      @hasfax_42 ,
                      @hasemail_43 ,
                      @hasfolk_44 ,
                      @hasregresidentplace_45 ,
                      @hasnativeplace_46 ,
                      @hascertificatenum_47 ,
                      @hasmaritalstatus_48 ,
                      @haspolicy_49 ,
                      @hasbememberdate_50 ,
                      @hasbepartydate_51 ,
                      @hasislabouunion_52 ,
                      @haseducationlevel_53 ,
                      @hasdegree_54 ,
                      @hashealthinfo_55 ,
                      @hasheight_56 ,
                      @hasweight_57 ,
                      @hasresidentplace_58 ,
                      @hashomeaddress_59 ,
                      @hastempresidentnumber_60 ,
                      @hasusekind_61 ,
                      @hasbankid1_62 ,
                      @hasaccountid1_63 ,
                      @hasaccumfundaccount_64 ,
                      @hasloginid_65 ,
                      @hassystemlanguage_66 ,
                      @hasaccounttype_67 ,
                      @workplanable_68,
                      @hasvirtualdepartment_69
                    )
        END
    ELSE 
        BEGIN
            UPDATE  [HrmUserDefine]
            SET     [hasresourceid] = @hasresourceid_2 ,
                    [hasresourcename] = @hasresourcename_3 ,
                    [hasjobtitle] = @hasjobtitle_4 ,
                    [hasactivitydesc] = @hasactivitydesc_5 ,
                    [hasjobgroup] = @hasjobgroup_6 ,
                    [hasjobactivity] = @hasjobactivity_7 ,
                    [hascostcenter] = @hascostcenter_8 ,
                    [hascompetency] = @hascompetency_9 ,
                    [hasresourcetype] = @hasresourcetype_10 ,
                    [hasstatus] = @hasstatus_11 ,
                    [hassubcompany] = @hassubcompany_12 ,
                    [hasdepartment] = @hasdepartment_13 ,
                    [haslocation] = @haslocation_14 ,
                    [hasmanager] = @hasmanager_15 ,
                    [hasassistant] = @hasassistant_16 ,
                    [hasroles] = @hasroles_17 ,
                    [hasseclevel] = @hasseclevel_18 ,
                    [hasjoblevel] = @hasjoblevel_19 ,
                    [hasworkroom] = @hasworkroom_20 ,
                    [hastelephone] = @hastelephone_21 ,
                    [hasstartdate] = @hasstartdate_22 ,
                    [hasenddate] = @hasenddate_23 ,
                    [hascontractdate] = @hascontractdate_24 ,
                    [hasbirthday] = @hasbirthday_25 ,
                    [hassex] = @hassex_26 ,
                    [projectable] = @projectable_27 ,
                    [crmable] = @crmable_28 ,
                    [itemable] = @itemable_29 ,
                    [docable] = @docable_30 ,
                    [workflowable] = @workflowable_31 ,
                    [subordinateable] = @subordinateable_32 ,
                    [trainable] = @trainable_33 ,
                    [budgetable] = @budgetable_34 ,
                    [fnatranable] = @fnatranable_35 ,
                    [dspperpage] = @dspperpage_36 ,
                    [hasage] = @hasage_37 ,
                    [hasworkcode] = @hasworkcode_38 ,
                    [hasjobcall] = @hasjobcall_39 ,
                    [hasmobile] = @hasmobile_40 ,
                    [hasmobilecall] = @hasmobilecall_41 ,
                    [hasfax] = @hasfax_42 ,
                    [hasemail] = @hasemail_43 ,
                    [hasfolk] = @hasfolk_44 ,
                    [hasregresidentplace] = @hasregresidentplace_45 ,
                    [hasnativeplace] = @hasnativeplace_46 ,
                    [hascertificatenum] = @hascertificatenum_47 ,
                    [hasmaritalstatus] = @hasmaritalstatus_48 ,
                    [haspolicy] = @haspolicy_49 ,
                    [hasbememberdate] = @hasbememberdate_50 ,
                    [hasbepartydate] = @hasbepartydate_51 ,
                    [hasislabouunion] = @hasislabouunion_52 ,
                    [haseducationlevel] = @haseducationlevel_53 ,
                    [hasdegree] = @hasdegree_54 ,
                    [hashealthinfo] = @hashealthinfo_55 ,
                    [hasheight] = @hasheight_56 ,
                    [hasweight] = @hasweight_57 ,
                    [hasresidentplace] = @hasresidentplace_58 ,
                    [hashomeaddress] = @hashomeaddress_59 ,
                    [hastempresidentnumber] = @hastempresidentnumber_60 ,
                    [hasusekind] = @hasusekind_61 ,
                    [hasbankid1] = @hasbankid1_62 ,
                    [hasaccountid1] = @hasaccountid1_63 ,
                    [hasaccumfundaccount] = @hasaccumfundaccount_64 ,
                    [hasloginid] = @hasloginid_65 ,
                    [hassystemlanguage] = @hassystemlanguage_66 ,
                    [hasaccounttype] = @hasaccounttype_67 ,
                    [workplanable] = @workplanable_68,
                    [hasvirtualdepartment] = @hasvirtualdepartment_69
            WHERE   ( [userid] = @userid_1 )
        END
    IF @@error <> 0 
        BEGIN
            SET @flag = 1
            SET @msg = '插入储存过程失败'
            RETURN
        END
    ELSE 
        BEGIN
            SET @flag = 0
            SET @msg = '插入储存过程成功'
            RETURN
        END 
GO
