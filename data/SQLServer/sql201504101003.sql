ALTER procedure [WorkPlan_InsertPlus] ( @type_n_1 int, @name_1 varchar(4000), @resourceid_1 varchar(4000), @begindate_1 char(10), @begintime_1 char(8), @enddate_1 char(10), @endtime_1 char(8), @description_1 text, @requestid_1 varchar(4000), @projectid_1 varchar(4000), @crmid_1 varchar(4000), @docid_1 varchar(4000), @meetingid_1 varchar(4000), @isremind_1 int, @waketime_1 int, @createrid_1 int, @createrType_1 char(1), @createdate_1 char(10), @createtime_1 char(8), @taskid_1 varchar(4000), @urgentLevel_1 char(1), @status_1 char(1), @relatedprj_1	varchar(4000), @relatedcus_1	varchar(4000), @relatedwf_1	varchar(4000), @relateddoc_1	varchar(4000),  @remindType_1 CHAR(1), @remindBeforeStart_1 CHAR(1), @remindBeforeEnd_1 CHAR(1), @remindTimesBeforeStart_1 int, @remindTimesBeforeEnd_1 int, @remindDateBeforeStart_1 CHAR(10), @remindTimeBeforeStart_1 CHAR(8), @remindDateBeforeEnd_1 CHAR(10), @remindTimeBeforeEnd_1 CHAR(8), @hrmPerformanceCheckDetailID_1 int,  @flag integer output, @msg varchar(4000) output ) AS INSERT INTO WorkPlan ( type_n, name, resourceid, begindate, begintime, enddate, endtime, description, requestid, projectid, crmid, docid, meetingid, status, isremind, waketime, createrid, createdate, createtime, deleted, taskid, urgentLevel, createrType, relatedprj, relatedcus, relatedwf, relateddoc,  remindType, remindBeforeStart, remindBeforeEnd, remindTimesBeforeStart, remindTimesBeforeEnd, remindDateBeforeStart, remindTimeBeforeStart, remindDateBeforeEnd, remindTimeBeforeEnd, hrmPerformanceCheckDetailID ) VALUES ( @type_n_1, @name_1, @resourceid_1, @begindate_1, @begintime_1, @enddate_1, @endtime_1, @description_1, @requestid_1, @projectid_1, @crmid_1, @docid_1, @meetingid_1, @status_1, @isremind_1, @waketime_1, @createrid_1, @createdate_1, @createtime_1, '0', @taskid_1, @urgentLevel_1, @createrType_1, @relatedprj_1, @relatedcus_1, @relatedwf_1, @relateddoc_1, @remindType_1, @remindBeforeStart_1, @remindBeforeEnd_1, @remindTimesBeforeStart_1, @remindTimesBeforeEnd_1, @remindDateBeforeStart_1, @remindTimeBeforeStart_1, @remindDateBeforeEnd_1, @remindTimeBeforeEnd_1, @hrmPerformanceCheckDetailID_1 ) DECLARE @m_id int DECLARE @m_deptId int DECLARE @m_subcoId int   SELECT @m_id = MAX(id) FROM WorkPlan where createrid = @createrid_1 SELECT @m_deptId = departmentid, @m_subcoId = subcompanyid1 FROM HrmResource WHERE id = @createrid_1 UPDATE WorkPlan SET deptId = @m_deptId, subcompanyId = @m_subcoId where id = @m_id SELECT @m_id AS id 
 go