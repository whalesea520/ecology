alter procedure [AlbumPhotos_U_Size]( @subcompanyId int ) as declare @albumSize int declare @albumSizeUsed int select @albumSize=albumSize from AlbumSubcompany where subcompanyId=@subcompanyId select @albumSizeUsed=SUM(photoSize) from AlbumPhotos where subcompanyId=@subcompanyId if @albumSizeUsed>@albumSize begin update AlbumSubcompany set albumSizeUsed=@albumSize WHERE subcompanyId=@subcompanyId end else begin update AlbumSubcompany set albumSizeUsed=@albumSizeUsed WHERE subcompanyId=@subcompanyId end

GO
alter procedure [AlbumPhotos_SelectAll]( @flag int output, @msg varchar(4000) output ) AS SELECT * FROM AlbumPhotos ORDER BY orderNum DESC SET @flag = 1 SET @msg = 'OK!'

GO
alter procedure [Meeting_Member2_Update] (@id [int] , @isattend varchar(4000) ,	@begindate varchar(4000)  , @begintime varchar(4000)  , @enddate varchar(4000)  ,	@endtime varchar(4000)  ,	@bookroom varchar(4000) ,	@roomstander varchar(4000) , @bookticket varchar(4000) ,	@ticketstander varchar(4000) ,	@othermember varchar(4000) , @flag integer output, @msg varchar(4000) output) AS Update [Meeting_Member2] set  [isattend]=@isattend , [begindate]=@begindate , [begintime]=@begintime , [enddate]=@enddate, [endtime]=@endtime , [bookroom]=@bookroom ,[roomstander]=@roomstander , [bookticket]=@bookticket , [ticketstander]=@ticketstander  , [othermember]=@othermember where id = @id set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Member2_SelectByType] (@meetingId int, @memberType int, @flag	int output, @msg varchar(4000) output) AS SELECT * FROM Meeting_Member2 WHERE meetingId = @meetingId AND memberType = @memberType ORDER BY id ASC SET @flag = 1 SET @msg = 'OK!'

GO
alter procedure [Meeting_Member2_SelectByID] ( @id [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Meeting_Member2] where id = @id set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Member2_Insert] (@meetingid [int] , @membertype [tinyint] ,	@memberid [int],	@membermanager [int] , @flag integer output, @msg varchar(4000) output) AS INSERT INTO [Meeting_Member2] ( [meetingid] ,[membertype] ,[memberid] ,[membermanager])  VALUES ( @meetingid , @membertype, @memberid, @membermanager) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Member2_Delete] (@meetingid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting_Member2] WHERE ( meetingid = @meetingid ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_UpdateDecision] (@meetingid [int] , @isdecision [int],  @decision [text], @decisiondocid [int], @decisiondate varchar(4000)  , @decisiontime varchar(4000) , @decisionhrmid [int] , @flag integer output, @msg varchar(4000) output) AS Update [Meeting] set [isdecision]=@isdecision, [decision]=@decision, decisiondocid=@decisiondocid, [decisiondate]=@decisiondate, [decisiontime]=@decisiontime, decisionhrmid=@decisionhrmid where id = @meetingid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Update] ( @meetingid [int] , @name varchar(4000) , @caller [int] , @contacter [int] , @projectid [int], @address [int] , @begindate varchar(4000)  , @begintime varchar(4000)  , @enddate varchar(4000)  , @endtime varchar(4000)  , @desc_n varchar(4000)  , @totalmember   int, @othermembers   text, @addressdesc   varchar(4000), @description text, @remindType int, @remindBeforeStart int, @remindBeforeEnd int, @remindTimesBeforeStart int, @remindTimesBeforeEnd int, @customizeAddress   varchar(4000), @flag integer output, @msg varchar(4000) output ) AS Update [Meeting] set [name]=@name , [caller]=@caller , [contacter]=@contacter , [projectid]=@projectid, [address]=@address , [begindate]=@begindate , [begintime]=@begintime , [enddate]=@enddate , [endtime]=@endtime , [desc_n]=@desc_n, totalmember=@totalmember, othermembers=@othermembers, addressdesc=@addressdesc, description=@description, remindType=@remindType, remindBeforeStart=@remindBeforeStart, remindBeforeEnd=@remindBeforeEnd, remindTimesBeforeStart=@remindTimesBeforeStart, remindTimesBeforeEnd=@remindTimesBeforeEnd, customizeAddress = @customizeAddress where id = @meetingid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Submit] (@meetingid [int] , @flag integer output, @msg varchar(4000) output) AS Update [Meeting] set [isapproved]='1' where id = @meetingid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_SelectMaxID] (  @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT max(id) FROM [Meeting] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_SelectByID] ( @meetingid [int] , @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Meeting] where id = @meetingid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Schedule] (@meetingid [int] , @flag integer output, @msg varchar(4000) output) AS Update [Meeting] set [isapproved]='3' where id = @meetingid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Insert] ( @meetingtype [int] , @name varchar(4000) , @caller [int] , @contacter [int] , @projectid[int], @address [int] , @begindate varchar(4000), @begintime varchar(4000), @enddate varchar(4000), @endtime varchar(4000), @desc_n varchar(4000), @creater [int], @createdate varchar(4000), @createtime varchar(4000) , @totalmember   int, @othermembers   text, @addressdesc   varchar(4000), @description text, @remindType int, @remindBeforeStart int, @remindBeforeEnd int, @remindTimesBeforeStart int, @remindTimesBeforeEnd int, @customizeAddress   varchar(4000), @flag integer output, @msg varchar(4000) output) AS INSERT INTO [Meeting] ( [meetingtype] , [name] , [caller] , [contacter] , [projectid], [address] , [begindate]  , [begintime] , [enddate] , [endtime] , [desc_n], [creater] , [createdate] , [createtime], totalmember, othermembers, addressdesc, description, remindType, remindBeforeStart, remindBeforeEnd, remindTimesBeforeStart, remindTimesBeforeEnd, customizeAddress ) VALUES ( @meetingtype , @name, @caller, @contacter, @projectid, @address , @begindate , @begintime , @enddate , @endtime , @desc_n , @creater , @createdate , @createtime, @totalmember, @othermembers, @addressdesc, @description, @remindType, @remindBeforeStart, @remindBeforeEnd, @remindTimesBeforeStart, @remindTimesBeforeEnd, @customizeAddress ) select IDENT_CURRENT('Meeting') set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting] WHERE ( id = @id ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Approve] (@meetingid [int] , @approver [int] , @approvedate varchar(4000)  ,@approvetime varchar(4000)  , @flag integer output, @msg varchar(4000) output) AS Update [Meeting] set [isapproved]='2', [approver]=@approver, [approvedate]=@approvedate, [approvetime]=@approvetime where id = @meetingid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [MostSpendTime_Get] @sqlStr_1	varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output AS exec ('select * from SpendTimeStat where 1=1  '+@sqlStr_1+' ')

GO
alter procedure [MostSpendFlowStat_count]  @sqlStr_1	varchar(4000), @sqlStr_2	varchar(4000), @num     int, @flag 		integer 	output , @msg 		varchar(4000) 	output AS  BEGIN  exec ('select count(*)  from (select top '+@num+' * from (select requestname,workflow_requestbase.requestid,workflow_requestbase.workflowid, (24*(convert(float,convert(datetime,isnull(lastoperatedate ,convert(char(10),getdate(),20)) +'' ''+isnull(lastoperatetime,convert(char(10),getdate(),108))))-convert(float,convert(datetime,createdate+'' ''+createtime))) - (select sum(isnull(convert(float,nodepasshour),0)+isnull(convert(float,nodepassminute),0)/24) from workflow_nodelink where workflowid=workflow_requestbase.workflowid)) as spends from workflow_requestbase where  (24*(convert(float,convert(datetime,isnull(lastoperatedate ,convert(char(10),getdate(),20)) +'' ''+isnull(lastoperatetime,convert(char(10),getdate(),108))))-convert(float,convert(datetime,createdate+'' ''+createtime))) - (select sum(isnull(convert(float,nodepasshour),0)+isnull(convert(float,nodepassminute),0)/24) from workflow_nodelink where workflowid=workflow_requestbase.workflowid))>0 and exists (select 1 from workflow_currentoperator where requestid=workflow_requestbase.requestid '+@sqlStr_1+') and status is not null and status!=''''  and exists (select 1 from workflow_nodelink where workflowid=workflow_requestbase.workflowid and (convert(float,nodepasshour)>0 or convert(float,nodepassminute)>0)) '+@sqlStr_2+' ) as temp order by spends desc ) as t ') end

GO
alter procedure [MostExceedPerson_Get] @sqlStr_1	varchar(4000), @flag 		integer 	output, @msg 		varchar(4000) output AS exec (' select top  100 percent userid as userid,count(distinct workflow_requestbase.requestid) as counts, (select count(requestid) from workflow_requestbase b where exists (select 1 from workflow_currentoperator  a where a.requestid=b.requestid and a.userid=workflow_currentoperator.userid ) and b.status is not null and b.status!='''' ) as countall,  convert(float,count(distinct workflow_requestbase.requestid)*100)/convert(float,(select count(requestid) from workflow_requestbase b where exists (select 1 from workflow_currentoperator  a where a.requestid=b.requestid and a.userid=workflow_currentoperator.userid ) and b.status is not null and b.status!='''' ) ) as percents  from workflow_currentoperator,workflow_requestbase where  workflow_currentoperator.requestid=workflow_requestbase.requestid and (workflow_currentoperator.isprocessed = ''2'' or workflow_currentoperator.isprocessed = ''3'') and workflow_requestbase.status is not null and workflow_requestbase.status!='''' and exists (select 1 from workflow_nodelink where workflowid=workflow_requestbase.workflowid and (workflow_currentoperator.usertype = 0) and exists (select 1 from hrmresource where hrmresource.id=workflow_currentoperator.userid and hrmresource.status in (0,1,2,3)) and (convert(float,nodepasshour)>0 or convert(float,nodepassminute)>0)) and isremark<>4 '+@sqlStr_1+' group by userid order by percents desc,userid desc')

GO
alter procedure [MostExceedFlow_Get] @sqlStr_1	varchar(4000), @sqlStr_2	varchar(4000), @pagenum   int , @prepage  int, @count  int, @flag 		integer 	output , @msg 		varchar(4000) 	output AS DECLARE @num int, @countss int set @num=@pagenum*@prepage set @countss=@count-(@pagenum-1)*@prepage-1 if @pagenum=1 exec (' select top '+@prepage+' * from ( select requestname,workflow_requestbase.requestid,workflow_requestbase.workflowid, (24*(convert(float, convert(datetime, case lastoperatedate when '' '' then convert(char(10),getdate(),20) when null then convert(char(10),getdate(),20) else lastoperatedate end + '' '' + isnull(lastoperatetime,convert(char(10), getdate(),108)) )) -convert(float,convert(datetime,createdate+'' ''+createtime))) - (select sum(isnull(convert(float,nodepasshour),0)+isnull(convert(float,nodepassminute),0)/24) from workflow_nodelink where workflowid=workflow_requestbase.workflowid)) as spends from workflow_requestbase where (24*(convert(float, convert(datetime, case lastoperatedate when '' '' then convert(char(10),getdate(),20) when null then convert(char(10),getdate(),20) else lastoperatedate end + '' '' + isnull(lastoperatetime,convert(char(10), getdate(),108)) )) -convert(float,convert(datetime,createdate+'' ''+createtime))) - (select sum(isnull(convert(float,nodepasshour),0)+isnull(convert(float,nodepassminute),0)/24) from workflow_nodelink where workflowid=workflow_requestbase.workflowid))>0 and exists (select 1 from workflow_currentoperator where requestid=workflow_requestbase.requestid '+@sqlStr_1+') and status is not null and status!='''' and exists (select 1 from workflow_nodelink where workflowid=workflow_requestbase.workflowid and (convert(float,nodepasshour)>0 or convert(float,nodepassminute)>0)) '+@sqlStr_2+') as t  order by spends desc') else exec (' select * from (select top '+@countss+' * from ( select top '+@num+' * from ( select requestname,workflow_requestbase.requestid,workflow_requestbase.workflowid, (24*(convert(float, convert(datetime, case lastoperatedate when '' '' then convert(char(10),getdate(),20) when null then convert(char(10),getdate(),20) else lastoperatedate end + '' '' + isnull(lastoperatetime,convert(char(10), getdate(),108)) )) - convert(float,convert(datetime,createdate+'' ''+createtime))) - (select sum(isnull(convert(float,nodepasshour),0)+isnull(convert(float,nodepassminute),0)/24) from workflow_nodelink where workflowid=workflow_requestbase.workflowid)) as spends from workflow_requestbase where (24*(convert(float, convert(datetime, case lastoperatedate when '' '' then convert(char(10),getdate(),20) when null then convert(char(10),getdate(),20) else lastoperatedate end + '' '' + isnull(lastoperatetime,convert(char(10), getdate(),108)) )) -convert(float,convert(datetime,createdate+'' ''+createtime))) - (select sum(isnull(convert(float,nodepasshour),0)+isnull(convert(float,nodepassminute),0)/24) from workflow_nodelink where workflowid=workflow_requestbase.workflowid))>0 and exists (select 1 from workflow_currentoperator where requestid=workflow_requestbase.requestid '+@sqlStr_1+') and status is not null and status!='''' and exists (select 1 from workflow_nodelink where workflowid=workflow_requestbase.workflowid and (convert(float,nodepasshour)>0 or convert(float,nodepassminute)>0)) '+@sqlStr_2+') as t  order by spends desc) as tt order by spends) as temp order by spends desc')

GO
alter procedure [NewDocFrontpage_SelectMAllNId] ( @pagenumber     int, @perpage        int, @countnumber    int, @logintype		int, @usertype		int, @userid			int, @userseclevel	int, @flag integer output, @msg varchar(4000) output) as declare @pagecount int declare @pagecount2 int set @pagecount =  @pagenumber*@perpage if (@countnumber-(@pagenumber-1)*@perpage)<@perpage set @pagecount2 =@countnumber-(@pagenumber-1)*@perpage else set @pagecount2 =@perpage  if @logintype=1 begin exec ('Select distinct top ' + @pagecount+ ' c.id , c.docsubject , c.doccreatedate , c.doccreatetime into #temp from NewDocFrontpage n , DocShareDetail d , docdetail c where n.docid=d.docid and n.docid=c.id and n.userid=d.userid and  d.usertype=1 and n.userid='+@userid+' and (c.docpublishtype=''2'' or c.docpublishtype=''3'') and c.docstatus in(''1'',''2'',''5'') and maincategory=''5'' order by c.doccreatedate  desc , c.doccreatetime desc ;'+ 'select top '+@pagecount2+'* from #temp order by doccreatedate, doccreatetime') end if @logintype<>1 begin exec ('Select distinct top '+@pagecount+' c.id , c.docsubject , c.doccreatedate , c.doccreatetime into #temp from NewDocFrontpage n , DocShareDetail d  , docdetail c where  n.docid=d.docid and n.docid= c.id and  n.usertype = d.usertype and n.usertype='+@usertype+' and d.userid<='+@userseclevel+' and ( c.docpublishtype=''2'' or c.docpublishtype=''3'') and c.docstatus in(''1'',''2'',''5'') and maincategory=''5'' order by c.doccreatedate desc , c.doccreatetime desc ;'+ 'select top '+@pagecount2+' * from #temp order by doccreatedate, doccreatetime')  end

GO
alter procedure [NewDocFrontpage_SelectAllNId] ( @pagenumber     int, @perpage        int, @countnumber    int, @logintype		int, @usertype		int, @userid			int, @userseclevel	int, @flag integer output, @msg varchar(4000) output) as declare @pagecount int declare @pagecount2 int set @pagecount =  @pagenumber*@perpage if (@countnumber-(@pagenumber-1)*@perpage)<@perpage set @pagecount2 =@countnumber-(@pagenumber-1)*@perpage else set @pagecount2 =@perpage  if @logintype=1 begin exec ('Select distinct top ' + @pagecount+ ' c.id , c.docsubject , c.doccreatedate , c.doccreatetime into #temp from NewDocFrontpage n , DocShareDetail d , docdetail c where n.docid=d.docid and n.docid=c.id and n.userid=d.userid and  d.usertype=1 and n.userid='+@userid+' and (c.docpublishtype=''2'' or c.docpublishtype=''3'') and c.docstatus in(''1'',''2'',''5'') order by c.doccreatedate  desc , c.doccreatetime desc ;'+ 'select top '+@pagecount2+'* from #temp order by doccreatedate, doccreatetime') end if @logintype<>1 begin exec ('Select distinct top '+@pagecount+' c.id , c.docsubject , c.doccreatedate , c.doccreatetime into #temp from NewDocFrontpage n , DocShareDetail d  , docdetail c where  n.docid=d.docid and n.docid= c.id and  n.usertype = d.usertype and n.usertype='+@usertype+' and d.userid<='+@userseclevel+' and ( c.docpublishtype=''2'' or c.docpublishtype=''3'') and c.docstatus in(''1'',''2'',''5'') order by c.doccreatedate desc , c.doccreatetime desc ;'+ 'select top '+@pagecount2+' * from #temp order by doccreatedate, doccreatetime') end

GO
alter procedure [HrmSalaryResult_delete] (@yearmonth_1 varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS delete HrmSalaryResult  WHERE ( yearmonth	 = @yearmonth_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryResult_Update] ( @id_1           int, @salary_1  	  decimal (12,2) , @flag	int	output, @msg	varchar(4000)	output ) AS UPDATE HrmSalaryResult SET  	 salary=@salary_1  WHERE ( id	 = @id_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryResult_send] (@yearmonth_1 varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS UPDATE HrmSalaryResult SET  	 isvalidate=1  WHERE ( yearmonth	 = @yearmonth_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryResult_SByid] (@id_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryResult WHERE id=@id_1 set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryResult_SByHrmid] (@hrmid_1 int, @yearmonth_1 varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryResult WHERE hrmid=@hrmid_1 AND yearmonth=@yearmonth_1 order by itemid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [bill_CptPlanMain_Select] (@id 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptPlanMain] WHERE ( [id]	 = @id)

GO
alter procedure [bill_CptPlanDetail_Update] (@id_1 	[int], @cptplanid_2 	[int], @cptid_3 	[int], @number_4 	[decimal](10,3), @unitprice_5 	[decimal](10,3), @amount_6 	[decimal](10,3), @needdate_7 	varchar(4000), @purpose_8 	varchar(4000), @cptdesc_9 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS UPDATE  [bill_CptPlanDetail]  SET  [cptplanid]	 = @cptplanid_2, [cptid]	 = @cptid_3, [number_n]	 = @number_4, [unitprice]	 = @unitprice_5, [amount]	 = @amount_6, [needdate]	 = @needdate_7, [purpose]	 = @purpose_8, [cptdesc]	 = @cptdesc_9  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptPlanDetail_Select] (@cptplanid_2 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptPlanDetail] WHERE ( [cptplanid]	 = @cptplanid_2)

GO
alter procedure [bill_CptPlanDetail_Insert] (@cptplanid 	[int], @cptid_1 	[int], @number_2 	[decimal](10,3), @unitprice_3 	[decimal](10,3), @amount_4 	[decimal](10,3), @needdate_5 	varchar(4000), @purpose_6 	varchar(4000), @cptdesc_7 	varchar(4000), @flag integer output , @msg varchar(4000) output )  AS INSERT INTO [bill_CptPlanDetail] ( [cptplanid], [cptid], [number_n], [unitprice], [amount], [needdate], [purpose], [cptdesc])  VALUES ( @cptplanid, @cptid_1, @number_2, @unitprice_3, @amount_4, @needdate_5, @purpose_6, @cptdesc_7)

GO
alter procedure [bill_CptCheckMain_Select] (@id 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptCheckMain] WHERE ( [id]	 = @id)

GO
alter procedure [bill_CptCheckDetail_Select] (@cptcheckid 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptCheckDetail] WHERE ( [cptcheckid]	 = @cptcheckid)

GO
alter procedure [bill_CptCheckDetail_Insert] (@cptcheckid 	[int], @cptid 	[int], @theorynumber 	[decimal](10,3), @realnumber 	[decimal](10,3), @price 	[decimal](10,3), @remark 	varchar(4000), @flag integer output , @msg varchar(4000) output )  AS INSERT INTO [bill_CptCheckDetail] ( [cptcheckid], [cptid], [theorynumber], [realnumber], [price], [remark])  VALUES ( @cptcheckid, @cptid, @theorynumber, @realnumber, @price, @remark)

GO
alter procedure [bill_CptCarOut_Update] (@id_1 	[int], @date_2 	varchar(4000), @driver_3 	[int], @carno_4 	[int], @begindate_5 	varchar(4000), @begintime_6 	varchar(4000), @enddate_7 	varchar(4000), @endtime_8 	varchar(4000), @frompos_9 	varchar(4000), @beginnumber_10 	[decimal], @endnumber_11 	[decimal], @number_12 	[decimal], @userid_13 	[int], @userdepid_14 	[int], @isotherplace_15 	[int], @flag integer output , @msg varchar(4000) output )  AS UPDATE [bill_CptCarOut]  SET  [usedate]	 = @date_2, [driver]	 = @driver_3, [carno]	 = @carno_4, [begindate]	 = @begindate_5, [begintime]	 = @begintime_6, [enddate]	 = @enddate_7, [endtime]	 = @endtime_8, [frompos]	 = @frompos_9, [beginnumber]	 = @beginnumber_10, [endnumber]	 = @endnumber_11, [number_n]	 = @number_12, [userid]	 = @userid_13, [userdepid]	 = @userdepid_14, [isotherplace]	 = @isotherplace_15  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptCarOut_Insert] (@requestid_1 	[int], @date_2 	varchar(4000), @driver_3 	[int], @carno_4 	[int], @begindate_5 	varchar(4000), @begintime_6 	varchar(4000), @enddate_7 	varchar(4000), @endtime_8 	varchar(4000), @frompos_9 	varchar(4000), @beginnumber_10 	[decimal], @endnumber_11 	[decimal], @number_12 	[decimal], @userid_13 	[int], @userdepid_14 	[int], @isotherplace_15 	[int], @flag integer output , @msg varchar(4000) output )  AS INSERT INTO [bill_CptCarOut] ( [requestid], [usedate], [driver], [carno], [begindate], [begintime], [enddate], [endtime], [frompos], [beginnumber], [endnumber], [number_n], [userid], [userdepid], [isotherplace])  VALUES ( @requestid_1, @date_2, @driver_3, @carno_4, @begindate_5, @begintime_6, @enddate_7, @endtime_8, @frompos_9, @beginnumber_10, @endnumber_11, @number_12, @userid_13, @userdepid_14, @isotherplace_15)

GO
alter procedure [bill_CptCarOut_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output )  AS DELETE [bill_CptCarOut]  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptCarMantant_Update] (@id_1 	[int], @usedate_2 	varchar(4000), @driver_3 	[int], @carno_4 	[int], @mantantfee_5 	[decimal], @remax_6 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS UPDATE [bill_CptCarMantant]  SET  [usedate]	 = @usedate_2, [driver]	 = @driver_3, [carno]	 = @carno_4, [mantantfee]	 = @mantantfee_5, [remax]	 = @remax_6  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptCarMantant_Insert] (@requestid_1 	[int], @usedate_2 	varchar(4000), @driver_3 	[int], @carno_4 	[int], @mantantfee_5 	[decimal], @remax_6 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [bill_CptCarMantant] ( [requestid], [usedate], [driver], [carno], [mantantfee], [remax])  VALUES ( @requestid_1, @usedate_2, @driver_3, @carno_4, @mantantfee_5, @remax_6)

GO
alter procedure [bill_CptCarFix_Update] (@id_1 	[int], @usedate_2 	varchar(4000), @driver_3 	[int], @carno_4 	[int], @fixfee_5 	[decimal](10,3), @remax_6 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS UPDATE [bill_CptCarFix]  SET  [usedate]	 = @usedate_2, [driver]	 = @driver_3, [carno]	 = @carno_4, [fixfee]	 = @fixfee_5, [remax]	 = @remax_6  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptCarFix_Insert] (@requestid_1 	[int], @usedate_2 	varchar(4000), @driver_3 	[int], @carno_4 	[int], @fixfee_5 	[decimal](10,3), @remax_6 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [bill_CptCarFix] ( [requestid], [usedate], [driver], [carno], [fixfee], [remax])  VALUES ( @requestid_1, @usedate_2, @driver_3, @carno_4, @fixfee_5, @remax_6)

GO
alter procedure [bill_CptCarFee_Update] (@id_1 	[int], @usedate_2 	varchar(4000), @driver_3 	[int], @carno_4 	[int], @oilfee_5 	[decimal], @bridgefee_6 	[decimal], @fixfee_7 	[decimal], @phonefee_8 	[decimal], @cleanfee_9 	[decimal], @remax_10 	varchar(4000), @flag integer output , @msg varchar(4000) output )  AS UPDATE [bill_CptCarFee]  SET  [usedate]	 = @usedate_2, [driver]	 = @driver_3, [carno]	 = @carno_4, [oilfee]	 = @oilfee_5, [bridgefee]	 = @bridgefee_6, [fixfee]	 = @fixfee_7, [phonefee]	 = @phonefee_8, [cleanfee]	 = @cleanfee_9, [remax]	 = @remax_10  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptCarFee_Insert] (@requestid_1 	[int], @usedate_2 	varchar(4000), @driver_3 	[int], @carno_4 	[int], @oilfee_5 	[decimal], @bridgefee_6 	[decimal], @fixfee_7 	[decimal], @phonefee_8 	[decimal], @cleanfee_9 	[decimal], @remax_10 	varchar(4000), @flag integer output , @msg varchar(4000) output )  AS INSERT INTO [bill_CptCarFee] ( [requestid], [usedate], [driver], [carno], [oilfee], [bridgefee], [fixfee], [phonefee], [cleanfee], [remax])  VALUES ( @requestid_1, @usedate_2, @driver_3, @carno_4, @oilfee_5, @bridgefee_6, @fixfee_7, @phonefee_8, @cleanfee_9, @remax_10)

GO
alter procedure [WorkFlowTypeNodeTime_Get] @sqlStr_1	varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output AS exec (' select workflow_currentoperator.requestid, workflow_currentoperator.nodeid, (select requestname from workflow_requestbase where requestid=workflow_currentoperator.requestid ), (select nodename from workflow_nodebase where id=workflow_currentoperator.nodeid), 24*avg( convert(float, convert(datetime, case isremark when ''2'' then case operatedate when '''' then convert(char(10),getdate(),20) else operatedate end when null then isnull(operatedate,convert(char(10),getdate(),20)) else convert(char(10),getdate(),20) end +'' ''+ case isremark when ''2'' then case operatetime when '''' then convert(char(10),getdate(),108) else operatetime end when null then isnull(operatetime,convert(char(10),getdate(),108)) else convert(char(10),getdate(),108) end ) ) - convert(float,convert(datetime,receivedate+'' ''+receivetime))) from workflow_currentoperator,workflow_requestbase where workflow_requestbase.requestid=workflow_currentoperator.requestid and (workflow_requestbase.status is not null and workflow_requestbase.status!='''') and workflowtype>1  and isremark<>4 '+@sqlStr_1+' and preisremark=''0'' and exists (select 1 from workflow_flownode where nodeid=workflow_currentoperator.nodeid and  workflowid=workflow_currentoperator.workflowid and nodetype<3) group by  workflow_currentoperator.requestid ,workflow_currentoperator.nodeid order by  workflow_currentoperator.requestid ,workflow_currentoperator.nodeid ')

GO
alter procedure [WorkFlowSysNodeTime_Get] @sqlStr_1	varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output AS exec (' select workflow_currentoperator.workflowid, workflow_currentoperator.nodeid, (select nodename from workflow_nodebase where id=workflow_currentoperator.nodeid), 24*avg( convert(float, convert(datetime, case isremark when ''2'' then case operatedate when '''' then convert(char(10),getdate(),20) else operatedate end when null then isnull(operatedate,convert(char(10),getdate(),20)) else convert(char(10),getdate(),20) end +'' ''+ case isremark when ''2'' then case operatetime when '''' then convert(char(10),getdate(),108) else operatetime end when null then isnull(operatetime,convert(char(10),getdate(),108)) else convert(char(10),getdate(),108) end ) ) - convert(float,convert(datetime,receivedate+'' ''+receivetime))) from workflow_currentoperator,workflow_requestbase where workflow_requestbase.requestid=workflow_currentoperator.requestid and (workflow_requestbase.status is not null and workflow_requestbase.status!='''') and workflowtype>1 and workflow_currentoperator.isremark <> 0 and isremark<>4 and preisremark=''0'' and exists (select 1 from workflow_flownode where nodeid=workflow_currentoperator.nodeid and  workflowid=workflow_currentoperator.workflowid and nodetype<>3) group by  workflow_currentoperator.workflowid ,workflow_currentoperator.nodeid order by  workflow_currentoperator.workflowid ,workflow_currentoperator.nodeid')

GO
alter procedure  [GetDBDateAndTime] @flag integer output , @msg varchar(4000) output AS declare @currentdate char(10),@currenttime char(8) set @currentdate=convert(char(10),getdate(),20) set @currenttime=convert(char(8),getdate(),108) begin select @currentdate as dbdate,@currenttime as dbtime end

GO
alter procedure [Bill_HrmResourcePlan_UStatus] (@id [int], @usestatus char(1) ,@flag integer output , @msg varchar(4000) output) AS update Bill_HrmResourcePlan set usestatus = @usestatus where id=@id

GO
alter procedure [Bill_HrmResourcePlan_SByID] (@id [int], @flag integer output , @msg varchar(4000) output) AS select *  from Bill_HrmResourcePlan where id=@id

GO
alter procedure [NodeOperatorTime] @sqlStr_1	varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output AS exec('select userid,24*avg(convert(float,convert(datetime, case isremark when  ''2'' then operatedate  else isnull(operatedate ,convert(char(10),getdate(),20)) end  +'' ''+case isremark when ''2'' then operatetime else  isnull(operatetime, convert(char(10),getdate(),108)) end )) -convert(float,convert(datetime,receivedate+'' ''+receivetime))) as spends from workflow_currentoperator where exists (select 1 from workflow_requestbase where workflow_requestbase.requestid=workflow_currentoperator.requestid and status is not null and status!='''' ) '+@sqlStr_1+'  group by userid order by spends desc')

GO
alter procedure [PersonNodeTime_Get] @sqlStr_1	varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output AS exec (' select workflow_currentoperator.userid, workflow_currentoperator.workflowid, workflow_currentoperator.nodeid, (select nodename from workflow_nodebase where id=workflow_currentoperator.nodeid), 24*avg( convert(float, convert(datetime, case isremark when ''2'' then case operatedate when '''' then convert(char(10),getdate(),20) else operatedate end when null then isnull(operatedate,convert(char(10),getdate(),20)) else convert(char(10),getdate(),20) end +'' ''+ case isremark when ''2'' then case operatetime when '''' then convert(char(10),getdate(),108) else operatetime end when null then isnull(operatetime,convert(char(10),getdate(),108)) else convert(char(10),getdate(),108) end ) ) - convert(float,convert(datetime,receivedate+'' ''+receivetime)) ) from workflow_currentoperator,workflow_requestbase where workflow_requestbase.requestid=workflow_currentoperator.requestid and (workflow_requestbase.status is not null and workflow_requestbase.status!='''') and workflowtype>1 and workflow_currentoperator.isremark <> 0 and isremark<4 '+@sqlStr_1+' and preisremark=''0'' and exists (select 1 from workflow_flownode where nodeid=workflow_currentoperator.nodeid and  workflowid=workflow_currentoperator.workflowid and nodetype<3) group by  workflow_currentoperator.userid,workflow_currentoperator.workflowid ,workflow_currentoperator.nodeid order by  workflow_currentoperator.userid,workflow_currentoperator.workflowid ,workflow_currentoperator.nodeid' )

GO
alter procedure [Prj_Find_Contract] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_Contract] WHERE ([projid] = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [bill_BudgetDetail_SMonthTotal] @departmentid	int, @month		int, @year		int, @flag integer output , @msg varchar(4000) output as select sum(budget) from bill_budgetdetail where departmentid=@departmentid and month=@month and year=@year

GO
alter procedure [bill_BudgetDetail_SMonthToByf] @feeid	int, @month		int, @year		int, @flag integer output , @msg varchar(4000) output as select sum(budget) from bill_budgetdetail where feeid=@feeid and month=@month and year=@year

GO
alter procedure [bill_BudgetDetail_SelectOne] @departmentid	int, @feeid		int, @month		int, @year		int, @flag integer output , @msg varchar(4000) output as select budget from bill_budgetdetail where departmentid=@departmentid and feeid=@feeid and month=@month and year=@year

GO
alter procedure [bill_BudgetDetail_SAllMonth] @month		int, @year		int, @flag integer output , @msg varchar(4000) output as select sum(budget) from bill_budgetdetail where month=@month and year=@year

GO
alter procedure [bill_BudgetDetail_Insert] @departmentid	int, @feeid		int, @month		int, @budget		decimal(10,3), @year       int, @flag integer output , @msg varchar(4000) output as insert into bill_budgetdetail values(@departmentid,@feeid,@month,@budget,@year)

GO
alter procedure [bill_CptStockInMain_Select] (@id 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptStockInMain] WHERE ( [id]	 = @id)

GO
alter procedure [bill_CptStockInDetail_Update2] (@id_1 	[int], @capitalid 	[int], @mark 	varchar(4000), @capitalspec    varchar(4000), @flag integer output , @msg varchar(4000) output)  AS UPDATE  [bill_CptStockInDetail]  SET [capitalid]	 = @capitalid , [cptno]	 = @mark, [cpttype]   = @capitalspec  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptStockInDetail_Update] (@id_1 	[int], @cptno_3 	varchar(4000), @cptid_4 	[int], @cpttype_5 	varchar(4000), @plannumber_6 	[decimal], @innumber_7 	[decimal], @planprice_8 	[decimal], @inprice_9 	[decimal], @planamount_10 	[decimal], @inamount_11 	[decimal], @difprice_12 	[decimal], @capitalid 	[int], @flag integer output , @msg varchar(4000) output)  AS UPDATE [bill_CptStockInDetail]  SET  	 [cptno]	 = @cptno_3, [cptid]	 = @cptid_4, [cpttype]	 = @cpttype_5, [plannumber]	 = @plannumber_6, [innumber]	 = @innumber_7, [planprice]	 = @planprice_8, [inprice]	 = @inprice_9, [planamount]	 = @planamount_10, [inamount]	 = @inamount_11, [difprice]	 = @difprice_12 , [capitalid]	 = @capitalid  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptStockInDetail_SSum] (@cptstockinid 	[int], @flag integer output , @msg varchar(4000) output)  AS select count(id)  from  [bill_CptStockInDetail] WHERE ( [cptstockinid]	 = @cptstockinid)

GO
alter procedure [bill_CptStockInDetail_Select] (@cptstockinid 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptStockInDetail] WHERE ( [cptstockinid]	 = @cptstockinid)

GO
alter procedure [bill_CptStockInDetail_Insert] (@cptstockinid 	[int], @cptid_1 	[int], @number_2 	[decimal](10,3), @unitprice_3 	[decimal](10,3), @amount_4 	[decimal](10,3), @flag integer output , @msg varchar(4000) output )  AS INSERT INTO [bill_CptStockInDetail] ( [cptstockinid], [cptid], [plannumber], [planprice], [planamount])  VALUES ( @cptstockinid, @cptid_1, @number_2, @unitprice_3, @amount_4)

GO
alter procedure [Bill_Meetingroom_SelectByID] (@id [int], @flag integer output , @msg varchar(4000) output) AS select *  from Bill_Meetingroom where id=@id

GO
alter procedure [bill_NameCard_UpdateStatus] @id		int, @status	char(1), @flag integer output , @msg varchar(4000) output as update bill_NameCard set status=@status where id=@id

GO
alter procedure [Bill_NameCard_SelectByID] @id		int, @flag integer output , @msg varchar(4000) output as select * from bill_namecard where id=@id

GO
alter procedure [bill_TotalBudget_UpdateStatus] @id		int, @status	char(1), @flag integer output , @msg varchar(4000) output as update Bill_TotalBudget set status=@status where id=@id

GO
alter procedure [Bill_TotalBudget_SelectByID] @id		int, @flag integer output , @msg varchar(4000) output as select * from Bill_TotalBudget where id=@id

GO
alter procedure [HrmSalaryRate_Update] ( @id_1	 	int, @ranknum_1 int , @ranklow_1 decimal (12,2)  , @rankhigh_1 decimal (12,2)  , @taxrate_1 decimal (12,2)  , @flag	int	output, @msg	varchar(4000)	output ) AS UPDATE HrmSalaryRate  SET  ranknum	 = @ranknum_1, ranklow	 = @ranklow_1, rankhigh = @rankhigh_1, taxrate=@taxrate_1  WHERE ( id	 = @id_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryRate_SelectByID] (@id_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryRate WHERE id=@id_1 set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryRate_SelectAll] (@flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryRate order by ranknum set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryRate_Insert] (	@ranknum_1 int , @ranklow_1 decimal (12,2)  , @rankhigh_1 decimal (12,2)  , @taxrate_1 decimal (12,2)  ,  @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO HrmSalaryRate ( ranknum, ranklow, rankhigh,taxrate) VALUES ( @ranknum_1, @ranklow_1, @rankhigh_1,@taxrate_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryRate_Delete] (@id_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS DELETE HrmSalaryRate WHERE ( id	 = @id_1)  set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [DocFrontpage_SelectAllId] ( @pagenumber     int, @perpage        int, @countnumber    int, @logintype		int, @usertype		int, @userid			int, @userseclevel	int, @flag integer output, @msg varchar(4000) output) as declare @pagecount int declare @pagecount2 int set @pagecount =  @pagenumber*@perpage  if (@countnumber-(@pagenumber-1)*@perpage)<@perpage set @pagecount2 =@countnumber-(@pagenumber-1)*@perpage else set @pagecount2 =@perpage  if @logintype=1 begin exec('Select distinct top '+@pagecount+' n.id, n.docsubject , n.doccreatedate , n.doccreatetime into #temp from DocDetail n INNER JOIN DocShareDetail d ON n.id=d.docid where d.userid='+@userid+' and d.usertype = 1 and  (n.docpublishtype=''2'' or n.docpublishtype=''3'') and n.docstatus in(''1'',''2'',''5'') order by n.doccreatedate desc , n.doccreatetime desc ;'+ 'select top '+@pagecount2+' * from #temp order by doccreatedate, doccreatetime') end if @logintype<>1 begin exec ('Select distinct top '+@pagecount+' n.id , n.docsubject , n.doccreatedate , n.doccreatetime into #temp from DocDetail n INNER JOIN DocShareDetail d ON n.id=d.docid where  d.usertype='+@usertype+' and d.userid<='+@userseclevel+' and (n.docpublishtype=''2'' or n.docpublishtype=''3'') and n.docstatus in(''1'',''2'',''5'') order by n.doccreatedate desc, n.doccreatetime desc ;'+ 'select top '+@pagecount2+' * from #temp order by doccreatedate, doccreatetime') end

GO
alter procedure [SpendTimeStat_Get] @sqlStr_1	varchar(4000), @sqlStr_2	varchar(4000), @pagenum   int , @prepage  int, @count  int, @flag 		integer 	output , @msg 		varchar(4000) 	output AS DECLARE @num int, @countss int set @num=@pagenum*@prepage set @countss=@count-(@pagenum-1)*@prepage-1 if @pagenum=1 exec (' select top '+@prepage+' * from ( select  requestname,workflow_requestbase.requestid,workflow_requestbase.workflowid,status, 24 *( convert(float,convert(datetime, case lastoperatedate when ''''  then convert(char(10),getdate(),20) when null then convert(char(10),getdate(),20) else lastoperatedate end + '' '' + isnull(lastoperatetime,convert(char(10), getdate(), 108)) ) ) - convert(float,convert(datetime, createdate + '' '' + createtime))) as spends from workflow_requestbase where exists (select 1 from workflow_currentoperator where requestid=workflow_requestbase.requestid and workflow_currentoperator.preisremark=''0'' '+@sqlStr_1+' ) and exists (select 1 from workflow_base where id = workflow_requestbase.workflowid and isvalid = 1) and status is not null and status!='''' '+@sqlStr_2+' ) as t order by spends desc') else exec (' select * from ( select top '+@countss+' * from ( select top '+@num+' * from ( select  requestname,workflow_requestbase.requestid,workflow_requestbase.workflowid,status, 24 *( convert(float,convert(datetime, case lastoperatedate when ''''  then convert(char(10),getdate(),20) when null then convert(char(10),getdate(),20) else lastoperatedate end + '' '' + isnull(lastoperatetime,convert(char(10), getdate(), 108)) ) ) - convert(float,convert(datetime, createdate + '' '' + createtime))) as spends from workflow_requestbase where exists ( select 1 from workflow_currentoperator where requestid=workflow_requestbase.requestid and workflow_currentoperator.preisremark=''0''  '+@sqlStr_1+' ) and exists (select 1 from workflow_base where id = workflow_requestbase.workflowid and isvalid = 1) and status is not null and status!='''' '+@sqlStr_2+' ) as temp order by spends desc ) as t  order by spends ) as temp1 order by spends desc')

GO
alter procedure [SpendTimeStat_count] @sqlStr_1	varchar(4000), @sqlStr_2	varchar(4000), @num     int, @flag 		integer 	output , @msg 		varchar(4000) 	output AS BEGIN exec ('select count(*)  from (select top '+@num+' * from (select  requestname,workflow_requestbase.requestid,workflow_requestbase.workflowid,status,24*(convert(float,convert(datetime,isnull(lastoperatedate ,convert(char(10),getdate(),20)) +'' ''+isnull(lastoperatetime,convert(char(10),getdate(),108))))-convert(float,convert(datetime,createdate+'' ''+createtime))) as spends from workflow_requestbase where exists (select 1 from workflow_currentoperator where requestid=workflow_requestbase.requestid '+@sqlStr_1+' ) and exists (select 1 from workflow_base where id = workflow_requestbase.workflowid and isvalid = 1) and status is not null and status!='''' '+@sqlStr_2+' ) as temp order by spends desc ) as t ')  END

GO
alter procedure [proc_onlineuser_list] @T_UserType Varchar(8), @FLAG  int output, @MSG varchar(4000) output AS Begin  if @T_UserType = 'reg' Select distinct 'reg',UserName,null,null,null,null from T_CountUserOnLine where UserType = 'reg' order by username desc; else Select UserType,UserName,SessionID,ServerIP,RemoteIP,convert(datetime,cdate) from T_CountUserOnLine where UserType = 'guest' order by username desc;  End

GO
alter procedure [proc_onlineuser_count] @T_UserType varchar(4000), @FLAG int output, @MSG varchar(4000) output AS  Begin declare @v_count1 int declare @v_count2 int set @FLAG = 0 set @MSG = '存取过程执行成功！' select  @v_count1=count(*) from T_CountUserOnLine where UserType = 'reg' select @v_count2=count(*)  from T_CountUserOnLine where usertype='guest' IF @T_UserType = 'all' Select @v_count1 + @v_count2 ELSe if @T_UserType = 'reg' select @v_count1 ELSe if @T_UserType = 'guest' Select @v_count2 if @@error<>0 begin set @flag=1 set @msg='执行失败' End end

GO
alter procedure [proc_count_restart] @ServerIP varchar(4000), @FLAG int output, @msg varchar(4000) output as Begin   Delete from T_CountUserOnLine where ServerIP = @ServerIP; Select '1' End

GO
alter procedure [proc_count_reduceonline] @SessionID varchar(4000), @ServerIP varchar(4000), @RemoteIP varchar(4000), @flag int output, @msg varchar(4000) output AS Begin  Delete from T_CountUserOnLine where SessionID = @SessionID and ServerIP = @ServerIP and RemoteIP = @RemoteIP   select '1' End

GO
alter procedure [proc_count_addonline] @userName Varchar(20), @SessionID varchar(4000), @ServerIP Varchar(10), @RemoteIP varchar(4000), @UserType varchar(4000), @FLAG int output, @MSG varchar(4000) output AS Begin   Insert into T_CountUserOnLine(UserName,SessionID,ServerIP,RemoteIP,UserType,Cdate) Values(@UserName,@SessionID,@ServerIP,@RemoteIP,@UserType,getdate())   Select '1'  End

GO
alter procedure [WorkFlowPending_Get]  @sqlStr_1	varchar(4000), @flag 		integer 	output, @msg 		varchar(4000) output AS exec (' SELECT TOP 100 PERCENT userid as userid, COUNT(requestid) AS counts FROM  workflow_currentoperator WHERE workflowtype > 0  and isremark IN (''0'', ''1'', ''5'',''8'',''9'',''7'') AND islasttimes = 1 AND usertype = ''0'' and exists (select 1 from hrmresource where hrmresource.id=workflow_currentoperator.userid and hrmresource.status in (0,1,2,3)) and exists (select 1 from workflow_requestbase where requestid = workflow_currentoperator.requestid and (deleted=0 or deleted is null)) AND EXISTS (SELECT 1 FROM workflow_base WHERE id = workflow_currentoperator.workflowid AND (isvalid = 1 or isvalid=3)) '+@sqlStr_1+' GROUP BY userid ORDER BY COUNT(requestid) desc ,userid asc')

GO
alter procedure [WorkFlowNodeTime_Get] @sqlStr_1	varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output AS exec (' select workflow_currentoperator.workflowid, workflow_currentoperator.nodeid, (select nodename from workflow_nodebase where id=workflow_currentoperator.nodeid), 24*avg( convert(float, convert(datetime, case isremark when ''2'' then case operatedate when '''' then convert(char(10),getdate(),20) else operatedate end when null then isnull(operatedate,convert(char(10),getdate(),20)) else convert(char(10),getdate(),20) end +'' ''+ case isremark when ''2'' then case operatetime when '''' then convert(char(10),getdate(),108) else operatetime end when null then isnull(operatetime,convert(char(10),getdate(),108)) else convert(char(10),getdate(),108) end ) ) - convert(float,convert(datetime,receivedate+'' ''+receivetime)) ) from workflow_currentoperator,workflow_requestbase where workflow_requestbase.requestid=workflow_currentoperator.requestid and (workflow_requestbase.status is not null and workflow_requestbase.status!='''') and workflowtype>1 and isremark<>4 '+@sqlStr_1+' and preisremark=''0'' and exists (select 1 from workflow_flownode where nodeid=workflow_currentoperator.nodeid and  workflowid=workflow_currentoperator.workflowid and nodetype<>3) group by  workflow_currentoperator.workflowid ,workflow_currentoperator.nodeid order by  workflow_currentoperator.workflowid ,workflow_currentoperator.nodeid ')

GO
alter procedure [Bill_Expense_UpdateStatus] (@id [int], @usestatus char(1) ,@flag integer output , @msg varchar(4000) output) AS update Bill_Expense set usestatus = @usestatus where id=@id

GO
alter procedure [Bill_Expense_SelectByID] (@id [int], @flag integer output , @msg varchar(4000) output) AS select *  from Bill_Expense where id=@id

GO
alter procedure [bill_HotelBook_UpdateStatus] @id		int, @status	char(1), @flag integer output , @msg varchar(4000) output as update bill_HotelBook set status=@status where id=@id

GO
alter procedure [Bill_HotelBook_SelectByID] @id		int, @flag integer output , @msg varchar(4000) output as select * from bill_HotelBook where id=@id

GO
alter procedure [bill_contractdetail_Update] (@id_1 	[int], @contractid 	[int], @assetid_3 	[int], @batchmark_4 	varchar(4000), @number_5 	[float], @currencyid_6 	[int], @defcurrencyid_7 	[int], @exchangerate_8 	[decimal], @defunitprice_9 	[decimal], @unitprice_10 	[decimal], @taxrate_11 	[int],  @flag integer output , @msg varchar(4000) output)  AS UPDATE [bill_contractdetail]  SET  [contractid]	 = @contractid, [assetid]	 = @assetid_3, [batchmark]	 = @batchmark_4, [number_n]	 = @number_5, [currencyid]	 = @currencyid_6, [defcurrencyid]	 = @defcurrencyid_7, [exchangerate]	 = @exchangerate_8, [defunitprice]	 = @defunitprice_9, [unitprice]	 = @unitprice_10, [taxrate]	 = @taxrate_11  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_contractdetail_Select] (@id [int], @flag integer output , @msg varchar(4000) output) AS select *  from bill_contractdetail where contractid=@id

GO
alter procedure [bill_contractdetail_Insert] (@contractid 	[int], @assetid_2 	[int], @batchmark_3 	varchar(4000), @number_4 	[float], @currencyid_5 	[int], @defcurrencyid_6 	[int], @exchangerate_7 	[decimal], @defunitprice_8 	[decimal], @unitprice_9 	[decimal], @taxrate_10 	[int], @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [bill_contractdetail] ( [contractid], [assetid], [batchmark], [number_n], [currencyid], [defcurrencyid], [exchangerate], [defunitprice], [unitprice], [taxrate])  VALUES ( @contractid, @assetid_2, @batchmark_3, @number_4, @currencyid_5, @defcurrencyid_6, @exchangerate_7, @defunitprice_8, @unitprice_9, @taxrate_10)

GO
alter procedure [bill_contract_SelectById] (@id [int], @flag integer output , @msg varchar(4000) output) AS select *  from bill_contract where id=@id

GO
alter procedure [FnaLedger_DeleteAuto] (@crmcode 	varchar(4000), @crmtype 	[char](1), @flag integer output , @msg varchar(4000) output)  AS declare @count integer declare @ledgermark_1 varchar(4000), @ledgermark_2 varchar(4000), @ledgerid_1 int, @ledgerid_2 int declare @supledgerid_1 int, @supledgerid_2 int  if @crmtype = '1' begin select @ledgermark_1 = ledgermark from FnaLedger where autosubledger = '1' select @ledgermark_2 = ledgermark from FnaLedger where autosubledger = '2' end  if @crmtype = '2' begin select @ledgermark_1 = ledgermark from FnaLedger where autosubledger = '3' select @ledgermark_2 = ledgermark from FnaLedger where autosubledger = '4' end  select @ledgerid_1 = id , @supledgerid_1 = supledgerid from FnaLedger where  ledgermark = (@ledgermark_1 + @crmcode) select @count = count(id) from FnaTransactionDetail where ledgerid = @ledgerid_1 if @count <> 0 begin select 2 return end   select @ledgerid_2 = id , @supledgerid_2 = supledgerid from FnaLedger where  ledgermark = (@ledgermark_2 + @crmcode) select @count = count(id) from FnaTransactionDetail where ledgerid = @ledgerid_2 if @count <> 0 begin select 2 return end  delete FnaLedger where id = @ledgerid_1 delete FnaLedger where id = @ledgerid_2  update FnaLedger set subledgercount = subledgercount-1 where id = @supledgerid_1 update FnaLedger set subledgercount = subledgercount-1 where id = @supledgerid_2  select 0

GO
alter procedure [FnaLedger_Delete] (@id_1 	[int], @supledgerid_2 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @count integer select @count = subledgercount from FnaLedger where [id] = @id_1 if @count <> 0 begin select '20' return end  select @count = count(id) from FnaTransactionDetail where ledgerid = @id_1 if @count <> 0 begin select '20' return end  DELETE [FnaLedger] WHERE ( [id]	 = @id_1 ) if  @supledgerid_2 <> 0 begin update FnaLedger set subledgercount = subledgercount-1 where id = @supledgerid_2 end  delete FnaAccount where ledgerid = @id_1

GO
alter procedure [FnaBudgetDetail_SByBudgetID] (@id_1 	[int], @flag integer output , @msg varchar(4000) output) AS select * from FnaBudgetDetail where budgetid = @id_1

GO
alter procedure [FnaBudgetDetail_Insert] (@budgetid_1 	[int], @ledgerid_2 	[int], @budgetcrmid_3 	[int], @budgetitemid_4 	[int], @budgetdocid_5 	[int], @budgetprojectid_6 	[int], @budgetaccount_7 	[decimal](18,3), @budgetdefaccount_8 	[decimal](18,3), @budgetremark_9 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [FnaBudgetDetail] ( [budgetid], [ledgerid], [budgetcrmid], [budgetitemid], [budgetdocid], [budgetprojectid], [budgetaccount], [budgetdefaccount], [budgetremark])  VALUES ( @budgetid_1, @ledgerid_2, @budgetcrmid_3, @budgetitemid_4, @budgetdocid_5, @budgetprojectid_6, @budgetaccount_7, @budgetdefaccount_8, @budgetremark_9)

GO
alter procedure [HrmArrangeShiftSet_Delete] ( @flag        integer output, @msg         varchar(4000) output ) AS delete HrmArrangeShiftSet

GO
alter procedure [FnaBudgetCheckDetail_Insert] (@budgetinfoid_1 	int, @budgetperiods_2 	int, @budgetstartdate_3 	char(10), @budgetenddate_4 	char(10), @budgettypeid_5 	int, @budgetaccount_9 	decimal(18,2), @budgetremark_10 	varchar(4000), @flag	int	output, @msg	varchar(4000) output)  AS INSERT INTO FnaBudgetCheckDetail ( budgetinfoid, budgetperiods, budgetstartdate, budgetenddate, budgettypeid, budgetaccount, budgetremark)  VALUES ( @budgetinfoid_1, @budgetperiods_2, @budgetstartdate_3, @budgetenddate_4, @budgettypeid_5, @budgetaccount_9, @budgetremark_10)

GO
alter procedure [FnaBudgetCheckDetail_Delete] (@budgetinfoid_1 	int, @flag	int	output, @msg	varchar(4000) output)  AS DELETE FnaBudgetCheckDetail  WHERE ( budgetinfoid	 = @budgetinfoid_1)

GO
alter procedure [FnaBudget_Update] (@id_1 	[int], @budgetmoduleid_3 	[int], @budgetcurrencyid_4 	[int], @budgetdefcurrencyid_5 	[int], @budgetexchangerate_6 	varchar(4000), @budgetremark_7 	varchar(4000), @budgetstatus_8 	[char](1), @createrid_9 	[int], @createdate_10 	[char](10), @flag integer output , @msg varchar(4000) output) AS UPDATE [FnaBudget]  SET  [budgetmoduleid]	 = @budgetmoduleid_3, [budgetcurrencyid]	 = @budgetcurrencyid_4, [budgetdefcurrencyid]	 = @budgetdefcurrencyid_5, [budgetexchangerate]	 = @budgetexchangerate_6, [budgetremark]	 = @budgetremark_7, [budgetstatus]	 = @budgetstatus_8, [createrid]	 = @createrid_9, [createdate]	 = @createdate_10  WHERE ( [id]	 = @id_1)  delete FnaBudgetDetail where budgetid = @id_1

GO
alter procedure [FnaBudget_SelectByResourceID] (@budgetperiods_1 	[char](6), @budgetresourceid_2 	[int], @flag integer output , @msg varchar(4000) output) AS select * from FnaBudget where budgetperiods = @budgetperiods_1 and budgetresourceid = @budgetresourceid_2

GO
alter procedure [FnaBudget_Reopen] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS update FnaBudget set budgetstatus='0' , approverid = null , approverdate=null where id = @id_1

GO
alter procedure [FnaBudget_Insert] (@budgetmoduleid_1 	[int], @budgetperiods_2 	[char](6), @budgetdepartmentid_3 	[int], @budgetcostercenterid_4 	[int], @budgetresourceid_5 	[int], @budgetcurrencyid_6 	[int], @budgetdefcurrencyid_7 	[int], @budgetexchangerate_8 	varchar(4000), @budgetremark_9 	varchar(4000), @budgetstatus_10 	[char](1), @createrid_11 	[int], @createdate_12 	[char](10), @flag integer output , @msg varchar(4000) output)  AS declare @count integer , @fnayear char(4) , @periodsid integer , @isclose char(1)  select @count = count(id) from FnaBudget where budgetresourceid = @budgetresourceid_5 and budgetperiods = @budgetperiods_2 if @count <> 0 begin select -1 return end  select @count = count(id) from FnaYearsPeriodsList where isclose = '0' and isactive = '1' and fnayearperiodsid = @budgetperiods_2  if @count = 0 begin select -2 return end   INSERT INTO [FnaBudget] ( [budgetmoduleid], [budgetperiods], [budgetdepartmentid], [budgetcostercenterid], [budgetresourceid], [budgetcurrencyid], [budgetdefcurrencyid], [budgetexchangerate], [budgetremark], [budgetstatus], [createrid], [createdate])  VALUES ( @budgetmoduleid_1, @budgetperiods_2, @budgetdepartmentid_3, @budgetcostercenterid_4, @budgetresourceid_5, @budgetcurrencyid_6, @budgetdefcurrencyid_7, @budgetexchangerate_8, @budgetremark_9, @budgetstatus_10, @createrid_11, @createdate_12)  select max(id) from FnaBudget

GO
alter procedure [FnaBudget_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS  DELETE [FnaBudget] WHERE  ( [id]	 = @id_1)  delete FnaBudgetDetail where budgetid = @id_1

GO
alter procedure [FnaBudget_Approve] @id_1 	[int], @approverid  [int], @approverdate  char(10), @flag integer output , @msg varchar(4000) output AS declare @count0 integer select @count0 = count(id) from FnaBudget where id = @id_1 and createrid = @approverid  if @count0 <> 0 begin select -1 return end   update FnaBudget set budgetstatus='1' , approverid=@approverid , approverdate=@approverdate where id = @id_1

GO
alter procedure [FnaCurrency_Update] (@id_1 int, @currencyname_2 varchar(4000), @currencydesc_3 varchar(4000), @activable_4 char(1), @isdefault_5 char(1), @flag integer output, @msg varchar(4000) output) AS IF (@isdefault_5 = '1') UPDATE FnaCurrency SET isdefault = '0' UPDATE FnaCurrency SET currencyname = @currencyname_2, currencydesc = @currencydesc_3, activable = @activable_4, isdefault = @isdefault_5 WHERE id = @id_1

GO
alter procedure [FnaCurrency_SelectByID] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from FnaCurrency where id = @id_1

GO
alter procedure [FnaCurrency_SelectByDefault] (@flag                             integer output, @msg                             varchar(4000) output ) AS select * from FnaCurrency where isdefault = '1'

GO
alter procedure [FnaCurrency_SelectAll] (@flag                             integer output, @msg                             varchar(4000) output ) AS select * from FnaCurrency order by id asc if @@error<>0 begin set @flag=1 set @msg='查询币种信息成功' return end else begin set @flag=0 set @msg='查询币种信息失败' return end

GO
alter procedure [FnaCurrency_Insert] (@currencyname_1 	varchar(4000), @currencydesc_2 	varchar(4000), @activable_3 	[char](1), @isdefault_4 	[char](1), @flag                             integer output, @msg                             varchar(4000) output )  AS declare @count integer select @count = count(id) from FnaCurrency where currencyname = @currencyname_1 if @count <>0 begin select -1 return end  if @isdefault_4 = '1' update FnaCurrency set isdefault = '0'  INSERT INTO [FnaCurrency] ( [currencyname], [currencydesc], [activable], [isdefault])  VALUES ( @currencyname_1, @currencydesc_2, @activable_3, @isdefault_4)  select max(id) from FnaCurrency

GO
alter procedure [FnaBudgetModule_Update] (@id_1 	[int], @budgetname_2 	varchar(4000), @budgetdesc_3 	varchar(4000), @fnayear_4 	[char](4), @periodsidfrom_5 	[int], @periodsidto_6 	[int], @flag integer output , @msg varchar(4000) output)  AS UPDATE [FnaBudgetModule]  SET  [budgetname]	 = @budgetname_2, [budgetdesc]	 = @budgetdesc_3, [fnayear]	 = @fnayear_4, [periodsidfrom]	 = @periodsidfrom_5, [periodsidto]	 = @periodsidto_6  WHERE ( [id]	 = @id_1)

GO
alter procedure [FnaBudgetModule_SelectByID] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS select * from FnaBudgetModule where id = @id_1

GO
alter procedure [FnaBudgetModule_Select] @flag integer output , @msg varchar(4000) output AS select * from FnaBudgetModule

GO
alter procedure [FnaBudgetModule_Insert] (@budgetname_1 	varchar(4000), @budgetdesc_2 	varchar(4000), @fnayear_3 	[char](4), @periodsidfrom_4 	[int], @periodsidto_5 	[int], @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [FnaBudgetModule] ( [budgetname], [budgetdesc], [fnayear], [periodsidfrom], [periodsidto])  VALUES ( @budgetname_1, @budgetdesc_2, @fnayear_3, @periodsidfrom_4, @periodsidto_5) select max(id) from FnaBudgetModule

GO
alter procedure [bill_CptAdjustDetail_Update] (@id_1 	[int], @cptid_3 	[int], @number_4 	[decimal](10,3), @unitprice_5 	[decimal](10,3), @amount_6 	[decimal](10,3), @cptstatus 	[int], @needdate_7 	varchar(4000), @purpose_8 	varchar(4000), @cptdesc_9 	varchar(4000), @capitalid 	[int], @flag integer output , @msg varchar(4000) output)  AS UPDATE  [bill_CptAdjustDetail]  SET [cptid]	 = @cptid_3, [number_n]	 = @number_4, [unitprice]	 = @unitprice_5, [amount]	 = @amount_6, [cptstatus]	 = @cptstatus, [needdate]	 = @needdate_7, [purpose]	 = @purpose_8, [cptdesc]	 = @cptdesc_9 , [capitalid]	 = @capitalid  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptAdjustDetail_Select] (@cptadjustid 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptAdjustDetail] WHERE ( [cptadjustid]	 = @cptadjustid) order by id

GO
alter procedure [bill_CptAdjustDetail_Insert] (@cptadjustid 	[int], @cptid_1 	[int], @capitalid_2 	[int], @number_3 	[decimal](10,3), @unitprice_4 	[decimal](10,3), @amount_5 	[decimal](10,3), @needdate_6 	varchar(4000), @purpose_7 	varchar(4000), @cptdesc_8 	varchar(4000), @flag integer output , @msg varchar(4000) output ) AS INSERT INTO [bill_CptAdjustDetail] ( [cptadjustid], [cptid], [capitalid], [number_n], [unitprice], [amount], [needdate], [purpose], [cptdesc]) VALUES (@cptadjustid, @cptid_1, @capitalid_2, @number_3, @unitprice_4, @amount_5, @needdate_6, @purpose_7, @cptdesc_8)

GO
alter procedure [XmlReport_ShareInfo_SbyRid] (@relateditemid varchar(4000) , @flag integer output , @msg varchar(4000) output ) AS select * from XmlReport_ShareInfo where ( relateditemid = @relateditemid ) order by sharetype set  @flag = 1 set  @msg = 'ok'

GO
alter procedure [XmlReport_ShareInfo_Insert] (@relateditemid varchar(4000), @sharetype tinyint, @seclevel  tinyint, @rolelevel tinyint, @sharelevel tinyint, @userid int, @departmentid int, @roleid int, @foralluser tinyint, @flag integer output, @msg varchar(4000) output ) AS INSERT INTO XmlReport_ShareInfo ( relateditemid, sharetype, seclevel, rolelevel, sharelevel, userid, departmentid, roleid, foralluser ) VALUES ( @relateditemid , @sharetype , @seclevel , @rolelevel , @sharelevel, @userid, @departmentid, @roleid, @foralluser  ) set @flag=1 set @msg='ok'

GO
alter procedure [XmlReport_ShareInfo_Delete] (@id int, @flag integer output, @msg varchar(4000) output ) AS DELETE from XmlReport_ShareInfo  WHERE ( id = @id) set @flag=1 set @msg='ok'

GO
alter procedure [Ycuser_Update] (@id_1 int, @loginid_2 varchar(4000), @logintype_3 int, @flag int output, @msg varchar(4000) output) as declare @numcount int select   @numcount = count(*)  from ycuser where loginid = @loginid_2 and id <> @id_1 if @numcount =0 begin update ycuser set loginid = @loginid_2, logintype = @logintype_3 where id = @id_1 end else begin select 1 end

GO
alter procedure [Ycuser_Insert] (@id_1 int, @loginid_2 varchar(4000), @logintype_3 int, @flag int output, @msg varchar(4000) output) as declare @numcount int select   @numcount = count(*)  from ycuser where id= @id_1 if @numcount =0 begin declare @count int select   @count = count(*)  from ycuser where  loginid = @loginid_2 if @count =0 begin insert into ycuser (id, loginid, logintype) values (@id_1, @loginid_2, @logintype_3) end else begin select 1 end end

GO
alter procedure [Ycuser_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) as delete ycuser where id = @id_1

GO
alter procedure [worktask_RequestID_Update](@flag int output , @msg varchar(4000) output ) AS update worktask_requestsequence set requestid=requestid+1 select requestid from worktask_requestsequence

GO
alter procedure [WorkSpaceStyle_Set] ( @userId_1 int, @userType_1 char(1), @styleType_1 char(1), @flag integer output , @msg varchar(4000) output) AS IF EXISTS(SELECT userId FROM WorkSpaceStyle WHERE userId = @userId_1 AND userType = @userType_1) UPDATE WorkSpaceStyle SET styleType = @styleType_1 WHERE userId = @userId_1 AND userType = @userType_1 ELSE INSERT INTO WorkSpaceStyle (userId, userType, styleType) VALUES ( @userId_1, @userType_1, @styleType_1)

GO
alter procedure [WorkPlanValuate_ValManager] ( @workPlanId_1 int, @memberId_1 int, @managerScore_1 char(1), @managerId_1 int, @valManagerDate_1 char(10), @flag integer output , @msg varchar(4000) output) AS UPDATE WorkPlanValuate SET managerScore = @managerScore_1, managerId = @managerId_1, valManagerDate = @valManagerDate_1 WHERE workPlanId = @workPlanId_1 AND memberId = @memberId_1

GO
alter procedure [WorkPlanValuate_ValCreater] ( @workPlanId_1 int, @memberId_1 int, @createrScore_1 char(1), @createrId_1 int, @valCreaterDate_1 char(10), @flag integer output , @msg varchar(4000) output) AS INSERT INTO WorkPlanValuate ( workPlanId, memberId, createrScore, createrId, valCreaterDate) VALUES ( @workPlanId_1, @memberId_1, @createrScore_1, @createrId_1, @valCreaterDate_1)

GO
alter procedure [WorkTaskCreateShare_Insert] ( @taskid	int, @sharetype	int, @seclevel	tinyint, @rolelevel	tinyint, @userid	int, @subcompanyid	int, @departmentid	int, @roleid	int, @foralluser	tinyint, @flag	int output, @msg	varchar(4000)	output ) as insert into WorkTaskCreateShare (taskid,sharetype,seclevel,rolelevel,userid,subcompanyid,departmentid,roleid,foralluser) values (@taskid,@sharetype,@seclevel,@rolelevel,@userid,@subcompanyid,@departmentid,@roleid,@foralluser)

GO
alter procedure [WorkTaskCreateShare_Delete] (@id	int, @flag	int output, @msg	varchar(4000)	output) as delete from WorkTaskCreateShare where id=@id

GO
alter procedure [WorkPlanShareSet_Insert] (@reportid_1       int, @sharetype_1	int, @seclevel_1	int, @rolelevel_1	int, @sharelevel_1	int, @userid_1	varchar(4000), @subcompanyid_1	varchar(4000), @departmentid_1	varchar(4000), @roleid_1	int, @foralluser_1	int, @sharetype_2	int, @seclevel_2	int, @rolelevel_2	int, @userid_2	varchar(4000), @subcompanyid_2	varchar(4000), @departmentid_2	varchar(4000), @roleid_2	int, @foralluser_2	int, @settype_1	int, @seclevelMax_1	int, @sseclevelMax_1	int, @flag  	int output, @msg 	varchar output) as insert into WorkPlanShareSet(planid,sharetype,seclevel,rolelevel,sharelevel,userid,subcompanyid, departmentid,roleid,foralluser,ssharetype,sseclevel,srolelevel,suserid,ssubcompanyid,sdepartmentid,sroleid,sforalluser,settype,seclevelMax,sseclevelMax) values(@reportid_1,@sharetype_1,@seclevel_1,@rolelevel_1,@sharelevel_1,@userid_1,@subcompanyid_1,@departmentid_1,@roleid_1,@foralluser_1,@sharetype_2, @seclevel_2,@rolelevel_2,@userid_2,@subcompanyid_2,@departmentid_2,@roleid_2,@foralluser_2,@settype_1,@seclevelMax_1,@sseclevelMax_1)

GO
alter procedure [FnaTransactionDetail_Insert] (@tranid_1 	[int], @ledgerid_2 	[int], @tranaccount_3 	[decimal](18,3), @trandefaccount_3 	[decimal](18,3), @tranbalance_4 	[char](1), @tranremark_5 	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output )  AS INSERT INTO [FnaTransactionDetail] ( [tranid], [ledgerid], [tranaccount], [trandefaccount], [tranbalance], [tranremark])  VALUES ( @tranid_1, @ledgerid_2, @tranaccount_3, @trandefaccount_3 , @tranbalance_4, @tranremark_5)

GO
alter procedure [WorkPlanSetup_SetRecCount] ( @userId_1 int, @reportType_1 char(1), @recCount_1 int, @flag integer output , @msg varchar(4000) output) AS IF EXISTS (SELECT userId FROM WorkPlanSetup WHERE userId = @userId_1 AND reportType = @reportType_1) UPDATE WorkPlanSetup SET recCount = @recCount_1 ELSE INSERT INTO WorkPlanSetup (userId, reportType, recCount) VALUES ( @userId_1, @reportType_1, @recCount_1)

GO
alter procedure [WorkPlanShare_Insert] ( @workid_1 [int]  , @userid_1 [int]   , @usertype_1 [int]   , @sharelevel_1 [int]   , @flag integer output, @msg varchar(4000) output)  AS  INSERT INTO [WorkPlanShareDetail] (workid , userid , usertype , sharelevel) VALUES (@workid_1 , @userid_1 , @usertype_1 , @sharelevel_1)

GO
alter procedure [WorkPlanShare_Ins] ( @workPlanId_1 int, @shareType_1 char(1), @userId_1 varchar(4000), @subCompanyID_1 varchar(4000), @deptId_1 varchar(4000), @roleId_1 varchar(4000), @forAll_1 char(1), @roleLevel_1 char(1), @securityLevel_1 tinyint, @shareLevel_1 char(1), @securityLevelMax_1 tinyint, @flag integer output , @msg varchar(4000) output ) AS  INSERT INTO WorkPlanShare ( workPlanId, shareType, userId, subCompanyID, deptId, roleId, forAll, roleLevel, securityLevel, shareLevel, securityLevelMax ) VALUES ( @workPlanId_1, @shareType_1, @userId_1, @subCompanyID_1, @deptId_1, @roleId_1, @forAll_1, @roleLevel_1, @securityLevel_1, @shareLevel_1, @securityLevelMax_1 )

GO
alter procedure [WorkPlanShare_DelById] ( @workid_1 [int]  , @flag integer output, @msg varchar(4000) output)  AS delete WorkPlanShareDetail where workid = @workid_1

GO
alter procedure [workflow_NodeGroup_SelectByid] @id	int, @flag integer output , @msg varchar(4000) output AS select * from workflow_nodegroup where id=@id

GO
alter procedure [workflow_NodeGroup_Select] @nodeid	int, @flag integer output , @msg varchar(4000) output AS select * from workflow_nodegroup where nodeid=@nodeid order by id

GO
alter procedure [workflow_nodegroup_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output )  AS DELETE [workflow_nodegroup]  WHERE ( [id]	 = @id_1) set @flag = 0 set @msg = '查询存储过程成功'

GO
alter procedure [FnaCurrencyExchange_SByLast] @flag integer output , @msg varchar(4000) output AS declare @thecurrencyid int, @defcurrencyid int, @fnayearperiodsid char(6) , @endexchangerage varchar(4000) create table #temp( defcurrencyid  int , thecurrencyid  int, endexchangerage       varchar(4000) )  declare currencyid_cursor cursor for select thecurrencyid , max(fnayearperiodsid) from  FnaCurrencyExchange group by thecurrencyid  open currencyid_cursor fetch next from currencyid_cursor into @thecurrencyid,@fnayearperiodsid while @@fetch_status=0 begin select @defcurrencyid = defcurrencyid , @endexchangerage=endexchangerage from FnaCurrencyExchange where thecurrencyid= @thecurrencyid and fnayearperiodsid=@fnayearperiodsid  insert into #temp values(@defcurrencyid,@thecurrencyid,@endexchangerage) fetch next from currencyid_cursor into @thecurrencyid,@fnayearperiodsid end close currencyid_cursor deallocate currencyid_cursor  select * from #temp

GO
alter procedure [FnaCurrencyExchange_SByCurrenc] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from FnaCurrencyExchange where thecurrencyid = @id_1 order by fnayearperiodsid desc

GO
alter procedure [FnaCurrencyExchange_Insert] (@defcurrencyid_1 	[int], @thecurrencyid_2 	[int], @fnayear_3 	[char](4), @periodsid_4 	[int], @fnayearperiodsid_5 	[char](6), @avgexchangerate_6 	varchar(4000), @endexchangerage_7 	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output )  AS declare @count integer declare @isclose char(1)  select @count = count(id) from FnaCurrencyExchange where fnayearperiodsid = @fnayearperiodsid_5 and thecurrencyid = @thecurrencyid_2  if @count <> 0 begin select -1 return end  select @isclose = isclose from FnaYearsPeriodsList where fnayear = @fnayear_3  and Periodsid = @periodsid_4  if @isclose = '1' begin select -2 return end  INSERT INTO [FnaCurrencyExchange] ( [defcurrencyid], [thecurrencyid], [fnayear], [periodsid], [fnayearperiodsid], [avgexchangerate], [endexchangerage])  VALUES ( @defcurrencyid_1, @thecurrencyid_2, @fnayear_3, @periodsid_4, @fnayearperiodsid_5, @avgexchangerate_6, @endexchangerage_7)  select max(id) from FnaCurrencyExchange

GO
alter procedure [FnaCurrencyExchange_Delete] (@id_1 	[int], @fnayear_2 	[char](4), @periodsid_3 	[int], @flag                             integer output, @msg                             varchar(4000) output )  AS  declare @isclose char(1) select @isclose = isclose from FnaYearsPeriodsList where fnayear = @fnayear_2  and Periodsid = @periodsid_3  if @isclose = '1' begin select -1 return end  DELETE [FnaCurrencyExchange] WHERE ( [id]	 = @id_1 )

GO
alter procedure [Workflow_QueryType_Update] ( @id_1 	int, @typename_2 	varchar(4000), @typenamemark_3 	text, @showorder_4 	decimal(10, 2), @flag	int	output, @msg	varchar(4000)	output) AS UPDATE workflow_customQuerytype  SET  typename = @typename_2, typenamemark = @typenamemark_3, showorder = @showorder_4  WHERE (id= @id_1)

GO
alter procedure [Workflow_QueryType_Insert] ( @typename_1 	varchar(4000), @typenamemark_2 text, @showorder_3 	decimal(10, 2), @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO workflow_customQuerytype (typename, typenamemark, showorder)  VALUES ( @typename_1, @typenamemark_2, @showorder_3)

GO
alter procedure [Workflow_QueryType_Delete] ( @id_1 	int, @flag	int	output, @msg	varchar(4000)	output) AS declare @count integer select @count = count(id) from Workflow_Custom where Querytypeid = @id_1 if (@count > 0) begin select 0 return end else begin DELETE workflow_customQuerytype WHERE ( id = @id_1) end

GO
alter procedure [workflow_NodeType_Select] @workflowid	int, @nodeid	int, @flag integer output , @msg varchar(4000) output AS select nodetype from workflow_flownode where workflowid=@workflowid and nodeid=@nodeid

GO
alter procedure [Workflow_RepDspFld_Insert_New] (@reportid_1    [int], @dsporder_3  varchar(4000), @isstat_4    [char](1), @dborder_5     char(1) , @dbordertype_6     char(1), @compositororder_7  [int], @fieldidbak_8 [int], @reportcondition_9 [int], @fieldwidth_10 [numeric](10,2),@valueone_11 varchar(4000),@valuetwo_12 varchar(4000),@valuethree_13 varchar(4000),@valuefour_14 varchar(4000),@httype_15 varchar(4000),@htdetailtype_16 varchar(4000), @flag   [int]   output, @msg    varchar(4000)   output) AS INSERT INTO [Workflow_ReportDspField] ( [reportid], [dsporder], [isstat], [dborder],[dbordertype],[compositororder],[fieldidbak],[reportcondition],[fieldwidth],[valueone],[valuetwo],[valuethree],[valuefour],[httype],[htdetailtype]) VALUES ( @reportid_1, @dsporder_3, @isstat_4, @dborder_5, @dbordertype_6,@compositororder_7, @fieldidbak_8 ,@reportcondition_9 ,@fieldwidth_10,@valueone_11,@valuetwo_12,@valuethree_13,@valuefour_14,@httype_15,@htdetailtype_16)

GO
alter procedure [bill_HireResource_UpdateStatus] @id		int, @status	char(1), @flag integer output , @msg varchar(4000) output as update bill_HireResource set status=@status where id=@id

GO
alter procedure [Bill_HireResource_SelectByID] @id		int, @flag integer output , @msg varchar(4000) output as select * from bill_HireResource where id=@id

GO
alter procedure [Workflow_CustomDspField_Insert] (@reportid_1    int, @fieldid_2   int,  @dborder_3     char(1) , @shows char(1), @compositororder  varchar(4000),@queryorder int, @flag   int   output, @msg    varchar(4000)   output) AS INSERT INTO Workflow_CustomDspField ( customid, fieldid, ifquery, ifshow,showorder,queryorder) VALUES ( @reportid_1, @fieldid_2, @dborder_3, @shows, @compositororder,@queryorder)

GO
alter procedure [Workflow_CustomDspField_Init] (@reportid_1    int, @flag   int   output, @msg    varchar(4000)   output) AS  begin  INSERT INTO Workflow_CustomDspField ( customid, fieldid, ifquery, ifshow,showorder,queryorder) VALUES ( @reportid_1, -9,'0','1',9,9) ; INSERT INTO Workflow_CustomDspField ( customid, fieldid, ifquery, ifshow,showorder,queryorder) VALUES ( @reportid_1, -8,'0','1',8,8) ; INSERT INTO Workflow_CustomDspField ( customid, fieldid, ifquery, ifshow,showorder,queryorder) VALUES ( @reportid_1, -7,'0','1',7,7) ; INSERT INTO Workflow_CustomDspField ( customid, fieldid, ifquery, ifshow,showorder,queryorder) VALUES ( @reportid_1, -6,'0','1',6,6) ; INSERT INTO Workflow_CustomDspField ( customid, fieldid, ifquery, ifshow,showorder,queryorder) VALUES ( @reportid_1, -5,'1','1',5,5) ; INSERT INTO Workflow_CustomDspField ( customid, fieldid, ifquery, ifshow,showorder,queryorder) VALUES ( @reportid_1, -4,'1','1',4,4) ; INSERT INTO Workflow_CustomDspField ( customid, fieldid, ifquery, ifshow,showorder,queryorder) VALUES ( @reportid_1, -3,'1','1',3,3) ; INSERT INTO Workflow_CustomDspField ( customid, fieldid, ifquery, ifshow,showorder,queryorder) VALUES ( @reportid_1, -2,'1','1',2,2) ; INSERT INTO Workflow_CustomDspField ( customid, fieldid, ifquery, ifshow,showorder,queryorder) VALUES ( @reportid_1, -1,'1','1',1,1) ; end

GO
alter procedure [Bill_ExpenseDetali_SelectByID] (@id [int], @flag integer output , @msg varchar(4000) output) AS select *  from Bill_ExpenseDetail where expenseid=@id order by rowno

GO
alter procedure [Bill_ExpenseDetail_Insert] @expenseid_1        int, @relatedate_1       char(10), @feetypeid_1        int, @detailremark_1     varchar(4000), @accessory_1        int, @relatedcrm_1       int, @relatedproject_1   int, @feesum_1           decimal(15,3), @realfeesum_1       decimal(15,3), @invoicenum_1       varchar(4000), @rowno_1            int, @relaterequest_1    int, @flag               int             output, @msg                varchar(4000)     output as insert into bill_expensedetail (expenseid,relatedate,feetypeid,detailremark,accessory,relatedcrm,relatedproject,feesum,realfeesum,invoicenum,rowno,relaterequest) values (@expenseid_1,@relatedate_1,@feetypeid_1,@detailremark_1,@accessory_1,@relatedcrm_1,@relatedproject_1,@feesum_1,@realfeesum_1,@invoicenum_1,@rowno_1,@relaterequest_1)

GO
alter procedure [Bill_ExpenseDetail_Delete] (@expenseid_1 	[int], @flag integer output , @msg varchar(4000) output)  AS DELETE [Bill_ExpenseDetail]  WHERE ( [expenseid]	 = @expenseid_1)

GO
alter procedure [workflow_FieldLabel_Select] @formid		int, @flag integer output , @msg varchar(4000) output AS select t1.* from workflow_fieldlable t1,workflow_formfield t2 where t1.formid=t2.formid and t1.fieldid=t2.fieldid and (t2.isdetail<>'1' or t2.isdetail is null) and t1.formid=@formid and t1.isdefault='1' order by t2.fieldid

GO
alter procedure [workflow_FieldID_Select]  @formid		int, @flag integer output , @msg varchar(4000) output AS select fieldid,fieldorder,isdetail from workflow_formfield where formid=@formid and (isdetail<>'1' or isdetail is null) order by fieldid

GO
alter procedure [workflow_formFieldRt_S] @formid		int, @nodeid		int, @flag integer output , @msg varchar(4000) output AS  select distinct a.fieldid,a.fieldorder,a.isdetail,b.isedit from workflow_formfield a, workflow_nodeform b where formid=@formid and (isdetail<>'1' or isdetail is null) and a.fieldid=b.fieldid and b.nodeid=@nodeid order by a.fieldid

GO
alter procedure [Workflow_formdetailinfo_Sel] @formid int, @flag integer output , @msg varchar(4000) output AS SELECT * FROM Workflow_formdetailinfo where formid = @formid

GO
alter procedure [workflow_FieldValue_Select] @requestid	int, @flag integer output , @msg varchar(4000) output AS select * from workflow_form where requestid=@requestid

 GO
alter procedure [workflow_form_SByRequestid] (@requestid 	int, @flag integer output, @msg varchar(4000) output) AS select * from workflow_form where requestid=@requestid

GO
alter procedure [Workflow_DocShareInfo_S] (@docid int, @workflowId int, @requestId int, @nodeId int, @userid int,@beAgentid int, @sharelevel int, @flag int output, @msg varchar(4000) output) as  select userid from Workflow_DocShareInfo where docid=@docid and workflowId=@workflowId and requestId=@requestId and nodeId=@nodeId and userid=@userid and beAgentid=@beAgentid and sharelevel=@sharelevel

GO
alter procedure [Workflow_DocShareInfo_I] (@docid  int, @workflowId	int, @requestId	int, @nodeId int, @userid	int,@beAgentid int, @sharelevel int, @flag	int output, @msg	varchar(4000)	output) as insert into Workflow_DocShareInfo(docid,workflowId,requestId,nodeId,userid,beAgentid,sharelevel)  values(@docid,@workflowId,@requestId,@nodeId,@userid,@beAgentid,@sharelevel)

GO
alter procedure [FnaBudgetfeeType_Insert] @name_1	varchar(4000), @feeperiod_1	int, @feetype_1	int, @agreegap_1	int, @description_1	varchar(4000), @feelevel_1	int, @alertvalue_1 int, @supsubject_1 int, @flag	int	output, @msg	varchar(4000) output as insert into fnaBudgetfeetype (name,feeperiod,feetype,agreegap,description,feelevel,alertvalue,supsubject) values (@name_1,@feeperiod_1,@feetype_1,@agreegap_1,@description_1,@feelevel_1,@alertvalue_1,@supsubject_1)

GO
alter procedure [FnaBudgetfeeType_Delete] @id int, @flag int output, @msg varchar(4000) output AS IF EXISTS (SELECT feetypeid FROM bill_expensedetail WHERE feetypeid = @id) OR EXISTS (SELECT id FROM FnaBudgetInfoDetail WHERE budgettypeid = @id) OR EXISTS (SELECT id FROM FnaBudgetCheckDetail WHERE budgettypeid = @id) OR EXISTS (SELECT id FROM FnaBudgetfeeType WHERE supsubject = @id) OR EXISTS (SELECT id FROM FnaExpenseInfo WHERE subject = @id) OR EXISTS (SELECT id FROM Bill_FnaWipeApplyDetail WHERE subject = @id) OR EXISTS (SELECT id FROM Bill_FnaBudgetChgApplyDetail WHERE subject=@id) BEGIN SELECT -1 RETURN END DELETE fnaBudgetfeetype WHERE id = @id

  GO
alter procedure [HrmAwardInfo_Insert] (@rptitle_2 varchar(4000), @resourseid_3 varchar(4000), @rptypeid_4 int, @rpdate_5 char(10), @rpexplain_6 varchar(4000), @rptransact_7 varchar(4000), @flag int output, @msg varchar(4000) output) AS insert into HrmAwardInfo (rptitle,resourseid,rptypeid,rpdate,rpexplain,rptransact) values (@rptitle_2,@resourseid_3,@rptypeid_4,@rpdate_5,@rpexplain_6,@rptransact_7)

 GO
alter procedure [HrmAwardInfo_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) AS DELETE HrmAwardInfo WHERE id = @id_1

GO
alter procedure [HrmArrangeShiftInfo_Save] ( @resourceid_2 int , @shiftdate_3 char (10) , @shiftid_4 int	, @flag        integer output, @msg         varchar(4000) output) AS declare @count int select @count = count(shiftid) from HrmArrangeShiftInfo where  resourceid=@resourceid_2 and shiftdate = @shiftdate_3 and shiftid=@shiftid_4 if @count is null or @count = 0 INSERT INTO HrmArrangeShiftInfo(resourceid,shiftdate,shiftid) VALUES(@resourceid_2,@shiftdate_3, @shiftid_4)

GO
alter procedure [HrmArrangeShiftInfo_Insert]( @resourceid_1 int , @shiftdate_2 char (10) , @shiftid_3 int	, @flag        integer output , @msg         varchar(4000) output) AS INSERT INTO HrmArrangeShiftInfo ( resourceid , shiftdate, shiftid) VALUES ( @resourceid_1, @shiftdate_2, @shiftid_3) select max(id) from HrmArrangeShiftInfo

GO
alter procedure [HrmActivitiesCompetency_Select] (@jobactivityid_1 	[int], @flag integer output, @msg varchar(4000) output )  AS select * from  [HrmActivitiesCompetency] where jobactivityid =convert(int, @jobactivityid_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmActivitiesCompetency_Insert] (@jobactivityid_1 	[int], @competencyid_2 	[int], @flag integer output, @msg varchar(4000) output )  AS INSERT INTO [HrmActivitiesCompetency] ( [jobactivityid], [competencyid])  VALUES ( @jobactivityid_1, @competencyid_2) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmActivitiesCompetency_Delete] (@jobactivityid_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [HrmActivitiesCompetency] WHERE ( [jobactivityid]	 = @jobactivityid_1) if @@error<>0 begin set @flag=1 set @msg='删除储存过程失败' return end else begin set @flag=0 set @msg='删除储存过程成功' return end

GO
alter procedure [HrmArrangeShift_Updatehistory] ( @id_1 	int, @shiftname_2 	 varchar(4000), @shiftbegintime_3 char(5), @shiftendtime_4   char(5), @validedatefrom_5 char(10), @validedateto_6   char(10), @flag        integer output, @msg         varchar(4000) output) AS UPDATE HrmArrangeShift SET  shiftname = @shiftname_2, shiftbegintime = @shiftbegintime_3, shiftendtime = @shiftendtime_4, validedatefrom = @validedatefrom_5 , validedateto = '9999-12-31' WHERE ( id	 = @id_1)

GO
alter procedure [HrmArrangeShift_Update] ( @id_1 	int, @shiftname_2 	 varchar(4000), @shiftbegintime_3 char(5), @shiftendtime_4   char(5), @validedatefrom_5  char(10), @flag        integer output, @msg         varchar(4000) output) AS UPDATE HrmArrangeShift SET  shiftname = @shiftname_2, shiftbegintime = @shiftbegintime_3, shiftendtime = @shiftendtime_4 , validedatefrom = @validedatefrom_5 WHERE ( id	 = @id_1)

GO
alter procedure [HrmArrangeShift_UHistory] ( @id_1 	int, @validedatefrom_5 char(10), @flag        integer output, @msg         varchar(4000) output) AS UPDATE HrmArrangeShift SET  validedateto = @validedatefrom_5, ishistory = '1' WHERE ( id	 = @id_1)

GO
alter procedure [HrmArrangeShift_SelectById] (@flag integer output, @msg varchar(4000) output ) AS select id , shiftname , shiftbegintime, shiftendtime,validedatefrom,validedateto from HrmArrangeShift where ishistory='0' order by id desc

 GO
alter procedure [HrmArrangeShift_SelectAll] (@ishistory_1 char(1), @flag integer output, @msg varchar(4000) output ) AS select * from HrmArrangeShift where ishistory = @ishistory_1 order by id

GO
alter procedure [HrmArrangeShift_Select_Default] (@id_1 int , @flag integer output, @msg varchar(4000) output ) AS select * from HrmArrangeShift where id = @id_1

GO
alter procedure [HrmArrangeShift_Select] (@flag integer output, @msg varchar(4000) output ) AS select id , shiftbegintime, shiftendtime from HrmArrangeShift order by shiftbegintime

GO
alter procedure [HrmArrangeShift_Insert] ( @shiftname_2 	 varchar(4000), @shiftbegintime_3 char(5), @shiftendtime_4 char(5), @validedatefrom_5  char(10), @validedateto_6 char(10), @flag        integer output, @msg         varchar(4000) output) AS INSERT INTO HrmArrangeShift ( shiftname , shiftbegintime, shiftendtime, validedatefrom, validedateto) VALUES ( @shiftname_2, @shiftbegintime_3, @shiftendtime_4, @validedatefrom_5, @validedateto_6) select max(id) from HrmArrangeShift

GO
alter procedure [HrmArrangeShift_Delete] (@id_1 	int, @flag        integer output, @msg         varchar(4000) output) AS DELETE HrmArrangeShift WHERE ( id	 = @id_1)

 GO
alter procedure [HrmApplyRemark_Select] @applyid		int, @flag                             integer output, @msg                             varchar(4000) output AS select * from HrmApplyRemark where applyid = @applyid

GO
alter procedure [HrmApplyRemark_Insert] (@applyid_1 	[int], @remark_2 	varchar(4000), @resourceid_3 	[int], @date_4 	[char](10), @time_5 	[char](8), @flag integer output , @msg varchar(4000) output  )  AS INSERT INTO [HrmApplyRemark] ( [applyid], [remark], [resourceid], [date_n], [time])  VALUES ( @applyid_1, @remark_2, @resourceid_3, @date_4, @time_5)

GO
alter procedure [HtmlNoteInfo_Insert] @id		int, @notename	varchar(4000), @langid		int, @flag		int	output, @msg		varchar(4000) output as insert into HtmlNoteInfo (indexid,notename,languageid) values (@id,@notename,@langid)

GO
alter procedure [Workflow_DocSource_Insert] @requestid	int, @nodeid		int, @fieldid	int, @docid		int, @userid		int, @usertype	int, @flag 		integer 	output , @msg 		varchar(4000) 	output AS declare @mcount int select @mcount=count(*) from Workflow_DocSource where requestid =@requestid and fieldid =@fieldid and docid=@docid  if @mcount=0 insert into Workflow_DocSource(requestId,nodeId,fieldId,docId,userId,userType) values(@requestid,@nodeid,@fieldid,@docid,@userid,@usertype)

GO
alter procedure [HtmlNoteIndex_Insert] @id		int, @indexdesc	varchar(4000), @flag		int	output, @msg		varchar(4000) output as insert into HtmlNoteIndex (id,indexdesc) values (@id,@indexdesc)

 GO
alter procedure [HtmlLabelInfo_Insert] @id		int, @labelname	varchar(4000), @langid		int, @flag		int	output, @msg		varchar(4000) output as insert into HtmlLabelInfo (indexid,labelname,languageid) values (@id,@labelname,@langid)

GO
alter procedure [HtmlLabelInfo_GetIndexId] (@labelname_1 	varchar ) AS select indexid from HtmlLabelInfo WHERE 	( labelname	 = @labelname_1)

GO
alter procedure [Workflow_formdetailfield_Sel] @formid int, @nodeid int, @groupid int, @flag integer output , @msg varchar(4000) output AS SELECT  formfield.fieldid,formfield.fieldorder, fieldlable.fieldlable,fieldlable.langurageid, nodeform.isview,nodeform.isedit,nodeform.ismandatory, dictdetail.fieldname,dictdetail.fielddbtype,dictdetail.fieldhtmltype,dictdetail.type,dictdetail.childfieldid FROM   Workflow_formfield formfield, Workflow_nodeform nodeform, Workflow_fieldlable fieldlable, Workflow_formdictdetail dictdetail where formfield.formid = @formid and nodeform.nodeid = @nodeid and formfield.fieldid = nodeform.fieldid and formfield.fieldid = fieldlable.fieldid and formfield.formid = fieldlable.formid and formfield.fieldid = dictdetail.id and formfield.isdetail = '1' and formfield.groupId = @groupid   	       Order by formfield.fieldorder

GO
alter procedure [HrmAbsense1_Update] (@id_1 	[int], @departmentid_2 	[int], @resourceid_3 	[int], @absenseremark_4 	[text], @startdate_5 	[char](10), @starttime_6 	[char](8), @enddate_7 	[char](10), @endtime_8 	[char](8), @absenseday_9 	[decimal](10,2), @workflowid_10 	[int], @workflowname_11 	varchar(4000), @usestatus_12 	[char](1), @flag                   integer output, @msg                   varchar(4000) output )  AS UPDATE [Bill_HrmResourceAbsense]  SET  [departmentid]	 = @departmentid_2, [resourceid]	 = @resourceid_3, [absenseremark]	 = @absenseremark_4, [startdate]	 = @startdate_5, [starttime]	 = @starttime_6, [enddate]	 = @enddate_7, [endtime]	 = @endtime_8, [absenseday]	 = @absenseday_9, [workflowid]	 = @workflowid_10, [workflowname]	 = @workflowname_11, [usestatus]	 = @usestatus_12  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmAbsense1_SelectByResourceID] @resourceid varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from Bill_HrmResourceAbsense where resourceid =convert(int, @resourceid) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmAbsense1_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from Bill_HrmResourceAbsense where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [ImageFile_SByBackup] (@imagefileid_1 	int, @flag int output, @msg varchar(4000) output)  AS select imagefileid, filerealpath from ImageFile where imagefileid > @imagefileid_1 and ( filerealpath is not null or filerealpath <> '' ) order by imagefileid

GO
alter procedure [ImageFile_Insert_New] (@imagefileid_1   int, @imagefilename_2   varchar(4000), @imagefiletype_3   varchar(4000), @imagefileused_4   int, @filerealpath_5   varchar(4000), @iszip_6 char(1) , @isencrypt_7   char(1) , @fileSize_8  varchar(4000) , @isaesencrypt_9 int, @aescode_10 varchar(4000),  @flag int output, @msg varchar(4000) output) AS INSERT INTO ImageFile ( imagefileid, imagefilename, imagefiletype, imagefileused, filerealpath, iszip, isencrypt, filesize, isaesencrypt, aescode)  VALUES ( @imagefileid_1, @imagefilename_2, @imagefiletype_3, @imagefileused_4, @filerealpath_5, @iszip_6, @isencrypt_7, @fileSize_8, @isaesencrypt_9, @aescode_10);

GO
alter procedure [ImageFile_Insert] (@imagefileid_1 	int, @imagefilename_2 	varchar(4000), @imagefiletype_3 	varchar(4000), @imagefileused_4 	int, @filerealpath_5 	varchar(4000), @iszip_6 char(1) , @isencrypt_7 	char(1) , @fileSize_8  varchar(4000) , @flag int output, @msg varchar(4000) output)  AS INSERT INTO ImageFile ( imagefileid, imagefilename, imagefiletype, imagefileused, filerealpath, iszip, isencrypt, filesize)  VALUES ( @imagefileid_1, @imagefilename_2, @imagefiletype_3, @imagefileused_4, @filerealpath_5, @iszip_6, @isencrypt_7, @fileSize_8)

GO
alter procedure [ImageFile_DeleteByImagefileID] (@imagefileid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS delete from ImageFile where imagefileid = @imagefileid_1

GO
alter procedure [imagefile_DeleteByDoc] ( @fileid 	int, @flag	[int]	output, @msg	varchar(4000)	output) AS  update imagefile set imagefileused=imagefileused-1 where imagefileid= @fileid select filerealpath from  ImageFile where imagefileid=@fileid and imagefileused = 0 delete ImageFile where imagefileid=@fileid and imagefileused = 0

GO
alter procedure [imagefile_AddByDoc] (@fileid 	int, @flag	[int]	output, @msg	varchar(4000)	output)  AS update imagefile set imagefileused=imagefileused+1 where imagefileid= @fileid

GO
alter procedure [WorkFlow_BillField_DelByBill] (@billid_1 int, @flag int output, @msg varchar(4000) output) AS DELETE workflow_billfield WHERE ( billid	 = @billid_1)

GO
alter procedure [T_OutReportShare_Insert] (@outrepid_1 	int, @userid_2 	int, @usertype_3 	char(1) , @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO T_OutReportShare ( outrepid, userid, usertype)  VALUES ( @outrepid_1, @userid_2, @usertype_3)

GO
alter procedure [T_OutReportShare_Delete] (@outrepshareid_1 	int , @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_OutReportShare  WHERE ( outrepshareid	 = @outrepshareid_1)

GO
alter procedure [WorkFlow_Bill_Update] (@id_1 	int, @namelabel_2 int, @tablename_3	varchar(4000), @createpage_4 varchar(4000), @managepage_5 	varchar(4000),	 @viewpage_6 	varchar(4000),	 @detailtablename_7 	varchar(4000), @detailkeyfield_8 	varchar(4000), @operationpage_9 	varchar(4000), @flag int output,	 @msg varchar(4000) output ) AS UPDATE workflow_bill SET  namelabel = @namelabel_2, tablename = @tablename_3, createpage = @createpage_4, managepage = @managepage_5, viewpage = @viewpage_6, detailtablename = @detailtablename_7, detailkeyfield	 = @detailkeyfield_8, operationpage= @operationpage_9 WHERE 	( id	 = @id_1)

GO
alter procedure [WorkFlow_Bill_Search] (@labelname 	varchar(4000), @flag integer output ,   @msg varchar(4000) output) AS select id from  workflow_bill WHERE ( namelabel	 = (select indexid from HtmlLabelInfo where labelname= @labelname))

GO
alter procedure [WorkFlow_Bill_Insert] (@id_1 	int, @namelabel_2 int, @tablename_3	varchar(4000),	 @createpage_4 	varchar(4000), @managepage_5 	varchar(4000),	 @viewpage_6 	varchar(4000),	 @detailtablename_7 	varchar(4000), @detailkeyfield_8 	varchar(4000), @operationpage_9 	varchar(4000), @flag int output,	 @msg varchar(4000)  output) AS INSERT INTO workflow_bill ( id, namelabel, tablename, createpage, managepage, viewpage, detailtablename, detailkeyfield,operationpage) VALUES ( @id_1, @namelabel_2, @tablename_3, @createpage_4, @managepage_5, @viewpage_6,	 @detailtablename_7, @detailkeyfield_8,@operationpage_9)

GO
alter procedure [WorkFlow_Bill_Delete] (@id_1 	int, @flag int output, @msg varchar(4000) output) AS DELETE workflow_bill WHERE ( id	 = @id_1)

GO
alter procedure [T_OutRICdinate_SelectByItemid]( @itemid int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_OutReportItemCoordinate where itemid = @itemid

GO
alter procedure [T_OutReportStatitem_Uorder] (@outrepitemid_1 	int, @upordown  	int, @flag	int	output, @msg	varchar(4000)	output)  AS declare @thedsporder int , @theoutrepid int select @thedsporder = dsporder , @theoutrepid = outrepid from T_OutReportStatitem where outrepitemid = @outrepitemid_1  if @upordown = 1 begin update T_OutReportStatitem set dsporder = dsporder+1 where outrepid = @theoutrepid and dsporder = @thedsporder-1 update T_OutReportStatitem set dsporder = dsporder-1 where outrepitemid = @outrepitemid_1 end else begin update T_OutReportStatitem set dsporder = dsporder-1 where outrepid = @theoutrepid and dsporder = @thedsporder+1 update T_OutReportStatitem set dsporder = dsporder+1 where outrepitemid = @outrepitemid_1 end

GO
alter procedure [T_OutReportStatitem_SById] (@outrepid_1 int , @flag	int	output, @msg	varchar(4000)	output)  AS select * from T_OutReportStatitem where outrepid = @outrepid_1 order by dsporder

GO
alter procedure [T_OutReportStatitem_Insert] (@outrepid_1 	int, @statitemid_2     int, @flag	int	output, @msg	varchar(4000)	output)  AS declare @maxdsporder int select @maxdsporder = max(dsporder) from T_OutReportStatitem where outrepid = @outrepid_1 if @maxdsporder is null or @maxdsporder = 0 set @maxdsporder = 1 else set @maxdsporder = @maxdsporder + 1  INSERT INTO T_OutReportStatitem ( outrepid, statitemid, dsporder)  VALUES ( @outrepid_1, @statitemid_2, @maxdsporder)

GO
alter procedure [T_OutReportStatitem_Delete] (@outrepitemid_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS declare @thedsporder int , @theoutrepid int select @thedsporder = dsporder , @theoutrepid = outrepid from T_OutReportStatitem where outrepitemid = @outrepitemid_1  update T_OutReportStatitem set dsporder = dsporder-1 where outrepid = @theoutrepid and dsporder > @thedsporder  Delete T_OutReportStatitem where outrepitemid = @outrepitemid_1

GO
alter procedure [T_OutReportItemTable_Insert] (@itemid_1 	int, @itemtable     varchar(4000), @itemtablealter  varchar(4000), @flag	int	output, @msg	varchar(4000)	output)  AS  INSERT INTO T_OutReportItemTable ( itemid, itemtable, itemtablealter)  VALUES ( @itemid_1, @itemtable, @itemtablealter)

GO
alter procedure [T_OutReportItemTable_Delete] (@itemid 	int , @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_OutReportItemTable  WHERE ( itemid	 = @itemid)

GO
alter procedure [T_OutReportICoordinate_Insert]( @itemid_1 	int, @coordinatename     varchar(4000), @coordinatevalue  varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO T_OutReportItemCoordinate ( itemid, coordinatename, coordinatevalue) VALUES ( @itemid_1, @coordinatename, @coordinatevalue)

GO
alter procedure [T_OutReportCondition_Insert] (@outrepid_1 	int, @conditionid_2 	int , @conditioncnname_3 	varchar(4000) , @conditionenname_4 	varchar(4000) , @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO T_OutReportCondition ( outrepid, conditionid, conditioncnname , conditionenname)  VALUES ( @outrepid_1, @conditionid_2, @conditioncnname_3, @conditionenname_4)

GO
alter procedure [T_OutReportCondition_Delete] (@outrepconditionid_1 	int , @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_OutReportCondition  WHERE ( outrepconditionid	 = @outrepconditionid_1)

GO
alter procedure [T_OutReport_Update] (@outrepid_1 	int, @outrepname_2 	varchar(4000), @outrepdesc_3 	varchar(4000) , @modulefilename_5  varchar(4000) , @outreptype_6 char(1) , @outrepcategory_7 char(1) , @enmodulefilename_8  varchar(4000) , @outrepenname_9  varchar(4000) , @outrependesc_10  varchar(4000) , @autocolumn_11 char(1) , @autorow_12 char(1) , @flag	int	output, @msg	varchar(4000)	output)  AS UPDATE T_OutReport  SET  outrepname	 = @outrepname_2, outrepdesc	 = @outrepdesc_3, modulefilename	 = @modulefilename_5 , outreptype = @outreptype_6 , outrepcategory = @outrepcategory_7 , enmodulefilename	 = @enmodulefilename_8 , outrepenname	 = @outrepenname_9 , outrependesc	 = @outrependesc_10 , autocolumn	 = @autocolumn_11 , autorow	 = @autorow_12 WHERE ( outrepid	 = @outrepid_1)

GO
alter procedure [T_OutReport_SelectByUserid] (@userid int , @usertype char(1), @flag	int	output, @msg	varchar(4000)	output)  AS select a.* from T_OutReport a, T_OutReportShare b where a.outrepid = b.outrepid and b.userid=@userid and b.usertype = @usertype

GO
alter procedure [T_InputReportItemDetail_Insert] (@itemid_1 	int, @itemdsp_2 	varchar(4000), @itemvalue_3 	varchar(4000) , @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO T_InputReportItemDetail ( itemid, itemdsp, itemvalue)  VALUES ( @itemid_1, @itemdsp_2, @itemvalue_3)

GO
alter procedure [T_InputReportItemDetail_Delete] (@itemid_1 	int , @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_InputReportItemDetail  WHERE ( itemid	 = @itemid_1)

GO
alter procedure [T_InputReportItemClose_Insert] (@inprepid_1 	int, @itemid_2 	int, @crmid_3 	int , @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO T_InputReportItemClose ( inprepid, itemid, crmid)  VALUES ( @inprepid_1, @itemid_2, @crmid_3)

GO
alter procedure [T_InputReportItemClose_Delete] (@closeid_1 	int , @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_InputReportItemClose  WHERE ( closeid	 = @closeid_1)

GO
alter procedure [T_InputReportItem_Update] ( @itemid_1 	int, @itemdspname_2 	varchar(4000), @itemfieldname_3 	varchar(4000), @itemfieldtype_4 	char(1), @itemfieldscale_5 	int, @itemtypeid_6 	int, @itemexcelsheet_7 	varchar(4000), @itemexcelrow_8 	int, @itemexcelcolumn_9 	int , @itemfieldunit_10   varchar(4000) , @dsporder_11        decimal(15,2) , @itemgongsi_12 	text, @inputablefact_13 	char(1), @inputablebudg_14 	char(1), @inputablefore_15 	char(1), @flag	int	output, @msg	varchar(4000)	output) AS UPDATE T_InputReportItem SET itemdspname	 = @itemdspname_2, itemfieldname	 = @itemfieldname_3, itemfieldtype	 = @itemfieldtype_4, itemfieldscale	 = @itemfieldscale_5, itemtypeid	 = @itemtypeid_6, itemexcelsheet	 = @itemexcelsheet_7, itemexcelrow	 = @itemexcelrow_8, itemexcelcolumn	 = @itemexcelcolumn_9 , itemfieldunit = @itemfieldunit_10 , dsporder = @dsporder_11 , itemgongsi = @itemgongsi_12 , inputablefact = @inputablefact_13 , inputablebudg = @inputablebudg_14 , inputablefore = @inputablefore_15 WHERE ( itemid	 = @itemid_1)

GO
alter procedure [T_InputReportItem_Insert] ( @inprepid_1 	int, @itemdspname_2 	varchar(4000), @itemfieldname_3 	varchar(4000), @itemfieldtype_4 	char(1), @itemfieldscale_5 	int, @itemtypeid_6 	int, @itemexcelsheet_7 	varchar(4000), @itemexcelrow_8 	int, @itemexcelcolumn_9 	int , @itemfieldunit_10   varchar(4000) , @dsporder_11        decimal(15,2) , @itemgongsi_12 	text, @inputablefact_13 	char(1), @inputablebudg_14 	char(1), @inputablefore_15 	char(1), @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO T_InputReportItem ( inprepid, itemdspname, itemfieldname, itemfieldtype, itemfieldscale, itemtypeid, itemexcelsheet, itemexcelrow, itemexcelcolumn, itemfieldunit, dsporder, itemgongsi, inputablefact, inputablebudg, inputablefore) VALUES ( @inprepid_1, @itemdspname_2, @itemfieldname_3, @itemfieldtype_4, @itemfieldscale_5, @itemtypeid_6, @itemexcelsheet_7, @itemexcelrow_8, @itemexcelcolumn_9, @itemfieldunit_10, @dsporder_11, @itemgongsi_12, @inputablefact_13, @inputablebudg_14, @inputablefore_15)

GO
alter procedure [T_InputReportItem_Delete] (@itemid_1 	int , @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_InputReportItem  WHERE ( itemid	 = @itemid_1)

GO
alter procedure [T_OutReportItem_SelectByRowCol] (@outrepid int , @itemrow int , @itemcolumn int , @flag	int	output, @msg	varchar(4000)	output)  AS select * from T_OutReportItem where outrepid = @outrepid and itemrow = @itemrow and itemcolumn= @itemcolumn

GO
alter procedure [T_OutReportItem_SelectByItemid] (@itemid int , @flag	int	output, @msg	varchar(4000)	output)  AS select * from T_OutReportItem where itemid = @itemid

GO
alter procedure [T_OutReportItem_Insert] (@itemid_1 	int, @outrepid_2 	int, @itemrow_2 	int, @itemcolumn_2 	int, @itemtype       char(1), @itemexpress    text , @itemdesc       varchar(4000), @itemexpresstype char(1) , @picstatbudget char(1) , @picstatlast   char(1) , @picstat       char(1) , @itemmodtype       char(1) , @itemendesc       varchar(4000), @flag	int	output, @msg	varchar(4000)	output)  AS if @itemid_1 = 0 begin insert into T_OutReportItem(outrepid,itemrow,itemcolumn,itemtype,itemexpress,itemdesc, itemexpresstype, picstatbudget, picstatlast, picstat,itemtable,itemcondition,itemmodtype,itemendesc) values(@outrepid_2, @itemrow_2, @itemcolumn_2, @itemtype, @itemexpress, @itemdesc, @itemexpresstype, @picstatbudget, @picstatlast, @picstat, '', '', @itemmodtype, @itemendesc) select @itemid_1 = max(itemid) from T_OutReportItem end  else begin update T_OutReportItem set itemtype = @itemtype , itemexpress = @itemexpress , itemdesc = @itemdesc , itemexpresstype = @itemexpresstype , picstatbudget = @picstatbudget , picstatlast = @picstatlast , picstat = @picstat  , itemtable = ''  , itemcondition = '' , itemmodtype=@itemmodtype , itemendesc = @itemendesc where itemid = @itemid_1 end  DELETE T_OutReportItemTable WHERE  ( itemid	 = @itemid_1) DELETE T_OutReportItemCondition WHERE  ( itemid	 = @itemid_1) DELETE T_OutReportItemCoordinate WHERE  ( itemid	 = @itemid_1)  select @itemid_1

GO
alter procedure [T_OutReportItem_DeleteByRowCol] (@outrepid int , @itemrow int , @itemcolumn int , @flag	int	output, @msg	varchar(4000)	output)  AS declare @itemid int select @itemid = itemid from T_OutReportItem where outrepid = @outrepid and itemrow = @itemrow and itemcolumn= @itemcolumn delete T_OutReportItem where itemid = @itemid delete T_OutReportItemTable where itemid = @itemid delete T_OutReportItemCondition where itemid = @itemid delete T_OutReportItemCoordinate where itemid = @itemid

GO
alter procedure [T_OutReportItem_DeleteByRow] (@outrepid int , @itemrow int , @flag	int	output, @msg	varchar(4000)	output)  AS declare @itemid int declare itemid_cursor cursor for select itemid from T_OutReportItem where outrepid = @outrepid and itemrow = @itemrow  open itemid_cursor fetch next from itemid_cursor into @itemid while @@fetch_status=0 begin delete T_OutReportItem where itemid = @itemid delete T_OutReportItemTable where itemid = @itemid delete T_OutReportItemCondition where itemid = @itemid delete T_OutReportItemCoordinate where itemid = @itemid fetch next from itemid_cursor into @itemid end close itemid_cursor deallocate itemid_cursor

GO
alter procedure [T_OutReportItem_DeleteByCol] (@outrepid int , @itemcolumn int , @flag	int	output, @msg	varchar(4000)	output)  AS declare @itemid int declare itemid_cursor cursor for select itemid from T_OutReportItem where outrepid = @outrepid and itemcolumn= @itemcolumn  open itemid_cursor fetch next from itemid_cursor into @itemid while @@fetch_status=0 begin delete T_OutReportItem where itemid = @itemid delete T_OutReportItemTable where itemid = @itemid delete T_OutReportItemCondition where itemid = @itemid delete T_OutReportItemCoordinate where itemid = @itemid fetch next from itemid_cursor into @itemid end close itemid_cursor deallocate itemid_cursor

GO
alter procedure [T_OutReportItem_Delete] (@itemid 	int , @flag	int	output, @msg	varchar(4000)	output)  AS delete T_OutReportItem where itemid = @itemid delete T_OutReportItemTable where itemid = @itemid delete T_OutReportItemCondition where itemid = @itemid delete T_OutReportItemCoordinate where itemid = @itemid

GO
alter procedure [T_OutReportItem_Copy] (@outrepid_2 	int, @itemrow_2 	int, @itemcolumn_2 	int, @fromitemrow_2      int, @fromitemcolumn_2    int , @flag	int	output, @msg	varchar(4000)	output) AS declare @itemid int , @itemid1 int , @itemtype char(1)  select @itemid = itemid , @itemtype = itemtype from T_OutReportItem where itemrow = @fromitemrow_2 and itemcolumn = @fromitemcolumn_2 and outrepid = @outrepid_2  if @itemid is null return  select @itemid1 = itemid from T_OutReportItem where itemrow = @itemrow_2 and itemcolumn = @itemcolumn_2 and outrepid = @outrepid_2  if @itemid1 is not null begin delete T_OutReportItem where itemid = @itemid1 delete T_OutReportItemTable where itemid = @itemid1 delete T_OutReportItemCondition where itemid = @itemid1 delete T_OutReportItemCoordinate where itemid = @itemid1 end  insert into T_OutReportItem( outrepid, itemrow, itemcolumn, itemtype, itemexpress, itemtable, itemcondition, itemdesc, itemexpresstype, picstatbudget, picstatlast, picstat , itemendesc) select outrepid, @itemrow_2, @itemcolumn_2, itemtype, itemexpress, itemtable, itemcondition, itemdesc, itemexpresstype, picstatbudget, picstatlast, picstat , itemendesc from T_OutReportItem where itemid = @itemid  if @itemtype = '2' begin select @itemid1 = max(itemid) from T_OutReportItem  insert into T_OutReportItemTable(itemid,itemtable,itemtablealter) select @itemid1, itemtable, itemtablealter from T_OutReportItemTable where itemid = @itemid  insert into T_OutReportItemCondition(itemid,conditionid,conditionvalue) select @itemid1, conditionid, conditionvalue from T_OutReportItemCondition where itemid = @itemid  insert into T_OutReportItemCoordinate(itemid,coordinatename,coordinatevalue) select @itemid1, coordinatename, coordinatevalue from T_OutReportItemCoordinate where itemid = @itemid end

GO
alter procedure [T_InputReportCrm_Insert] (@inprepid_1 	int, @crmid_2 	int , @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO T_InputReportCrm ( inprepid, crmid)  VALUES ( @inprepid_1, @crmid_2)

GO
alter procedure [T_InputReportCrm_Delete] (@inprepcrmid_1 	int , @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_InputReportCrm  WHERE ( inprepcrmid	 = @inprepcrmid_1)

GO
alter procedure [T_InputReportItemtype_Insert] ( @inprepid_1 	int, @itemtypename_2 	varchar(4000), @itemtypedesc_3 	varchar(4000) , @dsporder_4 	decimal(15,2) , @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO T_InputReportItemtype ( inprepid, itemtypename, itemtypedesc, dsporder) VALUES ( @inprepid_1, @itemtypename_2, @itemtypedesc_3, @dsporder_4)

GO
alter procedure [T_InputReportItemtype_Delete] ( @itemtypeid_1 	int, @flag	int	output, @msg	varchar(4000)	output ) AS DELETE T_InputReportItemtype WHERE ( itemtypeid	 = @itemtypeid_1)

  GO
alter procedure  [T_fieldItemDetail_Delete] (@itemid_1 	 int  , @flag	 int 	output, @msg	 varchar(4000)	output)  AS DELETE  T_fieldItemDetail  WHERE (  itemid 	 = @itemid_1)

GO
alter procedure [SystemRightsLanguage_Update] (@id_1 	[int], @languageid_2 	[int], @rightname_3 	varchar(4000), @rightdesc_4 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS UPDATE [SystemRightsLanguage]  SET  [rightname]	 = @rightname_3, [rightdesc]	 = @rightdesc_4  WHERE ( [id]	 = @id_1 AND [languageid]	 = @languageid_2)

GO
alter procedure [SystemRightsLanguage_SByIDLang] @id int , @languageid int , @flag integer output , @msg varchar(4000) output AS select a.rightname, a.rightdesc, b.righttype from SystemRightsLanguage a, SystemRights b where a.id = @id and a.languageid = @languageid and a.id = b.id set  @flag = 0 set  @msg = '查询系统权限成功'

GO
alter procedure [SystemRightsLanguage_SByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from SystemRightsLanguage where id = @id set  @flag = 0 set  @msg = '查询系统权限成功'

GO
alter procedure [SystemRightsLanguage_Insert] (@id_1 	[int], @languageid_2 	[int], @rightname_3 	varchar(4000), @rightdesc_4 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [SystemRightsLanguage] ( [id], [languageid], [rightname], [rightdesc])  VALUES ( @id_1, @languageid_2, @rightname_3, @rightdesc_4)

GO
alter procedure [SystemRights_Update] (@id_1 	[int], @rightdesc_2 	varchar(4000), @righttype_3 	[char](1), @flag integer output , @msg varchar(4000) output)  AS UPDATE [SystemRights]  SET  [rightdesc]	 = @rightdesc_2, [righttype]	 = @righttype_3  WHERE ( [id]	 = @id_1)

GO
alter procedure [SystemRights_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from SystemRights where id = @id set  @flag = 0 set  @msg = '查询系统权限成功'

GO
alter procedure [SystemRights_SelectAllID] @flag integer output , @msg varchar(4000) output AS select id,detachable from SystemRights set  @flag = 0 set  @msg = '查询系统权限成功'

GO
alter procedure [SystemRights_SelectAll] @flag int output, @msg varchar(4000) output as begin select id,languageid,rightname  from systemrightslanguage order by id,languageid end

GO
alter procedure [SystemRights_Select] (@rightdesc_1 varchar(4000) , @flag integer output , @msg varchar(4000) output ) AS  select * from SystemRights where rightdesc like @rightdesc_1 order by id desc

GO
alter procedure [SystemRights_Insert] ( @rightdesc_2 	varchar(4000), @righttype_3 	char(1), @flag integer output , @msg varchar(4000) output) AS declare @maxid int select @maxid = max(id) + 1 from SystemRights  INSERT INTO SystemRights ( id , rightdesc, righttype)  VALUES (  @maxid , @rightdesc_2, @righttype_3)  select max(id) from SystemRights

GO
alter procedure [SystemRights_Delete] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output )  AS Declare @count integer select @count = count(id) from SystemRightRoles where rightid = @id_1 if @count <> 0 return DELETE [SystemRights]  WHERE ( [id]	 = @id_1) DELETE [SystemRightsLanguage]  WHERE ( [id]	 = @id_1) DELETE [SystemRightToGroup]  WHERE ( [rightid] = @id_1)

GO
alter procedure [SystemRightRoles_Update] (@id_1 	[int], @rolelevel_2 	[char](1), @flag integer output , @msg varchar(4000) output)  AS UPDATE [SystemRightRoles]  SET  [rolelevel]	 = @rolelevel_2  WHERE ( [id]	 = @id_1)

GO
alter procedure [SystemRightRoles_SelectByID] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from SystemRightRoles where id = @id_1

GO
alter procedure [SystemRightRoles_SByRightid] @id int , @flag integer output , @msg varchar(4000) output AS select * from SystemRightRoles where rightid = @id set  @flag = 0 set  @msg = '查询系统权限角色成功'

GO
alter procedure [SystemRightRoles_Insert] (@rightid_1 	[int], @roleid_2 	[int], @rolelevel_3 	[char](1), @flag integer output , @msg varchar(4000) output)  AS DECLARE @count integer select @count = count(id) from SystemRightRoles where rightid = @rightid_1 and roleid = @roleid_2  if @count =0 begin INSERT INTO [SystemRightRoles] ( [rightid], [roleid], [rolelevel])  VALUES ( @rightid_1, @roleid_2, @rolelevel_3) end else begin update SystemRightRoles set rolelevel = @rolelevel_3 where rightid = @rightid_1 and roleid = @roleid_2 end

GO
alter procedure [SystemRightRoles_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS DELETE [SystemRightRoles]  WHERE ( [id]	 = @id_1)

GO
alter procedure [SystemRightDetail_SByRightID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from SystemRightDetail where rightid = @id set  @flag = 0 set  @msg = '查询系统权限详细成功'

GO
alter procedure [SystemRightDetail_Insert] (@rightdetailname_1 	varchar(4000), @rightdetail_2 	varchar(4000), @rightid_3 	int, @flag integer output , @msg varchar(4000) output) AS declare @maxid int select @maxid = max(id) + 1 from SystemRightDetail  INSERT INTO SystemRightDetail ( id, rightdetailname, rightdetail, rightid)  VALUES ( @maxid , @rightdetailname_1, @rightdetail_2, @rightid_3)

GO
alter procedure [SystemRightDetail_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS DELETE [SystemRightDetail]  WHERE ( [id]	 = @id_1)

GO
alter procedure [systemright_Srightsbygroup] @id int, @flag int output, @msg varchar(4000) output as begin select a.rightid,b.detachable from systemrighttogroup a,SystemRights b where a.groupid=@id and a.rightid=b.id order by b.righttype asc,a.rightid asc end

GO
alter procedure [SystemRight_selectRightGroup] @flag int output, @msg varchar(4000) output as declare @id int,@groupname varchar(4000),@count int  create table #temp( id  int, groupname varchar(4000), cnt int ) select @count=count(*) from SystemRights insert into #temp values(-1,'全部',@count)  declare right_cursor cursor for select id , rightgroupname from SystemRightGroups where id<>-2 order by id open right_cursor fetch next from right_cursor into @id,@groupname while @@fetch_status=0 begin select @count = count(rightid) from SystemRightToGroup where groupid= @id insert into #temp values(@id,@groupname,@count) fetch next from right_cursor into @id,@groupname end close right_cursor  select @count=count(distinct a.id) from SystemRights a left join SystemRightToGroup b on a.id=b.rightid where b.rightid is null insert into #temp values(-2,'其它权限组',@count)  deallocate right_cursor  select id,groupname,cnt from #temp

 GO
alter procedure [SystemModule_UPDATE]( @id_1       int, @moduleName_1     Varchar(100), @moduleReleased_1   char(1), @flag		int	output, @msg		varchar(4000)	output)  AS  UPDATE SystemModule SET moduleName = @moduleName_1, moduleReleased = @moduleReleased_1  WHERE id = @id_1   SET @flag = 1 SET @msg = 'ok'

 GO
alter procedure [SystemModule_Insert]( @id_1 int, @moduleName_1     Varchar(100), @moduleReleased_1   char(1), @flag		int	output, @msg		varchar(4000)	output)  AS INSERT INTO SystemModule ( id, moduleName, moduleReleased ) VALUES ( @id_1, @moduleName_1, @moduleReleased_1 )  SET @flag = 1 SET @msg = 'ok'

 GO
alter procedure [SystemModule_Delete]( @id_1       int, @flag		int	output, @msg		varchar(4000)	output)   AS  DELETE FROM SystemModule WHERE id = @id_1  SET @flag = 1 SET @msg = 'ok'

GO
alter procedure [sysPhrase_update] ( @id int, @hrmId int, @phraseShort varchar(4000), @phraseDesc varchar(4000), @flag integer output, @msg varchar(4000) output ) AS update sysPhrase set  hrmId=@hrmId,phraseShort=@phraseShort,phraseDesc=@phraseDesc where id = @id

GO
alter procedure [sysPhrase_selectById] ( @id int, @flag integer output, @msg varchar(4000) output ) AS select * from sysPhrase where id = @id

GO
alter procedure [sysPhrase_selectByHrmId] ( @hrmId int , @flag integer output, @msg varchar(4000) output ) AS select * from sysPhrase where hrmid = @hrmId order by id

GO
alter procedure [sysPhrase_insert] ( @hrmId int, @phraseShort varchar(4000), @phraseDesc varchar(4000), @flag integer output, @msg varchar(4000) output ) AS insert into sysPhrase (hrmId,phraseShort,phraseDesc) values(@hrmId,@phraseShort,@phraseDesc)

GO
alter procedure [sysPhrase_deleteById] ( @id int, @flag integer output, @msg varchar(4000) output ) AS delete sysPhrase where id = @id

GO
alter procedure [SysMaintenanceLog_proc] @relatedid int, @relatedname varchar(4000), @operateuserid int , @operateusertype int, @operatetype varchar(4000), @operatedesc text, @operateitem varchar(4000), @operatedate char(10), @operatetime char(8), @operatesmalltype int, @clientaddress char(15), @isTemplate int as insert into SysMaintenanceLog (relatedid, relatedname, operateuserid, operateusertype, operatetype, operatedesc, operateitem, operatedate, operatetime, operatesmalltype, clientaddress, isTemplate) values( @relatedid, @relatedname, @operateuserid, @operateusertype, @operatetype, @operatedesc, @operateitem, @operatedate, @operatetime, @operatesmalltype, @clientaddress, @isTemplate)

GO
alter procedure [SysFavourite_Update] (@id_1 	[int], @pagename_1   varchar(4000), @flag   integer output, @msg   varchar(4000) output ) AS UPDATE [sysfavourite]  SET  [pagename]	 = @pagename_1  WHERE ( [id] = @id_1)  if @@error<>0 begin set @flag=1 set @msg='	更新储存过程失败' return end else begin set @flag=0 set @msg='	更新储存过程成功' return end

GO
alter procedure [SysFavourite_SelectByUserID] @resourceid int, @flag integer output, @msg varchar(4000) output as select top 20 * from sysfavourite where resourceid=@resourceid order by resourceid,adddate desc

GO
alter procedure [SysFavourite_Insert] @userid int, @adddate char(20), @pagename char(100), @url char(1000), @importlevel int, @favouritetype int, @flag integer output, @msg varchar(4000) output AS insert into sysfavourite(resourceid,adddate,pagename,url,importlevel,favouritetype) VALUES (@userid,@adddate,@pagename,@url,@importlevel,@favouritetype) select @@IDENTITY from sysfavourite

GO
alter procedure [SysFavourite_DeleteByID] (@id 		int, @flag integer output, @msg varchar(4000) output) AS delete from sysfavourite where id=@id

GO
alter procedure [Sys_Slogan_Update] (@slogan 	varchar(4000), @speed 	[tinyint], @fontcolor 	[char](6), @backcolor 	[char](6), @flag                             integer output, @msg                             varchar(4000) output )  AS UPDATE [Sys_Slogan]  SET  [slogan]	 = @slogan, [speed]	 = @speed, [fontcolor]	 = @fontcolor, [backcolor]	 = @backcolor

GO
alter procedure [Sys_Slogan_Select] (@flag                             integer output, @msg                             varchar(4000) output )  AS select * from Sys_Slogan

GO
alter procedure [FnaBudgetInfoDetail_Insert] (@budgetinfoid_1 	int, @budgetperiods_2 	int, @budgetperiodslist_3 	int, @budgettypeid_4 	int, @budgetresourceid_5 	int, @budgetcrmid_6 	int, @budgetprojectid_7 	int, @budgetaccount_8 	decimal(18,2), @budgetremark_9 	varchar(4000), @flag	int	output, @msg	varchar(4000) output) AS IF EXISTS ( select id from FnaBudgetInfoDetail where budgetinfoid = @budgetinfoid_1 and budgetperiods = @budgetperiods_2 and budgetperiodslist = @budgetperiodslist_3 and budgettypeid = @budgettypeid_4) BEGIN UPDATE FnaBudgetInfoDetail SET budgetaccount = @budgetaccount_8 WHERE budgetinfoid = @budgetinfoid_1 AND budgetperiods = @budgetperiods_2 AND budgetperiodslist = @budgetperiodslist_3 AND budgettypeid = @budgettypeid_4 END ELSE BEGIN INSERT INTO FnaBudgetInfoDetail (budgetinfoid, budgetperiods, budgetperiodslist, budgettypeid, budgetresourceid, budgetcrmid, budgetprojectid, budgetaccount, budgetremark) VALUES (@budgetinfoid_1, @budgetperiods_2, @budgetperiodslist_3, @budgettypeid_4, @budgetresourceid_5, @budgetcrmid_6, @budgetprojectid_7, @budgetaccount_8, @budgetremark_9) END

GO
alter procedure [FnaBudgetInfoDetail_Delete] (@budgetinfoid_1 	int, @budgettypeid_2 	int, @flag	int	output, @msg	varchar(4000) output)  AS DELETE FnaBudgetInfoDetail  WHERE ( budgetinfoid	 = @budgetinfoid_1 and budgettypeid = @budgettypeid_2)

GO
alter procedure [FnaBudgetModule_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS DELETE [FnaBudgetModule] WHERE ( [id]	 = @id_1) select '20'

GO
alter procedure [FnaBudgetList_Process] @departmentid_1 	[int], @periodsfrom_2    char(6), @periodsto_2      char(6), @flag integer output , @msg varchar(4000) output AS declare @ledgerid int ,@budgetid int ,@budgetmoduleid int ,@budgetperiods char(6) declare @budgetdepartmentid int,@budgetcostcenterid int,@budgetresourceid int declare @budgetremark varchar(4000),@budgetaccount decimal(18,3)   declare budget_cursor cursor for select ledgerid, b.id, budgetmoduleid, budgetperiods, budgetdepartmentid, budgetcostercenterid, budgetresourceid, d.budgetremark , budgetdefaccount from FnaBudget b , FnaBudgetDetail d where b.id = d.budgetid and budgetdepartmentid = @departmentid_1 and budgetperiods >= @periodsfrom_2 and budgetperiods <= @periodsto_2 and budgetstatus = '1'  open budget_cursor fetch next from budget_cursor into @ledgerid,@budgetid,@budgetmoduleid,@budgetperiods,@budgetdepartmentid, @budgetcostcenterid,@budgetresourceid,@budgetremark,@budgetaccount while @@fetch_status=0 begin insert into FnaBudgetList ( [ledgerid], [budgetid], [budgetmoduleid], [budgetperiods], [budgetdepartmentid], [budgetcostcenterid], [budgetresourceid], [budgetremark], [budgetaccount])  VALUES ( @ledgerid, @budgetid, @budgetmoduleid, @budgetperiods, @budgetdepartmentid, @budgetcostcenterid, @budgetresourceid, @budgetremark, @budgetaccount)  fetch next from budget_cursor into @ledgerid,@budgetid,@budgetmoduleid,@budgetperiods,@budgetdepartmentid, @budgetcostcenterid,@budgetresourceid,@budgetremark,@budgetaccount end close budget_cursor deallocate budget_cursor  update FnaBudget set budgetstatus = '2' where budgetdepartmentid = @departmentid_1 and budgetperiods >= @periodsfrom_2 and budgetperiods <= @periodsto_2 and budgetstatus = '1'

GO
alter procedure [FnaBudgetInfo_UpdateStatus] (@id_1 	int, @status_2 	int, @revision_3 	int, @budgetstatus_4		int, @flag	int	output, @msg	varchar(4000) output)  AS UPDATE FnaBudgetInfo SET budgetstatus = @budgetstatus_4, status	 = @status_2, revision	 = @revision_3 WHERE (id = @id_1)

GO
alter procedure [FnaBudgetInfo_Update] (@id_1 	int, @approverid_2 	int, @approverdate_3 	char(10), @flag	int	output, @msg	varchar(4000) output)  AS UPDATE FnaBudgetInfo  SET  budgetstatus = '1' , approverid	 = @approverid_2, approverdate	 = @approverdate_3  WHERE ( id	 = @id_1)

GO
alter procedure [FnaBudgetInfo_Insert] @budgetperiods_1 int, @budgetorganizationid_2 int, @organizationtype_3 int, @budgetstatus_4 int, @createrid_5 int, @createdate_6 char(10), @revision_7 int, @status_8 int, @flag int output, @msg varchar(4000) output AS IF EXISTS ( SELECT id FROM FnaBudgetInfo WHERE budgetorganizationid = @budgetorganizationid_2 AND organizationtype = @organizationtype_3 AND budgetperiods = @budgetperiods_1 AND status = @status_8 AND revision = @revision_7 ) BEGIN SELECT -1 RETURN END ELSE BEGIN INSERT INTO FnaBudgetInfo (budgetperiods, budgetorganizationid, organizationtype, budgetstatus, createrid, createdate, revision, status) VALUES (@budgetperiods_1, @budgetorganizationid_2, @organizationtype_3, @budgetstatus_4, @createrid_5, @createdate_6, @revision_7, @status_8) select @@IDENTITY END

GO
alter procedure [FnaBudgetfeeType_Update] @id_1		int, @name_1	varchar(4000), @feeperiod_1	int, @feetype_1	int, @agreegap_1	int, @description_1	varchar(4000), @feelevel_1	int, @alertvalue_1 int, @supsubject_1 int, @flag	int	output, @msg	varchar(4000) output as update fnaBudgetfeetype set name=@name_1,feeperiod=@feeperiod_1,feetype=@feetype_1 ,agreegap=@agreegap_1,description=@description_1,feelevel=@feelevel_1,alertvalue=@alertvalue_1,supsubject=@supsubject_1 where id=@id_1

GO
alter procedure [FnaBudgetfeeType_SelectByID] @id		int, @flag	int	output, @msg	varchar(4000) output as select * from fnaBudgetfeetype where id=@id

GO
alter procedure [FnaBudgetfeeType_Select] @flag	int	output, @msg	varchar(4000) output as select * from fnaBudgetfeetype order by codeName,name

GO
alter procedure [HrmCompetency_Update] (@id_1 	[int], @competencymark_2 	varchar(4000), @competencyname_3 	varchar(4000), @competencyremark_4 	[text], @flag integer output, @msg varchar(4000) output )  AS UPDATE [HrmCompetency]  SET  [competencymark]	 = @competencymark_2, [competencyname]	 = @competencyname_3, [competencyremark]	 = @competencyremark_4  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmCompetency_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmCompetency where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmCompetency_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmCompetency set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmCompetency_Insert] (@competencymark_1 	varchar(4000), @competencyname_2 	varchar(4000), @competencyremark_3 	[text], @flag integer output, @msg varchar(4000) output )  AS INSERT INTO [HrmCompetency] ( [competencymark], [competencyname], [competencyremark])  VALUES ( @competencymark_1, @competencyname_2, @competencyremark_3) select max(id) from  [HrmCompetency]  if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmCompetency_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [HrmCompetency]  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmCompanyVirtual_Select] @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT AS SELECT  * FROM    HrmCompanyVirtual ORDER BY id desc SET @flag = 0 SET @msg = '操作成功完成'

GO
alter procedure [HrmCity_Update] (@id 	[int], @cityname 	varchar(4000) , @citylongitude [decimal](8,3),  @citylatitude [decimal](8,3), @provinceid [int], @countryid [int], @flag integer output, @msg varchar(4000) output )  AS UPDATE [HrmCity]  SET  [cityname]	 = @cityname, [citylongitude] = @citylongitude, [citylatitude] = @citylatitude, [provinceid] = @provinceid, [countryid] = @countryid  WHERE ( [id]	 = @id) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmCity_Select] (@countryid int , @provinceid int , @flag integer output , @msg varchar(4000) output ) AS if @countryid = 0 select * from HrmCity order by countryid , provinceid else if @provinceid = 0 select * from HrmCity where countryid = @countryid order by countryid , provinceid else select * from HrmCity where countryid = @countryid and provinceid = @provinceid order by countryid , provinceid

 GO
alter procedure [HrmCity_Insert] (@cityname 	varchar(4000), @citylongitude decimal(8,3), @citylatitude decimal(8,3), @provinceid int, @countryid int, @flag integer output, @msg varchar(4000) output ) AS declare @cityid int select @cityid = ( max(id)+1 ) from HrmCity INSERT INTO HrmCity ( id , cityname, citylongitude, citylatitude, provinceid, countryid ) VALUES ( @cityid , @cityname, @citylongitude, @citylatitude, @provinceid, @countryid ) select @cityid

GO
alter procedure [MailSequence_Get]( @indexdesc varchar(4000), @flag int output, @msg varchar(4000) output) as declare @id_1 integer select @id_1=currentid from SequenceIndex where indexdesc=@indexdesc update SequenceIndex set currentid = @id_1+1 where indexdesc=@indexdesc select @id_1

GO
alter procedure [MailSendRecord_Insert] (@id_1 	int, @sendto_2 	varchar(4000), @subject_3 varchar(4000), @body_4 text, @sendcount_5 	int, @sendtoid_6 	int, @flag int output, @msg varchar(4000) output)  AS INSERT INTO MailSendRecord ( id, sendto, subject, body, sendcount, sendtoid)  VALUES ( @id_1, @sendto_2, @subject_3, @body_4, @sendcount_5, @sendtoid_6)

GO
alter procedure [HrmCityTwo_Update] ( @id INT , @cityname varchar(4000) , @citylongitude DECIMAL(8, 3) , @citylatitude DECIMAL(8, 3) , @cityid INT , @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT ) AS UPDATE  HrmCityTwo SET     cityname = @cityname , citylongitude = @citylongitude , citylatitude = @citylatitude , cityid = @cityid WHERE   ( id = @id ) IF @@error <> 0 BEGIN SET @flag = 1 SET @msg = '插入储存过程失败' RETURN END ELSE BEGIN SET @flag = 0 SET @msg = '插入储存过程成功' RETURN END

GO
alter procedure [HrmCityTwo_Insert] ( @cityname varchar(4000) , @citylongitude DECIMAL(8, 3) , @citylatitude DECIMAL(8, 3) , @citypid INT , @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT ) AS DECLARE @cityid INT SELECT  @cityid = ( MAX(id) + 1 ) FROM    HrmCityTwo IF @cityid IS NULL SET @cityid = 1 INSERT  INTO HrmCityTwo ( id , cityname , citylongitude , citylatitude , cityid ) VALUES  ( @cityid , @cityname , @citylongitude , @citylatitude , @citypid ) SELECT  @cityid

GO
alter procedure [HrmCityTwo_Delete] ( @id INT , @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT ) AS DELETE  HrmCityTwo WHERE   ( id = @id ) IF @@error <> 0 BEGIN SET @flag = 1 SET @msg = '插入储存过程失败' RETURN END ELSE BEGIN SET @flag = 0 SET @msg = '插入储存过程成功' RETURN END

GO
alter procedure [MailSendMain_Insert] (@id_1 	int, @sendfrom_2 	varchar(4000), @sendcc_3 	varchar(4000), @sendbcc_4 	varchar(4000), @charset_5 	char(1), @priority_6 	char(1), @senddate_7 	char(10), @sendtime_8 	char(8), @isfinished_9 	char(1), @sendtotype_10 	char(1), @sender_11 	int, @flag int output, @msg varchar(4000) output)  AS INSERT INTO MailSendMain ( id, sendfrom, sendcc, sendbcc, charset, priority, senddate, sendtime, isfinished, sendtotype, sender)  VALUES ( @id_1, @sendfrom_2, @sendcc_3, @sendbcc_4, @charset_5, @priority_6, @senddate_7, @sendtime_8, @isfinished_9, @sendtotype_10, @sender_11)

GO
alter procedure [CRM_ContractType_Update] (@id_1 	[int] , @name_1 	varchar(4000), @contractdesc_1	varchar(4000), @workflowid_1  [int], @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE CRM_ContractType SET name = @name_1, contractdesc = @contractdesc_1 , workflowid = @workflowid_1 where id = @id_1

GO
alter procedure [CRM_ContractType_SelectById] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_ContractType  where id = @id_1

  GO
alter procedure [CRM_ContractType_Select] ( @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_ContractType

GO
alter procedure [CRM_ContractType_Insert] (@name_1 	varchar(4000), @contractdesc_1	varchar(4000), @workflowid_1  [int], @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [CRM_ContractType] ([name], [contractdesc], [workflowid])  VALUES ( @name_1, @contractdesc_1, @workflowid_1)

 GO
alter procedure [CRM_ContractType_Delete] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS IF EXISTS(SELECT id FROM CRM_Contract WHERE typeId = @id_1) BEGIN SELECT -1 RETURN END DELETE [CRM_ContractType] WHERE ( [id]	 = @id_1)

GO
alter procedure [CRM_ContractProInfo_Update] ( @id_1 	[int], @factNum_1 	[int], @factDate_1 	[char] (10), @formNum_1   varchar(4000) , @creater_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output )  AS UPDATE CRM_ContractProInfo set factNum = @factNum_1 , factDate = @factDate_1 , formNum = @formNum_1 , creater = @creater_1 WHERE id = @id_1

GO
alter procedure [CRM_ContractProInfo_Select] ( @proId_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output )  AS SELECT * FROM CRM_ContractProInfo WHERE proId = @proId_1

GO
alter procedure [CRM_ContractProInfo_Insert] ( @proId_1 	[int], @factNum_1 	[int], @factDate_1 	[char] (10), @formNum_1   varchar(4000) , @creater_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output )  AS INSERT INTO CRM_ContractProInfo VALUES ( @proId_1, @factNum_1, @factDate_1, @formNum_1, @creater_1 )

GO
alter procedure [MailUserAddress_SelectAllById] ( @mailgroupid int, @flag [int]  output, @msg  varchar(4000) output) as select * from MailUserAddress WHERE mailgroupid=@mailgroupid

GO
alter procedure [MailUserAddress_Delete] ( @mailgroupid int, @mailaddress     varchar(4000), @flag [int]  output, @msg  varchar(4000) output) as delete from MailUserAddress WHERE mailgroupid=@mailgroupid and mailaddress=@mailaddress

GO
alter procedure [MailUser_SelectAllById] ( @mailgroupid int, @flag [int]  output, @msg  varchar(4000) output) as select * from MailUser WHERE mailgroupid=@mailgroupid

GO
alter procedure [MailUser_Insert] ( @mailgroupid int,    @resourceid  int,    @flag [int]  output, @msg  varchar(4000) output) as INSERT INTO MailUser (mailgroupid,resourceid) VALUES (@mailgroupid,@resourceid)

GO
alter procedure [MailUser_DeleteById] ( @mailgroupid    int, @resourceid int, @flag [int]  output, @msg  varchar(4000) output) as delete from MailUser WHERE resourceid=@resourceid and mailgroupid=@mailgroupid

 GO
alter procedure [CRM_ContactLog_Update] (@id 	[int], @contacterid 	[int], @resourceid 	[int], @agentid 	[int],  @contactway 	[int], @ispassive 	[tinyint], @subject 	varchar(4000), @contacttype 	[int], @contactdate 	varchar(4000), @contacttime 	varchar(4000), @enddate 	varchar(4000), @endtime 	varchar(4000), @contactinfo text, @documentid 	[int], @isfinished [tinyint], @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [CRM_ContactLog]  SET  	 [contacterid]	 = @contacterid, [resourceid]	 = @resourceid,  [agentid]	 = @agentid, [contactway]	 = @contactway, [ispassive]	 = @ispassive, [subject]	 = @subject, [contacttype]	 = @contacttype, [contactdate]	 = @contactdate, [contacttime]	 = @contacttime, [enddate]	 = @enddate, [endtime]	 = @endtime, [contactinfo]	 = @contactinfo, [documentid]	 = @documentid, [isfinished]	 = @isfinished  WHERE ( [id]	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContactLog_Unite_Update] (@id_1 	[int] , @id_2 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE CRM_ContactLog SET customerid = @id_1 where customerid = @id_2

GO
alter procedure [CRM_ContactLog_SelectByID] (@id 		[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [CRM_ContactLog] WHERE ([id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContactLog_Select_Plan] (@resourceid 	[int],  @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT id,subject,customerid,contacterid,contactdate,contacttime from [CRM_ContactLog] WHERE ([resourceid] = @resourceid) and ([isfinished] = 0)  ORDER BY contactdate ASC, contacttime ASC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContactLog_Select] (@id 		[int], @issub		[tinyint], @parent	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [CRM_ContactLog] WHERE ([customerid] = @id) AND ([issublog] = @issub) AND ([parentid] = @parent) ORDER BY contactdate DESC, contacttime DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContactLog_S_Plan_byAgent] (@userid 	[int],  @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT id,subject,customerid,contacterid,contactdate,contacttime from [CRM_ContactLog] WHERE ([agentid] = @userid) and ([isfinished] = 0)  ORDER BY contactdate ASC, contacttime ASC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContactLog_Process] (@id 	[int], @processdate 	varchar(4000), @processtime 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [CRM_ContactLog]  SET  	 [isprocessed]	 = 1, [processdate]	 = @processdate, [processtime]	 = @processtime  WHERE ( [id]	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContactLog_InsertID] (@flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT top 1 id FROM [CRM_ContactLog] ORDER BY id DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContactLog_Insert] (@customerid 	[int], @contacterid 	[int], @resourceid 	[int], @agentid 	[int], @contactway 	[int], @ispassive 	[tinyint], @subject 	varchar(4000), @contacttype 	[int], @contactdate 	varchar(4000), @contacttime 	varchar(4000), @enddate 	varchar(4000), @endtime 	varchar(4000), @contactinfo 	text, @documentid 	[int], @submitdate 	varchar(4000), @submittime 	varchar(4000), @issublog 	[tinyint], @parentid 	[int], @isfinished  [tinyint], @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [CRM_ContactLog] ( [customerid], [contacterid], [resourceid], [agentid], [contactway], [ispassive], [subject], [contacttype], [contactdate], [contacttime], [enddate], [endtime], [contactinfo], [documentid], [submitdate], [submittime], [issublog], [parentid], [isfinished], [isprocessed], [processdate], [processtime])  VALUES ( @customerid, @contacterid, @resourceid, @agentid, @contactway, @ispassive, @subject, @contacttype, @contactdate, @contacttime, @enddate, @endtime, @contactinfo, @documentid, @submitdate, @submittime, @issublog, @parentid, @isfinished, 0, '', '')  SELECT top 1 id FROM [CRM_ContactLog] ORDER BY id DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [bill_CptApplyDetail_Update] (@id_1 	[int], @cpttype 	[int], @cptid_3 	[int], @number_4 	[decimal](10,3), @unitprice_5 	[decimal](10,3), @amount_6 	[decimal](10,3), @needdate_7 	varchar(4000), @purpose_8 	varchar(4000), @cptdesc_9 	varchar(4000), @capitalid 	[int], @flag integer output , @msg varchar(4000) output)  AS UPDATE  [bill_CptApplyDetail]  SET [cpttype]	 = @cpttype, [cptid]	 = @cptid_3, [number_n]	 = @number_4, [unitprice]	 = @unitprice_5, [amount]	 = @amount_6, [needdate]	 = @needdate_7, [purpose]	 = @purpose_8, [cptdesc]	 = @cptdesc_9 , [capitalid]	 = @capitalid  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptApplyDetail_Select] (@cptapplyid 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptApplyDetail] WHERE ( [cptapplyid]	 = @cptapplyid) order by id

GO
alter procedure [bill_CptApplyDetail_Insert] (@cptapplyid 	[int], @cpttype 	[int], @cptid_1 	[int], @number_2 	[decimal](10,3), @unitprice_3 	[decimal](10,3), @amount_4 	[decimal](10,3), @needdate_5 	varchar(4000), @purpose_6 	varchar(4000), @cptdesc_7 	varchar(4000), @capitalid_8 	[int], @flag integer output , @msg varchar(4000) output ) AS INSERT INTO [bill_CptApplyDetail] ( [cptapplyid], [cpttype], [cptid], [number_n], [unitprice], [amount], [needdate], [purpose], [cptdesc],[capitalid]) VALUES ( @cptapplyid, @cpttype, @cptid_1, @number_2, @unitprice_3, @amount_4, @needdate_5, @purpose_6, @cptdesc_7 , @capitalid_8)

GO
alter procedure [bill_CptAdjustMain_Select] (@id 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptAdjustMain] WHERE ( [id]	 = @id)

GO
alter procedure [MailShare_SelectByMailgroupid] (@mailgroupid	int, @flag	int output, @msg	varchar(4000)	output) as select * from MailShare where mailgroupid = @mailgroupid

 GO
alter procedure [MailShare_InsertByUser] @seclevel int, @departmentid int, @subcompanyid int, @userid	int, @flag	int	output, @msg	varchar(4000) output as declare	@mailgroupid	int, @all_cursor cursor SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select Distinct mailgroupid from MailShare  where sharetype=5 or (sharetype=3 and @seclevel>=seclevel and @departmentid=departmentid) OR (sharetype=2 and @seclevel>=seclevel and @subcompanyid=subcompanyid) OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @mailgroupid WHILE @@FETCH_STATUS = 0 begin insert into MailUserShare (mailgroupid,userid) values (@mailgroupid , @userid) FETCH NEXT FROM @all_cursor INTO @mailgroupid end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [MailShare_Insert] (@mailgroupid         int, @sharetype	tinyint, @seclevel	tinyint, @rolelevel	tinyint, @sharelevel	tinyint, @userid	        int, @subcompanyid	int, @departmentid	int, @roleid	        int, @foralluser	tinyint, @sharedcrm	int, @flag	int output, @msg	varchar(4000)	output) as insert into MailShare (mailgroupid,sharetype,seclevel,rolelevel,sharelevel,userid,subcompanyid,departmentid,roleid,foralluser,sharedcrm) values (@mailgroupid,@sharetype,@seclevel,@rolelevel,@sharelevel,@userid,@subcompanyid,@departmentid,@roleid,@foralluser,@sharedcrm)

GO
alter procedure [MailShare_Delete] (@id	int, @flag	int output, @msg	varchar(4000)	output) as delete from MailShare where id=@id

GO
alter procedure [CRM_ContactWay_SelectByID] (@id 	[int], @Flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_ContactWay] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContactWay_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_ContactWay]  order by id asc set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContactWay_InsertID] (@flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT top 1 id from CRM_ContactWay ORDER BY id DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContactWay_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CRM_ContactWay] ( [fullname], [description]) VALUES ( @fullname, @description) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_PayInfo_update] @id_1		int, @factprice_1	decimal(10,2), @factdate_1 char(10), @creater_1 int, @formNum_1   varchar(4000) , @flag		int	output, @msg		varchar(4000) output as update  CRM_PayInfo set factprice=@factprice_1, factdate=@factdate_1, creater=@creater_1, formNum=@formNum_1 WHERE id=@id_1

GO
alter procedure [CRM_PayInfo_SelectAll] @id_1		int, @flag		int	output, @msg		varchar(4000) output as select * from CRM_PayInfo WHERE payid=@id_1 order by factdate desc

GO
alter procedure [CRM_PayInfo_Insert] @id_1		int, @factprice_1	decimal(15,2), @factdate_1 char(10), @creater_1 int, @formNum_1   varchar(4000) , @flag		int	output, @msg		varchar(4000) output as insert into CRM_PayInfo (payid,factprice,factdate,creater,formNum) values (	@id_1,@factprice_1,	@factdate_1 ,@creater_1 ,@formNum_1)

GO
alter procedure [CRM_PayInfo_del] @id_1		int, @flag		int	output, @msg		varchar(4000) output as delete from CRM_PayInfo WHERE id =@id_1

GO
alter procedure [CRM_Modify_Select] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_Modify] WHERE ( [customerid]	 = @id) ORDER BY modifydate DESC, modifytime DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_Modify_Insert] (@customerid 	[int], @tabledesc 	[char](1), @type 		[int], @addresstype 	[int], @fieldname 	varchar(4000), @modifydate 	varchar(4000), @modifytime 	varchar(4000), @original 	varchar(4000), @modified 	varchar(4000), @modifier 	[int], @submitertype 	[tinyint], @clientip 	[char](15), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CRM_Modify] ( [customerid], [tabledesc], [type], [addresstype], [fieldname], [modifydate], [modifytime], [original], [modified], [modifier], [submitertype], [clientip]) VALUES ( @customerid, @tabledesc, @type, @addresstype, @fieldname, @modifydate, @modifytime, @original, @modified, @modifier, @submitertype, @clientip) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_LoginLog_Insert] @id	int,  @logindate	char(10), @logintime	char(8), @ipaddress	char(15), @flag integer output , @msg varchar(4000) output AS insert into CRM_loginLog (id, logindate, logintime, ipaddress) values(@id, @logindate, @logintime, @ipaddress)

GO
alter procedure [CRM_Log_Select] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [CRM_Log] WHERE ([customerid] = @id) ORDER BY submitdate DESC, submittime DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_Log_Insert] (@customerid 	[int], @logtype 	[char](2), @documentid 	[int], @logcontent 	text, @submitdate 	varchar(4000), @submittime 	varchar(4000), @submiter 	[int], @submitertype 	[tinyint], @clientip 	[char](15), @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [CRM_Log] ( [customerid], [logtype], [documentid], [logcontent], [submitdate], [submittime], [submiter], [submitertype], [clientip])  VALUES ( @customerid, @logtype, @documentid, @logcontent, @submitdate, @submittime, @submiter, @submitertype, @clientip) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_LedgerInfo_Update] @customerid	int, @customercode	char(10), @tradetype	char(1), @flag integer output , @msg varchar(4000) output as update CRM_LedgerInfo set customercode=@customercode where customerid=@customerid and tradetype=@tradetype

GO
alter procedure [CRM_LedgerInfo_SelectAll] @customerid	int, @flag integer output , @msg varchar(4000) output as select * from crm_ledgerinfo where customerid=@customerid

GO
alter procedure [CRM_LedgerInfo_Select] @customerid	int, @tradetype	char(1), @flag integer output , @msg varchar(4000) output as select * from crm_ledgerinfo where customerid=@customerid and tradetype=@tradetype

GO
alter procedure [CRM_LedgerInfo_Insert] @customerid	int, @customercode	char(10), @tradetype	char(1), @ledger1	int, @ledger2	int, @flag integer output , @msg varchar(4000) output as insert into CRM_LedgerInfo values(@customerid,@customercode,@tradetype,@ledger1,@ledger2)

GO
alter procedure [CRM_LedgerInfo_Delete] @customerid	int, @tradetype	char(1), @flag integer output , @msg varchar(4000) output as delete from CRM_LedgerInfo where customerid=@customerid and tradetype=@tradetype

GO
alter procedure [CRM_CustomerType_SelectAll] (@flag [int] output, @msg	varchar(4000) output) AS SELECT * FROM [CRM_CustomerType] order by id asc set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerType_Insert] (@fullname varchar(4000), @description varchar(4000),@workflowid int, @flag int output, @msg varchar(4000)	output) AS INSERT INTO CRM_CustomerType ( fullname, description,workflowid) VALUES ( @fullname, @description,@workflowid) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_Find_RecentRemark] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT top 3 * from [CRM_Log] WHERE ([customerid] = @id) ORDER BY submitdate DESC, submittime DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_Find_LastModifier] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT top 1 submiter,submitdate,submitertype from [CRM_Log] WHERE ([customerid] = @id) and (not ([logtype] = 'n')) ORDER BY submitdate DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerRating_Update] (@id 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @workflow11 [int], @workflow12 [int], @workflow21 [int], @workflow22 [int], @workflow31 [int], @workflow32 [int], @canupgrade [char](1), @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_CustomerRating] SET  [fullname]	 = @fullname, [description]	 = @description, [workflow11] = @workflow11, [workflow12] = @workflow12, [workflow21] = @workflow21, [workflow22] = @workflow22, [workflow31] = @workflow31, [workflow32] = @workflow32, [canupgrade] = @canupgrade WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerRating_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerRating] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerRating_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerRating] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerRating_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @workflow11 [int], @workflow12 [int], @workflow21 [int], @workflow22 [int], @workflow31 [int], @workflow32 [int], @canupgrade [char](1), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CRM_CustomerRating] ( [fullname], [description], [workflow11], [workflow12], [workflow21], [workflow22], [workflow31], [workflow32], [canupgrade]) VALUES ( @fullname, @description, @workflow11, @workflow12, @workflow21, @workflow22, @workflow31, @workflow32, @canupgrade) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerRating_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_CustomerRating] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CreditInfo_Update] ( @id_1 	int, @fullname_1 	varchar(4000), @creditamount_1 	varchar(4000), @highamout_1  varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS UPDATE CRM_CreditInfo  SET fullname	 = @fullname_1, creditamount	 = convert(money,@creditamount_1 ) , highamount	 = convert(money,@highamout_1 ) WHERE ( id	 = @id_1)

GO
alter procedure [CRM_CreditInfo_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CreditInfo] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CreditInfo_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CreditInfo] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CreditInfo_Insert] ( @fullname_1 	varchar(4000), @creditamount_1 	varchar(4000), @highamout_1  varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO  CRM_CreditInfo ( fullname, creditamount,highamount) VALUES ( @fullname_1, convert(money,@creditamount_1),convert(money,@highamout_1))

GO
alter procedure [CRM_CreditInfo_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_CreditInfo] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerSize_Update] (@id 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_CustomerSize] SET  [fullname]	 = @fullname, [description]	 = @description WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerSize_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerSize] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerSize_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerSize] order by id asc  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerSize_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CRM_CustomerSize] ( [fullname], [description]) VALUES ( @fullname, @description) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerStatus_Update] (@id 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @cnname		varchar(4000), @usname		varchar(4000), @twname		varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_CustomerStatus] SET [fullname]	 = @fullname, [description]	 = @description, [cnname]	= @cnname, [usname]	= @usname, [twname]	= @twname WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerStatus_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerStatus] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerStatus_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerStatus] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerStatus_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CRM_CustomerStatus] ( [fullname], [description]) VALUES ( @fullname, @description) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerStatus_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_CustomerStatus] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_Find_Creater] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT submiter,submitdate,submitertype from [CRM_Log] WHERE ([customerid] = @id) and ([logtype] = 'n') set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_Failfactor_Update] (@id	 	int, @fullname 	varchar(4000), @description 	varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS UPDATE CRM_Failfactor SET  fullname	 = @fullname, description	 = @description WHERE ( id	 = @id)

GO
alter procedure [CRM_Customize_SelectByUid] (@uid 	[int], @logintype 	[tinyint], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_Customize] WHERE ( [userid] = @uid and [logintype]	 = @logintype) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_Customize_Insert] (@userid_1 	int, @logintype 	tinyint, @row1col1_2 	int, @row1col2_3 	int, @row1col3_4 	int, @row1col4_5 	int, @row1col5_6 	int, @row1col6_7 	int, @row2col1_8 	int, @row2col2_9 	int, @row2col4_10 	int, @row2col3_11 	int, @row2col5_12 	int, @row2col6_13 	int, @row3col1_14 	int, @row3col2_15 	int, @row3col3_16 	int, @row3col4_17 	int, @row3col5_18 	int, @row3col6_19 	int, @perpage_1 	int, @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO CRM_Customize ( userid, logintype, row1col1, row1col2, row1col3, row1col4, row1col5, row1col6, row2col1, row2col2, row2col4, row2col3, row2col5, row2col6, row3col1, row3col2, row3col3, row3col4, row3col5, row3col6, perpage) VALUES ( @userid_1, @logintype, @row1col1_2, @row1col2_3, @row1col3_4, @row1col4_5, @row1col5_6, @row1col6_7, @row2col1_8, @row2col2_9, @row2col4_10, @row2col3_11, @row2col5_12, @row2col6_13, @row3col1_14, @row3col2_15, @row3col3_16, @row3col4_17, @row3col5_18, @row3col6_19, @perpage_1) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerType_Update] (@id 	int, @fullname 	varchar(4000), @description 	varchar(4000),@workflowid int, @flag	int	output, @msg	varchar(4000)	output) AS UPDATE CRM_CustomerType SET  fullname	 = @fullname, description	 = @description,workflowid = @workflowid WHERE ( id	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_SellStatus_Update] (@id	 	int, @fullname 	varchar(4000), @description 	varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS UPDATE CRM_SellStatus SET  fullname	 = @fullname, description	 = @description WHERE ( id	 = @id)

GO
alter procedure [CRM_PaymentTerm_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_PaymentTerm] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_PaymentTerm_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_PaymentTerm] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_PaymentTerm_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CRM_PaymentTerm] ( [fullname], [description]) VALUES ( @fullname, @description) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_PaymentTerm_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_PaymentTerm] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ShareEditToManager]( @crmId int, @managerId int, @flag integer output,@msg varchar(4000) output) AS IF EXISTS(SELECT id FROM CRM_ShareInfo WHERE relateditemid = @crmId AND sharetype = 1 AND userid = @managerId) UPDATE CRM_ShareInfo SET sharelevel = 2 WHERE relateditemid = @crmId AND sharetype = 1 AND userid = @managerId ELSE INSERT INTO CRM_ShareInfo(relateditemid, sharetype, sharelevel, userid,contents) VALUES(@crmId, 1, 2, @managerId,@managerId)

GO
alter procedure [DocSubscribe_UsateByDidSid]( @docid int, @hrmid int, @state char(1) , @flag integer output , @msg varchar(4000) output ) AS update DocSubscribe set state = @state where docid =  @docid and hrmid = @hrmid

 GO
alter procedure [DocSubscribe_updateSandO]( @id int , @state char(1) , @otherSubscribe  varchar(4000) , @flag integer output , @msg varchar(4000) output ) AS update DocSubscribe set state = @state,otherSubscribe=@otherSubscribe where id =  @id

 GO
alter procedure [DocSubscribe_update]( @id int , @docId int , @hrmId int , @ownerId int, @subscribeDate char(10), @approveDate char(10), @searchCase     varchar(4000) , @subscribeDesc  varchar(4000) , @otherSubscribe  varchar(4000) , @getBackDesc	   varchar(4000) , @state char(1), @flag integer output , @msg varchar(4000) output ) AS update DocSubscribe set docId=@docId,hrmId=@hrmId,ownerId=@ownerId,subscribeDate=@subscribeDate,approveDate=@approveDate,state=@state,searchCase=@searchCase,subscribeDesc=@subscribeDesc,getBackDesc=@getBackDesc,otherSubscribe=@otherSubscribe where id =  @id

  GO
alter procedure [DocSubscribe_SelectById]( @id int , @flag integer output , @msg varchar(4000) output ) AS select * from DocSubscribe where id =  @id

  GO
alter procedure [DocSubscribe_SelectByHrmId]( @HrmId int , @flag integer output , @msg varchar(4000) output ) AS select * from DocSubscribe where hrmId =  @HrmId

  GO
alter procedure [DocSubscribe_SelectByDocId]( @Docid int , @flag integer output , @msg varchar(4000) output ) AS select * from DocSubscribe where docid =  @Docid

  GO
alter procedure [DocSubscribe_SByDIdAndHId]( @Docid int, @HrmId int , @flag integer output , @msg varchar(4000) output ) AS select * from DocSubscribe where docid= @Docid and hrmId =  @HrmId

GO
alter procedure [DocImageFile_UpdateByDocidVid] (@docid_1 	int, @imagefileid_2 int, @imagefilename_3 	varchar(4000), @imagefiledesc_4 	varchar(4000), @imagefilewidth_5 	int, @imagefileheight_6 	int, @imagefielsize_7 	int, @docfiletype_8 	char(1),@versionId_9 int, @versionDetail_10	varchar(4000) , @flag int output, @msg varchar(4000)   output)  AS UPDATE DocImageFile set imagefileid=@imagefileid_2,   imagefilename=@imagefilename_3, imagefiledesc=@imagefiledesc_4,   imagefilewidth=@imagefilewidth_5, imagefileheight=@imagefileheight_6,   imagefielsize=@imagefielsize_7,   docfiletype=@docfiletype_8,versionId=@versionId_9,versionDetail=@versionDetail_10 where docid=@docid_1 and versionId=@versionId_9

GO
alter procedure [DocImageFile_UpdateByDocid] (@docid_1 	int, @imagefileid_2 	int, @imagefilename_3 	varchar(4000), @imagefiledesc_4 	varchar(4000), @imagefilewidth_5 	int, @imagefileheight_6 	int, @imagefielsize_7 	int, @docfiletype_8 	char(1),@versionId_9	int,@versionDetail_10	varchar(4000) , @flag int output, @msg varchar(4000) output)  AS UPDATE DocImageFile set imagefileid=@imagefileid_2, imagefilename=@imagefilename_3, imagefiledesc=@imagefiledesc_4, imagefilewidth=@imagefilewidth_5, imagefileheight=@imagefileheight_6, imagefielsize=@imagefielsize_7, docfiletype=@docfiletype_8,versionId=@versionId_9,versionDetail=@versionDetail_10 where docid=@docid_1 and versionId=(select max(versionId) from DocImageFile where docid=@docid_1)

GO
alter procedure [DocImageFile_SelectByVersionId] (@versionId_1 	int, @flag int output, @msg varchar(4000) output)  AS select * from DocImageFile where versionId= @versionId_1

GO
alter procedure [DocImageFile_SelectByDocid] ( @docid_1   int, @flag int output, @msg varchar(4000) output ) AS select d2.* from DocImageFile d2 where  d2.docid= @docid_1 and d2.docfiletype<>'1'  and d2.docfiletype<>'11' and d2.isextfile = '1' order by d2.id, versionId desc

GO
alter procedure [DocImageFile_Insert] ( @docid_1 	int, @imagefileid_2 	int, @imagefilename_3 	varchar(4000), @imagefiledesc_4 	varchar(4000), @imagefilewidth_5 	int, @imagefileheight_6 	int, @imagefielsize_7 	int, @docfiletype_8 	char(1), @versionId_9	int, @versionDetail_10	varchar(4000) , @docImageId_11	int, @isextfile_12		varchar(4000),  @flag int output, @msg varchar(4000) output)    AS INSERT INTO DocImageFile ( docid, imagefileid, imagefilename, imagefiledesc, imagefilewidth, imagefileheight, imagefielsize, docfiletype,versionId,versionDetail,id, isextfile)  VALUES ( @docid_1, @imagefileid_2, @imagefilename_3, @imagefiledesc_4, @imagefilewidth_5, @imagefileheight_6, @imagefielsize_7, @docfiletype_8,@versionId_9,@versionDetail_10,@docImageId_11, @isextfile_12)

GO
alter procedure [DocImageFile_DByDocid] (@docid_1 	int , @flag int output, @msg varchar(4000) output)  AS declare @imagefileid_2 int declare imagefileid_cursor cursor for select imagefileid from DocImageFile where docid=@docid_1 and isextfile = '1' open imagefileid_cursor fetch next from imagefileid_cursor into @imagefileid_2 while @@fetch_status=0 begin update ImageFile set imagefileused=imagefileused-1 where imagefileid = @imagefileid_2 fetch next from imagefileid_cursor into @imagefileid_2 end close imagefileid_cursor deallocate imagefileid_cursor delete from DocImageFile where docid=@docid_1 select filerealpath from ImageFile where imagefileused = 0 delete ImageFile where imagefileused = 0

GO
alter procedure [CRM_ShareInfo_Update] ( @typeid_1 int , @customerid_1 int, @flag integer output , @msg varchar(4000) output ) as declare @theid_1 int, @all_cursor cursor, @relateditemid_1 int  , @sharetype_1 tinyint , @seclevel_1 tinyint  , @rolelevel_1 tinyint  , @sharelevel_1 tinyint  , @userid_1 int  , @departmentid_1 int  , @roleid_1 int  , @foralluser_1 tinyint  , @crmid_1 int  SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from CRM_T_ShareInfo WHERE relateditemid = @typeid_1 OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @theid_1 WHILE @@FETCH_STATUS = 0 begin  select   @sharetype_1 =sharetype, @seclevel_1 =seclevel , @rolelevel_1= rolelevel, @sharelevel_1 =sharelevel,@userid_1 =userid,@departmentid_1 =departmentid, @roleid_1 =roleid,@foralluser_1 =foralluser,@crmid_1 =crmid from CRM_T_ShareInfo WHERE id = @theid_1 insert INTO  CRM_ShareInfo (relateditemid ,	sharetype  ,seclevel ,rolelevel  ,sharelevel,userid ,departmentid ,	roleid,	foralluser ,crmid ) 			values(@customerid_1,@sharetype_1,@seclevel_1,@rolelevel_1,@sharelevel_1,@userid_1,@departmentid_1,			@roleid_1,@foralluser_1,@crmid_1) FETCH NEXT FROM @all_cursor INTO @theid_1 end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [CRM_ShareInfo_SelectbyID] (@id int , @flag integer output , @msg varchar(4000) output ) AS select * from CRM_ShareInfo where (id = @id ) set  @flag = 1 set  @msg = 'ok'

GO
alter procedure [CRM_ShareInfo_SbyRelateditemid] (@relateditemid int , @flag integer output , @msg varchar(4000) output ) AS select * from CRM_ShareInfo where ( relateditemid = @relateditemid and (isdefault is null or (isdefault=1 and sharelevel=3 and sharetype=1))) order by sharetype set  @flag = 1 set  @msg = 'ok'

GO
alter procedure [CRM_ShareInfo_Insert] (@relateditemid int, @sharetype tinyint, @seclevel  tinyint,@seclevelMax  tinyint, @rolelevel tinyint, @sharelevel tinyint, @userid int, @departmentid int, @roleid int, @foralluser tinyint, @contents int, @flag integer output, @msg varchar(4000) output ) AS INSERT INTO CRM_ShareInfo ( relateditemid, sharetype, seclevel, seclevelMax ,rolelevel, sharelevel, userid, departmentid, roleid, foralluser,contents ) VALUES ( @relateditemid , @sharetype , @seclevel , @seclevelMax ,@rolelevel , @sharelevel, @userid, @departmentid, @roleid, @foralluser, @contents  ) set @flag=1 set @msg='ok'

GO
alter procedure [CRM_ShareInfo_Delete] (@id int, @flag integer output, @msg varchar(4000) output ) AS DELETE from CRM_ShareInfo  WHERE ( id = @id) set @flag=1 set @msg='ok'

GO
alter procedure [DocUserselfCategory_Update] (@id_1 	[int], @userid_2 	[int], @name_3 	varchar(4000), @parentid_4 	[int], @parentids_5 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [DocUserselfCategory]  SET  [userid]	 = @userid_2, [name]	 = @name_3, [parentid]	 = @parentid_4, [parentids]	 = @parentids_5  WHERE ( [id]	 = @id_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [DocUserselfCategory_SelectByID] (@id_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS select * from [DocUserselfCategory]  WHERE ( [id]	 = @id_1)

GO
alter procedure [DocUserselfCategory_Insert] (@userid_1 	[int], @name_2 	varchar(4000), @parentid_3 	[int], @parentids_4 	varchar(4000), @createdate varchar(4000)  , @createtime varchar(4000) , @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [DocUserselfCategory] ( [userid], [name], [parentid], [parentids], [createdate], [createtime])  VALUES ( @userid_1, @name_2, @parentid_3, @parentids_4, @createdate, @createtime)  select max(id) from DocUserselfCategory set @flag = 1 set @msg = 'OK!'

GO
alter procedure [DocUserselfCategory_Delete] (@id_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [DocUserselfCategory]  WHERE ( [id]	 = @id_1)

GO
alter procedure [DocUserCategory_SSubByUser] @userid	int, @usertype	char(1), @flag	int	output, @msg	varchar(4000) output as select distinct subid from docusercategory where userid=@userid and usertype=@usertype

GO
alter procedure [DocUserCategory_SSecByUser] @userid	int, @usertype	char(1), @flag	int	output, @msg	varchar(4000) output as select distinct secid from docusercategory where userid=@userid and usertype=@usertype

GO
alter procedure [DocUserCategory_SMainByUser] @userid	int, @usertype	char(1), @flag	int	output, @msg	varchar(4000) output as select 'mainid' = id from DocMainCategory where id in ( select distinct mainid from docusercategory where userid=@userid and usertype=@usertype ) order by categoryorder

GO
alter procedure [DocUserCategory_SelectByUserId] (@userid	int, @flag	int output, @msg	varchar(4000)	output) as select * from DocShare where userid = @userid

GO
alter procedure [DocSysDefault_Update] (@fgpicwidth	smallint, @fgpicfixtype	char(1), @docdefmouldid	int, @docapprovewfid int , @flag	int output, @msg	varchar(4000)	output) as update DocSysDefault set fgpicwidth=@fgpicwidth,fgpicfixtype=@fgpicfixtype,docdefmouldid=@docdefmouldid,docapprovewfid=@docapprovewfid

GO
alter procedure [DocUserCategory_DeleleByUser] @userid	int, @usertype	char(1), @flag	int	output, @msg	varchar(4000) output as delete from DocUserCategory where userid=@userid and usertype=@usertype

GO
alter procedure [DocUserCategory_DByCategory] @secid	int, @flag	int	output, @msg	varchar(4000) output as delete from DocUserCategory where secid=@secid

GO
alter procedure [CRM_SellTimespan_update] ( @time_1 int, @spannum_1 int, @flag	int	output, @msg	varchar(4000)	output) as update CRM_SelltimeSpan set timespan = @time_1, spannum = @spannum_1

GO
alter procedure [CRM_SellTimespan_SelectAll] ( @flag	int	output, @msg	varchar(4000)	output) as select * from CRM_SelltimeSpan

GO
alter procedure [CRM_SellTimespan_insert] ( @time_1 int, @spannum_1 int, @flag	int	output, @msg	varchar(4000)	output) as insert INTO CRM_SelltimeSpan (timespan,spannum)values(@time_1,@spannum_1)

GO
alter procedure [FnaAccount_SelectPL] (@periodsfrom  char(6) , @periodsto     char(6) , @lastperiodsfrom  char(6) , @lastperiodsto  char(6) , @flag integer output , @msg varchar(4000) output)  AS create table #templedgercount( ledgerid  int , precount  decimal(18,3), lastcount  decimal(18,3) )  declare @ledgerid int , @precount decimal(18,3) , @lastcount decimal(18,3) declare ledgerid_cursor cursor for select id from FnaLedger where supledgerid =0 and ledgergroup ='5' open ledgerid_cursor fetch next from ledgerid_cursor into @ledgerid while @@fetch_status=0 begin set @precount = 0 set @lastcount = 0 select @precount = sum(trancaccount)-sum(trandaccount) from FnaAccount where ledgerid = @ledgerid and tranperiods >= @lastperiodsfrom and tranperiods <= @lastperiodsto select @lastcount = sum(trancaccount)-sum(trandaccount) from FnaAccount where ledgerid = @ledgerid and tranperiods >= @periodsfrom and tranperiods <= @periodsto  insert into #templedgercount values(@ledgerid,@precount,@lastcount) fetch next from ledgerid_cursor into @ledgerid end close ledgerid_cursor deallocate ledgerid_cursor select * from #templedgercount

GO
alter procedure [FnaAccount_SelectBalance] (@periodsfrom  char(6) , @periodsto     char(6) , @searchtype    int , @flag integer output , @msg varchar(4000) output)  AS create table #templedgercount( ledgerid  int , precount  decimal(18,3), lastcount  decimal(18,3) ) declare @thelastperiods  char(6) ,@thenewperiods char(6), @ledgerid int , @precount decimal(18,3) , @lastcount decimal(18,3) select @thelastperiods = max(tranperiods) from FnaAccount where tranperiods < @periodsfrom if @thelastperiods = null  set @thelastperiods = '000000' select @thenewperiods = max(tranperiods) from FnaAccount if @thenewperiods < @periodsto  set @periodsto = @thenewperiods  if @searchtype = 1 begin  declare ledgerid_cursor cursor for select id from FnaLedger where supledgerid =0 and ledgergroup ='1' open ledgerid_cursor fetch next from ledgerid_cursor into @ledgerid while @@fetch_status=0 begin set @precount = 0 set @lastcount = 0 if @thelastperiods = '000000' select @precount = tranremain  from FnaAccount where ledgerid = @ledgerid and tranperiods= @thelastperiods else select @precount = (-2*convert(int,tranbalance)+3)*tranremain  from FnaAccount where ledgerid = @ledgerid and tranperiods= @thelastperiods select @lastcount = (-2*convert(int,tranbalance)+3)*tranremain  from FnaAccount where ledgerid = @ledgerid and tranperiods= @periodsto  insert into #templedgercount values(@ledgerid,@precount,@lastcount) fetch next from ledgerid_cursor into @ledgerid end close ledgerid_cursor deallocate ledgerid_cursor select * from #templedgercount  end  if @searchtype = 2 begin  declare ledgerid_cursor cursor for select id from FnaLedger where supledgerid =0 and ledgergroup ='2' open ledgerid_cursor fetch next from ledgerid_cursor into @ledgerid while @@fetch_status=0 begin set @precount = 0 set @lastcount = 0 if @thelastperiods = '000000' select @precount = tranremain  from FnaAccount where ledgerid = @ledgerid and tranperiods= @thelastperiods else select @precount = (2*convert(int,tranbalance)-3)*tranremain  from FnaAccount where ledgerid = @ledgerid and tranperiods= @thelastperiods select @lastcount = (2*convert(int,tranbalance)-3)*tranremain  from FnaAccount where ledgerid = @ledgerid and tranperiods= @periodsto  insert into #templedgercount values(@ledgerid,@precount,@lastcount) fetch next from ledgerid_cursor into @ledgerid end close ledgerid_cursor deallocate ledgerid_cursor select * from #templedgercount  end  if @searchtype = 3 begin  declare ledgerid_cursor cursor for select id from FnaLedger where supledgerid =0 and ledgergroup ='3' open ledgerid_cursor fetch next from ledgerid_cursor into @ledgerid while @@fetch_status=0 begin set @precount = 0 set @lastcount = 0 if @thelastperiods = '000000' select @precount = tranremain  from FnaAccount where ledgerid = @ledgerid and tranperiods= @thelastperiods else select @precount = (2*convert(int,tranbalance)-3)*tranremain  from FnaAccount where ledgerid = @ledgerid and tranperiods= @thelastperiods select @lastcount = (2*convert(int,tranbalance)-3)*tranremain  from FnaAccount where ledgerid = @ledgerid and tranperiods= @periodsto  insert into #templedgercount values(@ledgerid,@precount,@lastcount) fetch next from ledgerid_cursor into @ledgerid end close ledgerid_cursor deallocate ledgerid_cursor select * from #templedgercount end

GO
alter procedure [FnaAccount_Select] @ledgerid_0 	int, @periods_1    char(6), @periods_2    char(6), @flag integer output , @msg varchar(4000) output AS declare @count int, @ledgerid int ,@tranperiods char(6),@trandaccount decimal(18,3) declare @trancaccount decimal(18,3),@tranremain decimal(18,3),@tmptranperiods char(6)  create table #temp ( ledgerid int , tranperiods char(6), trandaccount     decimal(18,3) , trancaccount     decimal(18,3) , tranremain      decimal(18,3) )  if  @ledgerid_0 = 0 begin declare account_cursor cursor for select ledgerid,tranperiods,trandaccount,trancaccount,tranremain from  FnaAccount where tranperiods >= @periods_1 and  tranperiods <= @periods_2  open account_cursor fetch next from account_cursor into @ledgerid,@tranperiods,@trandaccount,@trancaccount,@tranremain while @@fetch_status=0 begin insert into #temp values(@ledgerid,@tranperiods,@trandaccount,@trancaccount,@tranremain) fetch next from account_cursor into @ledgerid,@tranperiods,@trandaccount,@trancaccount,@tranremain end close account_cursor deallocate account_cursor  declare ledger_cursor cursor for select ledgerid from #temp group by ledgerid  open ledger_cursor fetch next from ledger_cursor into @ledgerid while @@fetch_status=0 begin set @tranremain = 0 select @count = count(id) ,@tmptranperiods = max(tranperiods) from FnaAccount where ledgerid = @ledgerid and tranperiods < @periods_1 if @count <> 0 begin select @tranremain = tranremain from FnaAccount where ledgerid = @ledgerid and tranperiods = @tmptranperiods end insert into #temp values(@ledgerid,null,null,null,@tranremain) fetch next from ledger_cursor into @ledgerid end close ledger_cursor deallocate ledger_cursor  select * from #temp order by ledgerid , tranperiods end else begin declare account1_cursor cursor for select tranperiods,trandaccount,trancaccount,tranremain from  FnaAccount where tranperiods >= @periods_1 and  tranperiods <= @periods_2 and ledgerid = @ledgerid_0  open account1_cursor fetch next from account1_cursor into @tranperiods,@trandaccount,@trancaccount,@tranremain while @@fetch_status=0 begin insert into #temp values(@ledgerid_0,@tranperiods,@trandaccount,@trancaccount,@tranremain) fetch next from account1_cursor into @tranperiods,@trandaccount,@trancaccount,@tranremain end close account1_cursor deallocate account1_cursor  set @tranremain = 0 select @count = count(id) ,@tmptranperiods = max(tranperiods) from FnaAccount where ledgerid = @ledgerid_0 and tranperiods < @periods_1 if @count <> 0 begin select @tranremain = tranremain from FnaAccount where ledgerid = @ledgerid_0 and tranperiods = @tmptranperiods end insert into #temp values(@ledgerid_0,null,null,null,@tranremain) select * from #temp order by ledgerid , tranperiods end

GO
alter procedure [FnaAccountList_Select] @ledgerid_0 	int, @periods_1    char(6), @periods_2    char(6), @flag integer output , @msg varchar(4000) output AS declare @count int, @ledgerid int ,@tranmark int ,@trandate char(10),@tranremark varchar(4000),@tranid int declare @tranaccount decimal(18,3),@tranremain decimal(18,3),@tranbalance char(1),@tmptranperiods char(6)  create table #temp ( ledgerid        int , tranid          int  , tranmark        int  , trandate        char(10)   , tranremark      varchar(4000) , tranaccount     decimal(18,3) , tranbalance     char(1) )  if  @ledgerid_0 = 0 begin declare account_cursor cursor for select ledgerid,tranid,tranmark,trandate,tranremark,tranaccount, tranbalance from  FnaAccountList where tranperiods >= @periods_1 and  tranperiods <= @periods_2  open account_cursor fetch next from account_cursor into @ledgerid,@tranid,@tranmark,@trandate,@tranremark,@tranaccount,@tranbalance while @@fetch_status=0 begin insert into #temp values(@ledgerid,@tranid,@tranmark,@trandate,@tranremark,@tranaccount,@tranbalance) fetch next from account_cursor into @ledgerid,@tranid,@tranmark,@trandate,@tranremark,@tranaccount,@tranbalance end close account_cursor deallocate account_cursor  declare ledger_cursor cursor for select ledgerid from #temp group by ledgerid  open ledger_cursor fetch next from ledger_cursor into @ledgerid while @@fetch_status=0 begin set @tranremain = 0 select @count = count(id) ,@tmptranperiods = max(tranperiods) from FnaAccount where ledgerid = @ledgerid and tranperiods < @periods_1 if @count <> 0 begin select @tranremain = tranremain from FnaAccount where ledgerid = @ledgerid and tranperiods = @tmptranperiods end insert into #temp values(@ledgerid,0,0,null,null,@tranremain,null) fetch next from ledger_cursor into @ledgerid end close ledger_cursor deallocate ledger_cursor  select * from #temp order by ledgerid , tranmark end else begin declare accountid_cursor cursor for select ledgerid,tranid,tranmark,trandate,tranremark,tranaccount, tranbalance from  FnaAccountList where tranperiods >= @periods_1 and  tranperiods <= @periods_2 and ledgerid = @ledgerid_0  open accountid_cursor fetch next from accountid_cursor into @ledgerid,@tranid,@tranmark,@trandate,@tranremark,@tranaccount,@tranbalance while @@fetch_status=0 begin insert into #temp values(@ledgerid,@tranid,@tranmark,@trandate,@tranremark,@tranaccount,@tranbalance) fetch next from accountid_cursor into @ledgerid,@tranid,@tranmark,@trandate,@tranremark,@tranaccount,@tranbalance end close accountid_cursor deallocate accountid_cursor  set @tranremain = 0 select @count = count(id) ,@tmptranperiods = max(tranperiods) from FnaAccount where ledgerid = @ledgerid_0 and tranperiods < @periods_1 if @count <> 0 begin select @tranremain = tranremain from FnaAccount where ledgerid = @ledgerid_0 and tranperiods = @tmptranperiods end insert into #temp values(@ledgerid,0,0,null,null,@tranremain,null) select * from #temp order by ledgerid , tranmark end

GO
alter procedure [FnaAccountList_Process] @departmentid_1 	[int], @tranperiods_2    char(6), @flag integer output , @msg varchar(4000) output AS declare @count integer declare @ledgerid int ,@tranid int ,@tranperiods char(6),@tranmark int,@trandate char(10) declare @tranremark varchar(4000),@tranaccount decimal(18,3),@tranbalance char(1)  select @count = count(id) from FnaYearsPeriodsList where fnayearperiodsid < @tranperiods_2 and isactive = '1' and isclose ='0'  if @count <> 0 begin select -1 return end  declare transaction_cursor cursor for select ledgerid, t.id, tranperiods, tranmark, trandate, d.tranremark, tranaccount, tranbalance from FnaTransaction t , FnaTransactionDetail d where t.id = d.tranid and trandepartmentid = @departmentid_1 and tranperiods = @tranperiods_2 and transtatus = '1'  open transaction_cursor fetch next from transaction_cursor into @ledgerid,@tranid,@tranperiods,@tranmark,@trandate, @tranremark,@tranaccount,@tranbalance while @@fetch_status=0 begin insert into FnaAccountList ( [ledgerid], [tranid], [tranperiods], [tranmark], [trandate], [tranremark], [tranaccount], [tranbalance])  VALUES ( @ledgerid, @tranid, @tranperiods, @tranmark, @trandate, @tranremark, @tranaccount, @tranbalance)  fetch next from transaction_cursor into @ledgerid,@tranid,@tranperiods,@tranmark,@trandate, @tranremark,@tranaccount,@tranbalance end close transaction_cursor deallocate transaction_cursor  update FnaTransaction set transtatus = '2' where trandepartmentid = @departmentid_1 and tranperiods = @tranperiods_2 and transtatus = '1'

GO
alter procedure [FavouriteTab_Insert] @resourceid int, @adddate char(20), @tabname char(100), @tabdesc char(200), @displayorder int, @flag integer output, @msg varchar(4000) output AS insert into favouritetab(resourceid,adddate,tabname,tabdesc,displayorder) VALUES (@resourceid,@adddate,@tabname,@tabdesc,@displayorder) select @@IDENTITY from favouritetab

GO
alter procedure [Favourite_Tab_Insert] @favouriteid int, @tabid int, @favouritealias char(100), @favouritepagesize int, @favouritetitlesize int, @showFavouritetitle int, @showfavouritelevel int, @resourceid int, @flag integer output, @msg varchar(4000) output AS insert into favourite_tab(favouriteid,tabid,favouriteAlias,favouritepagesize,favouritetitlesize,showFavouritetitle,showfavouritelevel,resourceid) VALUES (@favouriteid,@tabid,@favouritealias,@favouritepagesize,@favouritetitlesize,@showFavouritetitle,@showfavouritelevel,@resourceid) select @@IDENTITY from favourite_tab

GO
alter procedure [DocUserView_DeletebyDocId] (@docid 	[int], @flag	int output, @msg	varchar(4000)	output) as delete from DocUserView where docid=@docid

GO
alter procedure [WorkTaskShareSet_Insert] (@taskid_1       int, @taskstatus_1	int,@sharetype_1	int, @seclevel_1	int, @rolelevel_1	int, @sharelevel_1	int, @userid_1	varchar(4000), @subcompanyid_1	varchar(4000), @departmentid_1	varchar(4000), @roleid_1	int, @foralluser_1	int, @sharetype_2	int, @seclevel_2	int, @rolelevel_2	int, @userid_2	varchar(4000), @subcompanyid_2	varchar(4000), @departmentid_2	varchar(4000), @roleid_2	int, @foralluser_2	int, @settype_1	int, @flag  	int output, @msg 	varchar output) as insert into WorkTaskShareSet(taskid,taskstatus,sharetype,seclevel,rolelevel,sharelevel,userid,subcompanyid, departmentid,roleid,foralluser,ssharetype,sseclevel,srolelevel,suserid,ssubcompanyid,sdepartmentid,sroleid,sforalluser,settype) values(@taskid_1,@taskstatus_1,@sharetype_1,@seclevel_1,@rolelevel_1,@sharelevel_1,@userid_1,@subcompanyid_1,@departmentid_1,@roleid_1,@foralluser_1,@sharetype_2, @seclevel_2,@rolelevel_2,@userid_2,@subcompanyid_2,@departmentid_2,@roleid_2,@foralluser_2,@settype_1)

GO
alter procedure [FileBackupIndex_Update] (@lastbackupimagefileid_1 	int, @lastbackupmailfileid_2 	int, @lastbackupdate_3 	char(10), @lastbackuptime_4 	char(8), @flag int output, @msg varchar(4000) output)  AS update FileBackupIndex set lastbackupimagefileid = @lastbackupimagefileid_1, lastbackupmailfileid = @lastbackupmailfileid_2, lastbackupdate = @lastbackupdate_3, lastbackuptime = @lastbackuptime_4

GO
alter procedure [FileBackupIndex_Select] (@flag int output, @msg varchar(4000) output)  AS select * from FileBackupIndex

GO
alter procedure [deleteVotingRemark] as declare @votingidtemp int declare @v_id int  declare voting_cursor cursor for select id from voting where status = 1 open voting_cursor fetch next from voting_cursor into @votingidtemp while @@fetch_status=0 begin select  @v_id = count(votingid) from votingoption where votingid = @votingidtemp if (@v_id = 0) delete from votingremark where votingid = @votingidtemp delete from votingresourceremark where votingid = @votingidtemp fetch next from voting_cursor into @votingidtemp end close voting_cursor deallocate voting_cursor

GO
alter procedure [cus_selectitembyid_new] @id varchar(4000) , @isbill varchar(4000) , @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT AS SELECT  * FROM    cus_SelectItem WHERE   fieldid = @id ORDER BY fieldorder , fieldid SET @flag = 0 SET @msg = ''

GO
alter procedure [CRM_ViewLog1_Insert] @id	int, @viewer	int, @submitertype 	[tinyint], @viewdate	char(10), @viewtime	char(8), @ipaddress	char(15), @flag integer output , @msg varchar(4000) output AS insert into CRM_viewLog1 (id, viewer, submitertype, viewdate, viewtime, ipaddress) values(@id, @viewer, @submitertype, @viewdate, @viewtime, @ipaddress)

GO
alter procedure [CRM_TradeInfo_Update] (@id 	[int], @fullname 	varchar(4000), @rangelower 	varchar(4000), @rangeupper 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_TradeInfo] SET  [fullname]	 = @fullname, [rangelower]	 = convert(money,@rangelower), [rangeupper]	 = convert(money,@rangeupper) WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_TradeInfo_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_TradeInfo] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_TradeInfo_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_TradeInfo] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_TradeInfo_Insert] (@fullname 	varchar(4000), @rangelower 	varchar(4000), @rangeupper 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CRM_TradeInfo] ( [fullname], [rangelower], [rangeupper]) VALUES ( @fullname, convert(money,@rangelower), convert(money,@rangeupper)) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_SectorInfo_Update] (@id 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @parentid 	[int], @seclevel 	[int], @sectors	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_SectorInfo] SET  [fullname]	 = @fullname, [description]	 = @description, [parentid]	 = @parentid, [seclevel]	 = @seclevel, [sectors]	 = @sectors WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_SectorInfo_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_SectorInfo] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_SectorInfo_SelectAllInfo] ( @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_SectorInfo]  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_SectorInfo_SelectAll] (@parentid	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_SectorInfo] WHERE	([parentid] = @parentid)  order by orderkey asc  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_SectorInfo_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @parentid 	[int], @seclevel 	[int], @sectors	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS declare @id int set @id=1 if((select count(*) from CRM_SectorInfo)>0) begin select @id=max(id)+1 from CRM_SectorInfo end INSERT INTO [CRM_SectorInfo] (id, [fullname], [description], [parentid], [seclevel], [sectors]) VALUES (@id, @fullname, @description, @parentid, @seclevel, @sectors) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContractExch_Select] (@contractId_1 [int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_Contract_Exchange where contractId = @contractId_1 order by createDate desc, createTime

GO
alter procedure [CRM_ContractExch_Insert] (@contractId_1 [int]  , @name_1  varchar(4000)   , @remark_1 [text]  , @creater_1  [int]  , @createDate_1  [char] (10)   , @createTime_1  [char] (10)  , @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [CRM_Contract_Exchange] (contractId , name , remark , creater , createDate , createTime)  VALUES (@contractId_1 , @name_1, @remark_1, @creater_1 , @createDate_1 , @createTime_1)

GO
alter procedure [CRM_Contract_UpdateRemind] (@id_1 	[int] , @isRemind_1  [int] , @remindDay_1  [char] (10)  , @flag integer output, @msg varchar(4000) output)  AS UPDATE CRM_Contract SET isRemind = @isRemind_1, remindDay = @remindDay_1   where id = @id_1

GO
alter procedure [CRM_Contract_Update] (@id_1 	int , @name_1  varchar(4000)   , @typeId_1  int  , @docId_1  varchar(4000)   , @price_1  decimal(17, 2)  , @crmId_1  int  , @contacterId_1  int  , @startDate_1  char (10)   , @endDate_1  char (10)   , @manager_1  int  , @status_1  int  , @isRemind_1  int  , @remindDay_1  int  , @prjid_1 int, @flag integer output, @msg varchar(4000) output)  AS UPDATE CRM_Contract SET name = @name_1, typeId = @typeId_1 , docId = @docId_1 , price = @price_1 , crmId = @crmId_1 , contacterId = @contacterId_1 , startDate = @startDate_1 , endDate = @endDate_1 , manager = @manager_1 , status = @status_1 , isRemind = @isRemind_1 , remindDay = @remindDay_1 ,projid=@prjid_1  where id = @id_1

GO
alter procedure [CRM_Contract_SelectById] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_Contract  where id = @id_1

  GO
alter procedure [CRM_Contract_SelectAll] ( @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_Contract

GO
alter procedure [CRM_Contract_Select] (@crmId_1 [int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_Contract  where crmId = @crmId_1 order by id asc

GO
alter procedure [CRM_Contract_Insert] (@name_1  varchar(4000)   , @typeId_1  int  , @docId_1  varchar(4000)   , @price_1  decimal(17, 2)  , @crmId_1  int  , @contacterId_1  int  , @startDate_1  char (10)   , @endDate_1  char (10)   , @manager_1  int  , @status_1  int  , @isRemind_1  int  , @remindDay_1  int  , @creater_1  int  , @createDate_1  char (10)   , @createTime_1  char (10)  , @prjid_1 int, @flag integer output, @msg varchar(4000) output)  AS INSERT INTO CRM_Contract (name , typeId , docId , price , crmId , contacterId , startDate , endDate , manager , status , isRemind , remindDay , creater , createDate , createTime,projid)  VALUES ( @name_1, @typeId_1, @docId_1, @price_1 , @crmId_1 , @contacterId_1 , @startDate_1 , @endDate_1 , @manager_1 , @status_1 , @isRemind_1 , @remindDay_1 , @creater_1 , @createDate_1 , @createTime_1,@prjid_1) select top 1 * from CRM_Contract order by id desc

GO
alter procedure [CRM_Product_SelectByID] ( @id_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM CRM_ProductTable WHERE sellchanceid =@id_1

GO
alter procedure [CRM_Product_Delete] ( @id_1 int, @flag	int	output, @msg	varchar(4000)	output) as delete CRM_ProductTable WHERE sellchanceid=@id_1

GO
alter procedure [CRM_PaymentTerm_Update] (@id 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_PaymentTerm] SET  [fullname]	 = @fullname, [description]	 = @description WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerDesc_Update] (@id 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_CustomerDesc] SET  [fullname]	 = @fullname, [description]	 = @description WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerDesc_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerDesc] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerDesc_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerDesc] order by id asc  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerDesc_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CRM_CustomerDesc] ( [fullname], [description]) VALUES ( @fullname, @description) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContactWay_Update] (@id 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_ContactWay] SET  [fullname]	 = @fullname, [description]	 = @description WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContractPayMethod_Update1] ( @id_1 	[int] , @prjName_1  varchar(4000)   , @typeId_1  [int]  , @feetypeid_1 [int]  , @payPrice_1  [decimal](17, 2)  , @payDate_1  [char] (10)   , @qualification_1 varchar(4000) , @isRemind_1  [int]  , @flag integer output, @msg varchar(4000) output)  AS UPDATE CRM_ContractPayMethod SET prjName = @prjName_1 , typeId = @typeId_1, feetypeid = @feetypeid_1, payPrice = @payPrice_1, payDate = @payDate_1, qualification = @qualification_1 , isRemind = @isRemind_1 where id = @id_1

GO
alter procedure [CRM_ContractPayMethod_Update] (@id_1 	[int] , @factPrice_1  [decimal](17, 2)  , @factDate_1  [char] (10)  , @isFinish_1  [int]  , @isRemind_1  [int] , @flag integer output, @msg varchar(4000) output)  AS UPDATE CRM_ContractPayMethod SET factPrice = @factPrice_1, factDate = @factDate_1 , isFinish = @isFinish_1 , isRemind = @isRemind_1  where id = @id_1

GO
alter procedure [CRM_ContractPayMethod_Select] (@contractId_1 [int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_ContractPayMethod  where contractId = @contractId_1 order by id

GO
alter procedure [CRM_ContractPayMethod_Insert] ( @contractId_1  int  , @prjName_1  varchar(4000)   , @typeId_1  int  , @payPrice_1  decimal(17, 2)  , @payDate_1  char (10)   , @factPrice_1  decimal(17, 2)  , @factDate_1  char (10)  , @qualification_1 varchar(4000) , @isFinish_1  int  , @isRemind_1  int  , @feetypeid_1 int, @flag integer output, @msg varchar(4000) output)  AS INSERT INTO CRM_ContractPayMethod (contractId , prjName , typeId , payPrice , payDate , factPrice , factDate , qualification , isFinish , isRemind,feetypeid )  VALUES (@contractId_1, @prjName_1, @typeId_1, @payPrice_1 , @payDate_1 , @factPrice_1 , @factDate_1 , @qualification_1 , @isFinish_1 , @isRemind_1,@feetypeid_1)

GO
alter procedure [CRM_ContractPayMethod_Delete] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_ContractPayMethod] WHERE ( [id]	 = @id_1)

GO
alter procedure [CRM_ContractPayMethod_DelAll] (@contractId_1 	[int] , @IdStr_1 	varchar(4000) , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_ContractPayMethod] WHERE ( [contractId]	 = @contractId_1 and id not in(@IdStr_1))

GO
alter procedure [CRM_ContractProInfo_Del] ( @id_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output )  AS DELETE CRM_ContractProInfo WHERE id = @id_1

GO
alter procedure [CRM_ContractProInfo_CountNum] ( @proId_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output )  AS SELECT sum(factNum) FROM CRM_ContractProInfo WHERE proId = @proId_1

GO
alter procedure [HrmnetworkSegStr_Update] ( @id_1 int, @inceptipaddress_2 varchar(4000), @endipaddress_3 varchar(4000), @segmentdesc_7 varchar(4000), @flag integer output , @msg varchar(4000) output) AS UPDATE HrmnetworkSegStr  SET inceptipaddress= @inceptipaddress_2,endipaddress = @endipaddress_3,segmentdesc=@segmentdesc_7  WHERE ( id = @id_1)

GO
alter procedure [HrmnetworkSegStr_Insert] ( @inceptipaddress_1 varchar(4000), @endipaddress_2 varchar(4000), @createrid_3 int, @createdate_4 char(20), @createtime_5 char(20), @segmentdesc_6 varchar(4000), @flag int output, @msg varchar(4000) output) AS INSERT INTO HrmnetworkSegStr (inceptipaddress, endipaddress, createrid, createdate, createtime,segmentdesc) VALUES (@inceptipaddress_1, @endipaddress_2, @createrid_3, @createdate_4,@createtime_5, @segmentdesc_6)

GO
alter procedure [HrmnetworkSegStr_Delete] ( @id_1 	int, @flag integer output , @msg varchar(4000) output) AS DELETE HrmnetworkSegStr  WHERE ( id = @id_1)

GO
alter procedure [CrmShareDetail_SByResourceId] (@resourceid_1 int , @flag	[int]	output, @msg	varchar(4000)	output) AS select crmid , sharelevel from CrmShareDetail where userid = @resourceid_1 and usertype = '1'

GO
alter procedure [CrmShareDetail_SByCrmId] (@crmid_1 int , @flag	[int]	output, @msg	varchar(4000)	output) AS select * from CrmShareDetail where crmid = @crmid_1

GO
alter procedure [CrmShareDetail_Insert] (@crmid_1 	[int], @userid_2 	[int], @usertype_3 	[int], @sharelevel_4 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CrmShareDetail] ( [crmid], [userid], [usertype], [sharelevel]) VALUES ( @crmid_1, @userid_2, @usertype_3, @sharelevel_4)

GO
alter procedure [CrmShareDetail_DByUserId] (@userid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CrmShareDetail] WHERE ( [userid]	 = @userid_1  and usertype = '1' )

GO
alter procedure [CrmShareDetail_DByCrmId] (@crmid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CrmShareDetail] WHERE ( [crmid]	 = @crmid_1)

GO
alter procedure [HrmList_Update] (@id int,@flag  integer output, @msg  varchar(4000) output ) AS update HrmListValidate  set validate_n=1 where id=@id set @flag=0 set @msg='ok'

GO
alter procedure [HrmLocations_Update] ( @id_1 	int, @locationname_2 	varchar(4000), @locationdesc_3 	varchar(4000), @address1_4 	varchar(4000), @address2_5 	varchar(4000), @locationcity_6 	varchar(4000), @postcode_7 	varchar(4000), @countryid_8 	int, @telephone_9 	varchar(4000), @fax_10 	varchar(4000), @showOrder_11 	decimal(15,2), @flag integer output, @msg varchar(4000) output ) AS UPDATE HrmLocations SET locationname	 = @locationname_2, locationdesc	 = @locationdesc_3, address1	 = @address1_4, address2	 = @address2_5, locationcity	 = @locationcity_6, postcode	 = @postcode_7, countryid	 = @countryid_8, telephone	 = @telephone_9, fax	 = @fax_10, showOrder	 = @showOrder_11 WHERE ( id	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmLocations_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmLocations where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmLocations_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmLocations set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmLocations_Insert] ( @locationname_1 	varchar(4000), @locationdesc_2 	varchar(4000), @address1_3 	varchar(4000), @address2_4 	varchar(4000), @locationcity_5 	varchar(4000), @postcode_6 	varchar(4000), @countryid_7 	int, @telephone_8 	varchar(4000), @fax_9 	varchar(4000), @showOrder_10 	decimal(15,2), @flag integer output, @msg varchar(4000) output ) AS INSERT INTO HrmLocations ( locationname, locationdesc, address1, address2, locationcity, postcode, countryid, telephone, fax, showOrder) VALUES ( @locationname_1, @locationdesc_2, @address1_3, @address2_4, @locationcity_5, @postcode_6, @countryid_7, @telephone_8, @fax_9, @showOrder_10) select max(id) from HrmLocations if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmCareerInviteStep_Insert] (@inviteid_1 	[int], @name_2 	varchar(4000), @startdate_3 	[char](10), @enddate_4 	[char](10), @assessor_5 	[int], @assessstartdate_6 	[char](10), @assessenddate_7 	[char](10), @informdate_8 	[char](10), @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [HrmCareerInviteStep] ( [inviteid], [name], [startdate], [enddate], [assessor], [assessstartdate], [assessenddate], [informdate])  VALUES (@inviteid_1, @name_2, @startdate_3, @enddate_4, @assessor_5, @assessstartdate_6, @assessenddate_7, @informdate_8)

GO
alter procedure [HrmCareerInvite_Update] (@id_1 	[int], @careername_2 	varchar(4000), @careerpeople_3 	[char](4), @careerage_4 	varchar(4000), @careersex_5 	[char](1), @careeredu_6 	[char](1), @careermode_7 	varchar(4000), @careeraddr_8 	varchar(4000), @careerclass_9 	varchar(4000), @careerdesc_10 	[text], @careerrequest_11 	[text], @careerremark_12 	[text], @lastmodid_13 	[int], @lastmoddate_14 	[char](10), @planid_15 	[char](10), @isweb_16 	[char](10), @flag integer output , @msg varchar(4000) output) AS UPDATE [HrmCareerInvite]  SET [careername]	 = @careername_2, [careerpeople]	 = @careerpeople_3, [careerage]	 = @careerage_4, [careersex]	 = @careersex_5, [careeredu]	 = @careeredu_6, [careermode]	 = @careermode_7, [careeraddr]	 = @careeraddr_8, [careerclass]	 = @careerclass_9, [careerdesc]	 = @careerdesc_10, [careerrequest]	 = @careerrequest_11, [careerremark]	 = @careerremark_12, [lastmodid]	 = @lastmodid_13, [lastmoddate]	 = @lastmoddate_14, careerplanid = @planid_15, isweb = @isweb_16 WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmCareerInvite_SelectById] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [HrmCareerInvite] WHERE ( [id]	 = @id)

GO
alter procedure [HrmCareerInvite_Select] ( @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [HrmCareerInvite]

GO
alter procedure [HrmCareerInvite_Insert] (@careername_1 	varchar(4000), @careerpeople_2 	[char](4), @careerage_3 	varchar(4000), @careersex_4 	[char](1), @careeredu_5 	[char](1), @careermode_6 	varchar(4000), @careeraddr_7 	varchar(4000), @careerclass_8 	varchar(4000), @careerdesc_9 	[text], @careerrequest_10 	[text], @careerremark_11 	[text], @createrid_12 	[int], @createdate_13 	[char](10), @planid_14 	[char](10), @isweb_15 	[char](10), @flag integer output , @msg varchar(4000) output) AS INSERT INTO [HrmCareerInvite] ( [careername], [careerpeople], [careerage], [careersex], [careeredu], [careermode], [careeraddr], [careerclass], [careerdesc], [careerrequest], [careerremark], [createrid], [createdate], careerplanid, isweb) VALUES ( @careername_1, @careerpeople_2, @careerage_3, @careersex_4, @careeredu_5, @careermode_6, @careeraddr_7, @careerclass_8, @careerdesc_9, @careerrequest_10, @careerremark_11, @createrid_12, @createdate_13, @planid_14, @isweb_15) select max(id) from HrmCareerInvite

GO
alter procedure [HrmCareerInvite_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output) AS DELETE [HrmCareerInvite] WHERE [id]	 = @id_1 delete HrmCareerInviteStep where inviteid = @id_1

  GO
alter procedure [HrmCareerApplyOtherInfo_Upd] (@applyid_2 	[int], @category_3 	[char](1), @contactor_4 	varchar(4000), @salarynow_5 	varchar(4000), @worktime_6 	[int], @salaryneed_7 	varchar(4000), @currencyid_8 	[int], @reason_9 	varchar(4000), @otherrequest_10 	varchar(4000), @selfcomment_11 	[text], @flag int output, @msg varchar(4000) output) AS  UPDATE [HrmCareerApplyOtherInfo] SET [category] =@category_3, [contactor]=@contactor_4, [salarynow]=@salarynow_5, [worktime]=@worktime_6, [salaryneed]=@salaryneed_7, [currencyid]=@currencyid_8, [reason]=@reason_9, [otherrequest]=@otherrequest_10, [selfcomment]= @selfcomment_11 WHERE applyid = @applyid_2

GO
alter procedure [HrmCareerApplyOtherInfo_SByApp] (@applyid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmCareerApplyOtherInfo WHERE applyid  = @applyid

GO
alter procedure [HrmCareerPlanStep_Insert] (@planid_1 	[int], @stepname_2 	varchar(4000), @stepstartdate_3 	[char](10), @stependdate_4 	[char](10), @flag int output, @msg varchar(4000) output)  AS INSERT INTO [HrmCareerPlanStep] ([planid], [stepname], [stepstartdate], [stependdate])  VALUES ( @planid_1, @stepname_2, @stepstartdate_3, @stependdate_4)

GO
alter procedure [HrmCareerPlan_Update] (@id_1 	[int], @topic_2 	varchar(4000), @principalid_3 	[int], @informmanid_4 	[int], @emailmould_5 	[int], @startdate_6 	[char](10), @budget_7 	[float], @budgettype_8 	[int], @memo_9 	[text], @flag int output, @msg varchar(4000) output)  AS UPDATE [HrmCareerPlan]  SET      [topic]	 = @topic_2, [principalid]	 = @principalid_3, [informmanid]	 = @informmanid_4, [emailmould]	 = @emailmould_5, [startdate]	 = @startdate_6, [budget]	 = @budget_7, [budgettype]	 = @budgettype_8, [memo]	 = @memo_9  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmCareerPlan_Insert] (@topic_1 	varchar(4000), @principalid_2 	[int], @informmanid_3 	[int], @emailmould_4 	[int], @startdate_5 	[char](10), @budget_6 	[float], @budgettype_7 	[int], @memo_8 	[text], @flag int output, @msg varchar(4000) output) AS INSERT INTO [HrmCareerPlan] ( [topic], [principalid], [informmanid], [emailmould], [startdate], [budget], [budgettype], [memo])  VALUES (@topic_1, @principalid_2, @informmanid_3, @emailmould_4, @startdate_5, @budget_6, @budgettype_7, @memo_8) select max(id) from HrmCareerPlan

GO
alter procedure [HrmCareerPlan_Finish] (@id_1 	[int], @enddate_2 	[char](10), @fare_3 	[float], @faretype_4 	[int], @advice_5 	[text], @flag int output, @msg varchar(4000) output)  AS UPDATE [HrmCareerPlan]  SET      [enddate]	 = @enddate_2, [fare]	         = @fare_3, [faretype]	 = @faretype_4, [advice]	 = @advice_5  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmCareerPlan_Delete] (@id_1 	[int], @flag int output, @msg varchar(4000) output)  AS DELETE [HrmCareerPlan]  WHERE ( [id]	 = @id_1) delete HrmCareerPlanStep where planid = @id_1

GO
alter procedure [CRM_CustomerCredit_Insert] (@CreditAmount_1  [decimal](10, 2)  , @CreditTime_1  [int]  , @currencytype_1  [int]  , @flag integer output, @msg varchar(4000) output) AS INSERT INTO [CRM_CustomerCredit] (CreditAmount,CreditTime,currencytype) VALUES(@CreditAmount_1, @CreditTime_1, @currencytype_1)

GO
alter procedure [HrmCareerApplyOtherIndo_In] (@applyid_2 	[int], @category_3 	[char](1), @contactor_4 	varchar(4000), @salarynow_5 	varchar(4000), @worktime_6 	[int], @salaryneed_7 	varchar(4000), @currencyid_8 	[int], @reason_9 	varchar(4000), @otherrequest_10 	varchar(4000), @selfcomment_11 	[text], @flag int output, @msg varchar(4000) output) AS INSERT INTO [HrmCareerApplyOtherInfo] ([applyid], [category], [contactor], [salarynow], [worktime], [salaryneed], [currencyid], [reason], [otherrequest], [selfcomment])  VALUES (@applyid_2, @category_3, @contactor_4, @salarynow_5, @worktime_6, @salaryneed_7, @currencyid_8, @reason_9, @otherrequest_10, @selfcomment_11)

  GO
alter procedure [HrmCareerApplyHire] (@resourceid_1 	[int], @flag int output, @msg varchar(4000) output)  as delete HrmCareerApply where id = @resourceid_1  delete HrmInterview where resourceid = @resourceid_1  delete HrmInterviewAssess where resourceid = @resourceid_1  delete HrmInterviewResult where resourceid = @resourceid_1  delete HrmCareerApplyOtherInfo where applyid = @resourceid_1

GO
alter procedure [HrmCareerApply_UpdateBasic] (@id_1 int, @lastname_2 varchar(4000), @sex_3 char(1), @jobtitle_4 int, @homepage_5 varchar(4000), @email_6 varchar(4000), @homeaddress_7 varchar(4000), @homepostcode_8 varchar(4000), @homephone_9 varchar(4000), @inviteid_10 int, @picture_11 int, @flag int output, @msg varchar(4000) output) as  Update HrmCareerApply Set lastname = @lastname_2, sex = @sex_3, jobtitle = @jobtitle_4, homepage = @homepage_5, email = @email_6, homeaddress = @homeaddress_7 , homepostcode = @homepostcode_8, homephone = @homephone_9, careerinviteid = @inviteid_10, picture = @picture_11 WHERE id = @id_1

GO
alter procedure [HrmCareerApply_Update] (@id_1  	[int], @judge 	[char](1), @flag  integer output, @msg varchar(4000) output)  AS if @judge='0' begin UPDATE [HrmCareerApply] SET  [ischeck]	 = 1 WHERE ( [id]	 = @id_1) end else begin UPDATE [HrmCareerApply] SET  [ishire]	 = 1 WHERE ( [id]	 = @id_1) end

  GO
alter procedure [HrmCareerApply_U] (@ischeck [char](1), @ishire		[char](1), @careerid	[int], @firstname_2 	varchar(4000), @lastname_3 	varchar(4000), @titleid_4 	[int], @sex_5 	[char](1), @birthday_6 	[char](10), @nationality_7 	[int], @defaultlanguage_8 	[int], @certificatecategory_9 	varchar(4000), @certificatenum_10 	varchar(4000), @nativeplace_11 	varchar(4000), @educationlevel_12 	[char](1), @bememberdate_13 	[char](10), @bepartydate_14 	[char](10), @bedemocracydate_15 	[char](10), @regresidentplace_16 	varchar(4000), @healthinfo_17 	[char](1), @residentplace_18 	varchar(4000), @policy_19 	varchar(4000), @degree_20 	varchar(4000), @height_21 	varchar(4000), @homepage_22 	varchar(4000), @maritalstatus_23 	[char](1), @marrydate_24 	[char](10), @train_25 	[text], @NumberId varchar(4000), @email_26 	varchar(4000), @homeaddress_27 	varchar(4000), @homepostcode_28 	varchar(4000), @homephone_29 	varchar(4000), @category_3 	[char](1), @contactor_4 	varchar(4000), @major_5 	varchar(4000), @salarynow_6 	varchar(4000), @worktime_7 	varchar(4000), @salaryneed_8 	varchar(4000), @currencyid_9 	[int], @reason_10 	varchar(4000), @otherrequest_11 	varchar(4000), @selfcomment_12 	[text], @createdate		[char](10), @id_1 	[int],  @flag integer output, @msg varchar(4000) output) AS if @nationality_7=0 set @nationality_7= null if @defaultlanguage_8=0 set @defaultlanguage_8= null UPDATE [HrmCareerApply] SET ischeck=@ischeck, ishire=@ishire, [careerid]=@careerid, [firstname]=@firstname_2, [lastname]=@lastname_3, [titleid]=@titleid_4, [sex]=@sex_5, [birthday]=@birthday_6, [nationality]=@nationality_7, [defaultlanguage]=@defaultlanguage_8, [certificatecategory]=@certificatecategory_9, [certificatenum]=@certificatenum_10, [nativeplace]=@nativeplace_11, [educationlevel]=@educationlevel_12, [bememberdate]=@bememberdate_13, [bepartydate]=@bepartydate_14, [bedemocracydate]=@bedemocracydate_15, [regresidentplace]=@regresidentplace_16, [healthinfo]=@healthinfo_17, [residentplace]=@residentplace_18, [policy]=@policy_19, [degree]=@degree_20, [height]=@height_21, [homepage]=@homepage_22, [maritalstatus]=@maritalstatus_23, [marrydate]=@marrydate_24, [train]=@train_25, NumberId=@NumberId, [email]=@email_26, [homeaddress]=@homeaddress_27, [homepostcode]=@homepostcode_28, [homephone]=@homephone_29, createrid=@id_1, createdate=@createdate  WHERE [id]=@id_1  update [HrmCareerApplyOtherInfo] set  [category]=@category_3, [contactor]=@contactor_4, [major]=@major_5, [salarynow]=@salarynow_6, [worktime]=@worktime_7, [salaryneed]=@salaryneed_8, [currencyid]=@currencyid_9, [reason]=@reason_10, [otherrequest]=@otherrequest_11, [selfcomment]=@selfcomment_12 where [applyid]=@id_1

GO
alter procedure [HrmCareerApply_SelectId] ( @id int, @flag integer output, @msg varchar(4000) output) as select firstname, lastname from HrmCareerApply where id=@id

GO
alter procedure [HrmCareerApply_SelectById] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmCareerApply WHERE id  = @id

GO
alter procedure [HrmCareerApply_Pass] (@resourceid_1 	[int], @stepid_2 	[int], @flag int output, @msg varchar(4000) output) as update HrmCareerApply set nowstep = @stepid_2, isinform = 0 where id = @resourceid_1

GO
alter procedure [HrmCareerApply_ModInfo] (@id_1 int, @lastmodid_2 int, @lastmoddate_3 char(10), @flag int output, @msg varchar(4000) output) as update HrmCareerApply set lastmodid = @lastmodid_2, lastmoddate = @lastmoddate_3 where id = @id_1

 GO
alter procedure [HrmCareerApply_InsertPer] ( @id_1 int, @birthday_2 char(10), @folk_3 varchar(4000), @nativeplace_4 varchar(4000), @regresidentplace_5 varchar(4000), @maritalstatus_6 char(1), @policy_7 varchar(4000), @bememberdate_8 char(10), @bepartydate_9 char(10), @islabouunion_10 char(1), @educationlevel_11 int, @degree_12 varchar(4000), @healthinfo_13  char(1), @height_14 decimal(38,2), @weight_15 decimal(38,2), @residentplace_16 varchar(4000), @tempresidentnumber_18 varchar(4000), @certificatenum_19 varchar(4000), @flag int output, @msg varchar(4000) output) AS UPDATE HrmCareerApply SET birthday = @birthday_2, folk = @folk_3, nativeplace = @nativeplace_4, regresidentplace = @regresidentplace_5, maritalstatus = @maritalstatus_6, policy = @policy_7, bememberdate = @bememberdate_8, bepartydate = @bepartydate_9, islabouunion = @islabouunion_10, educationlevel = @educationlevel_11, degree = @degree_12, healthinfo = @healthinfo_13, height = @height_14, weight = @weight_15, residentplace = @residentplace_16, tempresidentnumber = @tempresidentnumber_18, certificatenum = @certificatenum_19 WHERE id = @id_1

GO
alter procedure [KPI_SelectAll]( @flag int output, @msg varchar(4000) output )AS SELECT * FROM HrmPerformanceGoal SET @flag = 1 SET @msg = 'OK!'

GO
alter procedure [IWorkflowCenterSettingDetailP] as declare  @id_1          integer; declare  @eid_1         integer; declare  @typeids_1     varchar(4000); declare  @flowids_1     varchar(4000); declare  @nodeids_1     varchar(4000); declare  @tabid_1       integer;  declare  @content_1		varchar(4000);  declare  @srcfrom_1     integer; declare  @type_1        varchar(4000); declare  @i integer; begin  DELETE from workflowcentersettingdetail ; declare share_cursor cursor for select id,eid, typeids, flowids, nodeids, tabid from hpsetting_wfcenter  open share_cursor fetch next from share_cursor into @id_1,@eid_1,@typeids_1,@flowids_1,@nodeids_1,@tabid_1 while @@fetch_status=0 begin set	@srcfrom_1 = @id_1; if(@typeids_1!='') begin set @type_1='typeid'; set @i=charindex(',',@typeids_1);  while @i>0 begin   set @content_1 = LEFT(@typeids_1,@i-1);  insert into workflowcentersettingdetail (  eid, tabid, type, content, srcfrom )values(  @eid_1, @tabid_1, @type_1, @content_1, @srcfrom_1 ); set @typeids_1 = RIGHT(@typeids_1,LEN(@typeids_1)-@i); set @i=charindex(',',@typeids_1); end set @content_1 = @typeids_1; insert into workflowcentersettingdetail (  eid, tabid, type, content, srcfrom )values(  @eid_1, @tabid_1, @type_1, @content_1, @srcfrom_1 ); end if(@flowids_1!='') begin set @type_1='flowid'; set @i=charindex(',',@flowids_1);  while @i>0 begin   set @content_1 = LEFT(@flowids_1,@i-1);  insert into workflowcentersettingdetail (  eid, tabid, type, content, srcfrom )values(  @eid_1, @tabid_1, @type_1, @content_1, @srcfrom_1 ); set @flowids_1 = RIGHT(@flowids_1,LEN(@flowids_1)-@i); set @i=charindex(',',@flowids_1); end set @content_1 = @flowids_1; insert into workflowcentersettingdetail (  eid, tabid, type, content, srcfrom )values(  @eid_1, @tabid_1, @type_1, @content_1, @srcfrom_1 ); end if(@nodeids_1!='') begin set @type_1='nodeid'; set @i=charindex(',',@nodeids_1);  while @i>0 begin  set @content_1 = LEFT(@nodeids_1,@i-1);  insert into workflowcentersettingdetail (  eid, tabid, type, content, srcfrom )values(  @eid_1, @tabid_1, @type_1, @content_1, @srcfrom_1 ); set @nodeids_1 = RIGHT(@nodeids_1,LEN(@nodeids_1)-@i); set @i=charindex(',',@nodeids_1); end set @content_1 = @nodeids_1; insert into workflowcentersettingdetail (  eid, tabid, type, content, srcfrom )values(  @eid_1, @tabid_1, @type_1, @content_1, @srcfrom_1 ); end    fetch next from share_cursor into @id_1,@eid_1,@typeids_1,@flowids_1,@nodeids_1,@tabid_1 end close share_cursor deallocate share_cursor end
GO
alter procedure [int_BrowserbaseInfo_insert] ( @mark_1    varchar(4000), @hpid_2   int, @poolid_3     int, @regservice_4 varchar(4000), @brodesc_5	varchar(4000), @authcontorl_6 	varchar(4000), @w_fid_7 int, @w_nodeid_8 int, @w_actionorder_9  int, @w_enable_10       int, @w_type_11     int, @ispreoperator_12  int, @nodelinkid_13    int, @browsertype_14    int, @isbill_15   int, @url_16   varchar(4000), @flag 		int 	output , @msg 		varchar(4000) 	output ) as declare  @maxid_ varchar(4000); begin  insert into int_BrowserbaseInfo (mark,hpid,poolid,regservice,brodesc,authcontorl,w_fid,w_nodeid,w_actionorder,w_enable,w_type,ispreoperator,nodelinkid,browsertype,isbill,parurl,isdelete) values (@mark_1,@hpid_2,@poolid_3,@regservice_4,@brodesc_5,@authcontorl_6,@w_fid_7,@w_nodeid_8,@w_actionorder_9,@w_enable_10,@w_type_11,@ispreoperator_12,@nodelinkid_13,@browsertype_14,@isbill_15,@url_16,0);  select @maxid_=MAX(id)  from int_BrowserbaseInfo; select @maxid_ end;

 GO
alter procedure [CptUseLog_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from CptUseLog where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

 GO
alter procedure [CptUseLog_SelectByCapitalID] @capitalid int, @flag integer output , @msg varchar(4000) output  AS select * from CptUseLog where capitalid = @capitalid set  @flag = 0 set  @msg = '操作成功完成'

 GO
alter procedure [CptDepreMethod2_Insert] (@depreid_1 	[int], @time_2 	[decimal](9,3), @depreunit_3 	[decimal](5,3), @flag                             integer output, @msg                             varchar(4000) output ) AS INSERT INTO [CptDepreMethod2] ( [depreid], [time], [depreunit])  VALUES ( @depreid_1, @time_2, @depreunit_3)

 GO
alter procedure [CptDepreMethod2_Delete] (@id_1 	[int], @flag                   integer output, @msg                   varchar(4000) output )  AS DELETE [CptDepreMethod2]  WHERE ( [id]	 = @id_1)

 GO
alter procedure [CptDepreMethod2_DByDepreID] (@depreid_1 	[int], @flag                   integer output, @msg                   varchar(4000) output )  AS DELETE [CptDepreMethod2]  WHERE ( [depreid]	 = @depreid_1)

 GO
alter procedure [CptDepreMethod_Select] (@flag                             integer output, @msg                             varchar(4000) output ) AS select * from CptDepreMethod1 order by depretype if @@error<>0 begin set @flag=1 set @msg='查询折旧法成功' return end else begin set @flag=0 set @msg='查询折旧法失败' return end

 GO
alter procedure [CptCheckStockList_Update] (@id_1 	[int], @realnumber_2 	[int], @remark_3 	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output )  AS UPDATE [CptCheckStockList]  SET  [realnumber]	 = @realnumber_2, [remark]	 = @remark_3  WHERE ( [id]	 = @id_1)

 GO
alter procedure [CptCheckStockList_SByCheckSto] @checkstockid varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from CptCheckStockList where checkstockid =convert(int, @checkstockid) set  @flag = 0 set  @msg = '查询存储过程成功'

 GO
alter procedure [CptCheckStockList_Insert] (@checkstockid_1 	[int], @capitalid_2 	[int], @theorynumber_3 	[int], @realnumber_4 	[int], @price_5 	[decimal](10,2), @remark_6 	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output )  AS INSERT INTO [CptCheckStockList] ( [checkstockid], [capitalid], [theorynumber], [realnumber], [price], [remark])  VALUES ( @checkstockid_1, @capitalid_2, @theorynumber_3, @realnumber_4, @price_5, @remark_6)

 GO
alter procedure [CptCheckStockList_DByCheckSto] (@checkstockid_1 	[int], @flag                             integer output, @msg                             varchar(4000) output )  AS DELETE [CptCheckStockList]  WHERE ( [checkstockid]	 = @checkstockid_1)

 GO
alter procedure [CptCheckStock_Update] (@id_1 	[int], @checkstockno_2 	varchar(4000), @checkstockdesc_3 	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output )  AS UPDATE [CptCheckStock]  SET  [checkstockno]	 = @checkstockno_2, [checkstockdesc]	 = @checkstockdesc_3  WHERE ( [id]	 = @id_1)

   GO
alter procedure [CptCheckStock_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from CptCheckStock where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

 GO
alter procedure [CptCheckStock_Insert] (@checkstockno_1 	varchar(4000), @checkstockdesc_2 	varchar(4000), @departmentid_3 	[int], @location_4 	varchar(4000), @checkerid_5 	[int], @createdate_7 	varchar(4000), @checkstatus_9 	[char](1), @flag                             integer output, @msg                             varchar(4000) output )  AS INSERT INTO [CptCheckStock] ( [checkstockno], [checkstockdesc], [departmentid], [location], [checkerid], [createdate], [checkstatus])  VALUES ( @checkstockno_1, @checkstockdesc_2, @departmentid_3, @location_4, @checkerid_5, @createdate_7, @checkstatus_9) select max(id) from CptCheckStock

 GO
alter procedure [CptCheckStock_Delete] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output )  AS delete CptCheckStockList where checkstockid=@id_1  DELETE [CptCheckStock]  WHERE ( [id]	 = @id_1)

 GO
alter procedure [CptCheckStock_Approve] (@id_1 	[int], @approverid int, @approvedate char(10), @flag                             integer output, @msg                             varchar(4000) output )  AS UPDATE [CptCheckStock]  SET  [checkstatus]	 = '1', approverid = @approverid, approvedate = @approvedate  WHERE ( [id]	 = @id_1)

 GO
alter procedure [CptDepreMethod1_Update] (@id_1 	[int], @name_2 	varchar(4000), @description_3 	varchar(4000), @depretype_4 	[char](1), @timelimit_5 	[decimal](18,3), @startunit_6 	[decimal](5,3), @endunit_7 	[decimal](5,3), @deprefunc_8 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS UPDATE [CptDepreMethod1]  SET  [name]	 = @name_2, [description]	 = @description_3, [depretype]	 = @depretype_4, [timelimit]	 = @timelimit_5, [startunit]	 = @startunit_6, [endunit]	 = @endunit_7, [deprefunc]	 = @deprefunc_8  WHERE ( [id]	 = @id_1)

 GO
alter procedure [CptDepreMethod1_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CptDepreMethod1] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [CptDepreMethod1_Select] (@depretype		char(1), @flag                             integer output, @msg                             varchar(4000) output ) AS select * from CptDepreMethod1 where depretype = @depretype if @@error<>0 begin set @flag=1 set @msg='查询折旧法成功' return end else begin set @flag=0 set @msg='查询折旧法失败' return end

 GO
alter procedure [CptDepreMethod1_Insert] (@name_1 	varchar(4000), @description_2 	varchar(4000), @depretype_3 	[char](1), @timelimit_4 	[decimal](18,3), @startunit_5 	[decimal](5,3), @endunit_6 	[decimal](5,3), @deprefunc_7 	varchar(4000), @flag integer output, @msg varchar(4000) output) AS INSERT INTO [CptDepreMethod1] ( [name], [description], [depretype], [timelimit], [startunit], [endunit], [deprefunc])  VALUES ( @name_1, @description_2, @depretype_3, @timelimit_4, @startunit_5, @endunit_6, @deprefunc_7) select max(id) from CptDepreMethod1

 GO
alter procedure [CptDepreMethod1_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [CptDepreMethod1]  WHERE ( [id]	 = @id_1)

GO
alter procedure [int_browermark_Insert] ( @mark_1  varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output ) as declare @maxid_ varchar(4000); begin  insert into int_browermark (mark) values (@mark_1);  select @maxid_=MAX(id) from int_browermark;  update int_browermark set mark=@mark_1+@maxid_ where id=@maxid_; select mark  from int_browermark where id=@maxid_; end;

GO
alter procedure [int_authorizeRight_update] ( @id_1     int, @baseid_2  int, @type_3    varchar(4000), @resourceids_4    varchar(4000), @roleids_5	    varchar(4000), @wfids_6    varchar(4000), @ordernum_7 varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output ) as begin update int_authorizeRight set baseid=@baseid_2,type=@type_3,resourceids=@resourceids_4,roleids=@roleids_5,wfids=@wfids_6,ordernum=@ordernum_7 where id=@id_1; select @id_1 end;

GO
alter procedure [int_authorizeRight_Insert] ( @baseid_1  int, @type_2    varchar(4000), @resourceids_3    varchar(4000), @roleids_4	    varchar(4000), @wfids_5    varchar(4000), @ordernum_6 varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output ) as declare   @maxid_ varchar(4000); begin  insert into int_authorizeRight (baseid,type,resourceids,roleids,wfids,ordernum) values (@baseid_1,@type_2,@resourceids_3,@roleids_4,@wfids_5,@ordernum_6);  select @maxid_=MAX(id) from int_authorizeRight; select @maxid_ end;

 GO
alter procedure [CptCapitalState_Update] (@id_1 	[int], @name_2 	varchar(4000), @description_3 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS UPDATE [CptCapitalState]  SET  [name]	 = @name_2, [description]	 = @description_3  WHERE ( [id]	 = @id_1)

GO
alter procedure [CptCapitalAssortment_Select] @flag integer output , @msg varchar(4000) output AS select * from CptCapitalAssortment order by assortmentmark

 GO
alter procedure [CptCapitalAssortment_SByID] (@id_1 	[int], @flag integer output , @msg varchar(4000) output) AS select * from CptCapitalAssortment where id = @id_1

 GO
alter procedure [CptCapitalAssortment_Insert] ( @assortmentname_2 	varchar(4000), @assortmentmark	varchar(4000), @assortmentremark_6 	[text], @supassortmentid_7 	[int], @supassortmentstr_8 	varchar(4000), @flag integer output, @msg varchar(4000) output ) AS declare @count integer if @supassortmentid_7 <>0 begin  select @count = capitalcount from CptCapitalAssortment where id = @supassortmentid_7 if @count <> 0 begin select -1 return end  UPDATE CptCapitalAssortment SET subassortmentcount=subassortmentcount+1 WHERE id = @supassortmentid_7 end  INSERT INTO [CptCapitalAssortment] ([assortmentname],[assortmentmark], [assortmentremark], [supassortmentid], [supassortmentstr], [subassortmentcount], [capitalcount] )VALUES (@assortmentname_2, @assortmentmark,@assortmentremark_6, @supassortmentid_7, @supassortmentstr_8, 0, 0) select max(id) from CptCapitalAssortment

 GO
alter procedure [CptCapitalAssortment_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output ) AS declare @count integer , @supassortmentid int  select @count = capitalcount from CptCapitalAssortment where id = @id_1 if @count <> 0 begin select -1 return end select @count = subassortmentcount  from CptCapitalAssortment where id = @id_1 if @count <> 0 begin select -1 return end  select @supassortmentid = supassortmentid from CptCapitalAssortment where id= @id_1    update CptCapitalAssortment set subassortmentcount = subassortmentcount-1 where id= @supassortmentid DELETE [CptCapitalAssortment] WHERE [id] = @id_1

 GO
alter procedure [CptCapitalType_Update] (@id_1 	[int], @name_2 	varchar(4000), @description_3 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS UPDATE [CptCapitalType]  SET  [name]	 = @name_2, [description]	 = @description_3  WHERE ( [id]	 = @id_1)

 GO
alter procedure [CptCapitalType_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from CptCapitalType where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

 GO
alter procedure [CptCapitalType_Select] @flag integer output , @msg varchar(4000) output  AS select * from CptCapitalType set  @flag = 0 set  @msg = '操作成功完成'

 GO
alter procedure [CptCapitalType_Insert] (@name_1 	varchar(4000), @description_2 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [CptCapitalType] ( [name], [description])  VALUES ( @name_1, @description_2)

   GO
alter procedure [WorkflowReportShare_SByReport] (@reportid_1   int, @flag	int output, @msg	varchar(4000)	output) as select * from WorkflowReportShare where reportid = @reportid_1

GO
alter procedure [WorkflowReportShare_Insert] (@reportid_1       int, @sharetype_1	int, @seclevel_1 int,@seclevel_2 int, @rolelevel_1	tinyint, @sharelevel_1	tinyint, @userid_1	varchar(4000), @subcompanyid_1	varchar(4000), @departmentid_1	varchar(4000), @roleid_1 varchar(4000), @foralluser_1	tinyint, @crmid_1	int, @mutidepartmentid_1 varchar(4000),@allowlook_1 int,@flag	int output, @msg	varchar(4000)	output) as insert into WorkflowReportShare(reportid,sharetype,seclevel,seclevel2,rolelevel,sharelevel,userid,subcompanyid,departmentid,roleid,foralluser,crmid,mutidepartmentid,allowlook) values(@reportid_1,@sharetype_1,@seclevel_1,@seclevel_2,@rolelevel_1,@sharelevel_1,@userid_1,@subcompanyid_1,@departmentid_1,@roleid_1,@foralluser_1,@crmid_1,@mutidepartmentid_1,@allowlook_1)

GO
alter procedure [WorkflowReportShare_Delete] (@id	int, @flag	int output, @msg	varchar(4000)	output) as delete from WorkflowReportShare where id=@id

GO
alter procedure [Prj_PlanInfo_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_PlanInfo] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_PlanInfo_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_PlanInfo] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_PlanInfo_Insert] (@prjid_1 	[int], @subject_2 	varchar(4000), @begindate_3 	varchar(4000), @enddate_4 	varchar(4000), @begintime_5 	varchar(4000), @endtime_6 	varchar(4000), @resourceid_7 	[int], @content_8 	varchar(4000), @budgetmoney_9 	varchar(4000), @docid_10 	[int], @plansort_11 	[int], @plantype_12 	[int], @validate_13 	[tinyint], @flag integer output, @msg varchar(4000) output  )  AS INSERT INTO [Prj_PlanInfo] ( [prjid], [subject], [begindate], [enddate], [begintime], [endtime], [resourceid], [content], [budgetmoney], [docid], [plansort], [plantype], [validate_n])  VALUES ( @prjid_1, @subject_2, @begindate_3, @enddate_4, @begintime_5, @endtime_6, @resourceid_7, @content_8, @budgetmoney_9, @docid_10, @plansort_11, @plantype_12, @validate_13) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [Prj_PlanInfo_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [Prj_PlanInfo]  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [CRM_AddressType_Update] (@id 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_AddressType] SET  [fullname]	 = @fullname, [description]	 = @description WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_AddressType_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_AddressType] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_AddressType_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_AddressType] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_AddressType_InsertID] (@flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT top 1 id from CRM_AddressType ORDER BY id DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_AddressType_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CRM_AddressType] ( [fullname], [description], [candelete]) VALUES ( @fullname, @description, 'y') set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [CRM_AddressType_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS IF EXISTS(SELECT typeid FROM CRM_CustomerAddress WHERE typeid = @id) BEGIN SELECT -1 RETURN END DELETE [CRM_AddressType] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContacterLog_R_SById] (@customerid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_ContacterLog_Remind  where customerid = @customerid_1

GO
alter procedure [CRM_ContacterLog_R_Insert] (@customerid_1 	[int], @daytype_1	[int], @before_1	[int], @isremind_1	[int], @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [CRM_ContacterLog_Remind] ([customerid],[daytype],[before],[isremind]) VALUES ( @customerid_1, @daytype_1 , @before_1 , @isremind_1)

GO
alter procedure [Prj_Modify_Select] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_Modify] WHERE ( [projectid]	 = @id) ORDER BY modifydate DESC, modifytime DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Modify_Insert] (@projectid_1 	[int], @type_2 	[char](20), @fieldname_3 	varchar(4000), @modifydate_4 	varchar(4000), @modifytime_5 	varchar(4000), @original_6 	varchar(4000), @modified_7 	varchar(4000), @modifier_8 	[int], @submitertype 	[tinyint], @clientip_9 	[char](15), @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [Prj_Modify] ( [projectid], [type], [fieldname], [modifydate], [modifytime], [original], [modified], [modifier], [submitertype], [clientip])  VALUES ( @projectid_1, @type_2, @fieldname_3, @modifydate_4, @modifytime_5, @original_6, @modified_7, @modifier_8, @submitertype, @clientip_9)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Material_SelectAllPlan] (@prjid [int], @version varchar(4000), @material varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT t1.*,t2.wbscoding,t2.subject,t2.id as taskrecordid FROM [Prj_Material] as t1, [Prj_TaskInfo] as t2 WHERE ( t1.prjid	 = @prjid and t1.version like '%|' + @version + '|%' and t1.material = @material and t2.prjid	 = @prjid and t2.version = @version  and t1.taskid=t2.taskid ) order by t2.wbscoding  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Material_Insert] (@prjid 	[int], @taskid [int], @material 	 varchar(4000), @unit 	 varchar(4000), @version varchar(4000), @begindate 	varchar(4000), @enddate varchar(4000), @quantity [int], @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS INSERT INTO [Prj_Material] ( [prjid], [taskid], [material], [unit], [version], [begindate], [enddate], [quantity], [cost])  VALUES ( @prjid , @taskid , @material 	, @unit 	, @version, @begindate, @enddate, @quantity, @cost ) INSERT INTO [Prj_MaterialProcess] ( [prjid], [taskid], [material], [unit], [isactived])  VALUES ( @prjid , @taskid , @material 	, @unit 	, '0') set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Material_Delete] (@id [int], @version varchar(4000), @flag integer output, @msg varchar(4000) output )  AS update [Prj_Material] set version=replace(version, @version, '')  WHERE ( [id] = @id) delete [Prj_Material] WHERE ( [id] = @id and version='' )  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_MemberProcess_Update] (@id [int],  @relateid 	[int],  @begindate 	varchar(4000), @enddate varchar(4000), @workday [decimal] (10,1), @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS update [Prj_MemberProcess] set relateid=@relateid, begindate=@begindate, enddate=@enddate, workday=@workday, cost=@cost  WHERE ( [id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_MemberProcess_Insert] (@prjid 	[int], @taskid [int], @relateid 	[int],  @isactived [tinyint], @begindate 	varchar(4000), @enddate varchar(4000), @workday [decimal] (10,1), @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS INSERT INTO [Prj_MemberProcess] ( [prjid], [taskid], [relateid], [isactived], [begindate], [enddate], [workday], [cost])  VALUES ( @prjid , @taskid , @relateid , @isactived , @begindate, @enddate, @workday, @cost ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_MemberProcess_Delete] (@id [int],  @flag integer output, @msg varchar(4000) output )  AS update [Prj_MemberProcess] set [isactived] = '1'  WHERE ( [id] = @id)    set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_MaterialProcess_Delete] (@id [int],  @flag integer output, @msg varchar(4000) output )  AS update [Prj_MaterialProcess] set [isactived] = '1'  WHERE ( [id] = @id )  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_SearchMould_Update] (@id_1 	[int], @userid_2 	[int], @prjid_3 	varchar(4000), @status_4 	varchar(4000), @prjtype_5 	varchar(4000), @worktype_6 	[int], @nameopt_7 	[int], @name_8 	varchar(4000), @description_9 	varchar(4000), @customer_10 	[int], @parent_11 	[int], @securelevel_12 	[int], @department_13 	[int], @manager_14 	[int], @member_15 	[int],@procode_16 varchar(4000), @flag integer output, @msg varchar(4000) output )  AS UPDATE [Prj_SearchMould]  SET  [userid]	 = @userid_2, [prjid]	 = @prjid_3, [status]	 = @status_4, [prjtype]	 = @prjtype_5, [worktype]	 = @worktype_6, [nameopt]	 = @nameopt_7, [name]	 = @name_8, [description]	 = @description_9, [customer]	 = @customer_10, [parent]	 = @parent_11, [securelevel]	 = @securelevel_12, [department]	 = @department_13, [manager]	 = @manager_14, [member]	 = @member_15,[procode]=@procode_16  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [Prj_SearchMould_SelectByUserID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from  Prj_SearchMould where userid =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [Workflow_StaticReport_Update] @id     int, @name   varchar(4000), @description    varchar(4000), @pagename   varchar(4000), @module     int, @flag integer output , @msg varchar(4000) output as update workflow_StaticRpbase set name=@name, description=@description, pagename=@pagename, module=@module where id=@id

GO
alter procedure [Workflow_StaticReport_Select] @flag integer output , @msg varchar(4000) output as select * from workflow_StaticRpbase order by id

GO
alter procedure [Workflow_StaticReport_SByMU] @module     int, @userid     int, @usertype   int, @flag integer output , @msg varchar(4000) output as select t1.* from workflow_StaticRpbase t1,WorkflowReportShareDetail t2 where t1.module=@module and t1.reportid=t2.reportid and t2.userid=@userid and t2.usertype=@usertype

GO
alter procedure [Workflow_StaticReport_SByModu] @module     int, @flag integer output , @msg varchar(4000) output as select * from workflow_StaticRpbase where module=@module

GO
alter procedure [Workflow_StaticReport_SByID] @id     int, @flag integer output , @msg varchar(4000) output as select * from workflow_StaticRpbase where id=@id

GO
alter procedure [Workflow_StaticReport_Insert] @name   varchar(4000), @description    varchar(4000), @pagename   varchar(4000), @module     int, @flag integer output , @msg varchar(4000) output as declare @tmpid  int  insert into workflow_StaticRpbase(name,description,pagename,module) values (@name,@description,@pagename,@module)  select @tmpid=max(id) from workflow_StaticRpbase  update workflow_StaticRpbase set reportid=-id where id=@tmpid

GO
alter procedure [Workflow_StaticReport_Delete] @id     int, @flag integer output , @msg varchar(4000) output as delete from workflow_StaticRpbase where id=@id

GO
alter procedure [workflow_SelectItemSelectByid] @id varchar(4000) , @isbill varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from workflow_SelectItem where fieldid = @id and isbill = @isbill order by listorder,id set  @flag = 0 set  @msg = ''

GO
alter procedure [workflow_SelectItemSByvalue] (@id_1 varchar(4000) , @isbill_2 varchar(4000) , @selectvalue_3 integer , @flag integer output , @msg varchar(4000) output ) AS select * from workflow_SelectItem where fieldid = @id_1 and isbill = @isbill_2 and selectvalue = @selectvalue_3

GO
alter procedure [workflow_selectitembyid_new] @id varchar(4000) , @isbill varchar(4000) , @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT AS SELECT  * FROM    workflow_SelectItem WHERE   fieldid = @id AND isbill = @isbill AND ( cancel!='1' or cancel is null) ORDER BY listorder , id SET @flag = 0 SET @msg = ''

GO
alter procedure [workflow_selectitem_insert_new] ( @fieldid INT , @isbill INT , @selectvalue INT , @selectname varchar(4000) , @listorder NUMERIC(10, 2) , @isdefault CHAR(1) , @cancel2 varchar(4000), @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT ) AS INSERT  INTO workflow_selectitem ( fieldid , isbill , selectvalue , selectname , listorder , isdefault,cancel ) VALUES  ( @fieldid , @isbill , @selectvalue , @selectname , @listorder , @isdefault,@cancel2 )

GO
alter procedure [workflow_SelectItem_Insert] (@fieldid 		int, @isbill 		int, @selectvalue 	int, @selectname 	varchar(4000),@listorder numeric(10,2),@isdefault char(1), @flag integer output, @msg varchar(4000) output) AS insert into workflow_selectitem(fieldid,isbill,selectvalue,selectname,listorder,isdefault) values(@fieldid,@isbill,@selectvalue,@selectname,@listorder,@isdefault)

GO
alter procedure [workflow_SelectItem_DByFieldid] (@fieldid 		int, @isbill 		int, @flag integer output, @msg varchar(4000) output) AS delete from workflow_selectitem where fieldid=@fieldid and isbill=@isbill

GO
alter procedure [Prj_TaskInfo_SumCostMaterial] (@prjid [int], @version varchar(4000), @wbscoding varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT sum(t2.quantity*t2.cost) as cost FROM [Prj_TaskInfo] as t1, [Prj_Material] as t2 WHERE ( t1.prjid	 = @prjid and t1.version	 = @version and  t1.wbscoding like @wbscoding+'%' and t1.taskid = t2.taskid and t2.prjid = @prjid  and t2.version like '%|' + @version + '|%' ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskInfo_Sum] (@prjid [int], @version [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT sum(workday) as workday, min(begindate) as begindate, max(enddate) as enddate FROM [Prj_TaskInfo] WHERE ( prjid = @prjid and parentid = '0' and version = @version  and isdelete<>'1') set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskInfo_SelectMaxVersion] (@prjid [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT top 1 isactived, version FROM [Prj_TaskInfo] WHERE ( [prjid]	 = @prjid ) order by version desc set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskInfo_SelectMaxID] (@prjid [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT max(taskid) FROM [Prj_TaskInfo] WHERE ( [prjid]	 = @prjid ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskInfo_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_TaskInfo] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskInfo_SelectAll] (@prjid [int], @version [tinyint], @level_n [tinyint], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_TaskInfo] WHERE ( [prjid]	 = @prjid and [version]	 = @version and [level_n] <= @level_n and isdelete<>'1') order by parentids  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskInfo_NewPlan] (@prjid 	[int], @oldversion varchar(4000), @newversion varchar(4000), @flag integer output, @msg varchar(4000) output  ) AS declare	@taskid 	[int], @wbscoding 	varchar(4000), @subject 	varchar(4000), @version 	[tinyint], @begindate 	varchar(4000), @enddate 	varchar(4000), @workday        [decimal] (10,1), @content 	varchar(4000), @fixedcost	[decimal](10,2), @temp		[tinyint], @all_cursor	cursor select @temp=max(version) from prj_taskinfo where prjid=@prjid set @version=@temp+1 SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select  taskid , wbscoding, subject , begindate, enddate, workday, content, fixedcost from [Prj_TaskInfo] where prjid = @prjid and version=@temp OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @taskid,@wbscoding,@subject,@begindate,@enddate, @workday,@content,@fixedcost WHILE @@FETCH_STATUS = 0 begin INSERT INTO [Prj_TaskInfo] ( prjid, taskid , wbscoding, subject , version , begindate, enddate, workday, content, fixedcost)  VALUES ( @prjid, @taskid , @wbscoding, @subject , @version , @begindate, @enddate, @workday, @content, @fixedcost) FETCH NEXT FROM @all_cursor INTO @taskid,@wbscoding,@subject,@begindate,@enddate, @workday,@content,@fixedcost end CLOSE @all_cursor DEALLOCATE @all_cursor update [Prj_Member] set version = version +  @newversion   WHERE ([prjid] = @prjid  and [version] like '%' + @oldversion + '%' ) update [Prj_Tool] set version = version +  @newversion   WHERE ([prjid] = @prjid  and [version] like '%' + @oldversion + '%' ) update [Prj_Material] set version = version +  @newversion   WHERE ([prjid] = @prjid  and [version] like '%' + @oldversion + '%' )

GO
alter procedure [Prj_T_ShareInfo_SID] (@id int , @flag integer output , @msg varchar(4000) output ) AS select * from Prj_T_ShareInfo where (id = @id )

GO
alter procedure [Prj_T_ShareInfo_SbyRelateid] (@relateditemid int , @flag integer output , @msg varchar(4000) output ) AS select * from Prj_T_ShareInfo where ( relateditemid = @relateditemid ) order by sharetype

GO
alter procedure [Prj_T_ShareInfo_Insert] (@relateditemid int, @sharetype tinyint, @seclevel  tinyint, @rolelevel tinyint, @sharelevel tinyint, @userid int, @departmentid int, @roleid int, @foralluser tinyint,@subcompanyid int, @flag integer output, @msg varchar(4000) output ) AS INSERT INTO Prj_T_ShareInfo ( relateditemid, sharetype, seclevel, rolelevel, sharelevel, userid, departmentid, roleid, foralluser,subcompanyid ) VALUES ( @relateditemid , @sharetype , @seclevel , @rolelevel , @sharelevel, @userid, @departmentid, @roleid, @foralluser ,@subcompanyid )

GO
alter procedure [Prj_T_ShareInfo_Delete] (@id int, @flag integer output, @msg varchar(4000) output ) AS DELETE from Prj_T_ShareInfo  WHERE ( id = @id)

GO
alter procedure [Prj_ShareInfo_Update] ( @typeid_1 int , @prjid_1 int, @flag integer output , @msg varchar(4000) output ) as declare @theid_1 int, @all_cursor cursor, @relateditemid_1 int  , @sharetype_1 tinyint , @seclevel_1 tinyint  , @rolelevel_1 tinyint  , @sharelevel_1 tinyint  , @userid_1 int  , @departmentid_1 int  , @roleid_1 int  , @foralluser_1 tinyint  , @crmid_1 int SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from Prj_T_ShareInfo WHERE relateditemid = @typeid_1 OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @theid_1 WHILE @@FETCH_STATUS = 0 begin  select   @sharetype_1 =sharetype, @seclevel_1 =seclevel , @rolelevel_1= rolelevel, @sharelevel_1 =sharelevel,@userid_1 =userid,@departmentid_1 =departmentid, @roleid_1 =roleid,@foralluser_1 =foralluser,@crmid_1 =crmid from Prj_T_ShareInfo WHERE id = @theid_1 insert INTO  Prj_ShareInfo (relateditemid ,	sharetype  ,seclevel ,rolelevel  ,sharelevel,userid ,departmentid ,	roleid,	foralluser ,crmid,isdefault ) 			values(@prjid_1,@sharetype_1,@seclevel_1,@rolelevel_1,@sharelevel_1,@userid_1,@departmentid_1,			@roleid_1,@foralluser_1,@crmid_1,1) FETCH NEXT FROM @all_cursor INTO @theid_1 end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [Prj_ShareInfo_SelectbyID] (@id int , @flag integer output , @msg varchar(4000) output ) AS select * from Prj_ShareInfo where (id = @id ) set  @flag = 1 set  @msg = 'ok'

GO
alter procedure [Prj_ShareInfo_SbyRelateditemid] (@relateditemid int , @flag integer output , @msg varchar(4000) output ) AS select * from Prj_ShareInfo where ( relateditemid = @relateditemid ) order by sharetype set  @flag = 1 set  @msg = 'ok'

GO
alter procedure [Prj_ShareInfo_Insert] (@relateditemid int, @sharetype tinyint, @seclevel  int, @rolelevel int, @sharelevel int, @userid int, @departmentid int, @roleid int, @foralluser int,@subcompanyid int, @flag integer output, @msg varchar(4000) output ) AS INSERT INTO Prj_ShareInfo ( relateditemid, sharetype, seclevel, rolelevel, sharelevel, userid, departmentid, roleid, foralluser,subcompanyid ) VALUES ( @relateditemid , @sharetype , @seclevel , @rolelevel , @sharelevel, @userid, @departmentid, @roleid, @foralluser,@subcompanyid  ) set @flag=1 set @msg='ok'

GO
alter procedure [Prj_ShareInfo_Delete] (@id int, @flag integer output, @msg varchar(4000) output ) AS DELETE from Prj_ShareInfo  WHERE ( id = @id) set @flag=1 set @msg='ok'

GO
alter procedure [prj_selectitembyid_new] @id varchar(4000)  ,@isbill varchar(4000), @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT AS SELECT  * FROM    prj_SelectItem WHERE   fieldid = @id  AND ( cancel!='1' or cancel is null) ORDER BY listorder , id SET @flag = 0 SET @msg = ''

GO
alter procedure [prj_selectitem_insert_new] ( @fieldid INT , @isbill INT , @selectvalue INT , @selectname varchar(4000) , @listorder NUMERIC(10, 2) , @isdefault CHAR(1) , @cancel2 varchar(4000), @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT ) AS INSERT  INTO prj_selectitem ( fieldid , isbill , selectvalue , selectname , listorder , isdefault,cancel ) VALUES  ( @fieldid , @isbill , @selectvalue , @selectname , @listorder , @isdefault,@cancel2 )

GO
alter procedure [Prj_Material_Update] (@id [int], @version varchar(4000), @prjid 	[int], @taskid [int], @material 	 varchar(4000), @unit 	 varchar(4000),  @begindate 	varchar(4000), @enddate varchar(4000), @quantity [int], @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS update [Prj_Material] set version=replace(version, @version, '')  WHERE ( [id] = @id) delete [Prj_Material] WHERE ( [id] = @id and version='' ) INSERT INTO [Prj_Material] ( [prjid], [taskid], [material], [unit], [version], [begindate], [enddate], [quantity], [cost])  VALUES ( @prjid , @taskid , @material 	, @unit 	, @version, @begindate, @enddate, @quantity, @cost ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Material_SumProcess] (@prjid [int],  @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT material, sum(quantity) as quantity, sum(cost*quantity) as cost FROM [Prj_MaterialProcess] WHERE ( prjid	 = @prjid and ( isactived = '2' or isactived = '3' ) ) group by material set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Material_SumPlan] (@prjid [int], @version varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT material, sum(quantity) as quantity, sum(cost*quantity) as cost FROM [Prj_Material] WHERE ( prjid	 = @prjid and version like '%|' + @version + '|%' ) group by material set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Tool_Update] (@id [int], @version varchar(4000), @prjid 	[int], @taskid [int], @relateid 	[int], @begindate 	varchar(4000), @enddate varchar(4000), @workday [decimal] (10,1), @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS update [Prj_Tool] set version=replace(version, @version, '')  WHERE ( [id] = @id) delete [Prj_Tool] WHERE ( [id] = @id and version='' ) INSERT INTO [Prj_Tool] ( [prjid], [taskid], [relateid], [version], [begindate], [enddate], [workday], [cost])  VALUES ( @prjid , @taskid , @relateid 	, @version, @begindate, @enddate, @workday, @cost ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Tool_SumProcess] (@prjid [int],  @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT relateid, sum(workday) as workday, min(begindate) as begindate, max(enddate) as enddate, sum(cost*workday) as cost FROM [Prj_ToolProcess] WHERE ( prjid	 = @prjid and ( isactived = '2' or isactived = '3' )  ) group by relateid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Tool_SumPlan] (@prjid [int], @version varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT relateid, sum(workday) as workday, min(begindate) as begindate, max(enddate) as enddate, sum(cost*workday) as cost FROM [Prj_Tool] WHERE ( prjid	 = @prjid and version like '%|' + @version + '|%' ) group by relateid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProcessingType_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_ProcessingType] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProcessingType_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_ProcessingType] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProcessingType_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [Prj_ProcessingType] ( [fullname], [description])  VALUES ( @fullname, @description)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProcessingType_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [Prj_ProcessingType]  WHERE ( [id]	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Processing_Update] (@id_1 	[int], @title_2 	varchar(4000), @content_3 	varchar(4000), @type_4 	[int], @docid 	[int], @updatedate_5 	varchar(4000), @updatetime_6 	varchar(4000), @updater_7 	[int], @flag integer output, @msg varchar(4000) output )  AS UPDATE [Prj_Processing]  SET  [title]	 = @title_2, [content]	 = @content_3, [type]	 = @type_4, [docid]	 = @docid, [updatedate]	 = @updatedate_5, [updatetime]	 = @updatetime_6, [updater]	 = @updater_7  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [Prj_Processing_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_Processing] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Processing_SelectAll] ( @prjid	[int], @parentids	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_Processing] where ( [prjid]	 = @prjid) and ([parentids] like @parentids) order by parentids set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Processing_Insert] (@prjid_1 	[int], @planid_2 	[int], @title_3 	varchar(4000), @content_4 	varchar(4000), @type_5 	[int], @docid 	[int], @parentids_6 	varchar(4000), @submitdate_7 	varchar(4000), @submittime_8 	varchar(4000), @submiter_9 	[int], @flag integer output, @msg varchar(4000) output )  AS declare @count integer select @count = max(id)+1 from  [Prj_Processing] select @parentids_6 = @parentids_6+','+convert(varchar(4000),@count)  INSERT INTO [Prj_Processing] ( [prjid], [planid], [title], [content], [type], [docid], [parentids], [submitdate], [submittime], [submiter])  VALUES ( @prjid_1, @planid_2, @title_3, @content_4, @type_5, @docid, @parentids_6, @submitdate_7, @submittime_8, @submiter_9)  if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [Prj_Processing_Archive] (@id_1 	[int], @isprocessed_2 	[tinyint], @processdate_3 	varchar(4000), @processtime_4 	varchar(4000), @processor_5 	[int], @flag integer output, @msg varchar(4000) output )  AS UPDATE [Prj_Processing]  SET  [isprocessed]	 = @isprocessed_2, [processdate]	 = @processdate_3, [processtime]	 = @processtime_4, [processor]	 = @processor_5  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [PrjShareDetail_SByResourceId] (@resourceid_1 int , @flag	[int]	output, @msg	varchar(4000)	output) AS select prjid , sharelevel from PrjShareDetail where userid = @resourceid_1 and usertype = '1'

GO
alter procedure [PrjShareDetail_SByPrjId] (@prjid_1 int , @flag	[int]	output, @msg	varchar(4000)	output) AS select * from PrjShareDetail where prjid = @prjid_1

GO
alter procedure [PrjShareDetail_Insert] (@prjid_1 	[int], @userid_2 	[int], @usertype_3 	[int], @sharelevel_4 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [PrjShareDetail] ( [prjid], [userid], [usertype], [sharelevel]) VALUES ( @prjid_1, @userid_2, @usertype_3, @sharelevel_4)

GO
alter procedure [PrjShareDetail_DByUserId] (@userid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [PrjShareDetail] WHERE ( [userid]	 = @userid_1  and usertype = '1' )

GO
alter procedure [PrjShareDetail_DByPrjId] (@prjid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [PrjShareDetail] WHERE ( [prjid]	 = @prjid_1)

GO
alter procedure [Prj_ViewLog1_Insert] @id	int, @viewer	int, @submitertype 	[tinyint], @viewdate	char(10), @viewtime	char(8), @ipaddress	char(15), @flag integer output , @msg varchar(4000) output AS insert into Prj_viewLog1 (id, viewer, submitertype, viewdate, viewtime, ipaddress) values(@id, @viewer, @submitertype, @viewdate, @viewtime, @ipaddress)

GO
alter procedure [Prj_WorkType_Update] ( @id	 	int, @fullname 	varchar(4000), @description 	varchar(4000), @worktypecode varchar(4000),@dsporder decimal(10,2), @flag	int	output, @msg	varchar(4000)	output) AS UPDATE Prj_WorkType SET  fullname	 = @fullname, description = @description,worktypecode= @worktypecode,dsporder=@dsporder WHERE ( id	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_WorkType_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_WorkType] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_WorkType_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_WorkType] order by id asc set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_WorkType_Insert] ( @fullname_1 	varchar(4000), @description_2 	varchar(4000), @worktypecode varchar(4000),@dsporder decimal(10,2), @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO Prj_WorkType ( fullname, description,worktypecode,dsporder) VALUES ( @fullname_1, @description_2,@worktypecode,@dsporder) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_WorkType_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [Prj_WorkType]  WHERE ( [id]	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ToolProcess_Update] (@id [int],  @relateid 	[int],  @begindate 	varchar(4000), @enddate varchar(4000), @workday [decimal] (10,1), @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS update [Prj_ToolProcess] set relateid=@relateid, begindate=@begindate, enddate=@enddate, workday=@workday, cost=@cost  WHERE ( [id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ToolProcess_Insert] (@prjid 	[int], @taskid [int], @relateid 	[int],  @isactived [tinyint], @begindate 	varchar(4000), @enddate varchar(4000), @workday [decimal] (10,1), @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS INSERT INTO [Prj_ToolProcess] ( [prjid], [taskid], [relateid], [isactived], [begindate], [enddate], [workday], [cost])  VALUES ( @prjid , @taskid , @relateid , @isactived , @begindate, @enddate, @workday, @cost ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ToolProcess_Delete] (@id [int],  @flag integer output, @msg varchar(4000) output )  AS update [Prj_ToolProcess] set [isactived] = '1'  WHERE ( [id] = @id)    set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ViewedLog_Insert] ( @projId_1 int, @userId_1 int, @userType_1 char(1), @flag integer output , @msg varchar(4000) output) AS IF EXISTS (SELECT projId FROM Prj_ViewedLog WHERE projId = @projId_1 AND userId = @userId_1 AND userType = @userType_1) RETURN ELSE INSERT INTO Prj_ViewedLog (projId, userId, userType) VALUES ( @projId_1, @userId_1, @userType_1)

GO
alter procedure [SequenceIndex_Update] (@indexdesc_1 	varchar(4000), @flag integer output, @msg varchar(4000) output) AS  UPDATE [SequenceIndex]  SET  [currentid]	 = currentid+1  WHERE ( [indexdesc]	 = @indexdesc_1)   select currentid  from SequenceIndex where ( [indexdesc]	 = @indexdesc_1)

GO
alter procedure [SequenceIndex_SWFformdictid] (@flag int output, @msg varchar(4000) output)  AS select currentid from SequenceIndex where indexdesc='workflowformdictid' update SequenceIndex set currentid = currentid+1 where indexdesc='workflowformdictid'

GO
alter procedure [SequenceIndex_Sub] (@indexdesc_1 	varchar(4000), @flag integer output, @msg varchar(4000) output) AS  UPDATE [SequenceIndex] SET  [currentid]	 = currentid-1 WHERE ( [indexdesc]	 = @indexdesc_1)   select currentid  from SequenceIndex where ( [indexdesc]	 = @indexdesc_1)

GO
alter procedure [SequenceIndex_SMailSendId] (@flag int output, @msg varchar(4000) output)  AS select currentid from SequenceIndex where indexdesc='mailsendmain' update SequenceIndex set currentid = currentid+1 where indexdesc='mailsendmain'

GO
alter procedure [SequenceIndex_SelectVersionId] (@flag int output, @msg varchar(4000) output)  AS select currentid from SequenceIndex where indexdesc='versionId' update SequenceIndex set currentid = currentid+1 where indexdesc='versionId'

GO
alter procedure [DocSearchMould_Update] ( @id_1 	int, @mouldname_2 	varchar(4000), @userid_3 	int, @docsubject_4 	varchar(4000), @doccontent_5 	varchar(4000), @containreply_6 	char(1), @maincategory_7 	int, @subcategory_8 	int, @seccategory_9 	int, @docid_10 	int, @createrid_11 	int, @createrid2_12 	int, @departmentid_13 	int, @doclangurage_14 	tinyint, @hrmresid_15 	int, @itemid_16 	int, @itemmaincategoryid_17 	int, @crmid_18 	int, @projectid_19 	int, @financeid_20 	int, @docpublishtype_21 	char(1), @docstatus_22 	char(1), @keyword_23 	varchar(4000), @ownerid_24 	int, @ownerid2_25 	int, @docno_26 	varchar(4000), @doclastmoddatefrom_27 	char(10), @doclastmoddateto_28 	char(10), @docarchivedatefrom_29 	char(10), @docarchivedateto_30 	char(10), @doccreatedatefrom_31 	char(10), @doccreatedateto_32 	char(10), @docapprovedatefrom_33 	char(10), @docapprovedateto_34 	char(10), @replaydoccountfrom_35 	int, @replaydoccountto_36 	int, @accessorycountfrom_37 	int, @accessorycountto_38 	int, @doclastmoduserid_39 	int, @docarchiveuserid_40 	int, @docapproveuserid_41 	int, @assetid_42 	int, @treeDocFieldId_43 	int, @flag integer output, @msg varchar(4000) output) AS UPDATE DocSearchMould SET  mouldname	 = @mouldname_2, userid	 = @userid_3, docsubject	 = @docsubject_4, doccontent	 = @doccontent_5, containreply	 = @containreply_6, maincategory	 = @maincategory_7, subcategory	 = @subcategory_8, seccategory	 = @seccategory_9, docid	 = @docid_10, createrid	 = @createrid_11, createrid2	 = @createrid2_12, departmentid	 = @departmentid_13, doclangurage	 = @doclangurage_14, hrmresid	 = @hrmresid_15, itemid	 = @itemid_16, itemmaincategoryid	 = @itemmaincategoryid_17, crmid	 = @crmid_18, projectid	 = @projectid_19, financeid	 = @financeid_20, docpublishtype	 = @docpublishtype_21, docstatus	 = @docstatus_22, keyword	 = @keyword_23, ownerid	 = @ownerid_24, ownerid2	 = @ownerid2_25, docno	 = @docno_26, doclastmoddatefrom	 = @doclastmoddatefrom_27, doclastmoddateto	 = @doclastmoddateto_28, docarchivedatefrom	 = @docarchivedatefrom_29, docarchivedateto	 = @docarchivedateto_30, doccreatedatefrom	 = @doccreatedatefrom_31, doccreatedateto	 = @doccreatedateto_32, docapprovedatefrom	 = @docapprovedatefrom_33, docapprovedateto	 = @docapprovedateto_34, replaydoccountfrom	 = @replaydoccountfrom_35, replaydoccountto	 = @replaydoccountto_36, accessorycountfrom	 = @accessorycountfrom_37, accessorycountto	 = @accessorycountto_38, doclastmoduserid	 = @doclastmoduserid_39, docarchiveuserid	 = @docarchiveuserid_40, docapproveuserid	 = @docapproveuserid_41, assetid	 = @assetid_42, treeDocFieldId	 = @treeDocFieldId_43 WHERE ( id	 = @id_1)

GO
alter procedure [DocSearchMould_SelectByUserid] (@userid_1 	integer, @flag integer output, @msg varchar(4000) output) AS select id,mouldname from DocSearchMould where userid=@userid_1

GO
alter procedure [DocSearchMould_SelectByID] (@id_1 	integer, @flag integer output, @msg varchar(4000) output) AS select * from DocSearchMould where id=@id_1

GO
alter procedure [DocSearchMould_Insert] ( @mouldname_1 	varchar(4000), @userid_2 	int, @docsubject_3 	varchar(4000), @doccontent_4 	varchar(4000), @containreply_5 	char(1), @maincategory_6 	int, @subcategory_7 	int, @seccategory_8 	int, @docid_9 	int, @createrid_10 	int, @createrid2_11 	int, @departmentid_12 	int, @doclangurage_13 	tinyint, @hrmresid_14 	int, @itemid_15 	int, @itemmaincategoryid_16 	int, @crmid_17 	int, @projectid_18 	int, @financeid_19 	int, @docpublishtype_20 	char(1), @docstatus_21 	char(1), @keyword_22 	varchar(4000), @ownerid_23 	int, @ownerid2_24 	int, @docno_25 	varchar(4000), @doclastmoddatefrom_26 	char(10), @doclastmoddateto_27 	char(10), @docarchivedatefrom_28 	char(10), @docarchivedateto_29 	char(10), @doccreatedatefrom_30 	char(10), @doccreatedateto_31 	char(10), @docapprovedatefrom_32 	char(10), @docapprovedateto_33 	char(10), @replaydoccountfrom_34 	int, @replaydoccountto_35 	int, @accessorycountfrom_36 	int, @accessorycountto_37 	int, @doclastmoduserid_38 	int, @docarchiveuserid_39 	int, @docapproveuserid_40 	int, @assetid_41 	int, @treeDocFieldId_42 	int, @flag integer output, @msg varchar(4000) output) AS INSERT INTO DocSearchMould ( mouldname, userid, docsubject, doccontent, containreply, maincategory, subcategory, seccategory, docid, createrid, createrid2, departmentid, doclangurage, hrmresid, itemid, itemmaincategoryid, crmid, projectid, financeid, docpublishtype, docstatus, keyword, ownerid, ownerid2, docno, doclastmoddatefrom, doclastmoddateto, docarchivedatefrom, docarchivedateto, doccreatedatefrom, doccreatedateto, docapprovedatefrom, docapprovedateto, replaydoccountfrom, replaydoccountto, accessorycountfrom, accessorycountto, doclastmoduserid, docarchiveuserid, docapproveuserid, assetid, treeDocFieldId ) VALUES ( @mouldname_1, @userid_2, @docsubject_3, @doccontent_4, @containreply_5, @maincategory_6, @subcategory_7, @seccategory_8, @docid_9, @createrid_10, @createrid2_11, @departmentid_12, @doclangurage_13, @hrmresid_14, @itemid_15, @itemmaincategoryid_16, @crmid_17, @projectid_18, @financeid_19, @docpublishtype_20, @docstatus_21, @keyword_22, @ownerid_23, @ownerid2_24, @docno_25, @doclastmoddatefrom_26, @doclastmoddateto_27, @docarchivedatefrom_28, @docarchivedateto_29, @doccreatedatefrom_30, @doccreatedateto_31, @docapprovedatefrom_32, @docapprovedateto_33, @replaydoccountfrom_34, @replaydoccountto_35, @accessorycountfrom_36, @accessorycountto_37, @doclastmoduserid_38, @docarchiveuserid_39, @docapproveuserid_40, @assetid_41, @treeDocFieldId_42)  select max(id) from DocSearchMould

GO
alter procedure [VotingQuestion_Update] (@id    int, @votingid  int, @subject   varchar(4000), @description   varchar(4000), @ismulti       int, @isother       int, @ismultino     int, @flag integer output, @msg varchar(4000) output) AS update votingquestion set votingid=@votingid, subject=@subject, description=@description, ismulti=@ismulti, isother=@isother, ismultino=@ismultino where id=@id

GO
alter procedure [VotingQuestion_SelectByVoting] ( @votingid  int, @flag integer output, @msg varchar(4000) output) AS select * from votingquestion where votingid=@votingid order by showorder

GO
alter procedure [VotingQuestion_SelectByID] (@id  int, @flag integer output, @msg varchar(4000) output) AS select * from votingquestion where id=@id order by id

GO
alter procedure [VotingQuestion_Insert] ( @votingid  int, @subject   varchar(4000), @description   varchar(4000), @ismulti       int, @isother       int, @questioncount int, @ismultino int, @showorder int, @flag integer output, @msg varchar(4000) output ) AS insert into votingquestion ( votingid, subject, description, ismulti, isother, questioncount, ismultino, showorder) values ( @votingid, @subject, @description, @ismulti, @isother, @questioncount, @ismultino ,@showorder) select max(id) from votingquestion

GO
alter procedure [VotingQuestion_Delete] (@id    int, @flag integer output, @msg varchar(4000) output) AS delete from votingoption where questionid=@id delete from votingquestion where id=@id

GO
alter procedure [VotingMaintDetail_Insert] (@createrid    int, @approverid    int, @flag integer output, @msg varchar(4000) output) AS insert into votingmaintdetail (createrid,approverid) values (@createrid,@approverid)

GO
alter procedure [VotingMaintDetail_Delete] (@id    int, @flag integer output, @msg varchar(4000) output) AS delete from  votingmaintdetail where id=@id

GO
alter procedure [Voting_UpdateStatus] (@id    int, @status    int, @flag integer output, @msg varchar(4000) output) AS update voting set status=@status where id=@id

GO
alter procedure [Voting_UpdateCount] (@votingid    int, @flag integer output, @msg varchar(4000) output) AS update voting set votingcount=votingcount+1 where id=@votingid

GO
alter procedure [Voting_Update] ( @id    int, @subject   varchar(4000), @detail    text, @createrid int, @createdate    char(10), @createtime    char(8), @approverid    int, @approvedate   char(10), @approvetime   char(8), @begindate     char(10), @begintime     char(8), @enddate       char(10), @endtime       char(8), @isanony        varchar(4000), @docid         int, @crmid     int, @projid    int, @requestid int, @isSeeResult varchar(4000), @descr varchar(4000), @deploytype varchar(4000), @autoshowvote varchar(4000), @votetimecontrol varchar(4000), @votetimecontroltime varchar(4000), @forcevote varchar(4000), @remindtype varchar(4000), @remindtimebeforestart varchar(4000), @remindtimebeforeend varchar(4000), @istemplate varchar(4000), @flag integer output, @msg varchar(4000) output ) AS update voting set subject=@subject, detail=@detail, createrid=@createrid, createdate=@createdate, createtime=@createtime, approverid=@approverid, approvedate=@approvedate, approvetime=@approvetime, begindate=@begindate, begintime=@begintime, enddate=@enddate, endtime=@endtime, isanony=@isanony, docid=@docid, crmid=@crmid, projid=@projid, requestid=@requestid, isSeeResult=@isSeeResult , descr=@descr , deploytype=@deploytype , autoshowvote=@autoshowvote , votetimecontrol=@votetimecontrol , votetimecontroltime=@votetimecontroltime , forcevote=@forcevote , remindtype=@remindtype , remindtimebeforestart=@remindtimebeforestart , remindtimebeforeend=@remindtimebeforeend, istemplate=@istemplate  where id=@id

GO
alter procedure [Voting_SelectByStatus] (@status     int, @flag integer output, @msg varchar(4000) output) AS select * from voting where status=@status order by begindate desc,begintime desc

GO
alter procedure [Voting_SelectByID] (@id     int, @flag integer output, @msg varchar(4000) output) AS select * from voting where id=@id

GO
alter procedure [Voting_SelectAll] (@flag integer output, @msg varchar(4000) output) AS select * from voting order by begindate desc,begintime desc

GO
alter procedure [Voting_Insert] ( @subject   varchar(4000), @detail    text, @createrid int, @createdate    char(10), @createtime    char(8), @approverid    int, @approvedate   char(10), @approvetime   char(8), @begindate     char(10), @begintime     char(8), @enddate       char(10), @endtime       char(8), @isanony       varchar(4000), @docid         int, @crmid     int, @projid    int, @requestid int, @votingcount   int, @status int, @isSeeResult varchar(4000), @descr varchar(4000), @deploytype varchar(4000), @autoshowvote varchar(4000), @votetimecontrol varchar(4000), @votetimecontroltime varchar(4000), @forcevote varchar(4000), @remindtype varchar(4000), @remindtimebeforestart varchar(4000), @remindtimebeforeend varchar(4000), @istemplate varchar(4000), @flag integer output, @msg varchar(4000) output ) AS insert into voting ( subject, detail, createrid, createdate, createtime, approverid, approvedate, approvetime, begindate, begintime, enddate,endtime, isanony, docid, crmid, projid, requestid, votingcount, status, isSeeResult, descr,deploytype,autoshowvote,votetimecontrol,votetimecontroltime,forcevote,remindtype,remindtimebeforestart,remindtimebeforeend, istemplate) values ( @subject, @detail, @createrid, @createdate, @createtime, @approverid, @approvedate, @approvetime, @begindate, @begintime, @enddate, @endtime, @isanony, @docid, @crmid, @projid, @requestid, @votingcount, @status, @isSeeResult,@descr,@deploytype,@autoshowvote,@votetimecontrol,@votetimecontroltime,@forcevote,@remindtype,@remindtimebeforestart,@remindtimebeforeend, @istemplate) select max(id) from voting

GO
alter procedure [Voting_Delete] (@id    int, @flag integer output, @msg varchar(4000) output) AS delete from voting where id=@id

GO
alter procedure [TransBudgetCount_Select] @flag integer output , @msg varchar(4000) output AS declare @count int select @count= count(id) from FnaBudget if @count <> 0 begin select @count return end select @count= count(id) from FnaTransaction select @count

GO
alter procedure [TrainPlanDay_Insert] (@planid_1 int, @plandate_2 char(10), @plandaycontent_3 text, @plandayaim_4 text, @flag int output, @msg varchar(4000) output) as insert into HrmTrainPlanDay (planid, plandate, plandaycontent, plandayaim) values (@planid_1, @plandate_2, @plandaycontent_3, @plandayaim_4)

GO
alter procedure [TrainPlanDay_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) as delete from HrmTrainPlanDay where planid = @id_1

GO
alter procedure [TrainLayoutAssess_Insert] (@layoutid_1 int, @assessorid_2 int, @assessdate_3 char(10), @implement_4 char(1), @explain_5 text, @advice_6 text, @flag int output, @msg varchar(4000) output) as insert into HrmTrainLayoutAssess (layoutid, assessorid, assessdate, implement, explain, advice) values (@layoutid_1, @assessorid_2, @assessdate_3, @implement_4, @explain_5, @advice_6)

GO
alter procedure [CRM_SellStatus_SelectByID] (@id 	int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM CRM_SellStatus WHERE ( id	 = @id)

GO
alter procedure [CRM_SellStatus_SelectAll] (@flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM CRM_SellStatus

GO
alter procedure [CRM_SellStatus_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO CRM_SellStatus ( fullname, description) VALUES ( @fullname, @description)

 GO
alter procedure [CRM_SellStatus_Delete] (@id 	int, @flag	int	output, @msg	varchar(4000)	output) AS IF EXISTS(SELECT id FROM CRM_SellChance WHERE sellstatusid = @id) BEGIN SELECT -1 RETURN END DELETE CRM_SellStatus  WHERE ( id	 = @id)

GO
alter procedure [CRM_DeliveryType_Update] (@id 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @sendtype 	varchar(4000), @shipment 	varchar(4000), @receive 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_DeliveryType] SET  [fullname]	 = @fullname, [description]	 = @description, [sendtype]	 = @sendtype, [shipment]	 = @shipment, [receive]	 = @receive WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_DeliveryType_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_DeliveryType] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_DeliveryType_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_DeliveryType] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_DeliveryType_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @sendtype 	varchar(4000), @shipment 	varchar(4000), @receive 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CRM_DeliveryType] ( [fullname], [description], [sendtype], [shipment], [receive]) VALUES ( @fullname, @description, @sendtype, @shipment, @receive) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_DeliveryType_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_DeliveryType] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomizeOption_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomizeOption] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomizeOption_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomizeOption] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_Customize_Update] (@userid_1 	int, @logintype 	tinyint, @row1col1_2 	int, @row1col2_3 	int, @row1col3_4 	int, @row1col4_5 	int, @row1col5_6 	int, @row1col6_7 	int, @row2col1_8 	int, @row2col2_9 	int, @row2col4_10 	int, @row2col3_11 	int, @row2col5_12 	int, @row2col6_13 	int, @row3col1_14 	int, @row3col2_15 	int, @row3col3_16 	int, @row3col4_17 	int, @row3col5_18 	int, @row3col6_19 	int, @perpage_1 	int, @flag	int	output, @msg	varchar(4000)	output) AS UPDATE CRM_Customize SET  row1col1	 = @row1col1_2, row1col2	 = @row1col2_3, row1col3	 = @row1col3_4, row1col4	 = @row1col4_5, row1col5	 = @row1col5_6, row1col6	 = @row1col6_7, row2col1	 = @row2col1_8, row2col2	 = @row2col2_9, row2col4	 = @row2col4_10, row2col3	 = @row2col3_11, row2col5	 = @row2col5_12, row2col6	 = @row2col6_13, row3col1	 = @row3col1_14, row3col2	 = @row3col2_15, row3col3	 = @row3col3_16, row3col4	 = @row3col4_17, row3col5	 = @row3col5_18, row3col6	 = @row3col6_19, perpage		 = @perpage_1 WHERE ( userid	 = @userid_1 and logintype	 = @logintype)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ProductTable_insert] ( @sellchanceid_1 int , @productid_1 int , @assetunitid_1 int , @currencyid_1 int , @salesprice_1 decimal(12,2) , @salesnum_1 int , @totelprice_1 decimal(18,2) , @flag	int	output, @msg	varchar(4000)	output) as insert INTO CRM_ProductTable ( sellchanceid , productid , assetunitid, currencyid , salesprice , salesnum, totelprice ) values ( @sellchanceid_1  , @productid_1  , @assetunitid_1  , @currencyid_1  , @salesprice_1 , @salesnum_1  , @totelprice_1 )

GO
alter procedure [HrmCareerWorkexp_DByApplyId] (@applyid_1 	[int], @flag integer output , @msg varchar(4000) output)  AS DELETE [HrmCareerWorkexp]  WHERE ( [applyid] = @applyid_1)

GO
alter procedure [CRM_ContractProduct_Update1] ( @id_1 	[int] , @productId_1  [int]  , @unitId_1  [int]  , @currencyId_1  [int]  , @price_1  [decimal](17, 2)  , @depreciation_1  [int]  , @number_n_1  [decimal](10, 2)  , @sumPrice_1  [decimal](17, 2)  , @planDate_1  [char] (10)   , @isRemind_1  [int]  , @flag integer output, @msg varchar(4000) output) AS UPDATE CRM_ContractProduct SET productId = @productId_1 , unitId = @unitId_1, currencyId = @currencyId_1, price = @price_1, depreciation = @depreciation_1, number_n = @number_n_1 , sumPrice = @sumPrice_1, planDate = @planDate_1 , isRemind = @isRemind_1 where id = @id_1

GO
alter procedure [CRM_ContractProduct_Update] (@id_1 	[int] , @factnumber_n_1  [int] , @factDate_1  [char] (10)  , @isFinish_1  [int]  , @isRemind_1  [int] , @flag integer output, @msg varchar(4000) output)  AS UPDATE CRM_ContractProduct SET factnumber_n = @factnumber_n_1, factDate = @factDate_1 , isFinish = @isFinish_1 , isRemind = @isRemind_1  where id = @id_1

GO
alter procedure [CRM_ContractProduct_Select] (@contractId_1 [int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_ContractProduct where contractId = @contractId_1 order by id

GO
alter procedure [CRM_ContractProduct_Insert] ( @contractId_1  [int]  , @productId_1  [int]  , @unitId_1  [int]  , @number_n_1  [decimal](10, 2)  , @price_1  [decimal](17, 2)  , @currencyId_1  [int]  , @depreciation_1  [int]  , @sumPrice_1  [decimal](17, 2)  , @planDate_1  [char] (10)   , @factnumber_n_1   [int]  , @factDate_1  [char] (10)  , @isFinish_1  [int]  , @isRemind_1  [int]  , @flag integer output, @msg varchar(4000) output) AS INSERT INTO [CRM_ContractProduct] ( contractId , productId , unitId , number_n , price , currencyId , depreciation , sumPrice , planDate , factnumber_n , factDate , isFinish , isRemind ) VALUES ( @contractId_1, @productId_1, @unitId_1, @number_n_1 , @price_1 , @currencyId_1 , @depreciation_1 , @sumPrice_1 , @planDate_1 , @factnumber_n_1 , @factDate_1 , @isFinish_1 , @isRemind_1)

GO
alter procedure [CRM_ContractProduct_Delete] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_ContractProduct] WHERE ( [id]	 = @id_1)

GO
alter procedure [CRM_ContractProduct_DelAll] (@contractId_1 	[int] , @IdStr_1 	varchar(4000) , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_ContractProduct] WHERE ( [contractId]	 = @contractId_1 and id not in(@IdStr_1) )

GO
alter procedure [CRM_Evaluation_L_Update] (@id_1 	[int] , @name_1 	varchar(4000), @levelvalue_1	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE CRM_Evaluation_Level SET name = @name_1, levelvalue = @levelvalue_1 where id = @id_1

GO
alter procedure [CRM_Evaluation_L_SelectById] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_Evaluation_Level  where id = @id_1

  GO
alter procedure [CRM_Evaluation_L_Select] ( @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM CRM_Evaluation_Level ORDER BY levelvalue

GO
alter procedure [CRM_Evaluation_L_Insert] (@name_1 	varchar(4000), @levelvalue_1	[int], @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [CRM_Evaluation_Level] ([name], [levelvalue])  VALUES ( @name_1, @levelvalue_1)

GO
alter procedure [CRM_Evaluation_Update] (@id_1 	[int] , @name_1 	varchar(4000), @proportion_1	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE CRM_Evaluation SET name = @name_1, proportion = @proportion_1 where id = @id_1

GO
alter procedure [CRM_Evaluation_SelectById] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_Evaluation  where id = @id_1

GO
alter procedure [CRM_Evaluation_Select] ( @flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT * FROM CRM_Evaluation

GO
alter procedure [CRM_Evaluation_Insert] (@name_1 	varchar(4000), @proportion_1	[int], @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [CRM_Evaluation] ([name], [proportion])  VALUES ( @name_1, @proportion_1)

GO
alter procedure [CRM_Evaluation_Delete] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_Evaluation] WHERE ( [id]	 = @id_1)

GO
alter procedure [CRM_Failfactor_SelectByID] (@id 	int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM CRM_Failfactor WHERE ( id	 = @id)

GO
alter procedure [CRM_Failfactor_SelectAll] (@flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM CRM_Failfactor

GO
alter procedure [CRM_Failfactor_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO CRM_Failfactor ( fullname, description) VALUES ( @fullname, @description)

 GO
alter procedure [CRM_Failfactor_Delete] (@id 	int, @flag	int	output, @msg	varchar(4000)	output) AS IF EXISTS(SELECT id FROM CRM_SellChance WHERE defactor = @id) BEGIN SELECT -1 RETURN END DELETE CRM_Failfactor  WHERE ( id	 = @id)

GO
alter procedure [CRM_SellChance_SMAXID] ( @flag	int	output, @msg	varchar(4000)	output) AS SELECT max(id) as sellchanceid FROM CRM_SellChance

GO
alter procedure [CRM_SellChance_SelectByID] ( @id_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM CRM_SellChance WHERE id=@id_1

 GO
alter procedure [CRM_SellChance_SelectAll] ( @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM CRM_SellChance

GO
alter procedure [CRM_SellChance_SByCustomerID] ( @id_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM CRM_SellChance WHERE customerid =@id_1 order by predate desc

GO
alter procedure [CRM_SellChance_insert] ( @creater_1 int , @subject_1 varchar(4000) , @customerid_1 int , @comefromid_1 int , @sellstatusid_1 int , @endtatusid_1 char(1) , @predate_1 char(10) , @preyield_1 decimal(18,2) , @currencyid_1 int , @probability_1 decimal(8,2) , @createdate_1 char(10) , @createtime_1 char(8) , @content_1 text , @sufactor_1 int, @defactor_1 int, @departmentId_1 int, @subCompanyId_1 int, @flag	int	output, @msg	varchar(4000)	output) as insert INTO CRM_SellChance ( creater , subject , customerid , comefromid , sellstatusid , endtatusid , predate , preyield , currencyid , probability , createdate , createtime , content, sufactor, defactor, departmentId, subCompanyId) values ( @creater_1  , @subject_1  , @customerid_1  , @comefromid_1  , @sellstatusid_1  , @endtatusid_1  , @predate_1  , @preyield_1  , @currencyid_1  , @probability_1 , @createdate_1  , @createtime_1  , @content_1 , @sufactor_1, @defactor_1, @departmentId_1, @subCompanyId_1)

GO
alter procedure [CRM_SellChance_Delete] ( @id_1 int, @flag	int	output, @msg	varchar(4000)	output) as delete CRM_SellChance WHERE id=@id_1

GO
alter procedure [CRM_SellChance_Update] ( @creater_1 int , @subject_1 varchar(4000) , @customerid_1 int , @comefromid_1 int , @sellstatusid_1 int , @endtatusid_1 char(1) , @predate_1 char(10) , @preyield_1 decimal(18,2) , @currencyid_1 int , @probability_1 decimal(8,2) , @content_1 text , @id_1 int, @sufactor_1 int, @defactor_1 int, @departmentId_1 int, @subCompanyId_1 int, @flag	int	output, @msg	varchar(4000)	output) as update CRM_SellChance set  creater = @creater_1, subject = @subject_1, customerid =@customerid_1, comefromid =@comefromid_1, sellstatusid=@sellstatusid_1 , endtatusid =@endtatusid_1, predate=@predate_1 , preyield =@preyield_1, currencyid =@currencyid_1, probability =@probability_1, content= @content_1, sufactor = @sufactor_1, defactor = @defactor_1, departmentId = @departmentId_1, subCompanyId = @subCompanyId_1 WHERE id=@id_1

GO
alter procedure [Employee_CptUpdate] @id_1 int, @hrmid_1  int, @flag		int	output, @msg		varchar(4000) output as update HrmInfoStatus set status = '1' WHERE itemid=@id_1 AND hrmid=@hrmid_1

GO
alter procedure [Employee_SetAll] @hrmid_1    int, @flag		int	output, @msg		varchar(4000) output as declare @count_1 int  select @count_1=count(*) from HrmInfoStatus where status=0 AND hrmid=@hrmid_1 AND itemid<10 if @count_1<>0 begin select -1 return end else begin update HrmInfoStatus set status=1 WHERE itemid=10 AND hrmid=@hrmid_1 end

GO
alter procedure [ErrorMsgIndex_Insert] @id		int, @indexdesc	varchar(4000), @flag		int	output, @msg		varchar(4000) output as insert into ErrorMsgIndex (id,indexdesc) values (@id,@indexdesc)

GO
alter procedure [Employee_SelectByHrmid] @hrmid_1    int, @flag		int	output, @msg		varchar(4000) output as select itemid,status from HrmInfoStatus WHERE hrmid=@hrmid_1 AND itemid<10  order by itemid

GO
alter procedure [ExchangeInfo_SelectBID] (@sortid_1 int , @type_n_1 char(2), @flag	int	output, @msg	varchar(4000)	output)  AS SELECT * FROM Exchange_Info where sortid = @sortid_1 AND type_n=@type_n_1 order by id desc

GO
alter procedure [ExchangeInfo_Insert_PRJ] ( @sortid_1 int  , @name_1  varchar(4000)   , @remark_1 text  , @creater_1  int  , @createDate_1  char (10)   , @createTime_1  char (10)  , @type_n_1 char(2), @relateddoc_1	varchar(4000), @relatedwf_1	varchar(4000), @relatedcus_1	varchar(4000), @relatedprj_1	varchar(4000), @relatedtsk_1	varchar(4000), @relatedacc_1	varchar(4000), @flag integer output, @msg varchar(4000) output) AS INSERT INTO Exchange_Info( sortid , name , remark , creater , createDate , createTime, type_n, docids, requestIds, crmIds, projectIds, tskids,accessory) VALUES( @sortid_1 , @name_1, @remark_1, @creater_1 , @createDate_1 , @createTime_1, @type_n_1, @relateddoc_1, @relatedwf_1, @relatedcus_1, @relatedprj_1, @relatedtsk_1,@relatedacc_1)

  GO
alter procedure [ExchangeInfo_Insert]( @sortid_1 int  , @name_1  varchar(4000)   , @remark_1 text  , @creater_1  int  , @createDate_1  char (10)   , @createTime_1  char (10)  , @type_n_1 char(2), @docids_1 varchar(4000), @relatedprj_1	varchar(4000), @relatedcus_1	varchar(4000), @relatedwf_1	varchar(4000), @relateddoc_1	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS INSERT INTO Exchange_Info( sortid , name , remark , creater , createDate , createTime, type_n, docids, relatedprj, relatedcus, relatedwf, relateddoc)  VALUES( @sortid_1 , @name_1, @remark_1, @creater_1 , @createDate_1 , @createTime_1, @type_n_1, @docids_1, @relatedprj_1, @relatedcus_1, @relatedwf_1, @relateddoc_1)

GO
alter procedure [Exchange_Info_Insert] ( @sortId_1 int, @name_1 varchar(4000), @remark_1 text, @creater_1 int, @createDate_1 char(10), @createTime_1 char(10), @type_n_1 char(2), @docids_1 varchar(4000), @crmIds_1 varchar(4000), @projectIds_1 varchar(4000), @requestIds_1 varchar(4000), @createrType_1 char(1), @flag integer output , @msg varchar(4000) output) AS INSERT INTO Exchange_Info (sortid, name, remark, creater, createDate, createTime, type_n, docids, crmIds, projectIds, requestIds, createrType) VALUES (@sortId_1, @name_1, @remark_1, @creater_1, @createDate_1, @createTime_1, @type_n_1, @docids_1, @crmIds_1, @projectIds_1, @requestIds_1, @createrType_1)

GO
alter procedure [ErrorMsgInfo_Insert] @id		int, @errormsgname	varchar(4000), @langid		int, @flag		int	output, @msg		varchar(4000) output as insert into ErrorMsgInfo (indexid,msgname,languageid) values (@id,@errormsgname,@langid)

GO
alter procedure [DocSecCategoryShare_SBySecID] (@secid	int, @flag	int output, @msg	varchar(4000)	output) as select * from DocSecCategoryShare where seccategoryid=@secid

GO
alter procedure [DocSecCategoryShare_SBySecCate] (@seccategoryid  	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from DocSecCategoryShare where seccategoryid  = @seccategoryid

GO
alter procedure [DocSecCategoryShare_Insert] ( @secid	int, @sharetype	int, @seclevel	tinyint, @rolelevel	tinyint, @sharelevel	tinyint, @userid	int, @subcompanyid	int, @departmentid	int, @roleid	int, @foralluser	tinyint, @crmid int, @downloadlevel int, @flag	int output, @msg	varchar(4000)	output ) as insert into DocSecCategoryShare (seccategoryid,sharetype,seclevel,rolelevel,sharelevel,userid,subcompanyid,departmentid,roleid,foralluser,crmid,downloadlevel ) values (@secid,@sharetype,@seclevel,@rolelevel,@sharelevel,@userid,@subcompanyid,@departmentid,@roleid,@foralluser,@crmid,@downloadlevel)

GO
alter procedure [DocSecCategoryShare_Ins_G] ( @secid	int, @sharetype	int, @seclevel	tinyint, @rolelevel	tinyint, @sharelevel	tinyint, @userid	int, @subcompanyid	int, @departmentid	int, @roleid	int, @foralluser	tinyint, @crmid int, @orgGroupId int, @downloadlevel int, @flag	int output, @msg	varchar(4000)	output ) as insert into DocSecCategoryShare (seccategoryid,sharetype,seclevel,rolelevel,sharelevel,userid,subcompanyid,departmentid,roleid,foralluser,crmid,orgGroupId,downloadlevel ) values (@secid,@sharetype,@seclevel,@rolelevel,@sharelevel,@userid,@subcompanyid,@departmentid,@roleid,@foralluser,@crmid,@orgGroupId,@downloadlevel)

GO
alter procedure [DocSecCategoryShare_Delete] (@id	int, @flag	int output, @msg	varchar(4000)	output) as delete from DocSecCategoryShare where id=@id

GO
alter procedure [DocUserView_SelectbyUserId] (@userid 	[int], @flag	int output, @msg	varchar(4000)	output) as select docid from DocUserView where userid=@userid

GO
alter procedure [DocUserView_SelectByDocId] (@docid 	[int], @flag	int output, @msg	varchar(4000)	output) as select userid from DocUserView where docid=@docid

GO
alter procedure [DocUserView_InsertByUser] @seclevel int, @departmentid int, @subcompanyid int, @userid	int, @flag	int	output, @msg	varchar(4000) output as declare	@docid	int, @all_cursor cursor SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select Distinct docid from DocShare  where sharetype=5 or (sharetype=3 and @seclevel>=seclevel and @departmentid=departmentid) OR (sharetype=2 and @seclevel>=seclevel and @subcompanyid=subcompanyid) OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @docid WHILE @@FETCH_STATUS = 0 begin insert into DocUserView (docid,userid) values (@docid , @userid) FETCH NEXT FROM @all_cursor INTO @docid end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [DocUserView_DeletebyUserId] (@userid 	[int], @flag	int output, @msg	varchar(4000)	output) as delete from DocUserView where userid=@userid

GO
alter procedure [DocShare_FromDocSecCatI_DL] ( @docid  int, @sharetype	int, @seclevel	tinyint, @rolelevel	tinyint, @sharelevel	tinyint, @userid	int, @subcompanyid	int, @departmentid	int, @roleid	int, @foralluser	tinyint, @crmid	int, @sharesource int, @downloadlevel int, @flag	int output, @msg	varchar(4000)	output ) as  declare @count_1 int  select @count_1=count(*) from DocShare where docid=@docid and sharetype=@sharetype and seclevel=@seclevel and rolelevel=@rolelevel and sharelevel<=@sharelevel and userid=@userid and subcompanyid=@subcompanyid and departmentid=@departmentid and roleid=@roleid and foralluser=@foralluser and crmid=@crmid and sharesource=@sharesource  if @count_1=0 begin insert into DocShare(docid,sharetype,seclevel,rolelevel,sharelevel,userid,subcompanyid,departmentid,roleid,foralluser,crmid,sharesource,downloadlevel) values(@docid,@sharetype,@seclevel,@rolelevel,@sharelevel,@userid,@subcompanyid,@departmentid,@roleid,@foralluser,@crmid,@sharesource,@downloadlevel) end else begin update DocShare set docid=@docid , sharetype=@sharetype , seclevel=@seclevel , rolelevel=@rolelevel , sharelevel=@sharelevel , userid=@userid , subcompanyid=@subcompanyid , departmentid=@departmentid , roleid=@roleid , foralluser=@foralluser , crmid=@crmid , sharesource=@sharesource, downloadlevel=@downloadlevel where docid=@docid and sharetype=@sharetype and seclevel=@seclevel and rolelevel=@rolelevel and sharelevel<@sharelevel and userid=@userid and subcompanyid=@subcompanyid and departmentid=@departmentid and roleid=@roleid and foralluser=@foralluser and crmid=@crmid and sharesource=@sharesource end

GO
alter procedure [DocShare_FromDocSecCategoryI] (@docid  int, @sharetype	int, @seclevel	tinyint, @rolelevel	tinyint, @sharelevel	tinyint, @userid	int, @subcompanyid	int, @departmentid	int, @roleid	int, @foralluser	tinyint, @crmid	int,@sharesource int, @flag	int output, @msg	varchar(4000)	output) as  declare @count_1 int  select @count_1=count(*) from DocShare where docid=@docid and sharetype=@sharetype and seclevel=@seclevel and rolelevel=@rolelevel and sharelevel<=@sharelevel and userid=@userid and subcompanyid=@subcompanyid and departmentid=@departmentid and roleid=@roleid and foralluser=@foralluser and crmid=@crmid and sharesource=@sharesource  if @count_1=0 begin insert into DocShare(docid,sharetype,seclevel,rolelevel,sharelevel,userid,subcompanyid,departmentid,roleid,foralluser,crmid,sharesource) values(@docid,@sharetype,@seclevel,@rolelevel,@sharelevel,@userid,@subcompanyid,@departmentid,@roleid,@foralluser,@crmid,@sharesource) end else begin update DocShare set docid=@docid , sharetype=@sharetype , seclevel=@seclevel , rolelevel=@rolelevel , sharelevel=@sharelevel , userid=@userid , subcompanyid=@subcompanyid , departmentid=@departmentid , roleid=@roleid , foralluser=@foralluser , crmid=@crmid , sharesource=@sharesource where docid=@docid and sharetype=@sharetype and seclevel=@seclevel and rolelevel=@rolelevel and sharelevel<@sharelevel and userid=@userid and subcompanyid=@subcompanyid and departmentid=@departmentid and roleid=@roleid and foralluser=@foralluser and crmid=@crmid and sharesource=@sharesource end

GO
alter procedure [DocShare_DeleteByDocidUserid] (@docid    int, @userid    int, @flag	int output, @msg	varchar(4000)	output) as  delete from docshare where docid=@docid and userid=@userid

GO
alter procedure [DocShare_Delete] (@id	int, @flag	int output, @msg	varchar(4000)	output) as delete from DocShare where id=@id

GO
alter procedure [DocApproveRemark_SelectByDocid] @docid		int, @flag integer output , @msg varchar(4000) output as select * from docapproveremark where docid=@docid

GO
alter procedure [DocApproveRemark_Insert] @docid		int, @approveremark      varchar(4000), @approverid     int, @approvedate    char(10), @approvetime    char(8), @isapprover      char(1), @flag integer output , @msg varchar(4000) output as insert into docApproveRemark (docid,approveremark,approverid,approvedate,approvetime,isapprover) values(@docid,@approveremark,@approverid,@approvedate,@approvetime,@isapprover)

GO
alter procedure [VotingOption_UpdateCount] (@optionid    int, @flag integer output, @msg varchar(4000) output) AS update votingoption set optioncount=optioncount+1 where id = @optionid

GO
alter procedure [VotingOption_Update] (@id    int, @votingid  int, @questionid    int, @description   varchar(4000), @flag integer output, @msg varchar(4000) output) AS update votingoption set votingid=@votingid, questionid=@questionid, description=@description where id=@id

GO
alter procedure [VotingOption_SelectByQuestion] ( @questionid  int, @flag integer output, @msg varchar(4000) output) AS select * from votingoption where questionid=@questionid order by showorder

GO
alter procedure [VotingOption_SelectByID] (@id  int, @flag integer output, @msg varchar(4000) output) AS select * from votingoption where id=@id order by id

GO
alter procedure [VotingOption_Insert] ( @votingid  int, @questionid    int, @description   varchar(4000), @optioncount   int, @showorder     int, @flag integer output, @msg varchar(4000) output) AS insert into votingoption (votingid,questionid,description,optioncount,showorder) values (@votingid,@questionid,@description,@optioncount,@showorder) select max(id) from votingoption

GO
alter procedure [VotingOption_Delete] (@id    int, @flag integer output, @msg varchar(4000) output) AS delete from votingoption where id=@id

GO
alter procedure [SMS_Message_insert] (@id_1 	int, @message_2 	varchar(4000), @recievenumber_3 	varchar(4000), @sendnumber_4 	varchar(4000), @messagestatus_5 	char(1), @requestid_6 	int, @userid_7 	int, @usertype_8 	char(1), @messagetype_9 	char(1), @finishtime_10 	char(19), @smsyear_11   char(4), @smsmonth_12  char(2), @smsday_13    char(2), @isdelete_14   char(1), @touserid_15   int, @tousertype_16 char(1), @flag			int	output, @msg			varchar(4000) output)  AS INSERT INTO SMS_Message ( id, message, recievenumber, sendnumber, messagestatus, requestid, userid, usertype, messagetype, finishtime, smsyear, smsmonth, smsday, isdelete, touserid, tousertype)  VALUES ( @id_1, @message_2, @recievenumber_3, @sendnumber_4, @messagestatus_5, @requestid_6, @userid_7, @usertype_8, @messagetype_9, @finishtime_10, @smsyear_11, @smsmonth_12, @smsday_13, @isdelete_14, @touserid_15, @tousertype_16)

GO
alter procedure [ProcedureInfo_Delete] (@id_1  		[int], @flag                             integer output, @msg                             varchar(4000) output )  AS DELETE [ProcedureInfo]  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='删除储存过程失败' return end else begin set @flag=0 set @msg='删除储存过程成功' return end

GO
alter procedure [T_InputReport_Update] ( @inprepid_1 	int, @inprepname_2 	varchar(4000), @inpreptablename_3 	varchar(4000), @inprepbugtablename_4 	varchar(4000), @inprepfrequence_5 	char(1), @inprepbudget_6 	char(1), @inprepforecast_7	char(1), @startdate_8	char(10), @enddate_9	char(10), @modulefilename_10	varchar(4000), @helpdocid_11	int, @isInputMultiLine_12	char(1), @billId_13	int, @flag	int	output, @msg	varchar(4000)	output ) AS UPDATE T_InputReport SET inprepname	 = @inprepname_2, inpreptablename	 = @inpreptablename_3, inprepbugtablename	 = @inprepbugtablename_4, inprepfrequence	 = @inprepfrequence_5, inprepbudget	 = @inprepbudget_6 , inprepforecast	 = @inprepforecast_7 , startdate	 = @startdate_8 , enddate	 = @enddate_9 , modulefilename	 = @modulefilename_10 , helpdocid	 = @helpdocid_11 , isInputMultiLine	 = @isInputMultiLine_12 , billId	 = @billId_13 WHERE ( inprepid	 = @inprepid_1)

GO
alter procedure [T_InputReport_SelectByInprepid] (@inprepid_1  int , @flag	int	output, @msg	varchar(4000)	output)  AS select * from T_InputReport where inprepid = @inprepid_1

GO
alter procedure [T_InputReport_SelectByCrmid] (@crmid_1  int , @currentdate_2 char(10) , @flag	int	output, @msg	varchar(4000)	output)  AS select a.inprepid, a.inprepname from T_InputReport a, T_InputReportCrm b where a.inprepid = b.inprepid and b.crmid = @crmid_1 and (a.startdate = '' or a.startdate is null or a.startdate <= @currentdate_2 ) and (a.enddate = '' or a.enddate is null or a.enddate >= @currentdate_2 )

GO
alter procedure [T_InputReport_SelectAll] ( @flag	int	output, @msg	varchar(4000)	output) AS select * from T_InputReport where deleted=0

GO
alter procedure [T_InputReport_Insert] ( @inprepname_1 	varchar(4000), @inpreptablename_2 	varchar(4000), @inprepbugtablename_3 	varchar(4000), @inprepfrequence_4 	char(1), @inprepbudget_5 	char(1), @inprepforecast_6	char(1), @startdate_7	char(10), @enddate_8	char(10), @modulefilename_9	varchar(4000), @helpdocid_10	int, @isInputMultiLine_11	char(1), @billId_12	int, @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO T_InputReport ( inprepname, inpreptablename, inprepbugtablename, inprepfrequence, inprepbudget, inprepforecast, startdate, enddate, modulefilename, helpdocid, isInputMultiLine, billId ) VALUES ( @inprepname_1, @inpreptablename_2, @inprepbugtablename_3, @inprepfrequence_4, @inprepbudget_5, @inprepforecast_6, @startdate_7, @enddate_8, @modulefilename_9, @helpdocid_10, @isInputMultiLine_11, @billId_12 )

GO
alter procedure [T_InputReport_Delete] (@inprepid_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_InputReport  WHERE ( inprepid	 = @inprepid_1)

GO
alter procedure [Prj_TaskShareInfo_Insert] (@relateditemid_1 [int], @sharetype_2 [int], @seclevel_3 [int], @rolelevel_4 [int], @sharelevel_5 [int], @userid_6 [int], @departmentid_7 [int], @roleid_8 [int], @foralluser_9 [int],@subcompanyid_10 [int], @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [Prj_TaskShareInfo] ( [relateditemid], [sharetype], [seclevel], [rolelevel], [sharelevel], [userid], [departmentid], [roleid], [foralluser],[subcompanyid])  VALUES ( @relateditemid_1, @sharetype_2, @seclevel_3, @rolelevel_4, @sharelevel_5, @userid_6, @departmentid_7, @roleid_8, @foralluser_9,@subcompanyid_10)  select max(id)  id from Prj_TaskShareInfo

GO
alter procedure [Prj_TaskShareInfo_Delete] (@id_1 [int], @flag integer output, @msg varchar(4000) output)  AS DELETE [Prj_TaskShareInfo]  WHERE ( [id] = @id_1)

  GO
alter procedure [T_fieldItemDetail_SelectByItemid] (@itemid_1  int , @flag	 int 	output, @msg	 varchar(4000)	output)  AS select * from T_fieldItemDetail where itemid = @itemid_1

  GO
alter procedure  [T_fieldItemDetail_Insert] (@itemid_1 	 int , @itemdsp_2 	 varchar(4000), @itemvalue_3 	 varchar(4000) , @flag	 int 	output, @msg	 varchar(4000)	output)  AS INSERT INTO  T_fieldItemDetail (itemid , itemdsp , itemvalue )  VALUES (@itemid_1, @itemdsp_2, @itemvalue_3)

GO
alter procedure [Prj_TaskShareDtl_Insert] (@capitalid 	[int], @userid 	[int], @usertype 	[int], @sharelevel 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [Prj_TaskShareDtl] ( [taskid],	 [userid] , [usertype], [sharelevel] )  VALUES ( @capitalid,@userid, @usertype, @sharelevel )

GO
alter procedure [Prj_TaskShareDtl_DeleteByTaskId] (@cptid 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [Prj_TaskShareDtl]  WHERE ( [taskid]	 = @cptid)

  GO
alter procedure [DocSubscribe_Insert]( @docId int , @hrmId int , @ownerId int, @subscribeDate char(10), @approveDate char(10), @searchCase     varchar(4000) , @subscribeDesc  varchar(4000) , @getBackDesc	   varchar(4000) , @otherSubscribe  varchar(4000) , @state char(1), @subscribetype int, @ownertype int, @flag integer output , @msg varchar(4000) output ) AS insert into DocSubscribe(docId,hrmId,ownerId,subscribeDate,approveDate,searchCase,subscribeDesc,getBackDesc,state,otherSubscribe,subscribetype,ownertype) values (@docId,@hrmId,@ownerId,@subscribeDate,@approveDate,@searchCase,@subscribeDesc,@getBackDesc,@state,@otherSubscribe,@subscribetype,@ownertype) select max(id) from DocSubscribe

  GO
alter procedure [DocSubscribe_DeleteById]( @id int , @flag integer output , @msg varchar(4000) output ) AS delete DocSubscribe where id =  @id

GO
alter procedure [DocSearchMould_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [DocSearchMould]  WHERE ( [id]	 = @id_1)

GO
alter procedure [Favourite_Insert] @userid int, @adddate char(20), @favouritename char(100), @favouritedesc char(200), @displayorder int, @parentid int, @flag integer output, @msg varchar(4000) output AS insert into favourite(resourceid,adddate,favouritename,favouritedesc,displayorder,parentid) VALUES (@userid,@adddate,@favouritename,@favouritedesc,@displayorder,@parentid) select @@IDENTITY from favourite

 GO
alter procedure [DocDetailLog_SRead] @docid  int, @userid int, @flag integer output , @msg varchar(4000) output as select * from DocDetailLog where ((operatetype='0' and operateuserid=@userid) or doccreater=@userid ) and docid=@docid

GO
alter procedure [CRM_T_ShareInfo_SID] (@id int , @flag integer output , @msg varchar(4000) output ) AS select * from CRM_T_ShareInfo where (id = @id )

GO
alter procedure [CRM_T_ShareInfo_SbyRelateid] (@relateditemid int , @flag integer output , @msg varchar(4000) output ) AS select * from CRM_T_ShareInfo where ( relateditemid = @relateditemid ) order by sharetype

GO
alter procedure [CRM_T_ShareInfo_Insert] ( @relateditemid INT, @sharetype tinyint, @seclevel tinyint, @seclevelMax tinyint, @rolelevel tinyint, @sharelevel tinyint, @userid INT, @departmentid INT, @roleid INT, @foralluser tinyint , @subcompanyid INT, @flag INTEGER OUTPUT, @msg varchar(4000) OUTPUT ) AS INSERT INTO CRM_T_ShareInfo ( relateditemid, sharetype, seclevel, seclevelMax, rolelevel, sharelevel, userid, departmentid, roleid, foralluser, subcompanyid ) VALUES ( @relateditemid, @sharetype, @seclevel, @seclevelMax, @rolelevel, @sharelevel, @userid, @departmentid, @roleid, @foralluser , @subcompanyid ) SET @flag = 1 SET @msg = 'ok'

GO
alter procedure [CRM_T_ShareInfo_Delete] (@id int, @flag integer output, @msg varchar(4000) output ) AS DELETE from CRM_T_ShareInfo  WHERE ( id = @id)

GO
alter procedure [CRM_Successfactor_Update] (@id	 	int, @fullname 	varchar(4000), @description 	varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS UPDATE CRM_Successfactor SET  fullname	 = @fullname, description	 = @description WHERE ( id	 = @id)

GO
alter procedure [CRM_Successfactor_SelectByID] (@id 	int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM CRM_Successfactor WHERE ( id	 = @id)

GO
alter procedure [CRM_Successfactor_SelectAll] (@flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM CRM_Successfactor

GO
alter procedure [CRM_Successfactor_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO CRM_Successfactor ( fullname, description) VALUES ( @fullname, @description)

 GO
alter procedure [CRM_Successfactor_Delete] (@id 	int, @flag	int	output, @msg	varchar(4000)	output) AS IF EXISTS(SELECT id FROM CRM_SellChance WHERE sufactor = @id) BEGIN SELECT -1 RETURN END DELETE CRM_Successfactor  WHERE ( id	 = @id)

GO
alter procedure [CRM_CustomerAddress_Update] (@typeid_1 	[int], @customerid_2 	[int], @isequal_3 	[tinyint], @address1_4 	varchar(4000), @address2_5 	varchar(4000), @address3_6 	varchar(4000), @zipcode_7 	varchar(4000), @city_8 	[int], @country_9 	[int], @province_10 	[int], @county_11 	varchar(4000), @phone_12 	varchar(4000), @fax_13 	varchar(4000), @email_14 	varchar(4000), @contacter_15 	[int], @datefield1_16 	varchar(4000), @datefield2_17 	varchar(4000), @datefield3_18 	varchar(4000), @datefield4_19 	varchar(4000), @datefield5_20 	varchar(4000), @numberfield1_21 	[float], @numberfield2_22 	[float], @numberfield3_23 	[float], @numberfield4_24 	[float], @numberfield5_25 	[float], @textfield1_26 	varchar(4000), @textfield2_27 	varchar(4000), @textfield3_28 	varchar(4000), @textfield4_29 	varchar(4000), @textfield5_30 	varchar(4000), @tinyintfield1_31 	[tinyint], @tinyintfield2_32 	[tinyint], @tinyintfield3_33 	[tinyint], @tinyintfield4_34 	[tinyint], @tinyintfield5_35 	[tinyint], @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [CRM_CustomerAddress]  SET  [isequal]	 = @isequal_3, [address1]	 = @address1_4, [address2]	 = @address2_5, [address3]	 = @address3_6, [zipcode]	 = @zipcode_7, [city]	 = @city_8, [country]	 = @country_9, [province]	 = @province_10, [county]	 = @county_11, [phone]	 = @phone_12, [fax]	 = @fax_13, [email]	 = @email_14, [contacter]	 = @contacter_15, [datefield1]	 = @datefield1_16, [datefield2]	 = @datefield2_17, [datefield3]	 = @datefield3_18, [datefield4]	 = @datefield4_19, [datefield5]	 = @datefield5_20, [numberfield1]	 = @numberfield1_21, [numberfield2]	 = @numberfield2_22, [numberfield3]	 = @numberfield3_23, [numberfield4]	 = @numberfield4_24, [numberfield5]	 = @numberfield5_25, [textfield1]	 = @textfield1_26, [textfield2]	 = @textfield2_27, [textfield3]	 = @textfield3_28, [textfield4]	 = @textfield4_29, [textfield5]	 = @textfield5_30, [tinyintfield1]	 = @tinyintfield1_31, [tinyintfield2]	 = @tinyintfield2_32, [tinyintfield3]	 = @tinyintfield3_33, [tinyintfield4]	 = @tinyintfield4_34, [tinyintfield5]	 = @tinyintfield5_35  WHERE ( [typeid]	 = @typeid_1 AND [customerid]	 = @customerid_2)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerAddress_UEqual] (@typeid_1 	[int], @customerid_2 	[int], @isequal_3 	[tinyint], @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [CRM_CustomerAddress]  SET  [isequal]	 = @isequal_3  WHERE ( [typeid]	 = @typeid_1 AND [customerid]	 = @customerid_2)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerAddress_Select] (@tid 	[int], @cid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerAddress] WHERE ([typeid] = @tid) AND ([customerid] = @cid) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerAddress_Insert] (@typeid 	[int], @customerid 	[int], @isequal 	[tinyint], @address1 	varchar(4000), @address2 	varchar(4000), @address3 	varchar(4000), @zipcode 	varchar(4000), @city 	[int], @country 	[int], @province 	[int], @county 	varchar(4000), @phone 	varchar(4000), @fax 	varchar(4000), @email 	varchar(4000), @contacter 	[int], @datefield1 	varchar(4000), @datefield2 	varchar(4000), @datefield3 	varchar(4000), @datefield4 	varchar(4000), @datefield5 	varchar(4000), @numberfield1 	[float], @numberfield2 	[float], @numberfield3 	[float], @numberfield4 	[float], @numberfield5 	[float], @textfield1 	varchar(4000), @textfield2 	varchar(4000), @textfield3 	varchar(4000), @textfield4 	varchar(4000), @textfield5 	varchar(4000), @tinyintfield1 	[tinyint], @tinyintfield2 	[tinyint], @tinyintfield3 	[tinyint], @tinyintfield4 	[tinyint], @tinyintfield5 	[tinyint], @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [CRM_CustomerAddress] ( [typeid], [customerid], [isequal], [address1], [address2], [address3], [zipcode], [city], [country], [province], [county], [phone], [fax], [email], [contacter], [datefield1], [datefield2], [datefield3], [datefield4], [datefield5], [numberfield1], [numberfield2], [numberfield3], [numberfield4], [numberfield5], [textfield1], [textfield2], [textfield3], [textfield4], [textfield5], [tinyintfield1], [tinyintfield2], [tinyintfield3], [tinyintfield4], [tinyintfield5])  VALUES ( @typeid, @customerid, @isequal, @address1, @address2, @address3, @zipcode, @city, @country, @province, @county, @phone, @fax, @email, @contacter, @datefield1, @datefield2, @datefield3, @datefield4, @datefield5, @numberfield1, @numberfield2, @numberfield3, @numberfield4, @numberfield5, @textfield1, @textfield2, @textfield3, @textfield4, @textfield5, @tinyintfield1, @tinyintfield2, @tinyintfield3, @tinyintfield4, @tinyintfield5)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Workflow_Report_Update] (@id_1 	[int], @reportname_2 	varchar(4000), @reporttype_3 	[int], @reportwfid_4 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [Workflow_Report]  SET  [reportname]	 = @reportname_2, [reporttype]	 = @reporttype_3, [reportwfid]	 = @reportwfid_4  WHERE ( [id]	 = @id_1)

GO
alter procedure [Workflow_Report_SelectByID] (@id_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS select * from Workflow_Report where id = @id_1

GO
alter procedure [Workflow_Report_Select] (@flag	[int]	output, @msg	varchar(4000)	output) AS select * from Workflow_Report

GO
alter procedure [Workflow_Report_Insert] (@reportname_1 	varchar(4000), @reporttype_2 	[int], @reportwfid_3 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [Workflow_Report] ( [reportname], [reporttype], [reportwfid])  VALUES ( @reportname_1, @reporttype_2, @reportwfid_3)

GO
alter procedure [Workflow_Report_Delete] (@id_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [Workflow_Report]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmRewardsType_Update] (@id_1 	[int], @flag_2 	[char](1), @name_3 	varchar(4000), @description_4 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS UPDATE [HrmRewardsType]  SET  [flag]	 = @flag_2, [name]	 = @name_3, [description]	 = @description_4  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmRewardsType_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmRewardsType where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmRewardsType_Select] @flag integer output , @msg varchar(4000) output  AS select * from HrmRewardsType set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmRewardsType_Insert] (@flag_1 	[char](1), @name_2 	varchar(4000), @description_3 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [HrmRewardsType] ( [flag], [name], [description])  VALUES ( @flag_1, @name_2, @description_3)

GO
alter procedure [HrmRewardsType_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmRewardsType]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmRewardsRecord_Update] (@id_1 	[int], @resourceid_2 	[int], @rewardsdate_3 	[char](10), @rewardstype_4 	[int], @remark_5 	[text], @lastmoderid_6 	[int], @lastmoddate_7 	[char](10), @lastmodtime_8 	[char](8), @flag integer output, @msg varchar(4000) output)  AS UPDATE [HrmRewardsRecord]  SET  [resourceid]	 = @resourceid_2, [rewardsdate]	 = @rewardsdate_3, [rewardstype]	 = @rewardstype_4, [remark]	 = @remark_5, [lastmoderid]	 = @lastmoderid_6, [lastmoddate]	 = @lastmoddate_7, [lastmodtime]	 = @lastmodtime_8  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmRewardsRecord_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmRewardsRecord where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [DocShareDetail_Insert] (@docid_1 	[int], @userid_2 	[int], @usertype_3 	[int], @sharelevel_4 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [DocShareDetail] ( [docid], [userid], [usertype], [sharelevel])  VALUES ( @docid_1, @userid_2, @usertype_3, @sharelevel_4)

GO
alter procedure [DocShareDetail_DeleteByUserId] (@userid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [DocShareDetail]  WHERE ( [userid]	 = @userid_1  and usertype = '1' )

GO
alter procedure [Workflow_ReportType_Update] (@id_1 	[int], @typename_2 	varchar(4000), @typedesc_3 	varchar(4000), @typeorder_4 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [Workflow_ReportType]  SET  [typename]	 = @typename_2, [typedesc]	 = @typedesc_3, [typeorder]	 = @typeorder_4  WHERE ( [id]	 = @id_1)

GO
alter procedure [Workflow_ReportType_SelectByID] (@id_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS select * from Workflow_ReportType where id = @id_1

GO
alter procedure [Workflow_ReportType_Select] (@flag	[int]	output, @msg	varchar(4000)	output) AS select * from Workflow_ReportType order by typeorder

GO
alter procedure [Workflow_ReportType_Insert] (@typename_1 	varchar(4000), @typedesc_2 	varchar(4000), @typeorder_3 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [Workflow_ReportType] ( [typename], [typedesc], [typeorder])  VALUES ( @typename_1, @typedesc_2, @typeorder_3)

GO
alter procedure [Workflow_ReportType_Delete] (@id_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS declare @count integer select @count = count(id) from Workflow_Report where reporttype = @id_1 if (@count > 0) begin select 0 return end else begin DELETE [Workflow_ReportType] WHERE ( [id]	 = @id_1) end

GO
alter procedure [T_InputReportConfirm_SByUID]( @crmid_1  int , @contactid_2  varchar(4000) , @flag	int	output, @msg	varchar(4000)	output) AS select distinct * from (select a.inprepname, b.* from T_InputReport a, T_InputReportConfirm b,T_InputReportCrm c where a.inprepid = b.inprepid and b.inprepid=c.inprepid and b.crmid=c.crmid and b.crmid = @crmid_1 union select distinct a.inprepname, b.* from T_InputReport a,T_InputReportConfirm b,T_InputReportCrmSel c,T_InputReportCrm d where d.inprepcrmid = c.inprepcrmid and a.inprepid = b.inprepid and a.inprepid = d.inprepid and c.contacterid = @contactid_2 and  ','+c.SELCRM+',' like ','+b.crmid+',') a

GO
alter procedure [T_InputReportConfirm_Insert] (@inprepid_1 	int, @inprepbudget_2 	char(1), @thetable_2 	varchar(4000), @inputid_3      int , @inprepdspdate_3 	varchar(4000), @crmid_4 	int, @confirmuserid_5 	int , @reportuserid_6 	int , @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO T_InputReportConfirm ( inprepid, inprepbudget, thetable , inputid , inprepdspdate, crmid, confirmuserid, reportuserid)  VALUES ( @inprepid_1, @inprepbudget_2, @thetable_2 , @inputid_3 , @inprepdspdate_3, @crmid_4, @confirmuserid_5, @reportuserid_6)

GO
alter procedure [T_InputReportConfirm_Delete] (@confirmid_1 	int , @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_InputReportConfirm  WHERE ( confirmid	 = @confirmid_1)

GO
alter procedure [Prj_Tool_SelectAllPlan] (@prjid [int], @version varchar(4000), @relateid [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT t1.*,t2.wbscoding,t2.subject,t2.id as taskrecordid FROM [Prj_Tool] as t1, [Prj_TaskInfo] as t2 WHERE ( t1.prjid	 = @prjid and t1.version like '%|' + @version + '|%' and t1.relateid = @relateid and t2.prjid	 = @prjid and t2.version = @version  and t1.taskid=t2.taskid ) order by t2.wbscoding  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Tool_Insert] (@prjid 	[int], @taskid [int], @relateid 	[int], @version varchar(4000), @begindate 	varchar(4000), @enddate varchar(4000), @workday [decimal] (10,1), @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS INSERT INTO [Prj_Tool] ( [prjid], [taskid], [relateid], [version], [begindate], [enddate], [workday], [cost])  VALUES ( @prjid , @taskid , @relateid 	, @version, @begindate, @enddate, @workday, @cost ) INSERT INTO [Prj_ToolProcess] ( [prjid], [taskid], [relateid], [isactived])  VALUES ( @prjid , @taskid , @relateid , '0') set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Tool_Delete] (@id [int], @version varchar(4000), @flag integer output, @msg varchar(4000) output )  AS update [Prj_Tool] set version=replace(version, @version, '')  WHERE ( [id] = @id) delete [Prj_Tool] WHERE ( [id] = @id and version='' )  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_TradeInfo_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_TradeInfo] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Workflow_ReportDspField_Insert] (@reportid_1    [int], @fieldid_2   [int], @dsporder_3  varchar(4000), @isstat_4    [char](1), @dborder_5     char(1) , @dbordertype_6     char(1), @compositororder  [int],  @reportcondition_9 [int], @fieldwidth_10 [numeric](10,2) ,@valueone_11 varchar(4000),@valuetwo_12 varchar(4000),@valuethree_13 varchar(4000),@valuefour_14 varchar(4000),@httype_15 varchar(4000),@htdetailtype_16 varchar(4000), @flag   [int]   output, @msg    varchar(4000)   output) AS INSERT INTO [Workflow_ReportDspField] ( [reportid], [fieldid], [dsporder], [isstat],[dborder],[dbordertype],[compositororder],[reportcondition],[fieldwidth],[valueone],[valuetwo],[valuethree],[valuefour],[httype],[htdetailtype]) VALUES ( @reportid_1, @fieldid_2, @dsporder_3, @isstat_4, @dborder_5, @dbordertype_6,@compositororder,@reportcondition_9 ,@fieldwidth_10,@valueone_11,@valuetwo_12,@valuethree_13,@valuefour_14,@httype_15,@htdetailtype_16)

GO
alter procedure [Workflow_ReportDspField_Delete] (@id_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [Workflow_ReportDspField]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmFamilyInfo_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmFamilyInfo where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmFamilyInfo_SbyResourceID] @resourceid varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmFamilyInfo where resourceid =convert(int, @resourceid) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmFamilyInfo_Insert] (@resourceid_1 	int, @member_2 	varchar(4000), @title_3 	varchar(4000), @company_4 	varchar(4000), @jobtitle_5 	varchar(4000), @address_6 	varchar(4000), @flag integer output, @msg varchar(4000) output) AS INSERT INTO HrmFamilyInfo ( resourceid, member, title, company, jobtitle, address) VALUES ( @resourceid_1, @member_2, @title_3, @company_4, @jobtitle_5, @address_6  )

GO
alter procedure [HrmFamilyInfo_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) AS DELETE HrmFamilyInfo WHERE resourceid = @id_1

GO
alter procedure [HrmEducationLevel_Update] (@id_1 	[int], @name_2 	varchar(4000), @description_3 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS UPDATE [HrmEducationLevel]  SET  [name]	 = @name_2, [description]	 = @description_3  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmEducationLevel_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmEducationLevel where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [DocShare_SelectByDocID] (@docid	int, @flag	int output, @msg	varchar(4000)	output) as select * from DocShare where docid = @docid

GO
alter procedure [DocShare_IFromDocSecCategoryDL] ( @docid          int, @sharetype	int, @seclevel	tinyint, @rolelevel	tinyint, @sharelevel	tinyint, @userid	int, @subcompanyid	int, @departmentid	int, @roleid	int, @foralluser	tinyint, @crmid	int, @orgGroupId	int, @downloadlevel int, @flag	int output, @msg	varchar(4000)	output ) as insert into DocShare(docid,sharetype,seclevel,rolelevel,sharelevel,userid,subcompanyid,departmentid,roleid,foralluser,crmid,orgGroupId,downloadlevel) values (@docid,@sharetype,@seclevel,@rolelevel,@sharelevel,@userid,@subcompanyid,@departmentid,@roleid,@foralluser,@crmid,@orgGroupId,@downloadlevel)  select @@IDENTITY

GO
alter procedure [DocShare_IFromDocSecCategory] ( @docid          int, @sharetype	int, @seclevel	tinyint, @rolelevel	tinyint, @sharelevel	tinyint, @userid	int, @subcompanyid	int, @departmentid	int, @roleid	int, @foralluser	tinyint, @crmid	int, @flag	int output, @msg	varchar(4000)	output ) as insert into DocShare(docid,sharetype,seclevel,rolelevel,sharelevel,userid,subcompanyid,departmentid,roleid,foralluser,crmid) values (@docid,@sharetype,@seclevel,@rolelevel,@sharelevel,@userid,@subcompanyid,@departmentid,@roleid,@foralluser,@crmid)  select @@IDENTITY

GO
alter procedure [DocShare_IFromDocSecCat_G] ( @docid          int, @sharetype	int, @seclevel	tinyint, @rolelevel	tinyint, @sharelevel	tinyint, @userid	int, @subcompanyid	int, @departmentid	int, @roleid	int, @foralluser	tinyint, @crmid	int, @orgGroupId int, @downloadlevel int, @flag	int output, @msg	varchar(4000)	output ) as insert into DocShare(docid,sharetype,seclevel,rolelevel,sharelevel,userid,subcompanyid,departmentid,roleid,foralluser,crmid,orgGroupId,downloadlevel) values (@docid,@sharetype,@seclevel,@rolelevel,@sharelevel,@userid,@subcompanyid,@departmentid,@roleid,@foralluser,@crmid,@orgGroupId,@downloadlevel)  select @@IDENTITY

GO
alter procedure [MailPassword_SbyResourceid] (@resourceid_1 	int, @flag integer output, @msg varchar(4000) output) AS select * from MailPassword where resourceid = @resourceid_1

GO
alter procedure [MailPassword_IByResourceid] (@resourceid_1 	int, @resourcemail_2 	varchar(4000), @password	varchar(4000), @flag integer output, @msg varchar(4000) output) AS declare @count int select @count=count(*) from MailPassword where resourceid=@resourceid_1 if @count>0 update MailPassword set resourcemail=@resourcemail_2,password=@password where resourceid=@resourceid_1 else insert into MailPassword values(@resourceid_1,@resourcemail_2,@password)

GO
alter procedure [HrmRightCardInfo_Insert] ( @resourceid_2 int ,  @carddate_3 char(10), @cardtime_4 char(5) ,  @inorout_5  int ,            @flag        integer output , @msg         varchar(4000) output)  AS declare @cardcount int , @reccount int select @cardcount = count(id) from HrmRightCardInfo where carddate = @carddate_3 and resourceid = @resourceid_2 and cardtime = @cardtime_4 if @cardcount = 0 begin        INSERT INTO HrmRightCardInfo ( resourceid , carddate , cardtime , inorout , islegal , workout ) VALUES ( @resourceid_2 , @carddate_3 , @cardtime_4 , @inorout_5 , 0 , 0 ) end   

 GO
alter procedure [HrmRightCardInfo_Delete] ( @id_1 int , @flag        integer output , @msg         varchar(4000) output)  AS  declare @resourceid_2 int , @carddate_3 char(10) select @resourceid_2 = resourceid , @carddate_3 = carddate from HrmRightCardInfo where id = @id_1 delete HrmRightCardInfo where id = @id_1 update HrmRightCardInfo set islegal = 0 where carddate = @carddate_3 and resourceid = @resourceid_2 select @resourceid_2, @carddate_3

 GO
alter procedure [HrmRightCardInfo_AddWork] ( @id_1 int , @flag        integer output , @msg         varchar(4000) output)  AS  declare @resourceid_2 int , @carddate_3 char(10) select @resourceid_2 = resourceid , @carddate_3 = carddate from HrmRightCardInfo where id = @id_1 update HrmRightCardInfo set workout = 2 where id = @id_1 update HrmRightCardInfo set islegal = 0 where carddate = @carddate_3 and resourceid = @resourceid_2 select @resourceid_2, @carddate_3

GO
alter procedure [DocPicUpload_Update] (@id_1 	[int], @picname_2 	varchar(4000), @pictype_3 	[char](1), @imagefilename_4 	varchar(4000), @imagefileid_5 	[int], @imagefilewidth_6 	[smallint], @imagefileheight_7 	[smallint], @imagefilesize_8 	[int], @imagefilescale_9 	[real], @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [DocPicUpload]  SET  [picname]	 = @picname_2, [pictype]	 = @pictype_3, [imagefilename]	 = @imagefilename_4, [imagefileid]	 = @imagefileid_5, [imagefilewidth]	 = @imagefilewidth_6, [imagefileheight]	 = @imagefileheight_7, [imagefilesize]	 = @imagefilesize_8, [imagefilescale]	 = @imagefilescale_9  WHERE ( [id]	 = @id_1)

GO
alter procedure [DocPicUpload_SelectByID] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS select * from DocPicUpload where id= @id_1

GO
alter procedure [DocPicUpload_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output)  AS select * from DocPicUpload

GO
alter procedure [DocPicUpload_Insert] (@picname_1 	varchar(4000), @pictype_2 	[char](1), @imagefilename_3 	varchar(4000), @imagefileid_4 	[int], @imagefilewidth_5 	[smallint], @imagefileheight_6 	[smallint], @imagefilesize_7 	[int], @imagefilescale_8 	[real] , @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [DocPicUpload] ( [picname], [pictype], [imagefilename], [imagefileid], [imagefilewidth], [imagefileheight], [imagefilesize], [imagefilescale])  VALUES ( @picname_1, @pictype_2, @imagefilename_3, @imagefileid_4, @imagefilewidth_5, @imagefileheight_6, @imagefilesize_7, @imagefilescale_8) select max(id) from DocPicUpload

GO
alter procedure [DocPicUpload_Delete] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [DocPicUpload]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmWorkResumeIn_Update] (@id_1 	[int], @resourceid_2 	[int], @datefrom_3 	[char](10), @dateto_4 	[char](10), @departmentid_5 	[int], @jobtitle_6 	[int], @joblevel_7 	[tinyint], @lastmoderid_8 	[int], @lastmoddate_9 	[char](10), @lastmodtime_10 	[char](8), @flag integer output, @msg varchar(4000) output)  AS UPDATE [HrmWorkResumeIn]  SET  [resourceid]	 = @resourceid_2, [datefrom]	 = @datefrom_3, [dateto]	 = @dateto_4, [departmentid]	 = @departmentid_5, [jobtitle]	 = @jobtitle_6, [joblevel]	 = @joblevel_7, [lastmoderid]	 = @lastmoderid_8, [lastmoddate]	 = @lastmoddate_9, [lastmodtime]	 = @lastmodtime_10  WHERE ( [id]	 = @id_1)

 GO
alter procedure [HrmWorkResumeIn_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmWorkResumeIn where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmWorkResumeIn_Insert] (@resourceid_1 	[int], @datefrom_2 	[char](10), @dateto_3 	[char](10), @departmentid_4 	[int], @jobtitle_5 	[int], @joblevel_6 	[tinyint], @createid_7 	[int], @createdate_8 	[char](10), @createtime_9 	[char](8), @lastmoderid_10 	[int], @lastmoddate_11 	[char](10), @lastmodtime_12 	[char](8), @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [HrmWorkResumeIn] ( [resourceid], [datefrom], [dateto], [departmentid], [jobtitle], [joblevel], [createid], [createdate], [createtime], [lastmoderid], [lastmoddate], [lastmodtime])  VALUES ( @resourceid_1, @datefrom_2, @dateto_3, @departmentid_4, @jobtitle_5, @joblevel_6, @createid_7, @createdate_8, @createtime_9, @lastmoderid_10, @lastmoddate_11, @lastmodtime_12)

GO
alter procedure [HrmWorkResumeIn_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmWorkResumeIn]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmTrainLayout_Update] (@layoutname_1 varchar(4000), @typeid_2 int, @layoutstartdate_3 char(10), @layoutenddate_4 char(10), @layoutcontent_5 text, @layoutaim_6 text, @layouttestdate_7 char(10), @layoutassessor_8 varchar(4000), @id_9 int, @flag int output, @msg varchar(4000) output) as update HrmTrainLayout set layoutname = @layoutname_1, typeid = @typeid_2, layoutstartdate = @layoutstartdate_3, layoutenddate = @layoutenddate_4, layoutcontent = @layoutcontent_5, layoutaim = @layoutaim_6, layouttestdate = @layouttestdate_7, layoutassessor = @layoutassessor_8 where id = @id_9

GO
alter procedure [HrmTrainLayout_Insert] (@layoutname_1 varchar(4000), @typeid_2 int, @layoutstartdate_3 char(10), @layoutenddate_4 char(10), @layoutcontent_5 text, @layoutaim_6 text, @layouttestdate_7 char(10), @layoutassessor_8 varchar(4000), @flag int output, @msg varchar(4000) output) as insert into HrmTrainLayout (layoutname , typeid , layoutstartdate , layoutenddate, layoutcontent, layoutaim, layouttestdate, layoutassessor ) values (@layoutname_1 , @typeid_2 , @layoutstartdate_3 , @layoutenddate_4 , @layoutcontent_5 , @layoutaim_6 , @layouttestdate_7 , @layoutassessor_8 ) select max(id) from HrmTrainLayout

GO
alter procedure [HrmTrainLayout_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) as delete from HrmTrainLayout where id = @id_1

GO
alter procedure [HrmWorkResume_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmWorkResume where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmWorkResume_SByResourceID] @resourceid varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmWorkResume where resourceid =convert(int, @resourceid) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmWorkResume_Insert] (@resourceid_1 	int, @startdate_2 	char(10), @enddate_3 	char(10), @company_4 	varchar(4000), @jobtitle_6 	varchar(4000), @workdesc_7 	text, @leavereason_8 	varchar(4000), @flag integer output, @msg varchar(4000) output) AS INSERT INTO HrmWorkResume ( resourceid, startdate, enddate, company, jobtitle, workdesc, leavereason ) VALUES ( @resourceid_1, @startdate_2, @enddate_3, @company_4, @jobtitle_6, @workdesc_7, @leavereason_8)

GO
alter procedure [HrmTrainDay_Update] ( @day_1 CHAR(10) , @starttime CHAR(5), @endtime CHAR(5), @content_2 TEXT , @aim_3 TEXT , @effect_4 TEXT , @plain_5 TEXT , @id_6 INT , @flag INT OUTPUT , @msg varchar(4000) OUTPUT ) AS UPDATE  HrmTrainDay SET     traindate = @day_1 , starttime = @starttime, endtime = @endtime, daytraincontent = @content_2 , daytrainaim = @aim_3 , daytraineffect = @effect_4 , daytrainplain = @plain_5 WHERE   id = @id_6

GO
alter procedure [HrmTrainDay_Insert] ( @trainid_1 INT , @day_2 CHAR(10) , @starttime CHAR(5), @endtime CHAR(5), @content_3 TEXT , @aim_4 TEXT , @flag INT OUTPUT , @msg varchar(4000) OUTPUT ) AS INSERT  INTO HrmTrainDay ( trainid , traindate , starttime, endtime, daytraincontent , daytrainaim ) VALUES  ( @trainid_1 , @day_2 , @starttime, @endtime, @content_3 , @aim_4 ) SELECT  MAX(id) FROM    HrmTrainDay

GO
alter procedure [HrmTrainDay_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) as delete HrmTrainDay where id = @id_1 delete HrmTrainActor where traindayid = @id_1

GO
alter procedure [HrmTrainBeforeWork_Insert] (@resourceid_1 	int, @trainname_2 	varchar(4000), @trainresource_3 	varchar(4000), @trainstartdate_4 	char(10), @trainenddate_5 	char(10), @trainmemo_6 text, @flag integer output, @msg varchar(4000) output) AS INSERT INTO HrmTrainBeforeWork ( resourceid, trainname, trainresource, trainstartdate, trainenddate, trainmemo) VALUES ( @resourceid_1, @trainname_2, @trainresource_3, @trainstartdate_4, @trainenddate_5, @trainmemo_6)

GO
alter procedure [HrmTrainAssess_Update] (@trainid_1 int, @resourceid_2 int, @testdate_3 char(10), @result_4 int, @explain_5 text, @id_6 int, @flag int output, @msg varchar(4000) output) as update HrmTrainAssess set trainid    = @trainid_1, resourceid = @resourceid_2, assessdate = @testdate_3, implement  = @result_4, explain    = @explain_5 where id = @id_6

GO
alter procedure [HrmTrainAssess_Insert] (@trainid_1 int, @resourceid_2 int, @testdate_3 char(10), @result_4 int, @explain_5 text, @flag int output, @msg varchar(4000) output) as insert into HrmTrainAssess (trainid, resourceid, assessdate, implement, explain) values (@trainid_1 , @resourceid_2, @testdate_3, @result_4 , @explain_5)

GO
alter procedure [HrmTrainActor_UpdateReset] (@traindayid_1 int, @flag int output, @msg varchar(4000) output) as update HrmTrainActor set isattend = 0 where traindayid = @traindayid_1

GO
alter procedure [HrmSchedule_Update] ( @id_1 	int, @relatedId_2 	int, @monstarttime1_3 	char(5), @monendtime1_4 	char(5), @monstarttime2_5 	char(5), @monendtime2_6 	char(5), @tuestarttime1_7 	char(5), @tueendtime1_8 	char(5), @tuestarttime2_9 	char(5), @tueendtime2_10 	char(5), @wedstarttime1_11 	char(5), @wedendtime1_12 	char(5), @wedstarttime2_13 	char(5), @wedendtime2_14 	char(5), @thustarttime1_15 	char(5), @thuendtime1_16 	char(5), @thustarttime2_17 	char(5), @thuendtime2_18 	char(5), @fristarttime1_19 	char(5), @friendtime1_20 	char(5), @fristarttime2_21 	char(5), @friendtime2_22 	char(5), @satstarttime1_23 	char(5), @satendtime1_24 	char(5), @satstarttime2_25 	char(5), @satendtime2_26 	char(5), @sunstarttime1_27 	char(5), @sunendtime1_28 	char(5), @sunstarttime2_29 	char(5), @sunendtime2_30 	char(5), @totaltime_31    char(6), @validedatefrom_32 	char(10), @validedateto_33 	char(10), @scheduleType_34 	char, @flag        integer output, @msg         varchar(4000) output ) AS UPDATE HrmSchedule SET relatedId= @relatedId_2, monstarttime1= @monstarttime1_3, monendtime1	 = @monendtime1_4, monstarttime2= @monstarttime2_5, monendtime2	 = @monendtime2_6, tuestarttime1= @tuestarttime1_7, tueendtime1	 = @tueendtime1_8, tuestarttime2= @tuestarttime2_9, tueendtime2	 = @tueendtime2_10, wedstarttime1= @wedstarttime1_11, wedendtime1	 = @wedendtime1_12, wedstarttime2= @wedstarttime2_13, wedendtime2	 = @wedendtime2_14, thustarttime1= @thustarttime1_15, thuendtime1	 = @thuendtime1_16, thustarttime2= @thustarttime2_17, thuendtime2	 = @thuendtime2_18, fristarttime1= @fristarttime1_19, friendtime1	 = @friendtime1_20, fristarttime2= @fristarttime2_21, friendtime2	 = @friendtime2_22, satstarttime1= @satstarttime1_23, satendtime1	 = @satendtime1_24, satstarttime2= @satstarttime2_25, satendtime2	 = @satendtime2_26, sunstarttime1= @sunstarttime1_27, sunendtime1	 = @sunendtime1_28, sunstarttime2= @sunstarttime2_29, sunendtime2	 = @sunendtime2_30, totaltime    = @totaltime_31, validedatefrom= @validedatefrom_32, validedateto= @validedateto_33 , scheduleType= @scheduleType_34 WHERE ( id	 = @id_1)

GO
alter procedure [HrmSchedule_SelectAll] (@flag integer output, @msg varchar(4000) output ) AS select id , validedatefrom ,validedateto from HrmSchedule order by validedatefrom desc

GO
alter procedure [HrmSchedule_Select_ResouceAll] @flag integer output , @msg varchar(4000) output AS select t1.id,t1.relatedid from HrmSchedule t1 where scheduletype='2' set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmSchedule_Select_DepTotal] (@id_1 int, @flag integer output, @msg varchar(4000) output ) AS select totaltime from HrmSchedule where scheduletype ='1' and relatedid = @id_1

GO
alter procedure [HrmSchedule_Select_DeptAll] @flag integer output , @msg varchar(4000) output AS select t1.id,t1.relatedid from HrmSchedule t1 where scheduletype='1' set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmSchedule_Select_Default] (@id_1 int , @flag integer output, @msg varchar(4000) output ) AS select * from HrmSchedule where id = @id_1

GO
alter procedure [HrmSchedule_Select_Current] (@currentdate_1 varchar(4000) , @flag integer output, @msg varchar(4000) output ) AS select * from HrmSchedule where	scheduleType='3' and validedatefrom <= @currentdate_1 and validedateto >= @currentdate_1

GO
alter procedure [HrmSchedule_Select_CheckExist] @relatedid integer, @scheduletype char(1), @flag integer output , @msg varchar(4000) output AS select * from HrmSchedule where relatedid = (@relatedid) and scheduletype = (@scheduletype) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmSalaryRateBase_Update] ( @id_1	 	int, @name_1 varchar(4000) , @taxrate_1 decimal (6,1)  , @flag	int	output, @msg	varchar(4000)	output ) AS UPDATE HrmSalaryRateBase SET  name	 = @name_1,  taxrate=@taxrate_1  WHERE ( id	 = @id_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryRateBase_SelectByID] (@id_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryRateBase WHERE id=@id_1 set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryRateBase_SelectAll] (@flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryRateBase  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryRateBase_Insert] (	@name_1 varchar(4000) , @taxrate_1 decimal (6,1)  , @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO HrmSalaryRateBase ( name,taxrate) VALUES ( @name_1,@taxrate_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryRateBase_Delete] (@id_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS DELETE HrmSalaryRateBase WHERE ( id	 = @id_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryRank_SelectByID] (@id_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryRank WHERE id=@id_1 set @flag = 1 set @msg = 'OK!'

  GO
alter procedure [HrmSalaryRank_SelectAll] (@flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryRank order by itemid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryRank_Insert] (@itemid_1 	int, @jobid_2 	int, @joblevelfrom_3 	int, @joblevelto_4 	int, @amount_5 	decimal(10,2), @jobactivityid_6 	int, @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO HrmSalaryRank ( itemid, jobid, joblevelfrom, joblevelto, amount, jobactivityid)  VALUES ( @itemid_1, @jobid_2, @joblevelfrom_3, @joblevelto_4, @amount_5, @jobactivityid_6)

GO
alter procedure [HrmSalaryRank_Delete] (@id_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS DELETE HrmSalaryRank WHERE ( id	 = @id_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryPersonality_SByid] (@id_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT itemid,salary FROM HrmSalaryPersonality WHERE id=@id_1 set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [HrmSalaryPersonality_SByHrmid] (@id_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryPersonality WHERE hrmid=@id_1 set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryPersonality_Delete] (@hrmid_1 int, @flag	int	output, @msg	varchar(4000)	output) AS delete HrmSalaryPersonality  WHERE ( hrmid	 = @hrmid_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryPersonality_CByHrmid] (@id_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT count(*) FROM HrmSalaryPersonality WHERE hrmid=@id_1 set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryComponent_SelectAll] @jobactivityid           int, @countryid	int, @typeid int, @flag integer output , @msg varchar(4000) output AS if @jobactivityid=0 and @countryid=0 and @typeid=0 select * from hrmsalarycomponent t1, hrmsalarycomponentdetail t2 where t1.id=t2.componentid and t1.countryid is null  if @jobactivityid=0 and @countryid=0 and @typeid<>0 select * from hrmsalarycomponent t1, hrmsalarycomponentdetail t2 where t1.componenttypeid=@typeid and t1.id=t2.componentid and  t1.countryid is null  if @jobactivityid=0 and @countryid<>0 and @typeid=0 select * from hrmsalarycomponent t1, hrmsalarycomponentdetail t2 where t1.countryid=@countryid and t1.id=t2.componentid  if @jobactivityid<>0 and @countryid=0 and @typeid=0 select * from hrmsalarycomponent t1, hrmsalarycomponentdetail t2 where  t1.jobactivityid=@jobactivityid and t1.id=t2.componentid and t1.countryid is null  if @jobactivityid=0 and @countryid<>0 and @typeid<>0 select * from hrmsalarycomponent t1, hrmsalarycomponentdetail t2 where t1.componenttypeid=@typeid and t1.countryid=@countryid and t1.id=t2.componentid  if @jobactivityid<>0 and @countryid=0 and @typeid<>0 select * from hrmsalarycomponent t1, hrmsalarycomponentdetail t2 where  t1.componenttypeid=@typeid and t1.jobactivityid=@jobactivityid and t1.id=t2.componentid and t1.countryid is null  if @jobactivityid<>0 and @countryid<>0 and @typeid=0 select * from hrmsalarycomponent t1, hrmsalarycomponentdetail t2 where  t1.countryid=@countryid and t1.jobactivityid=@jobactivityid and t1.id=t2.componentid  if @jobactivityid<>0 and @countryid<>0 and @typeid<>0 select * from hrmsalarycomponent t1, hrmsalarycomponentdetail t2 where t1.componenttypeid=@typeid and t1.countryid=@countryid and t1.jobactivityid=@jobactivityid and t1.id=t2.componentid  set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmSalaryComponent_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmSalaryComponent set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmSalaryComponent_S_CheckEx] @typeid int, @flag integer output , @msg varchar(4000) output AS select * from HrmSalaryComponent where componenttypeid=@typeid set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmSalaryComponent_Insert] @componentname	varchar(4000), @countryid                   int, @jobactivityid              int, @componenttype	char(1), @componentperiod	char(1), @currencyid	int, @ledgerid	int, @docid		int, @startdate	char(10), @enddate	char(10), @includetex	char(1), @componenttypeid	int, @flag                              integer output, @msg                             varchar(4000) output  AS if @countryid=0		set @countryid=null if @currencyid=0	set @currencyid=null if @docid=0		set @docid=null  INSERT INTO [HrmSalaryComponent] VALUES (@componentname,@countryid,@jobactivityid,@componenttype, @componentperiod,@currencyid,@ledgerid,@docid,@startdate, @enddate,@includetex,@componenttypeid)  select max(id) from [HrmSalaryComponent]  if @@error<>0 begin set @flag=1 set @msg='操作失败' return end else begin set @flag=0 set @msg='操作成功' return end

GO
alter procedure [HrmSalaryComponent_Delete] @id	int, @flag                              integer output, @msg                             varchar(4000) output  AS DELETE FROM HrmSalaryComponent where id=@id Delete from HrmSalaryComponentDetail where componentid=@id if @@error<>0 begin set @flag=1 set @msg='操作失败' return end else begin set @flag=0 set @msg='操作成功' return end

GO
alter procedure [HrmSalaryChange_Insert] (@multresourceid_1 	varchar(4000), @itemid_2 	int, @changedate_3 	char(10), @changetype_4 	char(1), @salary_5 	decimal(10,2), @changeresion_6 	text, @changeuser_7 	int, @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO HrmSalaryChange ( multresourceid, itemid, changedate, changetype, salary, changeresion, changeuser)  VALUES ( @multresourceid_1, @itemid_2, @changedate_3, @changetype_4, @salary_5, @changeresion_6, @changeuser_7)

GO
alter procedure [HrmSalaryCalBench_Insert] (@itemid_1 	int, @scopetype_2 	int, @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO HrmSalaryCalBench ( itemid, scopetype)  VALUES ( @itemid_1, @scopetype_2)  select max(id) from HrmSalaryCalBench

GO
alter procedure [HrmResource_Try] ( @id_1 int, @changedate_2 char(10), @changereason_3 char(10), @infoman_5 varchar(4000), @oldjobtitleid_7 int, @type_n_8 char(1), @operator_9 int, @flag int output, @msg varchar(4000) output ) AS INSERT INTO HrmStatusHistory ( resourceid, changedate, changereason, infoman, oldjobtitleid, type_n, operator ) VALUES ( @id_1, @changedate_2, @changereason_3, @infoman_5, @oldjobtitleid_7 , @type_n_8 , @operator_9 )

GO
alter procedure [HrmResource_Trigger_Insert] (@id_1 	int, @managerid_2 	int, @departmentid_3 	int, @subcompanyid1_4 	int, @seclevel_5 	tinyint, @managerstr_6 	varchar(4000), @flag int output, @msg varchar(4000) output) AS declare @numcount int select   @numcount = count(*)  from HrmResource_Trigger where id=@id_1 if @numcount =0 begin INSERT INTO HrmResource_Trigger ( id, managerid, departmentid, subcompanyid1, seclevel, managerstr)  VALUES ( @id_1, @managerid_2, @departmentid_3, @subcompanyid1_4, 0, @managerstr_6) end

GO
alter procedure [HrmResourceSkill_Update] (@id_1 	[int], @skilldesc_2 	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output )  AS UPDATE [HrmResourceSkill]  SET  [skilldesc]	 = @skilldesc_2  WHERE ( [id]	 = @id_1) set @flag=1 set @msg='修改人力资源技能信息成功'

GO
alter procedure [HrmResourceSkill_SelectByID] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from HrmResourceSkill where id = @id_1 set @flag=1 set @msg='查询人力资源技能信息成功'

GO
alter procedure [HrmResourceSkill_Select] (@resourceid_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from HrmResourceSkill where resourceid = @resourceid_1 set @flag=1 set @msg='查询人力资源技能信息成功'

GO
alter procedure [HrmResourceSkill_Insert] (@resourceid_1 	[int], @skilldesc_2 	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output )  AS INSERT INTO [HrmResourceSkill] ( [resourceid], [skilldesc])  VALUES ( @resourceid_1, @skilldesc_2)

GO
alter procedure [HrmResourceSkill_Delete] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output )  AS DELETE [HrmResourceSkill]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmResRpDefine_Insert] (@resourceid_1 int, @colname_2 varchar(4000), @showorder_3 int, @header_4 varchar(4000), @flag int output, @msg varchar(4000) output) as insert into HrmResourceRpDefine (resourceid, colname, showorder, header) values (@resourceid_1, @colname_2, @showorder_3, @header_4)

GO
alter procedure [HrmResRpDefine_Delete] (@resourceid_1 int, @flag int output, @msg varchar(4000) output) as delete from HrmResourceRpDefine where resourceid = @resourceid_1

GO
alter procedure [HrmRewardBeforeWork_Insert] (@resourceid_1 	int, @rewardname_2 	varchar(4000), @rewarddate_3 	char(10), @rewardmemo_4         text, @flag integer output, @msg varchar(4000) output) AS INSERT INTO HrmRewardBeforeWork ( resourceid, rewardname, rewarddate, rewardmemo) VALUES ( @resourceid_1, @rewardname_2, @rewarddate_3, @rewardmemo_4)

GO
alter procedure [hrmroles_selectbyrole] @roleid int, @rolelevel int, @flag int output, @msg varchar(4000) output as select resourceid,rolelevel,id from hrmrolemembers where roleid=@roleid and rolelevel=@rolelevel order by rolelevel

GO
alter procedure [HrmRewardsRecord_SByResourceID] @resourceid varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmRewardsRecord where resourceid =convert(int, @resourceid) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmRewardsRecord_Insert] (@resourceid_1 	[int], @rewardsdate_2 	[char](10), @rewardstype_3 	[int], @remark_4 	[text], @createid_5 	[int], @createdate_6 	[char](10), @createtime_7 	[char](8), @lastmoderid_8 	[int], @lastmoddate_9 	[char](10), @lastmodtime_10 	[char](8), @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [HrmRewardsRecord] ( [resourceid], [rewardsdate], [rewardstype], [remark], [createid], [createdate], [createtime], [lastmoderid], [lastmoddate], [lastmodtime])  VALUES ( @resourceid_1, @rewardsdate_2, @rewardstype_3, @remark_4, @createid_5, @createdate_6, @createtime_7, @lastmoderid_8, @lastmoddate_9, @lastmodtime_10)

GO
alter procedure [HrmRewardsRecord_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmRewardsRecord]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmRoles_SystemRight] @roleid int, @flag int output, @msg varchar(4000) output as declare @rightid int , @rolelevel varchar(4000), @rightgroupname varchar(4000) create table #temp( rightgroup varchar(4000), rightlevel char(1), rightid int ) declare right_cursor1 cursor for select rightid,rolelevel from systemrightroles where roleid=@roleid  open right_cursor1 fetch next from right_cursor1 into @rightid , @rolelevel while @@fetch_status=0 begin insert into #temp(rightid,rightlevel) values(@rightid,@rolelevel) select @rightgroupname= '' select @rightgroupname=rightgroupname from Systemrightgroups a, SystemRightToGroup b where rightid = @rightid and a.id=b.groupid update #temp set rightgroup = @rightgroupname where rightid = @rightid fetch next from right_cursor1 into @rightid , @rolelevel end close right_cursor1 deallocate right_cursor1 select rightgroup,rightlevel,rightid from #temp order by rightgroup

GO
alter procedure [HrmRoleStrRight_Sel] @roleid int, @flag int output, @msg varchar(4000) output as  select * from SysRoleSubcomRight where roleid=@roleid

GO
alter procedure [HrmRoleStrRight_Ins] @roleid int, @subcompanyid int,@rightlevel int, @flag int output, @msg varchar(4000) output as  insert into SysRoleSubcomRight(roleid,subcompanyid,rightlevel) values(@roleid,@subcompanyid,@rightlevel)

GO
alter procedure [HrmRoleStrRight_Del] @roleid int, @flag int output, @msg varchar(4000) output as begin delete SysRoleSubcomRight where roleid=@roleid end

GO
alter procedure [HrmRoleSRT_AddByNewSc] (@subcomid int,@supsubcomid int,@flag integer output, @msg varchar(4000) output) as begin  declare c1 cursor for select roleid,rightlevel from SysRoleSubcomRight where subcompanyid=@supsubcomid open c1 declare  @roleid int declare  @rightlevel int  fetch next from c1 into @roleid, @rightlevel while @@fetch_status=0 begin insert into SysRoleSubcomRight(roleid,subcompanyid,rightlevel) values(@roleid, @subcomid, @rightlevel) fetch next from c1 into @roleid, @rightlevel end  close c1 deallocate c1 end

GO
alter procedure [HrmRoleSR_SeByURId] ( @userid int, @rightstr varchar(4000), @flag integer output , @msg varchar(4000) output )  AS  select subcompanyid,max(rightlevel) as rightlevel from SysRoleSubcomRight where roleid in(select a.roleid from HrmRoleMembers a,SystemRightRoles b where a.roleid=b.roleid and a.resourceid=@userid and b.rightid =(select rightid from SystemRightDetail where rightdetail=@rightstr) ) group by subcompanyid

GO
alter procedure [HrmRoleSR_SByURCId] ( @userid int, @rightstr varchar(4000), @subcompanyid int, @flag integer output , @msg varchar(4000) output ) AS select max(rightlevel) as rightlevel from SysRoleSubcomRight where roleid in(select a.roleid from HrmRoleMembers a,SystemRightRoles b where a.roleid=b.roleid and a.resourceid=@userid and b.rightid =(select rightid from SystemRightDetail where rightdetail=@rightstr) ) and subcompanyid=@subcompanyid group by subcompanyid

GO
alter procedure [HrmkqSystemSet_Update]( @tosomeone_1  varchar(4000) , @timeinterval_2  int , @getdatatype_3  int , @getdatavalue_4  varchar(4000) , @avgworkhour_5  int , @salaryenddate_6  int , @signIpScope_7  varchar(4000) , @flag int output, @msg varchar(4000) output) AS update HrmkqSystemSet set tosomeone = @tosomeone_1 , timeinterval = @timeinterval_2 , getdatatype = @getdatatype_3 , getdatavalue = @getdatavalue_4 , avgworkhour = @avgworkhour_5 , salaryenddate = @salaryenddate_6 , signIpScope = @signIpScope_7

GO
alter procedure [HrmkqSystemSet_Select]( @flag int output, @msg varchar(4000) output ) AS select * from HrmkqSystemSet

 GO
alter procedure [HrmList_SelectAll] (@flag  integer output, @msg  varchar(4000) output ) AS select id,name,validate_n from HrmListValidate set @flag=0 set @msg='ok'

GO
alter procedure [HrmLanguageAbility_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmLanguageAbility where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmLanguageAbility_SByResourID] @resourceid varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmLanguageAbility where resourceid =convert(int, @resourceid) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmLanguageAbility_Insert] (@resourceid_1 	[int], @language_2 	varchar(4000), @level_3 	[char](1), @memo_4 	[text], @flag integer output, @msg varchar(4000) output) AS INSERT INTO [HrmLanguageAbility] ( [resourceid], [language], [level_n], [memo])  VALUES ( @resourceid_1, @language_2, @level_3, @memo_4)

GO
alter procedure [HrmLanguageAbility_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmLanguageAbility]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmResource_Hire] ( @id_1 int, @changedate_2 char(10), @changereason_3 text, @infoman_5 varchar(4000), @oldjobtitleid_7 int, @type_n_8 char(1), @operator_9 int, @flag int output, @msg varchar(4000) output ) AS INSERT INTO HrmStatusHistory ( resourceid, changedate, changereason, infoman, oldjobtitleid, type_n, operator ) VALUES ( @id_1, @changedate_2, @changereason_3, @infoman_5, @oldjobtitleid_7 , @type_n_8, @operator_9 )

GO
alter procedure [HrmResource_Redeploy] ( @id_1 int, @changedate_2 char(10), @changereason_4 text, @oldjobtitleid_7 int, @oldjoblevel_8 int, @newjobtitleid_9 int, @newjoblevel_10 int, @infoman_6 varchar(4000), @type_n_11 int, @ischangesalary_12 int, @oldmanagerid_1 int, @newmanagerid_1 int, @oldDepartmentId_1 int, @newDepartmentId_1 int, @oldSubcompanyId_1 int, @newSubcompanyId_1 int, @operator_19 int, @flag int output, @msg varchar(4000) output ) AS INSERT INTO HrmStatusHistory ( resourceid, changedate, changereason, oldjobtitleid, oldjoblevel, newjobtitleid, newjoblevel, infoman, type_n, ischangesalary,oldmanagerid,newmanagerid,oldDepartmentId, newDepartmentId,oldSubcompanyId,newSubcompanyId,operator ) VALUES ( @id_1, @changedate_2, @changereason_4, @oldjobtitleid_7, @oldjoblevel_8, @newjobtitleid_9, @newjoblevel_10, @infoman_6, @type_n_11, @ischangesalary_12, @oldmanagerid_1, @newmanagerid_1, @oldDepartmentId_1, @newDepartmentId_1, @oldSubcompanyId_1, @newSubcompanyId_1, @operator_19 )

GO
alter procedure [HrmResourceOtherInfo_Update] (@id_1 	[int], @infoname_3 	varchar(4000), @startdate_4 	[char](10), @enddate_5 	[char](10), @docid_6 	[int], @inforemark_7 	[text], @infotype_8 	[int], @seclevel_9 	[tinyint], @lastmoderid_10 	[int], @lastmoddate_11 	[char](10), @flag int output, @msg varchar(4000) output)  AS  if @docid_6 =0 set @docid_6 = null UPDATE [HrmResourceOtherInfo]  SET  	 [infoname]	 = @infoname_3, [startdate]	 = @startdate_4, [enddate]	 = @enddate_5, [docid]	 = @docid_6, [inforemark]	 = @inforemark_7, [infotype]	 = @infotype_8, [seclevel]	 = @seclevel_9, [lastmoderid]	 = @lastmoderid_10, [lastmoddate]	 = @lastmoddate_11  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmResourceOtherInfo_Select] (@userid  int, @flag int output, @msg varchar(4000) output) as select infotype ,'infocount'=count(id) from HrmResourceOtherInfo  where resourceid = @userid group by infotype

GO
alter procedure [HrmResourceOtherInfo_SByType2] (@userid  int, @typeid   int, @flag int output, @msg varchar(4000) output) as select inforemark  from HrmResourceOtherInfo where resourceid = @userid and infotype = @typeid

GO
alter procedure [HrmResourceOtherInfo_SByType] (@userid  int, @typeid   int, @seclevel  tinyint, @flag int output, @msg varchar(4000) output) as select id , infoname ,inforemark from HrmResourceOtherInfo where resourceid = @userid and infotype = @typeid and seclevel <= @seclevel

GO
alter procedure [HrmResourceOtherInfo_SByID] (@id  int, @flag int output, @msg varchar(4000) output) as select * from HrmResourceOtherInfo  where id = @id

GO
alter procedure [HrmJobGroups_Update] (@id_1 [int], @jobgroupname_3 	varchar(4000), @jobgroupremark_5	[text], @flag integer output, @msg varchar(4000) output )  AS UPDATE [HrmJobGroups]  SET  [jobgroupname] = @jobgroupname_3, [jobgroupremark] = @jobgroupremark_5 WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmJobGroups_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmJobGroups where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmJobGroups_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmJobGroups set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmJobGroups_Insert] ( @jobgroupname_2 	varchar(4000),  @jobgroupremark_4 [text], @flag integer output, @msg varchar(4000) output ) AS INSERT INTO [HrmJobGroups] ( [jobgroupname],  [jobgroupremark]) VALUES ( @jobgroupname_2, @jobgroupremark_4) select max(id) from [HrmJobGroups] if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmJobGroups_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [HrmJobGroups]  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmJobCall_Update] (@id_1 	[int], @name_2 	varchar(4000), @description_3 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS UPDATE [HrmJobCall]  SET  [name]	 = @name_2, [description]	 = @description_3  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmJobCall_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmJobCall where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmEducationLevel_Select] @flag integer output , @msg varchar(4000) output  AS select * from HrmEducationLevel set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmEducationLevel_Insert] (@name_1 	varchar(4000), @description_2 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [HrmEducationLevel] ( [name], [description])  VALUES ( @name_1, @description_2)

GO
alter procedure [HrmEducationLevel_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmEducationLevel]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmkqSystem_Insert]( @tosomeone_1 varchar(4000) , @timeinterval_2 int , @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO HrmkqSystemSet(tosomeone , timeinterval) VALUES(@tosomeone_1 , @timeinterval_2)

GO
alter procedure [HrmJobType_Update] (@id_1 	[int], @name_2 	varchar(4000), @description_3 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS UPDATE [HrmJobType]  SET  [name]	 = @name_2, [description]	 = @description_3  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmJobType_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmJobType where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmJobType_Select] @flag integer output , @msg varchar(4000) output  AS select * from HrmJobType set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmJobType_Insert] (@name_1 	varchar(4000), @description_2 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [HrmJobType] ( [name], [description])  VALUES ( @name_1, @description_2)

 GO
alter procedure [HrmCheckPost_Update] (@id_1 int, @checktypeid_2 int, @jobid_3 int, @flag int output, @msg varchar(4000) output) AS UPDATE HrmCheckPost set checktypeid = @checktypeid_2, jobid = @jobid_3 WHERE id = @id_1

 GO
alter procedure [HrmCheckPost_SByid] (@id_1 int, @flag int output, @msg varchar(4000) output) AS select * from HrmCheckPost where id= @id_1

 GO
alter procedure [HrmCheckPost_Insert] (@checktypeid_2 int, @jobid_3 int,  @deptid_4 int,  @subcid_5 int, @flag int output, @msg varchar(4000) output) AS insert into HrmCheckPost (checktypeid,jobid,deptid,subcid) values (@checktypeid_2,@jobid_3,@deptid_4,@subcid_5)

 GO
alter procedure [HrmCheckList_Insert] (@checkname_2 varchar(4000), @checktypeid_3 int, @startdate_4 char(10), @enddate_5 char(10), @status_6 int, @flag int output, @msg varchar(4000) output) AS insert into HrmCheckList (checkname,checktypeid,startdate,enddate,status) values (@checkname_2,@checktypeid_3, @startdate_4,@enddate_5,@status_6) select max(id) from HrmCheckList

 GO
alter procedure [HrmCheckKindItem_Update] (@id_1 int, @checktypeid_2 int, @checkitemid_3 int, @checkitemproportion_4 int, @flag int output, @msg varchar(4000) output) AS UPDATE HrmCheckKindItem set checktypeid = @checktypeid_2, checkitemid = @checkitemid_3, checkitemproportion = @checkitemproportion_4 WHERE id = @id_1

 GO
alter procedure [HrmCheckKindItem_Insert] (@checktypeid_2 int, @checkitemid_3 int, @checkitemproportion_4 int, @flag int output, @msg varchar(4000) output) AS insert into HrmCheckKindItem (checktypeid,checkitemid,checkitemproportion) values (@checktypeid_2,@checkitemid_3, @checkitemproportion_4)

 GO
alter procedure [CptCapitalModify_Insert] (@capitalid_1 	[int], @field_1	[int], @oldvalue_1 	varchar(4000), @currentvalue_1 	varchar(4000), @resourceid_1 [int], @modifydate_1 [char](10), @flag integer output, @msg varchar(4000) output)  AS  INSERT INTO CptCapitalModify (cptid , field  , oldvalue  , currentvalue  , resourceid , modifydate ) VALUES ( @capitalid_1, @field_1, @oldvalue_1, @currentvalue_1, @resourceid_1, @modifydate_1)

GO
alter procedure [HrmCheckKind_Update] (@id_1 int, @kindname_2 varchar(4000), @checkcycle_3 char(1), @checkexpecd_4 int, @checkstartdate_5 char(10), @flag int output, @msg varchar(4000) output) AS UPDATE HrmCheckKind set kindname = @kindname_2, checkcycle = @checkcycle_3, checkexpecd = @checkexpecd_4, checkstartdate= @checkstartdate_5 WHERE id = @id_1

 GO
alter procedure [HrmCheckKind_SByid] (@id_1 int, @flag int output, @msg varchar(4000) output) AS select * from HrmCheckKind where id= @id_1

GO
alter procedure [HrmCheckKind_Insert] (@kindname_2 varchar(4000), @checkcycle_3 char(1), @checkexpecd_4 int, @checkstartdate_5 char(10), @flag int output, @msg varchar(4000) output) AS insert into HrmCheckKind (kindname,checkcycle,checkexpecd,checkstartdate) values (@kindname_2,@checkcycle_3, @checkexpecd_4, @checkstartdate_5)

  GO
alter procedure [HrmCheckItem_Update] (@id_1 int, @checkitemname_2 varchar(4000), @checkitemexplain_3 varchar(4000), @flag int output, @msg varchar(4000) output) AS UPDATE HrmCheckItem set checkitemname = @checkitemname_2, checkitemexplain = @checkitemexplain_3 WHERE id = @id_1

 GO
alter procedure [HrmCheckItem_SByid] (@id_1 int, @flag int output, @msg varchar(4000) output) AS SELECT * FROM HrmCheckItem WHERE id = @id_1

  GO
alter procedure [HrmCheckItem_Insert] (@checkitemname_2 varchar(4000), @checkitemexplain_3 varchar(4000), @flag int output, @msg varchar(4000) output) AS insert into HrmCheckItem (checkitemname, checkitemexplain) values (@checkitemname_2,@checkitemexplain_3)

 GO
alter procedure [HrmCheckItem_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) AS DELETE HrmCheckItem WHERE id = @id_1

  GO
alter procedure [HrmCheckGrade_Update] (@id_1 int, @checkpeopleid_2 int, @checkitemid_3 int, @result_4 int, @checkitemproportion_5 int, @flag int output, @msg varchar(4000) output) AS UPDATE HrmCheckGrade set checkpeopleid = @checkpeopleid_2, checkitemid = @checkitemid_3, result = @result_4, checkitemproportion = @checkitemproportion_5 WHERE id = @id_1

  GO
alter procedure [HrmCheckGrade_Insert] (@checkpeopleid_2 int, @checkitemid_3 int, @result_4 int, @checkitemproportion_5 int, @flag int output, @msg varchar(4000) output) AS insert into HrmCheckGrade (checkpeopleid,checkitemid,result,checkitemproportion) values (@checkpeopleid_2,@checkitemid_3, @result_4,@checkitemproportion_5)

 GO
alter procedure [HrmCheckActor_Update] (@id_1 int, @checktypeid_2 int, @typeid_3 int, @resourceid_4 int, @checkproportion_5 int, @flag int output, @msg varchar(4000) output) AS UPDATE HrmCheckActor set checktypeid = @checktypeid_2, typeid = @typeid_3, resourceid = @resourceid_4, checkproportion = @checkproportion_5 WHERE id = @id_1

 GO
alter procedure [HrmCheckActor_Insert] (@checktypeid_2 int, @typeid_3 int, @resourceid_4 int, @checkproportion_5 int, @flag int output, @msg varchar(4000) output) AS insert into HrmCheckActor (checktypeid,typeid,resourceid,checkproportion) values (@checktypeid_2, @typeid_3,@resourceid_4,@checkproportion_5)

GO
alter procedure [HrmCertification_Update] (@id_1 	[int], @resourceid_2 	[int], @datefrom_3 	[char](10), @dateto_4 	[char](10), @certname_5 	varchar(4000), @awardfrom_6 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS UPDATE [HrmCertification]  SET  [resourceid]	 = @resourceid_2, [datefrom]	 = @datefrom_3, [dateto]	 = @dateto_4, [certname]	 = @certname_5, [awardfrom]	 = @awardfrom_6 WHERE ( [id]	 = @id_1)

 GO
alter procedure [HrmCertification_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmCertification where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmCertification_Insert] (@resourceid_1 	[int], @datefrom_2 	[char](10), @dateto_3 	[char](10), @certname_4 	varchar(4000), @awardfrom_5 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [HrmCertification] ( [resourceid], [datefrom], [dateto], [certname], [awardfrom]) VALUES ( @resourceid_1, @datefrom_2, @dateto_3, @certname_4, @awardfrom_5)

GO
alter procedure [HrmCertification_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmCertification]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmCountry_Update] (@id_1 	[int], @countryname_2 	varchar(4000), @countrydesc_3 	varchar(4000), @flag integer output, @msg varchar(4000) output )  AS UPDATE [HrmCountry]  SET  [countryname]	 = @countryname_2, [countrydesc]	 = @countrydesc_3  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmCountry_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmCountry set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmCountry_Insert] (@countryname_1 	varchar(4000), @countrydesc_2 	varchar(4000), @flag integer output, @msg varchar(4000) output )  AS INSERT INTO [HrmCountry] ( [countryname], [countrydesc])  VALUES ( @countryname_1, @countrydesc_2) select max(id) from [HrmCountry] if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmCountry_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [HrmCountry]  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmCostcenterSubCategory_U] (@id_1 	[int], @ccsubcategoryname_2 	varchar(4000), @ccsubcategorydesc_3 	varchar(4000), @ccmaincategoryid_4 	[tinyint], @flag integer output, @msg varchar(4000) output )  AS UPDATE [HrmCostcenterSubCategory]  SET  [ccsubcategoryname]	 = @ccsubcategoryname_2, [ccsubcategorydesc]	 = @ccsubcategorydesc_3, [ccmaincategoryid]	 = @ccmaincategoryid_4  WHERE ( [id]	 = @id_1) IF @@error<>0 begin set @flag=1 set @msg='更新储存过程失败' return END ELSE begin set @flag=1 set @msg='更新储存过程失败' return END

GO
alter procedure [HrmCostcenterSubCategory_S] @flag integer output , @msg varchar(4000) output AS select * from HrmCostcenterSubCategory set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmCostcenterSubCategory_I] (@ccsubcategoryname_1 	varchar(4000), @ccsubcategorydesc_2 	varchar(4000), @ccmaincategoryid_3 	[tinyint], @flag integer output, @msg varchar(4000) output ) AS  INSERT INTO [HrmCostcenterSubCategory] ( [ccsubcategoryname], [ccsubcategorydesc], [ccmaincategoryid] )  VALUES ( @ccsubcategoryname_1, @ccsubcategorydesc_2, @ccmaincategoryid_3 ) select (max(id)) from [HrmCostcenterSubCategory] if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmCostcenterSubCategory_D] (@id_1 [int], @flag integer output, @msg varchar(4000) output ) AS DELETE [HrmCostcenterSubCategory] WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmCity_Delete] (@id 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [HrmCity]  WHERE ( [id]	 = @id) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmEducationInfo_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmEducationInfo where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmEducationInfo_SByResourceID] @resourceid varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmEducationInfo where resourceid =convert(int, @resourceid) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmEducationInfo_Insert] (@resourceid_1 	int, @startdate_2 	char(10), @enddate_3 	char(10), @school_4 	varchar(4000), @speciality_5 	varchar(4000) , @educationlevel_6 	int, @studydesc_7 	text, @flag integer output, @msg varchar(4000) output) AS INSERT INTO HrmEducationInfo ( resourceid, startdate, enddate, school, speciality, educationlevel, studydesc) VALUES ( @resourceid_1, @startdate_2, @enddate_3, @school_4, @speciality_5, @educationlevel_6 , @studydesc_7)

GO
alter procedure [HrmEducationInfo_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmEducationInfo]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmCareerWorkexp_SByApplyId] (@applyid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmCareerWorkexp WHERE applyid  = @applyid

GO
alter procedure [HrmCareerWorkexp_Insert] (@ftime_1 	[char](10), @ttime_2 	[char](10), @company_3 	varchar(4000), @jobtitle_4 	varchar(4000), @workdesc_5 	[text], @applyid_6 	[int], @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [HrmCareerWorkexp] ( [ftime], [ttime], [company], [jobtitle], [workdesc], [applyid])  VALUES ( @ftime_1, @ttime_2, @company_3, @jobtitle_4, @workdesc_5, @applyid_6)

 GO
alter procedure [HrmByCheckPeople_Update] (@id_1 int, @result_2 decimal(10,2), @lastmodifydate_3 char(10), @flag int output, @msg varchar(4000) output) AS UPDATE HrmByCheckPeople set result = @result_2, lastmodifydate= @lastmodifydate_3 WHERE id = @id_1

  GO
alter procedure [HrmByCheckPeople_Insert] (@checkid_2 int, @resourceid_3 int, @checkercount_4 int, @proportion_5 int, @checkresourcetype_6 int, @result_7 decimal (10,2), @flag int output, @msg varchar(4000) output) AS insert into HrmByCheckPeople (checkid,resourceid,checkercount,proportion,checkresourcetype ,result) values (@checkid_2,@resourceid_3,@checkercount_4, @proportion_5,@checkresourcetype_6, @result_7) select max(id) from HrmByCheckPeople

GO
alter procedure [HrmBPMGoalMaxId_Get] (@flag int output, @msg varchar(4000) output) as declare @id_1 integer select @id_1=currentid from SequenceIndex where indexdesc='goalid' update SequenceIndex set currentid = @id_1+1 where indexdesc='goalid' select @id_1

GO
alter procedure [HrmBirthdayShare_Insert] ( @sharetype_1 INT , @seclevel_1 TINYINT , @rolelevel_1 TINYINT , @sharelevel_1 TINYINT , @userid_1 INT , @subcompanyid_1 INT , @departmentid_1 INT , @roleid_1 INT , @foralluser_1 TINYINT , @flag INT OUTPUT , @msg varchar(4000) OUTPUT ) AS INSERT  INTO HrmBirthdayShare ( sharetype , seclevel , rolelevel , sharelevel , userid , subcompanyid , departmentid , roleid , foralluser ) VALUES  ( @sharetype_1 , @seclevel_1 , @rolelevel_1 , @sharelevel_1 , @userid_1 , @subcompanyid_1 , @departmentid_1 , @roleid_1 , @foralluser_1 )

GO
alter procedure [HrmBirthdayShare_Delete] ( @id INT , @flag INT OUTPUT , @msg varchar(4000) OUTPUT ) AS DELETE  FROM HrmBirthdayShare WHERE   id = @id

GO
alter procedure [HrmBank_Update] (@id	int, @bankname	varchar(4000), @bankdesc	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output ) AS update hrmbank set bankname=@bankname, bankdesc=@bankdesc where id=@id if @@error<>0 begin set @flag=1 set @msg='查询人力资源信息成功' return end else begin set @flag=0 set @msg='查询人力资源信息失败' return end

GO
alter procedure [HrmBank_SelectAll] (  @flag                             integer output, @msg                             varchar(4000) output ) AS select * from HrmBank order by id  if @@error<>0 begin set @flag=1 set @msg='查询人力资源信息成功' return end else begin set @flag=0 set @msg='查询人力资源信息失败' return end

  GO
alter procedure [HrmBank_Insert] ( @bankname	varchar(4000), @bankdesc	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output ) AS INSERT INTO hrmbank values(@bankname, @bankdesc) select max(id) from hrmbank if @@error<>0 begin set @flag=1 set @msg='查询人力资源信息成功' return end else begin set @flag=0 set @msg='查询人力资源信息失败' return end

GO
alter procedure [HrmBank_Delete] (@id	int, @flag                             integer output, @msg                             varchar(4000) output ) AS delete from hrmbank where id=@id  if @@error<>0 begin set @flag=1 set @msg='right' return end else begin set @flag=0 set @msg='wrong' return end

  GO
alter procedure [HrmCardInfo_SelectCount] ( @carddate_3 char(10), @workshift_5  char(1) , @Cardid_6  char(10) ,  @flag        integer output , @msg         varchar(4000) output)  AS  select count(id) from HrmCardInfo where carddate = @carddate_3 and workshift = @workshift_5 and Cardid = @Cardid_6

   GO
alter procedure [HrmCardInfo_Insert] ( @stationid_2 char(2) ,  @carddate_3 char(10), @cardtime_4 char(5) ,  @workshift_5  char(1) , @Cardid_6  char(10) ,  @flag        integer output , @msg         varchar(4000) output)  AS INSERT INTO HrmCardInfo ( stationid , carddate , cardtime , workshift , Cardid )  VALUES ( @stationid_2 , @carddate_3 , @cardtime_4 , @workshift_5 , @Cardid_6 )

 GO
alter procedure [HrmAwardType_Update] (@id_1 int, @name_2 varchar(4000), @awardtype_3 char(1), @description_4 varchar(4000), @transact_5 varchar(4000), @flag int output, @msg varchar(4000) output) AS UPDATE HrmAwardType set name = @name_2, awardtype = @awardtype_3, description = @description_4, transact= @transact_5 WHERE id = @id_1

 GO
alter procedure [HrmAwardType_SByid] (@id_1 int, @flag int output, @msg varchar(4000) output) as select * from HrmAwardType where id= @id_1

 GO
alter procedure [HrmAwardType_Insert] (@name_2 varchar(4000), @awardtype_3 char(1), @description_4 varchar(4000), @transact_5 varchar(4000), @flag int output, @msg varchar(4000) output) AS insert into HrmAwardType (name,awardtype,description,transact) values (@name_2,@awardtype_3, @description_4, @transact_5)

 GO
alter procedure [HrmAwardType_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) as delete HrmAwardType where id = @id_1

 GO
alter procedure [HrmAwardInfo_Update] (@id_1 int, @rptitle_2 varchar(4000), @resourseid_3 varchar(4000), @rptypeid_4 int, @rpdate_5 char(10), @rpexplain_6 varchar(4000), @rptransact_7 varchar(4000), @flag int output, @msg varchar(4000) output) AS UPDATE HrmAwardInfo set rptitle = @rptitle_2, resourseid = @resourseid_3, rptypeid = @rptypeid_4, rpdate = @rpdate_5, rpexplain = @rpexplain_6, rptransact = @rptransact_7 WHERE id = @id_1

 GO
alter procedure [HrmAwardInfo_SByid] (@id_1 int, @flag int output, @msg varchar(4000) output) AS select * from HrmAwardInfo where id= @id_1

GO
alter procedure [FnaExpensefeeRules_Insert] @feeid		int, @resourceid int, @standardfee    decimal(10,3), @flag integer output , @msg varchar(4000) output as insert into FnaExpensefeeRules (feeid,resourceid,standardfee) values (@feeid,@resourceid,@standardfee)

GO
alter procedure [FnaExpensefeeRules_Delete] @feeid		int, @resourceid int, @flag integer output , @msg varchar(4000) output as delete from FnaExpensefeeRules where feeid=@feeid and resourceid=@resourceid

GO
alter procedure [FnaYearsPeriods_Update] (@id_1 	[int], @budgetid_2 	[int], @flag integer output , @msg varchar(4000) output)  AS UPDATE [FnaYearsPeriods]  SET  [budgetid]	 = @budgetid_2  WHERE ( [id]	 = @id_1)

GO
alter procedure [FnaYearsPeriods_TakeEffect] @id_1 int, @flag integer output, @msg varchar(4000) output AS DECLARE @count integer SELECT @count = count(id) FROM FnaYearsPeriods WHERE status = 1 IF (@count <> 0) BEGIN SELECT '-1' RETURN END UPDATE FnaYearsPeriods SET status = 1 WHERE  id = @id_1

GO
alter procedure [FnaYearsPeriods_SelectMaxYear] @flag integer output , @msg varchar(4000) output AS declare @fnayear char(4) select @fnayear = max(fnayear) from FnaYearsPeriods where status > -1 select * from FnaYearsPeriods where fnayear = @fnayear

GO
alter procedure [FnaYearsPeriods_SelectByID] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS select * from FnaYearsPeriods where id = @id_1

  GO
alter procedure [FnaYearsPeriods_Select] ( @flag integer output , @msg varchar(4000) output) AS SELECT * FROM FnaYearsPeriods ORDER BY fnayear DESC

GO
alter procedure [FnaYearsPeriods_SDefaultBudget] @fnayear    char(4), @flag integer output , @msg varchar(4000) output AS declare @budgetid int  select @budgetid = budgetid from FnaYearsPeriods where fnayear = @fnayear  if @budgetid is null or @budgetid =0 select min(id) from FnaBudgetModule where fnayear = @fnayear else select @budgetid

GO
alter procedure [FnaYearsPeriods_Insert] @fnayear_1 char(4), @startdate_2 char(10), @enddate_3 char(10), @status int, @flag integer output, @msg varchar(4000) output AS declare @count integer select @count = count(id) from FnaYearsPeriods where fnayear = @fnayear_1 if @count <> 0 begin select -1 return end INSERT INTO FnaYearsPeriods (fnayear,startdate,enddate,status) VALUES (@fnayear_1,@startdate_2,@enddate_3,@status) select @@IDENTITY from FnaYearsPeriods

GO
alter procedure [FnaYearsPeriods_Delete] @id_1 int, @flag integer output, @msg varchar(4000) output AS DECLARE @count integer SELECT @count = count(id) FROM FnaYearsPeriodsList WHERE fnayearid = @id_1 AND isclose ='1' IF (@count <> 0) OR EXISTS (SELECT id from FnaBudgetInfo WHERE budgetperiods = @id_1) OR EXISTS (SELECT id from FnaBudgetInfoDetail WHERE budgetperiods = @id_1) BEGIN SELECT '20' RETURN END DELETE FnaYearsPeriods WHERE id = @id_1 DELETE FnaYearsPeriodsList WHERE fnayearid = @id_1

GO
alter procedure [FnaYearsPeriods_Close] @id_1 int, @flag integer output, @msg varchar(4000) output AS DECLARE @count integer UPDATE FnaYearsPeriods SET status = -1 WHERE  id = @id_1

GO
alter procedure [FnaTransactionDetail_SByID] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS select * from FnaTransactionDetail where tranid = @id_1

GO
alter procedure [FnaExpensefeeType_Update] @id		int, @name	varchar(4000), @remark	varchar(4000), @flag	int	output, @msg	varchar(4000) output as update fnaexpensefeetype set name=@name,remark=@remark where id=@id

GO
alter procedure [FnaExpensefeeType_SelectByID] @id		int, @flag	int	output, @msg	varchar(4000) output as select * from fnaexpensefeetype where id=@id

 GO
alter procedure [FnaExpensefeeType_Select] @flag	int	output, @msg	varchar(4000) output as select * from fnaexpensefeetype order by id

GO
alter procedure [FnaExpensefeeType_Insert] @name	varchar(4000), @remark	varchar(4000), @flag	int	output, @msg	varchar(4000) output as insert into fnaexpensefeetype (name,remark) values (@name,@remark) select max(id) from fnaExpensefeeType

GO
alter procedure [FnaExpensefeeType_Delete] @id		int, @flag	int	output, @msg	varchar(4000) output as delete from fnaexpensefeetype where id=@id

GO
alter procedure [FnaDptToKingdee_Select] (@flag integer output, @msg varchar(4000) output) AS select * from FnaDptToKingdee

GO
alter procedure [FnaDptToKingdee_Insert] (@departmentid int, @kingdeecode  varchar(4000), @flag integer output, @msg varchar(4000) output) AS INSERT INTO FnaDptToKingdee(departmentid,kingdeecode )  VALUES ( @departmentid,@kingdeecode ) if @@error<>0 begin set @flag=1 set @msg='插入失败' end else begin set @flag=0 set @msg='操作成功' end

GO
alter procedure [FnaDptToKingdee_Delete] (@flag integer output, @msg varchar(4000) output) AS delete from FnaDptToKingdee

GO
alter procedure [FnaCurrencyExchange_Update] (@id_1 	[int], @avgexchangerate_2 	varchar(4000), @endexchangerage_3 	varchar(4000), @fnayear_4 	[char](4), @periodsid_5 	[int], @flag                             integer output, @msg                             varchar(4000) output )  AS declare @isclose char(1) select @isclose = isclose from FnaYearsPeriodsList where fnayear = @fnayear_4  and Periodsid = @periodsid_5  if @isclose = '1' begin select -1 return end  UPDATE [FnaCurrencyExchange]  SET  [avgexchangerate]	 = @avgexchangerate_2, [endexchangerage]	 = @endexchangerage_3  WHERE ( [id]	 = @id_1)

GO
alter procedure [FnaCurrencyExchange_SelectByID] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from FnaCurrencyExchange where id = @id_1

GO
alter procedure [CRM_ContacterTitle_Update] (@id 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @usetype 	[char](1), @language 	[int], @abbrev 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_ContacterTitle] SET  [fullname]	 = @fullname, [description]	 = @description, [usetype]	 = @usetype, [language]	 = @language, [abbrev]	 = @abbrev WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContacterTitle_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_ContacterTitle] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContacterTitle_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_ContacterTitle] order by id set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContacterTitle_InsertID] (@flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT top 1 id from CRM_ContacterTitle ORDER BY id DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContacterTitle_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @usetype 	[char](1), @language 	[int], @abbrev 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CRM_ContacterTitle] ( [fullname], [description], [usetype], [language], [abbrev]) VALUES ( @fullname, @description, @usetype, @language, @abbrev) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContacterTitle_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [CRM_ContacterTitle] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_ContacterLog_R_Update] (@customerid_1 	[int], @daytype_1	[int], @before_1	[int], @isremind_1	[int], @flag integer output, @msg varchar(4000) output) AS UPDATE CRM_ContacterLog_Remind SET daytype = @daytype_1 , before = @before_1 , isremind = @isremind_1 where  customerid = @customerid_1

GO
alter procedure [CptStockInMain_Update] ( @id_1 [int] , @invoice_1 varchar(4000) , @buyerid_1 [int] , @supplierid_1 [int] , @checkerid_1 [int] , @stockindate_1 [char] (10) , @ischecked_1 [int] , @flag	[int]	output, @msg	varchar(4000)	output ) AS update CptStockInMain set invoice=@invoice_1, buyerid=@buyerid_1 , supplierid=@supplierid_1 , checkerid=@checkerid_1, stockindate=@stockindate_1 , ischecked=@ischecked_1  where id = @id_1

GO
alter procedure [CptStockInMain_SelectByid] ( @id_1 [int] , @flag	[int]	output, @msg	varchar(4000)	output ) AS select * from CptStockInMain where id = @id_1

 GO
alter procedure [CptStockInMain_Insert] ( @invoice_1 varchar(4000) , @buyerid_1 [int] , @supplierid_1 [int] , @checkerid_1 [int] , @stockindate_1 [char] (10) , @ischecked_1 [int] , @flag	[int]	output, @msg	varchar(4000)	output ) AS INSERT INTO [CptStockInMain] ([invoice], [buyerid], [supplierid], [checkerid], [stockindate], [ischecked]) VALUES (@invoice_1, @buyerid_1, @supplierid_1, @checkerid_1, @stockindate_1, @ischecked_1) select max(id) from CptStockInMain

GO
alter procedure [CptStockInDetail_Update] ( @id_1 [int] , @innumber_1 [float] , @flag	[int]	output, @msg	varchar(4000)	output ) AS update CptStockInDetail set  innumber=@innumber_1  where id = @id_1

GO
alter procedure [CptStockInDetail_SByStockid] ( @cptstockinid_1 [int] , @flag	[int]	output, @msg	varchar(4000)	output ) AS  select * from CptStockInDetail where cptstockinid = @cptstockinid_1 order by id

GO
alter procedure [CptStockInDetail_Insert] ( @cptstockinid_1 	int  , @cpttype_1 		int  , @plannumber_1 		float, @innumber_1 		float, @price_1 		decimal(15, 2)  , @customerid_1		int  , @SelectDate_1		char(10)  , @capitalspec_1		varchar(4000)  , @location_1		varchar(4000)  , @invoice_1		varchar(4000)  , @flag	int	output, @msg	varchar(4000)	output ) AS  INSERT INTO CptStockInDetail (cptstockinid, cpttype, plannumber, innumber, price, customerid, SelectDate, capitalspec, location, invoice) VALUES (@cptstockinid_1, @cpttype_1, @plannumber_1, @innumber_1 , @price_1, @customerid_1, @SelectDate_1, @capitalspec_1, @location_1, @invoice_1)  select max(id) from CptStockInDetail

GO
alter procedure [CptStockInDetail_Delete] ( @id_1 [int] , @flag	[int]	output, @msg	varchar(4000)	output ) AS delete CptStockInDetail where id = @id_1

GO
alter procedure [CptRelateWorkflow_Select] @flag integer output , @msg varchar(4000) output  AS select * from CptRelateWorkflow set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [CptShareInfo_Insert_dft] (@relateditemid_1 [int], @sharetype_2 [tinyint], @seclevel_3 [tinyint], @rolelevel_4 [tinyint], @sharelevel_5 [tinyint], @userid_6 [int], @departmentid_7 [int], @roleid_8 [int], @foralluser_9 [tinyint],@subcompanyid_10 [int],@sharefrom_11 [int], @flag integer output, @msg varchar(4000) output) AS INSERT INTO [CptCapitalShareInfo] ( [relateditemid], [sharetype], [seclevel], [rolelevel], [sharelevel], [userid], [departmentid], [roleid], [foralluser],[subcompanyid],[sharefrom],[isdefault])  VALUES ( @relateditemid_1, @sharetype_2, @seclevel_3, @rolelevel_4, @sharelevel_5, @userid_6, @departmentid_7, @roleid_8, @foralluser_9,@subcompanyid_10,@sharefrom_11,1)  select max(id)  id from CptCapitalShareInfo

  GO
alter procedure [CptShareDetail_Insert] (@capitalid 	[int], @userid 	[int], @usertype 	[int], @sharelevel 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [CptShareDetail] ( [cptid],	 [userid] , [usertype], [sharelevel] )  VALUES ( @capitalid,@userid, @usertype, @sharelevel )

 GO
alter procedure [CptShareDetail_DeleteByUserId] (@userid 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [CptShareDetail]  WHERE ( [userid]	 = @userid  and usertype = '1' )

GO
alter procedure [CptShareDetail_DeleteByCptId] (@cptid 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [CptShareDetail]  WHERE ( [cptid]	 = @cptid)

GO
alter procedure [ContractShareDetail_Insert] ( @contractid_1 	[int], @userid_2 	[int], @usertype_3 	[int], @sharelevel_4 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [ContractShareDetail] ([contractid], [userid], [usertype], [sharelevel]) VALUES(@contractid_1, @userid_2, @usertype_3, @sharelevel_4)

GO
alter procedure [ContractShareDetail_DById] ( @contractid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [ContractShareDetail] WHERE ( [contractid]	 = @contractid_1)

GO
alter procedure [bill_workinfodetail_DByType] @infoid		int, @type		int, @flag integer output , @msg varchar(4000) output as delete from bill_weekinfodetail where infoid=@infoid and type=@type

GO
alter procedure [bill_workinfo_UpdateStatus] @id		int, @status	char(1), @flag integer output , @msg varchar(4000) output as update bill_workinfo set status=@status where id=@id

GO
alter procedure [bill_workinfo_UpdateMainid] @formid		int, @userid     int, @mainid     int, @flag integer output , @msg varchar(4000) output as update bill_workinfo set mainid=@mainid where billid=@formid and status='1' and mainid is null and manager=@userid

GO
alter procedure [bill_workinfo_SSubordinate] @formid		int, @userid     int, @flag integer output , @msg varchar(4000) output as select * from bill_workinfo where billid=@formid and status='1' and mainid is null and manager=@userid

GO
alter procedure [Bill_workinfo_SelectByID] @id		int, @flag integer output , @msg varchar(4000) output as select * from bill_workinfo where id=@id

GO
alter procedure [bill_LeaveJob_UpdateStatus] @id		int, @status	char(1), @flag integer output , @msg varchar(4000) output as update bill_LeaveJob set status=@status where id=@id

GO
alter procedure [bill_Discuss_UpdateStatus] @id		int, @status	char(1), @flag integer output , @msg varchar(4000) output as update bill_Discuss set status=@status where id=@id

GO
alter procedure [Bill_Discuss_Update] @id     int, @billid int, @requestid  int, @resourceid int, @accepterid text, @subject    varchar(4000), @isend      int, @projectid  int, @crmid      int, @relatedrequestid   int, @flag integer output , @msg varchar(4000) output as update bill_Discuss set billid=@billid, requestid=@requestid, resourceid=@resourceid, accepterid=@accepterid, subject=@subject, isend=@isend, projectid=@projectid, crmid=@crmid, relatedrequestid=@relatedrequestid where id=@id

GO
alter procedure [Bill_Discuss_Insert] @billid int, @requestid  int, @resourceid int, @accepterid text, @subject    varchar(4000), @isend      int, @projectid  int, @crmid      int, @relatedrequestid   int, @status     char(1), @flag integer output , @msg varchar(4000) output as insert into bill_Discuss (billid,requestid,resourceid,accepterid,subject,isend,projectid,crmid,relatedrequestid,status) values(@billid,@requestid,@resourceid,@accepterid,@subject,@isend,@projectid,@crmid,@relatedrequestid,@status)  select max(id) from bill_Discuss

GO
alter procedure [Bill_SelectList_Insert](@billid int,@fieldname varchar(4000),@selectvalue int,@selectname varchar(4000),@listorder int,@isdefault char(1)) as declare @fieldid int select @fieldid=id from workflow_billfield where billid=@billid and fieldname=@fieldname insert into workflow_SelectItem (fieldid,isbill,selectvalue,selectname,listorder,isdefault) values(@fieldid,1,@selectvalue,@selectname,@listorder,@isdefault)

GO
alter procedure [Bill_NameCardinfo_Update] @resourceid		int, @cname          varchar(4000), @cjobtitle      varchar(4000), @cdepartment    varchar(4000), @phone          varchar(4000), @mobile         varchar(4000), @email          varchar(4000), @ename          varchar(4000), @ejobtitle      varchar(4000), @edepartment    varchar(4000), @flag integer output , @msg varchar(4000) output as update bill_namecardinfo set cname=@cname, cjobtitle=@cjobtitle, cdepartment=@cdepartment, phone=@phone, mobile=@mobile, email=@email, ename=@ename, ejobtitle=@ejobtitle, edepartment=@edepartment where resourceid=@resourceid

GO
alter procedure [bill_NameCardinfo_SByResource] @resourceid		int, @flag integer output , @msg varchar(4000) output as select * from bill_NameCardinfo where resourceid=@resourceid

GO
alter procedure [Bill_NameCardinfo_Insert] @resourceid		int, @cname          varchar(4000), @cjobtitle      varchar(4000), @cdepartment    varchar(4000), @phone          varchar(4000), @mobile         varchar(4000), @email          varchar(4000), @ename          varchar(4000), @ejobtitle      varchar(4000), @edepartment    varchar(4000), @flag integer output , @msg varchar(4000) output as insert into bill_namecardinfo (resourceid,cname,cjobtitle,cdepartment,phone,mobile,email,ename,ejobtitle,edepartment) values(@resourceid,@cname,@cjobtitle,@cdepartment,@phone,@mobile,@email,@ename,@ejobtitle,@edepartment)

GO
alter procedure [bill_monthinfodetail_UByPoint] @id		int, @point	varchar(4000), @flag integer output , @msg varchar(4000) output as update bill_monthinfodetail set point=@point where id=@id

GO
alter procedure [bill_monthinfodetail_SByType] @infoid		int, @type		int, @flag integer output , @msg varchar(4000) output as select * from bill_monthinfodetail where infoid=@infoid and type=@type order by id

GO
alter procedure [bill_monthinfodetail_Insert] @infoid		int, @type		int, @targetname	varchar(4000), @targetresult	text, @forecastdate	char(10), @scale		decimal(10,3), @point		varchar(4000), @flag integer output , @msg varchar(4000) output as insert into bill_monthinfodetail (infoid,type,targetname,targetresult,forecastdate,scale,point) values (@infoid,@type,@targetname,@targetresult,@forecastdate,@scale,@point)

GO
alter procedure [bill_monthinfodetail_DByType] @infoid		int, @type		int, @flag integer output , @msg varchar(4000) output as delete from bill_monthinfodetail where infoid=@infoid and type=@type

GO
alter procedure [bill_MailboxApply_UpdateStatus] @id		int, @status	char(1), @flag integer output , @msg varchar(4000) output as update bill_MailboxApply set status=@status where id=@id

GO
alter procedure [Bill_MailboxApply_SelectByID] @id		int, @flag integer output , @msg varchar(4000) output as select * from bill_MailboxApply where id=@id

GO
alter procedure [bill_Discard_Detail_Insert] (@detailrequestid_1 int, @capitalid_2 int, @numbers_3 decimal(15,3), @date_4 char(10), @fee_5 decimal(15,3), @remark_6 varchar(4000), @flag int output, @msg varchar(4000) output) AS INSERT INTO bill_Discard_Detail (detailrequestid, capitalid, numbers, dates, fee, remark) VALUES (@detailrequestid_1, @capitalid_2, @numbers_3, @date_4, @fee_5, @remark_6)

GO
alter procedure [Base_FreeField_Select] (@tablename 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Base_FreeField] WHERE ( [tablename]	 = @tablename) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [bill_CptRequireMain_Select] (@id 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptRequireMain] WHERE ( [id]	 = @id)

GO
alter procedure [bill_Approve_UpdateStatus] @id		int, @status	char(1), @flag integer output , @msg varchar(4000) output as update Bill_Approve set status=@status where id=@id

 GO
alter procedure [Bill_Approve_SelectByID] @id		int, @flag integer output , @msg varchar(4000) output as select * from Bill_Approve where id=@id

 GO
alter procedure [CptSearchMould_Update] ( @id_1 	int, @userid_2 	int, @mark_3 	varchar(4000), @name_4 	varchar(4000), @startdate_5 	char(10), @startdate1_6 	char(10), @enddate_7 	char(10), @enddate1_8 	char(10), @seclevel_9 	tinyint, @seclevel1_10 	tinyint, @departmentid_11 	int, @costcenterid_12 	int, @resourceid_13 	int, @currencyid_14 	int, @capitalcost_15 	varchar(4000), @capitalcost1_16 	varchar(4000), @startprice_17 	varchar(4000), @startprice1_18 	varchar(4000), @depreendprice_19 	varchar(4000), @depreendprice1_20 	varchar(4000), @capitalspec_21 	varchar(4000), @capitallevel_22 	varchar(4000), @manufacturer_23 	varchar(4000), @manudate_24 	char(10), @manudate1_25 	char(10), @capitaltypeid_26 	int, @capitalgroupid_27 	int, @unitid_28 	int, @capitalnum_29 	varchar(4000), @capitalnum1_30 	varchar(4000), @currentnum_31 	varchar(4000), @currentnum1_32 	varchar(4000), @replacecapitalid_33 	int, @version_34 	varchar(4000), @itemid_35 	int, @depremethod1_36 	int, @depremethod2_37 	int, @deprestartdate_38 	char(10), @deprestartdate1_39 	char(10), @depreenddate_40 	char(10), @depreenddate1_41 	char(10), @customerid_42 	int, @attribute_43 	char(1), @stateid_44 	int, @location_45 	varchar(4000), @isdata		char(1), @counttype	char(1), @isinner	char(1), @stockindate   char(10), @stockindate1   char(10), @flag integer output, @msg varchar(4000) output) AS  UPDATE CptSearchMould  SET userid	 = @userid_2, mark	 = @mark_3, name	 = @name_4, startdate	 = @startdate_5, startdate1	 = @startdate1_6, enddate	 = @enddate_7, enddate1	 = @enddate1_8, seclevel	 = @seclevel_9, seclevel1	 = @seclevel1_10, departmentid	 = @departmentid_11, costcenterid	 = @costcenterid_12, resourceid	 = @resourceid_13, currencyid	 = @currencyid_14, capitalcost	 = @capitalcost_15, capitalcost1	 = @capitalcost1_16, startprice	 = @startprice_17, startprice1	 = @startprice1_18, depreendprice	 = @depreendprice_19, depreendprice1	 = @depreendprice1_20, capitalspec	 = @capitalspec_21, capitallevel	 = @capitallevel_22, manufacturer	 = @manufacturer_23, manudate	 = @manudate_24, manudate1	 = @manudate1_25, capitaltypeid	 = @capitaltypeid_26, capitalgroupid	 = @capitalgroupid_27, unitid	 = @unitid_28, capitalnum	 = @capitalnum_29, capitalnum1	 = @capitalnum1_30, currentnum	 = @currentnum_31, currentnum1	 = @currentnum1_32, replacecapitalid	 = @replacecapitalid_33, version	 = @version_34, itemid	 = @itemid_35, depremethod1	 = @depremethod1_36, depremethod2	 = @depremethod2_37, deprestartdate	 = @deprestartdate_38, deprestartdate1	 = @deprestartdate1_39, depreenddate	 = @depreenddate_40, depreenddate1	 = @depreenddate1_41, customerid	 = @customerid_42, attribute	 = @attribute_43, stateid	 = @stateid_44, location	 = @location_45 , isdata		= @isdata, counttype	= @counttype, isinner	= @isinner, stockindate	= @stockindate, stockindate1	= @stockindate1  WHERE ( id	 = @id_1)

 GO
alter procedure [CptSearchMould_SelectByUserID] (@userid_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from CptSearchMould where userid = @userid_1

 GO
alter procedure [CptSearchMould_SelectByID] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from CptSearchMould where id = @id_1 if @@error<>0 begin set @flag=1 set @msg='查询信息成功' return end else begin set @flag=0 set @msg='查询信息失败' return end

 GO
alter procedure [CptSearchMould_Insert] ( @mouldname_1 	varchar(4000), @userid_2 	int, @mark_3 	varchar(4000), @name_4 	varchar(4000), @startdate_5 	char(10), @startdate1_6 	char(10), @enddate_7 	char(10), @enddate1_8 	char(10), @seclevel_9 	tinyint, @seclevel1_10 	tinyint, @departmentid_11 	int, @costcenterid_12 	int, @resourceid_13 	int, @currencyid_14 	int, @capitalcost_15 	varchar(4000), @capitalcost1_16 	varchar(4000), @startprice_17 	varchar(4000), @startprice1_18 	varchar(4000), @depreendprice_19 	varchar(4000), @depreendprice1_20 	varchar(4000), @capitalspec_21 	varchar(4000), @capitallevel_22 	varchar(4000), @manufacturer_23 	varchar(4000), @manudate_24 	char(10), @manudate1_25 	char(10), @capitaltypeid_26 	int, @capitalgroupid_27 	int, @unitid_28 	int, @capitalnum_29 	varchar(4000), @capitalnum1_30 	varchar(4000), @currentnum_31 	varchar(4000), @currentnum1_32 	varchar(4000), @replacecapitalid_33 	int, @version_34 	varchar(4000), @itemid_35 	int, @depremethod1_36 	int, @depremethod2_37 	int, @deprestartdate_38 	char(10), @deprestartdate1_39 	char(10), @depreenddate_40 	char(10), @depreenddate1_41 	char(10), @customerid_42 	int, @attribute_43 	char(1), @stateid_44 	int, @location_45 	varchar(4000), @isdata		char(1), @counttype	char(1), @isinner	char(1), @stockindate 	char(10), @stockindate1 	char(10), @flag integer output, @msg varchar(4000) output)  AS  INSERT INTO CptSearchMould ( mouldname, userid, mark, name, startdate, startdate1, enddate, enddate1, seclevel, seclevel1, departmentid, costcenterid, resourceid, currencyid, capitalcost, capitalcost1, startprice, startprice1, depreendprice, depreendprice1, capitalspec, capitallevel, manufacturer, manudate, manudate1, capitaltypeid, capitalgroupid, unitid, capitalnum, capitalnum1, currentnum, currentnum1, replacecapitalid, version, itemid, depremethod1, depremethod2, deprestartdate, deprestartdate1, depreenddate, depreenddate1, customerid, attribute, stateid, location, isdata, counttype, isinner, stockindate, stockindate1)  VALUES ( @mouldname_1, @userid_2, @mark_3, @name_4, @startdate_5, @startdate1_6, @enddate_7, @enddate1_8, @seclevel_9, @seclevel1_10, @departmentid_11, @costcenterid_12, @resourceid_13, @currencyid_14, @capitalcost_15, @capitalcost1_16, @startprice_17, @startprice1_18, @depreendprice_19, @depreendprice1_20, @capitalspec_21, @capitallevel_22, @manufacturer_23, @manudate_24, @manudate1_25, @capitaltypeid_26, @capitalgroupid_27, @unitid_28, @capitalnum_29, @capitalnum1_30, @currentnum_31, @currentnum1_32, @replacecapitalid_33, @version_34, @itemid_35, @depremethod1_36, @depremethod2_37, @deprestartdate_38, @deprestartdate1_39, @depreenddate_40, @depreenddate1_41, @customerid_42, @attribute_43, @stateid_44, @location_45, @isdata, @counttype, @isinner, @stockindate, @stockindate1)  select max(id) from CptSearchMould

  GO
alter procedure [CptSearchMould_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [CptSearchMould]  WHERE ( [id]	 = @id_1)

 GO
alter procedure [CptDepreMethod2_Update] (@id_1 	[int], @depreid_2 	[int], @time_3 	[decimal](9,3), @depreunit_4 	[decimal](5,3), @flag                   integer output, @msg                   varchar(4000) output )  AS UPDATE [CptDepreMethod2]  SET  [depreid]	 = @depreid_2, [time]	 = @time_3, [depreunit]	 = @depreunit_4  WHERE ( [id]	 = @id_1)

 GO
alter procedure [CptDepreMethod2_SByDepreID] (@depreid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CptDepreMethod2] WHERE  [depreid]	 = @depreid order by  [time] set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [CptCapitalState_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from CptCapitalState where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

 GO
alter procedure [CptCapitalState_Select] @flag integer output , @msg varchar(4000) output  AS select * from CptCapitalState set  @flag = 0 set  @msg = '操作成功完成'

 GO
alter procedure [CptCapitalState_Insert] ( @name_2 	varchar(4000), @description_3 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [CptCapitalState] ( [name], [description])  VALUES ( @name_2, @description_3)

 GO
alter procedure [CptCapitalState_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [CptCapitalState]  WHERE ( [id]	 = @id_1)

 GO
alter procedure [CptCapitalGroup_Update] (@id 	[int], @name 	varchar(4000), @description 	varchar(4000), @parentid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CptCapitalGroup] SET  [name]	 = @name, [description]	 = @description, [parentid]	 = @parentid WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [CptCapitalGroup_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CptCapitalGroup] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [CptCapitalGroup_SelectAllInfo] ( @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CptCapitalGroup]  set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [CptCapitalGroup_SelectAll] (@parentid	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CptCapitalGroup] WHERE ([parentid] = @parentid) set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [CptCapitalGroup_Insert] (@name 	varchar(4000), @description 	varchar(4000), @parentid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [CptCapitalGroup] ( [name], [description], [parentid]) VALUES ( @name, @description, @parentid) set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [CptCapitalGroup_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS declare @count int select @count=count(*) from  CptCapitalGroup where parentid = @id if @count<>0 begin select -1 end else begin DELETE [CptCapitalGroup] WHERE ( [id] = @id) set @flag = 1 set @msg = 'OK!' end

 GO
alter procedure [CptCapitalShareInfo_SelectbyID] (@id int , @flag integer output , @msg varchar(4000) output ) AS select * from CptCapitalShareInfo where (id = @id ) set  @flag = 1 set  @msg = 'ok'

  GO
alter procedure [CptCapitalShareInfo_SbyRelated] (@relateditemid int , @flag integer output , @msg varchar(4000) output ) AS select * from CptCapitalShareInfo where ( relateditemid = @relateditemid ) order by sharetype set  @flag = 1 set  @msg = 'ok'

GO
alter procedure [CptCapitalShareInfo_Insert] (@relateditemid_1 [int], @sharetype_2 [tinyint], @seclevel_3 [tinyint], @rolelevel_4 [tinyint], @sharelevel_5 [tinyint], @userid_6 [int], @departmentid_7 [int], @roleid_8 [int], @foralluser_9 [tinyint],@subcompanyid_10 [int], @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [CptCapitalShareInfo] ( [relateditemid], [sharetype], [seclevel], [rolelevel], [sharelevel], [userid], [departmentid], [roleid], [foralluser],[subcompanyid])  VALUES ( @relateditemid_1, @sharetype_2, @seclevel_3, @rolelevel_4, @sharelevel_5, @userid_6, @departmentid_7, @roleid_8, @foralluser_9,@subcompanyid_10)  select max(id)  id from CptCapitalShareInfo

 GO
alter procedure [CptCapitalShareInfo_Delete] (@id_1 [int], @flag integer output, @msg varchar(4000) output)  AS DELETE [CptCapitalShareInfo]  WHERE ( [id] = @id_1)

GO
alter procedure [CptCapitalModifyField_SAll] ( @flag integer output, @msg varchar(4000) output)  AS select * from CptCapitalModifyField order by field

GO
alter procedure [CptCapitalAssortment_Update] (@id_1 	[int], @assortmentname_3 	varchar(4000), @assortmentmark	varchar(4000), @assortmentremark_7 	[text], @supassortmentid_8 	[int], @supassortmentstr_9 	varchar(4000), @flag integer output, @msg varchar(4000) output ) AS UPDATE [CptCapitalAssortment] SET [assortmentname]	 = @assortmentname_3, [assortmentmark] = @assortmentmark, [assortmentremark]	 = @assortmentremark_7, [supassortmentid]	 = @supassortmentid_8, [supassortmentstr]	 = @supassortmentstr_9 WHERE ( [id]	 = @id_1)

 GO
alter procedure [CptCapitalAssortment_SSupAssor] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS select supassortmentstr from  CptCapitalAssortment  where id = @id_1

  GO
alter procedure [CptCapitalAssortment_SRoot] @flag integer output , @msg varchar(4000) output AS select * from CptCapitalAssortment where supassortmentid = 0

 GO
alter procedure [CptCapitalAssortment_SLeaf] @flag integer output , @msg varchar(4000) output AS select * from CptCapitalAssortment where subassortmentcount = 0

 GO
alter procedure [CptCapitalAssortment_SelectAll] ( @flag integer output , @msg varchar(4000) output) AS select * from CptCapitalAssortment

GO
alter procedure [cpt_detailselectitem_insert_new] ( @fieldid INT , @isbill INT , @selectvalue INT , @selectname varchar(4000) , @listorder NUMERIC(10, 2) , @isdefault CHAR(1) , @cancel2 varchar(4000), @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT ) AS INSERT  INTO cpt_detailselectitem ( fieldid , isbill , selectvalue , selectname , listorder , isdefault,cancel ) VALUES  ( @fieldid , @isbill , @selectvalue , @selectname , @listorder , @isdefault,@cancel2 )

GO
alter procedure [cowork_log_insert] (@coworkid_1 	int, @type_2 	int, @modifydate_3 	char(10), @modifytime_4 	char(8), @modifier_5 	int, @clientip_6  char(15), @flag integer output , @msg varchar(4000) output)  AS INSERT INTO cowork_log ( coworkid, type, modifydate, modifytime, modifier, clientip)  VALUES ( @coworkid_1, @type_2, @modifydate_3, @modifytime_4, @modifier_5, @clientip_6)

GO
alter procedure [cowork_types_update] (@id_1 	[int], @typename_2 	varchar(4000), @departmentid_3 	[int], @managerid_4 	[text], @members_5 	[text], @flag integer output , @msg varchar(4000) output)  AS UPDATE [cowork_types]  SET  [typename]	 = @typename_2, [departmentid]	 = @departmentid_3, [managerid]	 = @managerid_4, [members]	 = @members_5  WHERE ( [id]	 = @id_1)

GO
alter procedure [cowork_types_insert] (@typename_1 	varchar(4000), @departmentid_2 	[int], @managerid_3 	[text], @members_4 	[text], @flag integer output , @msg varchar(4000) output  )  AS INSERT INTO [cowork_types] ( [typename], [departmentid], [managerid], [members])  VALUES ( @typename_1, @departmentid_2, @managerid_3, @members_4)

GO
alter procedure [cowork_types_delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS DELETE [cowork_types]  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptRequireDetail_Update] (@id_1 	[int], @cpttype 	[int], @cptid_1 	[int], @number_2 	[decimal](10,3), @unitprice_3 	[decimal](10,3), @needdate_5 	varchar(4000), @purpose_6 	varchar(4000), @cptdesc_7 	varchar(4000), @buynumber 	[decimal](10,3), @adjustnumber 	[decimal](10,3), @fetchnumber 	[decimal](10,3), @flag integer output , @msg varchar(4000) output)  AS UPDATE  [bill_CptRequireDetail]  SET [cpttype]	 = @cpttype, [cptid]	 = @cptid_1, [number_n]	 = @number_2, [unitprice]	 = @unitprice_3, [needdate]	 = @needdate_5, [purpose]	 = @purpose_6, [cptdesc]	 = @cptdesc_7 , [buynumber]	 = @buynumber , [adjustnumber]	 = @adjustnumber , [fetchnumber]	 = @fetchnumber  WHERE ( [id]	 = @id_1)

GO
alter procedure [T_outrepmodule_Update] (@id_1 	int, @modulename_2 	varchar(4000), @moduledesc_3 	varchar(4000), @moduleenname_4 varchar(4000), @flag	int	output, @msg	varchar(4000)	output)  AS UPDATE outrepmodule  SET  modulename	 = @modulename_2, moduledesc	 = @moduledesc_3, moduleenname	 = @moduleenname_4 WHERE ( id	 = @id_1)

GO
alter procedure [T_outrepmodule_Insert] (@outrepid_1 int, @modulename_2 varchar(4000), @moduledesc_3 varchar(4000), @userid_4 int, @usertype_5 int, @moduleenname_6 varchar(4000), @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO outrepmodule ( outrepid, modulename, moduledesc, userid, usertype, moduleenname)  VALUES (@outrepid_1, @modulename_2, @moduledesc_3, @userid_4, @usertype_5, @moduleenname_6) select max(id) from outrepmodule

GO
alter procedure [T_outrepmodule_Delete] (@id_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS DELETE outrepmodule  WHERE ( id	 = @id_1)

GO
alter procedure [T_OutRC_SelectByOutrepid]( @outrepid int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_OutReportCondition where outrepid = @outrepid

GO
alter procedure [T_modulecondition_Insert] ( @moduleid_1       int , @conditionid_2    int, @conditionname_3   varchar(4000), @isuserdefine_4     int, @conditionvalue_5 varchar(4000), @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO modulecondition (moduleid, conditionid, conditionname , isuserdefine, conditionvalue )VALUES( @moduleid_1, @conditionid_2, @conditionname_3 , @isuserdefine_4, @conditionvalue_5)

GO
alter procedure [T_modulecondition_Delete] (@id_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS DELETE modulecondition  WHERE ( moduleid	 = @id_1)

GO
alter procedure [T_IRItemtype_SelectByInprepid]( @inprepid_1  int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_InputReportItemtype where inprepid = @inprepid_1 order by dsporder

GO
alter procedure [T_IRItemDetail_SelectByItemid]( @itemid_1  int, @flag	int	output, @msg	varchar(4000)	output) AS select * from T_InputReportItemDetail where itemid = @itemid_1

GO
alter procedure [T_IRItem_SelectByItemtypeid]( @itemtypeid_1  int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_InputReportItem where itemtypeid = @itemtypeid_1 order by dsporder

GO
alter procedure [T_IRItem_SelectByInprepid]( @inprepid_1  int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_InputReportItem where inprepid = @inprepid_1 order by dsporder

GO
alter procedure [T_IRIT_SelectByItemtypeid]( @itemtypeid_1  int , @flag	int	output, @msg	varchar(4000)	output)  AS select * from T_InputReportItemtype where itemtypeid = @itemtypeid_1

GO
alter procedure [T_IReportItem_SelectByItemid] ( @itemid_1  int , @flag	int	output, @msg	varchar(4000)	output ) AS select * from T_InputReportItem where itemid = @itemid_1

GO
alter procedure [T_IReportCrm_SelectByInprepid]( @inprepid_1  int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_InputReportCrm where inprepid = @inprepid_1

GO
alter procedure [T_IReport_SelectByContacterid]( @contacter_1  int , @currentdate_2 char(10) , @flag	int	output, @msg	varchar(4000)	output) AS select a.inprepid, a.inprepname from T_InputReport a, T_InputReportCrm b , T_InputReportCrmContacter c where a.inprepid = b.inprepid and b.inprepcrmid = c.inprepcrmid and c.contacterid = @contacter_1 and (a.startdate = '' or a.startdate is null or a.startdate <= @currentdate_2 ) and (a.enddate = '' or a.enddate is null or a.enddate >= @currentdate_2 )

GO
alter procedure [T_IRConfirm_SelectByUserid]( @confirmuserid_1  int , @flag	int	output, @msg	varchar(4000)	output) AS select b.confirmid ,b.inputid ,a.inprepname ,b.inprepdspdate, b.inprepbudget , b.crmid ,b.thetable from T_InputReport a, T_InputReportConfirm b where a.inprepid = b.inprepid and b.confirmuserid = @confirmuserid_1

GO
alter procedure [T_IRConfirm_SelectByConfirmid]( @confirmid_1  int , @flag	int	output, @msg	varchar(4000)	output) AS select b.* , a.inprepname from T_InputReport a,  T_InputReportConfirm b where a.inprepid = b.inprepid and confirmid = @confirmid_1

GO
alter procedure [T_InputReportItemtype_Update] ( @itemtypeid_1 	int, @itemtypename_2 	varchar(4000), @itemtypedesc_3 	varchar(4000), @dsporder_4 	decimal(15,2) , @flag	int	output, @msg	varchar(4000)	output) AS UPDATE T_InputReportItemtype SET itemtypename	 = @itemtypename_2, itemtypedesc	 = @itemtypedesc_3 , dsporder	 = @dsporder_4 WHERE ( itemtypeid	 = @itemtypeid_1)

  GO
alter procedure  [T_fieldItem_Update] (@itemid_1 	 int , @inprepid_2   int , @itemdspname_3   varchar(4000) , @itemfieldname_4   varchar(4000)   , @itemfieldtype_5   char  (1)  , @itemfieldscale_6   int   , @itemfieldunit_7 varchar(4000)  , @flag	 int 	output, @msg	 varchar(4000)	output)  AS UPDATE  T_fieldItem SET       inprepid = @inprepid_2 , itemdspname  = @itemdspname_3 , itemfieldname = @itemfieldname_4 , itemfieldtype = @itemfieldtype_5 , itemfieldscale = @itemfieldscale_6 , itemfieldunit  = @itemfieldunit_7 WHERE (  itemid = @itemid_1)

  GO
alter procedure [T_fieldItem_SelectByItemtypeid] (@inprepid_1  int , @flag	 int 	output, @msg	 varchar(4000)	output)  AS select * from T_fieldItem where inprepid = @inprepid_1 order by itemid

  GO
alter procedure [T_fieldItem_SelectByItemid] (@itemid_1  int , @flag	 int 	output, @msg	 varchar(4000)	output)  AS select * from T_fieldItem where itemid = @itemid_1

  GO
alter procedure [T_fieldItem_SelectByInprepid] (@inprepid_1  int , @flag	 int 	output, @msg	 varchar(4000)	output)  AS select * from T_fieldItem where inprepid = @inprepid_1

  GO
alter procedure  [T_fieldItem_Insert] (@inprepid_2   int , @itemdspname_3   varchar(4000) , @itemfieldname_4   varchar(4000)   , @itemfieldtype_5   char  (1)  , @itemfieldscale_6   int   , @itemfieldunit_7  varchar(4000)  , @flag	 int 	output, @msg	 varchar(4000)	output)  AS INSERT INTO  T_fieldItem ( inprepid , itemdspname , itemfieldname , itemfieldtype , itemfieldscale , itemfieldunit )  VALUES (@inprepid_2, @itemdspname_3, @itemfieldname_4, @itemfieldtype_5, @itemfieldscale_6, @itemfieldunit_7 )

  GO
alter procedure  [T_fieldItem_Delete] (@itemid_1 	 int  , @flag	 int 	output, @msg	 varchar(4000)	output)  AS DELETE T_fieldItem WHERE (  itemid 	 = @itemid_1)

GO
alter procedure [T_CT_SelectByConditionid]( @conditionid_1  int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_Condition where conditionid = @conditionid_1

GO
alter procedure [SystemDMSet_Update] ( @detachable_1 char(1) , @dftsubcomid_2 int , @hrmdetachable_3 char(1) , @hrmdftsubcomid_4 int , @wfdetachable_5 char(1) , @wfdftsubcomid_6 int , @docdetachable_7 char(1) , @docdftsubcomid_8 int , @portaldetachable_9 char(1) , @portaldftsubcomid_10 int , @cptdetachable_11 char(1) , @cptdftsubcomid_12 int , @mtidetachable_13 char(1) , @mtidftsubcomid_14 int , @flag int output , @msg varchar(4000) output ) AS update SystemSet set detachable=@detachable_1 , dftsubcomid=@dftsubcomid_2, hrmdetachable=@hrmdetachable_3, hrmdftsubcomid=@hrmdftsubcomid_4, wfdetachable=@wfdetachable_5, wfdftsubcomid=@wfdftsubcomid_6, docdetachable=@docdetachable_7, docdftsubcomid=@docdftsubcomid_8, portaldetachable=@portaldetachable_9, portaldftsubcomid=@portaldftsubcomid_10, cptdetachable=@cptdetachable_11, cptdftsubcomid=@cptdftsubcomid_12, mtidetachable=@mtidetachable_13, mtidftsubcomid=@mtidftsubcomid_14

GO
alter procedure [T_ConditionDetail_Insert] (@conditionid_1 	int, @conditiondsp_2 	varchar(4000), @conditionvalue_3 	varchar(4000) , @conditionendsp_4 	varchar(4000), @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO T_ConditionDetail ( conditionid, conditiondsp, conditionvalue, conditionendsp)  VALUES ( @conditionid_1, @conditiondsp_2, @conditionvalue_3, @conditionendsp_4)

GO
alter procedure [T_ConditionDetail_Delete] (@conditionid_1 	int , @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_ConditionDetail  WHERE ( conditionid	 = @conditionid_1)

GO
alter procedure [SystemLogItem_Update] (@itemid_1 	varchar(4000), @lableid_2 	[int], @itemdesc_3 	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output )  AS UPDATE [SystemLogItem]  SET  	 [lableid]	 = @lableid_2, [itemdesc]	 = @itemdesc_3  WHERE ( [itemid]	 = @itemid_1 )

GO
alter procedure [SystemLogItem_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from SystemLogItem where itemid = @id set  @flag = 0 set  @msg = '查询日志项目信息成功'

GO
alter procedure [SystemLogItem_Select] @itemdesc varchar(4000) , @flag integer output , @msg varchar(4000) output AS select itemid, itemdesc from SystemLogItem where itemdesc like @itemdesc order by convert(int,itemid) set  @flag = 0 set  @msg = '查询日志项目信息成功'

GO
alter procedure [SystemLogItem_Insert] (@itemid_1 	varchar(4000), @lableid_2 	[int], @itemdesc_3 	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output )  AS INSERT INTO [SystemLogItem] ( [itemid], [lableid], [itemdesc])  VALUES ( @itemid_1, @lableid_2, @itemdesc_3)

GO
alter procedure [SystemLogItem_Delete] (@itemid_1 	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output )  AS DELETE [SystemLogItem]  WHERE ( [itemid]	 = @itemid_1)

GO
alter procedure [SystemLog_Insert] (@createdate_1 	[char](10), @createtime_2 	[char](7), @classname  varchar(4000) , @sqlstr_3 	[text], @flag int output, @msg varchar(4000) output)  AS INSERT INTO [SystemLog] ( [createdate], [createtime], classname, [sqlstr])  VALUES ( @createdate_1, @createtime_2, @classname , @sqlstr_3)

GO
alter procedure [SystemLog_Delete] (@createdate_1 	[char](10), @flag int output, @msg varchar(4000) output)  AS delete SystemLog where createdate <= @createdate_1

GO
alter procedure [sap_outStructure_Insert] ( @baseid_1  int, @nameid_2    varchar(4000), @sapfield_3   varchar(4000), @showname_4    varchar(4000), @Display_5  varchar(4000), @Search_6  varchar(4000), @ordernum_7  varchar(4000), @orderGroupnum_8   varchar(4000), @oafield_9      varchar(4000), @ismainfield_10 	varchar(4000), @fromfieldid_11 varchar(4000), @isbill_12   varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output ) as declare   @maxid_ varchar(4000); begin  insert into sap_outStructure (baseid,nameid,sapfield,showname,Display,Search,ordernum,orderGroupnum,oafield,ismainfield,fromfieldid,isbill) values (@baseid_1,@nameid_2,@sapfield_3,@showname_4,@Display_5,@Search_6,@ordernum_7,@orderGroupnum_8,@oafield_9,@ismainfield_10,@fromfieldid_11,@isbill_12);  select @maxid_=MAX(id)  from sap_outStructure; select @maxid_ end;

GO
alter procedure [sap_outparaprocess_Insert] ( @baseid_1  int, @nameid_2   varchar(4000), @sapfield_3    varchar(4000), @oafield_4    varchar(4000), @constant_5  varchar(4000), @ordernum_6  varchar(4000), @ismainfield_7  varchar(4000), @fromfieldid_8  varchar(4000), @isbill_9       varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output ) as declare   @maxid_ varchar(4000); begin  insert into sap_outparaprocess (baseid,nameid,sapfield,oafield,constant,ordernum,ismainfield,fromfieldid,isbill) values (@baseid_1,@nameid_2,@sapfield_3,@oafield_4,@constant_5,@ordernum_6,@ismainfield_7,@fromfieldid_8,@isbill_9);  select @maxid_=MAX(id)   from sap_outparaprocess; select @maxid_ end;

GO
alter procedure [T_Condition_Update] (@conditionid_1 	int, @conditionname_2 	varchar(4000), @conditiondesc_3 	varchar(4000), @conditionitemfieldname_4 	varchar(4000), @conditiontype_5 	char(1) , @flag	int	output, @msg	varchar(4000)	output)  AS UPDATE T_Condition  SET  conditionname	 = @conditionname_2, conditiondesc	 = @conditiondesc_3, conditionitemfieldname	 = @conditionitemfieldname_4, conditiontype	 = @conditiontype_5  WHERE ( conditionid	 = @conditionid_1)

GO
alter procedure [T_Condition_SelectAll] (@flag	int	output, @msg	varchar(4000)	output)  AS select * from T_Condition

GO
alter procedure [T_Condition_Insert] (@conditionname_1 	varchar(4000), @conditiondesc_2 	varchar(4000), @conditionitemfieldname_3 	varchar(4000), @conditiontype_4 	char(1) , @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO T_Condition ( conditionname, conditiondesc, conditionitemfieldname, conditiontype)  VALUES ( @conditionname_1, @conditiondesc_2, @conditionitemfieldname_3, @conditiontype_4)

GO
alter procedure [T_Condition_Delete] (@conditionid_1 	int , @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_Condition  WHERE ( conditionid	 = @conditionid_1)

GO
alter procedure [SystemRightToGroup_Insert] (@groupid_1 	[int], @rightid_2 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @count integer select @count = count(id) from SystemRightToGroup where groupid = @groupid_1 and rightid = @rightid_2 if @count = 0 begin INSERT INTO [SystemRightToGroup] ( [groupid], [rightid])  VALUES ( @groupid_1, @rightid_2) end

GO
alter procedure [SystemRightToGroup_Delete] (@groupid_1 	[int], @rightid_2 	[int], @flag integer output , @msg varchar(4000) output)  AS DELETE [SystemRightToGroup]  WHERE ( [groupid]	 = @groupid_1) and ( [rightid]	 = @rightid_2)

GO
alter procedure [T_CDetail_SelectByConditionid]( @conditionid_1  int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_ConditionDetail where conditionid = @conditionid_1

GO
alter procedure [SystemSet_Update]( @emailserver_1  varchar(4000) , @debugmode_2   char(1) , @logleaveday_3  tinyint , @defmailuser_4  varchar(4000) , @defmailpassword_5  varchar(4000) , @pop3server_6  varchar(4000) , @filesystem_7 varchar(4000) , @filesystembackup_8 varchar(4000) , @filesystembackuptime_9 int , @needzip_10 char(1) , @needzipencrypt_11 char(1) , @defmailserver_12 varchar(4000) , @defmailfrom_13 varchar(4000) , @defneedauth_14 char(1) , @smsserver_15 varchar(4000) , @licenseRemind_17 char(1) , @remindUsers_18 varchar(4000) , @remindDays_19 varchar(4000) , @emailfilesize_20 int , @flag int output , @msg varchar(4000) output) AS update SystemSet set emailserver=@emailserver_1 , debugmode=@debugmode_2, logleaveday=@logleaveday_3 , defmailuser=@defmailuser_4 , defmailpassword=@defmailpassword_5 , pop3server=@pop3server_6 , filesystem=@filesystem_7, filesystembackup=@filesystembackup_8 , filesystembackuptime=@filesystembackuptime_9 , needzip=@needzip_10 , needzipencrypt=@needzipencrypt_11 , defmailserver=@defmailserver_12 , defmailfrom=@defmailfrom_13 , defneedauth=@defneedauth_14 , smsserver=@smsserver_15 , licenseRemind=@licenseRemind_17 , remindUsers=@remindUsers_18 , remindDays=@remindDays_19 , emailfilesize=@emailfilesize_20

GO
alter procedure [SystemSet_Select] (@flag int output, @msg varchar(4000) output) AS select * from SystemSet

GO
alter procedure [SysRemindInfo_IPasstimeNode] @userid		int, @usertype	int, @haspasstimenode int, @flag integer output , @msg varchar(4000) output as declare @tmpid integer select @tmpid = userid from SysPopRemindInfo where userid = @userid and usertype = @usertype if @tmpid is null begin insert into SysPopRemindInfo(userid,usertype,haspasstimenode) values(@userid,@usertype,@haspasstimenode) end else begin update SysPopRemindInfo set haspasstimenode = @haspasstimenode where userid = @userid and usertype = @usertype end

GO
alter procedure [SysRemindInfo_InserHasnewwf] @userid		int, @usertype	int, @requestid	int, @flag integer output , @msg varchar(4000) output as declare @tmpid integer declare @tmp varchar(4000) select @tmpid = userid,@tmp=convert(varchar,hasnewwf) from SysRemindInfo where userid = @userid and usertype = @usertype if @tmpid is null begin insert into SysRemindInfo(userid,usertype,hasnewwf) values(@userid,@usertype,convert(varchar,@requestid)) end else begin if @tmp = '' or @tmp is null begin update SysRemindInfo set hasnewwf = convert(varchar,@requestid) where userid = @userid and usertype = @usertype end else if CHARINDEX(','+convert(varchar,@requestid)+',',','+@tmp+',')=0 begin update SysRemindInfo set hasnewwf = convert(varchar,hasnewwf)+','+convert(varchar,@requestid) where userid = @userid and usertype = @usertype end end  set @tmpid = null set @tmp = null  select @tmpid = userid,@tmp=convert(varchar,hasnewwf) from SysPopRemindInfo where userid = @userid and usertype = @usertype if @tmpid is null begin insert into SysPopRemindInfo(userid,usertype,hasnewwf) values(@userid,@usertype,convert(varchar,@requestid)) end else begin if @tmp = '' or @tmp is null begin update SysPopRemindInfo set hasnewwf = convert(varchar,@requestid) where userid = @userid and usertype = @usertype end else if CHARINDEX(','+convert(varchar,@requestid)+',',','+@tmp+',')=0 begin update SysPopRemindInfo set hasnewwf = convert(varchar,hasnewwf)+','+convert(varchar,@requestid) where userid = @userid and usertype = @usertype end end

GO
alter procedure [SysRemindInfo_InserHasendwf] @userid		int, @usertype	int, @requestid	int, @flag integer output , @msg varchar(4000) output as declare @tmpid integer declare @tmp varchar(4000) select @tmpid = userid,@tmp=convert(varchar,hasendwf) from SysRemindInfo where userid = @userid and usertype = @usertype if @tmpid is null begin insert into SysRemindInfo(userid,usertype,hasendwf) values(@userid,@usertype,convert(varchar,@requestid)) end else begin if @tmp = '' or @tmp is null begin update SysRemindInfo set hasendwf = convert(varchar,@requestid) where userid = @userid and usertype = @usertype end else if CHARINDEX(','+convert(varchar,@requestid)+',',','+@tmp+',')=0 begin update SysRemindInfo set hasendwf = convert(varchar,hasendwf)+','+convert(varchar,@requestid) where userid = @userid and usertype = @usertype end end  set @tmpid = null set @tmp = null  select @tmpid = userid,@tmp=convert(varchar,hasendwf) from SysPopRemindInfo where userid = @userid and usertype = @usertype if @tmpid is null begin insert into SysPopRemindInfo(userid,usertype,hasendwf) values(@userid,@usertype,convert(varchar,@requestid)) end else begin if @tmp = '' or @tmp is null begin update SysPopRemindInfo set hasendwf = convert(varchar,@requestid) where userid = @userid and usertype = @usertype end else if CHARINDEX(','+convert(varchar,@requestid)+',',','+@tmp+',')=0 begin update SysPopRemindInfo set hasendwf = convert(varchar,hasendwf)+','+convert(varchar,@requestid) where userid = @userid and usertype = @usertype end end

GO
alter procedure [SysRemindInfo_InserDealwf] @userid		int, @usertype	int, @hasdealwf int, @flag integer output , @msg varchar(4000) output as declare @tmpid integer select @tmpid = userid from SysRemindInfo where userid = @userid and usertype = @usertype if @tmpid is null begin insert into SysRemindInfo(userid,usertype,hasdealwf) values(@userid,@usertype,@hasdealwf) end else begin update SysRemindInfo set hasdealwf = @hasdealwf where userid = @userid and usertype = @usertype end

GO
alter procedure [SysRemindInfo_InserCrmcontact] @userid		int, @usertype	int, @hascrmcontact int, @flag integer output , @msg varchar(4000) output as declare @tmpid integer select @tmpid = userid from SysPopRemindInfo where userid = @userid and usertype = @usertype if @tmpid is null begin insert into SysPopRemindInfo(userid,usertype,hascrmcontact) values(@userid,@usertype,@hascrmcontact) end else begin update SysPopRemindInfo set hascrmcontact = @hascrmcontact where userid = @userid and usertype = @usertype end

GO
alter procedure [SysRemindInfo_DeleteHasnewwf] @userid		int, @usertype	int, @requestid	int, @flag integer output , @msg varchar(4000) output as declare @tmp varchar(4000)  select @tmp = convert(varchar,hasnewwf) from SysRemindInfo where userid = @userid and usertype = @usertype if @tmp is not null begin set  @tmp = Replace(','+@tmp+',',','+convert(varchar,@requestid)+',',',') if LEN(@tmp) < 2 begin set  @tmp = '' end else begin set  @tmp = SUBSTRING(@tmp,2,LEN(@tmp)-2) end update SysRemindInfo set hasnewwf = @tmp where userid = @userid and usertype = @usertype end  set @tmp = null  select @tmp = convert(varchar,hasnewwf) from SysPopRemindInfo where userid = @userid and usertype = @usertype if @tmp is not null begin set  @tmp = Replace(','+@tmp+',',','+convert(varchar,@requestid)+',',',') if LEN(@tmp) < 2 begin set  @tmp = '' end else begin set  @tmp = SUBSTRING(@tmp,2,LEN(@tmp)-2) end update SysPopRemindInfo set hasnewwf = @tmp where userid = @userid and usertype = @usertype end

GO
alter procedure [SysRemindInfo_DeleteHasendwf] @userid		int, @usertype	int, @requestid	int, @flag integer output , @msg varchar(4000) output as declare @tmp varchar(4000)  select @tmp = convert(varchar,hasendwf) from SysRemindInfo where userid = @userid and usertype = @usertype if @tmp is not null and @tmp <> '' begin set  @tmp = Replace(','+@tmp+',',','+convert(varchar,@requestid)+',',',') if LEN(@tmp) < 2 begin set  @tmp = '' end else begin set  @tmp = SUBSTRING(@tmp,2,LEN(@tmp)-2) end update SysRemindInfo set hasendwf = @tmp where userid = @userid and usertype = @usertype end  set @tmp = null  select @tmp = convert(varchar,hasendwf) from SysPopRemindInfo where userid = @userid and usertype = @usertype if @tmp is not null and @tmp <> '' begin set  @tmp = Replace(','+@tmp+',',','+convert(varchar,@requestid)+',',',') if LEN(@tmp) < 2 begin set  @tmp = '' end else begin set  @tmp = SUBSTRING(@tmp,2,LEN(@tmp)-2) end update SysPopRemindInfo set hasendwf = @tmp where userid = @userid and usertype = @usertype end

GO
alter procedure [SequenceIndex_SelectSmsid] (@flag int output, @msg varchar(4000) output)  AS select currentid from SequenceIndex where indexdesc='smsid' update SequenceIndex set currentid = currentid+1 where indexdesc='smsid'

GO
alter procedure [SequenceIndex_SelectNextID] (@indexdesc_1 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS declare @currentid_1 integer select @currentid_1 = currentid from SequenceIndex where indexdesc = @indexdesc_1 update SequenceIndex set currentid = currentid+1 where indexdesc= @indexdesc_1 select @currentid_1

GO
alter procedure [SequenceIndex_SelectFileid] (@flag int output, @msg varchar(4000) output)  AS select currentid from SequenceIndex where indexdesc='imagefileid' update SequenceIndex set currentid = currentid+1 where indexdesc='imagefileid'

GO
alter procedure [SequenceIndex_SelectDocImageId] (@flag int output, @msg varchar(4000) output)  AS select currentid from SequenceIndex where indexdesc='docimageid' update SequenceIndex set currentid = currentid+1 where indexdesc='docimageid'

GO
alter procedure [SelectSysFavourite_Insert] @sysfavouriteid int, @adddate varchar(4000), @flag integer output, @msg varchar(4000) output AS insert into sysfavourite (resourceid, adddate, pagename, url, importlevel,favouritetype) select resourceid, @adddate, pagename, url, importlevel,favouritetype from sysfavourite where id = @sysfavouriteid select @@IDENTITY from sysfavourite

GO
alter procedure  [sap_outTable_Insert] ( @baseid_1  int, @nameid_2    varchar(4000), @sapfield_3   varchar(4000), @showname_4    varchar(4000), @Display_5  varchar(4000), @Search_6  varchar(4000), @Primarykey_7 varchar(4000), @ordernum_8  varchar(4000), @orderGroupnum_9 varchar(4000), @oafield_10   varchar(4000), @ismainfield_11 varchar(4000), @fromfieldid_12 varchar(4000), @isbill_13     varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output ) as declare   @maxid_ varchar(4000); begin  insert into sap_outTable (baseid,nameid,sapfield,showname,Display,Search,Primarykey,ordernum,orderGroupnum,oafield,ismainfield,fromfieldid,isbill) values (@baseid_1,@nameid_2,@sapfield_3,@showname_4,@Display_5,@Search_6,@Primarykey_7,@ordernum_8,@orderGroupnum_9,@oafield_10,@ismainfield_11,@fromfieldid_12,@isbill_13);  select @maxid_=MAX(id)   from sap_outTable; select @maxid_ end;

GO
alter procedure [sap_outParameter_Insert] ( @baseid_1  int, @sapfield_2   varchar(4000), @showname_3   varchar(4000), @Display_4    varchar(4000), @ordernum_5  varchar(4000), @oafield_6  varchar(4000), @ismainfield_7  varchar(4000), @fromfieldid_8   varchar(4000), @isbill_9   varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output ) as declare  @maxid_ varchar(4000); begin  insert into sap_outParameter (baseid,sapfield,showname,Display,ordernum,oafield,ismainfield,fromfieldid,isbill) values (@baseid_1,@sapfield_2,@showname_3,@Display_4,@ordernum_5,@oafield_6,@ismainfield_7,@fromfieldid_8,@isbill_9);  select @maxid_=MAX(id)  from sap_outParameter; select @maxid_ end;

GO
alter procedure [sap_inTable_Insert] ( @baseid_1  int, @nameid_2    varchar(4000), @sapfield_3    varchar(4000), @oafield_4	    varchar(4000), @constant_5    varchar(4000), @ordernum_6  varchar(4000), @orderGroupnum_7  varchar(4000), @ismainfield_8  varchar(4000), @fromfieldid_9  varchar(4000), @isbill_10    varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output ) as declare  @maxid_ varchar(4000); begin  insert into sap_inTable (baseid,nameid,sapfield,oafield,constant,ordernum,orderGroupnum,ismainfield,fromfieldid,isbill) values (@baseid_1,@nameid_2,@sapfield_3,@oafield_4,@constant_5,@ordernum_6,@orderGroupnum_7,@ismainfield_8,@fromfieldid_9,@isbill_10);  select @maxid_ =MAX(id)   from sap_inTable; select @maxid_ end;

GO
alter procedure [sap_inStructure_Insert] ( @baseid_1  int, @nameid_2    varchar(4000), @sapfield_3    varchar(4000), @oafield_4	    varchar(4000), @constant_5    varchar(4000), @ordernum_6  varchar(4000), @orderGroupnum_7  varchar(4000), @ismainfield_8  varchar(4000), @fromfieldid_9  varchar(4000), @isbill_10          varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output ) as declare   @maxid_ varchar(4000); begin  insert into sap_inStructure (baseid,nameid,sapfield,oafield,constant,ordernum,orderGroupnum,ismainfield,fromfieldid,isbill) values (@baseid_1,@nameid_2,@sapfield_3,@oafield_4,@constant_5,@ordernum_6,@orderGroupnum_7,@ismainfield_8,@fromfieldid_9,@isbill_10);  select @maxid_=MAX(id) from sap_inStructure; select @maxid_ end;

GO
alter procedure [sap_inParameter_Insert] ( @baseid_1   int, @sapfield_2 varchar(4000), @oafield_3  varchar(4000), @constant_4 varchar(4000), @ordernum_5 varchar(4000), @ismainfield_6  varchar(4000), @fromfieldid_7 varchar(4000), @isbill_8       varchar(4000), @flag 		integer 	output , @msg 		varchar(4000) 	output ) as declare  @maxid_ varchar(4000); begin  insert into sap_inParameter (baseid,sapfield,oafield,constant,ordernum,ismainfield,fromfieldid,isbill) values (@baseid_1,@sapfield_2,@oafield_3,@constant_4,@ordernum_5,@ismainfield_6,@fromfieldid_7,@isbill_8);  select @maxid_=MAX(id) from sap_inParameter; select @maxid_ end;

GO
alter procedure [sap_complexname_Insert] ( @baseid_1  int, @comtype_2    varchar(4000), @name_3        varchar(4000), @backtable_4 varchar(4000), @backoper_5  int, @flag 		integer 	output , @msg 		varchar(4000) 	output ) as declare  @maxid_ varchar(4000); begin  insert into sap_complexname (baseid,comtype,name,backtable,backoper) values (@baseid_1,@comtype_2,@name_3,@backtable_4,@backoper_5);  select @maxid_=MAX(id)  from sap_complexname; select @maxid_ end;

 GO
alter procedure [Sales_CRM_CreditInfo_Select] ( @creditAmount varchar(4000), @flag integer output , @msg varchar(4000) output) AS SELECT id FROM CRM_CreditInfo WHERE creditamount <= convert(money, @creditAmount) AND highamount >= convert(money, @creditAmount)

GO
alter procedure [Prj_TaskModifyLog_Insert] ( @ProjID_1	   INT , @TaskID_1	   INT , @Subject_1	   varchar(4000), @HrmID_1	   INT , @BeginDate_1  varchar(4000) , @EndDate_1	   varchar(4000) , @WorkDay_1	   DECIMAL  , @FixedCost_1  DECIMAL (18,2), @Finish_1	   TINYINT , @ParentID_1 INT, @Prefinish_1  varchar(4000)  , @IsLandMark_1 Char(1) , @ModifyDate_1 varchar(4000) , @ModifyTime_1 varchar(4000) , @ModifyBy_1   INT , @Status_1	   TINYINT , @OperationType_1	TINYINT, @ClientIP_1	Varchar(20), @realManDays decimal (6,1), @flag integer output, @msg varchar(4000) output  ) AS  INSERT INTO Prj_TaskModifyLog ( ProjID	   , TaskID	   , Subject	   , HrmID	   , BeginDate  , EndDate	   , WorkDay	   , FixedCost  , Finish	   , ParentID   , Prefinish  , IsLandMark , ModifyDate , ModifyTime , ModifyBy   , Status	   , OperationType	, ClientIP, realManDays ) VALUES( @ProjID_1	   , @TaskID_1	   , @Subject_1	   , @HrmID_1	   , @BeginDate_1       , @EndDate_1	   , @WorkDay_1	   , @FixedCost_1       , @Finish_1	   , @ParentID_1        , @Prefinish_1  , @IsLandMark_1 , @ModifyDate_1 , @ModifyTime_1 , @ModifyBy_1   , @Status_1	   , @OperationType_1	, @ClientIP_1, @realManDays )  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Request_Insert]( @prjid 		[int], @taskid 	[int], @requestid 	[int], @workflowid 	[int], @flag 		integer output, @msg 		varchar(4000) output )AS INSERT INTO [Prj_Request] (prjid, taskid, requestid, workflowid) VALUES (@prjid, @taskid, @requestid, @workflowid) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [RoleRightdetailInfo_Select] (@flag int output, @msg varchar(4000) output)  AS select roleid , rightdetail , rolelevel from SystemRightDetail, SystemRightRoles where SystemRightDetail.rightid = SystemRightRoles.rightid order by roleid

GO
alter procedure [ProcedureInfo_Update] (@id_1 	[int], @procedurename_2 	varchar(4000), @proceduretabel_3 	varchar(4000), @procedurescript_4 	[text], @proceduredesc_5 	[text], @flag                             integer output, @msg                             varchar(4000) output )  AS UPDATE [ProcedureInfo]  SET  [procedurename]	 = @procedurename_2, [proceduretabel]	 = @proceduretabel_3, [procedurescript]	 = @procedurescript_4, [proceduredesc]	 = @proceduredesc_5  WHERE ( [id]	 = @id_1)  if @@error<>0 begin set @flag=1 set @msg='	更新储存过程失败' return end else begin set @flag=0 set @msg='	更新储存过程成功' return end

GO
alter procedure [ProcedureInfo_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from ProcedureInfo where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [ProcedureInfo_Select] @procedurename varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from ProcedureInfo where procedurename like @procedurename set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [ProcedureInfo_Insert] (@procedurename_1 	varchar(4000), @proceduretabel_2 	varchar(4000), @procedurescript_3 	[text], @proceduredesc_4 	[text], @flag                             integer output, @msg                             varchar(4000) output ) AS INSERT INTO [ProcedureInfo] ( [procedurename], [proceduretabel], [procedurescript], [proceduredesc])  VALUES ( @procedurename_1, @proceduretabel_2, @procedurescript_3, @proceduredesc_4) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [VotingShare_SelectByVotingid] (@votingid    int, @flag integer output, @msg varchar(4000) output) AS select * from votingshare where votingid=@votingid

GO
alter procedure [VotingShare_SelectByID] (@id    int, @flag integer output, @msg varchar(4000) output) AS select * from votingshare where id=@id

GO
alter procedure [VotingShare_Insert] (@votingid    int, @sharetype     int, @resourceid      int, @subcompanyid  int, @departmentid  int, @roleid        int, @seclevel      int, @rolelevel     int, @foralluser    int, @flag integer output, @msg varchar(4000) output) AS insert into votingshare (votingid,sharetype,resourceid,subcompanyid,departmentid,roleid,seclevel,rolelevel,foralluser) values (@votingid,@sharetype,@resourceid,@subcompanyid,@departmentid,@roleid,@seclevel,@rolelevel,@foralluser) select max(id) from votingshare

GO
alter procedure [VotingShare_Delete] (@id    int, @flag integer output, @msg varchar(4000) output) AS delete from votingshare where id=@id

GO
alter procedure [VotingResourceRemark_Insert] (@votingid    int, @questionid    int, @resourceid int, @useranony     int, @otherinput    varchar(4000), @operatedate   char(10), @operatetime   char(8), @flag integer output, @msg varchar(4000) output) AS insert into votingresourceremark (votingid,questionid,resourceid,useranony,otherinput,operatedate,operatetime) values (@votingid,@questionid,@resourceid,@useranony,@otherinput,@operatedate,@operatetime)

GO
alter procedure [VotingResource_SelectByUser] (@votingid    int, @resourceid int, @flag integer output, @msg varchar(4000) output) AS select * from votingresource where votingid=@votingid and resourceid=@resourceid

GO
alter procedure [VotingResource_Insert] (@votingid    int, @questionid    int, @optionid   int, @resourceid int, @operatedate   char(10), @operatetime   char(8), @flag integer output, @msg varchar(4000) output) AS declare @count int select @count=count(votingid) from votingresource where optionid=@optionid and resourceid=@resourceid and votingid=@votingid if  @count=0 begin insert into votingresource (votingid,questionid,optionid,resourceid,operatedate,operatetime) values (@votingid,@questionid,@optionid,@resourceid,@operatedate,@operatetime) end

GO
alter procedure [VotingQuestion_UpdateCount] (@questionid    int, @flag integer output, @msg varchar(4000) output) AS update votingquestion set questioncount=questioncount+1 where id=@questionid

GO
alter procedure [test] (@periodsfrom  char(6) , @periodsto     char(6))  AS create table #templedgercount( ledgerid  int , precount  decimal(18,3), lastcount  decimal(18,3) ) declare @thelastperiods  char(6) ,@thenewperiods char(6), @ledgerid int , @precount decimal(18,3) , @lastcount decimal(18,3) select @thelastperiods = max(tranperiods) from FnaAccount where tranperiods < @periodsfrom if @thelastperiods = null  set @thelastperiods = '000000' select @thenewperiods = max(tranperiods) from FnaAccount if @thenewperiods < @periodsto  set @periodsto = @thenewperiods   declare ledgerid_cursor cursor for select id from FnaLedger where supledgerid =0 and ledgergroup ='1' open ledgerid_cursor fetch next from ledgerid_cursor into @ledgerid while @@fetch_status=0 begin set @precount = 0 set @lastcount = 0 select @precount = (-2*convert(int,tranbalance)+3)*tranremain  from FnaAccount where ledgerid = @ledgerid and tranperiods= @thelastperiods select @lastcount = (-2*convert(int,tranbalance)+3)*tranremain  from FnaAccount where ledgerid = @ledgerid and tranperiods= @periodsto  insert into #templedgercount values(@ledgerid,@precount,@lastcount) fetch next from ledgerid_cursor into @ledgerid end close ledgerid_cursor deallocate ledgerid_cursor select * from #templedgercount select @thelastperiods

GO
alter procedure [Task_Modify_Select] (@id 	int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM Task_Modify WHERE ( projectid	 = @id) ORDER BY modifydate DESC, modifytime DESC

GO
alter procedure [Task_Log_Select] (@id 	int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM Task_Log WHERE ( projectid	 = @id) ORDER BY submitdate DESC, submittime DESC

GO
alter procedure [T_DatacenterUser_Insert] (@crmid_1 	int, @contacterid_2 	int, @loginid_3 	varchar(4000), @password_4 	varchar(4000), @status_5 	char(1), @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO T_DatacenterUser ( crmid, contacterid, loginid, password, status)  VALUES ( @crmid_1, @contacterid_2, @loginid_3, @password_4, @status_5)

GO
alter procedure [T_DatacenterUser_Delete] (@flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_DatacenterUser

GO
alter procedure  [T_SurveyItem_Update] (@inprepid_1 	 int , @mailid_2 int, @inprepname_3 	 varchar(4000), @inpreptablename_4 	 varchar(4000), @urlname_5    varchar(4000), @flag	 int 	output, @msg	 varchar(4000)	output)  AS UPDATE  T_SurveyItem  SET mailid    =   @mailid_2 , inprepname 	 = @inprepname_3 , inpreptablename 	 = @inpreptablename_4, urlname    =    @urlname_5 WHERE (  inprepid 	 = @inprepid_1)

  GO
alter procedure [T_SurveyItem_SelectByInprepid] (@inprepid_1  int , @flag	 int 	output, @msg	 varchar(4000)	output)  AS select * from T_SurveyItem where inprepid = @inprepid_1

  GO
alter procedure [T_SurveyItem_SelectAll] (@flag	 int 	output, @msg	 varchar(4000)	output)  AS select * from T_SurveyItem

GO
alter procedure [T_SurveyItem_Insert] (@mailid_2 int , @inprepname_3	 varchar(4000), @inpreptablename_4 	 varchar(4000), @urlname_5    varchar(4000), @flag	 int 	output, @msg	 varchar(4000)	output)  AS INSERT INTO  T_SurveyItem (mailid, inprepname , inpreptablename, urlname)  VALUES (@mailid_2 , @inprepname_3 , @inpreptablename_4, @urlname_5)

  GO
alter procedure  [T_SurveyItem_Delete] (@inprepid_1 	 int , @flag	 int 	output, @msg	 varchar(4000)	output)  AS DELETE  T_SurveyItem  WHERE (  inprepid 	 = @inprepid_1)

    GO
alter procedure [T_FadeBespeak_Insert] (@crmid_2 int , @inprepid_3 int, @contacterid_4	 int , @inputid_5 int , @date_6 char(10), @flag	 int 	output, @msg	 varchar(4000)	output)  AS INSERT INTO  T_FadeBespeak (crmid, inprepid, contacterid , inputid , referdate) VALUES (@crmid_2 , @inprepid_3 , @contacterid_4 , @inputid_5 , @date_6 )

GO
alter procedure [T_Statitem_Update] (@statitemid_1 	int, @statitemname_2 	varchar(4000), @statitemexpress_3 	varchar(4000), @statitemdesc_4 	varchar(4000), @statitemenname_5 	varchar(4000), @flag	int	output, @msg	varchar(4000)	output)  AS UPDATE T_Statitem  SET  statitemname	 = @statitemname_2, statitemexpress	 = @statitemexpress_3, statitemdesc	 = @statitemdesc_4 , statitemenname	 = @statitemenname_5  WHERE ( statitemid	 = @statitemid_1)

GO
alter procedure [T_Statitem_SelectAll] (@flag	int	output, @msg	varchar(4000)	output)  AS select * from  T_Statitem

GO
alter procedure [T_Statitem_Select] (@statitemid_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS select * from  T_Statitem  WHERE ( statitemid	 = @statitemid_1)

GO
alter procedure [T_Statitem_Insert] (@statitemname_1 	varchar(4000), @statitemexpress_2 	varchar(4000), @statitemdesc_3 	varchar(4000), @statitemenname_4 	varchar(4000), @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO T_Statitem ( statitemname, statitemexpress, statitemdesc, statitemenname)  VALUES ( @statitemname_1, @statitemexpress_2, @statitemdesc_3, @statitemenname_4)

GO
alter procedure [T_Statitem_Delete] (@statitemid_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_Statitem  WHERE ( statitemid	 = @statitemid_1)

GO
alter procedure [T_ReportStatitemTable_SById] (@outrepid_1 int , @flag	int	output, @msg	varchar(4000)	output)  AS select * from T_ReportStatitemTable where outrepid = @outrepid_1

GO
alter procedure [T_ReportStatitemTable_Insert] (@outrepid_1 	int, @itemtable_2     varchar(4000), @itemtablealter_3  varchar(4000), @flag	int	output, @msg	varchar(4000)	output)  AS  INSERT INTO T_ReportStatitemTable ( outrepid, itemtable, itemtablealter)  VALUES ( @outrepid_1, @itemtable_2, @itemtablealter_3)

GO
alter procedure [T_ReportStatitemTable_Delete] (@outrepid_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS  Delete T_ReportStatitemTable where outrepid = @outrepid_1

GO
alter procedure [T_OutRShare_SelectByOutrepid]( @outrepid int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_OutReportShare where outrepid = @outrepid

GO
alter procedure [T_OutRItemTable_SelectByItemid]( @itemid int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_OutReportItemTable where itemid = @itemid

GO
alter procedure [T_OutRItemCoordinate_Delete]( @itemid 	int , @flag	int	output, @msg	varchar(4000)	output) AS DELETE T_OutReportItemCoordinate WHERE( itemid	 = @itemid)

GO
alter procedure [T_OutRItemCondition_Insert]( @itemid_1 	int, @conditionid     int, @conditionvalue  varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO T_OutReportItemCondition ( itemid, conditionid, conditionvalue) VALUES ( @itemid_1, @conditionid, @conditionvalue)

GO
alter procedure [T_OutRItemCondition_Delete]( @itemid 	int , @flag	int	output, @msg	varchar(4000)	output) AS DELETE T_OutReportItemCondition WHERE (itemid = @itemid)

GO
alter procedure [T_OutRItem_SelectByOutrepid]( @outrepid int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_OutReportItem where outrepid = @outrepid

GO
alter procedure [T_OutRICondition_SByItemid]( @itemid int , @flag	int	output, @msg	varchar(4000)	output) AS select * from T_OutReportItemCondition where itemid = @itemid

GO
alter procedure [T_OutReport_SelectByOutrepid] (@outrepid int , @flag	int	output, @msg	varchar(4000)	output)  AS select * from T_OutReport where outrepid = @outrepid

GO
alter procedure [T_OutReport_SelectAll] (@outrepcategory_1 char(1) , @flag	int	output, @msg	varchar(4000)	output)  AS select * from T_OutReport where outrepcategory = @outrepcategory_1

GO
alter procedure [T_OutReport_Insert] (@outrepname_1 	varchar(4000), @outreprow_2 	int, @outrepcolumn_3 	int, @outrepdesc_4 	varchar(4000) , @modulefilename_5  varchar(4000) , @outreptype_6 char(1) , @outrepcategory_7 char(1) , @enmodulefilename_8  varchar(4000) , @outrepenname_9  varchar(4000) , @outrependesc_10  varchar(4000) , @autocolumn_11 char(1) , @autorow_12 char(1) , @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO T_OutReport ( outrepname, outreprow, outrepcolumn, outrepdesc, modulefilename, outreptype, outrepcategory, enmodulefilename, outrepenname, outrependesc, autocolumn, autorow)  VALUES ( @outrepname_1, @outreprow_2, @outrepcolumn_3, @outrepdesc_4, @modulefilename_5, @outreptype_6, @outrepcategory_7, @enmodulefilename_8, @outrepenname_9 , @outrependesc_10 , @autocolumn_11, @autorow_12)

GO
alter procedure [T_OutReport_Delete] (@outrepid_1 	int , @flag	int	output, @msg	varchar(4000)	output)  AS DELETE T_OutReport WHERE ( outrepid	 = @outrepid_1) DELETE T_OutReportCondition WHERE ( outrepid	 = @outrepid_1) DELETE T_OutReportShare WHERE ( outrepid	 = @outrepid_1) DELETE T_OutReportItem WHERE ( outrepid	 = @outrepid_1) DELETE T_ReportStatitemTable WHERE ( outrepid	 = @outrepid_1) DELETE T_OutReportStatitem WHERE ( outrepid	 = @outrepid_1)

GO
alter procedure [T_OutReport_Copy] (@outrepid_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS declare @newoutrepid_1 int declare @theoutrepcategory_1 int declare @itemid_1 int declare @newitemid_1 int declare @moduleid_1 int declare @newmoduleid_1 int  select @theoutrepcategory_1 = outrepcategory from T_OutReport where outrepid = @outrepid_1  INSERT INTO T_OutReport( outrepname,  outreprow , outrepcolumn , outrepdesc , modulefilename , outreptype , outrepcategory ,enmodulefilename,outrepenname,outrependesc ) ( select '复制_'+outrepname,  outreprow , outrepcolumn , outrepdesc , modulefilename , outreptype , outrepcategory  ,enmodulefilename,outrepenname,outrependesc from T_OutReport where outrepid = @outrepid_1 )  select @newoutrepid_1 = max(outrepid) from T_OutReport  INSERT INTO T_OutReportCondition( outrepid,  conditionid , conditioncnname, conditionenname ) ( select @newoutrepid_1,  conditionid , conditioncnname, conditionenname from T_OutReportCondition where outrepid = @outrepid_1 )  INSERT INTO T_OutReportShare( outrepid,  userid , usertype , sharelevel) ( select @newoutrepid_1,  userid,  usertype , sharelevel from T_OutReportShare where outrepid = @outrepid_1 )  declare module_cursor cursor for select id from outrepmodule where outrepid = @outrepid_1 open module_cursor fetch next from module_cursor into @moduleid_1 while @@fetch_status=0 begin INSERT INTO outrepmodule( outrepid,  modulename , moduledesc , userid , usertype , moduleenname ) ( select @newoutrepid_1,  modulename,  moduledesc , userid , usertype , moduleenname from outrepmodule where id = @moduleid_1 ) select @newmoduleid_1 = max( id ) from outrepmodule INSERT INTO modulecondition( moduleid,  conditionid , conditionname , isuserdefine , conditionvalue ) ( select @newmoduleid_1,  conditionid , conditionname , isuserdefine , conditionvalue from modulecondition where moduleid = @moduleid_1 ) fetch next from module_cursor into @moduleid_1 end close module_cursor deallocate module_cursor   if @theoutrepcategory_1 = 0 or @theoutrepcategory_1 = 2 begin INSERT INTO T_OutReportItemRow( outrepid,  itemrow ) ( select @newoutrepid_1,  itemrow from T_OutReportItemRow where outrepid = @outrepid_1 )  declare itemid_cursor cursor for select itemid from T_OutReportItem where outrepid = @outrepid_1 open itemid_cursor fetch next from itemid_cursor into @itemid_1 while @@fetch_status=0 begin INSERT INTO T_OutReportItem( outrepid,  itemrow , itemcolumn , itemtype , picstat, itemexpress, itemtable, itemcondition, itemdesc, itemexpresstype, picstatbudget, picstatlast , itemmodtype ) ( select @newoutrepid_1,  itemrow , itemcolumn , itemtype , picstat, itemexpress, itemtable, itemcondition, itemdesc, itemexpresstype, picstatbudget, picstatlast , itemmodtype from T_OutReportItem where itemid = @itemid_1 )  select @newitemid_1 = max( itemid ) from T_OutReportItem  INSERT INTO T_OutReportItemTable( itemid,  itemtable , itemtablealter ) ( select @newitemid_1,  itemtable,  itemtablealter from T_OutReportItemTable where itemid = @itemid_1 )  INSERT INTO T_OutReportItemCondition( itemid,  conditionid , conditionvalue ) ( select @newitemid_1,  conditionid,  conditionvalue from T_OutReportItemCondition where itemid = @itemid_1 )  INSERT INTO T_OutReportItemCoordinate( itemid,  coordinatename , coordinatevalue ) ( select @newitemid_1,  coordinatename,  coordinatevalue from T_OutReportItemCoordinate where itemid = @itemid_1 )  fetch next from itemid_cursor into @itemid_1 end close itemid_cursor deallocate itemid_cursor end else begin INSERT INTO T_OutReportStatitem( outrepid,  statitemid , dsporder ) ( select @newoutrepid_1,  statitemid,  dsporder from T_OutReportStatitem where outrepid = @outrepid_1 ) end

GO
alter procedure [WF_CRM_ShareInfo_Add] (@crmid_1		int, @sharelevel_1		int, @userid_1		int, @usertype_1		int, @flag                             integer output, @msg                             varchar(4000) output ) as declare @count_2 int select @count_2=count(*)  from CRM_ShareInfo where relateditemid=@crmid_1 and sharelevel=@sharelevel_1 and userid= @userid_1 if @count_2=0 begin if @usertype_1=0 begin insert CRM_ShareInfo(relateditemid,sharetype,sharelevel,userid,contents) values(@crmid_1,'1',@sharelevel_1,@userid_1,@userid_1) end if @usertype_1=1 begin insert CRM_ShareInfo(relateditemid,sharetype,sharelevel,crmid,contents) values(@crmid_1,'9',@sharelevel_1,@userid_1,@userid_1) end end

GO
alter procedure [WF_CptCapitalShareInfo_Add] (@cptid		int, @sharelevel_1		int, @userid_1		int, @usertype_1		int, @flag                             integer output, @msg                             varchar(4000) output ) as declare @count_2 int select @count_2=count(*)  from CptCapitalShareInfo where relateditemid=@cptid and sharelevel=@sharelevel_1 and userid= @userid_1 if @count_2=0 begin if @usertype_1=0 begin insert CptCapitalShareInfo(relateditemid,sharetype,sharelevel,userid) values(@cptid,'1',@sharelevel_1,@userid_1) end if @usertype_1=1 begin insert CptCapitalShareInfo(relateditemid,sharetype,sharelevel,crmid) values(@cptid,'9',@sharelevel_1,@userid_1) end end

GO
alter procedure [Weather_Update] (@id_1            int, @thedate_1 	    char(10), @picid_2 	    int, @thedesc_3 	    varchar(4000), @temperature_4 	varchar(4000), @flag integer output, @msg varchar(4000) output) AS update [Weather] set thedate = @thedate_1, picid =@picid_2 , thedesc = @thedesc_3 ,temperature = @temperature_4 where id= @id_1

GO
alter procedure [Weather_SelectTheDate] (@thedate_1 	char(10), @flag                             integer output, @msg                             varchar(4000) output ) AS select * from Weather where thedate = @thedate_1

GO
alter procedure [Weather_SelectByYear] (@year_1 	 int, @flag                             integer output, @msg                             varchar(4000) output ) AS select * from Weather where substring(thedate,1,4)= @year_1 order by thedate

GO
alter procedure [Weather_SelectByID] (@id_1 	int, @flag                             integer output, @msg                             varchar(4000) output ) AS select * from Weather where id=@id_1

GO
alter procedure [Weather_Insert] (@thedate_1 	    char(10), @picid_2 		    int, @thedesc_3 	    varchar(4000), @temperature_4 	varchar(4000), @flag integer output, @msg varchar(4000) output) AS if  not exists( select * from Weather where thedate = @thedate_1) begin INSERT INTO Weather ( thedate, picid, thedesc,temperature)  VALUES ( @thedate_1, @picid_2, @thedesc_3, @temperature_4) end select max(id) from Weather if @@error<>0 begin set @flag=1 set @msg='插入失败' end else begin set @flag=0 set @msg='操作成功' end

GO
alter procedure [Weather_Delete] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output) AS DELETE [Weather]  WHERE ( [id]	 = @id_1)

GO
alter procedure [VotingRemark_Insert] (@votingid    int, @resourceid int, @useranony     int, @remark    text, @operatedate   char(10), @operatetime   char(8), @flag integer output, @msg varchar(4000) output) AS insert into votingremark (votingid,resourceid,useranony,remark,operatedate,operatetime) values (@votingid,@resourceid,@useranony,@remark,@operatedate,@operatetime)

  GO
alter procedure [WorkFlow_Browser_Search] (@labelname 	varchar(4000), @flag integer output ,   @msg varchar(4000) output) AS select id from  workflow_browserurl WHERE ( labelid	 = (select indexid from HtmlLabelInfo where labelname= @labelname))

GO
alter procedure [workflow_BillValue_Select] @requestid	int, @flag integer output , @msg varchar(4000) output AS declare @billformid int , @billid int select @billformid = billformid , @billid = billid from workflow_form where requestid=@requestid  if @billformid = 1 select * from bill_itemusage where id = @billid  else if @billformid = 2 select * from LgcStockInOut where id = @billid  else if @billformid = 3 select * from LgcStockInOut where id = @billid  else if @billformid = 4 select * from bill_contract where id = @billid  else if @billformid = 5 select * from Bill_Meetingroom where id = @billid  else if @billformid = 6 select * from Bill_HrmResourcePlan where id = @billid  else if @billformid = 7 select * from Bill_Expense where id = @billid  else if @billformid = 8 select * from Bill_HrmResourceAbsense where id = @billid  else select * from workflow_form where requestid=@requestid

GO
alter procedure [workflow_billFieldRt_S] @formid		int, @nodeid		int, @flag integer output , @msg varchar(4000) output AS   select distinct a.id,a.billid,a.fieldname,a.fieldlabel,a.fielddbtype, a.fieldhtmltype,a.type,a.dsporder,a.viewtype,a.detailtable,a.fromuser,b.isedit from workflow_billfield a, workflow_nodeform b where a.billid=@formid and a.id=b.fieldid and b.nodeid=@nodeid order by dsporder

GO
alter procedure [WorkFlow_BillField_Update] (@id_1 	int, @billid_2 int, @fieldname_3 varchar(4000), @fieldlabel_4 int, @fielddbtype_5 varchar(4000), @fieldhtmltype_6 char(1), @type_7 int, @dsporder_8 int, @viewtype_9 int, @flag int output,	 @msg varchar(4000) output ) AS UPDATE workflow_billfield SET  billid	 = @billid_2, fieldname = @fieldname_3, fieldlabel	 = @fieldlabel_4, fielddbtype	 = @fielddbtype_5, fieldhtmltype = @fieldhtmltype_6,	 type	 = @type_7, dsporder	 = @dsporder_8,	 viewtype	 = @viewtype_9  WHERE 	( id	 = @id_1)

GO
alter procedure [workflow_billfield_SelectByID] @id		int, @flag integer output , @msg varchar(4000) output AS select * from workflow_billfield where id=@id

GO
alter procedure [workflow_billfield_Select] @formid		int, @flag integer output , @msg varchar(4000) output AS select * from workflow_billfield where billid=@formid order by dsporder

GO
alter procedure [WorkFlow_BillField_Insert] (@billid_2 int,	 @fieldname_3 varchar(4000), @fieldlabel_4 int, @fielddbtype_5 varchar(4000), @fieldhtmltype_6 char(1), @type_7 int, @dsporder_8 	int, @viewtype_9 	int,	 @flag int output, @msg varchar(4000) output ) AS INSERT INTO workflow_billfield ( billid, fieldname, fieldlabel, fielddbtype, fieldhtmltype, type, dsporder, viewtype) VALUES ( @billid_2, @fieldname_3, @fieldlabel_4, @fielddbtype_5, @fieldhtmltype_6, @type_7, @dsporder_8, @viewtype_9)

GO
alter procedure [WorkFlow_BillField_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) AS DELETE workflow_billfield WHERE ( id	 = @id_1)

GO
alter procedure [Wf_Right_checkpermission](		   @dirid_1         INT, @dirtype_1       INT, @userid_1        INT, @usertype_1      INT, @seclevel_1      INT, @operationcode_1 INT, @departmentid_1  INT, @subcompanyid_1  INT, @roleid_1        varchar(4000), @flag            INT output, @msg             varchar(4000) output) AS DECLARE @count_1 INT DECLARE @result INT  SET @result = 0 BEGIN SET @count_1 = (SELECT Count(mainid) FROM   wfAccessControlList WHERE  dirid = @dirid_1 AND dirtype = @dirtype_1 AND operationcode = @operationcode_1 AND (  (permissiontype=1 AND departmentid = @departmentid_1 AND seclevel <= @seclevel_1 ) OR(permissiontype=2 AND roleid IN (SELECT * FROM   Splitstr(@roleid_1, ',')) AND seclevel <= @seclevel_1 ) OR( permissiontype = 3 AND seclevel <= @seclevel_1 ) OR( permissiontype = 4 AND usertype = @usertype_1 AND seclevel <= @seclevel_1 ) OR( permissiontype = 5 AND userid = @userid_1) OR( permissiontype = 6 AND subcompanyid=@subcompanyid_1 AND seclevel <= @seclevel_1) )) END  PRINT @count_1  IF ( NOT ( @count_1 IS NULL ) ) AND ( @count_1 > 0 ) BEGIN SET @result = 1 END  SELECT @result result  IF @@ERROR <> 0 BEGIN SET @flag=1 SET @msg='检查流程访问权限成功'  RETURN END ELSE BEGIN SET @flag=-1 SET @msg='检查流程访问权限失败'  RETURN END

GO
alter procedure [Workflow_MonitorType_UPDATE](@id_1        integer, @typename_2  varchar(4000), @typedesc_3  varchar(4000), @typeorder_4 integer, @flag integer output, @msg varchar(4000) output) AS UPDATE Workflow_MonitorType SET typename  = @typename_2, typedesc  = @typedesc_3, typeorder = @typeorder_4 WHERE (id = @id_1)

GO
alter procedure [Workflow_MonitorType_INSERT](@typename_1  varchar(4000), @typedesc_2  varchar(4000), @typeorder_3 integer, @flag integer output, @msg varchar(4000) output) AS INSERT INTO Workflow_MonitorType (typename, typedesc, typeorder) VALUES (@typename_1, @typedesc_2, @typeorder_3)

GO
alter procedure [Workflow_MonitorType_DELETE](@id_1      integer, @flag integer output, @msg varchar(4000) output) AS Declare @count1 integer select @count1=count(1) from workflow_monitor_bound where monitortype = @id_1; if @count1 <> 0 begin select 0 end else begin DELETE from Workflow_MonitorType WHERE (id = @id_1) end

GO
alter procedure [workflow_CreateNode_Select] @workflowid	int, @flag integer output , @msg varchar(4000) output AS select nodeid from workflow_flownode where workflowid=@workflowid and nodetype='0'

GO
alter procedure [WorkFlow_BrowserUrl_Update] (@id_1 	int, @labelid_2 	int, @fielddbtype_3 	varchar(4000), @browserurl_4 	varchar(4000), @tablename_5 	varchar(4000), @columname_6 	varchar(4000), @keycolumname_7 	varchar(4000), @linkurl_8 	varchar(4000), @flag int output, @msg varchar(4000) output )  AS UPDATE workflow_browserurl  SET  labelid	 = @labelid_2, fielddbtype	 = @fielddbtype_3, browserurl	 = @browserurl_4, tablename	 = @tablename_5, columname	 = @columname_6, keycolumname	 = @keycolumname_7, linkurl	 = @linkurl_8  WHERE ( id	 = @id_1)

GO
alter procedure [WorkFlow_BrowserUrl_Insert] (@id_1 	int, @labelid_2 	int, @fielddbtype_3 	varchar(4000), @browserurl_4 	varchar(4000), @tablename_5 	varchar(4000), @columname_6 	varchar(4000), @keycolumname_7 	varchar(4000), @linkurl_8 	varchar(4000), @flag int output, @msg varchar(4000) output ) AS INSERT INTO workflow_browserurl ( id, labelid, fielddbtype, browserurl, tablename, columname, keycolumname, linkurl)  VALUES (@id_1, @labelid_2, @fielddbtype_3, @browserurl_4, @tablename_5, @columname_6, @keycolumname_7, @linkurl_8)

GO
alter procedure [WorkFlow_BrowserUrl_Delete] (@id_1 	int, @flag int output, @msg varchar(4000) output )  AS DELETE workflow_browserurl  WHERE ( id	 = @id_1)

GO
alter procedure [LgcAssetType_Update] (@id_1 	[int], @typemark_2 	varchar(4000), @typename_3 	varchar(4000), @typedesc_4 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS UPDATE [LgcAssetType]  SET  [typemark]	 = @typemark_2, [typename]	 = @typename_3, [typedesc]	 = @typedesc_4  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcAssetType_SelectByID] @id  int , @flag integer output , @msg varchar(4000) output AS select * from LgcAssetType  where id = @id

GO
alter procedure [LgcAssetType_Select] @flag integer output , @msg varchar(4000) output AS select * from LgcAssetType

GO
alter procedure [LgcAssetType_Insert] (@typemark_1 	varchar(4000), @typename_2 	varchar(4000), @typedesc_3 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [LgcAssetType] ( [typemark], [typename], [typedesc])  VALUES ( @typemark_1, @typename_2, @typedesc_3)  select max(id) from LgcAssetType

GO
alter procedure [LgcAssetType_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @count int  select @count = count(id) from LgcAsset where assettypeid = @id_1 if @count <> 0 begin select -1 return end  DELETE [LgcAssetType] WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcAssetAssortment_Select] @flag integer output , @msg varchar(4000) output AS select * from LgcAssetAssortment order by assortmentmark

GO
alter procedure [LgcAssetAssortment_Insert] (@assortmentmark_1 	varchar(4000), @assortmentname_2 	varchar(4000), @seclevel_3 	[tinyint], @resourceid_4 	[int], @assortmentimageid_5 	[int], @assortmentremark_6 	[text], @supassortmentid_7 	[int], @supassortmentstr_8 	varchar(4000), @dff01name_11 	varchar(4000), @dff01use_12 	[tinyint], @dff02name_13 	varchar(4000), @dff02use_14 	[tinyint], @dff03name_15 	varchar(4000), @dff03use_16 	[tinyint], @dff04name_17 	varchar(4000), @dff04use_18 	[tinyint], @dff05name_19 	varchar(4000), @dff05use_20 	[tinyint], @nff01name_21 	varchar(4000), @nff01use_22 	[tinyint], @nff02name_23 	varchar(4000), @nff02use_24 	[tinyint], @nff03name_25 	varchar(4000), @nff03use_26 	[tinyint], @nff04name_27 	varchar(4000), @nff04use_28 	[tinyint], @nff05name_29 	varchar(4000), @nff05use_30 	[tinyint], @tff01name_31 	varchar(4000), @tff01use_32 	[tinyint], @tff02name_33 	varchar(4000), @tff02use_34 	[tinyint], @tff03name_35 	varchar(4000), @tff03use_36 	[tinyint], @tff04name_37 	varchar(4000), @tff04use_38 	[tinyint], @tff05name_39 	varchar(4000), @tff05use_40 	[tinyint], @bff01name_41 	varchar(4000), @bff01use_42 	[tinyint], @bff02name_43 	varchar(4000), @bff02use_44 	[tinyint], @bff03name_45 	varchar(4000), @bff03use_46 	[tinyint], @bff04name_47 	varchar(4000), @bff04use_48 	[tinyint], @bff05name_49 	varchar(4000), @bff05use_50 	[tinyint], @flag integer output, @msg varchar(4000) output ) AS begin UPDATE LgcAssetAssortment SET subassortmentcount=subassortmentcount+1 WHERE id = @supassortmentid_7 end INSERT INTO [LgcAssetAssortment] ( [assortmentmark], [assortmentname], [seclevel], [resourceid], [assortmentimageid], [assortmentremark], [supassortmentid], [supassortmentstr], [subassortmentcount], [assetcount], [dff01name], [dff01use], [dff02name], [dff02use], [dff03name], [dff03use], [dff04name], [dff04use], [dff05name], [dff05use], [nff01name], [nff01use], [nff02name], [nff02use], [nff03name], [nff03use], [nff04name], [nff04use], [nff05name], [nff05use], [tff01name], [tff01use], [tff02name], [tff02use], [tff03name], [tff03use], [tff04name], [tff04use], [tff05name], [tff05use], [bff01name], [bff01use], [bff02name], [bff02use], [bff03name], [bff03use], [bff04name], [bff04use], [bff05name], [bff05use]) VALUES ( @assortmentmark_1, @assortmentname_2, @seclevel_3, @resourceid_4, @assortmentimageid_5, @assortmentremark_6, @supassortmentid_7, @supassortmentstr_8, 0, 0, @dff01name_11, @dff01use_12, @dff02name_13, @dff02use_14, @dff03name_15, @dff03use_16, @dff04name_17, @dff04use_18, @dff05name_19, @dff05use_20, @nff01name_21, @nff01use_22, @nff02name_23, @nff02use_24, @nff03name_25, @nff03use_26, @nff04name_27, @nff04use_28, @nff05name_29, @nff05use_30, @tff01name_31, @tff01use_32, @tff02name_33, @tff02use_34, @tff03name_35, @tff03use_36, @tff04name_37, @tff04use_38, @tff05name_39, @tff05use_40, @bff01name_41, @bff01use_42, @bff02name_43, @bff02use_44, @bff03name_45, @bff03use_46, @bff04name_47, @bff04use_48, @bff05name_49, @bff05use_50) select max(id) from LgcAssetAssortment

GO
alter procedure [LgcAssetAssortment_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output ) AS declare @count integer , @supassortmentid int   select @count = assetcount from LgcAssetAssortment where id = @id_1 if @count <> 0 begin select -1 return end  select @count = subassortmentcount  from LgcAssetAssortment where id = @id_1 if @count <> 0 begin select -1 return end  select @supassortmentid = supassortmentid from LgcAssetAssortment where id= @id_1 update LgcAssetAssortment set subassortmentcount = subassortmentcount-1 where id= @supassortmentid   DELETE [LgcAssetAssortment] WHERE [id] = @id_1

  GO
alter procedure [HtmlLabelIndex_Select_ByDesc] (@indexdesc_1 	varchar(4000), @flag int output, @msg varchar(4000) output) AS select id from HtmlLabelIndex WHERE ( indexdesc	 = @indexdesc_1)

  GO
alter procedure [HtmlLabelIndex_Insert] @id		int, @indexdesc	varchar(4000), @flag		int	output, @msg		varchar(4000) output as insert into HtmlLabelIndex (id,indexdesc) values (@id,@indexdesc)

GO
alter procedure [LgcAsset_UpdatePic] (@id_1 	[int], @assetimageid_2     [int], @flag                             integer output, @msg                             varchar(4000) output ) AS update LgcAsset set assetimageid = 0 where id = @id_1 delete ImageFile where imagefileid = @assetimageid_2  if @@error<>0 begin set @flag=1 set @msg='删除图片成功' return end else begin set @flag=0 set @msg='删除图片失败' return end

GO
alter procedure [LgcAsset_Update] (@id_1 	int, @assetcountryid_2 int, @barcode_3 	varchar(4000), @seclevel_4 	tinyint, @assetimageid_5 	int, @assettypeid_6 	int, @assetunitid_7 	int, @replaceassetid_8 	int, @assetversion_9 	varchar(4000), @assetattribute_10 	varchar(4000), @counttypeid_11 	int, @assortmentid_12 	int, @assortmentstr_13 	varchar(4000), @relatewfid    int, @assetname_2 	varchar(4000), @assetcountyid_3 	int, @startdate_4 	char(10), @enddate_5 	char(10), @departmentid_6 	int, @resourceid_7 	int, @assetremark_8 	text, @currencyid_9 	int, @salesprice_10 	varchar(4000), @costprice_11 	varchar(4000), @datefield1_12 	char(10), @datefield2_13 	char(10), @datefield3_14 	char(10), @datefield4_15 	char(10), @datefield5_16 	char(10), @numberfield1_17 	float, @numberfield2_18 	float, @numberfield3_19 	float, @numberfield4_20 	float, @numberfield5_21 	float, @textfield1_22 	varchar(4000), @textfield2_23 	varchar(4000), @textfield3_24 	varchar(4000), @textfield4_25 	varchar(4000), @textfield5_26 	varchar(4000), @tinyintfield1_27 	char(1), @tinyintfield2_28 	char(1), @tinyintfield3_29 	char(1), @tinyintfield4_30 	char(1), @tinyintfield5_31 	char(1), @lastmoderid_32 	int, @lastmoddate_33 	char(10), @isdefault_1 		char(1), @Flag	int	output, @msg	varchar(4000)	output) AS set @salesprice_10 = convert(decimal(18,3) , @salesprice_10) set @costprice_11 = convert(decimal(18,3) , @costprice_11) UPDATE LgcAsset SET  	 relatewfid = @relatewfid , barcode	 = @barcode_3, seclevel	 = @seclevel_4, assetimageid	 = @assetimageid_5, assettypeid	 = @assettypeid_6, assetunitid	 = @assetunitid_7, replaceassetid	 = @replaceassetid_8, assetversion	 = @assetversion_9, assetattribute	 = @assetattribute_10, counttypeid	 = @counttypeid_11, assortmentid	 = @assortmentid_12, assortmentstr	 = @assortmentstr_13  WHERE ( id	 = @id_1) if  @assetcountryid_2=-1 begin select @assetcountryid_2=assetcountyid from LgcAssetCountry where assetid=@id_1 and isdefault='1' end if  @isdefault_1='1' begin update LgcAssetCountry set isdefault='0' where assetid=@id_1 end UPDATE LgcAssetCountry SET      assetname	 = @assetname_2, assetcountyid = @assetcountyid_3, startdate	 = @startdate_4, enddate	 = @enddate_5, departmentid	 = @departmentid_6, resourceid	 = @resourceid_7, assetremark	 = @assetremark_8, currencyid	 = @currencyid_9, salesprice	 = @salesprice_10, costprice	 = @costprice_11, datefield1	 = @datefield1_12, datefield2	 = @datefield2_13, datefield3	 = @datefield3_14, datefield4	 = @datefield4_15, datefield5	 = @datefield5_16, numberfield1	 = @numberfield1_17, numberfield2	 = @numberfield2_18, numberfield3	 = @numberfield3_19, numberfield4	 = @numberfield4_20, numberfield5	 = @numberfield5_21, textfield1	 = @textfield1_22, textfield2	 = @textfield2_23, textfield3	 = @textfield3_24, textfield4	 = @textfield4_25, textfield5	 = @textfield5_26, tinyintfield1 = @tinyintfield1_27, tinyintfield2 = @tinyintfield2_28, tinyintfield3 = @tinyintfield3_29, tinyintfield4 = @tinyintfield4_30, tinyintfield5 = @tinyintfield5_31, lastmoderid	 = @lastmoderid_32, lastmoddate	 = @lastmoddate_33 , isdefault	= @isdefault_1  WHERE ( (assetid = @id_1) and (assetcountyid =@assetcountryid_2))

GO
alter procedure [LgcAsset_SelectSumByResource] (@flag	[int]	output, @msg	varchar(4000)	output) AS select resourceid AS resultid, COUNT(id) AS resultcount from LgcAssetCountry where resourceid !=0 group by resourceid  order by  resultcount desc

GO
alter procedure [LgcAsset_SelectSumByDepartment] (@flag	[int]	output, @msg	varchar(4000)	output) AS select departmentid AS resultid, COUNT(id) AS resultcount from LgcAssetCountry where departmentid !=0 group by departmentid  order by  resultcount desc

GO
alter procedure [LgcAsset_SelectSumByConfigue] (@flag	[int]	output, @msg	varchar(4000)	output) AS select relationtypeid AS resultid, COUNT(id) AS resultcount from LgcConfiguration  group by relationtypeid  order by  resultcount desc

GO
alter procedure [LgcAsset_SelectSumByAssortment] (@flag	[int]	output, @msg	varchar(4000)	output) AS select assortmentid AS resultid, COUNT(id) AS resultcount from LgcAsset group by assortmentid  order by  resultcount desc

GO
alter procedure [LgcAsset_SelectSumByAssetType] (@flag	[int]	output, @msg	varchar(4000)	output) AS select assettypeid AS resultid, COUNT(id) AS resultcount from LgcAsset group by assettypeid  order by  resultcount desc

GO
alter procedure [LgcAsset_SelectById] ( @id int, @assetcountryid int, @flag integer output , @msg varchar(4000) output) AS  if @assetcountryid<>-1 begin select * from LgcAsset , LgcAssetCountry where LgcAsset.id = @id and LgcAssetCountry.assetid = @id and LgcAssetCountry.assetcountyid = @assetcountryid end else begin select * from LgcAsset , LgcAssetCountry where LgcAsset.id = @id and LgcAssetCountry.assetid = @id and isdefault ='1' end

GO
alter procedure [LgcAsset_SelectByAssortment] (@assortmentid 	[int], @flag integer output , @msg varchar(4000) output) AS select LgcAsset.id , assetmark,assetname,assettypeid,seclevel from LgcAsset , LgcAssetCountry where LgcAsset.id = LgcAssetCountry.assetid and isdefault ='1' and assortmentid = @assortmentid

GO
alter procedure [LgcCatalogs_Update] (@id_1 	[int], @catalogname_2 	varchar(4000), @catalogdesc_3 	varchar(4000), @catalogorder_4 	[int], @perpage_5 	[int], @seclevelfrom_6 	[tinyint], @seclevelto_7 	[tinyint], @navibardsp_8 	[char](1), @navibarbgcolor_9 	[char](6), @navibarfontcolor_10 	[char](6), @navibarfontsize_11 	varchar(4000), @navibarfonttype_12 	varchar(4000), @toolbardsp_13 	[char](1), @toolbarwidth_14 	[int], @toolbarbgcolor_15 	[char](6), @toolbarfontcolor_16 	[char](6), @toolbarlinkbgcolor_17 	[char](6), @toolbarlinkfontcolor_18 	[char](6), @toolbarfontsize_19 	varchar(4000), @toolbarfonttype_20 	varchar(4000), @countrydsp_21 	[char](1), @countrydeftype_22 	[char](1), @countryid_23 	[int], @searchbyname_24 	[char](1), @searchbycrm_25 	[char](1), @searchadv_26 	[char](1), @assortmentdsp_27 	[char](1), @assortmentname_28 	varchar(4000), @assortmentsql_29 	[text], @attributedsp_30 	[char](1), @attributecol_31 	[int], @attributefontsize_32 	varchar(4000), @attributefonttype_33 	varchar(4000), @assetsql_34 	[text], @assetcol1_35 	varchar(4000), @assetcol2_36 	varchar(4000), @assetcol3_37 	varchar(4000), @assetcol4_38 	varchar(4000), @assetcol5_39 	varchar(4000), @assetcol6_40 	varchar(4000), @assetfontsize_41 	varchar(4000), @assetfonttype_42 	varchar(4000), @webshopdap_43 	[char](1), @webshoptype_44 	[char](1), @webshopreturn_45 	[char](1), @webshopmanageid_46 	[int], @lastmoderid_47 	[int], @lastmoddate_48 	[char](10), @flag integer output , @msg varchar(4000) output)  AS UPDATE [LgcCatalogs]  SET  [catalogname]	 = @catalogname_2, [catalogdesc]	 = @catalogdesc_3, [catalogorder]	 = @catalogorder_4, [perpage]	 = @perpage_5, [seclevelfrom]	 = @seclevelfrom_6, [seclevelto]	 = @seclevelto_7, [navibardsp]	 = @navibardsp_8, [navibarbgcolor]	 = @navibarbgcolor_9, [navibarfontcolor]	 = @navibarfontcolor_10, [navibarfontsize]	 = @navibarfontsize_11, [navibarfonttype]	 = @navibarfonttype_12, [toolbardsp]	 = @toolbardsp_13, [toolbarwidth]	 = @toolbarwidth_14, [toolbarbgcolor]	 = @toolbarbgcolor_15, [toolbarfontcolor]	 = @toolbarfontcolor_16, [toolbarlinkbgcolor]	 = @toolbarlinkbgcolor_17, [toolbarlinkfontcolor]	 = @toolbarlinkfontcolor_18, [toolbarfontsize]	 = @toolbarfontsize_19, [toolbarfonttype]	 = @toolbarfonttype_20, [countrydsp]	 = @countrydsp_21, [countrydeftype]	 = @countrydeftype_22, [countryid]	 = @countryid_23, [searchbyname]	 = @searchbyname_24, [searchbycrm]	 = @searchbycrm_25, [searchadv]	 = @searchadv_26, [assortmentdsp]	 = @assortmentdsp_27, [assortmentname]	 = @assortmentname_28, [assortmentsql]	 = @assortmentsql_29, [attributedsp]	 = @attributedsp_30, [attributecol]	 = @attributecol_31, [attributefontsize]	 = @attributefontsize_32, [attributefonttype]	 = @attributefonttype_33, [assetsql]	 = @assetsql_34, [assetcol1]	 = @assetcol1_35, [assetcol2]	 = @assetcol2_36, [assetcol3]	 = @assetcol3_37, [assetcol4]	 = @assetcol4_38, [assetcol5]	 = @assetcol5_39, [assetcol6]	 = @assetcol6_40, [assetfontsize]	 = @assetfontsize_41, [assetfonttype]	 = @assetfonttype_42, [webshopdap]	 = @webshopdap_43, [webshoptype]	 = @webshoptype_44, [webshopreturn]	 = @webshopreturn_45, [webshopmanageid]	 = @webshopmanageid_46, [lastmoderid]	 = @lastmoderid_47, [lastmoddate]	 = @lastmoddate_48  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcCatalogs_SelectByUser] (@userseclevel  int , @flag integer output , @msg varchar(4000) output)  AS select id,catalogname,navibarbgcolor from LgcCatalogs where seclevelfrom <= @userseclevel and seclevelto >= @userseclevel

GO
alter procedure [LgcCatalogs_SelectByID] (@id  int , @flag integer output , @msg varchar(4000) output)  AS select * from LgcCatalogs where id= @id

GO
alter procedure [LgcCatalogs_Select] (@flag integer output , @msg varchar(4000) output)  AS select id,catalogname,catalogdesc,catalogorder,seclevelfrom,seclevelto from LgcCatalogs

GO
alter procedure [LgcCatalogs_SDefaultByUser] (@userseclevel  int , @flag integer output , @msg varchar(4000) output)  AS declare @catalogid int declare catalogid_cursor cursor for select id from LgcCatalogs where seclevelfrom <= @userseclevel and seclevelto >= @userseclevel order by catalogorder  open catalogid_cursor fetch next from catalogid_cursor into @catalogid if @@fetch_status=0 select @catalogid  close catalogid_cursor deallocate catalogid_cursor

GO
alter procedure [LgcCatalogs_Insert] (@catalogname_1 	varchar(4000), @catalogdesc_2 	varchar(4000), @catalogorder_3 	[int], @perpage_4 	[int], @seclevelfrom_5 	[tinyint], @seclevelto_6 	[tinyint], @navibardsp_7 	[char](1), @navibarbgcolor_8 	[char](6), @navibarfontcolor_9 	[char](6), @navibarfontsize_10 	varchar(4000), @navibarfonttype_11 	varchar(4000), @toolbardsp_12 	[char](1), @toolbarwidth_13 	[int], @toolbarbgcolor_14 	[char](6), @toolbarfontcolor_15 	[char](6), @toolbarlinkbgcolor_16 	[char](6), @toolbarlinkfontcolor_17 	[char](6), @toolbarfontsize_18 	varchar(4000), @toolbarfonttype_19 	varchar(4000), @countrydsp_20 	[char](1), @countrydeftype_21 	[char](1), @countryid_22 	[int], @searchbyname_23 	[char](1), @searchbycrm_24 	[char](1), @searchadv_25 	[char](1), @assortmentdsp_26 	[char](1), @assortmentname_27 	varchar(4000), @assortmentsql_28 	[text], @attributedsp_29 	[char](1), @attributecol_30 	[int], @attributefontsize_31 	varchar(4000), @attributefonttype_32 	varchar(4000), @assetsql_33 	[text], @assetcol1_34 	varchar(4000), @assetcol2_35 	varchar(4000), @assetcol3_36 	varchar(4000), @assetcol4_37 	varchar(4000), @assetcol5_38 	varchar(4000), @assetcol6_39 	varchar(4000), @assetfontsize_40 	varchar(4000), @assetfonttype_41 	varchar(4000), @webshopdap_42 	[char](1), @webshoptype_43 	[char](1), @webshopreturn_44 	[char](1), @webshopmanageid_45 	[int], @createrid_46 	[int], @createdate_47 	[char](10), @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [LgcCatalogs] ( [catalogname], [catalogdesc], [catalogorder], [perpage], [seclevelfrom], [seclevelto], [navibardsp], [navibarbgcolor], [navibarfontcolor], [navibarfontsize], [navibarfonttype], [toolbardsp], [toolbarwidth], [toolbarbgcolor], [toolbarfontcolor], [toolbarlinkbgcolor], [toolbarlinkfontcolor], [toolbarfontsize], [toolbarfonttype], [countrydsp], [countrydeftype], [countryid], [searchbyname], [searchbycrm], [searchadv], [assortmentdsp], [assortmentname], [assortmentsql], [attributedsp], [attributecol], [attributefontsize], [attributefonttype], [assetsql], [assetcol1], [assetcol2], [assetcol3], [assetcol4], [assetcol5], [assetcol6], [assetfontsize], [assetfonttype], [webshopdap], [webshoptype], [webshopreturn], [webshopmanageid], [createrid], [createdate])  VALUES ( @catalogname_1, @catalogdesc_2, @catalogorder_3, @perpage_4, @seclevelfrom_5, @seclevelto_6, @navibardsp_7, @navibarbgcolor_8, @navibarfontcolor_9, @navibarfontsize_10, @navibarfonttype_11, @toolbardsp_12, @toolbarwidth_13, @toolbarbgcolor_14, @toolbarfontcolor_15, @toolbarlinkbgcolor_16, @toolbarlinkfontcolor_17, @toolbarfontsize_18, @toolbarfonttype_19, @countrydsp_20, @countrydeftype_21, @countryid_22, @searchbyname_23, @searchbycrm_24, @searchadv_25, @assortmentdsp_26, @assortmentname_27, @assortmentsql_28, @attributedsp_29, @attributecol_30, @attributefontsize_31, @attributefonttype_32, @assetsql_33, @assetcol1_34, @assetcol2_35, @assetcol3_36, @assetcol4_37, @assetcol5_38, @assetcol6_39, @assetfontsize_40, @assetfonttype_41, @webshopdap_42, @webshoptype_43, @webshopreturn_44, @webshopmanageid_45, @createrid_46, @createdate_47) select max(id) from LgcCatalogs

GO
alter procedure [LgcCatalogs_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS DELETE [LgcCatalogs]  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcAttributeMove_Remove] (@assortmentid 	[int], @selectedattr  varchar(4000) , @flag integer output , @msg varchar(4000) output) AS update LgcAsset set assetattribute = replace(assetattribute,@selectedattr,'') where assortmentid = @assortmentid select @@ROWCOUNT

GO
alter procedure [LgcAttributeMove_Add] (@assortmentid 	[int], @selectedattr  varchar(4000) , @flag integer output , @msg varchar(4000) output) AS update LgcAsset set assetattribute = assetattribute + @selectedattr where assortmentid = @assortmentid and assetattribute not like '%'+@selectedattr+'%' select @@ROWCOUNT

GO
alter procedure [LgcAssortmentMove_Move] (@assortmentid	[int], @assetid  [int], @flag integer output , @msg varchar(4000) output) AS declare @supassortmentstr varchar(4000) select @supassortmentstr = supassortmentstr from LgcAssetAssortment where id = @assortmentid select @supassortmentstr = @supassortmentstr + convert(varchar(4000), @assortmentid) + '|' update LgcAsset set assortmentid = @assortmentid , assortmentstr = @supassortmentstr where id = @assetid

GO
alter procedure [LgcAssortmentMove_ChgCount] (@assortmentid1	[int], @assortmentid2  [int], @countid  [int], @flag integer output , @msg varchar(4000) output) AS update LgcAssetAssortment set assetcount = assetcount-@countid where id=@assortmentid1 update LgcAssetAssortment set assetcount = assetcount+@countid where id=@assortmentid2

GO
alter procedure [LgcAssetUnit_Update] (@id_1 	[int], @unitmark_2 	varchar(4000), @unitname_3 	varchar(4000), @unitdesc_4 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS UPDATE [LgcAssetUnit]  SET  [unitmark]	 = @unitmark_2, [unitname]	 = @unitname_3, [unitdesc]	 = @unitdesc_4  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcAssetUnit_SelectByID] @id  int , @flag integer output , @msg varchar(4000) output AS select * from LgcAssetUnit  where id = @id

GO
alter procedure [LgcAssetUnit_Select] @flag integer output , @msg varchar(4000) output AS select * from LgcAssetUnit order by id asc

 GO
alter procedure [LgcAssetUnit_Insert] ( @unitmark_1 	varchar(4000), @unitname_2 	varchar(4000), @unitdesc_3 	varchar(4000), @flag integer output , @msg varchar(4000) output) AS DECLARE @unitId integer INSERT INTO [LgcAssetUnit] ( [unitmark], [unitname], [unitdesc]) VALUES ( @unitmark_1, @unitname_2, @unitdesc_3) select @unitId = max(id) from LgcAssetUnit UPDATE LgcAssetUnit SET unitmark = CONVERT(varchar(4000), @unitId) WHERE [id] = @unitId

GO
alter procedure [LgcWebShop_Update] @id  int , @purchasestatus char(1), @flag integer output , @msg varchar(4000) output AS update LgcWebShop  set purchasestatus = @purchasestatus where id = @id

GO
alter procedure [LgcWebShop_SelectById] @id  int , @flag integer output , @msg varchar(4000) output AS select * from LgcWebShop  where id = @id

GO
alter procedure [LgcWebShop_Insert] (@usertype_1 	[tinyint], @userid_2 	[int], @username_3 	varchar(4000), @usercountry_4 	[int], @useremail_5 	varchar(4000), @receiveaddress_6 	varchar(4000), @receivetype_7 	[int], @postcode_8 	varchar(4000), @telephone1_9 	varchar(4000), @telephone2_10 	varchar(4000), @paymentmode_11 	varchar(4000), @currencyid_12 	[int], @purchasecount 	varchar(4000), @purchaseremark_14 	[text], @purchasedate_15 	[char](10), @manageid_16 	int, @flag integer output , @msg varchar(4000) output)  AS declare @purchasecount_13 [decimal](18,3) set @purchasecount_13 = convert(decimal(18,3),@purchasecount)  INSERT INTO [LgcWebShop] ( [usertype], [userid], [username], [usercountry], [useremail], [receiveaddress], [receivetype], [postcode], [telephone1], [telephone2], [paymentmode], [currencyid], [purchasecount], [purchaseremark], [purchasedate], [purchasestatus], manageid)  VALUES ( @usertype_1, @userid_2, @username_3, @usercountry_4, @useremail_5, @receiveaddress_6, @receivetype_7, @postcode_8, @telephone1_9, @telephone2_10, @paymentmode_11, @currencyid_12, @purchasecount_13, @purchaseremark_14, @purchasedate_15, '0', @manageid_16) select max(id) from LgcWebShop

GO
alter procedure [LgcWebShop_Delete] @id  int , @flag integer output , @msg varchar(4000) output AS delete LgcWebShop  where id = @id delete LgcWebShopDetail  where webshopid = @id

GO
alter procedure [HrmWorkTimeCount_Insert] (@resourceid_1 	int, @workdate_2 	char(7), @shiftid_3 	int, @workcount_4 	int, @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO HrmWorkTimeCount ( resourceid, workdate, shiftid, workcount)  VALUES ( @resourceid_1, @workdate_2, @shiftid_3, @workcount_4)

GO
alter procedure [HrmSalaryCalRate_Insert] (@benchid_1 	int, @timescope_2 	int, @condition_3 	varchar(4000), @formular_4 	varchar(4000), @conditiondsp_5 	varchar(4000), @formulardsp_6 	varchar(4000), @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO HrmSalaryCalrate ( benchid, timescope, condition, formular, conditiondsp, formulardsp )  VALUES ( @benchid_1, @timescope_2, @condition_3, @formular_4, @conditiondsp_5, @formulardsp_6)

GO
alter procedure [LgcWarehouse_Update] (@id_1 	[int], @warehousename_2 	varchar(4000), @warehousedesc_3 	varchar(4000), @roleid_4 	[int], @flag integer output , @msg varchar(4000) output)  AS UPDATE [LgcWarehouse]  SET  [warehousename]	 = @warehousename_2, [warehousedesc]	 = @warehousedesc_3, [roleid]	 = @roleid_4  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcWarehouse_SelectByID] @id  int , @flag integer output , @msg varchar(4000) output AS select * from LgcWarehouse  where id = @id

GO
alter procedure [LgcWarehouse_Select] @flag integer output , @msg varchar(4000) output AS select * from LgcWarehouse

GO
alter procedure [LgcWarehouse_Insert] (@warehousename_1 	varchar(4000), @warehousedesc_2 	varchar(4000), @roleid_3 	[int], @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [LgcWarehouse] ( [warehousename], [warehousedesc], [roleid])  VALUES ( @warehousename_1, @warehousedesc_2, @roleid_3)  select max(id) from LgcWarehouse

GO
alter procedure [LgcWarehouse_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @count int  select @count = count(id) from LgcStockInOut where warehouseid = @id_1 if @count <> 0 begin select -1 return end  DELETE [LgcWarehouse] WHERE  ( [id]	 = @id_1)

GO
alter procedure [LgcStockMode_Update] (@id_1 	[int], @modename_2 	varchar(4000), @modetype  char(1) , @modestatus  char(1), @modedesc_3 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS UPDATE [LgcStockMode]  SET  [modename]	 = @modename_2, [modetype]	 = @modetype, [modestatus]	 = @modestatus, [modedesc]	 = @modedesc_3  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcStockMode_SelectByID] @id  int , @flag integer output , @msg varchar(4000) output AS select * from LgcStockMode  where id = @id

GO
alter procedure [LgcStockMode_Select] @flag integer output , @msg varchar(4000) output AS select * from LgcStockMode

GO
alter procedure [LgcStockMode_Insert] (@modename_1 	varchar(4000), @modetype  char(1) , @modestatus  char(1), @modedesc_2 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [LgcStockMode] ( [modename], modetype, modestatus, [modedesc])  VALUES ( @modename_1, @modetype, @modestatus, @modedesc_2)  select max(id) from LgcStockMode

GO
alter procedure [LgcStockMode_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @count int  select @count = count(id) from LgcStockInOut where stockmodeid = @id_1 if @count <> 0 begin select -1 return end  DELETE [LgcStockMode] WHERE  ( [id]	 = @id_1)

GO
alter procedure [LgcStockInOutDetail_Update1] (@id_1 	[int], @inoutid_2 	[int], @assetid_3 	[int], @batchmark_4 	varchar(4000), @number_5 	[float], @flag integer output , @msg varchar(4000) output)  AS UPDATE [LgcStockInOutDetail]  SET  [inoutid]	 = @inoutid_2, [assetid]	 = @assetid_3, [batchmark]	 = @batchmark_4, [number_n]	 = @number_5  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcStockInOutDetail_Update] (@id_1 	[int], @inoutid_2 	[int], @assetid_3 	[int], @batchmark_4 	varchar(4000), @number_5 	[float], @currencyid_6 	[int], @defcurrencyid_7 	[int], @exchangerate_8 	[decimal], @defunitprice_9 	[decimal], @unitprice_10 	[decimal], @taxrate_11 	[int],  @flag integer output , @msg varchar(4000) output)  AS UPDATE [LgcStockInOutDetail]  SET  [inoutid]	 = @inoutid_2, [assetid]	 = @assetid_3, [batchmark]	 = @batchmark_4, [number_n]	 = @number_5, [currencyid]	 = @currencyid_6, [defcurrencyid]	 = @defcurrencyid_7, [exchangerate]	 = @exchangerate_8, [defunitprice]	 = @defunitprice_9, [unitprice]	 = @unitprice_10, [taxrate]	 = @taxrate_11  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcStockInOutDetail_Select] (@id [int], @flag integer output , @msg varchar(4000) output) AS select *  from LgcStockInOutDetail where inoutid=@id

GO
alter procedure [LgcStockInOutDetail_Insert1] (@inoutid_1 	[int], @assetid_2 	[int], @batchmark_3 	varchar(4000), @number_4 	[float], @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [LgcStockInOutDetail] ( [inoutid], [assetid], [batchmark], [number_n])  VALUES ( @inoutid_1, @assetid_2, @batchmark_3, @number_4)

GO
alter procedure [LgcStockInOutDetail_Insert] (@inoutid_1 	[int], @assetid_2 	[int], @batchmark_3 	varchar(4000), @number_4 	[float], @currencyid_5 	[int], @defcurrencyid_6 	[int], @exchangerate_7 	[decimal], @defunitprice_8 	[decimal], @unitprice_9 	[decimal], @taxrate_10 	[int], @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [LgcStockInOutDetail] ( [inoutid], [assetid], [batchmark], [number_n], [currencyid], [defcurrencyid], [exchangerate], [defunitprice], [unitprice], [taxrate])  VALUES ( @inoutid_1, @assetid_2, @batchmark_3, @number_4, @currencyid_5, @defcurrencyid_6, @exchangerate_7, @defunitprice_8, @unitprice_9, @taxrate_10)

GO
alter procedure [LgcConfiguration_SByWebshop] (@assetid  int , @flag integer output , @msg varchar(4000) output)  AS select subassetid,typename from LgcConfiguration ,  LgcAssetRelationType where supassetid = @assetid and relationtypeid = LgcAssetRelationType.id and shopadvice ='1'

GO
alter procedure [LgcConfiguration_Insert] (@supassetid_1 	[int], @subassetid_2 	[int], @relationtypeid_3 	[int], @flag integer output, @msg varchar(4000) output )  AS if @supassetid_1=@subassetid_2 begin select -1 return end INSERT INTO [LgcConfiguration] ( [supassetid], [subassetid], [relationtypeid])  VALUES ( @supassetid_1, @subassetid_2, @relationtypeid_3)

GO
alter procedure [LgcConfiguration_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [LgcConfiguration]  WHERE ( [id]	 = @id_1)

GO
alter procedure [MailUserGroup_UpdateById] ( @mailgroupname  varchar(4000), @operatedesc varchar(4000) , @mailgroupid int, @flag [int]  output, @msg  varchar(4000) output) as update MailUserGroup set mailgroupname=@mailgroupname,operatedesc=@operatedesc WHERE mailgroupid=@mailgroupid

GO
alter procedure [MailUserGroup_SMailgroupname] ( @userid	int, @flag [int]  output, @msg  varchar(4000) output) as select mailgroupname from MailUserGroup where createrid=@userid

GO
alter procedure [MailUserGroup_SelectNameById] ( @mailgroupid int, @flag [int]  output, @msg  varchar(4000) output) as select mailgroupname,operatedesc from MailUserGroup WHERE mailgroupid=@mailgroupid

 GO
alter procedure [MailUserGroup_SelectByUser] ( @userid     int, @flag [int]  output, @msg  varchar(4000) output) as select * from MailUserGroup where createrid=@userid

GO
alter procedure [MailUserGroup_SelectAll] ( @flag [int]  output, @msg  varchar(4000) output) as select * from MailUserGroup

GO
alter procedure [MailUserGroup_Insert] ( @mailgroupname  varchar(4000), @operatedesc varchar(4000) ,				  @createrid   int,		                          @createrdate    char(10) ,			  @flag [int]  output, @msg  varchar(4000) output) as INSERT INTO MailUserGroup  (mailgroupname,operatedesc,createrid,createrdate) VALUES (@mailgroupname,@operatedesc,@createrid,@createrdate)

GO
alter procedure [LgcWebShopDetail_SelectById] @id  int , @flag integer output , @msg varchar(4000) output AS select * from LgcWebShopDetail  where webshopid = @id

GO
alter procedure [LgcWebShopDetail_Insert] (@webshopid_1 	[int], @assetid_2 	[int], @countryid     int , @currencyid_3 	[int], @assetprice 	varchar(4000), @taxrate_5 	[int], @purchasenum_6 	[float], @flag integer output , @msg varchar(4000) output)  AS declare @assetprice_4 	[decimal](18,3) set @assetprice_4 = convert(decimal(18,3) , @assetprice)  INSERT INTO [LgcWebShopDetail] ( [webshopid], [assetid], countryid , [currencyid], [assetprice], [taxrate], [purchasenum])  VALUES ( @webshopid_1, @assetid_2, @countryid , @currencyid_3, @assetprice_4, @taxrate_5, @purchasenum_6)

GO
alter procedure [HrmWorkTimeWarp_Insert] (@diffid_1 	int, @resourceid_2 	int, @diffdate_3 	char(10), @difftype_4 	char(1), @intime_5 	char(5), @outtime_6 	char(5), @theintime_7 	char(5), @theouttime_8 	char(5), @counttime_9 	int, @diffcounttime_10 	int, @flag integer output, @msg varchar(4000) output )  AS INSERT INTO HrmWorkTimeWarp ( diffid, resourceid, diffdate, difftype, intime, outtime, theintime, theouttime, counttime, diffcounttime)  VALUES ( @diffid_1, @resourceid_2, @diffdate_3, @difftype_4, @intime_5, @outtime_6, @theintime_7, @theouttime_8, @counttime_9, @diffcounttime_10)

GO
alter procedure [MailUserShare_SelectbyUserId] (@userid 	[int], @flag	int output, @msg	varchar(4000)	output) as select mailgroupid from MailUserShare where userid=@userid

GO
alter procedure [MailUserShare_DeletebyUserId] (@userid 	[int], @flag	int output, @msg	varchar(4000)	output) as delete from MailUserShare where userid=@userid

GO
alter procedure [MailUserShare_DbyMailgroupId] (@mailgroupid 	[int], @flag	int output, @msg	varchar(4000)	output) as delete from MailUserShare where mailgroupid=@mailgroupid

GO
alter procedure [Prj_ProjectStatus_Update] (@id	 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [Prj_ProjectStatus]  SET  [fullname]	 = @fullname, [description]	 = @description  WHERE ( [id]	 = @id)   set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProjectStatus_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_ProjectStatus] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProjectStatus_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_ProjectStatus] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProjectStatus_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [Prj_ProjectStatus] ( [fullname], [description])  VALUES ( @fullname, @description)   set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProjectStatus_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [Prj_ProjectStatus]  WHERE ( [id]	 = @id)   set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Member_SelectAllPlan] (@prjid [int], @version varchar(4000), @relateid [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT t1.*,t2.wbscoding,t2.subject,t2.id as taskrecordid FROM [Prj_Member] as t1, [Prj_TaskInfo] as t2 WHERE ( t1.prjid	 = @prjid and t1.version like '%|' + @version + '|%' and t1.relateid = @relateid and t2.prjid	 = @prjid and t2.version = @version  and t1.taskid=t2.taskid ) order by t2.wbscoding  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Member_Insert] (@prjid 	[int], @taskid [int], @relateid 	[int], @version varchar(4000), @begindate 	varchar(4000), @enddate varchar(4000), @workday [decimal] (10,1), @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS INSERT INTO [Prj_Member] ( [prjid], [taskid], [relateid], [version], [begindate], [enddate], [workday], [cost])  VALUES ( @prjid , @taskid , @relateid 	, @version, @begindate, @enddate, @workday, @cost ) INSERT INTO [Prj_MemberProcess] ( [prjid], [taskid], [relateid], [isactived])  VALUES ( @prjid , @taskid , @relateid , '0') set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Member_Delete] (@id [int], @version varchar(4000), @flag integer output, @msg varchar(4000) output )  AS update [Prj_Member] set version=replace(version, @version, '')  WHERE ( [id] = @id)  delete [Prj_Member] WHERE ( [id] = @id and version='' )  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Doc_Insert] ( @prjid 		[int], @taskid 	[int], @docid 		[int], @secid 		[int], @flag 		integer output, @msg 		varchar(4000) output )AS INSERT INTO [Prj_Doc] (prjid, taskid, docid, secid) VALUES (@prjid, @taskid, @docid, @secid) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProjectType_Insert] ( @fullname  varchar(4000), @description    varchar(4000), @wfid       int, @protypecode varchar(4000), @insertWorkPlan char(1),@dsporder decimal(10,2),@guid1 char(36), @flag   int output, @msg    varchar(4000) output) AS  INSERT INTO Prj_ProjectType ( fullname, description, wfid, protypecode, insertWorkPlan,dsporder,guid1) VALUES ( @fullname, @description, @wfid, @protypecode, @insertWorkPlan,@dsporder,@guid1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProjectType_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [Prj_ProjectType]  WHERE ( [id]	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Member_SumPlan] (@prjid [int], @version varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT relateid, sum(workday) as workday, min(begindate) as begindate, max(enddate) as enddate, sum(cost*workday) as cost FROM [Prj_Member] WHERE ( prjid	 = @prjid and version like '%|' + @version + '|%' ) group by relateid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskModify_Insert] @projectid_1 int   , @taskid_1 int    , @fieldname_1 varchar(4000)    , @modifydate_1 varchar(4000)    , @modifytime_1 varchar(4000)    , @original_1 varchar(4000)    , @modified_1 varchar(4000)    , @modifier_1 int   , @clientip_1 char (15)    , @submitertype_1 tinyint  , @logtype_1 char(1), @flag integer output, @msg varchar(4000) output as insert INTO Task_Modify( projectid  , taskid   , fieldname   , modifydate  , modifytime   , original  , modified   , modifier   , clientip  , submitertype , logtype ) values( @projectid_1    , @taskid_1      , @fieldname_1     , @modifydate_1     , @modifytime_1   , @original_1    , @modified_1   , @modifier_1     , @clientip_1     , @submitertype_1 , @logtype_1 )

GO
alter procedure [Prj_TaskLog_Insert] @projectid_1 int, @taskid_1 int  , @logtype_1 char(2)  , @submitdate_1 varchar(4000)    , @submittime_1 varchar(4000)    , @submiter_1 int  , @clientip_1 char(15)  , @submitertype_1 tinyint  , @flag integer output, @msg varchar(4000) output as insert INTO Task_Log ( projectid , taskid , logtype , submitdate   , submittime  , submiter   , clientip   , submitertype ) values( @projectid_1 , @taskid_1 , @logtype_1 , @submitdate_1  , @submittime_1  , @submiter_1 , @clientip_1 , @submitertype_1 )

GO
alter procedure [Prj_TaskInfo_Update] (@id	[int], @wbscoding varchar(4000), @subject 	varchar(4000) , @begindate 	varchar(4000), @enddate 	varchar(4000), @workday [decimal] (10,1), @content 	varchar(4000), @fixedcost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS UPDATE [Prj_TaskInfo]  SET  wbscoding = @wbscoding, subject = @subject , begindate = @begindate, enddate = @enddate 	, workday = @workday, content = @content, fixedcost = @fixedcost  WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskInfo_SumCostTool] (@prjid [int], @version varchar(4000), @wbscoding varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT sum(t2.workday*t2.cost) as cost FROM [Prj_TaskInfo] as t1, [Prj_Tool] as t2 WHERE ( t1.prjid	 = @prjid and t1.version	 = @version and  t1.wbscoding like @wbscoding+'%' and t1.taskid = t2.taskid and t2.prjid = @prjid  and t2.version like '%|' + @version + '|%' ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskInfo_SumCostMember] (@prjid [int], @version varchar(4000), @wbscoding varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT sum(t2.workday*t2.cost) as cost FROM [Prj_TaskInfo] as t1, [Prj_Member] as t2 WHERE ( t1.prjid	 = @prjid and t1.version	 = @version and  t1.wbscoding like @wbscoding+'%' and t1.taskid = t2.taskid and t2.prjid = @prjid  and t2.version like '%|' + @version + '|%' ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_SearchMould_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from Prj_SearchMould where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [Prj_SearchMould_Insert] (@mouldname_1 	varchar(4000), @userid_2 	[int], @prjid_3 	varchar(4000), @status_4 	varchar(4000), @prjtype_5 	varchar(4000), @worktype_6 	[int], @nameopt_7 	[int], @name_8 	varchar(4000), @description_9 	varchar(4000), @customer_10 	[int], @parent_11 	[int], @securelevel_12 	[int], @department_13 	[int], @manager_14 	[int], @member_15 	[int],@procode_16 varchar(4000), @flag integer output, @msg varchar(4000) output )  AS INSERT INTO [Prj_SearchMould] ( [mouldname], [userid], [prjid], [status], [prjtype], [worktype], [nameopt], [name], [description], [customer], [parent], [securelevel], [department], [manager], [member],[procode])  VALUES ( @mouldname_1, @userid_2, @prjid_3, @status_4, @prjtype_5, @worktype_6, @nameopt_7, @name_8, @description_9, @customer_10, @parent_11, @securelevel_12, @department_13, @manager_14, @member_15,@procode_16) select max(id) from [Prj_SearchMould] if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [Prj_SearchMould_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [Prj_SearchMould]  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [Prj_ProjectType_Update] ( @id	 	int, @fullname 	varchar(4000), @description 	varchar(4000), @protypecode varchar(4000), @wfid	 	int, @insertWorkPlan char(1),@dsporder decimal(10,2), @flag	int	output, @msg	varchar(4000)	output )  AS UPDATE Prj_ProjectType SET  fullname	 = @fullname, description	 = @description, wfid	 = @wfid ,protypecode=@protypecode, insertWorkPlan=@insertWorkPlan,dsporder=@dsporder WHERE ( id	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_SaveAsTemplet] (  @isSelected	char(1), @templetName 	varchar(4000), @proTypeId	int, @workTypeId	int, @proMember	varchar(4000), @isMemberSee	char(1), @proCrm		varchar(4000), @isCrmSee	char(1), @parentProId	int, @commentDoc	int, @confirmDoc	int, @adviceDoc	int, @Manager	int, @relationXml	text, @status		char(1),   @datefield1_39 	varchar(4000), @datefield2_40 	varchar(4000), @datefield3_41 	varchar(4000), @datefield4_42 	varchar(4000), @datefield5_43 	varchar(4000), @numberfield1_44 	float, @numberfield2_45 	float, @numberfield3_46 	float, @numberfield4_47 	float, @numberfield5_48 	float, @textfield1_49 	varchar(4000), @textfield2_50 	varchar(4000), @textfield3_51 	varchar(4000), @textfield4_52 	varchar(4000), @textfield5_53 	varchar(4000), @boolfield1_54 	tinyint, @boolfield2_55 	tinyint, @boolfield3_56 	tinyint, @boolfield4_57 	tinyint, @boolfield5_58 	tinyint,  @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO Prj_Template (  isSelected, templetName, proTypeId, workTypeId, proMember, isMemberSee, proCrm, isCrmSee, parentProId, commentDoc, confirmDoc, adviceDoc, Manager, relationXml, status,   datefield1, datefield2, datefield3, datefield4, datefield5, numberfield1, numberfield2, numberfield3, numberfield4, numberfield5, textfield1, textfield2, textfield3,textfield4, textfield5, tinyintfield1, tinyintfield2, tinyintfield3, tinyintfield4, tinyintfield5 )VALUES(  @isSelected	, @templetName 	, @proTypeId	, @workTypeId	, @proMember	, @isMemberSee	, @proCrm		, @isCrmSee	, @parentProId	, @commentDoc	, @confirmDoc	, @adviceDoc	, @Manager	, @relationXml, @status,   @datefield1_39, @datefield2_40, @datefield3_41, @datefield4_42, @datefield5_43, @numberfield1_44, @numberfield2_45, @numberfield3_46, @numberfield4_47, @numberfield5_48, @textfield1_49, @textfield2_50, @textfield3_51, @textfield4_52, @textfield5_53, @boolfield1_54, @boolfield2_55, @boolfield3_56, @boolfield4_57, @boolfield5_58 )  set @flag = @@identity

GO
alter procedure [Prj_MaterialProcess_Update] (@id [int],  @material 	 varchar(4000), @unit 	 varchar(4000),  @begindate 	varchar(4000), @enddate varchar(4000), @quantity [int], @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS update [Prj_MaterialProcess] set material=@material, begindate=@begindate, enddate=@enddate, unit=@unit, quantity=@quantity, cost=@cost  WHERE ( [id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_MaterialProcess_Insert] (@prjid 	[int], @taskid [int], @material 	 varchar(4000), @unit 	 varchar(4000), @isactived [tinyint], @begindate 	varchar(4000), @enddate varchar(4000), @quantity [int], @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS INSERT INTO [Prj_MaterialProcess] ( [prjid], [taskid], [material], [unit], [isactived], [begindate], [enddate], [quantity], [cost])  VALUES ( @prjid , @taskid , @material 	, @unit 	, @isactived, @begindate, @enddate, @quantity, @cost ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_MaterialProcess] (@prjid 	[int], @taskid [int] ,  @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_MaterialProcess] WHERE ([prjid] = @prjid and [taskid] = @taskid  and ( [isactived] = '2' or [isactived] = '3' )) order by material  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_Materialbyid] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_Material] WHERE ([id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_Material] (@prjid 	[int], @taskid [int] , @version varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_Material] WHERE ([prjid] = @prjid and [taskid] = @taskid and [version] like '%' + @version + '%' ) order by material  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [PRJ_Find_LastModifier] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT top 1 submiter,submitdate from [Prj_Log] WHERE ([projectid] = @id) and (not ([logtype] = 'n')) ORDER BY submitdate DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_Customer] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_Customer] WHERE ([prjid] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Member_Update] (@id [int], @version varchar(4000), @prjid 	[int], @taskid [int], @relateid 	[int],  @begindate 	varchar(4000), @enddate varchar(4000), @workday [decimal] (10,1), @cost [decimal] (10,2), @flag integer output, @msg varchar(4000) output )  AS update [Prj_Member] set version=replace(version, @version, '')  WHERE ( [id] = @id)  delete [Prj_Member] WHERE ( [id] = @id and version='' ) INSERT INTO [Prj_Member] ( [prjid], [taskid], [relateid], [version], [begindate], [enddate], [workday], [cost])  VALUES ( @prjid , @taskid , @relateid 	, @version, @begindate, @enddate, @workday, @cost ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Customer_Update] (@id 	[int], @customerid 	[int], @powerlevel 	[tinyint], @reasondesc	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS Update [Prj_Customer] set customerid=@customerid, powerlevel=@powerlevel, reasondesc=@reasondesc  where id=@id set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Customer_Insert] (@prjid 	[int], @taskid 	[int], @customerid 	[int], @powerlevel 	[tinyint], @reasondesc	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [Prj_Customer] ( [prjid], [taskid], [customerid], [powerlevel], [reasondesc])  VALUES ( @prjid, @taskid, @customerid, @powerlevel, @reasondesc)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Customer_FindByTaskID] (@prjid 	[int], @taskid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_Customer] WHERE ( prjid	 = @prjid and taskid = @taskid ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Customer_FindByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_Customer] WHERE ( id	 = @id ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Customer_DeleteByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Prj_Customer] WHERE ( id = @id ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Cpt_Insert] (@prjid 	[int], @taskid 	[int], @requestid [int], @flag integer output, @msg varchar(4000) output  )  AS INSERT INTO [Prj_Cpt] ( prjid, taskid, requestid)  VALUES ( @prjid, @taskid, @requestid) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [PhotoSequence_Get]( @indexdesc varchar(4000), @flag int output, @msg varchar(4000) output) as declare @id_1 integer select @id_1=currentid from SequenceIndex where indexdesc=@indexdesc update SequenceIndex set currentid = @id_1-1 where indexdesc=@indexdesc select @id_1

GO
alter procedure [PhotoComments_SelectAll]( @flag int output, @msg varchar(4000) output ) AS SELECT * FROM AlbumPhotoReview SET @flag = 1 SET @msg = 'OK!'

GO
alter procedure [PersonalHPDesign_Update2] (@hrmid 	int, @homepageid    int, @orderid 	int, @flag integer output, @msg varchar(4000) output)  AS update PersonalHomePageDesign set orderid=@orderid , ischecked = 0 where hrmid = @hrmid and homepageid = @homepageid

GO
alter procedure [PersonalHPDesign_Update1] (@hrmid 	int, @flag integer output, @msg varchar(4000) output)  AS update PersonalHomePageDesign set orderid=0 , ischecked = 1 where hrmid = @hrmid

GO
alter procedure [PersonalHPDesign_Duplicate] (@hrmid 	int, @flag integer output, @msg varchar(4000) output)  AS declare @homepageid	int, @orderid   int set @orderid = 0 declare homepageid_cursor cursor for select id from HomePageDesign order by id  open homepageid_cursor fetch next from homepageid_cursor into @homepageid while @@fetch_status=0 begin set @orderid = @orderid + 1 INSERT INTO PersonalHomePageDesign values(@homepageid , @hrmid , @orderid, 0) fetch next from homepageid_cursor into @homepageid end close homepageid_cursor deallocate homepageid_cursor select * from PersonalHomePageDesign where hrmid = @hrmid order by orderid

GO
alter procedure [Meeting_TopicDoc_Insert] (@meetingid [int] , @topicid [int] , @docid [int], @hrmid [int], @flag integer output, @msg varchar(4000) output) AS INSERT INTO [Meeting_TopicDoc] ( [meetingid] ,[topicid] ,[docid],[hrmid])  VALUES ( @meetingid , @topicid, @docid, @hrmid) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_TopicDoc_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting_TopicDoc] WHERE ( id = @id ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [MeetingRoom_SelectAll] ( @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [MeetingRoom] order by id

GO
alter procedure [MeetingRoom_Insert] (@name_1 varchar(4000) , @roomdesc_1 varchar(4000) , @hrmid_1 int , @subcompanyid int,  @flag	int 	output, @msg	varchar(4000)	output) AS  INSERT INTO MeetingRoom (name , roomdesc , hrmid,subcompanyid ) VALUES (@name_1, @roomdesc_1, @hrmid_1, @subcompanyid)

GO
alter procedure [MeetingRoom_DeleById] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [MeetingRoom] WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmDepartmentVirtual_Select] @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT AS SELECT  * FROM    HrmDepartmentVirtual ORDER BY showorder ASC, id desc SET @flag = 0 SET @msg = '操作成功完成'

GO
alter procedure [Meeting_Topic_Update] (@id    int, @hrmid [int] , @subject varchar(4000) , @hrmids varchar(4000) , @projid int, @crmid  varchar(4000), @isopen [tinyint], @flag integer output, @msg varchar(4000) output) AS update [Meeting_Topic] set hrmid=@hrmid ,subject=@subject,hrmids=@hrmids,projid=@projid,crmids=@crmid,isopen=@isopen where id=@id set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Topic_SelectAll] ( @meetingid [int],  @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Meeting_Topic] where meetingid = @meetingid ORDER BY id set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [Meeting_Topic_Insert] (@meetingid [int] , @hrmid [int] , @subject varchar(4000) , @hrmids varchar(4000) , @projid int, @crmid  varchar(4000), @isopen [tinyint], @flag integer output, @msg varchar(4000) output) AS  INSERT INTO [Meeting_Topic] ( [meetingid] ,[hrmid] ,[subject],[hrmids], [isopen],projid,crmids) VALUES ( @meetingid , @hrmid, @subject , @hrmids, @isopen,@projid,@crmid) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Topic_Delete] (@meetingid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting_Topic] WHERE ( meetingid = @meetingid ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [MeetingCaller_SByMeeting] @meetingtype int, @flag integer output , @msg varchar(4000) output as select * from MeetingCaller where meetingtype=@meetingtype

GO
alter procedure [MeetingCaller_Insert] @meetingtype int, @callertype  int, @seclevel    int, @rolelevel   int, @userid      int, @departmentid      int, @roleid      int, @foralluser  int, @flag integer output , @msg varchar(4000) output as insert into MeetingCaller(meetingtype,callertype,seclevel,rolelevel,userid,departmentid,roleid,foralluser) values (@meetingtype,@callertype,@seclevel,@rolelevel,@userid,@departmentid,@roleid,@foralluser)

GO
alter procedure [MeetingCaller_Delete] @id int, @flag integer output , @msg varchar(4000) output as delete from MeetingCaller where id=@id

GO
alter procedure [Meeting_TopicDate_SelectAll] ( @meetingid [int], @topicid [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM Meeting_TopicDate where meetingid = @meetingid and topicid = @topicid  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_TopicDate_Insert] (@meetingid [int] , @topicid [int] , @begindate varchar(4000)  , @begintime varchar(4000)  , @enddate varchar(4000)  ,	@endtime varchar(4000)  , @flag integer output, @msg varchar(4000) output) AS INSERT INTO [Meeting_TopicDate] ( [meetingid] ,[topicid] ,[begindate],[begintime],[enddate],[endtime])  VALUES ( @meetingid , @topicid, @begindate , @begintime  , @enddate , @endtime ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_TopicDate_Delete] (@meetingid [int], @topicid [int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting_TopicDate] WHERE ( meetingid = @meetingid and topicid = @topicid ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmProvince_Update] (@id_1 	[int], @provincename_2 	varchar(4000), @provincedesc_3 	varchar(4000), @countryid_4 [int] , @flag integer output, @msg varchar(4000) output )  AS UPDATE [HrmProvince]  SET  [provincename]	 = @provincename_2, [provincedesc]	 = @provincedesc_3, [countryid] = @countryid_4  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmProvince_Select] @countryid_1 int , @flag integer output , @msg varchar(4000) output AS if @countryid_1 = 0 begin select * from HrmProvince end else begin select * from HrmProvince where countryid = @countryid_1 end set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmProvince_Insert] (@provincename_1 	varchar(4000), @provincedesc_2 	varchar(4000), @countryid_3 [int], @flag integer output, @msg varchar(4000) output ) AS declare @maxid	int select @maxid=max(id)+1 from HrmProvince INSERT INTO [HrmProvince] ([id], [provincename], [provincedesc],[countryid]) VALUES (@maxid, @provincename_1, @provincedesc_2, @countryid_3) select max(id) from [HrmProvince] if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmProvince_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [HrmProvince]  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

 GO
alter procedure [HrmPlanColor_Update] (@resourceid	int, @basictype		int, @colorid1		varchar(4000), @colorid2		varchar(4000), @flag integer output, @msg varchar(4000) output) AS declare @count	int select @count=count(*) from HrmPlancolor where resourceid=@resourceid and basictype=@basictype if	@count=0 begin insert into hrmplancolor (resourceid,basictype,colorid1,colorid2) values(@resourceid,@basictype,@colorid1,@colorid2) end else begin update hrmplancolor set colorid1=@colorid1 ,colorid2=@colorid2 where resourceid=@resourceid and basictype=@basictype end

GO
alter procedure [HrmPlanColor_SelectByID] (@resourceid	int, @flag integer output, @msg varchar(4000) output) AS select * from hrmplancolor where resourceid=@resourceid

 GO
alter procedure [HrmInterviewResult_Insert] (@resourceid_1 	[int], @stepid_2 	[int], @result_3 	int, @remark_4 	text, @userid_5 	int, @testdate_6 	char(10), @flag int output, @msg varchar(4000) output) AS INSERT INTO [HrmInterviewResult] ([resourceid], [stepid], [result], [remark], [tester], [testdate]) VALUES (@resourceid_1, @stepid_2, @result_3, @remark_4, @userid_5, @testdate_6)  update HrmInterview set status = 1 WHERE ResourceID=@resourceid_1 and StepID = @stepid_2

GO
alter procedure [HrmOtherInfoType_Update] (@id	int, @typename	varchar(4000), @typeremark	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output ) AS update hrmotherinfotype set typename=@typename,typeremark=@typeremark where id=@id  if @@error<>0 begin set @flag=1 set @msg='y' return end else begin set @flag=0 set @msg='n' return end

GO
alter procedure [HrmOtherInfoType_SelectAll] (  @flag                             integer output, @msg                             varchar(4000) output ) AS select * from HrmOtherInfoType order by id  if @@error<>0 begin set @flag=1 set @msg='查询人力资源信息成功' return end else begin set @flag=0 set @msg='查询人力资源信息失败' return end

GO
alter procedure [HrmOtherInfoType_Insert] ( @typename	varchar(4000), @typeremark	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output ) AS INSERT INTO hrmotherinfotype values(@typename,@typeremark)  select max(id) from hrmotherinfotype  if @@error<>0 begin set @flag=1 set @msg='y' return end else begin set @flag=0 set @msg='n' return end

GO
alter procedure [HrmOtherInfoType_Delete] (@id	int, @flag                             integer output, @msg                             varchar(4000) output ) AS delete from hrmotherinfotype where id=@id  if @@error<>0 begin set @flag=1 set @msg='right' return end else begin set @flag=0 set @msg='wrong' return end

GO
alter procedure [HrmJobCall_Select] @flag integer output , @msg varchar(4000) output  AS select * from HrmJobCall set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmJobCall_Insert] (@name_1 	varchar(4000), @description_2 	varchar(4000), @flag integer output, @msg varchar(4000) output) AS INSERT INTO [HrmJobCall] ( [name], [description])  VALUES ( @name_1, @description_2)

GO
alter procedure [HrmJobCall_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmJobCall]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmJobActivities_Update] (@id_1	[int], @jobactivitymark_2 varchar(4000), @jobactivityname_3 varchar(4000), @joblevelfrom_4 [int], @joblevelto_5 int, @jobgroupid_6 	[int], @flag integer output, @msg varchar(4000) output ) AS UPDATE [HrmJobActivities]  SET  [jobactivitymark]	= @jobactivitymark_2, [jobactivityname]	 = @jobactivityname_3, [joblevelfrom]	 = @joblevelfrom_4, [joblevelto]	 = @joblevelto_5, [jobgroupid]	 = @jobgroupid_6 WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmJobActivities_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmJobActivities where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmJobActivities_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmJobActivities set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmJobActivities_Insert] (@jobactivitymark_1 	varchar(4000), @jobactivityname_2 	varchar(4000), @joblevelfrom_3	[int], @joblevelto_4 	int, @jobgroupid_5 	[int], @flag integer output, @msg varchar(4000) output ) AS INSERT INTO [HrmJobActivities] ( [jobactivitymark], [jobactivityname], [joblevelfrom], [joblevelto], [jobgroupid]) VALUES ( @jobactivitymark_1, @jobactivityname_2, @joblevelfrom_3, @joblevelto_4, @jobgroupid_5) select max(id) from  [HrmJobActivities] if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmJobActivities_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [HrmJobActivities]  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmInterviewAssess_Insert] (@resourceid_1 	[int], @stepid_2 	[int], @result_3 	int, @remark_4 	text, @userid_5 	int, @assessdate_6 	char(10), @flag int output, @msg varchar(4000) output) AS INSERT INTO [HrmInterviewAssess] ([resourceid], [stepid], [result], [remark], [assessor], [assessdate]) VALUES (@resourceid_1, @stepid_2, @result_3, @remark_4, @userid_5, @assessdate_6)

GO
alter procedure [HrmInterviewAssess_Delete] (@id_1 	[int], @stepid_2 int, @userid_3 int, @flag int output, @msg varchar(4000) output)  AS DELETE from [HrmInterviewAssess] WHERE [resourceid]	 = @id_1 and stepid = @stepid_2 and assessor = @userid_3

GO
alter procedure [HrmInterview_Insert] (@resourceid_1 	[int], @stepid_2 	[int], @date_3 	[char](10), @time_4 	[char](8), @address_5 	varchar(4000), @notice_6 	[text], @interviewer_8 	varchar(4000), @flag int output, @msg varchar(4000) output) AS INSERT INTO [HrmInterview] ( [resourceid], [stepid], [date_n], [time], [address], [notice], [interviewer]) VALUES (@resourceid_1, @stepid_2, @date_3, @time_4, @address_5, @notice_6, @interviewer_8)

GO
alter procedure [HrmInterview_Delete] (@id_1 	[int], @stepid_2 int, @flag int output, @msg varchar(4000) output)  AS DELETE from [HrmInterview] WHERE [resourceid]	 = @id_1 and stepid = @stepid_2

GO
alter procedure [HrmInfoStatus_UpdateSystem] (@id_1 int, @flag int output, @msg varchar(4000) output) as update HrmInfoStatus set status = 1 where itemid = 1 and hrmid = @id_1

GO
alter procedure [HrmInfoStatus_UpdateFinance] (@id_1 int, @flag int output, @msg varchar(4000) output) as update HrmInfoStatus set status = 1 where itemid = 2 and hrmid = @id_1

GO
alter procedure [HrmInfoStatus_UpdateCapital] (@id_1 int, @flag int output, @msg varchar(4000) output) as update HrmInfoStatus set status = 1 where itemid = 3 and hrmid = @id_1

GO
alter procedure [HrmInfoStatus_Finish] (@id_1 int, @flag int output, @msg varchar(4000) output) as update HrmInfoStatus set status = 1 where hrmid = @id_1

GO
alter procedure [SystemRightGroups_Insert] @mark varchar(4000), @description varchar(4000), @notes text, @flag int output, @msg varchar(4000) output as begin insert systemrightgroups(rightgroupmark,rightgroupname,rightgroupremark) values(@mark,@description,@notes) select max(id) from systemrightgroups if @@error<>0 begin set @flag=1 set @msg='插入失败' end else begin set @flag=0 set @msg='操作成功' end select @flag,@msg end

GO
alter procedure [HrmSalaryComponent_Update] @id	int, @componentname	varchar(4000), @countryid                   int, @jobactivityid              int, @componenttype	char(1), @componentperiod	char(1), @currencyid	int, @ledgerid	int, @docid		int, @startdate	char(10), @enddate	char(10), @includetex	char(1), @componenttypeid	int, @flag                              integer output, @msg                             varchar(4000) output  AS if @countryid=0		set @countryid=null if @currencyid=0	set @currencyid=null if @docid=0		set @docid=null  update [HrmSalaryComponent] set 	componentname=@componentname, countryid=@countryid, jobactivityid=@jobactivityid, componenttype=@componenttype, componentperiod=@componentperiod, currencyid=@currencyid, ledgerid=@ledgerid, docid=@docid, startdate=@startdate, enddate=@enddate, includetex=@includetex, componenttypeid=@componenttypeid where id=@id  if @@error<>0 begin set @flag=1 set @msg='操作失败' return end else begin set @flag=0 set @msg='操作成功' return end

GO
alter procedure [HrmSalaryComponent_SelectByID] @id   int, @flag integer output , @msg varchar(4000) output AS select t1.* from HrmSalaryComponent t1 where  t1.id= @id set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmResourceOtherInfo_Insert] (@resourceid_1 	[int], @infoname_2 	varchar(4000), @startdate_3 	[char](10), @enddate_4 	[char](10), @docid_5 	[int], @inforemark_6 	[text], @infotype_7 	[int], @seclevel_8 	[tinyint], @createid_9 	[int], @createdate_10 	[char](10), @flag int output, @msg varchar(4000) output)  AS if @docid_5 =0 set  @docid_5 = null INSERT INTO [HrmResourceOtherInfo] ( [resourceid], [infoname], [startdate], [enddate], [docid], [inforemark], [infotype], [seclevel], [createid], [createdate])  VALUES ( @resourceid_1, @infoname_2, @startdate_3, @enddate_4, @docid_5, @inforemark_6, @infotype_7, @seclevel_8, @createid_9, @createdate_10)

GO
alter procedure [HrmResourceOtherInfo_Delete] (@id_1 	[int], @flag int output, @msg varchar(4000) output)  AS DELETE [HrmResourceOtherInfo]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmResourceCompetency_Update] (@resourceid_1 	[int], @competencyid_2 	[int], @currentgrade_3 	[real], @currentdate_4 	[char](10), @flag                             integer output, @msg                             varchar(4000) output )  AS DECLARE @recordercount integer Select @recordercount = count(id) from HrmResourceCompetency where resourceid = @resourceid_1 and competencyid = @competencyid_2  if @recordercount = 0 begin INSERT INTO [HrmResourceCompetency] ( [resourceid], [competencyid], [currentgrade], [currentdate], [countgrade], [counttimes])  VALUES ( @resourceid_1, @competencyid_2, @currentgrade_3, @currentdate_4, @currentgrade_3, 1) end else begin Update [HrmResourceCompetency] set countgrade = countgrade - currentgrade + @currentgrade_3, currentgrade = @currentgrade_3 where resourceid = @resourceid_1 and competencyid = @competencyid_2 end

GO
alter procedure [HrmResourceCompetency_SByID] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from HrmResourceCompetency where resourceid = @id_1 if @@error<>0 begin set @flag=1 set @msg='查询人力资源技能信息成功' return end else begin set @flag=0 set @msg='查询人力资源技能信息失败' return end

GO
alter procedure [HrmResourceCompetency_Insert] (@resourceid_1 	[int], @competencyid_2 	[int], @currentgrade_3 	[real], @currentdate_4 	[char](10), @flag                             integer output, @msg                             varchar(4000) output )  AS DECLARE @recordercount integer Select @recordercount = count(id) from HrmResourceCompetency where resourceid = @resourceid_1 and competencyid = @competencyid_2  if @recordercount = 0 begin INSERT INTO [HrmResourceCompetency] ( [resourceid], [competencyid], [currentgrade], [currentdate], [countgrade], [counttimes])  VALUES ( @resourceid_1, @competencyid_2, @currentgrade_3, @currentdate_4, @currentgrade_3, 1) end else begin Update [HrmResourceCompetency] set lastgrade = currentgrade , lastdate = currentdate, currentgrade = @currentgrade_3, currentdate = @currentdate_4, countgrade = countgrade + @currentgrade_3, counttimes = counttimes+1 where resourceid = @resourceid_1 and competencyid = @competencyid_2 end

GO
alter procedure [HrmResourceMaxId_Get] (@flag int output, @msg varchar(4000) output) as declare @id_1 integer select @id_1=currentid from SequenceIndex where indexdesc='resourceid' update SequenceIndex set currentid = @id_1+1 where indexdesc='resourceid' select @id_1

GO
alter procedure [Bill_HrmResourceAbsense_UStat] (@id [int], @usestatus char(1) ,@flag integer output , @msg varchar(4000) output) AS update Bill_HrmResourceAbsense set usestatus = @usestatus where id=@id

GO
alter procedure [Bill_HrmResourceAbsense_SByW] (@flag integer output , @msg varchar(4000) output) AS select distinct workflowid , workflowname from Bill_HrmResourceAbsense

GO
alter procedure [Bill_HrmResourceAbsense_SByID] (@id [int], @flag integer output , @msg varchar(4000) output) AS select *  from Bill_HrmResourceAbsense where id=@id

GO
alter procedure [HrmAbsense1_Insert] (@departmentid_1 	[int], @resourceid_2 	[int], @absenseremark_3 	[text], @startdate_4 	[char](10), @starttime_5 	[char](8), @enddate_6 	[char](10), @endtime_7 	[char](8), @absenseday_8 	[decimal](10,2), @workflowid_9 	[int], @workflowname_10 	varchar(4000), @usestatus_11 	[char](1), @flag                   integer output, @msg                   varchar(4000) output )  AS INSERT INTO [Bill_HrmResourceAbsense] ( [departmentid], [resourceid], [absenseremark], [startdate], [starttime], [enddate], [endtime], [absenseday], [workflowid], [workflowname], [usestatus])  VALUES ( @departmentid_1, @resourceid_2, @absenseremark_3, @startdate_4, @starttime_5, @enddate_6, @endtime_7, @absenseday_8, @workflowid_9, @workflowname_10, @usestatus_11)

GO
alter procedure [HrmAbsense1_Delete] (@id_1 	[int], @flag                   integer output, @msg                   varchar(4000) output )  AS DELETE [Bill_HrmResourceAbsense]  WHERE ( [id]	 = @id_1)

GO
alter procedure [hrm_selectitembyid_new] @id varchar(4000) , @isbill varchar(4000) , @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT AS SELECT  * FROM    hrm_SelectItem WHERE   fieldid = @id AND ( cancel != '1' OR cancel IS NULL ) ORDER BY listorder , id SET @flag = 0 SET @msg = ''

GO
alter procedure [GetMaxId_PRO] (@type varchar(4000), @flag int output, @msg varchar(4000) output) as declare @id_1 integer select @id_1=currentid from SequenceIndex where indexdesc= @type update SequenceIndex set currentid = @id_1+1 where indexdesc= @type select @id_1

GO
alter procedure [HrmUseDemand_Update] (@jobtitle_1 int, @status_2 int, @demandnum_3 int, @demandkind_4 int, @leaseedulevel_5 int, @date_6 char(10), @otherrequest_7 text, @id_8 int, @department_9 int, @flag int output, @msg varchar(4000) output) as update HrmUseDemand set demandjobtitle = @jobtitle_1, status = @status_2, demandnum = @demandnum_3, demandkind = @demandkind_4, leastedulevel = @leaseedulevel_5, demandregdate = @date_6, otherrequest = @otherrequest_7, demanddep = @department_9 where id = @id_8

GO
alter procedure [HrmUseDemand_Insert] (@demandjobtitle_1 	[int], @demandnum_2 	[int], @demandkind_3 	[int], @leastedulevel_4 	[int], @demandregdate_5 	[char](10), @otherrequest_6 	[text], @refermandid_7 	[int], @referdate_8 	[char](10), @createkind_9 	[int], @department_10 int, @flag int output, @msg varchar(4000) output) AS INSERT INTO HrmUseDemand ([demandjobtitle], [demandnum], [demandkind], [leastedulevel], [demandregdate], [otherrequest], [refermandid], [referdate], [createkind], demanddep) VALUES (@demandjobtitle_1, @demandnum_2, @demandkind_3, @leastedulevel_4, @demandregdate_5, @otherrequest_6, @refermandid_7, @referdate_8, @createkind_9, @department_10)

GO
alter procedure [HrmUseDemand_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) as delete HrmUseDemand where id = @id_1

GO
alter procedure [HrmUseDemand_Close] (@id_1 int, @flag int output, @msg varchar(4000) output) as update HrmUseDemand set status = 4 where id = @id_1

GO
alter procedure [HrmTrainType_Update] (@id_1 int, @name_2 varchar(4000), @description_3 varchar(4000), @typecontent_4 text , @typeaim_5 text , @typedocurl_6 varchar(4000) , @typetesturl_7 varchar(4000) , @typeoperator_8 varchar(4000) , @flag int output, @msg varchar(4000) output ) AS UPDATE HrmTrainType SET name = @name_2, description = @description_3, typecontent = @typecontent_4, typeaim = @typeaim_5, typedocurl = @typedocurl_6, typetesturl = @typetesturl_7, typeoperator = @typeoperator_8 WHERE id = @id_1

GO
alter procedure [HrmTrainType_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmTrainType where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmTrainType_Select] @flag integer output , @msg varchar(4000) output  AS select * from HrmTrainType set  @flag = 0 set  @msg = '操作成功完成'

 GO
alter procedure [HrmTrainType_Insert] (@name_2 varchar(4000), @description_3 varchar(4000), @typecontent_4 text , @typeaim_5 text , @typedocurl_6 varchar(4000) , @typetesturl_7 varchar(4000) , @typeoperator_8 varchar(4000) , @flag int output, @msg varchar(4000) output) AS INSERT into HrmTrainType ( name, description , typecontent , typeaim , typedocurl , typetesturl, typeoperator) VALUES ( @name_2, @description_3, @typecontent_4, @typeaim_5, @typedocurl_6, @typetesturl_7, @typeoperator_8) select max(id) from HrmTrainType

GO
alter procedure [HrmTrainType_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output )  AS DELETE [HrmTrainType]  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_includepages_SelectByID] @id	int, @flag integer output , @msg varchar(4000) output AS select * from workflow_bill where id=@id

GO
alter procedure [bill_HrmTime_UpdateStatus] (@id		int, @status	char(1), @flag integer output, @msg varchar(4000) output) AS update bill_hrmtime set status=@status where id=@id

GO
alter procedure [bill_HrmTime_UpdateRemind] @id	int, @isremind        int, @flag integer output , @msg varchar(4000) output AS Update bill_hrmtime set isremind=@isremind where id=@id

 GO
alter procedure [bill_HrmTime_Update] (@id		int, @resourceid 	int, @requestid 	int, @billid 	int, @basictype 	int, @detailtype 	int, @begindate 	char(10), @begintime 	char(8), @enddate 	char(10), @endtime 	char(5), @name	 	varchar(4000), @description 	varchar(4000), @remark 	text, @totaldays 	int, @totalhours	bigint, @progress	decimal(8,3), @projectid	int, @crmid		int, @docid		int, @relatedrequestid	int, @customizeint1	int, @customizeint2	int, @customizeint3	int, @customizefloat1	decimal(8,3), @customizestr1	varchar(4000), @customizestr2 varchar(4000), @flag integer output, @msg varchar(4000) output) AS update bill_hrmtime set resourceid=@resourceid, requestid=@requestid, billid=@billid, basictype=@basictype, detailtype=@detailtype, begindate=@begindate, begintime=@begintime, enddate=@enddate, endtime=@endtime, name=@name, description=@description, remark=@remark, totaldays=@totaldays, totalhours=@totalhours, progress=@progress, projectid=@projectid, crmid=@crmid, docid=@docid, relatedrequestid=@relatedrequestid, customizeint1=@customizeint1, customizeint2=@customizeint2, customizeint3=@customizeint3, customizefloat1=@customizefloat1, customizestr1=@customizestr1, customizestr2=@customizestr2 where id=@id

GO
alter procedure [bill_HrmTime_SelectByID] (@id 	int, @flag integer output, @msg varchar(4000) output) AS select * from bill_hrmtime where id=@id

GO
alter procedure [bill_HrmTime_Insert] (@resourceid 	int, @requestid 	int, @billid 	int, @basictype 	int, @detailtype 	int, @begindate 	char(10), @begintime 	char(8), @enddate 	char(10), @endtime 	char(5), @name	 	varchar(4000), @description 	varchar(4000), @remark 	text, @totaldays 	int, @totalhours	bigint, @progress	decimal(8,3), @projectid	int, @crmid		int, @docid		int, @relatedrequestid	int, @status	char(1), @customizeint1	int, @customizeint2	int, @customizeint3	int, @customizefloat1	decimal(8,3), @customizestr1	varchar(4000), @customizestr2	varchar(4000), @flag integer output, @msg varchar(4000) output) AS  INSERT INTO bill_hrmtime (resourceid,requestid,billid,basictype,detailtype, begindate,begintime,enddate,endtime, name,description,remark,totaldays,totalhours, progress,projectid,crmid,docid, relatedrequestid,status,customizeint1,customizeint2,customizeint3, customizefloat1,customizestr1,customizestr2) VALUES (@resourceid,@requestid,@billid,@basictype,@detailtype, @begindate,@begintime,@enddate,@endtime, @name,@description,@remark,@totaldays,@totalhours, @progress,@projectid,@crmid,@docid, @relatedrequestid,@status,@customizeint1,@customizeint2,@customizeint3, @customizefloat1,@customizestr1,@customizestr2)  select max(id) from bill_hrmtime

GO
alter procedure [bill_itemusage_UpdateStatus] (@id [int], @usestatus char(1) ,@flag integer output , @msg varchar(4000) output) AS update bill_itemusage set usestatus = @usestatus where id=@id

GO
alter procedure [bill_itemusage_Select] @id	int, @flag integer output , @msg varchar(4000) output AS select * from bill_itemusage where id=@id

GO
alter procedure [HrmCareerApply_InsertBasic] (@id_1 int, @lastname_2 varchar(4000), @sex_3 char(1), @jobtitle_4 int, @homepage_5 varchar(4000), @email_6 varchar(4000), @homeaddress_7 varchar(4000), @homepostcode_8 varchar(4000), @homephone_9 varchar(4000), @inviteid_10 int, @picture_11 int, @subCompanyId_12 int, @flag int output, @msg varchar(4000) output) as insert into HrmCareerApply (id, lastname, sex, jobtitle, homepage, email, homeaddress, homepostcode, homephone, careerinviteid, picture, subCompanyId) values (@id_1, @lastname_2, @sex_3, @jobtitle_4, @homepage_5, @email_6, @homeaddress_7, @homepostcode_8, @homephone_9, @inviteid_10, @picture_11, @subCompanyId_12)

GO
alter procedure [HrmCareerApply_Insert] (@id_1 	[int], @ischeck [char](1), @ishire		[char](1), @careerid	[int], @firstname_2 	varchar(4000), @lastname_3 	varchar(4000), @titleid_4 	[int], @sex_5 	[char](1), @birthday_6 	[char](10), @nationality_7 	[int], @defaultlanguage_8 	[int], @certificatecategory_9 	varchar(4000), @certificatenum_10 	varchar(4000), @nativeplace_11 	varchar(4000), @educationlevel_12 	[char](1), @bememberdate_13 	[char](10), @bepartydate_14 	[char](10), @bedemocracydate_15 	[char](10), @regresidentplace_16 	varchar(4000), @healthinfo_17 	[char](1), @residentplace_18 	varchar(4000), @policy_19 	varchar(4000), @degree_20 	varchar(4000), @height_21 	varchar(4000), @homepage_22 	varchar(4000), @maritalstatus_23 	[char](1), @marrydate_24 	[char](10), @train_25 	[text], @numberid varchar(4000), @email_26 	varchar(4000), @homeaddress_27 	varchar(4000), @homepostcode_28 	varchar(4000), @homephone_29 	varchar(4000), @category_3 	[char](1), @contactor_4 	varchar(4000), @major_5 	varchar(4000), @salarynow_6 	varchar(4000), @worktime_7 	varchar(4000), @salaryneed_8 	varchar(4000), @currencyid_9 	[int], @reason_10 	varchar(4000), @otherrequest_11 	varchar(4000), @selfcomment_12 	[text], @createdate		[char](10), @flag integer output, @msg varchar(4000) output)  AS if @nationality_7=0 set @nationality_7= null if @defaultlanguage_8=0 set @defaultlanguage_8= null  INSERT INTO [HrmCareerApply] ( [id], ischeck, ishire, [careerid], [firstname], [lastname], [titleid], [sex], [birthday], [nationality], [defaultlanguage], [certificatecategory], [certificatenum], [nativeplace], [educationlevel], [bememberdate], [bepartydate], [bedemocracydate], [regresidentplace], [healthinfo], [residentplace], [policy], [degree], [height], [homepage], [maritalstatus], [marrydate], [train],[NumberId], [email], [homeaddress], [homepostcode], [homephone], createrid, createdate)  VALUES ( @id_1, @ischeck, @ishire, @careerid, @firstname_2, @lastname_3, @titleid_4, @sex_5, @birthday_6, @nationality_7, @defaultlanguage_8, @certificatecategory_9, @certificatenum_10, @nativeplace_11, @educationlevel_12, @bememberdate_13, @bepartydate_14, @bedemocracydate_15, @regresidentplace_16, @healthinfo_17, @residentplace_18, @policy_19, @degree_20, @height_21, @homepage_22, @maritalstatus_23, @marrydate_24, @train_25, @numberid, @email_26, @homeaddress_27, @homepostcode_28, @homephone_29, @id_1, @createdate)  INSERT INTO [HrmCareerApplyOtherInfo] ([applyid], [category], [contactor], [major], [salarynow], [worktime], [salaryneed], [currencyid], [reason], [otherrequest], [selfcomment])  VALUES ( @id_1, @category_3, @contactor_4, @major_5, @salarynow_6, @worktime_7, @salaryneed_8, @currencyid_9, @reason_10, @otherrequest_11, @selfcomment_12)

GO
alter procedure [HrmCareerApply_Init] as declare @dftsubcomid_1 integer delete from HrmCareerApply where id in(select id from HrmCareerApply where id not in(select applyid from HrmCareerApplyOtherInfo)) select @dftsubcomid_1=max(dftsubcomid) from SystemSet update HrmCareerApply set subcompanyid = @dftsubcomid_1 where subcompanyid=0 or subcompanyid is null

GO
alter procedure [HrmCareerApply_Inform] (@id_1 	[int], @flag int output, @msg varchar(4000) output)  AS update [HrmCareerApply] set isinform = 1 WHERE id	 = @id_1

GO
alter procedure [HrmCareerApply_Delete] (@resourceid_1 	[int], @flag int output, @msg varchar(4000) output)  as delete HrmCareerApply where id = @resourceid_1  delete HrmInterview where resourceid = @resourceid_1  delete HrmInterviewAssess where resourceid = @resourceid_1  delete HrmInterviewResult where resourceid = @resourceid_1  delete HrmCareerApplyOtherInfo where applyid = @resourceid_1  delete HrmEducationInfo where resourceid = @resourceid_1  delete HrmFamilyInfo where resourceid = @resourceid_1  delete HrmLanguageAbility where resourceid = @resourceid_1  delete HrmWorkResume where resourceid = @resourceid_1  delete HrmTrainBeforeWork where resourceid = @resourceid_1  delete HrmRewardBeforeWork where resourceid = @resourceid_1  delete HrmCertification where resourceid = @resourceid_1

GO
alter procedure [HrmCareerApply_CreateInfo] (@id_1 int, @createrid_2 int, @createdate_3 char(10), @lastmodid_4 int, @lastmoddate_5 char(10), @flag int output, @msg varchar(4000) output) as update HrmCareerApply set createrid = @createrid_2, createdate = @createdate_3, lastmodid = @lastmodid_4, lastmoddate = @lastmoddate_5 where id = @id_1

GO
alter procedure [HrmCareerApply_Backup] (@resourceid_1 	[int], @flag int output, @msg varchar(4000) output) as update HrmCareerApply set nowstep = 0, careerinviteid = 0 where id = @resourceid_1

GO
alter procedure [HrmWelfare_Update] (@id_1 	[int], @resourceid_2 	[int], @datefrom_3 	[char](10), @dateto_4 	[char](10), @basesalary_5 	[decimal](18,2), @homesub_6 	[decimal](18,2), @vehiclesub_7 	[decimal](18,2), @mealsub_8 	[decimal](18,2), @othersub_9 	[decimal](18,2), @adjustreason_10 	varchar(4000), @lastmoderid_11 	[int], @lastmoddate_12 	[char](10), @lastmodtime_13 	[char](8), @flag                   integer output, @msg                   varchar(4000) output )  AS UPDATE [HrmWelfare]  SET  [resourceid]	 = @resourceid_2, [datefrom]	 = @datefrom_3, [dateto]	 = @dateto_4, [basesalary]	 = @basesalary_5, [homesub]	 = @homesub_6, [vehiclesub]	 = @vehiclesub_7, [mealsub]	 = @mealsub_8, [othersub]	 = @othersub_9, [adjustreason]	 = @adjustreason_10, [lastmoderid]	 = @lastmoderid_11, [lastmoddate]	 = @lastmoddate_12, [lastmodtime]	 = @lastmodtime_13  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmWelfare_SelectByResourceID] @resourceid varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmWelfare where resourceid =convert(int, @resourceid) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmWelfare_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmWelfare where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmWelfare_Insert] (@resourceid_1 	[int], @datefrom_2 	[char](10), @dateto_3 	[char](10), @basesalary_4 	[decimal](18,2), @homesub_5 	[decimal](18,2), @vehiclesub_6 	[decimal](18,2), @mealsub_7 	[decimal](18,2), @othersub_8 	[decimal](18,2), @adjustreason_9 	varchar(4000), @createid_10 	[int], @createdate_11 	[char](10), @createtime_12 	[char](8), @lastmoderid_13 	[int], @lastmoddate_14 	[char](10), @lastmodtime_15 	[char](8), @flag                   integer output, @msg                   varchar(4000) output )  AS INSERT INTO [HrmWelfare] ( [resourceid], [datefrom], [dateto], [basesalary], [homesub], [vehiclesub], [mealsub], [othersub], [adjustreason], [createid], [createdate], [createtime], [lastmoderid], [lastmoddate], [lastmodtime])  VALUES ( @resourceid_1, @datefrom_2, @dateto_3, @basesalary_4, @homesub_5, @vehiclesub_6, @mealsub_7, @othersub_8, @adjustreason_9, @createid_10, @createdate_11, @createtime_12, @lastmoderid_13, @lastmoddate_14, @lastmodtime_15)

GO
alter procedure [HrmWelfare_Delete] (@id_1 	[int], @flag                   integer output, @msg                   varchar(4000) output )  AS DELETE [HrmWelfare]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmUserDefine_Update] (@userid_1 	[int], @hasresourceid_2 	[char](1), @hasresourcename_3 	[char](1), @hasjobtitle_4 	[char](1), @hasactivitydesc_5 	[char](1), @hasjobgroup_6 	[char](1), @hasjobactivity_7 	[char](1), @hascostcenter_8 	[char](1), @hascompetency_9 	[char](1), @hasresourcetype_10 	[char](1), @hasstatus_11 	[char](1), @hassubcompany_12 	[char](1), @hasdepartment_13 	[char](1), @haslocation_14 	[char](1), @hasmanager_15 	[char](1), @hasassistant_16 	[char](1), @hasroles_17 	[char](1), @hasseclevel_18 	[char](1), @hasjoblevel_19 	[char](1), @hasworkroom_20 	[char](1), @hastelephone_21 	[char](1), @hasstartdate_22 	[char](1), @hasenddate_23 	[char](1), @hascontractdate_24 	[char](1), @hasbirthday_25 	[char](1), @hassex_26 	[char](1), @projectable_27 	[char](1), @crmable_28 	[char](1), @itemable_29 	[char](1), @docable_30 	[char](1), @workflowable_31 	[char](1), @subordinateable_32 	[char](1), @trainable_33 	[char](1), @budgetable_34 	[char](1), @fnatranable_35 	[char](1), @dspperpage_36 	[tinyint], @flag integer output, @msg varchar(4000) output )  AS UPDATE [HrmUserDefine]  SET  [hasresourceid]	 = @hasresourceid_2, [hasresourcename]	 = @hasresourcename_3, [hasjobtitle]	 = @hasjobtitle_4, [hasactivitydesc]	 = @hasactivitydesc_5, [hasjobgroup]	 = @hasjobgroup_6, [hasjobactivity]	 = @hasjobactivity_7, [hascostcenter]	 = @hascostcenter_8, [hascompetency]	 = @hascompetency_9, [hasresourcetype]	 = @hasresourcetype_10, [hasstatus]	 = @hasstatus_11, [hassubcompany]	 = @hassubcompany_12, [hasdepartment]	 = @hasdepartment_13, [haslocation]	 = @haslocation_14, [hasmanager]	 = @hasmanager_15, [hasassistant]	 = @hasassistant_16, [hasroles]	 = @hasroles_17, [hasseclevel]	 = @hasseclevel_18, [hasjoblevel]	 = @hasjoblevel_19, [hasworkroom]	 = @hasworkroom_20, [hastelephone]	 = @hastelephone_21, [hasstartdate]	 = @hasstartdate_22, [hasenddate]	 = @hasenddate_23, [hascontractdate]	 = @hascontractdate_24, [hasbirthday]	 = @hasbirthday_25, [hassex]	 = @hassex_26, [projectable]	 = @projectable_27, [crmable]	 = @crmable_28, [itemable]	 = @itemable_29, [docable]	 = @docable_30, [workflowable]	 = @workflowable_31, [subordinateable]	 = @subordinateable_32, [trainable]	 = @trainable_33, [budgetable]	 = @budgetable_34, [fnatranable]	 = @fnatranable_35, [dspperpage]	 = @dspperpage_36  WHERE ( [userid]	 = @userid_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmUserDefine_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS DECLARE @recordercount integer Select @recordercount = count(userid) from HrmUserDefine where userid =convert(int, @id)  if @recordercount = 0 begin select * from HrmUserDefine where userid =-1 end else begin select * from HrmUserDefine where userid =convert(int, @id) end set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmUserDefine_Insert] ( @userid_1 [int] , @hasresourceid_2 [char](1) , @hasresourcename_3 [char](1) , @hasjobtitle_4 [char](1) , @hasactivitydesc_5 [char](1) , @hasjobgroup_6 [char](1) , @hasjobactivity_7 [char](1) , @hascostcenter_8 [char](1) , @hascompetency_9 [char](1) , @hasresourcetype_10 [char](1) , @hasstatus_11 [char](1) , @hassubcompany_12 [char](1) , @hasdepartment_13 [char](1) , @haslocation_14 [char](1) , @hasmanager_15 [char](1) , @hasassistant_16 [char](1) , @hasroles_17 [char](1) , @hasseclevel_18 [char](1) , @hasjoblevel_19 [char](1) , @hasworkroom_20 [char](1) , @hastelephone_21 [char](1) , @hasstartdate_22 [char](1) , @hasenddate_23 [char](1) , @hascontractdate_24 [char](1) , @hasbirthday_25 [char](1) , @hassex_26 [char](1) , @projectable_27 [char](1) , @crmable_28 [char](1) , @itemable_29 [char](1) , @docable_30 [char](1) , @workflowable_31 [char](1) , @subordinateable_32 [char](1) , @trainable_33 [char](1) , @budgetable_34 [char](1) , @fnatranable_35 [char](1) , @dspperpage_36 [tinyint] , @hasage_37 [char](1) , @hasworkcode_38 [char](1) , @hasjobcall_39 [char](1) , @hasmobile_40 [char](1) , @hasmobilecall_41 [char](1) , @hasfax_42 [char](1) , @hasemail_43 [char](1) , @hasfolk_44 [char](1) , @hasregresidentplace_45 [char](1) , @hasnativeplace_46 [char](1) , @hascertificatenum_47 [char](1) , @hasmaritalstatus_48 [char](1) , @haspolicy_49 [char](1) , @hasbememberdate_50 [char](1) , @hasbepartydate_51 [char](1) , @hasislabouunion_52 [char](1) , @haseducationlevel_53 [char](1) , @hasdegree_54 [char](1) , @hashealthinfo_55 [char](1) , @hasheight_56 [char](1) , @hasweight_57 [char](1) , @hasresidentplace_58 [char](1) , @hashomeaddress_59 [char](1) , @hastempresidentnumber_60 [char](1) , @hasusekind_61 [char](1) , @hasbankid1_62 [char](1) , @hasaccountid1_63 [char](1) , @hasaccumfundaccount_64 [char](1) , @hasloginid_65 [char](1) , @hassystemlanguage_66 [char](1) , @hasaccounttype_67 [char](1) , @workplanable_68 [char](1) , @hasvirtualdepartment_69 [char](1) , @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT ) AS DECLARE @recordercount INTEGER SELECT  @recordercount = COUNT(userid) FROM    HrmUserDefine WHERE   userid = CONVERT(INT, @userid_1) IF @recordercount = 0 BEGIN INSERT  INTO [HrmUserDefine] ( [userid] , [hasresourceid] , [hasresourcename] , [hasjobtitle] , [hasactivitydesc] , [hasjobgroup] , [hasjobactivity] , [hascostcenter] , [hascompetency] , [hasresourcetype] , [hasstatus] , [hassubcompany] , [hasdepartment] , [haslocation] , [hasmanager] , [hasassistant] , [hasroles] , [hasseclevel] , [hasjoblevel] , [hasworkroom] , [hastelephone] , [hasstartdate] , [hasenddate] , [hascontractdate] , [hasbirthday] , [hassex] , [projectable] , [crmable] , [itemable] , [docable] , [workflowable] , [subordinateable] , [trainable] , [budgetable] , [fnatranable] , [dspperpage] , [hasage] , [hasworkcode] , [hasjobcall] , [hasmobile] , [hasmobilecall] , [hasfax] , [hasemail] , [hasfolk] , [hasregresidentplace] , [hasnativeplace] , [hascertificatenum] , [hasmaritalstatus] , [haspolicy] , [hasbememberdate] , [hasbepartydate] , [hasislabouunion] , [haseducationlevel] , [hasdegree] , [hashealthinfo] , [hasheight] , [hasweight] , [hasresidentplace] , [hashomeaddress] , [hastempresidentnumber] , [hasusekind] , [hasbankid1] , [hasaccountid1] , [hasaccumfundaccount] , [hasloginid] , [hassystemlanguage] , [hasaccounttype] , [workplanable], [hasvirtualdepartment] ) VALUES  ( @userid_1 , @hasresourceid_2 , @hasresourcename_3 , @hasjobtitle_4 , @hasactivitydesc_5 , @hasjobgroup_6 , @hasjobactivity_7 , @hascostcenter_8 , @hascompetency_9 , @hasresourcetype_10 , @hasstatus_11 , @hassubcompany_12 , @hasdepartment_13 , @haslocation_14 , @hasmanager_15 , @hasassistant_16 , @hasroles_17 , @hasseclevel_18 , @hasjoblevel_19 , @hasworkroom_20 , @hastelephone_21 , @hasstartdate_22 , @hasenddate_23 , @hascontractdate_24 , @hasbirthday_25 , @hassex_26 , @projectable_27 , @crmable_28 , @itemable_29 , @docable_30 , @workflowable_31 , @subordinateable_32 , @trainable_33 , @budgetable_34 , @fnatranable_35 , @dspperpage_36 , @hasage_37 , @hasworkcode_38 , @hasjobcall_39 , @hasmobile_40 , @hasmobilecall_41 , @hasfax_42 , @hasemail_43 , @hasfolk_44 , @hasregresidentplace_45 , @hasnativeplace_46 , @hascertificatenum_47 , @hasmaritalstatus_48 , @haspolicy_49 , @hasbememberdate_50 , @hasbepartydate_51 , @hasislabouunion_52 , @haseducationlevel_53 , @hasdegree_54 , @hashealthinfo_55 , @hasheight_56 , @hasweight_57 , @hasresidentplace_58 , @hashomeaddress_59 , @hastempresidentnumber_60 , @hasusekind_61 , @hasbankid1_62 , @hasaccountid1_63 , @hasaccumfundaccount_64 , @hasloginid_65 , @hassystemlanguage_66 , @hasaccounttype_67 , @workplanable_68, @hasvirtualdepartment_69 ) END ELSE BEGIN UPDATE  [HrmUserDefine] SET     [hasresourceid] = @hasresourceid_2 , [hasresourcename] = @hasresourcename_3 , [hasjobtitle] = @hasjobtitle_4 , [hasactivitydesc] = @hasactivitydesc_5 , [hasjobgroup] = @hasjobgroup_6 , [hasjobactivity] = @hasjobactivity_7 , [hascostcenter] = @hascostcenter_8 , [hascompetency] = @hascompetency_9 , [hasresourcetype] = @hasresourcetype_10 , [hasstatus] = @hasstatus_11 , [hassubcompany] = @hassubcompany_12 , [hasdepartment] = @hasdepartment_13 , [haslocation] = @haslocation_14 , [hasmanager] = @hasmanager_15 , [hasassistant] = @hasassistant_16 , [hasroles] = @hasroles_17 , [hasseclevel] = @hasseclevel_18 , [hasjoblevel] = @hasjoblevel_19 , [hasworkroom] = @hasworkroom_20 , [hastelephone] = @hastelephone_21 , [hasstartdate] = @hasstartdate_22 , [hasenddate] = @hasenddate_23 , [hascontractdate] = @hascontractdate_24 , [hasbirthday] = @hasbirthday_25 , [hassex] = @hassex_26 , [projectable] = @projectable_27 , [crmable] = @crmable_28 , [itemable] = @itemable_29 , [docable] = @docable_30 , [workflowable] = @workflowable_31 , [subordinateable] = @subordinateable_32 , [trainable] = @trainable_33 , [budgetable] = @budgetable_34 , [fnatranable] = @fnatranable_35 , [dspperpage] = @dspperpage_36 , [hasage] = @hasage_37 , [hasworkcode] = @hasworkcode_38 , [hasjobcall] = @hasjobcall_39 , [hasmobile] = @hasmobile_40 , [hasmobilecall] = @hasmobilecall_41 , [hasfax] = @hasfax_42 , [hasemail] = @hasemail_43 , [hasfolk] = @hasfolk_44 , [hasregresidentplace] = @hasregresidentplace_45 , [hasnativeplace] = @hasnativeplace_46 , [hascertificatenum] = @hascertificatenum_47 , [hasmaritalstatus] = @hasmaritalstatus_48 , [haspolicy] = @haspolicy_49 , [hasbememberdate] = @hasbememberdate_50 , [hasbepartydate] = @hasbepartydate_51 , [hasislabouunion] = @hasislabouunion_52 , [haseducationlevel] = @haseducationlevel_53 , [hasdegree] = @hasdegree_54 , [hashealthinfo] = @hashealthinfo_55 , [hasheight] = @hasheight_56 , [hasweight] = @hasweight_57 , [hasresidentplace] = @hasresidentplace_58 , [hashomeaddress] = @hashomeaddress_59 , [hastempresidentnumber] = @hastempresidentnumber_60 , [hasusekind] = @hasusekind_61 , [hasbankid1] = @hasbankid1_62 , [hasaccountid1] = @hasaccountid1_63 , [hasaccumfundaccount] = @hasaccumfundaccount_64 , [hasloginid] = @hasloginid_65 , [hassystemlanguage] = @hassystemlanguage_66 , [hasaccounttype] = @hasaccounttype_67 , [workplanable] = @workplanable_68, [hasvirtualdepartment] = @hasvirtualdepartment_69 WHERE   ( [userid] = @userid_1 ) END IF @@error <> 0 BEGIN SET @flag = 1 SET @msg = '插入储存过程失败' RETURN END ELSE BEGIN SET @flag = 0 SET @msg = '插入储存过程成功' RETURN END

 GO
alter procedure [HrmTrainTest_Update] (@trainid_1 int, @resourceid_2 int, @testdate_3 char(10), @result_4 int, @explain_5 text, @testerid_6 int, @id_7 int, @flag int output, @msg varchar(4000) output) as UPDATE HrmTrainTest SET resourceid = @resourceid_2, testdate = @testdate_3, result = @result_4, explain = @explain_5 WHERE ID = @id_7

GO
alter procedure [Bill_LeaveJob_SelectByID] @id		int, @flag integer output , @msg varchar(4000) output as select * from bill_LeaveJob where id=@id

GO
alter procedure [HrmUseKind_Update] (@id_1 	[int], @name_2 	varchar(4000), @description_3 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS UPDATE [HrmUseKind]  SET  [name]	 = @name_2, [description]	 = @description_3  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmUseKind_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmUseKind where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmUseKind_Select] @flag integer output , @msg varchar(4000) output  AS select * from HrmUseKind set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmUseKind_Insert] (@name_1 	varchar(4000), @description_2 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [HrmUseKind] ( [name], [description])  VALUES ( @name_1, @description_2)

GO
alter procedure [HrmUseKind_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmUseKind]  WHERE ( [id]	 = @id_1)

GO
alter procedure [SystemRightGroup_Update] @id int, @mark varchar(4000), @description varchar(4000), @notes text, @flag int output, @msg varchar(4000) output as begin update SystemRightGroups set rightgroupmark=@mark,rightgroupname=@description,rightgroupremark=@notes where id=@id if @@error=0 begin set @flag=0 set @msg='操作成功' end else begin set @flag=13 set @msg='修改记录失败' end select @flag ,@msg end

GO
alter procedure [SystemRightGroup_sbygroupid] @id int, @flag int output, @msg varchar(4000) output as begin select rightgroupmark,rightgroupname,rightgroupremark from systemrightgroups where id=@id end

GO
alter procedure [SystemRightGroup_Delete] @id int, @flag int output, @msg varchar(4000) output as select rightgroupname from SystemRightGroups where id=@id delete SystemRightGroups where id=@id delete SystemRightToGroup where groupid=@id set @flag=0 set @msg='操作成功' select @flag,@msg

GO
alter procedure [SystemRightDetail_Update] (@id_1 	[int], @rightdetailname_2 	varchar(4000), @rightdetail_3 	varchar(4000), @rightid_4 	[int], @flag integer output , @msg varchar(4000) output)  AS UPDATE [SystemRightDetail]  SET  [rightdetailname]	 = @rightdetailname_2, [rightdetail]	 = @rightdetail_3, [rightid]	 = @rightid_4  WHERE ( [id]	 = @id_1)

GO
alter procedure [SystemRightDetail_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from SystemRightDetail where id = @id set  @flag = 0 set  @msg = '查询系统权限详细成功'

GO
alter procedure [SystemRightDetail_Select] (@rightdetailname_1 varchar(4000) , @flag integer output , @msg varchar(4000) output )  AS  select * from SystemRightDetail where rightdetailname like @rightdetailname_1 order by rightid desc , id desc

GO
alter procedure [HrmTrainActor_Update] (@traindayid_1 int, @resourceid_2 int, @flag int output, @msg varchar(4000) output) as update HrmTrainActor set isattend = 1 where traindayid = @traindayid_1 and resourceid = @resourceid_2

GO
alter procedure [HrmTrainActor_Insert] (@traindayid_1 int, @resourceid_2 int, @flag int output, @msg varchar(4000) output) as insert into HrmTrainActor (traindayid, resourceid) values (@traindayid_1, @resourceid_2)

GO
alter procedure [HrmTrain_Update] (@name_1 varchar(4000), @planid_2 int, @organizer_3 varchar(4000), @startdate_4 char(10), @enddate_5 char(10), @content_6 text, @aim_7 text, @address_8 varchar(4000), @resource_n_9 varchar(4000), @testdate_10 char(10), @id_11 int, @flag int output , @msg varchar(4000) output) as update HrmTrain set name      = @name_1, planid    = @planid_2, organizer = @organizer_3, startdate = @startdate_4, enddate   = @enddate_5, content   = @content_6, aim       = @aim_7, address   = @address_8, resource_n= @resource_n_9, testdate  = @testdate_10 where id = @id_11

 GO
alter procedure [HrmTrain_Insert] (@name_1 varchar(4000), @planid_2 int, @organizer_3 varchar(4000), @startdate_4 char(10), @enddate_5 char(10), @content_6 text, @aim_7 text, @address_8 varchar(4000), @resource_n_9 varchar(4000), @createrid_10 int, @testdate_11 char(10), @flag int output , @msg varchar(4000) output) as insert into HrmTrain (name, planid, organizer, startdate, enddate, content, aim, address, resource_n, createrid, testdate) values (@name_1, @planid_2, @organizer_3, @startdate_4, @enddate_5, @content_6, @aim_7, @address_8, @resource_n_9, @createrid_10, @testdate_11) select max(id) from HrmTrain 

GO
alter procedure [HrmTrain_Finish] (@id_1 int, @summarizer_2 int, @summarizedate_3 char(10), @fare_4 float, @faretype_5 int, @advice_6 text, @flag int output, @msg varchar(4000) output) as update HrmTrain set summarizer = @summarizer_2, summarizedate = @summarizedate_3, fare = @fare_4, faretype = @faretype_5, advice = @advice_6 where id = @id_1

GO
alter procedure [HrmTrain_Delete] (@id_1 int, @flag int output , @msg varchar(4000) output) as delete HrmTrain where id = @id_1 delete from HrmTrainActor where traindayid in (select id from HrmTrainDay where trainid = @id_1) delete from HrmTrainDay where trainid = @id_1 delete from HrmTrainAssess where trainid = @id_1 delete from HrmTrainTest where trainid = @id_1

GO
alter procedure [HrmTimecardUser_Update] (@resourceid_1 	int, @usercode_2 	varchar(4000), @flag		int	output, @msg		varchar(4000) output)  AS declare @count int  select @count= count(usercode) from HrmTimecardUser where resourceid != @resourceid_1 and usercode = @usercode_2 and usercode is not null and usercode != '' if @count is not null and @count > 0 begin select -1 return end  select @count= count(resourceid) from HrmTimecardUser where resourceid = @resourceid_1 if @count is not null and @count > 0 update HrmTimecardUser set usercode = @usercode_2 where resourceid = @resourceid_1 else insert into HrmTimecardUser(resourceid,usercode) values(@resourceid_1,@usercode_2 )  select 1

GO
alter procedure [HrmTimecardInfo_Update] (@resourceid_1 	int, @timecarddate_3 	char(10), @intime_4 	char(5), @outtime_5 	char(5), @relateshiftid_6  int , @cardtimetype int ,   @flag		int	output, @msg		varchar(4000) output)  AS declare @reccount int  select @reccount = count(resourceid) from HrmTimecardinfo where resourceid = @resourceid_1 and timecarddate = @timecarddate_3 and relateshiftid = @relateshiftid_6  if @cardtimetype = 0 begin if @reccount = 0 insert into HrmTimecardinfo(resourceid,timecarddate,intime,outtime,relateshiftid) values(@resourceid_1,@timecarddate_3,@intime_4 , @outtime_5 ,@relateshiftid_6) else if @relateshiftid_6 = -1 begin select @reccount = count(resourceid) from HrmTimecardinfo where resourceid = @resourceid_1 and timecarddate = @timecarddate_3 and intime = @intime_4 and outtime = @outtime_5 if @reccount = 0 insert into HrmTimecardinfo(resourceid,timecarddate,intime,outtime,relateshiftid) values(@resourceid_1,@timecarddate_3,@intime_4 , @outtime_5 ,@relateshiftid_6) end end else if @cardtimetype = 1 begin if @reccount = 0 insert into HrmTimecardinfo(resourceid,timecarddate,intime,outtime,relateshiftid) values(@resourceid_1,@timecarddate_3,@intime_4 , @outtime_5 ,@relateshiftid_6) else update HrmTimecardinfo set outtime = @outtime_5 where resourceid = @resourceid_1 and timecarddate = @timecarddate_3 and relateshiftid = @relateshiftid_6 end else if @cardtimetype = 2 begin if @reccount = 0 insert into HrmTimecardinfo(resourceid,timecarddate,intime,outtime,relateshiftid) values(@resourceid_1,@timecarddate_3,@intime_4 , @outtime_5 ,@relateshiftid_6) else update HrmTimecardinfo set intime = @intime_4 where resourceid = @resourceid_1 and timecarddate = @timecarddate_3 and relateshiftid = @relateshiftid_6 end

GO
alter procedure [HrmSubCompanyVirtual_Select] @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT AS SELECT  * FROM    HrmSubCompanyVirtual ORDER BY showorder ASC, id desc SET @flag = 0 SET @msg = '操作成功完成'

GO
alter procedure [HrmValidateCardInfo_Insert] ( @stationid_2 char(2) ,  @carddate_3 char(10), @cardtime_4 char(5) ,  @workshift_5  char(1) , @Cardid_6  char(10) ,  @flag        integer output , @msg         varchar(4000) output)  AS INSERT INTO HrmValidateCardInfo ( stationid , carddate , cardtime , workshift , Cardid )  VALUES ( @stationid_2 , @carddate_3 , @cardtime_4 , @workshift_5 , @Cardid_6 )

GO
alter procedure [BPMSequenceId_Get] (@indexdesc varchar(4000),@flag int output, @msg varchar(4000) output) as declare @id_1 integer select @id_1=currentid from SequenceIndex where indexdesc=@indexdesc update SequenceIndex set currentid = @id_1+1 where indexdesc=@indexdesc select @id_1

GO
alter procedure [bill_workinfodetail_SByType] @infoid		int, @type		int, @flag integer output , @msg varchar(4000) output as select * from bill_weekinfodetail where infoid=@infoid and type=@type   order by id

GO
alter procedure [bill_workinfodetail_Insert] @infoid		int, @type		int, @workname	varchar(4000), @workdesc	text, @forecastdate	char(10), @flag integer output , @msg varchar(4000) output as insert into bill_weekinfodetail (infoid,type,workname,workdesc,forecastdate) values (@infoid,@type,@workname,@workdesc,@forecastdate)

GO
alter procedure [WkfReportShareDetail_Insert] (@reportid_1 	int, @userid_2 	int, @usertype_3 	int, @sharelevel_4 	int , @mutidepartmentid_5 varchar(4000), @flag int 	output, @msg 	varchar(4000) output) AS INSERT INTO WorkflowReportShareDetail ( reportid, userid, usertype, sharelevel,mutidepartmentid) VALUES ( @reportid_1, @userid_2, @usertype_3, @sharelevel_4,@mutidepartmentid_5)

GO
alter procedure [WkfReportShareDetail_DByUId] (@userid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [WorkflowReportShareDetail]  WHERE ( [userid]	 = @userid_1  and usertype = '1' )

GO
alter procedure [WkfReportShareDetail_DBId] (@reportid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [WorkflowReportShareDetail]  WHERE ( [reportid]	 = @reportid_1)

GO
alter procedure [WFDocShareInfo_Select] (@requestId	int,@userid    int, @flag	int output, @msg	varchar(4000)	output) as select * from Workflow_DocShareInfo where requestId=@requestId and userid=@userid

GO
alter procedure [WFDocShareInfo_Delete] (@requestId	int,@userid    int, @flag	int output, @msg	varchar(4000)	output) as delete from Workflow_DocShareInfo where requestId=@requestId and userid=@userid

GO
alter procedure [workflow_addinoperate_select] (@id 	int, @isnode 	int, @ispreadd char(1), @flag integer output, @msg varchar(4000) output) AS select * from workflow_addinoperate where objid=@id and isnode=@isnode and ispreadd=@ispreadd order by id

GO
alter procedure [workflow_addinoperate_Insert] (@objid_1           int, @isnode_2          int, @workflowid_3      int, @fieldid_4         int, @fieldop1id_5      int, @fieldop2id_6      int, @operation_7       int, @customervalue_8   varchar(4000), @rules_9           int, @type_10           int, @ispreadd_11       char(1), @flag integer      output, @msg varchar(4000)   output ) AS INSERT INTO workflow_addinoperate (objid, isnode, workflowid, fieldid, fieldop1id, fieldop2id, operation, customervalue, rules, type, ispreadd) VALUES (@objid_1, @isnode_2, @workflowid_3, @fieldid_4, @fieldop1id_5, @fieldop2id_6, @operation_7, @customervalue_8, @rules_9, @type_10, @ispreadd_11)

GO
alter procedure [workflow_addinoperate_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [workflow_addinoperate]  WHERE ( [id]	 = @id_1)

GO
alter procedure [FnaLedgerCategory_Update] (@id_1 	[int], @categoryname_2 	varchar(4000), @categorydesc_3 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS UPDATE [FnaLedgerCategory]  SET  [categoryname]	 = @categoryname_2, [categorydesc]	 = @categorydesc_3  WHERE ( [id]	 = @id_1)

GO
alter procedure [FnaLedgerCategory_SelectByID] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS select * from FnaLedgerCategory where id = @id_1

GO
alter procedure [FnaLedgerCategory_Select] @flag integer output , @msg varchar(4000) output AS select * from FnaLedgerCategory

GO
alter procedure [FnaLedgerCategory_Insert] (@categoryname_1 	varchar(4000), @categorydesc_2 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [FnaLedgerCategory] ( [categoryname], [categorydesc]) VALUES ( @categoryname_1, @categorydesc_2) select max(id) from FnaLedgerCategory

GO
alter procedure [FnaLedgerCategory_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @count integer select @count = count(id) from FnaLedger where categoryid = @id_1 if @count <> 0 begin select '20' return end  DELETE [FnaLedgerCategory] WHERE  ( [id]	 = @id_1)

GO
alter procedure [FnaLedger_UpdateAuto] (@oldcrmcode 	varchar(4000), @crmcode 	varchar(4000), @crmtype 	[char](1), @flag integer output , @msg varchar(4000) output)  AS  declare @count integer declare @ledgermark_1 varchar(4000), @ledgermark_2 varchar(4000), @ledgerid_1 int, @ledgerid_2 int  if @crmtype = '1' begin select @ledgermark_1 = ledgermark from FnaLedger where autosubledger = '1' select @ledgermark_2 = ledgermark from FnaLedger where autosubledger = '2' end  if @crmtype = '2' begin select @ledgermark_1 = ledgermark from FnaLedger where autosubledger = '3' select @ledgermark_2 = ledgermark from FnaLedger where autosubledger = '4' end  select @count = count(id) from FnaLedger where  ledgermark = (@ledgermark_1 + @crmcode) if @count <> 0 begin select 1 return end  select @ledgerid_1 = id from FnaLedger where  ledgermark = (@ledgermark_1 + @oldcrmcode) select @count = count(id) from FnaTransactionDetail where ledgerid = @ledgerid_1 if @count <> 0 begin select 2 return end  select @count = count(id) from FnaLedger where  ledgermark = (@ledgermark_2 + @crmcode) if @count <> 0 begin select 1 return end  select @ledgerid_2 = id from FnaLedger where  ledgermark = (@ledgermark_2 + @oldcrmcode) select @count = count(id) from FnaTransactionDetail where ledgerid = @ledgerid_2 if @count <> 0 begin select 2 return end  update FnaLedger set ledgermark = (@ledgermark_1 + @crmcode) where id = @ledgerid_1 update FnaLedger set ledgermark = (@ledgermark_2 + @crmcode) where id = @ledgerid_2  select 0

GO
alter procedure [FnaLedger_Update] (@id_1 	[int], @ledgermark_2 	varchar(4000), @ledgername_3 	varchar(4000), @ledgertype_4 	[char](1), @ledgergroup_5 	[char](1), @ledgerbalance_6 	[char](1), @autosubledger_7 	[char](1), @ledgercurrency_8 	[char](1), @initaccount_9         decimal(18,3), @doinit_10              char(1), @flag integer output , @msg varchar(4000) output)  AS declare @count integer if @autosubledger_7 <> '0' begin select @count = count(id) from FnaLedger where autosubledger = @autosubledger_7 and id != @id_1 if @count <> 0 begin select -3 return end end   UPDATE [FnaLedger]  SET  [ledgermark]	 = @ledgermark_2, [ledgername]	 = @ledgername_3, [ledgertype]	 = @ledgertype_4, [ledgergroup]	 = @ledgergroup_5, [ledgerbalance]	 = @ledgerbalance_6, [autosubledger]	 = @autosubledger_7, [ledgercurrency]	 = @ledgercurrency_8, [initaccount]	 = @initaccount_9  WHERE ( [id]	 = @id_1)  if @doinit_10 = '1' begin  delete FnaAccount where ledgerid = @id_1 insert into FnaAccount(ledgerid,tranperiods,tranremain) values(@id_1,'000000',@initaccount_9)  end

GO
alter procedure [FnaLedger_SelectSupLedgerall] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS select supledgerall from FnaLedger  where id = @id_1

GO
alter procedure [FnaLedger_SelectCountByBabance] (@flag integer output , @msg varchar(4000) output)  AS declare @assetcount int , @debitcount int select @assetcount = count(id) from FnaLedger where supledgerid =0 and ledgergroup ='1'  select @debitcount = count(id) from FnaLedger where supledgerid =0 and (ledgergroup ='2' or ledgergroup ='3' )  select @assetcount , @debitcount

GO
alter procedure [FnaLedger_SelectByID] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS declare @count integer ,@count1 integer select @count = count(id) from FnaAccountList where ledgerid = @id_1 select @count1 = count(id) from FnaYearsPeriodsList where isclose = '1' set @count = @count + @count1 select id,ledgermark,ledgername,ledgertype,ledgergroup,ledgerbalance, autosubledger,ledgercurrency,supledgerid,subledgercount,categoryid, initaccount, 'accountnum'=@count from FnaLedger  where id = @id_1

GO
alter procedure [FnaLedger_Select] @flag integer output , @msg varchar(4000) output AS select * from FnaLedger order by ledgermark

GO
alter procedure [FnaLedger_InsertAuto] (@crmname 	varchar(4000), @crmtype 	[char](1), @crmcode 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS  declare @count integer , @init decimal(18,3) declare @ledgermark_1 varchar(4000), @ledgername_2 varchar(4000), @ledgertype_3 [char](1), @ledgergroup_4  [char](1) declare	@ledgerbalance_5 [char](1), @ledgercurrency_7 [char](1), @supledgerid_8 [int] declare @categoryid_9 [int], @supledgerall_10 varchar(4000), @ledgerid1 int , @ledgerid2 int  if @crmtype = '1' begin  select @ledgermark_1 = ledgermark from FnaLedger where autosubledger = '1' select @count = count(id) from FnaLedger where  ledgermark = (@ledgermark_1 + @crmcode) if @count <> 0 begin select 1,0,0 return end  select @ledgermark_1 = ledgermark from FnaLedger where autosubledger = '2' select @count = count(id) from FnaLedger where  ledgermark = (@ledgermark_1 + @crmcode) if @count <> 0 begin select 1,0,0 return end  select @ledgermark_1 = ledgermark, @ledgername_2= ledgername, @ledgertype_3= ledgertype, @ledgergroup_4=ledgergroup, @ledgerbalance_5= ledgerbalance, @ledgercurrency_7=ledgercurrency, @supledgerid_8=id , @categoryid_9=categoryid , @supledgerall_10 = supledgerall from FnaLedger where autosubledger = '1' set @ledgermark_1 = @ledgermark_1 + @crmcode set @ledgername_2 = @ledgername_2 + '-' + @crmname set @supledgerall_10 = @supledgerall_10 + convert(varchar(4000), @supledgerid_8) +'|'  INSERT INTO [FnaLedger] ( [ledgermark], [ledgername], [ledgertype], [ledgergroup], [ledgerbalance], [autosubledger], [ledgercurrency], [supledgerid], [categoryid], [supledgerall])  VALUES ( @ledgermark_1, @ledgername_2, @ledgertype_3, @ledgergroup_4, @ledgerbalance_5, '0', @ledgercurrency_7, @supledgerid_8, @categoryid_9, @supledgerall_10)  select @ledgerid1 = max(id) from FnaLedger update FnaLedger set subledgercount = subledgercount+1 where id = @supledgerid_8  select @ledgermark_1 = ledgermark, @ledgername_2= ledgername, @ledgertype_3= ledgertype, @ledgergroup_4=ledgergroup, @ledgerbalance_5= ledgerbalance, @ledgercurrency_7=ledgercurrency, @supledgerid_8=id , @categoryid_9=categoryid , @supledgerall_10 = supledgerall from FnaLedger where autosubledger = '2' set @ledgermark_1 = @ledgermark_1 + @crmcode set @ledgername_2 = @ledgername_2 + '-' + @crmname set @supledgerall_10 = @supledgerall_10 + convert(varchar(4000), @supledgerid_8) +'|'  INSERT INTO [FnaLedger] ( [ledgermark], [ledgername], [ledgertype], [ledgergroup], [ledgerbalance], [autosubledger], [ledgercurrency], [supledgerid], [categoryid], [supledgerall])  VALUES ( @ledgermark_1, @ledgername_2, @ledgertype_3, @ledgergroup_4, @ledgerbalance_5, '0', @ledgercurrency_7, @supledgerid_8, @categoryid_9, @supledgerall_10)  select @ledgerid2 = max(id) from FnaLedger update FnaLedger set subledgercount = subledgercount+1 where id = @supledgerid_8  end  if @crmtype = '2' begin  select @ledgermark_1 = ledgermark from FnaLedger where autosubledger = '3' select @count = count(id) from FnaLedger where  ledgermark = (@ledgermark_1 + @crmcode) if @count <> 0 begin select 1,0,0 return end  select @ledgermark_1 = ledgermark from FnaLedger where autosubledger = '4' select @count = count(id) from FnaLedger where  ledgermark = (@ledgermark_1 + @crmcode) if @count <> 0 begin select 1,0,0 return end  select @ledgermark_1 = ledgermark, @ledgername_2= ledgername, @ledgertype_3= ledgertype, @ledgergroup_4=ledgergroup, @ledgerbalance_5= ledgerbalance, @ledgercurrency_7=ledgercurrency, @supledgerid_8=id , @categoryid_9=categoryid , @supledgerall_10 = supledgerall from FnaLedger where autosubledger = '3' set @ledgermark_1 = @ledgermark_1 + @crmcode set @ledgername_2 = @ledgername_2 + '-' + @crmname set @supledgerall_10 = @supledgerall_10 + convert(varchar(4000), @supledgerid_8) +'|'  INSERT INTO [FnaLedger] ( [ledgermark], [ledgername], [ledgertype], [ledgergroup], [ledgerbalance], [autosubledger], [ledgercurrency], [supledgerid], [categoryid], [supledgerall])  VALUES ( @ledgermark_1, @ledgername_2, @ledgertype_3, @ledgergroup_4, @ledgerbalance_5, '0', @ledgercurrency_7, @supledgerid_8, @categoryid_9, @supledgerall_10)  select @ledgerid1 = max(id) from FnaLedger update FnaLedger set subledgercount = subledgercount+1 where id = @supledgerid_8  select @ledgermark_1 = ledgermark, @ledgername_2= ledgername, @ledgertype_3= ledgertype, @ledgergroup_4=ledgergroup, @ledgerbalance_5= ledgerbalance, @ledgercurrency_7=ledgercurrency, @supledgerid_8=id , @categoryid_9=categoryid , @supledgerall_10 = supledgerall from FnaLedger where autosubledger = '4' set @ledgermark_1 = @ledgermark_1 + @crmcode set @ledgername_2 = @ledgername_2 + '-' + @crmname set @supledgerall_10 = @supledgerall_10 + convert(varchar(4000), @supledgerid_8) +'|'  INSERT INTO [FnaLedger] ( [ledgermark], [ledgername], [ledgertype], [ledgergroup], [ledgerbalance], [autosubledger], [ledgercurrency], [supledgerid], [categoryid], [supledgerall])  VALUES ( @ledgermark_1, @ledgername_2, @ledgertype_3, @ledgergroup_4, @ledgerbalance_5, '0', @ledgercurrency_7, @supledgerid_8, @categoryid_9, @supledgerall_10)  select @ledgerid2 = max(id) from FnaLedger update FnaLedger set subledgercount = subledgercount+1 where id = @supledgerid_8  end  select 0, @ledgerid1, @ledgerid2

GO
alter procedure [FnaLedger_Insert] (@ledgermark_1 	varchar(4000), @ledgername_2 	varchar(4000), @ledgertype_3 	[char](1), @ledgergroup_4 	[char](1), @ledgerbalance_5 	[char](1), @autosubledger_6 	[char](1), @ledgercurrency_7 	[char](1), @supledgerid_8 	[int], @categoryid_9 	[int], @supledgerall_10 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS declare @count integer , @init decimal(18,3)  if @supledgerid_8 <> 0 begin  select @init = initaccount from FnaLedger where id = @supledgerid_8 if @init <> 0 begin select -1 return end  select @count = count(id) from FnaTransactionDetail where ledgerid = @supledgerid_8 if @count <> 0 begin select -1 return end    end   select @count = count(id) from FnaLedger where ledgermark = @ledgermark_1 if @count <> 0 begin select -2 return end   if @autosubledger_6 <> '0' begin select @count = count(id) from FnaLedger where autosubledger = @autosubledger_6 if @count <> 0 begin select -3 return end end   INSERT INTO [FnaLedger] ( [ledgermark], [ledgername], [ledgertype], [ledgergroup], [ledgerbalance], [autosubledger], [ledgercurrency], [supledgerid], [categoryid], [supledgerall])  VALUES ( @ledgermark_1, @ledgername_2, @ledgertype_3, @ledgergroup_4, @ledgerbalance_5, @autosubledger_6, @ledgercurrency_7, @supledgerid_8, @categoryid_9, @supledgerall_10)  if @supledgerid_8 <> 0 begin update FnaLedger set subledgercount = subledgercount+1 where id = @supledgerid_8 end select max(id) from FnaLedger

GO
alter procedure [Wf_Right_insert_type6](			@dirid_1         INT, @dirtype_1       INT, @operationcode_1 INT, @subcompanyid_1  INT, @seclevel_1      INT, @flag            INT output, @msg             varchar(4000) output) AS INSERT INTO wfAccessControlList (dirid, dirtype, subcompanyid, seclevel, operationcode, permissiontype) VALUES     (@dirid_1, @dirtype_1, @subcompanyid_1, @seclevel_1, @operationcode_1, 6)  IF @@ERROR <> 0 BEGIN SET @flag=1 SET @msg='插入流程访问权限主表成功'  RETURN END ELSE BEGIN SET @flag=0 SET @msg='插入流程访问权限主表失败'  RETURN END

GO
alter procedure [Wf_Right_insert_type5](			@dirid_1         INT, @dirtype_1       INT, @operationcode_1 INT, @userid_1        INT, @flag            INT output, @msg             varchar(4000) output) AS INSERT INTO wfAccessControlList (dirid, dirtype, userid, operationcode, permissiontype) VALUES     (@dirid_1, @dirtype_1, @userid_1, @operationcode_1, 5)  IF @@ERROR <> 0 BEGIN SET @flag=1 SET @msg='插入流程访问权限主表成功'  RETURN END ELSE BEGIN SET @flag=0 SET @msg='插入流程访问权限主表失败'  RETURN END

GO
alter procedure [Wf_Right_insert_type4](			@dirid_1         INT, @dirtype_1       INT, @operationcode_1 INT, @usertype_1      INT, @seclevel_1      INT, @flag            INT output, @msg             varchar(4000) output) AS INSERT INTO wfAccessControlList (dirid, dirtype, usertype, seclevel, operationcode, permissiontype) VALUES     (@dirid_1, @dirtype_1, @usertype_1, @seclevel_1, @operationcode_1, 4)  IF @@ERROR <> 0 BEGIN SET @flag=1 SET @msg='插入流程访问权限主表成功'  RETURN END ELSE BEGIN SET @flag=0 SET @msg='插入流程访问权限主表失败'  RETURN END

GO
alter procedure [Wf_Right_insert_type3](			@dirid_1         INT, @dirtype_1       INT, @operationcode_1 INT, @seclevel_1      INT, @flag            INT output, @msg             varchar(4000) output) AS INSERT INTO wfAccessControlList (dirid, dirtype, seclevel, operationcode, permissiontype) VALUES     (@dirid_1, @dirtype_1, @seclevel_1, @operationcode_1, 3)  IF @@ERROR <> 0 BEGIN SET @flag=1 SET @msg='插入流程访问权限主表成功'  RETURN END ELSE BEGIN SET @flag=0 SET @msg='插入流程访问权限主表失败'  RETURN END

GO
alter procedure [Wf_Right_insert_type2] (		@dirid_1         INT, @dirtype_1       INT, @operationcode_1 INT, @roleid_1        INT, @rolelevel_1     INT, @seclevel_1      INT, @flag            INT output, @msg             varchar(4000) output) AS INSERT INTO wfAccessControlList (dirid, dirtype, roleid, rolelevel, seclevel, operationcode, permissiontype) VALUES     (@dirid_1, @dirtype_1, @roleid_1, @rolelevel_1, @seclevel_1, @operationcode_1, 2)  IF @@ERROR <> 0 BEGIN SET @flag=1 SET @msg='插入流程访问权限主表成功'  RETURN END ELSE BEGIN SET @flag=0 SET @msg='插入流程访问权限主表失败'  RETURN END

GO
alter procedure [Wf_Right_insert_type1](			@dirid_1         INT, @dirtype_1       INT, @operationcode_1 INT, @departmentid_1  INT, @seclevel_1      INT, @flag            INT output, @msg             varchar(4000) output) AS INSERT INTO wfAccessControlList (dirid, dirtype, departmentid, seclevel, operationcode, permissiontype) VALUES     (@dirid_1, @dirtype_1, @departmentid_1, @seclevel_1, @operationcode_1, 1)  IF @@ERROR <> 0 BEGIN SET @flag=1 SET @msg='插入流程访问权限主表成功'  RETURN END ELSE BEGIN SET @flag=0 SET @msg='插入流程访问权限主表失败'  RETURN END

GO
alter procedure [Wf_Right_delete](		  @mainid_1 INT, @flag     INT output, @msg      varchar(4000) output) AS DELETE FROM wfAccessControlList WHERE  mainid = @mainid_1  IF @@ERROR <> 0 BEGIN SET @flag=1 SET @msg='删除流程访问权限表成功'  RETURN END ELSE BEGIN SET @flag=0 SET @msg='删除流程访问权限表失败'  RETURN END

GO
alter procedure [Wf_Right_checkpermission2](	   @dirtype_1       INT, @userid_1        INT, @usertype_1      INT, @seclevel_1      INT, @operationcode_1 INT, @departmentid_1  INT, @subcompanyid_1  INT, @roleid_1        varchar(4000), @flag            INT output, @msg             varchar(4000) output) AS DECLARE @count_1 INT DECLARE @result INT  SET @result = 0 BEGIN SET @count_1 = (SELECT Count(mainid) FROM   wfAccessControlList WHERE  dirtype = @dirtype_1 AND operationcode = @operationcode_1 AND (  (permissiontype=1 AND departmentid = @departmentid_1 AND seclevel <= @seclevel_1 ) OR(permissiontype=2 AND roleid IN (SELECT * FROM   Splitstr(@roleid_1, ',')) AND seclevel <= @seclevel_1 ) OR( permissiontype = 3 AND seclevel <= @seclevel_1 ) OR( permissiontype = 4 AND usertype = @usertype_1 AND seclevel <= @seclevel_1 ) OR( permissiontype = 5 AND userid = @userid_1) OR( permissiontype = 6 AND subcompanyid=@subcompanyid_1 AND seclevel <= @seclevel_1) )) END  PRINT @count_1  IF ( NOT ( @count_1 IS NULL ) ) AND ( @count_1 > 0 ) BEGIN SET @result = 1 END  SELECT @result result  IF @@ERROR <> 0 BEGIN SET @flag=1 SET @msg='检查流程访问权限成功'  RETURN END ELSE BEGIN SET @flag=-1 SET @msg='检查流程访问权限失败'  RETURN END

GO
alter procedure [Contract_ShareInfo_SByCID] (@relateditemid_1 int , @flag integer output , @msg varchar(4000) output ) AS select * from Contract_ShareInfo where (relateditemid = @relateditemid_1 ) set  @flag = 1 set  @msg = 'ok'

GO
alter procedure [Contract_ShareInfo_Ins] ( @relateditemid int, @sharetype tinyint, @seclevel  tinyint, @seclevelMax  tinyint, @rolelevel tinyint, @sharelevel tinyint, @userid int, @departmentid int, @subcompanyid int ,@roleid int, @foralluser tinyint, @flag integer output, @msg varchar(4000) output ) AS INSERT INTO Contract_ShareInfo ( relateditemid, sharetype, seclevel, seclevelMax, rolelevel, sharelevel, userid, departmentid, subcompanyid ,roleid, foralluser ) VALUES ( @relateditemid , @sharetype , @seclevel , @seclevelMax , @rolelevel , @sharelevel, @userid, @departmentid, @subcompanyid ,@roleid, @foralluser  ) set @flag=1 set @msg='ok'

GO
alter procedure [Contract_ShareInfo_Del] (@id int, @flag integer output, @msg varchar(4000) output ) AS DELETE from Contract_ShareInfo  WHERE ( id = @id)

GO
alter procedure [CarDriverDataPara_Insert] (@driverdataid        int, @paraid        int, @flag integer output, @msg varchar(4000) output) AS insert into CarDriverDataPara values (@driverdataid,@paraid)

GO
alter procedure [CarDriverDataPara_Delete] (@driverdataid        int, @flag integer output, @msg varchar(4000) output) AS delete from CarDriverDataPara where driverdataid = @driverdataid

GO
alter procedure [CarType_Update] (   @id int, @name   varchar(4000), @description    varchar(4000), @usefee    decimal(10,2), @flag integer output, @msg varchar(4000) output) AS update cartype set name=@name,description=@description,usefee=@usefee where id=@id

GO
alter procedure [CarType_SelectByID] (   @id int, @flag integer output, @msg varchar(4000) output) AS select * from cartype where id=@id

GO
alter procedure [CarType_Select] (@flag integer output, @msg varchar(4000) output) AS select * from cartype

 GO
alter procedure [CarType_Insert] (@name 		varchar(4000), @description   varchar(4000), @usefee    decimal(10,2), @flag integer output, @msg varchar(4000) output) AS insert into cartype values (@name,@description,@usefee)

GO
alter procedure [CarType_Delete] (   @id int, @flag integer output, @msg varchar(4000) output) AS delete from cartype where id=@id

GO
alter procedure [CarParameter_Update] (   @id int, @name   varchar(4000), @paravalue  decimal(10,2), @description    varchar(4000), @flag integer output, @msg varchar(4000) output) AS update CarParameter set name=@name,description=@description,paravalue=@paravalue where id=@id

GO
alter procedure [CarParameter_SelectByID] (   @id int, @flag integer output, @msg varchar(4000) output) AS select * from CarParameter where id=@id

GO
alter procedure [CarParameter_Select] (@flag integer output, @msg varchar(4000) output) AS select * from CarParameter

GO
alter procedure [CarParameter_Insert] (@name 		varchar(4000), @paravalue decimal(10,2), @description   varchar(4000), @flag integer output, @msg varchar(4000) output) AS insert into CarParameter values (@name,@description,@paravalue)

GO
alter procedure [CarParameter_Delete] (   @id int, @flag integer output, @msg varchar(4000) output) AS delete from CarParameter where id=@id

GO
alter procedure [CarDriverData_Update] (@id        int, @driverid 		int, @cartypeid   int, @isreception   int, @startdate     char(10), @starttime     char(8), @backdate      char(10), @backtime      char(8), @startkm       decimal(10,2), @backkm        decimal(10,2), @runKM         decimal(10,2), @runtime       decimal(10,2), @normalkm      decimal(10,2), @overtimekm    decimal(10,2), @normaltime    decimal(10,2), @overtime      decimal(10,2), @realkm        decimal(10,2), @realtime      decimal(10,2), @useperson     varchar(4000), @usedepartment varchar(4000), @iscarout      int, @remark        text, @isholiday     char(1), @flag integer output, @msg varchar(4000) output) AS update CarDriverData set driverid=@driverid, cartypeid=@cartypeid, isreception=@isreception, startdate=@startdate, starttime=@starttime, backdate=@backdate, backtime=@backtime, startkm=@startkm, backkm=@backkm, runKM=@runKM, runtime=@runtime, normalkm=@normalkm, overtimekm=@overtimekm, normaltime=@normaltime, overtime=@overtime, realkm=@realkm, realtime=@realtime, useperson=@useperson, usedepartment=@usedepartment, iscarout=@iscarout, remark=@remark, isholiday=@isholiday where id=@id

GO
alter procedure [CarDriverData_Insert] (@driverid 		int, @cartypeid   int, @isreception   int, @startdate     char(10), @starttime     char(8), @backdate      char(10), @backtime      char(8), @startkm       decimal(10,2), @backkm        decimal(10,2), @runKM         decimal(10,2), @runtime       decimal(10,2), @normalkm      decimal(10,2), @overtimekm    decimal(10,2), @normaltime    decimal(10,2), @overtime      decimal(10,2), @realkm        decimal(10,2), @realtime      decimal(10,2), @useperson     varchar(4000), @usedepartment varchar(4000), @iscarout      int, @remark        text, @isholiday     char(1), @flag integer output, @msg varchar(4000) output) AS insert into CarDriverData values (@driverid,@cartypeid,@isreception,@startdate,@starttime,@backdate,@backtime,@startkm,@backkm, @runKM,@runtime,@normalkm,@overtimekm,@normaltime,@overtime,@realkm,@realtime,@useperson,@usedepartment,@iscarout,@remark,@isholiday)  select max(id) from cardriverdata

GO
alter procedure [CarDriverData_Delete] (@id        int, @flag integer output, @msg varchar(4000) output) AS delete from CarDriverData where id=@id

GO
alter procedure [CarDriverBasicinfo_Select] (   @flag integer output, @msg varchar(4000) output) AS select * from cardriverbasicinfo

GO
alter procedure [CarDriverBasicinfo_Insert] (   @basicsalary    decimal(10,2), @overtimepara   decimal(10,2), @receptionpara  decimal(10,2), @basicKM        decimal(10,2), @basicKMpara    decimal(10,2), @basictime      decimal(10,2), @basictimepara  decimal(10,2), @basicout       int, @basicoutpara   decimal(10,2), @publicpara     decimal(10,2), @flag integer output, @msg varchar(4000) output) AS declare @count int select @count=count(*) from cardriverbasicinfo if @count=0 insert into cardriverbasicinfo values (@basicsalary,@overtimepara,@receptionpara,@basicKM,@basicKMpara,@basictime,@basictimepara,@basicout,@basicoutpara,@publicpara) else update cardriverbasicinfo set basicsalary=@basicsalary,overtimepara=@overtimepara, receptionpara=@receptionpara,basicKM=@basicKM,basicKMpara=@basicKMpara, basictime=@basictime,basictimepara=@basictimepara,basicout=@basicout,basicoutpara=@basicoutpara,publicpara=@publicpara

GO
alter procedure [FnaTransaction_Update] (@id_1 	[int], @trandate_2 	[char](10), @trandepartmentid_3 	[int], @trancostercenterid_4 	[int], @trancurrencyid_5 	[int], @trandefcurrencyid_6 	[int], @tranexchangerate_7 	varchar(4000), @tranaccessories_8 	[tinyint], @tranresourceid_9 	[int], @trancrmid_10 	[int], @tranitemid_11 	[int], @trandocid_12 	[int], @tranprojectid_13 	[int], @trandaccount_14 	[decimal](18,3), @trancaccount_15 	[decimal](18,3), @trandefdaccount_16 	[decimal](18,3), @trandefcaccount_17 	[decimal](18,3), @tranremark_18 	varchar(4000), @transtatus_19 	[char](1), @createrid_20 	[int], @createdate_21 	[char](10), @flag                             integer output, @msg                             varchar(4000) output )  AS declare @count integer , @fnayear char(4) , @periodsid integer ,  @fnayearp char(6)  select @count = count(id) from FnaYearsPeriodsList where isclose = '0' and isactive = '1' and startdate <= @trandate_2 and enddate >= @trandate_2  if @count = 0 begin select -2 return end   select @fnayear = '' , @periodsid = 0 ,  @fnayearp = '' select @fnayear=fnayear , @periodsid=Periodsid from FnaYearsPeriodsList where startdate <= @trandate_2 and enddate >= @trandate_2   if @periodsid < 9 select @fnayearp = @fnayear + '0' + convert(char(1) , @periodsid) else select @fnayearp = @fnayear + convert(char(2) , @periodsid)  UPDATE [FnaTransaction]  SET	 [trandate]	 = @trandate_2, [tranperiods]   = @fnayearp , [trandepartmentid]	 = @trandepartmentid_3, [trancostercenterid]	 = @trancostercenterid_4, [trancurrencyid]	 = @trancurrencyid_5, [trandefcurrencyid]	 = @trandefcurrencyid_6, [tranexchangerate]	 = @tranexchangerate_7, [tranaccessories]	 = @tranaccessories_8, [tranresourceid]	 = @tranresourceid_9, [trancrmid]	 = @trancrmid_10, [tranitemid]	 = @tranitemid_11, [trandocid]	 = @trandocid_12, [tranprojectid]	 = @tranprojectid_13, [trandaccount]	 = @trandaccount_14, [trancaccount]	 = @trancaccount_15, [trandefdaccount]	 = @trandefdaccount_16, [trandefcaccount]	 = @trandefcaccount_17, [tranremark]	 = @tranremark_18, [transtatus]	 = @transtatus_19, [createrid]	 = @createrid_20, [createdate]	 = @createdate_21  WHERE ( [id]	 = @id_1)  DELETE [FnaTransactionDetail] WHERE  ( [tranid]	 = @id_1)  select @fnayearp

GO
alter procedure [FnaTransaction_SelectByMaxmark] (@flag                             integer output, @msg                             varchar(4000) output )  AS select max(tranmark) from FnaTransaction

GO
alter procedure [FnaTransaction_SelectByID] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS select * from FnaTransaction where id = @id_1

GO
alter procedure [FnaTransaction_Reopen] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS update FnaTransaction set transtatus='0' , approverid = null , approverdate=null where id = @id_1  select tranperiods from FnaTransaction where [id] = @id_1

GO
alter procedure [FnaTransaction_Insert] (@tranmark_1 	varchar(4000), @trandate_2 	[char](10), @trandepartmentid_3 	[int], @trancostercenterid_4 	[int], @trancurrencyid_5 	[int], @trandefcurrencyid_6 	[int], @tranexchangerate_7 	varchar(4000), @tranaccessories_8 	[tinyint], @tranresourceid_9 	[int], @trancrmid_10 	[int], @tranitemid_11 	[int], @trandocid_12 	[int], @tranprojectid_13 	[int], @trandaccount_14 	[decimal](18,3), @trancaccount_15 	[decimal](18,3), @trandefdaccount_16 	[decimal](18,3), @trandefcaccount_17 	[decimal](18,3), @tranremark_18 	varchar(4000), @transtatus_19 	[char](1), @createrid_20 	[int], @createdate_21 	[char](10), @flag                             integer output, @msg                             varchar(4000) output )  AS declare @count integer , @fnayear char(4) , @periodsid integer , @isclose char(1), @fnayearp char(6)  select @count = count(id) from FnaTransaction where tranmark = @tranmark_1 if @count <> 0 begin select -1,'0' return end  select @count = count(id) from FnaYearsPeriodsList where isclose = '0' and isactive = '1' and startdate <= @trandate_2 and enddate >= @trandate_2  if @count = 0 begin select -2,'0' return end   select @fnayear = '' , @periodsid = 0 ,  @fnayearp = '' select @fnayear=fnayear , @periodsid=Periodsid from FnaYearsPeriodsList where startdate <= @trandate_2 and enddate >= @trandate_2   if @periodsid < 9 select @fnayearp = @fnayear + '0' + convert(char(1) , @periodsid) else select @fnayearp = @fnayear + convert(char(2) , @periodsid)    INSERT INTO [FnaTransaction] ( [tranmark], [trandate], [tranperiods], [trandepartmentid], [trancostercenterid], [trancurrencyid], [trandefcurrencyid], [tranexchangerate], [tranaccessories], [tranresourceid], [trancrmid], [tranitemid], [trandocid], [tranprojectid], [trandaccount], [trancaccount], [trandefdaccount], [trandefcaccount], [tranremark], [transtatus], [createrid], [createdate])  VALUES ( @tranmark_1, @trandate_2, @fnayearp , @trandepartmentid_3, @trancostercenterid_4, @trancurrencyid_5, @trandefcurrencyid_6, @tranexchangerate_7, @tranaccessories_8, @tranresourceid_9, @trancrmid_10, @tranitemid_11, @trandocid_12, @tranprojectid_13, @trandaccount_14, @trancaccount_15, @trandefdaccount_16, @trandefcaccount_17, @tranremark_18, @transtatus_19, @createrid_20, @createdate_21)  select max(id) , @fnayearp from FnaTransaction

GO
alter procedure [FnaTransaction_Delete] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output )  AS select tranperiods from FnaTransaction where [id] = @id_1  DELETE [FnaTransaction] WHERE  ( [id]	 = @id_1)  DELETE [FnaTransactionDetail] WHERE  ( [tranid]	 = @id_1)

GO
alter procedure [FnaTransaction_Approve] @id_1 	[int], @approverid  [int], @approverdate  char(10), @flag integer output , @msg varchar(4000) output AS declare @count1 decimal(18,3) , @count2 decimal(18,3),@count0 integer select @count0 = count(id) from FnaTransaction where id = @id_1 and createrid = @approverid  if @count0 <> 0 begin select -1 return end  select @count1= sum(tranaccount) from FnaTransactionDetail where tranid = @id_1 and tranbalance = '1'  select @count2= sum(tranaccount) from FnaTransactionDetail where tranid = @id_1 and tranbalance = '2'  if @count1 is null set @count1 = 0 if @count2 is null set @count2 = 0  if @count1 <> @count2 begin select -2 return end  update FnaTransaction set transtatus='1' , approverid=@approverid , approverdate=@approverdate where id = @id_1  select tranperiods from FnaTransaction where id = @id_1

GO
alter procedure [FormLabelMaintenance] AS Declare @indexidn    int, @labelnamen  varchar(4000), @languageidn int, @all_cursor cursor SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select hl.* from (select h.indexid, count(h.languageid) cl from workflow_bill b, htmllabelinfo h where b.namelabel = h.indexid and b.id<0 group by h.indexid having count(h.languageid) < 3) r, htmllabelinfo hl where r.indexid = hl.indexid and languageid = 7 OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @indexidn ,	@labelnamen ,@languageidn WHILE @@FETCH_STATUS = 0 begin begin delete from htmllabelinfo where indexid = @indexidn end begin insert into htmllabelinfo values (@indexidn, @labelnamen, 7) end begin insert into htmllabelinfo values (@indexidn, @labelnamen, 8) end begin insert into htmllabelinfo values (@indexidn, @labelnamen, 9) end FETCH NEXT FROM @all_cursor INTO @indexidn ,	@labelnamen ,@languageidn end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [FnaYearsPeriodsList_Update] (@id_1 	[int], @startdate_2 	[char](10), @enddate_3 	[char](10), @fnayearid_4    int , @isactive_5 	[char](1), @flag integer output , @msg varchar(4000) output)  AS declare @minfromdate [char](10) declare @maxenddate [char](10)  UPDATE [FnaYearsPeriodsList] SET  [startdate]	 = @startdate_2, [enddate]	 = @enddate_3 , [isactive]	 = @isactive_5 WHERE ( [id]	 = @id_1)  select @minfromdate = min(startdate) from FnaYearsPeriodsList where fnayearid=@fnayearid_4 and startdate <> '' select @maxenddate = max(enddate) from FnaYearsPeriodsList where fnayearid=@fnayearid_4 and enddate <> ''  update FnaYearsPeriods set startdate=@minfromdate , enddate = @maxenddate where id = @fnayearid_4

GO
alter procedure [FnaYearsPeriodsList_SelectByID] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS declare @count integer ,  @fnayearperiodsid char(6) select @fnayearperiodsid = fnayearperiodsid from FnaYearsPeriodsList where id = @id_1 select @count = count(id) from FnaTransaction where tranperiods = @fnayearperiodsid if @count = 0 select @count = count(id) from FnaBudget where budgetperiods = @fnayearperiodsid  select id,fnayearid,Periodsid,fnayear,startdate,enddate,isclose,isactive,fnayearperiodsid,'trancount'=@count from FnaYearsPeriodsList where id = @id_1

  GO
alter procedure [FnaYearsPeriodsList_SByFnayear] ( @id_1 	[int], @flag integer output , @msg varchar(4000) output) AS SELECT * FROM FnaYearsPeriodsList WHERE fnayearid = @id_1 ORDER BY Periodsid

GO
alter procedure [FnaYearsPeriodsList_Reopen] (@id_1 	[int], @fnayearperiods  char(6), @flag integer output , @msg varchar(4000) output)  AS declare @count integer select @count = count(id) from FnaYearsPeriodsList where fnayearperiodsid > @fnayearperiods and isclose ='1'  if @count <> 0 begin select -1 return end  delete FnaAccount where tranperiods = @fnayearperiods delete FnaAccountDepartment where tranperiods = @fnayearperiods delete FnaAccountCostcenter where tranperiods = @fnayearperiods delete FnaAccountList where tranperiods > @fnayearperiods delete FnaBudgetDepartment where budgetperiods = @fnayearperiods delete FnaBudgetCostcenter where budgetperiods = @fnayearperiods update FnaTransaction set transtatus = '2' where tranperiods = @fnayearperiods update FnaTransaction set transtatus = '1' where tranperiods > @fnayearperiods update FnaBudget set budgetstatus = '2' where budgetperiods = @fnayearperiods   UPDATE [FnaYearsPeriodsList] SET  [isclose]	 = '0' WHERE ( [id]	 = @id_1)

GO
alter procedure [FnaYearsPeriodsList_Insert] (@fnayearid_1 	[int], @Periodsid_2 	[int], @fnayear_3 	[char](4), @startdate_4 	[char](10), @enddate_5 	[char](10), @isactive_6 	[char](1), @flag integer output , @msg varchar(4000) output)  AS declare @fnayearperiodsid char(6) if @Periodsid_2 <= 9 select @fnayearperiodsid = @fnayear_3 + '0' + convert(char(1),@Periodsid_2) else select @fnayearperiodsid = @fnayear_3 + convert(char(2),@Periodsid_2)  INSERT INTO [FnaYearsPeriodsList] ( [fnayearid], [Periodsid], [fnayear], [startdate], [enddate], [isactive], [fnayearperiodsid])  VALUES ( @fnayearid_1, @Periodsid_2, @fnayear_3, @startdate_4, @enddate_5, @isactive_6, @fnayearperiodsid)

GO
alter procedure [workflow_RequestLogID_Update] @flag integer output , @msg varchar(4000) output AS update workflow_requestlogsequence set requestlogid=requestlogid+1 select requestlogid from workflow_requestlogsequence

GO
alter procedure [workflow_RequestID_Update] @flag integer output , @msg varchar(4000) output AS update workflow_requestsequence set requestid=requestid+1  select requestid from workflow_requestsequence

GO
alter procedure [workflow_RUserDefault_Update] @userid	int, @selectedworkflow text, @isuserdefault    char(1), @hascreatetime char(1) , @hascreater char(1) , @hasworkflowname char(1) , @hasrequestlevel char(1) , @hasrequestname char(1) , @hasreceivetime char(1) , @hasstatus char(1) , @hasreceivedpersons char(1) , @hascurrentnode char(1) , @numperpage int , @noReceiveMailRemind char(1) , @Showoperator char(1) , @commonuse char(1) , @flag integer output , @msg varchar(4000) output AS Update workflow_requestUserdefault set selectedworkflow=@selectedworkflow , isuserdefault=@isuserdefault , hascreatetime=@hascreatetime , hascreater=@hascreater , hasworkflowname=@hasworkflowname , hasrequestlevel=@hasrequestlevel , hasrequestname=@hasrequestname , hasreceivetime=@hasreceivetime , hasstatus=@hasstatus , hasreceivedpersons=@hasreceivedpersons , hascurrentnode=@hascurrentnode , numperpage=@numperpage , noReceiveMailRemind=@noReceiveMailRemind, Showoperator=@Showoperator, commonuse=@commonuse where userid=@userid

GO
alter procedure [workflow_RUserDefault_Select] @userid	int, @flag integer output , @msg varchar(4000) output AS select * from workflow_requestUserdefault where userid=@userid

GO
alter procedure [workflow_RUserDefault_Insert] @userid	int, @selectedworkflow text, @isuserdefault    char(1), @hascreatetime char(1) , @hascreater char(1) , @hasworkflowname char(1) , @hasrequestlevel char(1) , @hasrequestname char(1) , @hasreceivetime char(1) , @hasstatus char(1) , @hasreceivedpersons char(1) , @hascurrentnode char(1) , @numperpage int , @noReceiveMailRemind char(1) , @Showoperator char(1) , @commonuse char(1) , @flag integer output , @msg varchar(4000) output AS insert into workflow_requestUserdefault(userid,selectedworkflow,isuserdefault,hascreatetime,hascreater,hasworkflowname,hasrequestlevel,hasrequestname,hasreceivetime,hasstatus,hasreceivedpersons,numperpage,hascurrentnode,noReceiveMailRemind,Showoperator,commonuse) values(@userid ,@selectedworkflow ,@isuserdefault ,@hascreatetime ,@hascreater ,@hasworkflowname ,@hasrequestlevel ,@hasrequestname ,@hasreceivetime ,@hasstatus ,@hasreceivedpersons ,@numperpage,@hascurrentnode,@noReceiveMailRemind,@Showoperator,@commonuse)

GO
alter procedure [workflow_RequestViewLog_Insert] @id	int, @viewer	int, @viewdate	char(10), @viewtime	char(8), @clientip	char(15), @viewtype 	int, @currentnodeid	int,@ordertype char(1),@showorder int, @flag integer output ,@msg varchar(4000) output AS insert into workflow_requestviewlog (id,viewer, viewdate,viewtime,ipaddress,viewtype,currentnodeid,ordertype,showorder) values(@id,@viewer, @viewdate,@viewtime,@clientip,@viewtype,@currentnodeid,@ordertype,@showorder)

GO
alter procedure [Meeting_Member_SelectByType] ( @meetingtype [int], @membertype [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Meeting_Member] where meetingtype = @meetingtype and membertype = @membertype set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Member_SelectAll] ( @meetingtype [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Meeting_Member] where meetingtype = @meetingtype order by membertype set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Member_Insert] (@meetingtype [int], @membertype [tinyint], @memberid [int], @desc_n varchar(4000), @flag integer output, @msg varchar(4000) output  )  AS INSERT INTO [Meeting_Member] ( [meetingtype],[membertype],[memberid],[desc_n])  VALUES ( @meetingtype, @membertype, @memberid, @desc_n ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Member_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting_Member] WHERE ( id = @id ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [WorkPlanExchange_Insert] ( @workPlanId_1 int, @memberId_1 int, @memberType_1 char(1), @flag integer output, @msg varchar(4000) output) AS INSERT INTO WorkPlanExchange ( workPlanId, memberId, memberType) VALUES ( @workPlanId_1, @memberId_1, @memberType_1)

GO
alter procedure [WorkPlanEditLog_Insert] ( @workPlanId_1 int, @fieldName_1 varchar(4000), @oldValue_1 varchar(4000), @newValue_1 varchar(4000), @userId_1 int, @userType_1 char(1), @ipAddress_1 char(15), @logDate_1 char(10), @logTime_1 char(8), @flag integer output , @msg varchar(4000) output) AS INSERT INTO WorkPlanEditLog ( workPlanId, fieldName, oldValue, newValue, userId, userType, ipAddress, logDate, logTime) VALUES ( @workPlanId_1, @fieldName_1, @oldValue_1, @newValue_1, @userId_1, @userType_1, @ipAddress_1, @logDate_1, @logTime_1)

GO
alter procedure [bill_CptApplyMain_Select] (@id 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptApplyMain] WHERE ( [id]	 = @id)

GO
alter procedure [Meeting_Service2_SelectAll] ( @meetingid [int],  @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Meeting_Service2] where meetingid = @meetingid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Service2_Insert] (@meetingid [int] , @hrmid [int] , @name varchar(4000) , @desc_n varchar(4000), @flag integer output, @msg varchar(4000) output) AS INSERT INTO [Meeting_Service2] ( [meetingid] ,[hrmid] ,[name], [desc_n])  VALUES ( @meetingid , @hrmid, @name , @desc_n) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Service2_Delete] (@meetingid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting_Service2] WHERE ( meetingid = @meetingid ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Service_SelectAll] ( @meetingtype [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Meeting_Service] where meetingtype = @meetingtype set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Service_Insert] (@meetingtype [int], @hrmid [int], @name varchar(4000), @desc_n varchar(4000), @flag integer output, @msg varchar(4000) output  )  AS INSERT INTO [Meeting_Service] ( [meetingtype],[hrmid],[name],[desc_n])  VALUES ( @meetingtype, @hrmid, @name, @desc_n ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Service_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting_Service] WHERE ( id = @id ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_MemberCrm_SelectAll] ( @memberrecid [int],  @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Meeting_MemberCrm] where memberrecid = @memberrecid set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_MemberCrm_Insert] (@meetingid [int] , @memberrecid [int] , @name varchar(4000), @sex [tinyint], @occupation varchar(4000), @tel  varchar(4000), @handset varchar(4000), @desc_n varchar(4000), @flag integer output, @msg varchar(4000) output) AS INSERT INTO [Meeting_MemberCrm] ( [meetingid] ,[memberrecid] ,[name], [sex] ,[occupation], [tel] ,[handset], [desc_n])  VALUES ( @meetingid , @memberrecid, @name, @sex , @occupation, @tel , @handset, @desc_n) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_MemberCrm_Delete] (@memberrecid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting_MemberCrm] WHERE ( memberrecid = @memberrecid ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Decision_SelectAll] ( @meetingid int,  @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM Meeting_Decision where meetingid = @meetingid  order by id set @flag = 1 set @msg = 'OK!'

GO
alter procedure [bill_HotelBookDetail_SByBooki] @bookid		int, @flag integer output , @msg varchar(4000) output as select * from bill_HotelBookDetail where bookid=@bookid

GO
alter procedure [bill_HotelBookDetail_Insert] @bookid		int, @hotelid    int, @roomstyle  varchar(4000), @roomsum    int, @flag integer output , @msg varchar(4000) output as insert into bill_HotelBookDetail (bookid,hotelid,roomstyle,roomsum) values (@bookid,@hotelid,@roomstyle,@roomsum)

GO
alter procedure [bill_HotelBookDetail_Delete] @bookid		int, @flag integer output , @msg varchar(4000) output as delete from bill_HotelBookDetail where bookid=@bookid

GO
alter procedure [bill_CptRequireDetail_Select] (@cptrequireid 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptRequireDetail] WHERE ( [cptrequireid]	 = @cptrequireid)

GO
alter procedure [bill_CptRequireDetail_Insert] (@cptrequireid 	[int], @cpttype 	[int], @cptid_1 	[int], @number_2 	[decimal](10,3), @unitprice_3 	[decimal](10,3), @needdate_5 	varchar(4000), @purpose_6 	varchar(4000), @cptdesc_7 	varchar(4000), @buynumber 	[decimal](10,3), @adjustnumber 	[decimal](10,3), @fetchnumber 	[decimal](10,3), @flag integer output , @msg varchar(4000) output )  AS INSERT INTO [bill_CptRequireDetail] ( [cptrequireid], [cpttype], [cptid], [number_n], [unitprice], [needdate], [purpose], [cptdesc], [buynumber], [adjustnumber], [fetchnumber])  VALUES ( @cptrequireid, @cpttype, @cptid_1, @number_2, @unitprice_3, @needdate_5, @purpose_6, @cptdesc_7, @buynumber, @adjustnumber, @fetchnumber )

GO
alter procedure [bill_CptFetchMain_Select] (@id 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptFetchMain] WHERE ( [id]	 = @id)

GO
alter procedure [bill_HrmFinance_SelectByID] @id		int, @flag			int	output, @msg			varchar(4000) output as select * from bill_hrmfinance where id=@id

 GO
alter procedure [bill_HrmFinance_Insert] @resourceid		int, @requestid		int, @billid			int, @basictype		int, @detailtype		int, @amount			decimal(10,2), @crmid			int, @projectid		int, @docid			int, @name			varchar(4000), @description	varchar(4000), @remark			varchar(4000), @occurdate		char(10), @occurtime		char(8), @relatedrequestid	int, @relatedresource	varchar(4000), @accessory		int, @debitledgeid	int, @debitremark        varchar(4000), @creditledgeid      int, @creditremark       varchar(4000), @currencyid         int, @exchangerate       varchar(4000), @status				char(1), @flag			int	output, @msg			varchar(4000) output as insert into bill_HrmFinance (resourceid,requestid,billid,basictype,detailtype,amount,crmid,projectid,docid,name, description,remark,occurdate,occurtime,relatedrequestid,relatedresource,accessory, debitledgeid,debitremark,creditledgeid,creditremark,currencyid,exchangerate,status) values (@resourceid,@requestid,@billid,@basictype,@detailtype,@amount,@crmid,@projectid,@docid,@name, @description,@remark,@occurdate,@occurtime,@relatedrequestid,@relatedresource,@accessory, @debitledgeid,@debitremark,@creditledgeid,@creditremark,@currencyid,@exchangerate,@status)  select max(id) from bill_hrmfinance

GO
alter procedure [bill_CptFetchDetail_Update] (@id_1 	[int], @cptid_3 	[int], @number_4 	[decimal](10,3), @unitprice_5 	[decimal](10,3), @amount_6 	[decimal](10,3), @needdate_7 	varchar(4000), @purpose_8 	varchar(4000), @cptdesc_9 	varchar(4000), @capitalid 	[int], @flag integer output , @msg varchar(4000) output)  AS UPDATE  [bill_CptFetchDetail]  SET [cptid]	 = @cptid_3, [number_n]	 = @number_4, [unitprice]	 = @unitprice_5, [amount]	 = @amount_6, [needdate]	 = @needdate_7, [purpose]	 = @purpose_8, [cptdesc]	 = @cptdesc_9 , [capitalid]	 = @capitalid  WHERE ( [id]	 = @id_1)

GO
alter procedure [bill_CptFetchDetail_Select] (@cptfetchid 	[int], @flag integer output , @msg varchar(4000) output)  AS select * from  [bill_CptFetchDetail] WHERE ( [cptfetchid]	 = @cptfetchid) order by id

GO
alter procedure [bill_CptFetchDetail_Insert] (@cptfetchid 	[int], @cptid_1 	[int], @capitalid_2 	[int], @number_3 	[decimal](10,3), @unitprice_4 	[decimal](10,3), @amount_5 	[decimal](10,3), @needdate_6 	varchar(4000), @purpose_7 	varchar(4000), @cptdesc_8 	varchar(4000), @flag integer output , @msg varchar(4000) output ) AS INSERT INTO [bill_CptFetchDetail] ( [cptfetchid], [cptid], [capitalid], [number_n], [unitprice], [amount], [needdate], [purpose], [cptdesc]) VALUES ( @cptfetchid, @cptid_1, @capitalid_2, @number_3, @unitprice_4, @amount_5, @needdate_6, @purpose_7, @cptdesc_8)

GO
alter procedure [bill_HrmFinance_UpdateStatus] (@id		int, @status	char(1), @flag integer output, @msg varchar(4000) output) AS update bill_hrmfinance set status=@status where id=@id

GO
alter procedure [bill_HrmFinance_UpdateRemind] @id	int, @isremind        int, @flag integer output , @msg varchar(4000) output AS Update bill_hrmfinance set isremind=@isremind where id=@id

GO
alter procedure [bill_HrmFinance_Update] @id				int, @resourceid		int, @requestid		int, @billid			int, @basictype		int, @detailtype		int, @amount			decimal(10,2), @crmid			int, @projectid		int, @docid			int, @name			varchar(4000), @description	varchar(4000), @remark			varchar(4000), @occurdate		char(10), @occurtime		char(8), @relatedrequestid	int, @relatedresource	varchar(4000), @accessory		int, @debitledgeid	int, @debitremark        varchar(4000), @creditledgeid      int, @creditremark       varchar(4000), @currencyid         int, @exchangerate       varchar(4000), @flag			int	output, @msg			varchar(4000) output as update bill_HrmFinance set resourceid=@resourceid,requestid=@requestid,billid=@billid, basictype=@basictype,detailtype=@detailtype,amount=@amount, crmid=@crmid,projectid=@projectid,docid=@docid,name=@name, description=@description,remark=@remark,occurdate=@occurdate, occurtime=@occurtime,relatedrequestid=@relatedrequestid, relatedresource=@relatedresource,accessory=@accessory, debitledgeid=@debitledgeid,debitremark=@debitremark, creditledgeid=@creditledgeid,creditremark=@creditremark, currencyid=@currencyid,exchangerate=@exchangerate where id=@id

GO
alter procedure [HrmSalaryWelfarerate_Insert] (@itemid_1 	int, @cityid_2 	int, @personwelfarerate_3 	decimal(10,2), @companywelfarerate_4 	decimal(10,2), @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO HrmSalaryWelfarerate ( itemid, cityid, personwelfarerate, companywelfarerate)  VALUES ( @itemid_1, @cityid_2, @personwelfarerate_3, @companywelfarerate_4)

GO
alter procedure [HrmSalaryWelfarerate_Delete] (@id_1 	int, @flag          integer output, @msg           varchar(4000) output)  AS DELETE HrmSalaryWelfarerate  WHERE ( id	 = @id_1)

GO
alter procedure [HrmSalaryTaxrate_Insert] (@benchid_1 	int, @ranknum_2 	int, @ranklow_3 	int, @rankhigh_4 	int, @taxrate_5 	int, @subtractnum_6 	int, @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO HrmSalaryTaxrate ( benchid, ranknum, ranklow, rankhigh, taxrate, subtractnum)  VALUES ( @benchid_1, @ranknum_2, @ranklow_3, @rankhigh_4, @taxrate_5, @subtractnum_6)

GO
alter procedure [HrmSalaryTaxbench_Insert] (@itemid_1 	int, @cityid_2 	int, @taxbenchmark_3 	int, @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO HrmSalaryTaxbench ( itemid, cityid, taxbenchmark)  VALUES ( @itemid_1, @cityid_2, @taxbenchmark_3)  select max(id) from HrmSalaryTaxbench

GO
alter procedure [HrmSalaryShiftPay_SByItemid] (@itemid_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS Select * from HrmSalaryShiftPay where itemid = @itemid_1

GO
alter procedure [HrmSalaryShiftPay_Insert] (@itemid_1 	int, @shiftid_2 	int, @shiftpay_3 	decimal(10,2), @flag	int	output, @msg	varchar(4000)	output)  AS INSERT INTO HrmSalaryShiftPay ( itemid, shiftid, shiftpay)  VALUES ( @itemid_1, @shiftid_2, @shiftpay_3)

GO
alter procedure [HrmSalaryShiftPay_Delete] (@itemid_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS DELETE HrmSalaryShiftPay WHERE ( itemid	 = @itemid_1)

GO
alter procedure [HrmSalaryPay_Update] (@id_1 	int, @isvalidate_2 	int, @flag          integer output, @msg           varchar(4000) output)  AS UPDATE HrmSalaryPay  SET  isvalidate	 = @isvalidate_2  WHERE ( id	 = @id_1)

GO
alter procedure [HrmSalaryPay_Insert] (@paydate_1 	varchar(4000), @isvalidate_2 	int, @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO HrmSalaryPay ( paydate, isvalidate)  VALUES ( @paydate_1, @isvalidate_2)  select max(id) from HrmSalaryPay

     GO
alter procedure [HrmSalaryPaydetail_Update] (@payid_1 	int, @itemid_2 	varchar(4000), @hrmid_3 	int, @salary_4 	decimal(10,2), @flag          integer output, @msg           varchar(4000) output)  AS declare @count int  select @count = count(payid) from HrmSalaryPaydetail where ( payid	 = @payid_1 AND itemid	 = @itemid_2 AND hrmid	 = @hrmid_3)  if @count is null or @count = 0 INSERT INTO HrmSalaryPaydetail ( payid, itemid, hrmid, salary)  VALUES ( @payid_1, @itemid_2, @hrmid_3, @salary_4) else UPDATE HrmSalaryPaydetail SET  salary	 = @salary_4 WHERE ( payid	 = @payid_1 AND itemid	 = @itemid_2 AND hrmid	 = @hrmid_3)

GO
alter procedure [HrmSalaryPaydetail_Insert] (@payid_1 	int, @itemid_2 	varchar(4000), @hrmid_3 	int, @salary_4 	decimal(10,2), @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO HrmSalaryPaydetail ( payid, itemid, hrmid, salary)  VALUES ( @payid_1, @itemid_2, @hrmid_3, @salary_4)

GO
alter procedure [HrmSalaryItem_Update] (@id_1 	int, @itemname_2 	varchar(4000), @itemcode_3 	varchar(4000), @itemtype_4 	char(1), @personwelfarerate_5 	int, @companywelfarerate_6 	int, @taxrelateitem_7 	int, @amountecp_8 	varchar(4000), @feetype_9 	int, @isshow_10 	char(1), @showorder_11 	int, @ishistory_12 	char(1) , @applyscope_13 	int ,@calMode_14 int, @directModify_15 int,@personalPercent_16 float,@companyPercent_17 float, @flag          integer output, @msg           varchar(4000) output)  AS declare @olditemtype_1 char(1) declare @benchid_1 int select @olditemtype_1 = itemtype from HrmSalaryItem where id = @id_1 UPDATE HrmSalaryItem SET  itemname	 = @itemname_2, itemcode	 = @itemcode_3, itemtype	 = @itemtype_4, personwelfarerate	 = @personwelfarerate_5, companywelfarerate	 = @companywelfarerate_6, taxrelateitem	 = @taxrelateitem_7, amountecp	 = @amountecp_8, feetype	 = @feetype_9, isshow	 = @isshow_10, showorder	 = @showorder_11, ishistory	 = @ishistory_12,applyscope=@applyscope_13,calMode=@calMode_14,directModify=@directModify_15,personalPercent=@personalPercent_16,companyPercent=@companyPercent_17  WHERE ( id	 = @id_1) if @olditemtype_1 = '1' begin delete from HrmSalaryRank where itemid = @id_1 delete from HrmSalaryResourcePay where itemid = @id_1 delete from HrmSalaryTaxscope where itemid = @id_1 end else if @olditemtype_1 = '2' begin delete from HrmSalaryRank where itemid = @id_1 delete from HrmSalaryWelfarerate where itemid = @id_1 delete from HrmSalaryResourcePay where itemid = @id_1 end else if @olditemtype_1 = '5' or @olditemtype_1 = '6' delete from HrmSalarySchedule where itemid = @id_1 else if @olditemtype_1 = '7' delete from HrmSalaryShiftPay where itemid = @id_1 else if @olditemtype_1 = '8' delete from HrmSalaryResourcePay where itemid = @id_1 else if @olditemtype_1 = '3' begin declare benchid_cursor cursor for select id from HrmSalaryTaxbench where itemid = @id_1 open benchid_cursor fetch next from benchid_cursor into @benchid_1 while @@fetch_status=0 begin delete from HrmSalaryTaxrate where benchid = @benchid_1 delete from HrmSalaryTaxbench where id = @benchid_1 fetch next from benchid_cursor into @benchid_1 end close benchid_cursor deallocate benchid_cursor end else if @olditemtype_1 = '4' or @olditemtype_1 = '9' begin declare benchid_cursor cursor for select id from HrmSalaryCalBench where itemid = @id_1 open benchid_cursor fetch next from benchid_cursor into @benchid_1 while @@fetch_status=0 begin delete from HrmSalaryCalRate where benchid = @benchid_1 delete from HrmSalaryCalBench where id = @benchid_1 fetch next from benchid_cursor into @benchid_1 end close benchid_cursor deallocate benchid_cursor end

GO
alter procedure [HrmSalaryItem_SelectByID] (@id_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryItem WHERE id=@id_1 set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryItem_SelectAll] (@flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryItem order by showorder  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryItem_Insert] (@itemname_1 	varchar(4000), @itemcode_2 	varchar(4000), @itemtype_3 	char(1), @personwelfarerate_4 	int, @companywelfarerate_5 	int, @taxrelateitem_6 	int, @amountecp_7 	varchar(4000), @feetype_8 	int, @isshow_9 	char(1), @showorder_10 	int, @ishistory_11 	char(1), @subcompanyid_12 int, @applyscope_13 int, @calMode_14 	int, @directModify_15  int, @personalPercent_16 float, @companyPercent_17 float, @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO HrmSalaryItem (itemname, itemcode, itemtype, personwelfarerate, companywelfarerate, taxrelateitem, amountecp, feetype, isshow, showorder, ishistory, subcompanyid, applyscope, calMode, directModify, personalPercent, companyPercent)  VALUES ( @itemname_1, @itemcode_2, @itemtype_3, @personwelfarerate_4, @companywelfarerate_5, @taxrelateitem_6, @amountecp_7, @feetype_8, @isshow_9, @showorder_10, @ishistory_11, @subcompanyid_12, @applyscope_13, @calMode_14, @directModify_15, @personalPercent_16, @companyPercent_17 )  select max(id) from HrmSalaryItem

GO
alter procedure [HrmSalaryItem_Delete] (@id_1 	int , @flag          integer output, @msg           varchar(4000) output) AS declare @olditemtype_1 char(1) declare @benchid_1 int select @olditemtype_1 = itemtype from HrmSalaryItem where id = @id_1 DELETE HrmSalaryItem WHERE ( id	 = @id_1) if @olditemtype_1 = '1' begin delete from HrmSalaryRank where itemid = @id_1 delete from HrmSalaryResourcePay where itemid = @id_1 delete from HrmSalaryTaxscope where itemid = @id_1 end else if @olditemtype_1 = '5' or @olditemtype_1 = '6' delete from HrmSalarySchedule where itemid = @id_1 else if @olditemtype_1 = '7' delete from HrmSalaryShiftPay where itemid = @id_1 else if @olditemtype_1 = '8' delete from HrmSalaryResourcePay where itemid = @id_1 else if @olditemtype_1 = '2' begin delete from HrmSalaryRank where itemid = @id_1 delete from HrmSalaryWelfarerate where itemid = @id_1 delete from HrmSalaryResourcePay where itemid = @id_1 end else if @olditemtype_1 = '3' begin delete from HrmSalaryTaxscope where itemid=@id_1 declare benchid_cursor cursor for select id from HrmSalaryTaxbench where itemid = @id_1 open benchid_cursor fetch next from benchid_cursor into @benchid_1 while @@fetch_status=0 begin delete from HrmSalaryTaxrate where benchid = @benchid_1 delete from HrmSalaryTaxbench where id = @benchid_1 fetch next from benchid_cursor into @benchid_1 end close benchid_cursor deallocate benchid_cursor end else if @olditemtype_1 = '4' or @olditemtype_1 = '9' begin declare benchid_cursor cursor for select id from HrmSalaryCalBench where itemid = @id_1 open benchid_cursor fetch next from benchid_cursor into @benchid_1 while @@fetch_status=0 begin delete from HrmSalaryCalRate where benchid = @benchid_1 delete from HrmSalaryCalBench where id = @benchid_1 fetch next from benchid_cursor into @benchid_1 end close benchid_cursor deallocate benchid_cursor end

GO
alter procedure [HrmSalaryDiffDetail_Insert] (@itemid_1 	int, @resourceid_2 	int, @payid_3 	int, @diffid_4 	int, @difftypeid_5 	int, @startdate_6 	char(10), @enddate_7 	char(10), @realcounttime_8 	int, @realcountpay_9 	decimal(10,2) , @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO HrmSalaryDiffDetail ( itemid, resourceid, payid, diffid, difftypeid, startdate, enddate, realcounttime, realcountpay)  VALUES ( @itemid_1, @resourceid_2, @payid_3, @diffid_4, @difftypeid_5, @startdate_6, @enddate_7, @realcounttime_8, @realcountpay_9)

GO
alter procedure [HrmSalaryHistory_SByHrmid] (@hrmid_1 int, @flag	int	output, @msg	varchar(4000)	output) AS SELECT * FROM HrmSalaryHistory WHERE hrmid=@hrmid_1 set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryCreateInfo_Select] (@hasdone_1 	char(1), @flag int output, @msg varchar(4000) output)  AS  select * from HrmSalaryCreateInfo where hasdone = @hasdone_1

GO
alter procedure [HrmSalaryCreateInfo_Insert] (@currentdate_1 	char(7), @salarybegindate_2 	char(10), @salaryenddate_3 	char(10), @payid_4 	varchar(4000), @plandate_5 	char(10), @flag int output, @msg varchar(4000) output)  AS INSERT INTO HrmSalaryCreateInfo ( currentdate, salarybegindate, salaryenddate, payid, plandate)  VALUES ( @currentdate_1, @salarybegindate_2, @salaryenddate_3, @payid_4, @plandate_5)

GO
alter procedure [HrmSalaryCreateInfo_Delete] (@id_1 	int, @flag int output, @msg varchar(4000) output)  AS DELETE HrmSalaryCreateInfo  WHERE ( id	 = @id_1)

GO
alter procedure [HrmSalaryScheduleDec_Insert]( @itemid_2 int , @diffid_1 int , @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO HrmSalarySchedule( diffid , itemid) VALUES( @diffid_1 , @itemid_2) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryScheduleAdd_Insert]( @itemid_2 int , @diffid_1 int , @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO HrmSalarySchedule( diffid , itemid) VALUES( @diffid_1 , @itemid_2) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryResult_Insert] (@yearmonth_1 varchar(4000), @flag	int	output, @msg	varchar(4000)	output) AS declare @itemid_1 int, @hrmid_1 int, @salary_1 decimal(12,2), @all_cursor	cursor SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select  itemid, hrmid, salary from HrmSalaryPersonality OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @itemid_1,@hrmid_1,@salary_1 WHILE @@FETCH_STATUS = 0 begin INSERT INTO HrmSalaryResult (  itemid, hrmid , salary, yearmonth)  VALUES (  @itemid_1, @hrmid_1, @salary_1, @yearmonth_1) FETCH NEXT FROM @all_cursor INTO @itemid_1,@hrmid_1,@salary_1 end CLOSE @all_cursor DEALLOCATE @all_cursor set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSalaryResourcePay_SByItemid] (@itemid_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS Select * from HrmSalaryResourcePay where itemid = @itemid_1

GO
alter procedure [HrmSalaryResourcePay_Insert] (@itemid_1 	int, @resourceid_2 	int, @resourcepay_3 	decimal(10,2),@isBatch_4 char, @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO HrmSalaryResourcePay (itemid, resourceid, resourcepay,isBatch) VALUES ( @itemid_1, @resourceid_2, @resourcepay_3,@isBatch_4)

GO
alter procedure [HrmSalaryResourcePay_Delete] (@itemid_1 	int, @flag	int	output, @msg	varchar(4000)	output)  AS DELETE HrmSalaryResourcePay WHERE ( itemid	 = @itemid_1)

GO
alter procedure [HrmSalaryComponentDetail_SByID] @id   int, @flag integer output , @msg varchar(4000) output AS select * from HrmSalaryComponentDetail where  componentid= @id set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmSalaryComponentDetail_I] @componentid	int, @detailmark                   varchar(4000), @joblevel              tinyint, @salarysum_temp	varchar(4000), @editable	char(1), @flag                              integer output, @msg                             varchar(4000) output  AS declare @salarysum	decimal(10,3) if @salarysum_temp='' set @salarysum=null else set @salarysum=@salarysum_temp INSERT INTO [HrmSalaryComponentDetail] VALUES(@componentid,@detailmark,@joblevel,@salarysum,@editable)  if @@error<>0 begin set @flag=1 set @msg='操作失败' return end else begin set @flag=0 set @msg='操作成功' return end

GO
alter procedure [HrmSalaryComponentDetail_D] @componentid	int, @flag                              integer output, @msg                             varchar(4000) output  AS delete from HrmSalaryComponentDetail where componentid=@componentid  if @@error<>0 begin set @flag=1 set @msg='操作失败' return end else begin set @flag=0 set @msg='操作成功' return end

GO
alter procedure [HrmPubHoliday_Insert] (@countryid_1 	int, @holidaydate_2 	char(10), @holidayname_3 	varchar(4000), @changetype_4  int , @relateweekday_5 int , @flag integer output, @msg varchar(4000) output) AS if  not exists( select * from hrmpubholiday where countryid=@countryid_1 and holidaydate=@holidaydate_2) begin INSERT INTO HrmPubHoliday ( countryid, holidaydate, holidayname,changetype,relateweekday) VALUES ( @countryid_1, @holidaydate_2, @holidayname_3,@changetype_4,@relateweekday_5) end select max(id) from hrmpubholiday

GO
alter procedure [HrmPubHoliday_Delete] (@id int, @countryid  int, @flag integer output, @msg varchar(4000) output)  AS delete from hrmpubholiday where id=@id if  @@error<>0 begin set @flag=1 set @msg='失败' end else begin set @flag=0 set @msg='操作成功' end select @flag,@msg

GO
alter procedure [HrmPubHoliday_Copy]( @fromyear  varchar(4000), @toyear    varchar(4000), @countryid varchar(4000), @flag      INTEGER OUTPUT, @msg       varchar(4000) OUTPUT) AS DELETE FROM hrmpubholiday WHERE       Substring(holidaydate,1,4) = @toyear AND countryid = @countryid DECLARE @all_cursor  CURSOR, @tempdate   varchar(4000), @tempname   varchar(4000), @temptype   varchar(4000) SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR SELECT Substring(holidaydate,5,6), holidayname , changetype FROM   hrmpubholiday WHERE  Substring(holidaydate,1,4) = @fromyear AND countryid = @countryid OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @tempdate,@tempname,@temptype WHILE @@FETCH_STATUS = 0 BEGIN INSERT INTO hrmpubholiday(countryid, holidaydate, holidayname, changetype) VALUES     (@countryid, @toyear + @tempdate, @tempname, @temptype) FETCH NEXT FROM @all_cursor INTO @tempdate,@tempname,@temptype END CLOSE @all_cursor DEALLOCATE @all_cursor IF @@ERROR <> 0 BEGIN SET @flag = 1 SET @msg = '插入失败' END ELSE BEGIN SET @flag = 0 SET @msg = '操作成功' END

GO
alter procedure [HrmResourceComponent_SByResour] (@id_1 	[int], @flag int output, @msg varchar(4000) output) AS select * from HrmResourceComponent where resourceid = @id_1

GO
alter procedure [HrmResourceComponent_SByID] (@id_1 	[int], @flag int output, @msg varchar(4000) output) AS select * from HrmResourceComponent where id = @id_1

GO
alter procedure [HrmSalaryComponentTypes_Update] @id	int, @typemark                     varchar(4000), @typename                    varchar(4000), @colorid                         varchar(4000), @typeorder	            int, @flag                              integer output, @msg                             varchar(4000) output  AS UPDATE hrmsalarycomponenttypes set typemark=@typemark,typename=@typename,colorid=@colorid,typeorder=@typeorder where id=@id  if @@error<>0 begin set @flag=1 set @msg='操作失败' return end else begin set @flag=0 set @msg='操作成功' return end

GO
alter procedure [HrmSalaryComponentTypes_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmSalaryComponentTypes order by typeorder set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmSalaryComponentTypes_Insert] @typemark                     varchar(4000), @typename                    varchar(4000), @colorid                         varchar(4000), @typeorder	            int, @flag                              integer output, @msg                             varchar(4000) output  AS INSERT INTO [HrmSalaryComponentTypes] VALUES (@typemark,@typename,@colorid,@typeorder)  select max(id) from [HrmSalaryComponentTypes]  if @@error<>0 begin set @flag=1 set @msg='操作失败' return end else begin set @flag=0 set @msg='操作成功' return end

GO
alter procedure [HrmSalaryComponentTypes_Delete] @id                                  int, @flag                              integer output, @msg                             varchar(4000) output  AS delete from HrmSalaryComponentTypes where id=@id  if @@error<>0 begin set @flag=1 set @msg='操作失败' return end else begin set @flag=0 set @msg='操作成功' return end

GO
alter procedure [HrmRoleMembers_Update] (@id_1 	[int], @rolelevel_2 	[char](1), @flag int output, @msg varchar(4000) output)  AS UPDATE [HrmRoleMembers]  SET  [rolelevel]	 = @rolelevel_2  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmRoleMembers_SelectByID] (@id_1 	[int], @flag int output, @msg varchar(4000) output)  AS select * from HrmRoleMembers WHERE ( [id] = @id_1)

GO
alter procedure [HrmRoleMembers_SByResourceID] (@id_1 	[int], @flag int output, @msg varchar(4000) output)  AS select * from HrmRoleMembers WHERE ( [resourceid] = @id_1)

GO
alter procedure [HrmRoleMembers_SByIDandLevel] (@id_1 	[int], @level_n char(1), @flag int output, @msg varchar(4000) output)  AS select * from HrmRoleMembers WHERE ( [roleid] = @id_1) and [rolelevel] >= @level_n

GO
alter procedure [Prj_ProcessingType_Update] (@id	 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [Prj_ProcessingType]  SET  [fullname]	 = @fullname, [description]	 = @description  WHERE ( [id]	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmSpeciality_Update] (@id_1 	[int], @name_2 	varchar(4000), @description_3 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS UPDATE [HrmSpeciality]  SET  [name]	 = @name_2, [description]	 = @description_3  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmSpeciality_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmSpeciality where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmSpeciality_Select] @flag integer output , @msg varchar(4000) output  AS select * from HrmSpeciality set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmSpeciality_Insert] (@name_1 	varchar(4000), @description_2 	varchar(4000), @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [HrmSpeciality] ( [name], [description])  VALUES ( @name_1, @description_2)

GO
alter procedure [HrmSpeciality_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmSpeciality]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmShare_SelectByHrmApply] ( @hrmid int, @applyid int, @flag integer output, @msg varchar(4000) output) as select * from HrmShare where hrmid=@hrmid and applyid=@applyid

GO
alter procedure [HrmShare_SelectByApply] ( @applyid int, @flag integer output, @msg varchar(4000) output) as select * from HrmShare where applyid=@applyid

GO
alter procedure [HrmShare_Insert] (@hrmid int, @applyid int, @flag integer output, @msg varchar(4000) output) as DECLARE	@count integer select @count=count(*) from HrmShare where hrmid= @hrmid and applyid= @applyid IF @count > 0 return INSERT INTO HrmShare (hrmid,applyid) values (@hrmid, @applyid)

GO
alter procedure [HrmShare_Delete] ( @hrmid int, @applyid int, @flag integer output, @msg varchar(4000) output) as delete  from HrmShare where hrmid=@hrmid and applyid=@applyid

GO
alter procedure [HrmSearchMouldDefine_Update] (@id_1 int, @dff01name varchar(4000),@dff02name varchar(4000),@dff03name varchar(4000),@dff04name varchar(4000),@dff05name varchar(4000),@dff01nameto varchar(4000),@dff02nameto varchar(4000),@dff03nameto varchar(4000),@dff04nameto varchar(4000),@dff05nameto varchar(4000), @nff01name varchar(4000),@nff02name varchar(4000),@nff03name varchar(4000),@nff04name varchar(4000),@nff05name varchar(4000),@nff01nameto varchar(4000),@nff02nameto varchar(4000),@nff03nameto varchar(4000),@nff04nameto varchar(4000),@nff05nameto varchar(4000), @tff01name varchar(4000),@tff02name varchar(4000),@tff03name varchar(4000),@tff04name varchar(4000),@tff05name varchar(4000),@bff01name tinyint, @bff02name tinyint,@bff03name tinyint,@bff04name tinyint,@bff05name tinyint, @flag int output, @msg varchar(4000) output) as update HrmSearchMould set datefield1 = @dff01name ,datefield2 = @dff02name ,datefield3 = @dff03name ,datefield4 = @dff04name ,datefield5 = @dff05name ,datefieldto1 = @dff01nameto ,datefieldto2 = @dff02nameto ,datefieldto3 = @dff03nameto ,datefieldto4 = @dff04nameto ,datefieldto5 = @dff05nameto ,numberfield1 = @nff01name ,numberfield2 = @nff02name ,numberfield3 = @nff03name ,numberfield4 = @nff04name ,numberfield5 = @nff05name ,numberfieldto1 = @nff01nameto ,numberfieldto2 = @nff02nameto ,numberfieldto3 = @nff03nameto ,numberfieldto4 = @nff04nameto ,numberfieldto5 = @nff05nameto ,textfield1 = @tff01name ,textfield2 = @tff02name ,textfield3 = @tff03name ,textfield4 = @tff04name ,textfield5 = @tff05name ,tinyintfield1 = @bff01name,tinyintfield2 = @bff02name,tinyintfield3 = @bff03name,tinyintfield4 = @bff04name,tinyintfield5 = @bff05name where id = @id_1

GO
alter procedure [HrmSearchMould_Update] (@id_1 	int, @userid_2 	int, @resourceid_3 	int, @resourcename_4 	varchar(4000), @jobtitle_5 	int, @activitydesc_6 	varchar(4000), @jobgroup_7 	int, @jobactivity_8 	int, @costcenter_9 	int, @competency_10 	int, @resourcetype_11 	char(1), @status_12 	char(1), @subcompany1_13 	int, @department_14 	varchar(4000), @location_15 	int, @manager_16 	int, @assistant_17 	int, @roles_18 	int, @seclevel_19 	tinyint, @joblevel_20 	tinyint, @workroom_21 	varchar(4000), @telephone_22 	varchar(4000), @startdate_23 	char(10), @enddate_24 	char(10), @contractdate_25 	char(10), @birthday_26 	char(10), @sex_27 	char(1), @seclevelTo_28 	tinyint, @joblevelTo_29 	tinyint, @startdateTo_30 	char(10), @enddateTo_31 	char(10), @contractdateTo_32 	char(10), @birthdayTo_33 	char(10), @age_34 	int, @ageTo_35 	int, @resourceidfrom_36 	int, @resourceidto_37 	int, @workcode_38 	varchar(4000), @jobcall_39 	int, @mobile_40 	varchar(4000), @mobilecall_41 	varchar(4000), @fax_42 	varchar(4000), @email_43 	varchar(4000), @folk_44 	varchar(4000), @nativeplace_45 	varchar(4000), @regresidentplace_46 	varchar(4000), @maritalstatus_47 	char(1), @certificatenum_48 	varchar(4000), @tempresidentnumber_49 	varchar(4000), @residentplace_50 	varchar(4000), @homeaddress_51 	varchar(4000), @healthinfo_52 	char(1), @heightfrom_53 	int, @heightto_54 	int, @weightfrom_55 	int, @weightto_56 	int, @educationlevel_57 	int, @degree_58 	varchar(4000), @usekind_59 	int, @policy_60 	varchar(4000), @bememberdatefrom_61 	char(10), @bememberdateto_62 	char(10), @bepartydatefrom_63 	char(10), @bepartydateto_64 	char(10), @islabouunion_65 	char(1), @bankid1_66 	int, @accountid1_67 	varchar(4000), @accumfundaccount_68 	varchar(4000), @loginid_69 	varchar(4000), @systemlanguage_70 	int, @birthdayyear_71   int, @birthdaymonth_72  int, @birthdayday_73    int, @educationlevelto_74   int, @accounttype_75 int, @flag int output, @msg varchar(4000) output)  AS UPDATE HrmSearchMould  SET      userid	 = @userid_2, resourceid	 = @resourceid_3, resourcename	 = @resourcename_4, jobtitle	 = @jobtitle_5, activitydesc	 = @activitydesc_6, jobgroup	 = @jobgroup_7, jobactivity	 = @jobactivity_8, costcenter	 = @costcenter_9, competency	 = @competency_10, resourcetype	 = @resourcetype_11, status	 = @status_12, subcompany1	 = @subcompany1_13, department	 = @department_14, location	 = @location_15, manager	 = @manager_16, assistant	 = @assistant_17, roles	 = @roles_18, seclevel	 = @seclevel_19, joblevel	 = @joblevel_20, workroom	 = @workroom_21, telephone	 = @telephone_22, startdate	 = @startdate_23, enddate	 = @enddate_24, contractdate	 = @contractdate_25, birthday	 = @birthday_26, sex	 = @sex_27, seclevelTo	 = @seclevelTo_28, joblevelTo	 = @joblevelTo_29, startdateTo	 = @startdateTo_30, enddateTo	 = @enddateTo_31, contractdateTo	 = @contractdateTo_32, birthdayTo	 = @birthdayTo_33, age	 = @age_34, ageTo	 = @ageTo_35, resourceidfrom	 = @resourceidfrom_36, resourceidto	 = @resourceidto_37, workcode	 = @workcode_38, jobcall	 = @jobcall_39, mobile	 = @mobile_40, mobilecall	 = @mobilecall_41, fax	 = @fax_42, email	 = @email_43, folk	 = @folk_44, nativeplace	 = @nativeplace_45, regresidentplace	 = @regresidentplace_46, maritalstatus	 = @maritalstatus_47, certificatenum	 = @certificatenum_48, tempresidentnumber	 = @tempresidentnumber_49, residentplace	 = @residentplace_50, homeaddress	 = @homeaddress_51, healthinfo	 = @healthinfo_52, heightfrom	 = @heightfrom_53, heightto	 = @heightto_54, weightfrom	 = @weightfrom_55, weightto	 = @weightto_56, educationlevel	 = @educationlevel_57, degree	 = @degree_58, usekind	 = @usekind_59, policy	 = @policy_60, bememberdatefrom	 = @bememberdatefrom_61, bememberdateto	 = @bememberdateto_62, bepartydatefrom	 = @bepartydatefrom_63, bepartydateto	 = @bepartydateto_64, islabouunion	 = @islabouunion_65, bankid1	 = @bankid1_66, accountid1	 = @accountid1_67, accumfundaccount	 = @accumfundaccount_68, loginid	 = @loginid_69, systemlanguage	 = @systemlanguage_70 , birthdayyear   =   @birthdayyear_71   , birthdaymonth  =   @birthdaymonth_72  , birthdayday    =   @birthdayday_73    , educationlevelto   =   @educationlevelto_74,accounttype =@accounttype_75  WHERE ( id	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmSearchMould_SelectByUserID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmSearchMould where userid =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmSearchMould_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmSearchMould where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmSearchMould_Insert] (@mouldname_1 	varchar(4000), @userid_2 	int, @resourceid_3 	int, @resourcename_4 	varchar(4000), @jobtitle_5 	int, @activitydesc_6 	varchar(4000), @jobgroup_7 	int, @jobactivity_8 	int, @costcenter_9 	int, @competency_10 	int, @resourcetype_11 	char(1), @status_12 	char(1), @subcompany1_13 	int, @department_14 	varchar(4000), @location_15 	int, @manager_16 	int, @assistant_17 	int, @roles_18 	int, @seclevel_19 	tinyint, @joblevel_20 	tinyint, @workroom_21 	varchar(4000), @telephone_22 	varchar(4000), @startdate_23 	char(10), @enddate_24 	char(10), @contractdate_25 	char(10), @birthday_26 	char(10), @sex_27 	char(1), @seclevelTo_28 	tinyint, @joblevelTo_29 	tinyint, @startdateTo_30 	char(10), @enddateTo_31 	char(10), @contractdateTo_32 	char(10), @birthdayTo_33 	char(10), @age_34 	int, @ageTo_35 	int, @resourceidfrom_36 	int, @resourceidto_37 	int, @workcode_38 	varchar(4000), @jobcall_39 	int, @mobile_40 	varchar(4000), @mobilecall_41 	varchar(4000), @fax_42 	varchar(4000), @email_43 	varchar(4000), @folk_44 	varchar(4000), @nativeplace_45 	varchar(4000), @regresidentplace_46 	varchar(4000), @maritalstatus_47 	char(1), @certificatenum_48 	varchar(4000), @tempresidentnumber_49 	varchar(4000), @residentplace_50 	varchar(4000), @homeaddress_51 	varchar(4000), @healthinfo_52 	char(1), @heightfrom_53 	int, @heightto_54 	int, @weightfrom_55 	int, @weightto_56 	int, @educationlevel_57 	int, @degree_58 	varchar(4000), @usekind_59 	int, @policy_60 	varchar(4000), @bememberdatefrom_61 	char(10), @bememberdateto_62 	char(10), @bepartydatefrom_63 	char(10), @bepartydateto_64 	char(10), @islabouunion_65 	char(1), @bankid1_66 	int, @accountid1_67 	varchar(4000), @accumfundaccount_68 	varchar(4000), @loginid_69 	varchar(4000), @systemlanguage_70 	int, @birthdayyear_71   int, @birthdaymonth_72  int, @birthdayday_73    int, @educationlevelto_74   int,@accounttype_75 int , @flag int output, @msg varchar(4000) output)  AS INSERT INTO HrmSearchMould ( mouldname, userid, resourceid, resourcename, jobtitle, activitydesc, jobgroup, jobactivity, costcenter, competency, resourcetype, status, subcompany1, department, location, manager, assistant, roles, seclevel, joblevel, workroom, telephone, startdate, enddate, contractdate, birthday, sex, seclevelTo, joblevelTo, startdateTo, enddateTo, contractdateTo, birthdayTo, age, ageTo, resourceidfrom, resourceidto, workcode, jobcall, mobile, mobilecall, fax, email, folk, nativeplace, regresidentplace, maritalstatus, certificatenum, tempresidentnumber, residentplace, homeaddress, healthinfo, heightfrom, heightto, weightfrom, weightto, educationlevel, degree, usekind, policy, bememberdatefrom, bememberdateto, bepartydatefrom, bepartydateto, islabouunion, bankid1, accountid1, accumfundaccount, loginid, systemlanguage, birthdayyear, birthdaymonth, birthdayday, educationlevelto,accounttype)  VALUES ( @mouldname_1, @userid_2, @resourceid_3, @resourcename_4, @jobtitle_5, @activitydesc_6, @jobgroup_7, @jobactivity_8, @costcenter_9, @competency_10, @resourcetype_11, @status_12, @subcompany1_13, @department_14, @location_15, @manager_16, @assistant_17, @roles_18, @seclevel_19, @joblevel_20, @workroom_21, @telephone_22, @startdate_23, @enddate_24, @contractdate_25, @birthday_26, @sex_27, @seclevelTo_28, @joblevelTo_29, @startdateTo_30, @enddateTo_31, @contractdateTo_32, @birthdayTo_33, @age_34, @ageTo_35, @resourceidfrom_36, @resourceidto_37, @workcode_38, @jobcall_39, @mobile_40, @mobilecall_41, @fax_42, @email_43, @folk_44, @nativeplace_45, @regresidentplace_46, @maritalstatus_47, @certificatenum_48, @tempresidentnumber_49, @residentplace_50, @homeaddress_51, @healthinfo_52, @heightfrom_53, @heightto_54, @weightfrom_55, @weightto_56, @educationlevel_57, @degree_58, @usekind_59, @policy_60, @bememberdatefrom_61, @bememberdateto_62, @bepartydatefrom_63, @bepartydateto_64, @islabouunion_65, @bankid1_66, @accountid1_67, @accumfundaccount_68, @loginid_69, @systemlanguage_70, @birthdayyear_71   , @birthdaymonth_72  , @birthdayday_73    , @educationlevelto_74,@accounttype_75 ) select max(id) from HrmSearchMould if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmSearchMould_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [HrmSearchMould]  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmScheduleTotalTime] (@id_1 int, @totaltime_2 varchar(4000), @flag int output, @msg varchar(4000) output) as update HrmScheduleMaintance set totaltime = @totaltime_2 where id= @id_1

GO
alter procedure [HrmScheduleTotalDay] (@id_1 int, @totalday_2 varchar(4000), @flag int output, @msg varchar(4000) output) as update HrmScheduleMaintance set totalday = @totalday_2 where id= @id_1

GO
alter procedure [HrmScheduleMain_Update] (@id_1 	int, @diffid_2 	int, @resourceid_3 	int, @startdate_4 	char(10), @starttime_5 	char(8), @enddate_6 	char(10), @endtime_7 	char(8), @memo_8 	text, @realdifftime_11  int , @difftype_12 char(1), @flag int output, @msg varchar(4000) output) AS UPDATE HrmScheduleMaintance SET diffid	 = @diffid_2, resourceid	 = @resourceid_3, startdate	 = @startdate_4, starttime	 = @starttime_5, enddate	 = @enddate_6, endtime	 = @endtime_7, memo        = @memo_8 , realdifftime = @realdifftime_11 , difftype    = @difftype_12 WHERE ( id	 = @id_1)

GO
alter procedure [HrmScheduleMain_Insert] (@diffid_1 	int, @resourceid_2 	int, @startdate_3 	char(10), @starttime_4 	char(8), @enddate_5 	char(10), @endtime_6 	char(8), @memo_7 	text, @createtype_8 	int, @createrid_9 	int, @createdate_10 	char(10), @realdifftime_11  int , @difftype_12 char(1), @flag int output, @msg varchar(4000) output)  AS INSERT INTO HrmScheduleMaintance ( diffid, resourceid, startdate, starttime, enddate, endtime, memo, createtype, createrid, createdate, realdifftime, difftype)  VALUES ( @diffid_1, @resourceid_2, @startdate_3, @starttime_4, @enddate_5, @endtime_6, @memo_7, @createtype_8, @createrid_9, @createdate_10, @realdifftime_11, @difftype_12) select max(id) from HrmScheduleMaintance

GO
alter procedure [HrmScheduleMain_Delete] (@id_1 	[int], @flag int output, @msg varchar(4000) output) AS delete from [HrmScheduleMaintance] WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmScheduleDiff_Update] (@id_1 	int, @diffname_2 	varchar(4000), @diffdesc_3 	varchar(4000), @difftype_4 	char(1), @difftime_5 	char(1), @mindifftime_6 	smallint, @workflowid_7 	int, @salaryable_8 	char(1), @counttype_9 	char(1), @countnum_11      varchar(4000), @salaryitem_12 	int, @diffremark_13 	text, @color_14 varchar(4000), @flag integer output, @msg varchar(4000) output) AS declare  @countnum_10 decimal(10,2) if @countnum_11 <>'' set @countnum_10 = convert(decimal(10,2),@countnum_11) else set  @countnum_10 = 0 UPDATE HrmScheduleDiff  SET diffname	 = @diffname_2, diffdesc	 = @diffdesc_3, difftype	 = @difftype_4, difftime	 = @difftime_5, mindifftime	 = @mindifftime_6, workflowid	 = @workflowid_7, salaryable	 = @salaryable_8, counttype	 = @counttype_9, countnum	 = @countnum_10, salaryitem	 = @salaryitem_12, diffremark	 = @diffremark_13, color = @color_14 WHERE ( id	 = @id_1)

GO
alter procedure [HrmScheduleDiff_Select_ByID] @id int , @flag integer output , @msg varchar(4000) output AS select * from HrmScheduleDiff where id = (@id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmScheduleDiff_Select_All] ( @flag integer output , @msg varchar(4000) output ) AS select id, diffname from HrmScheduleDiff order by id set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmScheduleDiff_Insert] (@diffname_1 	varchar(4000), @diffdesc_2 	varchar(4000), @difftype_3 	char(1), @difftime_4 	char(1), @mindifftime_5 	smallint, @workflowid_6 	int, @salaryable_7 	char(1), @counttype_8 	char(1), @countnum_9 	varchar(4000), @salaryitem_11 	int, @diffremark_12 	text, @color_13 varchar(4000), @flag integer output,   @msg  varchar(4000) output) AS declare  @countnum_10 decimal(10,2) if @countnum_9 <>'' set @countnum_10 = convert(decimal(10,2),@countnum_9) else set  @countnum_10 = 0  INSERT INTO HrmScheduleDiff ( diffname, diffdesc, difftype, difftime, mindifftime, workflowid, salaryable, counttype, countnum, salaryitem, diffremark, color) VALUES ( @diffname_1, @diffdesc_2, @difftype_3, @difftime_4, @mindifftime_5, @workflowid_6, @salaryable_7, @counttype_8, @countnum_10,    @salaryitem_11, @diffremark_12, @color_13) select max(id) from HrmScheduleDiff

GO
alter procedure [HrmScheduleDiff_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmScheduleDiff]  WHERE ( [id]	 = @id_1)  if @@error<>0 begin set @flag=1 set @msg='操作失败' return end else begin set @flag=0 set @msg='操作成功' return end

GO
alter procedure [HrmSchedule_Select_ByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmSchedule where id = convert(int,@id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmSchedule_Select_ByDepID] (@id_1 int, @flag int output, @msg varchar(4000) output) as select * from HrmSchedule where relatedid = @id_1 and scheduletype =1

GO
alter procedure [HrmSchedule_Select_All] @flag integer output , @msg varchar(4000) output AS select id, diffname from HrmScheduleDiff order by id set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmSchedule_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmSchedule where scheduletype='0' set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmSchedule_Insert] ( @relatedId_1 	integer , @monstarttime1_2 	char(5), @monendtime1_3 	char(5), @monstarttime2_4 	char(5), @monendtime2_5 	char(5), @tuestarttime1_6 	char(5), @tueendtime1_7 	char(5), @tuestarttime2_8 	char(5), @tueendtime2_9 	char(5), @wedstarttime1_10 	char(5), @wedendtime1_11 	char(5), @wedstarttime2_12 	char(5), @wedendtime2_13 	char(5), @thustarttime1_14 	char(5), @thuendtime1_15 	char(5), @thustarttime2_16 	char(5), @thuendtime2_17 	char(5), @fristarttime1_18 	char(5), @friendtime1_19 	char(5), @fristarttime2_20 	char(5), @friendtime2_21 	char(5), @satstarttime1_22 	char(5), @satendtime1_23 	char(5), @satstarttime2_24 	char(5), @satendtime2_25 	char(5), @sunstarttime1_26 	char(5), @sunendtime1_27 	char(5), @sunstarttime2_28 	char(5), @sunendtime2_29 	char(5), @totaltime_30    char(5), @validedatefrom_31 	char(10), @validedateto_32 	char(10), @scheduleType_33 	char(1), @flag    integer output, @msg    varchar(4000) output) AS INSERT INTO HrmSchedule ( relatedId, monstarttime1, monendtime1, monstarttime2, monendtime2, tuestarttime1, tueendtime1, tuestarttime2, tueendtime2, wedstarttime1, wedendtime1, wedstarttime2, wedendtime2, thustarttime1, thuendtime1, thustarttime2, thuendtime2, fristarttime1, friendtime1, fristarttime2, friendtime2, satstarttime1, satendtime1, satstarttime2, satendtime2, sunstarttime1, sunendtime1, sunstarttime2, sunendtime2, totaltime, validedatefrom, validedateto, scheduleType) VALUES ( @relatedId_1, @monstarttime1_2, @monendtime1_3, @monstarttime2_4, @monendtime2_5, @tuestarttime1_6, @tueendtime1_7, @tuestarttime2_8, @tueendtime2_9, @wedstarttime1_10, @wedendtime1_11, @wedstarttime2_12, @wedendtime2_13, @thustarttime1_14, @thuendtime1_15, @thustarttime2_16, @thuendtime2_17, @fristarttime1_18, @friendtime1_19, @fristarttime2_20, @friendtime2_21, @satstarttime1_22, @satendtime1_23, @satstarttime2_24, @satendtime2_25, @sunstarttime1_26, @sunendtime1_27, @sunstarttime2_28, @sunendtime2_29, @totaltime_30, @validedatefrom_31, @validedateto_32, @scheduleType_33) select max(id) from HrmSchedule

GO
alter procedure [HrmSchedule_Delete] (@id_1 	[int], @flag        integer output, @msg         varchar(4000) output) AS DELETE [HrmSchedule]  WHERE ( [id]	 = @id_1)  if @@error<>0 begin set @flag=1 set @msg='操作失败' return end else begin set @flag=0 set @msg='操作成功' return end

GO
alter procedure [FnaIndicator_Update] (@id_1 	[int], @indicatorname_2 	varchar(4000), @indicatordesc_3 	varchar(4000), @indicatorbalance_4 	[char](1), @haspercent_5 	[char](1), @indicatoridfirst_6 	[int], @indicatoridlast_7 	[int], @flag integer output , @msg varchar(4000) output)  AS UPDATE [FnaIndicator]  SET  [indicatorname]	 = @indicatorname_2, [indicatordesc]	 = @indicatordesc_3, [indicatorbalance]	 = @indicatorbalance_4, [haspercent]	 = @haspercent_5, [indicatoridfirst]	 = @indicatoridfirst_6, [indicatoridlast]	 = @indicatoridlast_7  WHERE ( [id]	 = @id_1)

GO
alter procedure [FnaIndicator_SelectMinYear] @flag integer output , @msg varchar(4000) output AS select min(id) from FnaIndicator where  indicatortype='0'

GO
alter procedure [FnaIndicator_SelectByID] @id  int , @flag integer output , @msg varchar(4000) output AS select * from FnaIndicator where id = @id

GO
alter procedure [FnaIndicator_Select] @flag integer output , @msg varchar(4000) output AS select * from FnaIndicator

GO
alter procedure [FnaIndicator_Insert] (@indicatorname_1 	varchar(4000), @indicatordesc_2 	varchar(4000), @indicatortype_3 	[char](1), @indicatorbalance_4 	[char](1), @haspercent_5 	[char](1), @indicatoridfirst_6 	[int], @indicatoridlast_7 	[int], @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [FnaIndicator] ( [indicatorname], [indicatordesc], [indicatortype], [indicatorbalance], [haspercent], [indicatoridfirst], [indicatoridlast])  VALUES ( @indicatorname_1, @indicatordesc_2, @indicatortype_3, @indicatorbalance_4, @haspercent_5, @indicatoridfirst_6, @indicatoridlast_7)  select max(id) from FnaIndicator

GO
alter procedure [FnaIndicator_Delete] (@id_1 	[int], @indicatortype_2 	[char], @flag integer output , @msg varchar(4000) output)  AS DELETE [FnaIndicator] WHERE ( [id]	 = @id_1)  if @indicatortype_2 = '0' delete FnaIndicatordetail where indicatorid = @id_1

GO
alter procedure [HrmWorkResume_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmWorkResume]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmTrainTest_Insert] (@trainid_1 int, @resourceid_2 int, @testdate_3 char(10), @result_4 int, @explain_5 text, @testerid_6 int, @flag int output, @msg varchar(4000) output) as insert into HrmTrainTest (trainid, resourceid, testdate, result, explain, testerid) values (@trainid_1 , @resourceid_2, @testdate_3, @result_4 , @explain_5, @testerid_6)

GO
alter procedure [HrmTrainRes_Update] (@name_1 varchar(4000) , @type_2 int, @fare_3 varchar(4000), @time_4 varchar(4000), @memo_5 text, @id_6 int, @flag int output, @msg varchar(4000) output) as update HrmTrainResource set name = @name_1, type_n = @type_2, fare = @fare_3, time = @time_4, memo = @memo_5 where id = @id_6

GO
alter procedure [HrmTrainRes_Insert] (@name_1 varchar(4000) , @type_2 int, @fare_3 varchar(4000), @time_4 varchar(4000), @memo_5 text, @flag int output, @msg varchar(4000) output) as insert into HrmTrainResource (name, type_n, fare, time, memo) values (@name_1, @type_2, @fare_3, @time_4, @memo_5)

GO
alter procedure [HrmTrainRes_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) as delete HrmTrainResource where id = @id_1

GO
alter procedure [HrmTrainRecord_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmTrainRecord where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmTrainRecord_SByResourceID] @resourceid varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmTrainRecord where resourceid =convert(int, @resourceid) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmTrainRecord_Insert] (@resourceid_1 	[int], @trainstartdate_2 	[char](10), @trainenddate_3 	[char](10), @traintype_4 	[int], @trainrecord_5 	[text], @trainhour_6		[decimal](18,3), @trainunit_7		varchar(4000), @flag integer output, @msg varchar(4000) output) AS INSERT INTO  [HrmTrainRecord] ( [resourceid], [trainstartdate], [trainenddate], [traintype], [trainrecord], trainhour, trainunit ) VALUES ( @resourceid_1, @trainstartdate_2, @trainenddate_3, @traintype_4, @trainrecord_5, @trainhour_6, @trainunit_7)

GO
alter procedure [HrmTrainRecord_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS DELETE [HrmTrainRecord]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmTrainPlanRange_Insert] (@planid_1 int, @type_2 int, @resourceid_3 int, @seclevel_4 int, @flag int output, @msg varchar(4000) output) as insert into HrmTrainPlanRange (planid, type_n, resourceid, seclevel) values (@planid_1, @type_2, @resourceid_3, @seclevel_4) update HrmTrainPlan set openrange = 1 where id = @planid_1

GO
alter procedure [HrmTrainPlanRange_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) as delete from HrmTrainPlanRange where id = @id_1

GO
alter procedure [HrmTrainPlan_Update] (@planname_1 varchar(4000), @layoutid_2 int, @planorganizer_3 varchar(4000), @planstartdate_4 char(10), @planenddate_5 char(10), @plancontent_6 text, @planaim_7 text, @planaddress_8 varchar(4000), @planresource_9 varchar(4000), @planactor_10 text, @planbudget_11 float, @planbudgettype_12 char(1), @openrange_13 varchar(4000), @id_14 int, @flag int output , @msg varchar(4000) output) as Update HrmTrainPlan set planname = @planname_1, layoutid = @layoutid_2, planorganizer = @planorganizer_3 , planstartdate = @planstartdate_4, planenddate = @planenddate_5, plancontent = @plancontent_6, planaim = @planaim_7, planaddress = @planaddress_8, planresource = @planresource_9, planactor = @planactor_10, planbudget =  @planbudget_11, planbudgettype = @planbudgettype_12, openrange = @openrange_13 where (id = @id_14)

GO
alter procedure [HrmTrainPlan_Insert] (@planname_1 varchar(4000), @layoutid_2 int, @planorganizer_3 varchar(4000), @planstartdate_4 char(10), @planenddate_5 char(10), @plancontent_6 text, @planaim_7 text, @planaddress_8 varchar(4000), @planresource_9 varchar(4000), @planactor_10 text, @planbudget_11 float, @planbudgettype_12 char(1), @openrange_13 varchar(4000), @createrid_14 int, @createdate_15 char(10), @flag int output , @msg varchar(4000) output) as insert into HrmTrainPlan (planname, layoutid , planorganizer, planstartdate, planenddate, plancontent, planaim, planaddress, planresource, planactor, planbudget, planbudgettype, openrange, createrid, createdate) values (@planname_1, @layoutid_2, @planorganizer_3, @planstartdate_4, @planenddate_5, @plancontent_6, @planaim_7, @planaddress_8, @planresource_9, @planactor_10, @planbudget_11, @planbudgettype_12, @openrange_13, @createrid_14, @createdate_15)

GO
alter procedure [HrmTrainPlan_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) as delete from HrmTrainPlan where id = @id_1

GO
alter procedure [HrmContract_UpdateByHrm] (@id_1 int, @contracttypeid_2 int, @startdate_3 char(10), @enddate_4 char(10), @proenddate_5 char(10), @flag int output, @msg varchar(4000) output) as update HrmContract set contractstartdate = @startdate_3, contractenddate = @enddate_4, proenddate = @proenddate_5 where contractman = @id_1 and contracttypeid = @contracttypeid_2

GO
alter procedure [HrmPubHoliday_Update] (@id_1 int, @holidayname_2 	varchar(4000), @changetype_4  int , @relateweekday_5 int , @flag integer output, @msg varchar(4000) output) AS update HrmPubHoliday set holidayname=@holidayname_2 , changetype=@changetype_4 , relateweekday=@relateweekday_5 where id=@id_1

GO
alter procedure [HrmPubHoliday_SelectByYear] (@year 	[char](4), @countryid    int, @flag                             integer output, @msg                             varchar(4000) output ) AS select * from HrmPubHoliday where substring(holidaydate,1,4)=@year and countryid=@countryid order by holidaydate if @@error<>0 begin set @flag=1 set @msg='查询人力资源信息成功' return end else begin set @flag=0 set @msg='查询人力资源信息失败' return end

GO
alter procedure [HrmPubHoliday_SelectByID] (@id 	int, @flag                             integer output, @msg                             varchar(4000) output ) AS select * from HrmPubHoliday where id=@id if @@error<>0 begin set @flag=1 set @msg='查询人力资源信息成功' return end else begin set @flag=0 set @msg='查询人力资源信息失败' return end

GO
alter procedure [Prj_PlanType_Update] (@id	 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [Prj_PlanType]  SET  [fullname]	 = @fullname, [description]	 = @description  WHERE ( [id]	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_PlanType_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_PlanType] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_PlanType_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_PlanType] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_PlanType_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [Prj_PlanType] ( [fullname], [description])  VALUES ( @fullname, @description)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_PlanType_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [Prj_PlanType]  WHERE ( [id]	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_PlanInfo_Validate] (@id_1 	[int], @validate_16 	[int], @flag integer output, @msg varchar(4000) output )  AS UPDATE [Prj_PlanInfo]  SET [validate_n]	 = @validate_16  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [Prj_PlanInfo_Update] (@id_1 	[int], @subject_2 	varchar(4000), @begindate_3 	varchar(4000), @enddate_4 	varchar(4000), @begintime_5 	varchar(4000), @endtime_6 	varchar(4000), @resourceid_7 	[int], @content_8 	varchar(4000), @budgetmoney_9 	varchar(4000), @docid_10 	[int], @plansort_11 	[int], @plantype_12 	[int], @updatedate_13 	varchar(4000), @updatetime_14 	varchar(4000), @updater_15 	[int], @validate_16 	[int], @flag integer output, @msg varchar(4000) output )  AS UPDATE [Prj_PlanInfo]  SET  [subject]	 = @subject_2, [begindate]	 = @begindate_3, [enddate]	 = @enddate_4, [begintime]	 = @begintime_5, [endtime]	 = @endtime_6, [resourceid]	 = @resourceid_7, [content]	 = @content_8, [budgetmoney]	 = @budgetmoney_9, [docid]	 = @docid_10, [plansort]	 = @plansort_11, [plantype]	 = @plantype_12, [updatedate]	 = @updatedate_13, [updatetime]	 = @updatetime_14, [updater]	 = @updater_15, [validate_n]	 = @validate_16  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [Prj_PlanSort_Update] (@id	 	[int], @fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [Prj_PlanSort]  SET  [fullname]	 = @fullname, [description]	 = @description  WHERE ( [id]	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_PlanSort_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_PlanSort] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_PlanSort_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_PlanSort] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_PlanSort_Insert] (@fullname 	varchar(4000), @description 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [Prj_PlanSort] ( [fullname], [description])  VALUES ( @fullname, @description)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_PlanSort_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [Prj_PlanSort]  WHERE ( [id]	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Log_Select] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_Log] WHERE ( [projectid]	 = @id) ORDER BY submitdate DESC, submittime DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Log_Insert] (@projectid 	[int], @logtype 	[char](2), @documentid 	[int], @logcontent 	varchar(4000), @submitdate 	varchar(4000), @submittime 	varchar(4000), @submiter	[int], @submitertype 	[tinyint], @clientip	[char](15), @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [Prj_Log] ( [projectid], [logtype], [documentid], [logcontent], [submitdate], [submittime], [submiter], [submitertype], [clientip])  VALUES ( @projectid, @logtype, @documentid, @logcontent, @submitdate, @submittime, @submiter, @submitertype, @clientip)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Jianbao_Select] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_Jianbao] WHERE ( [projectid]	 = @id) ORDER BY submitdate DESC, submittime DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Jianbao_Insert] (@projectid 	[int], @type 	[char](2), @documentid 	[int], @content 	varchar(4000), @submitdate 	varchar(4000), @submittime 	varchar(4000), @submiter	[int], @submitertype 	[tinyint], @clientip	[char](15), @flag	[int]	output, @msg	varchar(4000)	output)  AS INSERT INTO [Prj_Jianbao] ( [projectid], [type], [documentid], [content], [submitdate], [submittime], [submiter], [submitertype], [clientip])  VALUES ( @projectid, @type, @documentid, @content, @submitdate, @submittime, @submiter, @submitertype, @clientip)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_ToolProcessbyid] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_ToolProcess] WHERE ([id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_ToolProcess] (@prjid 	[int], @taskid [int] , @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_ToolProcess] WHERE ([prjid] = @prjid and [taskid] = @taskid and ( [isactived] = '2' or [isactived] = '3' ) ) order by relateid  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_Toolbyid] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_Tool] WHERE ([id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_Tool] (@prjid 	[int], @taskid [int] , @version varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_Tool] WHERE ([prjid] = @prjid and [taskid] = @taskid and [version] like '%' + @version + '%' ) order by relateid  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_RecentRemark] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT top 3 * from [Prj_Log] WHERE ([projectid] = @id) ORDER BY submitdate DESC, submittime DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_MemberProcessByPrjid] (@prjid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT distinct * from [Prj_MemberProcess] WHERE ([prjid] = @prjid  and ( [isactived] = '2' or [isactived] = '3' ) ) order by relateid  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_MemberProcessbyid] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_MemberProcess] WHERE ([id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_MemberProcess] (@prjid 	[int], @taskid [int] , @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_MemberProcess] WHERE ([prjid] = @prjid and [taskid] = @taskid and ( [isactived] = '2' or [isactived] = '3' ) ) order by relateid  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_MemberHasRightByPrjid] (@prjid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT distinct * from [Prj_MemberProcess] WHERE ([prjid] = @prjid  and  [isactived] <> '1' ) order by relateid  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_Memberbyid] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_Member] WHERE ([id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_Member] (@prjid 	[int], @taskid [int] , @version varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_Member] WHERE ([prjid] = @prjid and [taskid] = @taskid and [version] like '%' + @version + '%' ) order by relateid  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Find_MaterialProcessbyid] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * from [Prj_MaterialProcess] WHERE ([id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Decision_Insert] (@meetingid [int] , @requestid [int] , @coding varchar(4000) ,	@subject varchar(4000) ,	@hrmid01 varchar(4000) , @hrmid02 varchar(4000), @begindate varchar(4000)  , @begintime varchar(4000)  , @enddate varchar(4000)  , @endtime varchar(4000) , @flag integer output, @msg varchar(4000) output) AS INSERT INTO [Meeting_Decision] ( [meetingid] ,[requestid] , coding, subject, hrmid01, hrmid02, begindate, begintime, enddate, endtime )  VALUES ( @meetingid , @requestid , @coding, @subject, @hrmid01, @hrmid02, @begindate, @begintime, @enddate, @endtime  ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Decision_Delete] (@meetingid 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting_Decision] WHERE ( meetingid = @meetingid ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Address_SelectAll] ( @meetingtype [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Meeting_Address] where meetingtype = @meetingtype set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Address_Insert] (@meetingtype [int], @addressid [int], @desc_n varchar(4000), @flag integer output, @msg varchar(4000) output  ) AS INSERT INTO [Meeting_Address] ( [meetingtype],[addressid],[desc_n])  VALUES ( @meetingtype, @addressid, @desc_n ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Address_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting_Address] WHERE ( id = @id ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [MainMenuSequenceId_Get]( @flag int output, @msg varchar(4000) output ) AS DECLARE @id_1 INT SELECT @id_1=currentid FROM SequenceIndex WHERE indexdesc='mainmenuid' UPDATE SequenceIndex SET currentid=currentid-1 WHERE indexdesc='mainmenuid' SELECT @id_1

GO
alter procedure [mode_CustomDspField_Insert] (@reportid_1    int, @fieldid_2   int,  @dborder_3     char(1) , @shows char(1), @compositororder  varchar(4000),@queryorder int,@istitle int, @flag   int   output, @msg    varchar(4000)   output) AS INSERT INTO mode_CustomDspField ( customid, fieldid, isquery, isshow,showorder,queryorder,istitle) VALUES ( @reportid_1, @fieldid_2, @dborder_3, @shows, @compositororder,@queryorder,@istitle)

GO
alter procedure [mode_CustomDspField_Init] (@reportid_1    int, @flag   int   output, @msg    varchar(4000)   output) AS begin INSERT INTO mode_CustomDspField ( customid, fieldid, isquery, isshow,showorder,queryorder,istitle) VALUES ( @reportid_1, -2,'1','1',2,2,0) ; INSERT INTO mode_CustomDspField ( customid, fieldid, isquery, isshow,showorder,queryorder,istitle) VALUES ( @reportid_1, -1,'1','1',1,1,0) ; end

GO
alter procedure [mode_C_BrowserDspField_Insert] (@reportid_1    int, @fieldid_2   int,  @dborder_3     char(1) , @shows char(1), @compositororder  varchar(4000),@queryorder int,@istitle int, @flag   int   output, @msg    varchar(4000)   output) AS INSERT INTO mode_CustomBrowserDspField ( customid, fieldid, isquery, isshow,showorder,queryorder,istitle) VALUES ( @reportid_1, @fieldid_2, @dborder_3, @shows, @compositororder,@queryorder,@istitle)

GO
alter procedure [mode_C_BrowserDspField_Init] (@reportid_1    int, @flag   int   output, @msg    varchar(4000)   output) AS begin INSERT INTO mode_CustomBrowserDspField ( customid, fieldid, isquery, isshow,showorder,queryorder,istitle) VALUES ( @reportid_1, -2,'1','1',2,2,0) ; INSERT INTO mode_CustomBrowserDspField ( customid, fieldid, isquery, isshow,showorder,queryorder,istitle) VALUES ( @reportid_1, -1,'1','1',1,1,0) ; end

GO
alter procedure [NewDocFrontpage_Insert] (@usertype int, @userid int, @docid  int, @flag integer output, @msg varchar(4000) output) AS insert into NewDocFrontpage (usertype,userid,docid) VALUES(@usertype,@userid,@docid)

GO
alter procedure [NewDocFrontpage_DeleteByUser] (@usertype int, @userid int, @docid  int, @flag integer output, @msg varchar(4000) output) AS delete from  NewDocFrontpage where usertype=@usertype and userid=@userid and docid=@docid

GO
alter procedure [NewDocFrontpage_DeleteByDocId] ( @docid  int, @flag integer output, @msg varchar(4000) output) AS delete from  NewDocFrontpage where docid=@docid

GO
alter procedure [MailUserGroup_DeleteById] ( @mailgroupid int, @flag [int]  output, @msg  varchar(4000) output) as delete from MailUserGroup WHERE mailgroupid=@mailgroupid

GO
alter procedure [HrmResourceComponent_Delete] (@id_1 	[int], @flag int output, @msg varchar(4000) output)  AS DELETE [HrmResourceComponent]  WHERE ( [id]	 = @id_1)

GO
alter procedure [mode_pageexpand_historydata2] as declare @icount int,@modeid int declare m_cursor cursor  for select id from modeinfo begin open m_cursor fetch next from m_cursor into @modeid while @@FETCH_STATUS=0 begin select @icount=count(*) from mode_pageexpand where modeid=@modeid and expendname='批量共享' if @icount<1 begin insert into mode_pageexpand(modeid,expendname,showtype,opentype,hreftype,hrefid,hreftarget,isshow,showorder,issystem,issystemflag,expenddesc,isbatch,defaultenable) select @modeid,mp.expendname,mp.showtype,mp.opentype,mp.hreftype,mp.hrefid,mp.hreftarget,mp.isshow,mp.showorder,mp.issystem,mp.issystemflag,mp.expenddesc,mp.isbatch,mp.defaultenable from mode_pageexpandtemplate mp where mp.issystemflag=104 end fetch next from m_cursor into @modeid end close m_cursor deallocate m_cursor end

GO
alter procedure [mode_pageexpand_historydata] as declare @icount int,@modeid int declare m_cursor cursor  for select id from modeinfo begin open m_cursor fetch next from m_cursor into @modeid while @@FETCH_STATUS=0 begin select @icount=count(*) from mode_pageexpand where modeid=@modeid and expendname='打印' if @icount<1 begin insert into mode_pageexpand(modeid,expendname,showtype,opentype,hreftype,hrefid,hreftarget,isshow,showorder,issystem,issystemflag,expenddesc,isbatch,defaultenable) select @modeid,mp.expendname,mp.showtype,mp.opentype,mp.hreftype,mp.hrefid,mp.hreftarget,mp.isshow,mp.showorder,mp.issystem,mp.issystemflag,mp.expenddesc,mp.isbatch,mp.defaultenable from mode_pageexpandtemplate mp where mp.issystemflag=7 end fetch next from m_cursor into @modeid end close m_cursor deallocate m_cursor end

GO
alter procedure [MemberRoleInfo_Select] (@flag int output, @msg varchar(4000) output)  AS select resourceid , roleid , rolelevel from HrmRoleMembers order by resourceid

GO
alter procedure [MeetingShareDetail_Insert] (@meetingid_1 int , @userid_1 int , @usertype_1 int , @sharelevel_1 int , @flag	[int]	output, @msg	varchar(4000)	output) AS DECLARE	@count integer select @count = count(userid) from Meeting_ShareDetail where meetingid=@meetingid_1 and userid=@userid_1 and usertype=@usertype_1 if @count=0 begin INSERT INTO [Meeting_ShareDetail] ([meetingid], [userid], [usertype], [sharelevel]) VALUES (@meetingid_1, @userid_1, @usertype_1, @sharelevel_1) end else begin update Meeting_ShareDetail set sharelevel=@sharelevel_1 where meetingid=@meetingid_1 and userid=@userid_1 and usertype=@usertype_1 and sharelevel>@sharelevel_1 end

  GO
alter procedure [MeetingShareDetail_DById] (@meetingid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS DELETE [Meeting_ShareDetail] WHERE ( [meetingid]	 = @meetingid_1)

GO
alter procedure [MeetingRoom_Update] (@id_1 	int  , @name_1 varchar(4000) , @roomdesc_1 varchar(4000) , @hrmid_1 int , @subcompanyid_1 int, @flag	int 	output, @msg	varchar(4000)	output) AS  Update MeetingRoom  set  name=@name_1, roomdesc=@roomdesc_1, hrmid=@hrmid_1,subcompanyid=@subcompanyid_1  where id= @id_1

GO
alter procedure [MeetingRoom_SelectById] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [MeetingRoom] where id= @id_1

GO
alter procedure [LgcSearchDefine_SelectByID] (@userid	[int], @flag integer output , @msg varchar(4000) output) AS declare @count int select @count = count(userid) from LgcSearchDefine where userid = @userid if @count <> 0 select * from LgcSearchDefine where userid = @userid else select * from LgcSearchDefine where userid = -1

GO
alter procedure [LgcSearchDefine_Insert] (@userid_1 	[int], @hasassetmark_2 	[char](1), @hasassetname_3 	[char](1), @hasassetcountry_4 	[char](1), @hasassetassortment_5 	[char](1), @hasassetstatus_6 	[char](1), @hasassettype_7 	[char](1), @hasassetversion_8 	[char](1), @hasassetattribute_9 	[char](1), @hasassetsalesprice_10 	[char](1), @hasdepartment_11 	[char](1), @hasresource_12 	[char](1), @hascrm_13 	[char](1), @perpage_14 	[int], @assetcol1_15 	varchar(4000), @assetcol2_16 	varchar(4000), @assetcol3_17 	varchar(4000), @assetcol4_18 	varchar(4000), @assetcol5_19 	varchar(4000), @assetcol6_20 	varchar(4000), @flag integer output , @msg varchar(4000) output)  AS delete LgcSearchDefine where userid = @userid_1 INSERT INTO [LgcSearchDefine] ( [userid], [hasassetmark], [hasassetname], [hasassetcountry], [hasassetassortment], [hasassetstatus], [hasassettype], [hasassetversion], [hasassetattribute], [hasassetsalesprice], [hasdepartment], [hasresource], [hascrm], [perpage], [assetcol1], [assetcol2], [assetcol3], [assetcol4], [assetcol5], [assetcol6])  VALUES ( @userid_1, @hasassetmark_2, @hasassetname_3, @hasassetcountry_4, @hasassetassortment_5, @hasassetstatus_6, @hasassettype_7, @hasassetversion_8, @hasassetattribute_9, @hasassetsalesprice_10, @hasdepartment_11, @hasresource_12, @hascrm_13, @perpage_14, @assetcol1_15, @assetcol2_16, @assetcol3_17, @assetcol4_18, @assetcol5_19, @assetcol6_20)

 GO
alter procedure [LeftMenuSequenceId_Get]( @flag int output, @msg varchar(4000) output ) AS DECLARE @id_1 INT SELECT @id_1=currentid FROM SequenceIndex WHERE indexdesc='leftmenuid' UPDATE SequenceIndex SET currentid=currentid-1 WHERE indexdesc='leftmenuid' SELECT @id_1

GO
alter procedure [LgcStockInOut_SelectById] (@id [int], @flag integer output , @msg varchar(4000) output) AS select *  from LgcStockInOut where id=@id

GO
alter procedure [LgcStockInOut_SelectByAsset] (@assetid [int], @warehouseid [int], @flag integer output , @msg varchar(4000) output) AS select *  from LgcStockInOut a,LgcStockInOutDetail b where a.warehouseid=@warehouseid and b.assetid=@assetid and a.id=b.inoutid

GO
alter procedure [LgcSearchMould_Update] (@id_1 	[int], @assetmark_2 	varchar(4000), @assetname_3 	varchar(4000), @assetcountry_4 	[int], @assetassortment_5 	[int], @assetstatus_6 	[char](1), @assettype_7 	[int], @assetversion_8 	varchar(4000), @assetattribute_9 	varchar(4000), @assetsalespricefrom 	varchar(4000), @assetsalespriceto 	varchar(4000), @departmentid_12 	[int], @resourceid_13 	[int], @crmid_14 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @assetsalespricefrom_10 decimal(18,3) , @assetsalespriceto_11 decimal(18,3) if @assetsalespricefrom = '' set @assetsalespricefrom_10 = null else set @assetsalespricefrom_10 = convert(decimal(18,3),@assetsalespricefrom)  if @assetsalespriceto = '' set @assetsalespriceto_11 = null else set @assetsalespriceto_11 = convert(decimal(18,3),@assetsalespriceto)  if @crmid_14 = 0 set @crmid_14 = null if @assetcountry_4 = 0 set @assetcountry_4 = null if @assetassortment_5 = 0 set @assetassortment_5 = null if @assettype_7 = 0 set @assettype_7 = null if @departmentid_12 = 0 set @departmentid_12 = null if @resourceid_13 = 0 set @resourceid_13 = null  UPDATE [LgcSearchMould]  SET  [assetmark]	 = @assetmark_2, [assetname]	 = @assetname_3, [assetcountry]	 = @assetcountry_4, [assetassortment]	 = @assetassortment_5, [assetstatus]	 = @assetstatus_6, [assettype]	 = @assettype_7, [assetversion]	 = @assetversion_8, [assetattribute]	 = @assetattribute_9, [assetsalespricefrom]	 = @assetsalespricefrom_10, [assetsalespriceto]	 = @assetsalespriceto_11, [departmentid]	 = @departmentid_12, [resourceid]	 = @resourceid_13, [crmid]	 = @crmid_14  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcSearchMould_SelectByUserID] (@userid	[int], @flag integer output , @msg varchar(4000) output) AS select id,mouldname from LgcSearchMould where userid = @userid

GO
alter procedure [LgcSearchMould_SelectByMouldID] (@mouldid	[int], @flag integer output , @msg varchar(4000) output) AS select * from LgcSearchMould where id = @mouldid

GO
alter procedure [LgcSearchMould_Insert] (@mouldname_1 	varchar(4000), @userid_2 	[int], @assetmark_3 	varchar(4000), @assetname_4 	varchar(4000), @assetcountry_5 	[int], @assetassortment_6 	[int], @assetstatus_7 	[char](1), @assettype_8 	[int], @assetversion_9 	varchar(4000), @assetattribute_10 	varchar(4000), @assetsalespricefrom 	varchar(4000), @assetsalespriceto 	varchar(4000), @departmentid_13 	[int], @resourceid_14 	[int], @crmid_15 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @assetsalespricefrom_11 decimal(18,3) , @assetsalespriceto_12 decimal(18,3) if @assetsalespricefrom = '' set @assetsalespricefrom_11 = null else set @assetsalespricefrom_11 = convert(decimal(18,3),@assetsalespricefrom)  if @assetsalespriceto = '' set @assetsalespriceto_12 = null else set @assetsalespriceto_12 = convert(decimal(18,3),@assetsalespriceto)  if @crmid_15 = 0 set @crmid_15 = null if @assetcountry_5 = 0 set @assetcountry_5 = null if @assetassortment_6 = 0 set @assetassortment_6 = null if @assettype_8 = 0 set @assettype_8 = null if @departmentid_13 = 0 set @departmentid_13 = null if @resourceid_14 = 0 set @resourceid_14 = null  INSERT INTO [LgcSearchMould] ( [mouldname], [userid], [assetmark], [assetname], [assetcountry], [assetassortment], [assetstatus], [assettype], [assetversion], [assetattribute], [assetsalespricefrom], [assetsalespriceto], [departmentid], [resourceid], [crmid])  VALUES ( @mouldname_1, @userid_2, @assetmark_3, @assetname_4, @assetcountry_5, @assetassortment_6, @assetstatus_7, @assettype_8, @assetversion_9, @assetattribute_10, @assetsalespricefrom_11, @assetsalespriceto_12, @departmentid_13, @resourceid_14, @crmid_15) select max(id) from LgcSearchMould

GO
alter procedure [LgcSearchMould_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS DELETE [LgcSearchMould]  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcAsset_SelectAll] (@flag integer output , @msg varchar(4000) output) AS  select * from LgcAsset , LgcAssetCountry where LgcAsset.id = LgcAssetCountry.assetid and isdefault ='1'

GO
alter procedure [LgcAsset_Insert] (@assetmark_1 	varchar(4000), @barcode_2 	varchar(4000), @seclevel_3 	[tinyint], @assetimageid_4 	[int], @assettypeid_5 	[int], @assetunitid_6 	[int], @replaceassetid_7 	[int], @assetversion_8 	varchar(4000), @assetattribute_9 	varchar(4000), @counttypeid_10 	[int], @assortmentid_11 	[int], @assortmentstr_12 	varchar(4000), @relatewfid    int, @assetname_2 	varchar(4000), @assetcountyid_3 	[int], @startdate_4 	[char](10), @enddate_5 	[char](10), @departmentid_6 	[int], @resourceid_7 	[int], @assetremark_8 	[text], @currencyid_9 	[int], @salesprice_10 	varchar(4000), @costprice_11 	        varchar(4000), @datefield1_12 	[char](10), @datefield2_13 	[char](10), @datefield3_14 	[char](10), @datefield4_15 	[char](10), @datefield5_16 	[char](10), @numberfield1_17 	[float], @numberfield2_18 	[float], @numberfield3_19 	[float], @numberfield4_20 	[float], @numberfield5_21 	[float], @textfield1_22 	varchar(4000), @textfield2_23 	varchar(4000), @textfield3_24 	varchar(4000), @textfield4_25 	varchar(4000), @textfield5_26 	varchar(4000), @tinyintfield1_27 	[char](1), @tinyintfield2_28 	[char](1), @tinyintfield3_29 	[char](1), @tinyintfield4_30 	[char](1), @tinyintfield5_31 	[char](1), @createrid_32 	[int], @createdate_33 	[char](10), @Flag	[int]	output, @msg	varchar(4000)	output)  AS set @salesprice_10 = convert([decimal](18,3) , @salesprice_10) set @costprice_11 = convert([decimal](18,3) , @costprice_11)  declare @count integer  INSERT INTO [LgcAsset] ( [assetmark], [barcode], [seclevel], [assetimageid], [assettypeid], [assetunitid], [replaceassetid], [assetversion], [assetattribute], [counttypeid], [assortmentid], [assortmentstr], relatewfid)  VALUES ( @assetmark_1, @barcode_2, @seclevel_3, @assetimageid_4, @assettypeid_5, @assetunitid_6, @replaceassetid_7, @assetversion_8, @assetattribute_9, @counttypeid_10, @assortmentid_11, @assortmentstr_12, @relatewfid)  declare @assetid integer  select @assetid = max(id) from LgcAsset  INSERT INTO [LgcAssetCountry] ( [assetid], [assetname], [assetcountyid], [startdate], [enddate], [departmentid], [resourceid], [assetremark], [currencyid], [salesprice], [costprice], [datefield1], [datefield2], [datefield3], [datefield4], [datefield5], [numberfield1], [numberfield2], [numberfield3], [numberfield4], [numberfield5], [textfield1], [textfield2], [textfield3], [textfield4], [textfield5], [tinyintfield1], [tinyintfield2], [tinyintfield3], [tinyintfield4], [tinyintfield5], [createrid], [createdate], [lastmoderid], [lastmoddate], [isdefault])  VALUES ( @assetid, @assetname_2, @assetcountyid_3, @startdate_4, @enddate_5, @departmentid_6, @resourceid_7, @assetremark_8, @currencyid_9, @salesprice_10, @costprice_11, @datefield1_12, @datefield2_13, @datefield3_14, @datefield4_15, @datefield5_16, @numberfield1_17, @numberfield2_18, @numberfield3_19, @numberfield4_20, @numberfield5_21, @textfield1_22, @textfield2_23, @textfield3_24, @textfield4_25, @textfield5_26, @tinyintfield1_27, @tinyintfield2_28, @tinyintfield3_29, @tinyintfield4_30, @tinyintfield5_31, @createrid_32, @createdate_33, @createrid_32, @createdate_33, '1')  update LgcAssetAssortment set assetcount = assetcount+1 where id= @assortmentid_11 select max(id) from LgcAsset

GO
alter procedure [LgcAsset_Delete] ( @id_1 	[int], @assetcountryid_2 [int], @flag                             integer output, @msg                             varchar(4000) output) AS declare @isdefault char(1), @assortmentid_1 int  select @assortmentid_1 = assortmentid from LgcAsset where id=@id_1 DELETE [LgcAsset]  WHERE id=@id_1 DELETE [LgcAssetCountry]  WHERE assetid=@id_1 update LgcAssetAssortment set assetcount = assetcount-1 where id= @assortmentid_1

GO
alter procedure [LgcPaymentType_Update] (@id_1 	[int], @typename_2 	varchar(4000), @typedesc_3 	varchar(4000), @paymentid_4 	[int], @flag integer output , @msg varchar(4000) output)  AS UPDATE [LgcPaymentType]  SET  [typename]	 = @typename_2, [typedesc]	 = @typedesc_3, [paymentid]	 = @paymentid_4  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcPaymentType_SelectByID] @id  int , @flag integer output , @msg varchar(4000) output AS select * from LgcPaymentType  where id = @id

GO
alter procedure [LgcPaymentType_Select] @flag integer output , @msg varchar(4000) output AS select * from LgcPaymentType

GO
alter procedure [LgcPaymentType_Insert] (@typename_1 	varchar(4000), @typedesc_2 	varchar(4000), @paymentid_3 	[int], @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [LgcPaymentType] ( [typename], [typedesc], [paymentid])  VALUES ( @typename_1, @typedesc_2, @paymentid_3)  select max(id) from LgcPaymentType

GO
alter procedure [LgcPaymentType_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @count int    DELETE [LgcPaymentType] WHERE  ( [id]	 = @id_1)

GO
alter procedure [LgcAssetCountry_SSumByResource] (@id	 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS select count(id) from LgcAssetCountry where resourceid = @id

GO
alter procedure [LgcAssetCountry_SelectByID] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS select * from  LgcAssetCountry where id = @id_1

GO
alter procedure [LgcAssetCountry_SByAssetID] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS select * from LgcAssetCountry where assetid = @id_1

GO
alter procedure [LgcAssetCountry_Insert] (@assetid_1 	[int], @assetname_2 	varchar(4000), @assetcountyid_3 	[int], @startdate_4 	[char](10), @enddate_5 	[char](10), @departmentid_6 	[int], @resourceid_7 	[int], @assetremark_8 	[text], @currencyid_9 	[int], @salesprice_10 	varchar(4000), @costprice_11 	varchar(4000), @datefield1_12 	[char](10), @datefield2_13 	[char](10), @datefield3_14 	[char](10), @datefield4_15 	[char](10), @datefield5_16 	[char](10), @numberfield1_17 	[float], @numberfield2_18 	[float], @numberfield3_19 	[float], @numberfield4_20 	[float], @numberfield5_21 	[float], @textfield1_22 	varchar(4000), @textfield2_23 	varchar(4000), @textfield3_24 	varchar(4000), @textfield4_25 	varchar(4000), @textfield5_26 	varchar(4000), @tinyintfield1_27 	[char](1), @tinyintfield2_28 	[char](1), @tinyintfield3_29 	[char](1), @tinyintfield4_30 	[char](1), @tinyintfield5_31 	[char](1), @createrid_32 	[int], @createdate_33 	[char](10), @lastmoderid_34 	[int], @lastmoddate_35 	[char](10), @isdefault_36 	[char](1), @flag integer output, @msg varchar(4000) output )  AS declare @count int select @count=count(*) from LgcAssetCountry where assetid=@assetid_1 and assetcountyid=@assetcountyid_3 if @count<>0 begin select -1 return end  set @salesprice_10 = convert([decimal](18,3) , @salesprice_10) set @costprice_11 = convert([decimal](18,3) , @costprice_11)  if @isdefault_36 <>'0' begin UPDATE LgcAssetCountry SET isdefault='0' WHERE assetid = @assetid_1 end  INSERT INTO [LgcAssetCountry] ( [assetid], [assetname], [assetcountyid], [startdate], [enddate], [departmentid], [resourceid], [assetremark], [currencyid], [salesprice], [costprice], [datefield1], [datefield2], [datefield3], [datefield4], [datefield5], [numberfield1], [numberfield2], [numberfield3], [numberfield4], [numberfield5], [textfield1], [textfield2], [textfield3], [textfield4], [textfield5], [tinyintfield1], [tinyintfield2], [tinyintfield3], [tinyintfield4], [tinyintfield5], [createrid], [createdate], [lastmoderid], [lastmoddate], [isdefault])  VALUES ( @assetid_1, @assetname_2, @assetcountyid_3, @startdate_4, @enddate_5, @departmentid_6, @resourceid_7, @assetremark_8, @currencyid_9, @salesprice_10, @costprice_11, @datefield1_12, @datefield2_13, @datefield3_14, @datefield4_15, @datefield5_16, @numberfield1_17, @numberfield2_18, @numberfield3_19, @numberfield4_20, @numberfield5_21, @textfield1_22, @textfield2_23, @textfield3_24, @textfield4_25, @textfield5_26, @tinyintfield1_27, @tinyintfield2_28, @tinyintfield3_29, @tinyintfield4_30, @tinyintfield5_31, @createrid_32, @createdate_33, @lastmoderid_34, @lastmoddate_35, @isdefault_36)

GO
alter procedure [LgcCountType_Update] (@id_1 	[int], @typename_2 	varchar(4000), @typedesc_3 	varchar(4000), @salesinid_4 	[int], @salescostid_5 	[int], @salestaxid_6 	[int], @purchasetaxid_7 	[int], @stockid_8 	[int], @stockdiffid_9 	[int], @producecostid_10 	[int], @flag integer output , @msg varchar(4000) output)  AS UPDATE [LgcCountType]  SET  [typename]	 = @typename_2, [typedesc]	 = @typedesc_3, [salesinid]	 = @salesinid_4, [salescostid]	 = @salescostid_5, [salestaxid]	 = @salestaxid_6, [purchasetaxid]	 = @purchasetaxid_7, [stockid]	 = @stockid_8, [stockdiffid]	 = @stockdiffid_9, [producecostid]	 = @producecostid_10  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcCountType_SelectByID] @id  int , @flag integer output , @msg varchar(4000) output AS select * from LgcCountType  where id = @id

GO
alter procedure [LgcCountType_Select] @flag integer output , @msg varchar(4000) output AS select * from LgcCountType

GO
alter procedure [LgcCountType_Insert] (@typename_1 	varchar(4000), @typedesc_2 	varchar(4000), @salesinid_3 	[int], @salescostid_4 	[int], @salestaxid_5 	[int], @purchasetaxid_6 	[int], @stockid_7 	[int], @stockdiffid_8 	[int], @producecostid_9 	[int] , @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [LgcCountType] ( [typename], [typedesc], [salesinid], [salescostid], [salestaxid], [purchasetaxid], [stockid], [stockdiffid], [producecostid])  VALUES ( @typename_1, @typedesc_2, @salesinid_3, @salescostid_4, @salestaxid_5, @purchasetaxid_6, @stockid_7, @stockdiffid_8, @producecostid_9) select max(id) from LgcCountType

GO
alter procedure [LgcCountType_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @count int  select @count = count(id) from LgcAsset where counttypeid = @id_1 if @count <> 0 begin select -1 return end  DELETE [LgcCountType] WHERE  ( [id]	 = @id_1)

GO
alter procedure [LgcAssetAssortment_UpdatePic] (@id_1 	[int], @assortmentimageid_2     [int], @flag                             integer output, @msg                             varchar(4000) output ) AS update LgcAssetAssortment set assortmentimageid = 0 where id = @id_1 delete ImageFile where imagefileid = @assortmentimageid_2  if @@error<>0 begin set @flag=1 set @msg='删除图片成功' return end else begin set @flag=0 set @msg='删除图片失败' return end

GO
alter procedure [LgcAssetAssortment_Update] (@id_1 	[int], @assortmentmark_2 	varchar(4000), @assortmentname_3 	varchar(4000), @seclevel_4 	[tinyint], @resourceid_5 	[int], @assortmentimageid_6 	[int], @assortmentremark_7 	[text], @supassortmentid_8 	[int], @supassortmentstr_9 	varchar(4000), @dff01name_12 	varchar(4000), @dff01use_13 	[tinyint], @dff02name_14 	varchar(4000), @dff02use_15 	[tinyint], @dff03name_16 	varchar(4000), @dff03use_17 	[tinyint], @dff04name_18 	varchar(4000), @dff04use_19 	[tinyint], @dff05name_20 	varchar(4000), @dff05use_21 	[tinyint], @nff01name_22 	varchar(4000), @nff01use_23 	[tinyint], @nff02name_24 	varchar(4000), @nff02use_25 	[tinyint], @nff03name_26 	varchar(4000), @nff03use_27 	[tinyint], @nff04name_28 	varchar(4000), @nff04use_29 	[tinyint], @nff05name_30 	varchar(4000), @nff05use_31 	[tinyint], @tff01name_32 	varchar(4000), @tff01use_33 	[tinyint], @tff02name_34 	varchar(4000), @tff02use_35 	[tinyint], @tff03name_36 	varchar(4000), @tff03use_37 	[tinyint], @tff04name_38 	varchar(4000), @tff04use_39 	[tinyint], @tff05name_40 	varchar(4000), @tff05use_41 	[tinyint], @bff01name_42 	varchar(4000), @bff01use_43 	[tinyint], @bff02name_44 	varchar(4000), @bff02use_45 	[tinyint], @bff03name_46 	varchar(4000), @bff03use_47 	[tinyint], @bff04name_48 	varchar(4000), @bff04use_49 	[tinyint], @bff05name_50 	varchar(4000), @bff05use_51 	[tinyint], @flag integer output, @msg varchar(4000) output )  AS UPDATE [LgcAssetAssortment]  SET  [assortmentmark]	 = @assortmentmark_2, [assortmentname]	 = @assortmentname_3, [seclevel]	 = @seclevel_4, [resourceid]	 = @resourceid_5, [assortmentimageid]	 = @assortmentimageid_6, [assortmentremark]	 = @assortmentremark_7, [supassortmentid]	 = @supassortmentid_8, [supassortmentstr]	 = @supassortmentstr_9, [dff01name]	 = @dff01name_12, [dff01use]	 = @dff01use_13, [dff02name]	 = @dff02name_14, [dff02use]	 = @dff02use_15, [dff03name]	 = @dff03name_16, [dff03use]	 = @dff03use_17, [dff04name]	 = @dff04name_18, [dff04use]	 = @dff04use_19, [dff05name]	 = @dff05name_20, [dff05use]	 = @dff05use_21, [nff01name]	 = @nff01name_22, [nff01use]	 = @nff01use_23, [nff02name]	 = @nff02name_24, [nff02use]	 = @nff02use_25, [nff03name]	 = @nff03name_26, [nff03use]	 = @nff03use_27, [nff04name]	 = @nff04name_28, [nff04use]	 = @nff04use_29, [nff05name]	 = @nff05name_30, [nff05use]	 = @nff05use_31, [tff01name]	 = @tff01name_32, [tff01use]	 = @tff01use_33, [tff02name]	 = @tff02name_34, [tff02use]	 = @tff02use_35, [tff03name]	 = @tff03name_36, [tff03use]	 = @tff03use_37, [tff04name]	 = @tff04name_38, [tff04use]	 = @tff04use_39, [tff05name]	 = @tff05name_40, [tff05use]	 = @tff05use_41, [bff01name]	 = @bff01name_42, [bff01use]	 = @bff01use_43, [bff02name]	 = @bff02name_44, [bff02use]	 = @bff02use_45, [bff03name]	 = @bff03name_46, [bff03use]	 = @bff03use_47, [bff04name]	 = @bff04name_48, [bff04use]	 = @bff04use_49, [bff05name]	 = @bff05name_50, [bff05use]	 = @bff05use_51  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcAssetAssortment_SSupAssort] @id_1 	[int], @flag integer output , @msg varchar(4000) output AS select supassortmentstr from  LgcAssetAssortment  where id = @id_1

GO
alter procedure [LgcAssetAssortment_SelectLeaf] @flag integer output , @msg varchar(4000) output AS select * from LgcAssetAssortment where subassortmentcount = 0

GO
alter procedure [LgcAssetAssortment_SelectByID] (@id_1 	[int], @flag integer output , @msg varchar(4000) output) AS select * from LgcAssetAssortment where id = @id_1

GO
alter procedure [LgcConfiguration_Update] (@id_1 	[int], @supassetid_2 	[int], @subassetid_3 	[int], @relationtypeid_4 	[int], @flag integer output, @msg varchar(4000) output )  AS if @supassetid_2=@subassetid_3 begin select -1 return end  UPDATE [LgcConfiguration]  SET  [supassetid]	 = @supassetid_2, [subassetid]	 = @subassetid_3, [relationtypeid]	 = @relationtypeid_4  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcConfiguration_SelectById] ( @id int, @flag integer output , @msg varchar(4000) output) AS select * from LgcConfiguration where id=@id

GO
alter procedure [LgcConfiguration_SelectByAsset] ( @id int, @direction char(1), @flag integer output , @msg varchar(4000) output) AS  if @direction='1' select * from LgcConfiguration where subassetid=@id else select * from LgcConfiguration where supassetid=@id

GO
alter procedure [LgcConfiguration_Select] @flag integer output , @msg varchar(4000) output AS  select * from LgcConfiguration

GO
alter procedure [LgcAssetStock_Update] (@id_1 	[int], @warehouseid_2 	[int], @assetid_3 	[int], @stocknum_4 	[float], @unitprice_5    varchar(4000), @trandefcurrencyid int, @currencyid       int, @exchangerate varchar(4000), @flag integer output , @msg varchar(4000) output)  AS set @unitprice_5 = convert([decimal](18,3) , @unitprice_5)   declare @count int,@inoutid int,@inoutdetailid int,@temp decimal(18,3)  set @temp = @unitprice_5  select @count=count(*)  from LgcStockInOut a,LgcStockInOutDetail b where a.warehouseid=@warehouseid_2 and b.assetid=@assetid_3 and a.id=b.inoutid and a.stockmodeid<>-2 if @count>0 begin select -1 return end  UPDATE [LgcAssetStock]  SET  [warehouseid]	 = @warehouseid_2, [assetid]	 = @assetid_3, [stocknum]	 = @stocknum_4, [unitprice]	 = @unitprice_5  WHERE ( [id]	 = @id_1)  select @inoutid=a.id,@inoutdetailid=b.id  from LgcStockInOut a,LgcStockInOutDetail b where a.warehouseid=@warehouseid_2 and b.assetid=@assetid_3 and a.id=b.inoutid  UPDATE [LgcStockInOut]  SET  [warehouseid]	 = @warehouseid_2, [currencyid]	 = @currencyid, [defcurrencyid] = @trandefcurrencyid, [exchangerate]	 = @exchangerate, [defcountprice] = @stocknum_4*@unitprice_5/@exchangerate, [countprice]    = @stocknum_4*@unitprice_5 WHERE ( [id]	 = @inoutid)  UPDATE [LgcStockInOutDetail]  SET  [number_n]	 = @stocknum_4, [currencyid]	 = @currencyid, [defcurrencyid] = @trandefcurrencyid, [exchangerate]	 = @exchangerate, [defunitprice] = @temp/@exchangerate, [unitprice]	 = @unitprice_5 WHERE ( [id]	 = @inoutdetailid)

GO
alter procedure [LgcAssetStock_SelectByID] (@id_1 	[int], @flag integer output , @msg varchar(4000) output) AS select * from LgcAssetStock where id = @id_1

GO
alter procedure [LgcAssetStock_SelectByAsset] (@assetid int, @flag integer output , @msg varchar(4000) output) AS select id,warehouseid,stocknum,unitprice,stocknum*unitprice unitpriceall from LgcAssetStock where assetid = @assetid

GO
alter procedure [LgcAssetStock_Insert] (@warehouseid_1 	[int], @assetid_2 	[int], @stocknum_3 	[float], @unitprice_4 	varchar(4000), @trandefcurrencyid int, @currencyid       int, @exchangerate varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS  declare @count int,@maxid int,@temp decimal(18,3)  select @count=count(*)  from LgcStockInOut a,LgcStockInOutDetail b where a.warehouseid=@warehouseid_1 and b.assetid=@assetid_2 and a.id=b.inoutid if @count>0 begin select -1 return end  set @unitprice_4 = convert([decimal](18,3) , @unitprice_4) set @exchangerate = convert([decimal](18,3) , @exchangerate) set @temp=convert([decimal](18,3) , @unitprice_4)  INSERT INTO [LgcAssetStock] ( [warehouseid], [assetid], [stocknum], [unitprice])  VALUES ( @warehouseid_1, @assetid_2, @stocknum_3, @unitprice_4)   INSERT INTO [LgcStockInOut] ( [warehouseid], [stockmodeid], [currencyid], [defcurrencyid], exchangerate, defcountprice, countprice)  VALUES ( @warehouseid_1, -2, @currencyid, @trandefcurrencyid, @exchangerate, @stocknum_3*@temp/@exchangerate, @stocknum_3*@unitprice_4)  select @maxid=max(id) from LgcStockInOut  INSERT INTO [LgcStockInOutDetail] ( [inoutid], [assetid], [number_n], [currencyid], defcurrencyid, exchangerate, defunitprice, unitprice)  VALUES ( @maxid, @assetid_2, @stocknum_3, @currencyid, @trandefcurrencyid, @exchangerate, @temp/@exchangerate, @unitprice_4)   select max(id) from LgcAssetStock

GO
alter procedure [LgcAssetStock_EditOrView] ( @assetid_3 	[int], @warehouseid_2 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @count int select @count=count(*)  from LgcStockInOut a,LgcStockInOutDetail b where a.warehouseid=@warehouseid_2 and b.assetid=@assetid_3 and a.id=b.inoutid and a.stockmodeid<>-2 if @count>0 begin select -1 return end else begin select  1 return end

GO
alter procedure [LgcAssetStock_Delete] (@id_1 	[int], @warehouseid_2 	[int], @assetid_3 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @count int,@inoutid int,@inoutdetailid int select @count=count(*)  from LgcStockInOut a,LgcStockInOutDetail b where a.warehouseid=@warehouseid_2 and b.assetid=@assetid_3 and a.id=b.inoutid and a.stockmodeid<>-2 if @count>0 begin select -1 return end  DELETE [LgcAssetStock]   WHERE ( [id] = @id_1)  select @inoutid=a.id,@inoutdetailid=b.id  from LgcStockInOut a,LgcStockInOutDetail b where a.warehouseid=@warehouseid_2 and b.assetid=@assetid_3 and a.id=b.inoutid  DELETE [LgcStockInOut]   WHERE ( [id] = @inoutid)  DELETE [LgcStockInOutDetail]   WHERE ( [id] = @inoutdetailid)

GO
alter procedure [LgcAssetRelationType_Update] (@id_1 	[int], @typename_2 	varchar(4000), @typedesc_3 	varchar(4000), @typekind_4 	[char](1), @shopadvice_5 	[char](1), @contractlimit_6 	[char](1), @flag integer output , @msg varchar(4000) output)  AS UPDATE [LgcAssetRelationType]  SET  [typename]	 = @typename_2, [typedesc]	 = @typedesc_3, [typekind]	 = @typekind_4, [shopadvice]	 = @shopadvice_5, [contractlimit]	 = @contractlimit_6  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcAssetRelationType_Select] @flag integer output , @msg varchar(4000) output AS select * from LgcAssetRelationType

GO
alter procedure [LgcAssetRelationType_SByID] @id int , @flag integer output , @msg varchar(4000) output AS select * from LgcAssetRelationType where id = @id

GO
alter procedure [LgcAssetRelationType_Insert] (@typename_1 	varchar(4000), @typedesc_2 	varchar(4000), @typekind_3 	[char](1), @shopadvice_4 	[char](1), @contractlimit_5 	[char](1), @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [LgcAssetRelationType] ( [typename], [typedesc], [typekind], [shopadvice], [contractlimit])  VALUES ( @typename_1, @typedesc_2, @typekind_3, @shopadvice_4, @contractlimit_5) select max(id) from LgcAssetRelationType

GO
alter procedure [LgcAssetRelationType_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS declare @count int  select @count = count(id) from LgcConfiguration where relationtypeid = @id_1 if @count <> 0 begin select -1 return end  DELETE [LgcAssetRelationType] WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcAssetPrice_Update] (@id_1 	[int], @pricedesc_4 	varchar(4000), @numfrom_5 	[int], @numto_6 	[int], @currencyid_7 	[int], @unitprice_8 	varchar(4000), @taxrate_9 	[int], @flag integer output, @msg varchar(4000) output )  AS if @numfrom_5 = 0 set @numfrom_5 = null if @numto_6 = 0 set @numto_6 = null  set @unitprice_8 = convert([decimal](18,3) , @unitprice_8)  UPDATE [LgcAssetPrice]  SET	 [pricedesc]	 = @pricedesc_4, [numfrom]	 = @numfrom_5, [numto]	 = @numto_6, [currencyid]	 = @currencyid_7, [unitprice]	 = @unitprice_8, [taxrate]	 = @taxrate_9  WHERE ( [id]	 = @id_1)  select * from LgcAssetPrice where id = @id_1

GO
alter procedure [LgcAssetPrice_SelectById] @id_1 int, @flag integer output , @msg varchar(4000) output AS select * from LgcAssetPrice where id=@id_1

GO
alter procedure [LgcAssetPrice_SelectByAsset] @assetid_1 int, @assetcountryid_2 int, @flag integer output , @msg varchar(4000) output AS select * from LgcAssetPrice where assetid=@assetid_1 and assetcountyid=@assetcountryid_2

GO
alter procedure [LgcAssetPrice_Select] ( @assetid  int , @countryid  int , @assetcount  float , @flag integer output , @msg varchar(4000) output) AS declare @unitprice decimal(18,3) , @taxrate int ,  @currencyid int declare theprice_cursor cursor for select unitprice,taxrate, currencyid from LgcAssetPrice where assetid = @assetid and assetcountyid = @countryid and numfrom <= @assetcount and (numto >= @assetcount or numto=0 or numto is null) open theprice_cursor fetch next from theprice_cursor into @unitprice , @taxrate , @currencyid if @@fetch_status=0 select @unitprice , @taxrate , @currencyid else select salesprice , 0 , currencyid from LgcAssetCountry where assetid = @assetid and assetcountyid = @countryid close theprice_cursor deallocate theprice_cursor

GO
alter procedure [LgcAssetPrice_Insert] (@assetid_1 	[int], @assetcountyid_2 	[int], @pricedesc_3 	varchar(4000), @numfrom_4 	[int], @numto_5 	[int], @currencyid_6 	[int], @unitprice_7 	varchar(4000), @taxrate_8 	[int], @flag integer output , @msg varchar(4000) output)  AS if @numfrom_4 = 0 set @numfrom_4 = null if @numto_5 = 0 set @numto_5 = null  set @unitprice_7 = convert([decimal](18,3) , @unitprice_7)  INSERT INTO [LgcAssetPrice] ( [assetid], [assetcountyid], [pricedesc], [numfrom], [numto], [currencyid], [unitprice], [taxrate])  VALUES ( @assetid_1, @assetcountyid_2, @pricedesc_3, @numfrom_4, @numto_5, @currencyid_6, @unitprice_7, @taxrate_8) select max(id) from LgcAssetPrice

GO
alter procedure [LgcAssetPrice_Delete] (@id_1  [int], @flag integer output , @msg varchar(4000) output)  AS select * from LgcAssetPrice where id=@id_1  DELETE [LgcAssetPrice]  WHERE  id = @id_1

GO
alter procedure [HrmCostcenterMainCategory_U] (@id_1	[tinyint], @ccmaincategoryname_2 varchar(4000), @ccmaincategorydesc_3 text, @flag integer output, @msg varchar(4000) output ) AS UPDATE [HrmCostcenterMainCategory]  SET  [ccmaincategoryname] = @ccmaincategoryname_2, ccmaincategorydesc = @ccmaincategorydesc_3 WHERE ( [id]	 = @id_1) IF @@error<>0 begin set @flag=1 set @msg='更新储存过程失败' return END ELSE begin set @flag=1 set @msg='更新储存过程失败' return END

GO
alter procedure [HrmCostcenterMainCategory_S] @flag integer output , @msg varchar(4000) output AS select * from HrmCostcenterMainCategory set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [CptBorrowBuffer_Insert] ( @cptId_1 int, @useDate_1 char(10), @deptId_1 int, @userId_1 int, @depositary_1 varchar(4000), @remark_1 text, @flag integer output , @msg varchar(4000) output) AS IF EXISTS(SELECT cptId FROM CptBorrowBuffer WHERE cptId = @cptId_1) BEGIN SELECT -1 RETURN END INSERT INTO CptBorrowBuffer ( cptId, useDate, deptId, userId, depositary, remark) VALUES ( @cptId_1, @useDate_1, @deptId_1, @userId_1, @depositary_1, @remark_1)

GO
alter procedure [LgcAssetCrm_Insert] (@assetid_1 	[int], @crmid_2 	[int], @countryid_3 	[int], @ismain_4 	[char](1), @assetcode_5 	[char](60), @currencyid_6 	[int], @purchaseprice_7 	varchar(4000), @taxrate_8 	[int], @unitid_9 	[int], @packageunit_10 	varchar(4000), @supplyremark_11 	[text], @docid_12 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS set @purchaseprice_7 = convert([decimal](18,3) , @purchaseprice_7) if @docid_12 = 0 set @docid_12 = null  INSERT INTO [LgcAssetCrm] ( [assetid], [crmid], [countryid], [ismain], [assetcode], [currencyid], [purchaseprice], [taxrate], [unitid], [packageunit], [supplyremark], [docid])  VALUES ( @assetid_1, @crmid_2, @countryid_3, @ismain_4, @assetcode_5, @currencyid_6, @purchaseprice_7, @taxrate_8, @unitid_9, @packageunit_10, @supplyremark_11, @docid_12) select max(id) from LgcAssetCrm

GO
alter procedure [LgcAssetCrm_Delete] (@id_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [LgcAssetCrm]  WHERE ( [id]	 = @id_1)

GO
alter procedure [LgcAssetCrm_SelectByID] (@id_1 	[int], @flag integer output , @msg varchar(4000) output) AS select * from LgcAssetCrm where id = @id_1

GO
alter procedure [LgcAssetmark_Change] (@assetid	[int], @assetmark  varchar(4000), @flag integer output , @msg varchar(4000) output) AS declare @count int select @count = count(id) from LgcAsset where assetmark = @assetmark if @count <> 0 begin select -1 return end  update LgcAsset set assetmark = @assetmark where id = @assetid

GO
alter procedure [LgcAssetCrm_Update] (@id_1 	[int], @assetid_2 	[int], @crmid_3 	[int], @countryid_4 	[int], @ismain_5 	[char](1), @assetcode_6 	[char](60), @currencyid_7 	[int], @purchaseprice_8 	varchar(4000), @taxrate_9 	[int], @unitid_10 	[int], @packageunit_11 	varchar(4000), @supplyremark_12 	[text], @docid_13 	[int], @flag integer output , @msg varchar(4000) output)  AS set @purchaseprice_8 = convert([decimal](18,3) , @purchaseprice_8) if @docid_13 = 0 set @docid_13 = null  UPDATE [LgcAssetCrm]  SET  [assetid]	 = @assetid_2, [crmid]	 = @crmid_3, [countryid]	 = @countryid_4, [ismain]	 = @ismain_5, [assetcode]	 = @assetcode_6, [currencyid]	 = @currencyid_7, [purchaseprice]	 = @purchaseprice_8, [taxrate]	 = @taxrate_9, [unitid]	 = @unitid_10, [packageunit]	 = @packageunit_11, [supplyremark]	 = @supplyremark_12, [docid]	 = @docid_13  WHERE ( [id]	 = @id_1)

GO
alter procedure [CptAstShareInfo_Insert_dft] (@relateditemid_1 [int], @sharetype_2 [tinyint], @seclevel_3 [tinyint], @rolelevel_4 [tinyint], @sharelevel_5 [tinyint], @userid_6 [int], @departmentid_7 [int], @roleid_8 [int], @foralluser_9 [tinyint], @sharefrom_10 int ,@subcompanyid_11 int , @flag integer output, @msg varchar(4000) output) AS INSERT INTO [CptCapitalShareInfo] ( [relateditemid], [sharetype], [seclevel], [rolelevel], [sharelevel], [userid], [departmentid], [roleid], [foralluser], sharefrom,[subcompanyid],isdefault)  VALUES ( @relateditemid_1, @sharetype_2, @seclevel_3, @rolelevel_4, @sharelevel_5, @userid_6, @departmentid_7, @roleid_8, @foralluser_9, @sharefrom_10,@subcompanyid_11,1);

GO
alter procedure [CptAssortmentShareInfo_Insert] (@relateditemid_1 [int], @sharetype_2 [tinyint], @seclevel_3 [tinyint], @rolelevel_4 [tinyint], @sharelevel_5 [tinyint], @userid_6 [int], @departmentid_7 [int], @roleid_8 [int], @foralluser_9 [tinyint], @sharefrom_10 int ,@subcompanyid_11 int , @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [CptCapitalShareInfo] ( [relateditemid], [sharetype], [seclevel], [rolelevel], [sharelevel], [userid], [departmentid], [roleid], [foralluser], sharefrom,[subcompanyid])  VALUES ( @relateditemid_1, @sharetype_2, @seclevel_3, @rolelevel_4, @sharelevel_5, @userid_6, @departmentid_7, @roleid_8, @foralluser_9, @sharefrom_10,@subcompanyid_11)

GO
alter procedure [CptAssortmentShare_Insert] (@assortmentid_1 [int], @sharetype_2 [tinyint], @seclevel_3 [tinyint], @rolelevel_4 [tinyint], @sharelevel_5 [tinyint], @userid_6 [int], @departmentid_7 [int], @roleid_8 [int], @foralluser_9 [tinyint],@subcompanyid_10 [int], @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [CptAssortmentShare] ( [assortmentid], [sharetype], [seclevel], [rolelevel], [sharelevel], [userid], [departmentid], [roleid], [foralluser],[subcompanyid])  VALUES ( @assortmentid_1, @sharetype_2, @seclevel_3, @rolelevel_4, @sharelevel_5, @userid_6, @departmentid_7, @roleid_8, @foralluser_9,@subcompanyid_10)  select max(id)  id from CptAssortmentShare

GO
alter procedure [cpt_selectitembyid_new] @id varchar(4000)  ,@isbill varchar(4000), @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT AS SELECT  * FROM    cpt_SelectItem WHERE   fieldid = @id  AND ( cancel!='1' or cancel is null) ORDER BY listorder , id SET @flag = 0 SET @msg = ''

GO
alter procedure [cpt_selectitem_insert_new] ( @fieldid INT , @isbill INT , @selectvalue INT , @selectname varchar(4000) , @listorder NUMERIC(10, 2) , @isdefault CHAR(1) , @cancel2 varchar(4000), @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT ) AS INSERT  INTO cpt_selectitem ( fieldid , isbill , selectvalue , selectname , listorder , isdefault,cancel ) VALUES  ( @fieldid , @isbill , @selectvalue , @selectname , @listorder , @isdefault,@cancel2 )

GO
alter procedure [HrmRoleMembers_Insert] @employeeid int, @roleid int, @level_n int, @flag int output, @msg varchar(4000) output as declare @count integer select @count = id from HrmRoleMembers where roleid = @roleid and resourceid = @employeeid if @count is null begin insert into HrmRoleMembers(roleid,resourceid,rolelevel) values(@roleid,@employeeid,@level_n) select max(id) from HrmRoleMembers end else begin update HrmRoleMembers set rolelevel=@level_n where roleid = @roleid and resourceid = @employeeid select @count end

GO
alter procedure [HrmRoleMembers_Delete] (@id_1 	[int], @flag int output, @msg varchar(4000) output)  AS DELETE [HrmRoleMembers]  WHERE ( [id]	 = @id_1)

GO
alter procedure [FnaIndicatordetail_SelectByID] @id  int , @flag integer output , @msg varchar(4000) output AS select * from FnaIndicatordetail where indicatorid = @id

GO
alter procedure [FnaIndicatordetail_Insert] (@indicatorid_1 	[int], @ledgerid_2 	[int], @flag integer output , @msg varchar(4000) output)  AS INSERT INTO [FnaIndicatordetail] ( [indicatorid], [ledgerid]) VALUES ( @indicatorid_1, @ledgerid_2)

GO
alter procedure [FnaIndicatordetail_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output)  AS DELETE [FnaIndicatordetail]  WHERE ( [id]	 = @id_1)

GO
alter procedure [HrmConType_Update] (@id_1 int, @typename_2 varchar(4000), @contracttempletid_3 int, @saveurl_4 varchar(4000), @ishirecontract_5 char(1), @remindaheaddate_6 int, @remindman_7 varchar(4000), @flag int output, @msg varchar(4000) output) AS UPDATE HrmContractType SET typename = @typename_2, contracttempletid = @contracttempletid_3, saveurl = @saveurl_4, ishirecontract = @ishirecontract_5, remindaheaddate = @remindaheaddate_6 , remindman = @remindman_7 WHERE id = @id_1

GO
alter procedure [HrmConType_Insert] (@typename_1 varchar(4000), @contracttempletid_2 int, @saveurl_3 varchar(4000), @ishirecontract_4 char(1), @remindaheaddate_5 int, @remindman_6 varchar(4000), @flag int output, @msg varchar(4000) output) AS INSERT HrmContractType (typename, contracttempletid, saveurl, ishirecontract, remindaheaddate, remindman) VALUES (@typename_1, @contracttempletid_2, @saveurl_3, @ishirecontract_4, @remindaheaddate_5, @remindman_6)

GO
alter procedure [HrmConType_Delete] (@id_1 int, @flag int output, @msg varchar(4000) output) AS DELETE FROM HrmContractType WHERE id = @id_1

GO
alter procedure [HrmCostcenter_Update] (@id_1 [int], @costcentermark_2 varchar(4000), @costcentername_3 varchar(4000), @departmentid_5 [int], @ccsubcategory1_6 	[int],  @flag integer output, @msg varchar(4000) output ) AS UPDATE [HrmCostcenter]  SET  [costcentermark] = @costcentermark_2, [costcentername] = @costcentername_3, [departmentid] = @departmentid_5, [ccsubcategory1] = @ccsubcategory1_6  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmCostcenter_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmCostcenter where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmCostcenter_SelectByDeptID] @id varchar(4000) , @groupby varchar(4000) , @flag integer output , @msg varchar(4000) output AS if convert(int,@groupby)=1 begin select ccsubcategory1 from HrmCostcenter where departmentid =convert(int, @id) group by ccsubcategory1 end set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmCostcenter_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmCostcenter set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmCostcenter_Insert] (@costcentermark_1 varchar(4000), @costcentername_2 varchar(4000), @departmentid_4 [int], @ccsubcategory1_5 [int], @flag integer output, @msg varchar(4000) output ) AS INSERT INTO [HrmCostcenter] ( [costcentermark], [costcentername], [departmentid], [ccsubcategory1] ) VALUES ( @costcentermark_1, @costcentername_2, @departmentid_4, @ccsubcategory1_5 ) select max(id) from [HrmCostcenter]  if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmCostcenter_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DECLARE @recordercount integer Select @recordercount = count(id) from HrmResource where costcenterid =convert(int, @id_1) if @recordercount = 0 begin DELETE [HrmCostcenter]  WHERE ( [id]	 = @id_1) end else begin select '20' end IF @@error<>0 begin set @flag=1 set @msg='更新储存过程失败' return END ELSE begin set @flag=1 set @msg='更新储存过程失败' return END

GO
alter procedure [NewDocFrontpage_SMRecentCount] ( @logintype		int, @usertype		int, @userid			int, @userseclevel	int, @flag integer output, @msg varchar(4000) output) as if @logintype=1 begin Select count(distinct c.id ) countnew from NewDocFrontpage n , DocShareDetail d , docdetail c where n.docid=d.docid and n.docid=c.id and n.userid=d.userid and  d.usertype=1 and n.userid=@userid and (c.docpublishtype='2' or c.docpublishtype='3') and c.docstatus in('1','2','5') and c.maincategory='5' end else begin Select count(distinct c.id ) countnew from NewDocFrontpage n , DocShareDetail d  , docdetail c where  n.docid=d.docid and n.docid= c.id and  n.usertype = d.usertype and n.usertype=@usertype and d.userid<=@userseclevel and ( c.docpublishtype='2' or c.docpublishtype='3') and c.docstatus in('1','2','5') and maincategory='5' end

GO
alter procedure [HrmRoles_insert] @rolesmark varchar(4000), @rolesname varchar(4000), @docid int, @type int, @subcompanyid int, @flag int output, @msg varchar(4000) output as if @docid = 0 set @docid = null begin insert into HrmRoles(rolesmark,rolesname,docid,type,subcompanyid) values(@rolesmark,@rolesname,@docid,@type,@subcompanyid)  if @@error<>0 begin set @flag=1 set @msg='插入失败' end else begin set @flag=0 set @msg='操作成功' end  select id from hrmroles where rolesmark=@rolesmark and rolesname=@rolesname and docid=@docid and type=@type and subcompanyid=@subcompanyid end

GO
alter procedure [HrmRoles_deleteSingle] @roleid int, @flag int output, @msg varchar(4000) output as begin if exists(select id from hrmrolemembers where roleid=@roleid) begin set @flag=11 select @flag return end else begin delete from hrmroles where id=@roleid delete from SystemRightRoles where roleid=@roleid delete from SysRoleSubcomRight where roleid=@roleid set @flag=0 select @flag end end

GO
alter procedure [Prj_ProjectInfo_Insert] ( @name_1 	varchar(4000), @description_2 	varchar(4000), @prjtype_3 	int, @worktype_4 	int, @securelevel_5 	int, @status_6 	int, @isblock_7 	tinyint, @managerview_8 	tinyint, @parentview_9 	tinyint, @budgetmoney_10 	varchar(4000), @moneyindeed_11 	varchar(4000), @budgetincome_12 	varchar(4000), @imcomeindeed_13 	varchar(4000), @planbegindate_14 	varchar(4000), @planbegintime_15 	varchar(4000), @planenddate_16 	varchar(4000), @planendtime_17 	varchar(4000), @truebegindate_18 	varchar(4000), @truebegintime_19 	varchar(4000), @trueenddate_20 	varchar(4000), @trueendtime_21 	varchar(4000), @planmanhour_22 	int, @truemanhour_23 	int, @picid_24 	int, @intro_25 	varchar(4000), @parentid_26 	int, @envaluedoc_27 	int, @confirmdoc_28 	int, @proposedoc_29 	int, @manager_30 	int, @department_31 	int, @subcompanyid1 	int, @creater_32 	int, @createdate_33 	varchar(4000), @createtime_34 	varchar(4000), @isprocessed_35 	tinyint, @processer_36 	int, @processdate_37 	varchar(4000), @processtime_38 	varchar(4000), @proCode   varchar(4000), @proTemplateId  int, @relationXml   text, @datefield1_39 	varchar(4000), @datefield2_40 	varchar(4000), @datefield3_41 	varchar(4000), @datefield4_42 	varchar(4000), @datefield5_43 	varchar(4000), @numberfield1_44 	float, @numberfield2_45 	float, @numberfield3_46 	float, @numberfield4_47 	float, @numberfield5_48 	float, @textfield1_49 	varchar(4000), @textfield2_50 	varchar(4000), @textfield3_51 	varchar(4000), @textfield4_52 	varchar(4000), @textfield5_53 	varchar(4000), @boolfield1_54 	tinyint, @boolfield2_55 	tinyint, @boolfield3_56 	tinyint, @boolfield4_57 	tinyint, @boolfield5_58 	tinyint, @flag	int	output, @msg	varchar(4000)	output)   AS  INSERT INTO Prj_ProjectInfo ( name, description, prjtype, worktype, securelevel, status, isblock, managerview, parentview, budgetmoney, moneyindeed, budgetincome, imcomeindeed, planbegindate, planbegintime, planenddate, planendtime, truebegindate, truebegintime, trueenddate, trueendtime, planmanhour, truemanhour, picid, intro, parentid, envaluedoc, confirmdoc, proposedoc, manager, department, subcompanyid1, creater, createdate, createtime, isprocessed, processer, processdate, processtime,proCode,proTemplateId,relationXml, datefield1, datefield2, datefield3, datefield4, datefield5, numberfield1, numberfield2, numberfield3, numberfield4, numberfield5, textfield1, textfield2, textfield3, textfield4, textfield5, tinyintfield1, tinyintfield2, tinyintfield3, tinyintfield4, tinyintfield5) VALUES ( @name_1, @description_2, @prjtype_3, @worktype_4, @securelevel_5, @status_6, @isblock_7, @managerview_8, @parentview_9, convert(money,@budgetmoney_10), convert(money,@moneyindeed_11), convert(money,@budgetincome_12), convert(money,@imcomeindeed_13), @planbegindate_14, @planbegintime_15, @planenddate_16, @planendtime_17, @truebegindate_18, @truebegintime_19, @trueenddate_20, @trueendtime_21, @planmanhour_22, @truemanhour_23, @picid_24, @intro_25, @parentid_26, @envaluedoc_27, @confirmdoc_28, @proposedoc_29, @manager_30, @department_31, @subcompanyid1, @creater_32, @createdate_33, @createtime_34, @isprocessed_35, @processer_36, @processdate_37, @processtime_38,@proCode,@proTemplateId, @relationXml,@datefield1_39, @datefield2_40, @datefield3_41, @datefield4_42, @datefield5_43, @numberfield1_44, @numberfield2_45, @numberfield3_46, @numberfield4_47, @numberfield5_48, @textfield1_49, @textfield2_50, @textfield3_51, @textfield4_52, @textfield5_53, @boolfield1_54, @boolfield2_55, @boolfield3_56, @boolfield4_57, @boolfield5_58)

GO
alter procedure [HrmRoleMembers_SByDepartmentID] (@id_1 	[int], @flag int output, @msg varchar(4000) output)  AS select resourceid,roleid,rolelevel from HrmRoleMembers, HrmResource WHERE HrmRoleMembers.resourceid = HrmResource.id and HrmResource.departmentid = @id_1 order by resourceid , rolelevel desc

 GO
alter procedure [bill_HrmFinance_SelectLoan] @resourceid	int, @flag integer output , @msg varchar(4000) output AS declare @tmpamount1   decimal(10,3), @tmpamount2   decimal(10,3) select @tmpamount1=sum(amount) from FnaLoanLog where resourceid=@resourceid and loantypeid = 1  select @tmpamount2=sum(amount) from FnaLoanLog where resourceid=@resourceid and loantypeid != 1  if    @tmpamount1 is null set @tmpamount1=0 if    @tmpamount2 is null set @tmpamount2=0  set @tmpamount1=@tmpamount1-@tmpamount2  select @tmpamount1

GO
alter procedure [WorkflowRequestbase_SCountByC] (@year 	[char](4), @createrid    int, @flag int output, @msg varchar(4000) output) AS select createdate , count(requestid) from workflow_requestbase where creater = @createrid and substring(createdate,1,4)=@year group by createdate order by createdate

GO
alter procedure [WorkPlanExchange_WP_Add] ( @workPlanId_1 int, @flag integer output , @msg varchar(4000) output) AS DECLARE @m_userid int DECLARE @m_usertype int DECLARE all_cursor CURSOR FOR SELECT DISTINCT userid, usertype FROM WorkPlanShareDetail WHERE workid = @workPlanId_1 OPEN all_cursor FETCH NEXT FROM all_cursor INTO @m_userid, @m_usertype WHILE (@@FETCH_STATUS = 0) BEGIN EXEC WorkPlanExchange_Insert @workPlanId_1, @m_userid, @m_usertype, '', '' FETCH NEXT FROM all_cursor INTO @m_userid, @m_usertype END CLOSE all_cursor DEALLOCATE all_cursor

GO
alter procedure [workflow_RequestRemark_Select] @requestid	int, @isremark	char(1), @flag	int output, @msg	varchar(4000) output AS select userid from workflow_currentoperator where requestid=@requestid and isremark=@isremark

GO
alter procedure [workflow_RequestRemark_SByUser] @requestid	int, @userid		int, @isremark	char(1), @flag	int output, @msg	varchar(4000) output AS select * from workflow_currentoperator where requestid=@requestid and userid=@userid and isremark=@isremark

GO
alter procedure [workflow_RequestRemark_Insert] @requestid	int, @userid		int, @groupid	int, @workflowid	int, @workflowtype	int, @isremark	char(1), @usertype	char(1), @flag	int output, @msg	varchar(4000) output AS insert into workflow_currentoperator (requestid,userid,groupid,workflowid,workflowtype,isremark,usertype) values (@requestid,@userid,@groupid,@workflowid,@workflowtype,@isremark,@usertype)

GO
alter procedure [workflow_RequestRemark_Delete] @requestid	int, @userid		int, @isremark	char(1), @flag	int output, @msg	varchar(4000) output AS delete from workflow_currentoperator where requestid=@requestid and userid=@userid and isremark=@isremark

GO
alter procedure [workflow_Requestbase_Update] @requestid	int, @workflowid	int, @lastnodeid	int, @lastnodetype	char(1), @currentnodeid	int, @currentnodetype	char(1), @status		varchar(4000), @passedgroups	int, @totalgroups	int, @requestname	varchar(4000), @creater	int, @createdate	char(10), @createtime	char(8), @lastoperator	int, @lastoperatedate	char(10), @lastoperatetime	char(8), @deleted	int, @creatertype	int, @lastoperatortype	int, @nodepasstime	float, @nodelefttime	float, @docids 		[text], @crmids 		[text], @hrmids 		[text], @prjids 		[text], @cptids 		[text], @flag integer output , @msg varchar(4000) output AS update workflow_requestbase set workflowid=@workflowid, lastnodeid=@lastnodeid, lastnodetype=@lastnodetype, currentnodeid=@currentnodeid, currentnodetype=@currentnodetype, status=@status, passedgroups=@passedgroups, totalgroups=@totalgroups, requestname=@requestname, creater=@creater, createdate=@createdate, createtime=@createtime, lastoperator=@lastoperator, lastoperatedate=@lastoperatedate, lastoperatetime=@lastoperatetime, deleted=@deleted , creatertype=@creatertype, lastoperatortype=@lastoperatortype, nodepasstime=@nodepasstime, nodelefttime=@nodelefttime, docids=@docids, crmids=@crmids, hrmids=@hrmids, prjids=@prjids, cptids=@cptids where requestid=@requestid

GO
alter procedure [workflow_RequestLog_SBUser] @requestid	int, @operator int , @operatortype int , @logtype char(1) , @flag integer output , @msg varchar(4000) output AS select * from workflow_requestlog where requestid=@requestid and operator=@operator and operatortype=@operatortype and logtype=@logtype

GO
alter procedure  [workflow_RequestLog_Insert_New] @requestid int, @workflowid    int, @nodeid    int, @logtype   char(1), @operatedate   char(10), @operatetime  char(8), @operator  int, @remark    text, @clientip char(15), @operatortype int, @destnodeid    int, @operate varchar(4000), @agentorbyagentid  int,@agenttype  char(1),@showorder int,@annexdocids varchar(4000), @requestLogId int,@signdocids varchar(4000),@signworkflowids varchar(4000), @clientType char(1), @speechAttachment int,@handWrittenSign int,@flag integer output , @msg varchar(4000) output AS declare @count integer, @currentdate char(10), @currenttime char(8), @operatorDept integer set @currentdate=convert(char(10),getdate(),20) set @currenttime=convert(char(8),getdate(),108) if @operatortype = '0' begin select @operatorDept = departmentid from hrmresource where id = @operator end else begin set @operatorDept = 0 end if @logtype = '1' begin select @count = count(*) from workflow_requestlog where requestid=@requestid and nodeid=@nodeid and logtype=@logtype and operator = @operator and operatortype = @operatortype if @count > 0 begin update workflow_requestlog SET   [operatedate]   = @currentdate, [operatetime]   = @currenttime, [remark]    = @remark, [clientip]   = @clientip, [destnodeid]   = @destnodeid,annexdocids=@annexdocids ,requestLogId=@requestLogId,signdocids=@signdocids,signworkflowids=@signworkflowids,isMobile=@clientType,SpeechAttachment=@speechAttachment,HandWrittenSign=@handWrittenSign  WHERE ( [requestid]  = @requestid AND [nodeid]   = @nodeid AND [logtype]    = @logtype AND [operator]   = @operator AND [operatortype]  = @operatortype) end else begin insert into workflow_requestlog (requestid,workflowid,nodeid,logtype, operatedate,operatetime,operator, remark,clientip,operatortype,destnodeid,receivedPersons,agentorbyagentid,agenttype,showorder,annexdocids,requestLogId,operatorDept,signdocids,signworkflowids,isMobile,HandWrittenSign,SpeechAttachment) values(@requestid,@workflowid,@nodeid,@logtype, @currentdate,@currenttime,@operator, @remark,@clientip,@operatortype,@destnodeid,@operate,@agentorbyagentid,@agenttype,@showorder,@annexdocids,@requestLogId,@operatorDept,@signdocids,@signworkflowids,@clientType,@handWrittenSign,@speechAttachment) end select @currentdate,@currenttime from workflow_requestlog where requestid=@requestid end else begin delete workflow_requestlog where requestid=@requestid and nodeid=@nodeid and (logtype='1') and operator = @operator and operatortype = @operatortype insert into workflow_requestlog (requestid,workflowid,nodeid,logtype, operatedate,operatetime,operator, remark,clientip,operatortype,destnodeid,receivedPersons,agentorbyagentid,agenttype,showorder,annexdocids,requestLogId,operatorDept,signdocids,signworkflowids,isMobile,HandWrittenSign,SpeechAttachment) values(@requestid,@workflowid,@nodeid,@logtype, @currentdate,@currenttime,@operator, @remark,@clientip,@operatortype,@destnodeid,@operate,@agentorbyagentid,@agenttype,@showorder,@annexdocids,@requestLogId,@operatorDept,@signdocids,@signworkflowids,@clientType,@handWrittenSign,@speechAttachment) select @currentdate,@currenttime from workflow_requestlog where requestid=@requestid end

GO
alter procedure  [workflow_RequestLogCurDate_New] @requestid int, @workflowid    int, @nodeid    int, @logtype   char(1), @operatedate   char(10), @operatetime  char(8), @operator  int, @remark    text, @clientip char(15), @operatortype int, @destnodeid    int, @operate varchar(4000), @agentorbyagentid  int,@agenttype  char(1),@showorder int,@annexdocids varchar(4000), @requestLogId int,@signdocids varchar(4000),@signworkflowids varchar(4000),@clientType char(1), @speechAttachment int,@handWrittenSign int,@flag integer output , @msg varchar(4000) output AS declare @count integer, @operatorDept integer if @operatortype = '0' begin select @operatorDept = departmentid from hrmresource where id = @operator end else begin set @operatorDept = 0 end if @logtype = '1' begin select @count = count(*) from workflow_requestlog where requestid=@requestid and nodeid=@nodeid and logtype=@logtype and operator = @operator and operatortype = @operatortype if @count > 0 begin update workflow_requestlog SET   [operatedate]   = @operatedate, [operatetime]   = @operatetime, [remark]    = @remark, [clientip]   = @clientip, [destnodeid]   = @destnodeid,annexdocids=@annexdocids ,requestLogId=@requestLogId,signdocids=@signdocids,signworkflowids=@signworkflowids,isMobile=@clientType,SpeechAttachment=@speechAttachment,HandWrittenSign=@handWrittenSign WHERE ( [requestid]  = @requestid AND [nodeid]   = @nodeid AND [logtype]    = @logtype AND [operator]   = @operator AND [operatortype]  = @operatortype) end else begin insert into workflow_requestlog (requestid,workflowid,nodeid,logtype, operatedate,operatetime,operator, remark,clientip,operatortype,destnodeid,receivedPersons,agentorbyagentid,agenttype,showorder,annexdocids,requestLogId,operatorDept,signdocids,signworkflowids,isMobile,HandWrittenSign,SpeechAttachment) values(@requestid,@workflowid,@nodeid,@logtype, @operatedate,@operatetime,@operator, @remark,@clientip,@operatortype,@destnodeid,@operate,@agentorbyagentid,@agenttype,@showorder,@annexdocids,@requestLogId,@operatorDept,@signdocids,@signworkflowids,@clientType,@handWrittenSign,@speechAttachment) end end else begin delete workflow_requestlog where requestid=@requestid and nodeid=@nodeid and (logtype='1') and operator = @operator and operatortype = @operatortype insert into workflow_requestlog (requestid,workflowid,nodeid,logtype, operatedate,operatetime,operator, remark,clientip,operatortype,destnodeid,receivedPersons,agentorbyagentid,agenttype,showorder,annexdocids,requestLogId,operatorDept,signdocids,signworkflowids,isMobile,HandWrittenSign,SpeechAttachment) values(@requestid,@workflowid,@nodeid,@logtype, @operatedate,@operatetime,@operator, @remark,@clientip,@operatortype,@destnodeid,@operate,@agentorbyagentid,@agenttype,@showorder,@annexdocids,@requestLogId,@operatorDept,@signdocids,@signworkflowids,@clientType,@handWrittenSign,@speechAttachment) end

GO
alter procedure [FnaYearsPeriodsList_Close] (@id_1 	[int], @fnayearperiods  char(6), @flag integer output , @msg varchar(4000) output)  AS declare @count integer   select @count = count(id) from FnaYearsPeriodsList where fnayearperiodsid < @fnayearperiods and isactive = '1' and isclose ='0'  if @count <> 0 begin select -1 return end   select @count = count(id) from FnaTransaction where transtatus != '2' and tranperiods = @fnayearperiods  if @count <> 0 begin select -2 return end    select @count = count(id) from FnaBudget where budgetstatus != '2' and budgetperiods = @fnayearperiods  if @count <> 0 begin select -2 return end     delete FnaAccount where tranperiods = @fnayearperiods delete FnaAccountDepartment where tranperiods = @fnayearperiods delete FnaAccountCostcenter where tranperiods = @fnayearperiods delete FnaBudgetDepartment where budgetperiods = @fnayearperiods delete FnaBudgetCostcenter where budgetperiods = @fnayearperiods  declare @ledgerid int , @departmentid int , @costcenterid int,@trandaccount decimal(18,3),@trancaccount decimal(18,3) declare @ledgerbalance char(1) , @subledgercount int ,@tranremain decimal(18,3),@tmptranperiods char(6) declare @tmplegderstr  varchar(4000),@budgetmoduleid int,@budgetaccount decimal(18,3),@budgetperiods char(6)   declare ledgerid_cursor cursor for select id from  FnaLedger where subledgercount = 0  open ledgerid_cursor fetch next from ledgerid_cursor into @ledgerid while @@fetch_status=0 begin set @trandaccount = 0 set @trancaccount = 0 set @tranremain = 0 select @count = count(id) ,@tmptranperiods = max(tranperiods) from FnaAccount where ledgerid = @ledgerid if @count <> 0 begin select @tranremain = tranremain from FnaAccount where ledgerid = @ledgerid and tranperiods = @tmptranperiods end select @ledgerbalance=ledgerbalance from FnaLedger where id = @ledgerid select @trandaccount = sum(tranaccount) from FnaAccountList where ledgerid = @ledgerid and tranperiods = @fnayearperiods and tranbalance = '1' select @trancaccount = sum(tranaccount) from FnaAccountList where ledgerid = @ledgerid and tranperiods = @fnayearperiods and tranbalance = '2' if @trandaccount is null set @trandaccount = 0 if @trancaccount is null set @trancaccount = 0 if @tranremain is null set @tranremain = 0  if @ledgerbalance = '1' set @tranremain = @tranremain + @trandaccount - @trancaccount else set @tranremain = @tranremain - @trandaccount + @trancaccount  insert into FnaAccount(ledgerid,tranperiods,trandaccount,trancaccount,tranremain,tranbalance) values(@ledgerid,@fnayearperiods,@trandaccount,@trancaccount,@tranremain,@ledgerbalance) fetch next from ledgerid_cursor into @ledgerid end close ledgerid_cursor deallocate ledgerid_cursor    declare departmentid_cursor cursor for select ledgerid, trandepartmentid from  FnaTransaction t , FnaTransactionDetail d where t.id = d.tranid and tranperiods = @fnayearperiods group by ledgerid , trandepartmentid  open departmentid_cursor fetch next from departmentid_cursor into @ledgerid,@departmentid while @@fetch_status=0 begin set @trandaccount = 0 set @trancaccount = 0 set @tranremain = 0 select @ledgerbalance =ledgerbalance from FnaLedger where id = @ledgerid select @trandaccount = sum(trandefaccount) from FnaTransaction t , FnaTransactionDetail d where t.id = d.tranid and tranperiods = @fnayearperiods and ledgerid = @ledgerid and trandepartmentid=@departmentid and tranbalance = '1' select @trancaccount = sum(trandefaccount) from FnaTransaction t , FnaTransactionDetail d where t.id = d.tranid and tranperiods = @fnayearperiods and ledgerid = @ledgerid and trandepartmentid=@departmentid and tranbalance = '2' if @trandaccount is null set @trandaccount = 0 if @trancaccount is null set @trancaccount = 0 if @ledgerbalance = '1' set @tranremain = @trandaccount - @trancaccount else set @tranremain = @trancaccount - @trandaccount  insert into FnaAccountDepartment(ledgerid,departmentid,tranperiods,tranaccount,tranbalance) values(@ledgerid,@departmentid,@fnayearperiods,@tranremain,@ledgerbalance) fetch next from departmentid_cursor into @ledgerid,@departmentid end close departmentid_cursor deallocate departmentid_cursor    declare costcenterid_cursor cursor for select ledgerid, trancostercenterid from  FnaTransaction t , FnaTransactionDetail d where t.id = d.tranid and tranperiods = @fnayearperiods group by ledgerid , trancostercenterid  open costcenterid_cursor fetch next from costcenterid_cursor into @ledgerid,@costcenterid while @@fetch_status=0 begin set @trandaccount = 0 set @trancaccount = 0 set @tranremain = 0 select @ledgerbalance =ledgerbalance from FnaLedger where id = @ledgerid select @trandaccount = sum(trandefaccount) from FnaTransaction t , FnaTransactionDetail d where t.id = d.tranid and tranperiods = @fnayearperiods and ledgerid = @ledgerid and trancostercenterid=@costcenterid and tranbalance = '1' select @trancaccount = sum(trandefaccount) from FnaTransaction t , FnaTransactionDetail d where t.id = d.tranid and tranperiods = @fnayearperiods and ledgerid = @ledgerid and trancostercenterid=@costcenterid and tranbalance = '2' if @trandaccount is null set @trandaccount = 0 if @trancaccount is null set @trancaccount = 0 if @ledgerbalance = '1' set @tranremain = @trandaccount - @trancaccount else set @tranremain = @trancaccount - @trandaccount  insert into FnaAccountCostcenter(ledgerid,costcenterid,tranperiods,tranaccount,tranbalance) values(@ledgerid,@costcenterid,@fnayearperiods,@tranremain,@ledgerbalance) fetch next from costcenterid_cursor into @ledgerid,@costcenterid end close costcenterid_cursor deallocate costcenterid_cursor    declare departmentbudgetid_cursor cursor for select ledgerid, budgetdepartmentid,budgetmoduleid, sum(budgetaccount) from  FnaBudgetList where budgetperiods = @fnayearperiods group by ledgerid ,budgetmoduleid, budgetdepartmentid  open departmentbudgetid_cursor fetch next from departmentbudgetid_cursor into @ledgerid,@departmentid,@budgetmoduleid,@budgetaccount while @@fetch_status=0 begin insert into FnaBudgetDepartment(ledgerid,departmentid,budgetmoduleid,budgetperiods,budgetaccount) values(@ledgerid,@departmentid,@budgetmoduleid,@fnayearperiods,@budgetaccount) fetch next from departmentbudgetid_cursor into @ledgerid,@departmentid,@budgetmoduleid,@budgetaccount end close departmentbudgetid_cursor deallocate departmentbudgetid_cursor      declare costcenterbudgetid_cursor cursor for select ledgerid, budgetcostcenterid,budgetmoduleid, sum(budgetaccount) from  FnaBudgetList where budgetperiods = @fnayearperiods group by ledgerid ,budgetmoduleid, budgetcostcenterid  open costcenterbudgetid_cursor fetch next from costcenterbudgetid_cursor into @ledgerid,@costcenterid,@budgetmoduleid,@budgetaccount while @@fetch_status=0 begin insert into FnaBudgetCostcenter(ledgerid,costcenterid,budgetmoduleid,budgetperiods,budgetaccount) values(@ledgerid,@costcenterid,@budgetmoduleid,@fnayearperiods,@budgetaccount) fetch next from costcenterbudgetid_cursor into @ledgerid,@costcenterid,@budgetmoduleid,@budgetaccount end close costcenterbudgetid_cursor deallocate costcenterbudgetid_cursor     declare ledgeridsup_cursor cursor for select id from  FnaLedger where subledgercount != 0  open ledgeridsup_cursor fetch next from ledgeridsup_cursor into @ledgerid while @@fetch_status=0 begin set @trandaccount = 0 set @trancaccount = 0 set @tranremain = 0 set @tmplegderstr = '%' + convert(varchar(4000),@ledgerid) + '|%' select @count = count(id) ,@tmptranperiods = max(tranperiods) from FnaAccount where ledgerid = @ledgerid if @count <> 0 begin select @tranremain = tranremain from FnaAccount where ledgerid = @ledgerid and tranperiods = @tmptranperiods end select @ledgerbalance =ledgerbalance from FnaLedger where id = @ledgerid select @trandaccount = sum(a.trandaccount) , @trancaccount = sum(a.trancaccount) from FnaAccount a , FnaLedger b where a.ledgerid = b.id and b.supledgerall like @tmplegderstr and b.subledgercount = 0 and a.tranperiods = @fnayearperiods  if @trandaccount is null set @trandaccount = 0 if @trancaccount is null set @trancaccount = 0 if @tranremain is null set @tranremain = 0 if @ledgerbalance = '1' set @tranremain = @tranremain + @trandaccount - @trancaccount else set @tranremain = @tranremain - @trandaccount + @trancaccount insert into FnaAccount(ledgerid,tranperiods,trandaccount,trancaccount,tranremain,tranbalance) values(@ledgerid,@fnayearperiods,@trandaccount,@trancaccount,@tranremain,@ledgerbalance) fetch next from ledgeridsup_cursor into @ledgerid end close ledgeridsup_cursor deallocate ledgeridsup_cursor    create table #tempdepartment( ledgerid  int , departmentid  int, ledgerbalance  char(1) )  create table #tempcostcenter( ledgerid  int , costcenterid  int, ledgerbalance  char(1) )  declare ledgerdepartment_cursor cursor for select a.id , b.id , a.ledgerbalance from  FnaLedger a, HrmDepartment b where subledgercount != 0  open ledgerdepartment_cursor fetch next from ledgerdepartment_cursor into @ledgerid,@departmentid,@ledgerbalance while @@fetch_status=0 begin insert into #tempdepartment values(@ledgerid,@departmentid,@ledgerbalance) fetch next from ledgerdepartment_cursor into @ledgerid,@departmentid,@costcenterid end close ledgerdepartment_cursor deallocate ledgerdepartment_cursor  declare ledgercostcenter_cursor cursor for select a.id , b.id , a.ledgerbalance from  FnaLedger a, HrmCostcenter b where subledgercount != 0  open ledgercostcenter_cursor fetch next from ledgercostcenter_cursor into @ledgerid,@costcenterid,@ledgerbalance while @@fetch_status=0 begin insert into #tempcostcenter values(@ledgerid,@costcenterid,@ledgerbalance) fetch next from ledgercostcenter_cursor into @ledgerid,@costcenterid,@ledgerbalance end close ledgercostcenter_cursor deallocate ledgercostcenter_cursor    declare departmentsupledger_cursor cursor for select * from #tempdepartment  open departmentsupledger_cursor fetch next from departmentsupledger_cursor into @ledgerid,@departmentid,@ledgerbalance while @@fetch_status=0 begin set @trandaccount = 0 set @trancaccount = 0 set @tranremain = 0 set @tmplegderstr = '%' + convert(varchar(4000),@ledgerid) + '|%' select @trandaccount = sum(a.tranaccount) from FnaAccountDepartment a , FnaLedger b where a.ledgerid = b.id and b.supledgerall like @tmplegderstr and a.departmentid = @departmentid and a.tranperiods = @fnayearperiods and a.tranbalance = @ledgerbalance select @trancaccount = sum(a.tranaccount) from FnaAccountDepartment a , FnaLedger b where a.ledgerid = b.id and b.supledgerall like @tmplegderstr and a.departmentid = @departmentid and a.tranperiods = @fnayearperiods and a.tranbalance != @ledgerbalance if @trandaccount is null set @trandaccount = 0 if @trancaccount is null set @trancaccount = 0 set @tranremain = @trandaccount - @trancaccount if @tranremain <> 0 begin insert into FnaAccountDepartment(ledgerid,departmentid,tranperiods,tranaccount,tranbalance) values(@ledgerid,@departmentid,@fnayearperiods,@tranremain,@ledgerbalance) end fetch next from departmentsupledger_cursor into @ledgerid,@departmentid,@ledgerbalance end close departmentsupledger_cursor deallocate departmentsupledger_cursor    declare costcentersupledger_cursor cursor for select * from #tempcostcenter  open costcentersupledger_cursor fetch next from costcentersupledger_cursor into @ledgerid,@costcenterid,@ledgerbalance while @@fetch_status=0 begin set @trandaccount = 0 set @trancaccount = 0 set @tranremain = 0 set @tmplegderstr = '%' + convert(varchar(4000),@ledgerid) + '|%' select @trandaccount = sum(a.tranaccount) from FnaAccountCostcenter a , FnaLedger b where a.ledgerid = b.id and b.supledgerall like @tmplegderstr and a.costcenterid = @costcenterid and a.tranperiods = @fnayearperiods and a.tranbalance = @ledgerbalance select @trancaccount = sum(a.tranaccount) from FnaAccountCostcenter a , FnaLedger b where a.ledgerid = b.id and b.supledgerall like @tmplegderstr and a.costcenterid = @costcenterid and a.tranperiods = @fnayearperiods and a.tranbalance != @ledgerbalance if @trandaccount is null set @trandaccount = 0 if @trancaccount is null set @trancaccount = 0 set @tranremain = @trandaccount - @trancaccount if @tranremain <> 0 begin insert into FnaAccountCostcenter(ledgerid,costcenterid,tranperiods,tranaccount,tranbalance) values(@ledgerid,@costcenterid,@fnayearperiods,@tranremain,@ledgerbalance) end fetch next from costcentersupledger_cursor into @ledgerid,@costcenterid,@ledgerbalance end close costcentersupledger_cursor deallocate costcentersupledger_cursor    create table #tempdepartmentbuget( ledgerid  int , departmentid  int, budgetmoduleid int )  create table #tempcostcenterbudget( ledgerid  int , costcenterid  int, budgetmoduleid int )  declare @fnayear char(4) , @theperiods int select @fnayear = left(@fnayearperiods ,4) select @theperiods = convert(int,right(@fnayearperiods,2))  declare budgetdepartmentmodule_cursor cursor for select a.id , b.id , c.id from  FnaLedger a, HrmDepartment b ,FnaBudgetModule c where subledgercount != 0 and c.fnayear = @fnayear and c.periodsidfrom <= @theperiods and c.periodsidto >= @theperiods  open budgetdepartmentmodule_cursor fetch next from budgetdepartmentmodule_cursor into @ledgerid,@departmentid,@budgetmoduleid while @@fetch_status=0 begin insert into #tempdepartmentbuget values(@ledgerid,@departmentid,@budgetmoduleid) fetch next from budgetdepartmentmodule_cursor into @ledgerid,@departmentid,@budgetmoduleid end close budgetdepartmentmodule_cursor deallocate budgetdepartmentmodule_cursor  declare budgetcostcentermodule_cursor cursor for select a.id , b.id , c.id from  FnaLedger a, HrmCostcenter b ,FnaBudgetModule c where subledgercount != 0 and c.fnayear = @fnayear and c.periodsidfrom <= @theperiods and c.periodsidto >= @theperiods  open budgetcostcentermodule_cursor fetch next from budgetcostcentermodule_cursor into @ledgerid,@costcenterid,@budgetmoduleid while @@fetch_status=0 begin insert into #tempcostcenterbudget values(@ledgerid,@costcenterid,@budgetmoduleid) fetch next from budgetcostcentermodule_cursor into @ledgerid,@costcenterid,@budgetmoduleid end close budgetcostcentermodule_cursor deallocate budgetcostcentermodule_cursor      declare departmentsupledgerbudget_cursor cursor for select * from #tempdepartmentbuget  open departmentsupledgerbudget_cursor fetch next from departmentsupledgerbudget_cursor into @ledgerid,@departmentid,@budgetmoduleid while @@fetch_status=0 begin set @budgetaccount = 0 set @tmplegderstr = '%' + convert(varchar(4000),@ledgerid) + '|%' select @budgetaccount = sum(budgetaccount) from FnaBudgetList a , FnaLedger b where a.ledgerid = b.id and b.supledgerall like @tmplegderstr and a.budgetdepartmentid = @departmentid and a.budgetperiods = @fnayearperiods and a.budgetmoduleid = @budgetmoduleid  if @budgetaccount <> 0 begin insert into FnaBudgetDepartment(ledgerid,departmentid,budgetmoduleid,budgetperiods,budgetaccount) values(@ledgerid,@departmentid,@budgetmoduleid,@budgetperiods,@budgetaccount) end fetch next from departmentsupledgerbudget_cursor into @ledgerid,@departmentid,@budgetmoduleid end close departmentsupledgerbudget_cursor deallocate departmentsupledgerbudget_cursor    declare costcentersupledgerbudget_cursor cursor for select * from #tempcostcenterbudget  open costcentersupledgerbudget_cursor fetch next from costcentersupledgerbudget_cursor into @ledgerid,@costcenterid,@budgetmoduleid while @@fetch_status=0 begin set @budgetaccount = 0 set @tmplegderstr = '%' + convert(varchar(4000),@ledgerid) + '|%' select @budgetaccount = sum(budgetaccount) from FnaBudgetList a , FnaLedger b where a.ledgerid = b.id and b.supledgerall like @tmplegderstr and a.budgetcostcenterid = @costcenterid and a.budgetperiods = @fnayearperiods and a.budgetmoduleid = @budgetmoduleid  if @budgetaccount <> 0 begin insert into FnaBudgetCostcenter(ledgerid,costcenterid,budgetmoduleid,budgetperiods,budgetaccount) values(@ledgerid,@costcenterid,@budgetmoduleid,@budgetperiods,@budgetaccount) end fetch next from costcentersupledgerbudget_cursor into @ledgerid,@costcenterid,@budgetmoduleid end close costcentersupledgerbudget_cursor deallocate costcentersupledgerbudget_cursor    update FnaTransaction set transtatus = '3' where tranperiods = @fnayearperiods   update FnaBudget set budgetstatus = '3' where budgetperiods = @fnayearperiods    UPDATE [FnaYearsPeriodsList] SET  [isclose]	 = '1' WHERE ( [id]	 = @id_1)

  GO
alter procedure [FnaLoanLog_Update] ( @id_0 int, @loantypeid_1 int, @resourceid_2 int, @departmentid_3 int, @crmid_4 int, @projectid_5 int, @amount_6 decimal, @description_7 varchar(4000), @credenceno_8 varchar(4000), @occurdate_9 char(10), @releatedid_10 int, @releatedname_11 varchar(4000), @returndate_12 char(10), @dealuser_13 int, @flag integer output , @msg varchar(4000) output) AS UPDATE FnaLoanLog SET loantypeid = @loantypeid_1, resourceid = @resourceid_2, departmentid = @departmentid_3, crmid = @crmid_4, projectid = @projectid_5, amount = @amount_6, description = @description_7, credenceno = @credenceno_8, occurdate = @occurdate_9, releatedid = @releatedid_10, releatedname = @releatedname_11, returndate = @returndate_12, dealuser = @dealuser_13 WHERE id = @id_0

GO
alter procedure [FnaLoanLog_Insert] (@loantypeid_1 	int, @resourceid_2 	int, @departmentid_3 	int, @crmid_4 	int, @projectid_5 	int, @amount_6 	decimal(18,3), @description_7 	varchar(4000), @credenceno_8 	varchar(4000), @occurdate_9 	char(10), @releatedid_10 	int, @releatedname_11 	varchar(4000), @returndate_12 	char(10), @dealuser_13   integer , @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO FnaLoanLog ( loantypeid, resourceid, departmentid, crmid, projectid, amount, description, credenceno, occurdate, releatedid, releatedname, returndate, dealuser)  VALUES ( @loantypeid_1, @resourceid_2, @departmentid_3, @crmid_4, @projectid_5, @amount_6, @description_7, @credenceno_8, @occurdate_9, @releatedid_10, @releatedname_11, @returndate_12, @dealuser_13)

GO
alter procedure [FnaLoanLog_Delete] ( @id_0 int, @flag integer output , @msg varchar(4000) output) AS DELETE FnaLoanLog WHERE id = @id_0

GO
alter procedure [HrmSubCompany_Update] ( @id_1 int , @subcompanyname_2 varchar(4000) , @subcompanydesc_3 varchar(4000) , @companyid_4 tinyint , @supsubcomid_5 int , @url_6 varchar(4000) , @showorder_7 int , @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT ) AS DECLARE @count INT DECLARE @count1 INT SELECT  @count = COUNT(*) FROM    HrmSubCompany WHERE   subcompanyname = @subcompanyname_2 AND id != @id_1 AND supsubcomid = @supsubcomid_5 SELECT  @count1 = COUNT(*) FROM    HrmSubCompany WHERE   subcompanydesc = @subcompanydesc_3 AND id != @id_1 AND supsubcomid = @supsubcomid_5 IF @count > 0 BEGIN SET @flag = 2 SET @msg = '该分部简称已经存在，不能保存！' RETURN END IF @count1 > 0 BEGIN SET @flag = 3 SET @msg = '该分部全称已经存在，不能保存！' RETURN END UPDATE  HrmSubCompany SET     subcompanyname = @subcompanyname_2 , subcompanydesc = @subcompanydesc_3 , companyid = @companyid_4 , supsubcomid = @supsubcomid_5 , url = @url_6 , showorder = @showorder_7 WHERE   ( id = @id_1 ) IF @@error <> 0 BEGIN SET @flag = 1 SET @msg = '	更新储存过程失败' RETURN END ELSE BEGIN SET @flag = 0 SET @msg = '	更新储存过程成功' RETURN END

GO
alter procedure [HrmSubCompany_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmSubCompany order by supsubcomid,showorder,subcompanyname set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmSubCompany_SByCompanyID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmSubCompany where companyid =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmSubCompany_Insert] ( @subcompanyname_1 varchar(4000) , @subcompanydesc_2 varchar(4000) , @companyid_3 tinyint , @supsubcomid_4 int , @url_5 varchar(4000) , @showorder_6 int , @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT ) AS DECLARE @count INT DECLARE @count1 INT SELECT  @count = COUNT(*) FROM    HrmSubCompany WHERE   subcompanyname = @subcompanyname_1 AND supsubcomid = @supsubcomid_4 SELECT  @count1 = COUNT(*) FROM    HrmSubCompany WHERE   subcompanydesc = @subcompanydesc_2 AND supsubcomid = @supsubcomid_4 IF @count > 0 BEGIN SET @flag = 2 SET @msg = '该分部简称已经存在，不能保存！' RETURN END IF @count1 > 0 BEGIN SET @flag = 3 SET @msg = '该分部全称已经存在，不能保存！' RETURN END INSERT  INTO HrmSubCompany ( subcompanyname , subcompanydesc , companyid , supsubcomid , url , showorder ) VALUES  ( @subcompanyname_1 , @subcompanydesc_2 , @companyid_3 , @supsubcomid_4 , @url_5 , @showorder_6 ) SELECT  ( MAX(id) ) FROM    HrmSubCompany IF @@error <> 0 BEGIN SET @flag = 1 SET @msg = '	更新储存过程失败' RETURN END ELSE BEGIN SET @flag = 0 SET @msg = '	更新储存过程成功' RETURN END

GO
alter procedure [HrmSubCompany_Delete] (@id_1 	[int], @flag     integer output, @msg   varchar(4000) output) AS  DECLARE @recordercount integer Select @recordercount = count(id) from HrmDepartment where subcompanyid1 =convert(int, @id_1) if @recordercount = 0 begin DELETE [HrmSubCompany]  WHERE ( [id]	 = @id_1) end else begin select '20' end  if @@error<>0 begin set @flag=1 set @msg='	更新储存过程失败' return end else begin set @flag=0 set @msg='	更新储存过程成功' return end

GO
alter procedure [HrmResourceFinanceInfo_Insert] (@id_1 int, @bankid1_2 int, @accountid1_3 varchar(4000), @accumfundaccount_4 varchar(4000), @flag int output, @msg varchar(4000) output) AS UPDATE HrmResource SET bankid1 = @bankid1_2, accountid1 = @accountid1_3 , accumfundaccount = @accumfundaccount_4 WHERE id = @id_1

GO
alter procedure [HrmResourceDefine_Update] (@id_1 int, @datefield1_2 varchar(4000), @numberfield1_3 float, @textfield1_4 varchar(4000), @tinyintfield1_5 tinyint, @datefield2_6 varchar(4000), @numberfield2_7 float, @textfield2_8 varchar(4000), @tinyintfield2_9 tinyint, @datefield3_10 varchar(4000), @numberfield3_11 float, @textfield3_12 varchar(4000), @tinyintfield3_13 tinyint, @datefield4_14 varchar(4000), @numberfield4_15 float, @textfield4_16 varchar(4000), @tinyintfield4_17 tinyint, @datefield5_18 varchar(4000), @numberfield5_19 float, @textfield5_20 varchar(4000), @tinyintfield5_21 tinyint, @flag int output, @msg varchar(4000) output) as update HrmResource set datefield1 = @datefield1_2 , numberfield1 = @numberfield1_3 , textfield1 = @textfield1_4 , tinyintfield1 = @tinyintfield1_5 , datefield2 = @datefield2_6 , numberfield2 = @numberfield2_7 , textfield2 = @textfield2_8 , tinyintfield2 = @tinyintfield2_9 , datefield3 = @datefield3_10 , numberfield3 = @numberfield3_11 , textfield3 = @textfield3_12 , tinyintfield3 = @tinyintfield3_13 , datefield4 = @datefield4_14 , numberfield4 = @numberfield4_15 , textfield4 = @textfield4_16 , tinyintfield4 = @tinyintfield4_17 , datefield5 = @datefield5_18 , numberfield5 = @numberfield5_19 , textfield5 = @textfield5_20 , tinyintfield5 = @tinyintfield5_21 where id = @id_1

GO
alter procedure [HrmResourceDateCheck] (@today_1 char(10), @flag int output, @msg varchar(4000) output) as  delete from hrmrolemembers where resourceid in ( select id from HrmResource where (status = 0 or status = 1 or status = 2 or status = 3) and enddate < @today_1 and enddate <>'' and enddate is not null ) delete from PluginLicenseUser where plugintype='mobile' and sharetype='0' and sharevalue in ( select id from HrmResource where (status = 0 or status = 1 or status = 2 or status = 3) and enddate < @today_1 and enddate <>'' and enddate is not null ) update HrmResource set status = 7 where (status = 0 or status = 1 or status = 2 or status = 3) and enddate < @today_1 and enddate <>'' and enddate is not null   update HrmResource set status = 3 where status = 0 and probationenddate < @today_1 and probationenddate<>'' and probationenddate is not null   update HrmResource set status = 0 where status = 3 and (probationenddate >= @today_1 or probationenddate='' or probationenddate is null)

GO
alter procedure [HrmResourceContactInfo_Update] ( @id_1 INT , @locationid_15 INT , @workroom_16 varchar(4000) , @telephone_17 varchar(4000) , @mobile_18 varchar(4000) , @mobilecall_19 varchar(4000) , @fax_20 varchar(4000) , @systemlanguage_21 INT , @email_22 varchar(4000) , @mobileshowtype_23 varchar(4000) =null, @flag INT OUTPUT , @msg varchar(4000) OUTPUT ) AS UPDATE  HrmResource SET     locationid = @locationid_15 , workroom = @workroom_16 , telephone = @telephone_17 , mobile = @mobile_18 , mobileshowtype = @mobileshowtype_23 , mobilecall = @mobilecall_19 , fax = @fax_20 , email = @email_22 , systemlanguage = @systemlanguage_21 WHERE   id = @id_1

GO
alter procedure [HrmResourceBasicInfo_Insert] ( @id_1 INT , @workcode_2 varchar(4000) , @lastname_3 varchar(4000) , @sex_5 CHAR(1) , @resoureimageid_6 INT , @departmentid_7 INT , @costcenterid_8 INT , @jobtitle_9 INT , @joblevel_10 INT , @jobactivitydesc_11 varchar(4000) , @managerid_12 INT , @assistantid_13 INT , @status_14 CHAR(1) , @locationid_15 INT , @workroom_16 varchar(4000) , @telephone_17 varchar(4000) , @mobile_18 varchar(4000) , @mobilecall_19 varchar(4000) , @fax_20 varchar(4000) , @jobcall_21 INT , @subcompanyid1_22 INT , @managerstr_23 varchar(4000) , @accounttype_24 INT , @belongto_25 INT , @systemlanguage_26 INT , @email_27 varchar(4000)=NULL , @dsporder_28 INT =NULL, @mobileshowtype_29 INT =NULL , @flag INT OUTPUT , @msg varchar(4000) OUTPUT ) AS INSERT  INTO HrmResource ( id , workcode , lastname , sex , resourceimageid , departmentid , costcenterid , jobtitle , joblevel , jobactivitydesc , managerid , assistantid , status , locationid , workroom , telephone , mobile , mobilecall , fax , jobcall , seclevel , subcompanyid1 , managerstr , accounttype , belongto , systemlanguage , email , dsporder, mobileshowtype ) VALUES  ( @id_1 , @workcode_2 , @lastname_3 , @sex_5 , @resoureimageid_6 , @departmentid_7 , @costcenterid_8 , @jobtitle_9 , @joblevel_10 , @jobactivitydesc_11 , @managerid_12 , @assistantid_13 , @status_14 , @locationid_15 , @workroom_16 , @telephone_17 , @mobile_18 , @mobilecall_19 , @fax_20 , @jobcall_21 , 0 , @subcompanyid1_22 , @managerstr_23 , @accounttype_24 , @belongto_25 , @systemlanguage_26 , @email_27 , @dsporder_28, @mobileshowtype_29 )

GO
alter procedure [HrmResource_UpdateSubCom] (@id_1 int, @subcompanyid1_2 int, @flag int output, @msg varchar(4000) output) as update HrmResource set subcompanyid1 = @subcompanyid1_2 where id = @id_1

GO
alter procedure [HrmResource_UpdatePic] (@id_1 	[int], @resourceimageid_2     [int], @flag                             integer output, @msg                             varchar(4000) output ) AS update HrmResource set resourceimageid = 0 where id = @id_1 delete ImageFile where imagefileid = @resourceimageid_2  if @@error<>0 begin set @flag=1 set @msg='删除人力资源信息图片成功' return end else begin set @flag=0 set @msg='删除人力资源信息图片失败' return end

GO
alter procedure [HrmResource_UpdatePassword] (@id_1 	int, @passwordold_2     varchar(4000), @passwordnew_3     varchar(4000), @flag                             integer output, @msg                             varchar(4000) output ) AS declare @rowcountsum int  set @rowcountsum=0  update HrmResource set password = @passwordnew_3,passwdchgdate=convert(char(10),getdate(),120) where id=@id_1 and password = @passwordold_2  if @@ROWCOUNT<>0 set @rowcountsum=1  update HrmResourceManager set password = @passwordnew_3 where id=@id_1 and password = @passwordold_2  if @@ROWCOUNT<>0 set @rowcountsum=1  if @rowcountsum<>0 begin set @flag=1 set @msg='更改密码成功' select 1 return end else             begin set @flag=1 set @msg='更改密码失败' select 2 return end

GO
alter procedure [HrmResource_UpdateManagerStr] (@id_1 int, @managerstr_2 varchar(4000), @flag int output, @msg varchar(4000) output) AS UPDATE HrmResource SET managerstr = @managerstr_2 WHERE id = @id_1

GO
alter procedure [HrmResource_UpdateLoginDate] (@id_1 	[int], @lastlogindate char(10) , @flag                             integer output, @msg                             varchar(4000) output ) AS update HrmResource set lastlogindate = @lastlogindate where id = @id_1

GO
alter procedure [Meeting_Type_Update] ( @id int , @name varchar(4000), @approver int , @desc_n varchar(4000), @subcompanyid int, @catalogpath varchar(4000), @flag integer output, @msg varchar(4000) output  )  AS update Meeting_Type set name =@name, approver =@approver, desc_n =@desc_n, subcompanyid=@subcompanyid, catalogpath=@catalogpath where id=@id set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Type_SelectByID] ( @id [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Meeting_Type] where id=@id set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Type_SelectAll] ( @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Meeting_Type] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Type_Insert] (@name varchar(4000), @approver int, @desc_n varchar(4000), @subcompanyid int, @catalogpath varchar(4000), @flag integer output, @msg varchar(4000) output) AS INSERT INTO Meeting_Type ( name , approver , desc_n ,subcompanyid,catalogpath) VALUES( @name, @approver, @desc_n , @subcompanyid , @catalogpath ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_Type_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS delete [Meeting_Type] WHERE ( id = @id ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Meeting_TopicDoc_SelectAll] ( @meetingid [int], @topicid [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT t1.id,t1.docid,t1.hrmid,t2.docsubject,t2.ownerid FROM Meeting_TopicDoc as t1, DocDetail as t2 where t1.meetingid = @meetingid and t1.topicid = @topicid and t1.docid=t2.id set @flag = 1 set @msg = 'OK!'

GO
alter procedure [NewDocFrontpage_SRecentCount] ( @logintype		int, @usertype		int, @userid			int, @userseclevel	int, @flag integer output, @msg varchar(4000) output) as if @logintype=1 begin Select count(distinct c.id ) countnew from NewDocFrontpage n , DocShareDetail d , docdetail c where n.docid=d.docid and n.docid=c.id and n.userid=d.userid and  d.usertype=1 and n.userid=@userid and (c.docpublishtype='2' or c.docpublishtype='3') and c.docstatus in('1','2','5') end else begin Select count(distinct c.id ) countnew from NewDocFrontpage n , DocShareDetail d  , docdetail c where  n.docid=d.docid and n.docid= c.id and  n.usertype = d.usertype and n.usertype=@usertype and d.userid<=@userseclevel and ( c.docpublishtype='2' or c.docpublishtype='3') and c.docstatus in('1','2','5') end

GO
alter procedure [Prj_ProjectInfo_UpdateForMoney] ( @id_1   int, @budgetmoney_11     varchar(4000), @moneyindeed_12     varchar(4000), @budgetincome_13    varchar(4000), @imcomeindeed_14    varchar(4000), @flag   int output, @msg    varchar(4000) output ) AS UPDATE Prj_ProjectInfo  SET  budgetmoney   = convert(money,@budgetmoney_11), moneyindeed  = convert(money,@moneyindeed_12), budgetincome  = convert(money,@budgetincome_13), imcomeindeed     = convert(money,@imcomeindeed_14)  WHERE ( id    = @id_1)

GO
alter procedure [Prj_ProjectInfo_Update] ( @id_1   int, @name_2     varchar(4000), @description_3  varchar(4000), @prjtype_4  int, @worktype_5     int, @securelevel_6  int, @status_7   int, @isblock_8  tinyint, @managerview_9  tinyint, @parentview_10  tinyint, @budgetmoney_11     varchar(4000), @moneyindeed_12     varchar(4000), @budgetincome_13    varchar(4000), @imcomeindeed_14    varchar(4000), @planbegindate_15   varchar(4000), @planbegintime_16   varchar(4000), @planenddate_17     varchar(4000), @planendtime_18     varchar(4000), @truebegindate_19   varchar(4000), @truebegintime_20   varchar(4000), @trueenddate_21     varchar(4000), @trueendtime_22     varchar(4000), @planmanhour_23     int, @truemanhour_24     int, @picid_25   int, @intro_26   varchar(4000), @parentid_27    int, @envaluedoc_28  int, @confirmdoc_29  int, @proposedoc_30  int, @manager_31     int, @department_32  int, @subcompanyid1  int, @procode  varchar(4000), @protemplateid  int, @relationXml text, @datefield1_40  varchar(4000), @datefield2_41  varchar(4000), @datefield3_42  varchar(4000), @datefield4_43  varchar(4000), @datefield5_44  varchar(4000), @numberfield1_45    float, @numberfield2_46    float, @numberfield3_47    float, @numberfield4_48    float, @numberfield5_49    float, @textfield1_50  varchar(4000), @textfield2_51  varchar(4000), @textfield3_52  varchar(4000), @textfield4_53  varchar(4000), @textfield5_54  varchar(4000), @boolfield1_55  tinyint, @boolfield2_56  tinyint, @boolfield3_57  tinyint, @boolfield4_58  tinyint, @boolfield5_59  tinyint, @flag   int output, @msg    varchar(4000) output ) AS UPDATE Prj_ProjectInfo  SET  name    = @name_2, description  = @description_3, prjtype  = @prjtype_4, worktype  = @worktype_5, securelevel  = @securelevel_6, status   = @status_7, isblock    = @isblock_8, managerview   = @managerview_9, parentview   = @parentview_10, budgetmoney   = convert(money,@budgetmoney_11), moneyindeed  = convert(money,@moneyindeed_12), budgetincome  = convert(money,@budgetincome_13), imcomeindeed     = convert(money,@imcomeindeed_14), planbegindate    = @planbegindate_15, planbegintime    = @planbegintime_16, planenddate    = @planenddate_17, planendtime  = @planendtime_18, truebegindate    = @truebegindate_19, truebegintime    = @truebegintime_20, trueenddate    = @trueenddate_21, trueendtime  = @trueendtime_22, planmanhour  = @planmanhour_23, truemanhour  = @truemanhour_24, picid    = @picid_25, intro  = @intro_26, parentid     = @parentid_27, envaluedoc  = @envaluedoc_28, confirmdoc    = @confirmdoc_29, proposedoc   = @proposedoc_30, manager   = @manager_31, department   = @department_32, subcompanyid1 = @subcompanyid1,procode=@procode,protemplateid=@protemplateid,relationXml=@relationXml, datefield1   = @datefield1_40, datefield2   = @datefield2_41, datefield3    = @datefield3_42, datefield4   = @datefield4_43, datefield5    = @datefield5_44, numberfield1     = @numberfield1_45, numberfield2    = @numberfield2_46, numberfield3 = @numberfield3_47, numberfield4     = @numberfield4_48, numberfield5     = @numberfield5_49, textfield1  = @textfield1_50, textfield2   = @textfield2_51, textfield3    = @textfield3_52, textfield4   = @textfield4_53, textfield5    = @textfield5_54, tinyintfield1= @boolfield1_55, tinyintfield2     = @boolfield2_56, tinyintfield3    = @boolfield3_57, tinyintfield4     = @boolfield4_58, tinyintfield5    = @boolfield5_59  WHERE ( id    = @id_1)

GO
alter procedure [Prj_ProjectInfo_UConids] ( @prj_id int , @contractids_1 varchar(4000) , @flag	int	output, @msg	varchar(4000)	output) as update Prj_ProjectInfo set contractids = @contractids_1 WHERE id=@prj_id

GO
alter procedure [Prj_ProjectInfo_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_ProjectInfo] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProjectInfo_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_ProjectInfo] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProjectInfo_InsertID] (@flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT top 1 id from Prj_ProjectInfo ORDER BY id DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_RpSum] @optional	varchar(4000), @flag	int output, @msg varchar(4000) output AS if  @optional='projecttype' select prjtype AS resultid,COUNT(id) AS resultcount from Prj_Projectinfo  group by prjtype order by resultcount  if  @optional='worktype' select worktype AS resultid,COUNT(id) AS resultcount from Prj_Projectinfo  group by worktype order by resultcount  if  @optional='projectstatus' select status AS resultid,COUNT(id) AS resultcount from Prj_Projectinfo  group by status order by resultcount  if  @optional='manager' select manager AS resultid,COUNT(id) AS resultcount from Prj_Projectinfo  group by manager order by resultcount  if  @optional='department' select department AS resultid,COUNT(id) AS resultcount from Prj_Projectinfo  group by department order by resultcount

GO
alter procedure [Prj_ProjectType_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS  SELECT type.*,base.workflowname FROM Prj_ProjectType type LEFT JOIN Workflow_base base ON (type.wfid = base.id) WHERE ( type.id	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_ProjectType_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS  SELECT type.* ,base.workflowname FROM  [Prj_ProjectType] type LEFT JOIN Workflow_base base ON (type.wfid = base.id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Member_SelectSumByMember] (@id	 varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS select count(id) from prj_projectinfo where  ( ','+members+','  like '%,'+@id+',%' and isblock=1 ) or manager=@id

GO
alter procedure [workflow_Nodebase_SelectByID] @nodeid	int, @flag integer output , @msg varchar(4000) output AS select * from workflow_nodebase where id=@nodeid

GO
alter procedure [Workflow_MainField_Select] ( @userId INT, @requestId INT, @nodeId INT, @flag INTEGER OUTPUT, @msg varchar(4000) OUTPUT ) AS  DECLARE @isBill char(1)  SELECT @isBill = A.isBill FROM Workflow_Base A, Workflow_FlowNode B WHERE A.id = B.workflowId AND B.nodeId = @nodeId  IF '1' = @isbill SELECT DISTINCT A.* , B.dspOrder FROM Workflow_NodeForm A, Workflow_BillField B WHERE A.fieldId = B.id AND nodeId = @nodeId ORDER BY B.dspOrder ELSE SELECT workflowNodeForm.fieldId, max(workflowNodeForm.isView) isView, max(workflowNodeForm.isEdit) isEdit, max(workflowNodeForm.isMandatory) isMandatory FROM Workflow_NodeForm workflowNodeForm WHERE EXISTS ( SELECT 1 FROM Workflow_CurrentOperator workflowCurrentOperator WHERE workflowNodeForm.nodeId = workflowCurrentOperator.nodeId AND workflowCurrentOperator.requestId = @requestId AND workflowCurrentOperator.userId = @userId ) GROUP BY workflowNodeForm.fieldId ORDER BY workflowNodeForm.fieldId

GO
alter procedure [workflow_groupdetail_SByGroup] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT *, case when signorder in(3,4) then 10000+signorder else 1+orders  end as sort from workflow_groupdetail where groupid=@id order by sort,id set @flag = 1 set @msg = 'OK!'

GO
alter procedure [workflow_groupdetail_Insert] (@groupid_1 	int, @type_2 	int, @objid_3 	int, @level_4 	int, @level2_5 	int,@conditions text,@conditioncn text,@orders varchar(4000) ,@signorder char(1),@IsCoadjutant char(1),@signtype char(1),@issyscoadjutant char(1),@issubmitdesc char(1),@ispending char(1),@isforward char(1),@ismodify char(1),@coadjutants varchar(4000),@coadjutantcn varchar(4000),  @flag integer output , @msg varchar(4000) output ) AS INSERT INTO workflow_groupdetail ( groupid, type, objid, level_n, level2_n,conditions,conditioncn,orders,signorder,IsCoadjutant,signtype,issyscoadjutant,issubmitdesc,ispending,isforward,ismodify,coadjutants,coadjutantcn)  VALUES ( @groupid_1, @type_2, @objid_3, @level_4, @level2_5,@conditions,@conditioncn,@orders,@signorder,@IsCoadjutant,@signtype,@issyscoadjutant,@issubmitdesc,@ispending,@isforward,@ismodify,@coadjutants,@coadjutantcn) select max(id) from workflow_groupdetail set @flag = 0 set @msg = 'ok'

GO
alter procedure [workflow_groupdetail_Delete] (@id_1 	[int], @flag integer output , @msg varchar(4000) output )  AS DELETE [workflow_groupdetail]  WHERE ( [id]	 = @id_1) set @flag = 0 set @msg = '查询存储过程成功'

GO
alter procedure [workflow_groupdetail_DbyGroup] (@id_1 	[int], @flag integer output , @msg varchar(4000) output )  AS DELETE [workflow_groupdetail]  WHERE ( [groupid]	 = @id_1) set @flag = 0 set @msg = '查询存储过程成功'

GO
alter procedure [workflow_CurOpe_UpdatebySubmit] @userid	int, @requestid	int, @groupid	int, @nodeid	int, @isremark char(1), @currentdate char(10), @currenttime char(8), @flag 		integer 	output , @msg 		varchar(4000) 	output AS DECLARE @nodeAttribute char(1)  update workflow_currentoperator set operatedate=@currentdate,operatetime=@currenttime,viewtype=-2 where requestid =@requestid and userid=@userid and isremark=@isremark and groupid =@groupid and nodeid=@nodeid  update workflow_currentoperator set isremark = '2' where requestid =@requestid and isremark=@isremark and groupid =@groupid and nodeid=@nodeid  select @nodeAttribute=nodeAttribute from workflow_nodebase where id =@nodeid if @nodeAttribute is null set @nodeAttribute=0 if @nodeAttribute=2 begin update workflow_currentoperator set isremark = '2' where requestid =@requestid and (isremark='5' or isremark='8' or isremark='9') and  userid=@userid and nodeid=@nodeid end else begin update workflow_currentoperator set isremark = '2' where requestid =@requestid and (isremark='5' or isremark='8' or isremark='9') and  userid=@userid end

GO
alter procedure [workflow_CurOpe_UpdatebyReject] @requestid	int, @nodeid	int, @flag 		integer 	output , @msg 		varchar(4000) 	output AS declare @currentdate char(10), @currenttime char(8)  set @currentdate=convert(char(10),getdate(),20) set @currenttime=convert(char(8),getdate(),108)  update workflow_currentoperator set isremark = '2',operatedate=@currentdate,operatetime=@currenttime where requestid =@requestid and isremark='0' and nodeid=@nodeid

GO
alter procedure [workflow_CurOpe_UpdatebyPassNB] @requestid	int, @flag 		integer 	output , @msg 		varchar(4000) 	output AS  declare @currentdate char(10), @currenttime char(8) set @currentdate=convert(char(10),getdate(),20) set @currenttime=convert(char(8),getdate(),108)  update workflow_currentoperator set isremark = '2',operatedate=@currentdate,operatetime=@currenttime, needwfback='0' where requestid =@requestid and isremark=0

GO
alter procedure [workflow_CurOpe_UpdatebyPass] @requestid	int, @flag 		integer 	output , @msg 		varchar(4000) 	output AS  declare @currentdate char(10), @currenttime char(8) set @currentdate=convert(char(10),getdate(),20) set @currenttime=convert(char(8),getdate(),108)  update workflow_currentoperator set isremark = '2',operatedate=@currentdate,operatetime=@currenttime where requestid =@requestid and isremark=0

GO
alter procedure [workflow_CurOpe_UbySubmitNB] @userid	int, @requestid	int, @groupid	int, @nodeid	int, @isremark char(1), @currentdate char(10), @currenttime char(8), @flag 		integer 	output , @msg 		varchar(4000) 	output AS declare @nodeAttribute char(1)  update workflow_currentoperator set operatedate=@currentdate,operatetime=@currenttime,viewtype=-2, needwfback='0' where requestid =@requestid and userid=@userid and isremark=@isremark and groupid =@groupid and nodeid=@nodeid  update workflow_currentoperator set isremark = '2', needwfback='0' where requestid =@requestid and isremark=@isremark and groupid =@groupid and nodeid=@nodeid  select @nodeAttribute=nodeAttribute from workflow_nodebase where id =@nodeid if @nodeAttribute is null set @nodeAttribute=0 if @nodeAttribute=2 begin update workflow_currentoperator set isremark = '2', needwfback='0' where requestid =@requestid and (isremark='5' or isremark='8' or isremark='9') and  userid=@userid and nodeid=@nodeid end else begin update workflow_currentoperator set isremark = '2', needwfback='0' where requestid =@requestid and (isremark='5' or isremark='8' or isremark='9') and  userid=@userid end

GO
alter procedure [workflow_CurOpe_UbySendNB] @requestid	integer, @userid		integer, @usertype	integer, @isremark char(1), @flag 		integer 	output , @msg 		varchar(4000) 	output AS declare @currentdate char(10), @currenttime char(8) set @currentdate=convert(char(10),getdate(),20) set @currenttime=convert(char(8),getdate(),108) update workflow_currentoperator set isremark=2,operatedate=@currentdate,operatetime=@currenttime,needwfback='0' where requestid =@requestid and userid =@userid and usertype=@usertype and isremark=@isremark

GO
alter procedure [workflow_CurOpe_UbySend] @requestid	integer, @userid		integer, @usertype	integer, @isremark char(1), @flag 		integer 	output , @msg 		varchar(4000) 	output AS declare @currentdate char(10), @currenttime char(8) set @currentdate=convert(char(10),getdate(),20) set @currenttime=convert(char(8),getdate(),108) update workflow_currentoperator set isremark=2,operatedate=@currentdate,operatetime=@currenttime where requestid =@requestid and userid =@userid and usertype=@usertype and isremark=@isremark

GO
alter procedure [workflow_CurOpe_UbyForwardNB] @requestid	int, @userid		int, @usertype	int, @flag 		integer 	output , @msg 		varchar(4000) 	output AS declare @currentdate char(10), @currenttime char(8)  set @currentdate=convert(char(10),getdate(),20) set @currenttime=convert(char(8),getdate(),108)  update workflow_currentoperator set isremark=2,operatedate=@currentdate,operatetime=@currenttime, needwfback='0' where requestid =@requestid and userid =@userid and usertype=@usertype and (isremark=1 or isremark=8 or isremark=9)

GO
alter procedure [workflow_CurOpe_UbyForward] @requestid	int, @userid		int, @usertype	int, @flag 		integer 	output , @msg 		varchar(4000) 	output AS declare @currentdate char(10), @currenttime char(8)  set @currentdate=convert(char(10),getdate(),20) set @currenttime=convert(char(8),getdate(),108)  update workflow_currentoperator set isremark=2,operatedate=@currentdate,operatetime=@currenttime where requestid =@requestid and userid =@userid and usertype=@usertype and (isremark=1 or isremark=8 or isremark=9)

GO
alter procedure [WF_Prj_ShareInfo_Add] (@prjid_1		int, @sharelevel_1		int, @userid_1		int, @usertype_1		int, @flag                             integer output, @msg                             varchar(4000) output ) as declare @count_1 int declare @count_2 int select @count_1=count(*)  from Prj_ProjectInfo where (manager=@userid_1 or creater=@userid_1) and id=@prjid_1 if @count_1=0 begin select @count_2=count(*)  from Prj_ShareInfo where relateditemid=@prjid_1 and sharelevel=@sharelevel_1 and userid= @userid_1 if @count_2=0 begin if @usertype_1=0 begin insert Prj_ShareInfo(relateditemid,sharetype,sharelevel,userid) values(@prjid_1,'1',@sharelevel_1,@userid_1) end if @usertype_1=1 begin insert Prj_ShareInfo(relateditemid,sharetype,sharelevel,crmid) values(@prjid_1,'9',@sharelevel_1,@userid_1) end end end

GO
alter procedure [WF_DocShare_AddSharesource] (@docid_1	int, @sharelevel_1	int, @userid_1	int, @usertype_1	int,@sharesource int, @flag  int output, @msg   varchar(4000) output ) as declare @count_1 int declare @count_2 int select @count_1=count(*)  from docdetail where usertype=@usertype_1 and (ownerid=@userid_1 or doccreaterid=@userid_1) if @count_1=0 begin select @count_2=count(*)  from DocShare where docid=@docid_1 and sharelevel=@sharelevel_1 and userid= @userid_1 if @count_2=0 begin if @usertype_1=0 begin insert into DocShare(docid,sharetype,sharelevel,userid,sharesource) values(@docid_1,'1',@sharelevel_1,@userid_1,@sharesource) end if @usertype_1=1 begin insert into DocShare(docid,sharetype,sharelevel,crmid) values(@docid_1,'9',@sharelevel_1,@userid_1) end end end

GO
alter procedure [WF_DocShare_Add] (@docid_1		int, @sharelevel_1		int, @userid_1		int, @usertype_1		int, @flag                             integer output, @msg                             varchar(4000) output ) as declare @count_1 int declare @count_2 int select @count_1=count(*)  from docdetail where usertype=@usertype_1 and (ownerid=@userid_1 or doccreaterid=@userid_1) if @count_1=0 begin select @count_2=count(*)  from DocShare where docid=@docid_1 and sharelevel=@sharelevel_1 and userid= @userid_1 if @count_2=0 begin if @usertype_1=0 begin insert DocShare(docid,sharetype,sharelevel,userid) values(@docid_1,'1',@sharelevel_1,@userid_1) end if @usertype_1=1 begin insert DocShare(docid,sharetype,sharelevel,crmid) values(@docid_1,'9',@sharelevel_1,@userid_1) end end end

GO
alter procedure [VotingViewerDetail_Update] (@votingid    int, @flag integer output, @msg varchar(4000) output) AS declare @shareid int, @sharetype   int, @resourceid  int, @subcompanyid    int, @departmentid    int, @roleid      int, @seclevel    int, @rolelevel   int, @foralluser  int, @all_cursor cursor, @detail_cursor cursor, @userid int, @count  int delete from votingviewerdetail where votingid=@votingid  SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id,sharetype,resourceid,subcompanyid,departmentid,roleid,seclevel,rolelevel,foralluser from votingviewer where votingid=@votingid OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @shareid ,	@sharetype ,@resourceid ,@subcompanyid,@departmentid,@roleid,@seclevel,@rolelevel,@foralluser WHILE @@FETCH_STATUS = 0 begin if @sharetype=1 begin SET @detail_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from HrmResource where id = @resourceid and (seclevel >= @seclevel or (seclevel is null and @seclevel=0)) OPEN @detail_cursor FETCH NEXT FROM @detail_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin select @count=count(*) from votingviewerdetail where votingid=@votingid and resourceid=@userid if  @count=0 insert into votingviewerdetail values(@votingid,@userid) FETCH NEXT FROM @detail_cursor INTO @userid end CLOSE @detail_cursor DEALLOCATE @detail_cursor end  if @sharetype=2 begin SET @detail_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from HrmResource where subcompanyid1 = @subcompanyid and (seclevel >= @seclevel or (seclevel is null and @seclevel=0)) OPEN @detail_cursor FETCH NEXT FROM @detail_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin select @count=count(*) from votingviewerdetail where votingid=@votingid and resourceid=@userid if  @count=0 insert into votingviewerdetail values(@votingid,@userid) FETCH NEXT FROM @detail_cursor INTO @userid end CLOSE @detail_cursor DEALLOCATE @detail_cursor end  if @sharetype=3 begin SET @detail_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from HrmResource where departmentid = @departmentid and (seclevel >= @seclevel or (seclevel is null and @seclevel=0)) OPEN @detail_cursor FETCH NEXT FROM @detail_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin select @count=count(*) from votingviewerdetail where votingid=@votingid and resourceid=@userid if  @count=0 insert into votingviewerdetail values(@votingid,@userid) FETCH NEXT FROM @detail_cursor INTO @userid end CLOSE @detail_cursor DEALLOCATE @detail_cursor end  if @sharetype=4 begin SET @detail_cursor = CURSOR FORWARD_ONLY STATIC FOR select resourceid from HrmRoleMembers where roleid = @roleid and rolelevel >= @rolelevel OPEN @detail_cursor FETCH NEXT FROM @detail_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin select @count=count(*) from votingviewerdetail where votingid=@votingid and resourceid=@userid if  @count=0 insert into votingviewerdetail values(@votingid,@userid) FETCH NEXT FROM @detail_cursor INTO @userid end CLOSE @detail_cursor DEALLOCATE @detail_cursor end  if @sharetype=5 begin SET @detail_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from HrmResource where (seclevel >= @seclevel or (seclevel is null and @seclevel=0)) OPEN @detail_cursor FETCH NEXT FROM @detail_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin select @count=count(*) from votingviewerdetail where votingid=@votingid and resourceid=@userid if  @count=0 insert into votingviewerdetail values(@votingid,@userid) FETCH NEXT FROM @detail_cursor INTO @userid end CLOSE @detail_cursor DEALLOCATE @detail_cursor end FETCH NEXT FROM @all_cursor INTO @shareid ,	@sharetype ,@resourceid ,@subcompanyid,@departmentid,@roleid,@seclevel,@rolelevel,@foralluser end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [VotingShareDetail_Update] (@votingid    int, @flag integer output, @msg varchar(4000) output) AS declare @shareid int, @sharetype   int, @resourceid  int, @subcompanyid    int, @departmentid    int, @roleid      int, @seclevel    int, @rolelevel   int, @foralluser  int, @all_cursor cursor, @detail_cursor cursor, @userid int, @count  int delete from votingsharedetail where votingid=@votingid  SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id,sharetype,resourceid,subcompanyid,departmentid,roleid,seclevel,rolelevel,foralluser from votingshare where votingid=@votingid OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @shareid ,	@sharetype ,@resourceid ,@subcompanyid,@departmentid,@roleid,@seclevel,@rolelevel,@foralluser WHILE @@FETCH_STATUS = 0 begin if @sharetype=1 begin SET @detail_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from HrmResource where id = @resourceid and (seclevel >= @seclevel or (seclevel is null and @seclevel=0)) OPEN @detail_cursor FETCH NEXT FROM @detail_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin select @count=count(*) from votingsharedetail where votingid=@votingid and resourceid=@userid if  @count=0 insert into votingsharedetail values(@votingid,@userid) FETCH NEXT FROM @detail_cursor INTO @userid end CLOSE @detail_cursor DEALLOCATE @detail_cursor end  if @sharetype=2 begin SET @detail_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from HrmResource where subcompanyid1 = @subcompanyid and (seclevel >= @seclevel or (seclevel is null and @seclevel=0)) OPEN @detail_cursor FETCH NEXT FROM @detail_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin select @count=count(*) from votingsharedetail where votingid=@votingid and resourceid=@userid if  @count=0 insert into votingsharedetail values(@votingid,@userid) FETCH NEXT FROM @detail_cursor INTO @userid end CLOSE @detail_cursor DEALLOCATE @detail_cursor end  if @sharetype=3 begin SET @detail_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from HrmResource where departmentid = @departmentid and (seclevel >= @seclevel or (seclevel is null and @seclevel=0)) OPEN @detail_cursor FETCH NEXT FROM @detail_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin select @count=count(*) from votingsharedetail where votingid=@votingid and resourceid=@userid if  @count=0 insert into votingsharedetail values(@votingid,@userid) FETCH NEXT FROM @detail_cursor INTO @userid end CLOSE @detail_cursor DEALLOCATE @detail_cursor end  if @sharetype=4 begin SET @detail_cursor = CURSOR FORWARD_ONLY STATIC FOR select resourceid from HrmRoleMembers where roleid = @roleid and rolelevel >= @rolelevel and resourceid<>1 OPEN @detail_cursor FETCH NEXT FROM @detail_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin select @count=count(*) from votingsharedetail where votingid=@votingid and resourceid=@userid if  @count=0 insert into votingsharedetail values(@votingid,@userid) FETCH NEXT FROM @detail_cursor INTO @userid end CLOSE @detail_cursor DEALLOCATE @detail_cursor end  if @sharetype=5 begin SET @detail_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from HrmResource where (seclevel >= @seclevel or (seclevel is null and @seclevel=0)) OPEN @detail_cursor FETCH NEXT FROM @detail_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin select @count=count(*) from votingsharedetail where votingid=@votingid and resourceid=@userid if  @count=0 insert into votingsharedetail values(@votingid,@userid) FETCH NEXT FROM @detail_cursor INTO @userid end CLOSE @detail_cursor DEALLOCATE @detail_cursor end FETCH NEXT FROM @all_cursor INTO @shareid ,	@sharetype ,@resourceid ,@subcompanyid,@departmentid,@roleid,@seclevel,@rolelevel,@foralluser end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [reset_CoworkRemind]( @flag integer output , @msg varchar(4000) output) as Declare @id int, @count int, @all_cursor cursor  SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from HrmResource OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @id WHILE @@FETCH_STATUS = 0 BEGIN select @count=count(id) from cowork_items where ((coworkers like '%,'+CAST(@id AS varchar(4000))+',%') or creater=CAST(@id AS varchar(4000))) and (isnew not like '%,'+CAST(@id AS varchar(4000))+',%') and status=1 update SysPoppupRemindInfo set remindcount=@count,count=@count where userid=@id and type=9 FETCH NEXT FROM @all_cursor INTO @id END CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [Proj_Members_update] @ProjId_1 int, @members_1  varchar(4000), @flag		int	output, @msg		varchar(4000) output as update Prj_ProjectInfo set members = @members_1 WHERE id= @ProjId_1

GO
alter procedure [cowork_items_update] (@id_1 	[int], @name_2 	varchar(4000), @typeid_3 	[int], @levelvalue_4 	[int], @principal_5 	[int], @mutil_prjs_6 	varchar(4000), @begindate_7 	[char](10), @beingtime_8 	[char](5), @enddate_9 	[char](10), @endtime_10 	[char](5), @relatedprj_11 varchar(4000), @relatedcus_12 varchar(4000), @relatedwf_13 	varchar(4000), @relateddoc_14 varchar(4000), @remark_15 	[text], @accessory_16 	varchar(4000), @flag integer output , @msg varchar(4000) output) AS UPDATE [cowork_items] SET  [name]	 = @name_2, [typeid]	 = @typeid_3, [levelvalue]	 = @levelvalue_4, [principal]	 = @principal_5, [mutil_prjs]	 = @mutil_prjs_6, [begindate]	 = @begindate_7, [beingtime]	 = @beingtime_8, [enddate]	 = @enddate_9, [endtime]	 = @endtime_10, [relatedprj]	 = @relatedprj_11, [relatedcus]	 = @relatedcus_12, [relatedwf]	 = @relatedwf_13, [relateddoc]	 = @relateddoc_14, [remark]	 = @remark_15, [accessory]	 = @accessory_16 WHERE ( [id]	 = @id_1)

GO
alter procedure [cowork_items_insert] (@name_1 	varchar(4000), @typeid_2 	[int], @levelvalue_3 	[int], @creater_4 	[int], @principal_5 	[int], @createdate_6 	[char](10), @createtime_7 	[char](8), @begindate_8 	[char](10), @beingtime_9 	[char](5), @enddate_10 	[char](10), @endtime_11 	[char](5), @relatedprj_12 varchar(4000), @relatedcus_13 varchar(4000), @relatedwf_14 	varchar(4000), @relateddoc_15 varchar(4000), @remark_16 	[text], @status_17 	[int], @accessory_18 	varchar(4000), @mutil_prjs_19 	varchar(4000), @lastdiscussant_20 [int], @flag integer output , @msg varchar(4000) output) AS INSERT INTO [cowork_items] ( [name], [typeid], [levelvalue], [creater], [principal], [createdate], [createtime], [begindate], [beingtime], [enddate], [endtime], [relatedprj], [relatedcus], [relatedwf], [relateddoc], [remark], [status], [accessory], [mutil_prjs], [lastdiscussant]) VALUES ( @name_1, @typeid_2, @levelvalue_3, @creater_4, @principal_5, @createdate_6, @createtime_7, @begindate_8, @beingtime_9, @enddate_10, @endtime_11, @relatedprj_12, @relatedcus_13, @relatedwf_14, @relateddoc_15, @remark_16, @status_17, @accessory_18, @mutil_prjs_19, @lastdiscussant_20) select max(id) from cowork_items

GO
alter procedure [HrmDepartment_Update] (@id_1 [int], @departmentmark_2 varchar(4000), @departmentname_3 varchar(4000), @supdepid_4 int, @allsupdepid_5 varchar(4000), @subcompanyid1_6 	[int], @showorder_7 int,@coadjutant_8 int, @flag integer output, @msg varchar(4000) output  )  AS declare @count int declare @count1 int select @count=count(*)  from HrmDepartment where subcompanyid1=@subcompanyid1_6 and departmentmark=@departmentmark_2 and id!=@id_1 and supdepid=@supdepid_4 select @count1=count(*)  from HrmDepartment where subcompanyid1=@subcompanyid1_6 and departmentname=@departmentname_3 and id!=@id_1 and supdepid=@supdepid_4 if @count>0 begin set @flag=2 set @msg='该部门简称已经存在，不能保存！' return end if @count1>0 begin set @flag=3 set @msg='该部门全称已经存在，不能保存！' return end UPDATE [HrmDepartment]  SET  [departmentmark] = @departmentmark_2, [departmentname]	= @departmentname_3, supdepid = @supdepid_4,allsupdepid = @allsupdepid_5, [subcompanyid1] = @subcompanyid1_6,  showorder = @showorder_7,coadjutant=@coadjutant_8 WHERE ( [id]	 = @id_1) IF @@error<>0 begin set @flag=1 set @msg='更新储存过程失败' return END ELSE begin set @flag=1 set @msg='更新储存过程失败' return END

GO
alter procedure [HrmDepartment_SelectByID] @id varchar(4000) , @flag integer output , @msg varchar(4000) output AS select * from HrmDepartment where id =convert(int, @id) set  @flag = 0 set  @msg = '查询存储过程成功'

GO
alter procedure [HrmDepartment_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmDepartment order by subcompanyid1,supdepid ,showorder,departmentname; set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmDepartment_Insert] (@departmentmark_1 varchar(4000), @departmentname_2 	varchar(4000), @supdepid_3 int, @allsupdepid_4 varchar(4000), @subcompanyid1_5 [int], @showorder_6 int,@coadjutant_7 int, @flag integer output , @msg varchar(4000) output ) AS declare @count int declare @count1 int select @count=count(*)  from HrmDepartment where subcompanyid1=@subcompanyid1_5 and departmentmark=@departmentmark_1 and supdepid=@supdepid_3 select @count1=count(*)  from HrmDepartment where subcompanyid1=@subcompanyid1_5 and departmentname=@departmentname_2 and supdepid=@supdepid_3 if @count>0 begin set @flag=2 set @msg='该部门简称已经存在，不能保存！' return end if @count1>0 begin set @flag=3 set @msg='该部门全称已经存在，不能保存！' return end INSERT INTO [HrmDepartment] ( [departmentmark], [departmentname], supdepid, allsupdepid, [subcompanyid1], showorder,coadjutant) VALUES ( @departmentmark_1, @departmentname_2, @supdepid_3, @allsupdepid_4, @subcompanyid1_5, @showorder_6,@coadjutant_7) select (max(id)) from [HrmDepartment] if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmDepartment_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [HrmDepartment]  WHERE ( [id]	 = @id_1) select @@ROWCOUNT if @@error<>0 begin set @flag=1 set @msg='删除储存过程失败' return end else begin set @flag=0 set @msg='删除储存过程成功' return end

GO
alter procedure [HrmJobTitles_Update] (@id_1 [int], @jobtitlemark_2 	varchar(4000), @jobtitlename_3 	varchar(4000), @jobdepartmentid_4 	int, @jobactivityid_5 int, @jobresponsibility_6	varchar(4000), @jobcompetency_7 varchar(4000), @jobtitleremark_8 [text], @flag integer output, @msg varchar(4000) output ) AS  UPDATE [HrmJobTitles]  SET  [jobtitlemark] = @jobtitlemark_2, [jobtitlename] = @jobtitlename_3, jobdepartmentid = @jobdepartmentid_4, jobactivityid	 = @jobactivityid_5, jobresponsibility = @jobresponsibility_6, jobcompetency = @jobcompetency_7, [jobtitleremark]	 = @jobtitleremark_8 WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmJobTitles_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmJobTitles set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [HrmJobTitles_Insert] (@jobtitlemark_1 varchar(4000), @jobtitlename_2 varchar(4000), @jobdepartmentid_3 int, @jobactivityid_4 int, @jobresponsibility_5 	varchar(4000), @jobcompetency_6 	varchar(4000), @jobtitleremark_7 [text],  @flag integer output, @msg varchar(4000) output ) AS INSERT INTO [HrmJobTitles] ( [jobtitlemark], [jobtitlename], [jobdepartmentid], [jobactivityid], [jobresponsibility], [jobcompetency], [jobtitleremark]) VALUES ( @jobtitlemark_1, @jobtitlename_2, @jobdepartmentid_3, @jobactivityid_4, @jobresponsibility_5, @jobcompetency_6, @jobtitleremark_7) select max(id) from  [HrmJobTitles] if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmJobTitles_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output )  AS DELETE [HrmJobTitles]  WHERE ( [id]	 = @id_1) if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [HrmResource_UpdateByDep] (@id_1 int, @subcompanyid1_2 int, @flag int output, @msg varchar(4000) output) as update HrmResource set subcompanyid1 = @subcompanyid1_2 where departmentid = @id_1

GO
alter procedure [HrmResource_up_AllManagerstr] as declare @id INT declare @managerid  INT declare @tempmanagerid  INT declare @managerCount  INT DECLARE @managetstr varchar(4000) SET @managetstr='' SET @tempmanagerid=0 SET @managerCount=1 declare cursor0 cursor for SELECT id,managerid FROM HrmResource ORDER BY id open cursor0 fetch next from cursor0  into @id,@managerid while(@@fetch_status=0) BEGIN  WHILE(@managerid<>0 AND @managerid <>'' AND ((@id=@managerid and @managerCount<=1) OR (@id!=@managerid and (@managerCount<=2 AND charindex(','+CAST(@managerid AS varchar(4000))+',',@managetstr+',')=0))) ) BEGIN  SET @tempmanagerid=@managerid  SELECT @managetstr=@managetstr+','+CAST(id AS varchar(4000)),@managerid=managerid FROM HrmResource WHERE id=@managerid  IF @tempmanagerid=@managerid SET @managerCount=@managerCount+1 END  IF @managetstr<>'' SET @managetstr=@managetstr+','  UPDATE HrmResource SET managerstr=@managetstr WHERE id=@id  SET @managetstr='' SET @tempmanagerid=0 SET @managerCount=1  fetch next from cursor0  into @id,@managerid end close cursor0 deallocate cursor0

GO
alter procedure [HrmResource_ModInfo] (@id_1 int, @lastmodid_2 int, @lastmoddate_3 char(10), @flag int output, @msg varchar(4000) output) as update HrmResource set lastmodid = @lastmodid_2, lastmoddate = @lastmoddate_3 where id = @id_1

GO
alter procedure [HrmResource_Delete] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output)  AS DELETE [HrmResource]  WHERE ( [id]	 = @id_1)  if @@error<>0 begin set @flag=1 set @msg='删除人力资源信息失败' return end else begin set @flag=0 set @msg='删除人力资源信息成功' return end

GO
alter procedure [HrmResource_CreateInfo] (@id_1 int, @createrid_2 int, @createdate_3 char(10), @lastmodid_4 int, @lastmoddate_5 char(10), @flag int output, @msg varchar(4000) output) as update HrmResource set createrid = @createrid_2, createdate = @createdate_3, lastmodid = @lastmodid_4, lastmoddate = @lastmoddate_5 where id = @id_1

GO
alter procedure [HrmResource_SSubordinatesID] (@id_1 	[int], @flag       integer output, @msg     varchar(4000) output ) AS select id from HrmResource where managerid = @id_1 if @@error<>0 begin set @flag=1 set @msg='查询人力资源下属信息成功' return end else begin set @flag=0 set @msg='查询人力资源下属信息失败' return end

GO
alter procedure [HrmResource_SelectTheSub] (@resourceid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS select id from hrmresource where managerid = @resourceid_1

GO
alter procedure [HrmResource_SelectByManagerID] (@id_1 [int], @flag integer output, @msg varchar(4000) output ) AS select * from HrmResource where managerid = @id_1 and (status =0 or status = 1 or status =2 or status =3) order by dsporder if @@error<>0 begin set @flag=1 set @msg='查询人力资源信息成功' return end else begin set @flag=0 set @msg='查询人力资源信息失败' return end

GO
alter procedure [HrmResource_SelectByLoginID] (@id_1 	varchar(4000), @flag                             integer output, @msg                             varchar(4000) output ) AS select * from HrmResource where loginid = @id_1 if @@error<>0 begin set @flag=1 set @msg='查询人力资源信息成功' return end else begin set @flag=0 set @msg='查询人力资源信息失败' return end

GO
alter procedure [HrmResource_SelectByID] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from HrmResource where id = @id_1 if @@error<>0 begin set @flag=1 set @msg='查询人力资源信息成功' return end else begin set @flag=0 set @msg='查询人力资源信息失败' return end

GO
alter procedure [HrmResource_SelectAll] (@flag integer output, @msg   varchar(4000) output ) AS select id, loginid, lastname, sex, resourcetype, email, locationid, workroom, departmentid, subcompanyid1, costcenterid, jobtitle, managerid, assistantid , seclevel, joblevel, managerstr, status, account, mobile, password, systemLanguage, telephone from HrmResource if @@error<>0 begin set @flag=1 set @msg='查询人力资源信息成功' return end else begin set @flag=0 set @msg='查询人力资源信息失败' return end

GO
alter procedure [HrmResource_SCountBySubordinat] (@id_1 [int], @flag integer output, @msg  varchar(4000) output ) AS select count(*) from HrmResource where managerid = @id_1 and (status =0 or status = 1 or status =2 or status =3) if @@error<>0 begin set @flag=1 set @msg='查询人力资源下属总数信息成功' return end else begin set @flag=0 set @msg='查询人力资源下属总数信息失败' return end

GO
alter procedure [HrmResource_SByLoginIDPass] ( @loginid   varchar(4000), @password  varchar(4000), @flag	int	output, @msg	varchar(4000)	output ) AS declare @count int begin select @count = count(id) from HrmResource where loginid= @loginid if @count <> 0 begin select @count = count(id) from HrmResource where loginid= @loginid and password = @password if @count <> 0 select * from HrmResource where loginid= @loginid else select 0 end else begin select @count = count(id) from HrmResourceManager where loginid= @loginid if @count <> 0 begin select @count = count(id) from HrmResourceManager where loginid = @loginid and password = @password if @count <> 0 select * from HrmResourceManager where loginid= @loginid else select 0 end end end

GO
alter procedure [HrmResource_Retire] ( @id_1 int, @changedate_2 char(10), @changereason_3 text, @changecontractid_4 int, @infoman_5 varchar(4000), @oldjobtitleid_7 int, @type_n_8 char(1), @operator_9 int, @flag int output, @msg varchar(4000) output ) AS INSERT INTO HrmStatusHistory ( resourceid, changedate, changereason, changecontractid, infoman, oldjobtitleid, type_n, operator ) VALUES ( @id_1, @changedate_2, @changereason_3, @changecontractid_4, @infoman_5, @oldjobtitleid_7, @type_n_8, @operator_9 ) UPDATE HrmResource SET enddate = @changedate_2 WHERE id = @id_1

GO
alter procedure [HrmResource_Rehire] ( @id_1 int, @changedate_2 char(10), @changeenddate_3 char(10), @changereason_4 text, @changecontractid_5 int, @infoman_6 varchar(4000), @oldjobtitleid_7 int, @type_n_8 char(1), @operator_9 int, @flag int output, @msg varchar(4000) output ) AS INSERT INTO HrmStatusHistory ( resourceid, changedate, changeenddate, changereason, changecontractid, infoman, oldjobtitleid, type_n, operator ) VALUES ( @id_1, @changedate_2, @changeenddate_3, @changereason_4, @changecontractid_5, @infoman_6, @oldjobtitleid_7 , @type_n_8 , @operator_9 ) UPDATE HrmResource SET startdate = @changedate_2, enddate = @changeenddate_3 WHERE id = @id_1

GO
alter procedure [HrmResource_Fire] ( @id_1 int, @changedate_2 char(10), @changereason_3 text, @changecontractid_4 int, @infoman_5 varchar(4000), @oldjobtitleid_7 int, @type_n_8 char(1), @operator_9 int, @flag int output, @msg varchar(4000) output ) AS INSERT INTO HrmStatusHistory ( resourceid, changedate, changereason, changecontractid, infoman, oldjobtitleid, type_n, operator ) VALUES ( @id_1, @changedate_2, @changereason_3, @changecontractid_4, @infoman_5, @oldjobtitleid_7 , @type_n_8, @operator_9 ) UPDATE HrmResource SET enddate = @changedate_2 WHERE id = @id_1

GO
alter procedure [HrmResource_Extend] ( @id_1 int, @changedate_2 char(10), @changeenddate_3 char(10), @changereason_4 text, @changecontractid_5 int, @infoman_6 varchar(4000), @oldjobtitleid_7 int, @type_n_8 char(1), @status_9 int, @operator_10 int, @flag int output, @msg varchar(4000) output ) AS INSERT INTO HrmStatusHistory ( resourceid, changedate, changeenddate, changereason, changecontractid, infoman, oldjobtitleid, type_n, status, operator ) VALUES ( @id_1, @changedate_2, @changeenddate_3, @changereason_4, @changecontractid_5, @infoman_6, @oldjobtitleid_7 , @type_n_8, @status_9, @operator_10 ) UPDATE HrmResource SET enddate = @changeenddate_3 WHERE id = @id_1

GO
alter procedure [HrmResource_Dismiss] ( @id_1 int, @changedate_2 char(10), @changereason_3 text, @changecontractid_4 int, @infoman_5 varchar(4000), @oldjobtitleid_7 int, @type_n_8 char(1), @operator_9 int, @flag int output, @msg varchar(4000) output ) AS INSERT INTO HrmStatusHistory ( resourceid, changedate, changereason, changecontractid, infoman, oldjobtitleid, type_n, operator ) VALUES ( @id_1, @changedate_2, @changereason_3, @changecontractid_4, @infoman_5, @oldjobtitleid_7, @type_n_8, @operator_9 ) UPDATE HrmResource SET enddate = @changedate_2 WHERE id = @id_1

GO
alter procedure [hrmroles_update] @id int, @rolesmark varchar(4000), @rolesname varchar(4000), @docid int, @type int, @subcompanyid int, @flag int output, @msg varchar(4000) output as if @docid = 0 set @docid = null begin update hrmroles set rolesmark=@rolesmark,rolesname=@rolesname,docid=@docid,type=@type, subcompanyid=@subcompanyid where id=@id  if @@error<>0 begin set @flag=1 set @msg='更新失败' end else begin set @flag=0 set @msg='更新成功' end  end

GO
alter procedure [hrmroles_selectSingle] @id int, @flag int output, @msg varchar(4000) output as begin select rolesmark,rolesname,docid,type,subcompanyid from hrmroles where id=@id  if @@error<>0 begin set @flag=1 set @msg='操作失败' end else begin set @flag=0 set @msg='操作成功' end  end

GO
alter procedure [hrmroles_selectallbyname] (@rolesnameq varchar(4000),@flag integer output, @msg varchar(4000) output) as begin set nocount on create table #temp( id int, rolesmark varchar(4000), rolesname varchar(4000),type int, cnt int null ) insert into #temp(id,rolesmark,rolesname,type) select id,rolesmark,rolesname,type from hrmroles  declare roles_cursor cursor for select id from hrmroles open roles_cursor  declare  @id int,@cnt int fetch next from roles_cursor into @id while @@fetch_status=0 begin select @cnt=count(id) from HrmRoleMembers where roleid=@id update  #temp set cnt=@cnt where id=@id fetch next from roles_cursor into @id end if @rolesnameq<>'!@#$'  select id,rolesmark,rolesname,type,cnt from #temp where rolesname like '%'+@rolesnameq+'%' order by rolesname else select id,rolesmark,rolesname,type,cnt from #temp order by rolesname close roles_cursor deallocate roles_cursor end

GO
alter procedure [hrmroles_selectall] @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT AS BEGIN SET nocount ON select * into #temp from hrmroles ALTER TABLE #temp add cnt int DECLARE roles_cursor CURSOR FOR SELECT  id FROM    hrmroles OPEN roles_cursor DECLARE @id INT , @cnt INT FETCH NEXT FROM roles_cursor INTO @id WHILE @@fetch_status = 0 BEGIN SELECT  @cnt = COUNT(id) FROM    HrmRoleMembers WHERE   roleid = @id UPDATE  #temp SET     cnt = @cnt WHERE   id = @id FETCH NEXT FROM roles_cursor INTO @id END SELECT  id , rolesmark , rolesname , type , cnt FROM    #temp CLOSE roles_cursor DEALLOCATE roles_cursor END

GO
alter procedure [hrmroles_selBynameSubcom] (@rolesnameq varchar(4000),@subcomid int,@flag integer output, @msg varchar(4000) output) as begin set nocount on create table #temp( id int, rolesmark varchar(4000), rolesname varchar(4000),type int, subcomid int, cnt int null ) insert into #temp(id,rolesmark,rolesname,type,subcomid) select id,rolesmark,rolesname,type,subcompanyid from hrmroles  declare roles_cursor cursor for select id from hrmroles open roles_cursor  declare  @id int,@cnt int fetch next from roles_cursor into @id while @@fetch_status=0 begin select @cnt=count(id) from HrmRoleMembers where roleid=@id update  #temp set cnt=@cnt where id=@id fetch next from roles_cursor into @id end if @rolesnameq<>'!@#$'  select id,rolesmark,rolesname,type,subcomid,cnt from #temp where rolesname like '%'+@rolesnameq+'%' and subcomid=@subcomid order by rolesname else select id,rolesmark,rolesname,type,subcomid,cnt from #temp where subcomid=@subcomid order by rolesname close roles_cursor deallocate roles_cursor end

GO
alter procedure [HrmRoles_insert_name] @rolesmark varchar(4000), @rolesname varchar(4000), @docid int, @type int, @subcompanyid int output, @flag int output, @msg varchar(4000) output  as begin insert into HrmRoles(rolesmark,rolesname,docid,type,subcompanyid) values(@rolesmark,@rolesname,@docid,@type,@subcompanyid)  if @@error<>0 begin set @flag=1 set @msg='插入失败' end else begin set @flag=0 set @msg='操作成功' end select max(id) as id from hrmroles end

GO
alter procedure [HrmResourceWorkInfo_Insert] (@id_1 int, @usekind_2 int, @startdate_3 char(10), @probationenddate_4 char(10), @enddate_5 char(10), @flag int output, @msg varchar(4000) output) AS UPDATE HrmResource SET usekind = @usekind_2, startdate = @startdate_3, probationenddate = @probationenddate_4, enddate = @enddate_5 WHERE id = @id_1

GO
alter procedure [HrmResourceSystemInfo_Insert1] (@id_1 int, @loginid_2 varchar(4000), @password_3 varchar(4000), @systemlanguage_4 int, @seclevel_5 int, @email_6 varchar(4000) ,@needusb1 int,@serial1 varchar(4000),@account_2 varchar(4000),@lloginid_2 varchar(4000),@needdynapass_2 int,@passwordstate_11 int,@flag int output, @msg varchar(4000) output) AS declare @count int declare @oldpass varchar(4000) declare @chgpasswddate char(10) if @loginid_2 is null or @loginid_2 = '' UPDATE HrmResource SET loginid ='',lloginid='',account='', systemlanguage = @systemlanguage_4, seclevel = @seclevel_5, email = @email_6 WHERE id = @id_1 else begin set @chgpasswddate=null select @oldpass=password from HrmResource where id=@id_1 if (@oldpass is null and @password_3<>'0' ) or @oldpass<>@password_3 set @chgpasswddate=convert(char(10),getdate(),120) if @loginid_2 is not null and @loginid_2 != '' and @loginid_2 != 'sysadmin' select @count = count(id) from HrmResource where id != @id_1 and loginid = @loginid_2 if @loginid_2 = 'sysadmin' select 0 else begin if @password_3 = '0' begin if @serial1='0' UPDATE HrmResource SET loginid = @loginid_2, systemlanguage = @systemlanguage_4, seclevel = @seclevel_5, email = @email_6,passwdchgdate =@chgpasswddate,needusb=@needusb1,account=@account_2,lloginid=@lloginid_2,needdynapass=@needdynapass_2,passwordstate=@passwordstate_11 WHERE id = @id_1 else UPDATE HrmResource SET loginid = @loginid_2, systemlanguage = @systemlanguage_4, seclevel = @seclevel_5, email = @email_6,passwdchgdate =@chgpasswddate,needusb=@needusb1,serial=@serial1,account=@account_2,lloginid=@lloginid_2,passwordstate=@passwordstate_11 WHERE id = @id_1 end else begin if @serial1='0' UPDATE HrmResource SET loginid = @loginid_2, password = @password_3, systemlanguage = @systemlanguage_4, seclevel = @seclevel_5, email = @email_6,passwdchgdate =@chgpasswddate,needusb=@needusb1,account=@account_2,lloginid=@lloginid_2,needdynapass=@needdynapass_2,passwordstate=@passwordstate_11  WHERE id = @id_1 else UPDATE HrmResource SET loginid = @loginid_2, password = @password_3, systemlanguage = @systemlanguage_4, seclevel = @seclevel_5, email = @email_6,passwdchgdate =@chgpasswddate,needusb=@needusb1,serial=@serial1,account=@account_2,lloginid=@lloginid_2,needdynapass=@needdynapass_2,passwordstate=@passwordstate_11  WHERE id = @id_1 end end end

GO
alter procedure [HrmResourceSystemInfo_Insert] (@id_1 int, @loginid_2 varchar(4000), @password_3 varchar(4000), @systemlanguage_4 int, @seclevel_5 int, @email_6 varchar(4000) ,@needusb1 int,@serial1 varchar(4000),@account_2 varchar(4000),@lloginid_2 varchar(4000),@needdynapass_2 int,@passwordstate_11 int,@flag int output, @msg varchar(4000) output) AS declare @count int declare @oldpass varchar(4000) declare @chgpasswddate char(10) if @loginid_2 is null or @loginid_2 = '' UPDATE HrmResource SET loginid ='',lloginid='',account='', systemlanguage = @systemlanguage_4, seclevel = @seclevel_5, email = @email_6 WHERE id = @id_1 else begin set @chgpasswddate=null select @oldpass=password from HrmResource where id=@id_1 if (@oldpass is null and @password_3<>'0' ) or @oldpass<>@password_3 set @chgpasswddate=convert(char(10),getdate(),120) if @loginid_2 is not null and @loginid_2 != '' and @loginid_2 != 'sysadmin' select @count = count(id) from HrmResource where id != @id_1 and loginid = @loginid_2 if ( @count is not null and @count > 0 ) or @loginid_2 = 'sysadmin' select 0 else begin if @password_3 = '0' begin if @serial1='0' UPDATE HrmResource SET loginid = @loginid_2, systemlanguage = @systemlanguage_4, seclevel = @seclevel_5, email = @email_6,passwdchgdate =@chgpasswddate,needusb=@needusb1,account=@account_2,lloginid=@lloginid_2,needdynapass=@needdynapass_2,passwordstate=@passwordstate_11 WHERE id = @id_1 else UPDATE HrmResource SET loginid = @loginid_2, systemlanguage = @systemlanguage_4, seclevel = @seclevel_5, email = @email_6,passwdchgdate =@chgpasswddate,needusb=@needusb1,serial=@serial1,account=@account_2,lloginid=@lloginid_2,passwordstate=@passwordstate_11 WHERE id = @id_1 end else begin if @serial1='0' UPDATE HrmResource SET loginid = @loginid_2, password = @password_3, systemlanguage = @systemlanguage_4, seclevel = @seclevel_5, email = @email_6,passwdchgdate =@chgpasswddate,needusb=@needusb1,account=@account_2,lloginid=@lloginid_2,needdynapass=@needdynapass_2,passwordstate=@passwordstate_11  WHERE id = @id_1 else UPDATE HrmResource SET loginid = @loginid_2, password = @password_3, systemlanguage = @systemlanguage_4, seclevel = @seclevel_5, email = @email_6,passwdchgdate =@chgpasswddate,needusb=@needusb1,serial=@serial1,account=@account_2,lloginid=@lloginid_2,needdynapass=@needdynapass_2,passwordstate=@passwordstate_11  WHERE id = @id_1 end end end

GO
alter procedure [HrmResourcePersonalInfo_Insert] ( @id_1 int, @birthday_2 char(10), @folk_3 varchar(4000), @nativeplace_4 varchar(4000), @regresidentplace_5 varchar(4000), @maritalstatus_6 char(1), @policy_7 varchar(4000), @bememberdate_8 char(10), @bepartydate_9 char(10), @islabouunion_10 char(1), @educationlevel_11 int, @degree_12 varchar(4000), @healthinfo_13  char(1), @height_14 int, @weight_15 int, @residentplace_16 varchar(4000), @homeaddress_17 varchar(4000), @tempresidentnumber_18 varchar(4000), @certificatenum_19 varchar(4000), @flag int output, @msg varchar(4000) output) AS UPDATE HrmResource SET birthday = @birthday_2, folk = @folk_3, nativeplace = @nativeplace_4, regresidentplace = @regresidentplace_5, maritalstatus = @maritalstatus_6, policy = @policy_7, bememberdate = @bememberdate_8, bepartydate = @bepartydate_9, islabouunion = @islabouunion_10, educationlevel = @educationlevel_11, degree = @degree_12, healthinfo = @healthinfo_13, height = @height_14, weight = @weight_15, residentplace = @residentplace_16, homeaddress = @homeaddress_17, tempresidentnumber = @tempresidentnumber_18, certificatenum = @certificatenum_19 WHERE id = @id_1

GO
alter procedure [DocReadRpSum] @fromdate	varchar(4000), @todate	varchar(4000), @userid       int, @flag	int output, @msg 	varchar(4000) output AS declare @docid	int, @acount int, @doccreaterid int, @docdepartmentid int, @maincategory int create table #temp( docid  int , acount  int, doccreaterid	int, docdepartmentid	int, maincategory	int )  if @fromdate<>'0' and @todate <>'0' begin declare docid_cursor cursor for select top 50 count(t3.id) result,t1.docid resultid from DocDetailLog as t1,DocShareDetail as t2 ,DocDetail as t3 where t2.usertype=1 and operatetype='0' and operatedate > @fromdate and operatedate<@todate and t1.docid=t2.docid and t1.docid=t3.id and t2.userid=@userid group by t1.docid order by result desc end  if @fromdate='0' and @todate <>'0' begin declare docid_cursor cursor for select top 50 count(t3.id) result,t1.docid resultid from DocDetailLog as t1,DocShareDetail as t2  ,DocDetail as t3 where t2.usertype=1 and  operatetype='0' and operatedate<@todate and t1.docid=t2.docid  and t1.docid=t3.id and t2.userid=@userid group by t1.docid order by result desc end  if @fromdate<>'0' and @todate ='0' begin declare docid_cursor cursor for select top 50 count(t3.id) result,t1.docid resultid from DocDetailLog as t1,DocShareDetail as t2 ,DocDetail as t3 where  t2.usertype=1 and operatetype='0' and operatedate>@fromdate and t1.docid=t2.docid  and t1.docid=t3.id and t2.userid=@userid group by t1.docid order by result desc end  if @fromdate='0' and @todate ='0' begin declare docid_cursor cursor for select top 50 count(t3.id) result,t1.docid resultid from DocDetailLog as t1,DocShareDetail as t2 ,DocDetail as t3 where  t2.usertype=1 and operatetype='0' and t1.docid=t2.docid  and t1.docid=t3.id and t2.userid=@userid group by t1.docid order by result desc end  open docid_cursor fetch next from docid_cursor into @acount,@docid while @@fetch_status=0 begin select @maincategory = maincategory , @doccreaterid=doccreaterid, @docdepartmentid= docdepartmentid from DocDetail where id= @docid  insert into #temp values(@docid,@acount,@doccreaterid, @docdepartmentid,@maincategory) fetch next from docid_cursor into @acount,@docid end close docid_cursor deallocate docid_cursor select * from #temp order by acount desc

GO
alter procedure [SequenceIndexRes_Init] as declare @id_1 integer, @resid_2 integer, @curid_3 integer select @id_1=max(id) from HrmResource select @resid_2 = max(id) from HrmCareerApply if @resid_2 is null set @resid_2 = 0 if @id_1 is null set @id_1 = 0 if( @id_1>@resid_2) set @curid_3= @id_1+1 else  set @curid_3 = @resid_2+1 update SequenceIndex set currentid = @curid_3 where indexdesc='resourceid'

GO
alter procedure [DocShareDetail_DeleteByDocId] ( @docid_1 	int , @flag	int	output, @msg	varchar(4000)	output )  AS DELETE shareinnerdoc  WHERE (sourceid=@docid_1)

GO
alter procedure [HrmRightTransfer_Resource] @fromid	int, @toid	int, @resourceid	int, @flag	int	output, @msg	varchar(4000) output as if	@resourceid=0 begin declare @all_cursor cursor, @tempid		int SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from hrmresource where managerid=@fromid OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @tempid  WHILE @@FETCH_STATUS = 0 begin update hrmresource set managerid=@toid where id=@tempid FETCH NEXT FROM @all_cursor INTO @tempid end CLOSE @all_cursor DEALLOCATE @all_cursor end else update hrmresource set managerid=@toid where id=@resourceid if @@error<>0 begin set @flag=1 set @msg='插入失败' end else begin set @flag=0 set @msg='操作成功' end

GO
alter procedure [HrmRightTransfer_Project] @fromid	int, @toid	int, @projectid	int, @flag	int	output, @msg	varchar(4000) output as if	@projectid=0 begin declare @all_cursor cursor, @tempid		int SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from Prj_ProjectInfo where manager=@fromid OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @tempid  WHILE @@FETCH_STATUS = 0 begin update Prj_ProjectInfo set manager=@toid where id=@tempid FETCH NEXT FROM @all_cursor INTO @tempid end CLOSE @all_cursor DEALLOCATE @all_cursor end else update Prj_ProjectInfo set manager=@toid where id=@projectid if @@error<>0 begin set @flag=1 set @msg='插入失败' end else begin set @flag=0 set @msg='操作成功' end

GO
alter procedure [HrmRightTransfer_Doc] @fromid	int, @toid	int, @docid	int, @todeptid	int, @flag	int	output, @msg	varchar(4000) output as if	@docid=0 begin declare @all_cursor cursor, @tempid		int SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from docdetail where ownerid=@fromid OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @tempid WHILE @@FETCH_STATUS = 0 begin update docdetail set ownerid=@toid, docdepartmentid=@todeptid where id=@tempid FETCH NEXT FROM @all_cursor INTO @tempid end CLOSE @all_cursor DEALLOCATE @all_cursor end else update docdetail set ownerid=@toid, docdepartmentid=@todeptid where id=@docid  if @@error<>0 begin set @flag=1 set @msg='插入失败' end else begin set @flag=0 set @msg='操作成功' end

GO
alter procedure [workflow_CurOpe_UpdatebyView] @requestid	int, @userid		int, @usertype	int, @flag 		integer 	output , @msg 		varchar(4000) 	output AS declare @currentdate char(10), @currenttime char(8)  set @currentdate=convert(char(10),getdate(),20) set @currenttime=convert(char(8),getdate(),108)  update workflow_currentoperator set operatedate=@currentdate,operatetime=@currenttime where requestid =@requestid and userid =@userid and usertype=@usertype  and isremark in(0,4) and operatedate is null

GO
alter procedure [CRM_CustomerContacter_SMain] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerContacter] WHERE ( [customerid]	 = @id) AND ([main] = 1) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerContacter_SByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerContacter] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerContacter_SAll] ( @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerContacter]  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerContacter_Insert] (@customerid_1 	int, @title_2 	int, @fullname_3 	varchar(4000), @lastname_4 	varchar(4000), @firstname_5 	varchar(4000), @jobtitle_6 	varchar(4000), @email_7 	varchar(4000), @phoneoffice_8 	varchar(4000), @phonehome_9 	varchar(4000), @mobilephone_10 	varchar(4000), @fax_11 	varchar(4000), @language_12 	int, @manager_13 	int, @main_14 	tinyint, @picid_15 	int, @interest_1	varchar(4000), @hobby_1	varchar(4000), @managerstr_1	varchar(4000), @subordinate_1	varchar(4000), @strongsuit_1	varchar(4000), @age_1		int, @birthday_1	varchar(4000), @home_1	varchar(4000), @school_1	varchar(4000), @speciality_1	varchar(4000), @nativeplace_1	varchar(4000), @experience_1	varchar(4000), @datefield1_16 	varchar(4000), @datefield2_17 	varchar(4000), @datefield3_18 	varchar(4000), @datefield4_19 	varchar(4000), @datefield5_20 	varchar(4000), @numberfield1_21 	float, @numberfield2_22 	float, @numberfield3_23 	float, @numberfield4_24 	float, @numberfield5_25 	float, @textfield1_26 	varchar(4000), @textfield2_27 	varchar(4000), @textfield3_28 	varchar(4000), @textfield4_29 	varchar(4000), @textfield5_30 	varchar(4000), @tinyintfield1_31 	tinyint, @tinyintfield2_32 	tinyint, @tinyintfield3_33 	tinyint, @tinyintfield4_34 	tinyint, @tinyintfield5_35 	tinyint, @IDCard_36 	varchar(4000), @isbirthdaynotify_37   char(1), @birthdaynotifydays_38 int, @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO CRM_CustomerContacter ( customerid, title, fullname, lastname, firstname, jobtitle, email, phoneoffice, phonehome, mobilephone, fax, language, manager, main, picid, datefield1, datefield2, datefield3, datefield4, datefield5, numberfield1, numberfield2, numberfield3, numberfield4, numberfield5, textfield1, textfield2, textfield3, textfield4, textfield5, tinyintfield1, tinyintfield2, tinyintfield3, tinyintfield4, tinyintfield5 ,interest ,hobby ,managerstr,subordinate,strongsuit,age,birthday,home,school,speciality,nativeplace,experience,IDCard,isbirthdaynotify,birthdaynotifydays) VALUES ( @customerid_1, @title_2, @fullname_3, @lastname_4, @firstname_5, @jobtitle_6, @email_7, @phoneoffice_8, @phonehome_9, @mobilephone_10, @fax_11, @language_12, @manager_13, @main_14, @picid_15, @datefield1_16, @datefield2_17, @datefield3_18, @datefield4_19, @datefield5_20, @numberfield1_21, @numberfield2_22, @numberfield3_23, @numberfield4_24, @numberfield5_25, @textfield1_26, @textfield2_27, @textfield3_28, @textfield4_29, @textfield5_30, @tinyintfield1_31, @tinyintfield2_32, @tinyintfield3_33, @tinyintfield4_34, @tinyintfield5_35, @interest_1 , @hobby_1 , @managerstr_1, @subordinate_1 , @strongsuit_1 , @age_1 , @birthday_1 , @home_1 , @school_1 , @speciality_1 , @nativeplace_1 , @experience_1, @IDCard_36, @isbirthdaynotify_37, @birthdaynotifydays_38 )  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerContacter_Delete] (@id_1 	[int], @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [CRM_CustomerContacter]  WHERE ( [id]	 = @id_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [DocFrontpage_ALLCount] ( @logintype		int, @usertype		int, @userid			int, @userseclevel	int, @flag integer output, @msg varchar(4000) output) as if @logintype=1 begin Select count(distinct n.id ) countnew from DocDetail n INNER JOIN DocShareDetail d ON n.id=d.docid where d.userid=@userid and d.usertype = 1 and  (n.docpublishtype='2' or n.docpublishtype='3') and n.docstatus in('1','2','5') end else begin Select count(distinct n.id ) countnew from DocDetail n INNER JOIN DocShareDetail d ON n.id=d.docid where  d.usertype=@usertype and d.userid<=@userseclevel and (n.docpublishtype='2' or n.docpublishtype='3') and n.docstatus in('1','2','5') end

GO
alter procedure [ShareForWorkflow] AS Declare @workflowid int, @groupid int, @gid int, @type int, @objid int, @objid_2 int, @level_n int, @level2_n int, @signorder  int, @groupid_old int, @detail_cursor cursor delete from ShareInnerWfCreate SET @detail_cursor = CURSOR FORWARD_ONLY STATIC FOR select workflowid,type,objid,level_n,level2_n,signorder, t2.id, t3.id from workflow_flownode t1,workflow_nodegroup t2,workflow_groupdetail t3 where t1.nodetype='0' and t1.nodeid = t2.nodeid and t2.id = t3.groupid OPEN @detail_cursor fetch next from @detail_cursor INTO @workflowid, @type, @objid, @level_n, @level2_n, @signorder, @groupid, @gid while @@FETCH_STATUS = 0 begin if @type=1 or @type=3 or @type=4 or @type=30 begin insert into ShareInnerWfCreate(gid, workflowid, type, content, min_seclevel, max_seclevel, isBelong, usertype) values(@gid, @workflowid, @type, @objid, @level_n, @level2_n, @signorder, 0) end else if @type=2 begin set @objid_2 = CONVERT(int, CONVERT(varchar(4000), @objid) +  CONVERT(varchar(4000), @level_n)) insert into ShareInnerWfCreate(gid, workflowid, type, content, min_seclevel, max_seclevel, isBelong, usertype) values(@gid, @workflowid, @type, @objid_2, -1, -1, @signorder, 0) if @signorder=1 begin if @level_n=0 begin set @objid_2 = CONVERT(int, CONVERT(varchar(4000), @objid) +  CONVERT(varchar(4000), @level_n + 1)) insert into ShareInnerWfCreate(gid, workflowid, type, content, min_seclevel, max_seclevel, isBelong, usertype) values(@gid, @workflowid, @type, @objid_2, -1, -1, @signorder, 0)  set @level_n = @level_n + 1 end if @level_n=1 begin set @objid_2 = CONVERT(int, CONVERT(varchar(4000), @objid) +  CONVERT(varchar(4000), @level_n + 1)) insert into ShareInnerWfCreate(gid, workflowid, type, content, min_seclevel, max_seclevel, isBelong, usertype) values(@gid, @workflowid, @type, @objid_2, -1, -1, @signorder, 0) end end end else if @type=20 or @type=21 or @type=22 or @type=25 begin insert into ShareInnerWfCreate(gid, workflowid, type, content, min_seclevel, max_seclevel, isBelong, usertype) values(@gid, @workflowid, @type, @objid, @level_n, @level2_n, @signorder, 1) end FETCH NEXT FROM @detail_cursor INTO @workflowid, @type, @objid, @level_n, @level2_n, @signorder, @groupid, @gid end CLOSE @detail_cursor DEALLOCATE @detail_cursor

GO
alter procedure [Doc_DirAcl_CheckPermissionEx1](@dirid_1 int, @dirtype_1 int, @userid_1 int, @usertype_1 int, @seclevel_1 int, @operationcode_1 int, @departmentid_1 int,@subcompanyid_1 int, @roleid_1 varchar(4000), @haspermission_1 int output, @flag int output, @msg varchar(4000) output)  AS declare @count_1 int declare @result int set @result = 0 if @usertype_1 = 0 begin set @count_1 = (select count(sourceid) from DirAccessControlDetail  where  sourceid = @dirid_1 and  sourcetype=@dirtype_1 and  sharelevel=@operationcode_1 and ((type=1 and content=@departmentid_1 and seclevel<=@seclevel_1) or (type=2 and content in (select * from SplitStr(@roleid_1,',')) and seclevel<=@seclevel_1) or (type=3 and seclevel<=@seclevel_1) or (type=4 and content=@usertype_1 and seclevel<=@seclevel_1) or (type=5 and content=@userid_1) or (type=6 and content=@subcompanyid_1 and seclevel<=@seclevel_1))) end else begin set @count_1 = (select count(mainid) from DirAccessControlList where dirid=@dirid_1 and dirtype=@dirtype_1 and operationcode=@operationcode_1 and ((permissiontype=3 and seclevel<=@seclevel_1) or (permissiontype=4 and usertype=@usertype_1 and seclevel<=@seclevel_1))) end if (not (@count_1 is null)) and (@count_1 > 0) begin set @result = 1 end set @haspermission_1 = @result if @@error<>0 begin set @flag=1 set @msg='检查目录访问权限成功' return end else begin set @flag=0 set @msg='检查目录访问权限失败' return end

GO
alter procedure [DocSecCategory_SByCustomerType] (@cusertype 	[int], @cuserseclevel 	[tinyint], @flag	int output, @msg	varchar(4000)	output) as select id,subcategoryid from DocSecCategory where cusertype= @cusertype and cuserseclevel<=@cuserseclevel  order by subcategoryid

GO
alter procedure [Doc_DirAcl_Insert_Type3](@dirid_1 int, @dirtype_1 int, @operationcode_1 int, @seclevel_1 int, @flag int output, @msg varchar(4000) output)  AS insert into DirAccessControlList(dirid, dirtype, seclevel, operationcode, permissiontype) values(@dirid_1, @dirtype_1, @seclevel_1, @operationcode_1, 3) if @@error<>0 begin set @flag=1 set @msg='插入目录访问权限主表成功' return end else begin set @flag=0 set @msg='插入目录访问权限主表失败' return end

GO
alter procedure [Doc_DirAcl_Insert_Type2](@dirid_1 int, @dirtype_1 int, @operationcode_1 int, @roleid_1 int, @rolelevel_1 int, @seclevel_1 int, @flag int output, @msg varchar(4000) output)  AS insert into DirAccessControlList(dirid, dirtype, roleid, rolelevel, seclevel, operationcode, permissiontype) values(@dirid_1, @dirtype_1, @roleid_1, @rolelevel_1, @seclevel_1, @operationcode_1, 2) if @@error<>0 begin set @flag=1 set @msg='插入目录访问权限主表成功' return end else begin set @flag=0 set @msg='插入目录访问权限主表失败' return end

GO
alter procedure [Doc_DirAcl_Insert_Type1](@dirid_1 int, @dirtype_1 int, @operationcode_1 int, @departmentid_1 int, @seclevel_1 int, @flag int output, @msg varchar(4000) output)  AS insert into DirAccessControlList(dirid, dirtype, departmentid, seclevel, operationcode, permissiontype) values(@dirid_1, @dirtype_1, @departmentid_1, @seclevel_1, @operationcode_1, 1) if @@error<>0 begin set @flag=1 set @msg='插入目录访问权限主表成功' return end else begin set @flag=0 set @msg='插入目录访问权限主表失败' return end

GO
alter procedure [Doc_DirAcl_Delete](@mainid_1 int, @flag int output, @msg varchar(4000) output)  AS delete from DirAccessControlList where mainid = @mainid_1 if @@error<>0 begin set @flag=1 set @msg='删除目录访问权限表成功' return end else begin set @flag=0 set @msg='删除目录访问权限表失败' return end

GO
alter procedure [Doc_DirAcl_CPermissionForDir](@dirid_1 int, @dirtype_1 int, @flag int output, @msg varchar(4000) output) as delete from DirAccessControlList where dirid = @dirid_1 and dirtype = @dirtype_1 if @@error<>0 begin set @flag=1 set @msg='清除目录访问权限表成功' return end else begin set @flag=0 set @msg='清除目录访问权限表失败' return end

GO
alter procedure [DocDetail_SProCountByProjID] (@id_1 	[int], @id_2 [int], @flag  integer output, @msg  varchar(4000) output ) AS select count(projectid) from DocDetail t1, DocUserView t2 where t1.projectid = @id_1 and t2.userid=@id_2 and t2.docid=t1.id  if @@error<>0 begin set @flag=1 set @msg='查询人力资源文档总数信息成功' return end else begin set @flag=0 set @msg='查询人力资源文档总数信息失败' return end

GO
alter procedure [DocDetail_SelectCrmCountByCrm] (@id_1 	[int], @id_2 [int], @flag  integer output, @msg  varchar(4000) output ) AS select count(crmid) from DocDetail t1, DocUserView t2 where t1.crmid = @id_1 and t2.userid=@id_2 and t2.docid=t1.id  if @@error<>0 begin set @flag=1 set @msg='查询人力资源文档总数信息成功' return end else begin set @flag=0 set @msg='查询人力资源文档总数信息失败' return end

GO
alter procedure [DocDetail_SelectCountByOwner] (@id_1  int, @flag    integer output, @msg   varchar(4000) output ) AS select count(*) from DocDetail where ownerid = @id_1 and  maincategory!=0  and subcategory!=0 and seccategory!=0

GO
alter procedure [DocDetail_SelectCountByItem] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select count(*) from DocDetail where itemid = @id_1

GO
alter procedure [DocDetail_SelectCountByCapital] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select count(*) from DocDetail where assetid = @id_1

GO
alter procedure [DocDetail_SelectByOwner] (@resourceid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS select distinct id from DocDetail where  ownerid = @resourceid_1

GO
alter procedure [DocDetail_SelectByCreater] (@resourceid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS select distinct id from DocDetail where doccreaterid = @resourceid_1 or ownerid = @resourceid_1

GO
alter procedure [DocDetail_SCountByResource2] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select count(*) from DocDetail where doccreaterid = @id_1 if @@error<>0 begin set @flag=1 set @msg='查询人力资源文档总数信息成功' return end else begin set @flag=0 set @msg='查询人力资源文档总数信息失败' return end

GO
alter procedure [DocDetail_SCountByResource] (@id_1 	[int], @id_2  [int], @flag  integer output, @msg  varchar(4000) output ) AS select count(hrmresid) from DocDetail t1, DocUserView t2 where hrmresid = @id_1 and t2.userid=@id_2 and t1.id=t2.docid  if @@error<>0 begin set @flag=1 set @msg='查询人力资源文档总数信息成功' return end else begin set @flag=0 set @msg='查询人力资源文档总数信息失败' return end

GO
alter procedure [docDetail_QueryByDocid] (@docid_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS select DocSubject,maincategory,docdepartmentid,doccreaterid  from Docdetail where id = @docid_1

  GO
alter procedure [DocDetail_Approve] @approverid		int, @docstatus      char(1), @approvedate    char(10), @approvetime    char(8), @docid          int, @flag integer output , @msg varchar(4000) output as update DocDetail set docstatus=@docstatus,docapproveuserid=@approverid,docapprovedate=@approvedate,docapprovetime=@approvetime where id=@docid

GO
alter procedure [Employee_SeatUpdate] @textfield_1 varchar(4000), @hrmid_1  int, @flag		int	output, @msg		varchar(4000) output as update HrmResource set textfield2=@textfield_1 WHERE id=@hrmid_1 update HrmInfoStatus set status = '1' WHERE itemid=4 AND hrmid=@hrmid_1

  GO
alter procedure [Employee_SByStatus] @flag		int	output, @msg		varchar(4000) output as declare @hrmid_1 int, @id_1 int, @lastname_1 varchar(4000), @sex_1 char(1), @startdate_1 char(10), @departmentid_1 int, @joblevel_1 tinyint, @managerid_1 int  CREATE table #temp(id int, lastname  varchar(4000) , sex  char(1), startdate	char(10), departmentid	int, joblevel	tinyint, managerid int )  declare employee_cursor cursor for   select distinct(hrmid) from HrmInfoStatus t1,HrmResource t2 where t1.status ='0' and t1.hrmid = t2.id  open employee_cursor fetch next from employee_cursor into @hrmid_1 while @@fetch_status=0 begin select 		 @id_1=id,@lastname_1=lastname,@sex_1=sex,@startdate_1=startdate,@departmentid_1=departmentid,@joblevel_1=joblevel,@managerid_1=managerid from HrmResource WHERE id=@hrmid_1 insert INTO #temp(id,lastname,sex,startdate,departmentid,joblevel,managerid) values(@id_1,@lastname_1,@sex_1,@startdate_1,@departmentid_1,@joblevel_1,@managerid_1) fetch next from employee_cursor into @hrmid_1 end close employee_cursor deallocate employee_cursor select * from #temp

GO
alter procedure [Employee_LoginUpdate] @loginid_1 varchar(4000), @password_1 varchar(4000), @hrmid_1  int, @flag		int	output, @msg		varchar(4000) output as declare @count_1 int  select @count_1=count(*) from HrmResource where loginid = @loginid_1 and id<>@hrmid_1 if @count_1<>0 begin select -1 return end else if @password_1 = 'novalue$1' begin update HrmResource set loginid=@loginid_1, systemlanguage=7, resourcetype='2', seclevel=10 WHERE id= @hrmid_1 end else begin update HrmResource set loginid=@loginid_1, password=@password_1, systemlanguage=7, resourcetype='2', seclevel=10 WHERE id= @hrmid_1 end update HrmInfoStatus set status = '1' WHERE itemid=1 AND hrmid=@hrmid_1

GO
alter procedure [Employee_EmaiUpdate] @email_1 varchar(4000), @emailpassword_1 varchar(4000), @hrmid_1  int, @flag		int	output, @msg		varchar(4000) output as declare @count_1 int update HrmResource set email=@email_1 WHERE id=@hrmid_1 if @emailpassword_1 = 'novalue$1'   begin update MailPassword set resourcemail =@email_1  WHERE resourceid=@hrmid_1 end else begin select @count_1=count(*) from MailPassword WHERE resourceid=@hrmid_1 if @count_1 <> 0    begin update MailPassword set resourcemail =@email_1,password=@emailpassword_1  WHERE resourceid=@hrmid_1 end else	 begin insert INTO  MailPassword (resourceid,resourcemail,password) values(@hrmid_1,@email_1,@emailpassword_1) end end update HrmInfoStatus set status = '1' WHERE itemid=2 AND hrmid=@hrmid_1

GO
alter procedure [Employee_CardUpdate] @textfield_1 varchar(4000), @hrmid_1  int, @flag		int	output, @msg		varchar(4000) output as update HrmResource set textfield1=@textfield_1 WHERE id=@hrmid_1 update HrmInfoStatus set status = '1' WHERE itemid=3 AND hrmid=@hrmid_1

GO
alter procedure [Employee_BusiCardUpdate] @businesscard_1 varchar(4000), @hrmid_1  int, @flag		int	output, @msg		varchar(4000) output as update HrmResource set tinyintfield1 = @businesscard_1 WHERE id=@hrmid_1 update HrmInfoStatus set status = '1' WHERE itemid=9 AND hrmid=@hrmid_1

GO
alter procedure [DocUserView_SelectCopyByUserId] (@secid  int, @userid 	[int], @flag	int output, @msg	varchar(4000)	output) as select t1.id,t1.docsubject,t1.doccreaterid,t1.doccreatedate,t1.docstatus from DocDetail as t1, DocUserView as t2 where t1.id=t2.docid and t1.seccategory=@secid and t2.userid=@userid

GO
alter procedure [Doc_DirAcl_CheckPermission](@dirid_1 int, @dirtype_1 int, @userid_1 int, @usertype_1 int, @seclevel_1 int, @operationcode_1 int, @departmentid_1 int,@subcompanyid_1 int, @roleid_1 varchar(4000),@flag int output, @msg varchar(4000) output)  AS declare @count_1 int declare @result int set @result = 0 if @usertype_1 = 0 begin set @count_1 = (select count(sourceid) from DirAccessControlDetail  where  sourceid = @dirid_1 and  sourcetype=@dirtype_1 and  sharelevel=@operationcode_1 and ((type=1 and content=@departmentid_1 and seclevel<=@seclevel_1) or (type=2 and  content in (select * from SplitStr(@roleid_1,',')) and seclevel<=@seclevel_1) or (type=3 and seclevel<=@seclevel_1) or (type=4 and content=@usertype_1 and seclevel<=@seclevel_1) or (type=5 and content=@userid_1) or (type=6 and content=@subcompanyid_1 and seclevel<=@seclevel_1))) end else begin set @count_1 = (select count(mainid) from DirAccessControlList where dirid=@dirid_1 and dirtype=@dirtype_1 and operationcode=@operationcode_1 and ((permissiontype=3 and seclevel<=@seclevel_1) or (permissiontype=4 and usertype=@usertype_1 and seclevel<=@seclevel_1))) end print @count_1 if (not (@count_1 is null)) and (@count_1 > 0) begin set @result = 1 end select @result result if @@error<>0 begin set @flag=1 set @msg='检查目录访问权限成功' return end else begin set @flag=-1 set @msg='检查目录访问权限失败' return end

 GO
alter procedure [Doc_DeleteSecidFromFather](@secid_1 int, @flag integer output , @msg varchar(4000) output) as declare @fatherid_1 int, @fatherid1_1 int declare @secid_ch_1 varchar(4000) declare @secids_1 varchar(4000)  set @secid_ch_1 = ','+convert(varchar, @secid_1)+',' select @fatherid_1=subcategoryid from DocSecCategory where id = @secid_1 if @fatherid_1 is null set @fatherid_1 = -1 if @fatherid_1 = 0 set @fatherid_1 = -1  while @fatherid_1 <> -1 begin select @fatherid1_1=subcategoryid, @secids_1=seccategoryids from DocSubCategory where id = @fatherid_1 if (@secids_1 is not null) and (@secids_1 <> '') begin set @secids_1 = ','+@secids_1+',' if charindex(@secid_ch_1, @secids_1) <> 0 begin set @secids_1 = replace(@secids_1, @secid_ch_1, ',') if @secids_1 = ',' begin set @secids_1 = '' end else begin set @secids_1 = substring(@secids_1, 2, len(@secids_1)-2) end update DocSubCategory set seccategoryids = @secids_1 where id = @fatherid_1 end end set @fatherid_1 = @fatherid1_1 end

GO
alter procedure [Doc_AddSecidToFather] (@secid_1 int, @flag integer output , @msg varchar(4000) output) as declare @fatherid_1 int, @fatherid1_1 int declare @secid_ch_1 varchar(4000) declare @secids_1 varchar(4000)  set @secid_ch_1 = convert(varchar, @secid_1) select @fatherid_1=subcategoryid from DocSecCategory where id = @secid_1 if @fatherid_1 is null set @fatherid_1 = -1 if @fatherid_1 = 0 set @fatherid_1 = -1  while @fatherid_1 <> -1 begin select @fatherid1_1=subcategoryid, @secids_1=seccategoryids from DocSubCategory where id = @fatherid_1 if (@secids_1 is null) or (@secids_1 = '') begin update DocSubCategory set seccategoryids = @secid_ch_1 where id = @fatherid_1 end else if (charindex(','+@secid_ch_1+',', ','+@secids_1+',')=0) begin update DocSubCategory set seccategoryids = @secids_1+','+@secid_ch_1 where id = @fatherid_1 end set @fatherid_1 = @fatherid1_1 end

GO
alter procedure [Employee_TeleUpdate] @telephone_1 varchar(4000), @hrmid_1  int, @flag		int	output, @msg		varchar(4000) output as update HrmResource set telephone=@telephone_1 WHERE id=@hrmid_1 update HrmInfoStatus set status = '1' WHERE itemid=7 AND hrmid=@hrmid_1

GO
alter procedure [Employee_SelectByID] @hrmid_1    int, @flag		int	output, @msg		varchar(4000) output as select email,textfield1,textfield2,telephone,tinyintfield1 from HrmResource WHERE id=@hrmid_1

GO
alter procedure [Prj_Info_SelectCountByResource] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select count(*) from PRJ_ProjectInfo where manager = @id_1 if @@error<>0 begin set @flag=1 set @msg='查询人力资源文档总数信息成功' return end else begin set @flag=0 set @msg='查询人力资源文档总数信息失败' return end

GO
alter procedure [workflow_Workflowbase_SByID] @workflowid	int, @flag integer output , @msg varchar(4000) output AS select * from workflow_base where id=@workflowid

GO
alter procedure [workflow_wftype_Update] (@id	 	[int], @typename 	varchar(4000), @typedesc 	varchar(4000), @dsporder	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [workflow_type]  SET  [typename] = @typename, [typedesc] = @typedesc ,[dsporder] = @dsporder WHERE ( [id]	 = @id)

GO
alter procedure [workflow_wftype_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [workflow_type] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [workflow_wftype_Insert] (@typename_1 	varchar(4000), @typedesc_2 	varchar(4000), @dsporder	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [workflow_type] ( [typename], [typedesc],[dsporder]) VALUES ( @typename_1, @typedesc_2,@dsporder)

GO
alter procedure [CRM_Contacter_Unite_Update] (@id_1 	[int] , @id_2 	varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE CRM_CustomerContacter SET customerid = @id_1 , main = '0' where customerid = @id_2

GO
alter procedure [importloan] as Declare @relatedcrm_1 int, @relatedprj_1 int, @organizationid_1 int, @occurdate_1 char(10), @amount_1 decimal(15,3), @subject_1 int, @requestid_1 int, @description_1 varchar(4000), @loantype_1 int, @debitremark_1 varchar(4000), @processorid_1 int, @all_cursor cursor SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select loantypeid,resourceid,crmid,projectid,amount,occurdate,releatedid,description,credenceno,dealuser from FnaLoanLog OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @loantype_1,@organizationid_1,@relatedcrm_1,@relatedprj_1,@amount_1,@occurdate_1,@requestid_1,@description_1,@debitremark_1,@processorid_1 WHILE @@FETCH_STATUS = 0 begin if(@loantype_1!=1) set @amount_1=-1*@amount_1 insert into fnaloaninfo(loantype,organizationtype,organizationid,relatedcrm,relatedprj,amount,occurdate,requestid,remark,debitremark,processorid) values(@loantype_1,3,@organizationid_1,@relatedcrm_1,@relatedprj_1,@amount_1,@occurdate_1,@requestid_1,@description_1,@debitremark_1,@processorid_1) FETCH NEXT FROM @all_cursor INTO @loantype_1,@organizationid_1,@relatedcrm_1,@relatedprj_1,@amount_1,@occurdate_1,@requestid_1,@description_1,@debitremark_1,@processorid_1 end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [initDocDetail_docExtendName] @flag		int	output, @msg		varchar(4000) output as Declare @docid int, @doctype int, @docfiletype int, @all_cursor cursor  SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select d1.id,d1.doctype,d2.docfiletype from docdetail d1 left join docimagefile d2 on d1.id=d2.docid OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @docid,@doctype,@docfiletype WHILE @@FETCH_STATUS = 0 begin if @doctype = 2 begin if @docfiletype = 3 update docdetail set docExtendName='doc' where id = @docid; else if  @docfiletype = 4 update docdetail set docExtendName='xls' where id = @docid; else update docdetail set docExtendName='html' where id = @docid; end else update docdetail set docExtendName='html' where id = @docid; FETCH NEXT FROM @all_cursor INTO  @docid,@doctype,@docfiletype end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [Init_CRM_SellChance] as Declare @creater int, @departmentId int, @subCompanyId int, @all_cursor cursor SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select t1.creater,t2.departmentid,t2.subcompanyid1 from CRM_SellChance t1 left join HrmResource t2 on t1.creater=t2.id OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @creater,@departmentId,@subCompanyId WHILE @@FETCH_STATUS = 0 begin update CRM_SellChance set departmentId=@departmentId,subCompanyId=@subCompanyId where creater = @creater; FETCH NEXT FROM @all_cursor INTO  @creater,@departmentId,@subCompanyId end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [CRM_CustomerContacter_Update] (@id_1 	int, @title_3 	int, @fullname_4 	varchar(4000), @lastname_5 	varchar(4000), @firstname_6 	varchar(4000), @jobtitle_7 	varchar(4000), @email_8 	varchar(4000), @phoneoffice_9 	varchar(4000), @phonehome_10 	varchar(4000), @mobilephone_11 	varchar(4000), @fax_12 	varchar(4000), @language_13 	int, @manager_14 	int, @main_15 	tinyint, @picid_16 	int, @interest_1	varchar(4000), @hobby_1	varchar(4000), @managerstr_1	varchar(4000), @subordinate_1	varchar(4000), @strongsuit_1	varchar(4000), @age_1		int, @birthday_1	varchar(4000), @home_1	varchar(4000), @school_1	varchar(4000), @speciality_1	varchar(4000), @nativeplace_1	varchar(4000), @experience_1	varchar(4000), @datefield1_17 	varchar(4000), @datefield2_18 	varchar(4000), @datefield3_19 	varchar(4000), @datefield4_20 	varchar(4000), @datefield5_21 	varchar(4000), @numberfield1_22 	float, @numberfield2_23 	float, @numberfield3_24 	float, @numberfield4_25 	float, @numberfield5_26 	float, @textfield1_27 	varchar(4000), @textfield2_28 	varchar(4000), @textfield3_29 	varchar(4000), @textfield4_30 	varchar(4000), @textfield5_31 	varchar(4000), @tinyintfield1_32 	tinyint, @tinyintfield2_33 	tinyint, @tinyintfield3_34 	tinyint, @tinyintfield4_35 	tinyint, @tinyintfield5_36 	tinyint, @IDCard_37 	varchar(4000), @isbirthdaynotify_38   char(1), @birthdaynotifydays_39 int, @flag	int	output, @msg	varchar(4000)	output) AS UPDATE CRM_CustomerContacter SET	 title	 = @title_3, fullname	 = @fullname_4, lastname	 = @lastname_5, firstname	 = @firstname_6, jobtitle	 = @jobtitle_7, email	 = @email_8, phoneoffice	 = @phoneoffice_9, phonehome	 = @phonehome_10, mobilephone	 = @mobilephone_11, fax	 = @fax_12, language	 = @language_13, manager	 = @manager_14, main	 = @main_15, picid	 = @picid_16, datefield1	 = @datefield1_17, datefield2	 = @datefield2_18, datefield3	 = @datefield3_19, datefield4	 = @datefield4_20, datefield5	 = @datefield5_21, numberfield1	 = @numberfield1_22, numberfield2	 = @numberfield2_23, numberfield3	 = @numberfield3_24, numberfield4	 = @numberfield4_25, numberfield5	 = @numberfield5_26, textfield1	 = @textfield1_27, textfield2	 = @textfield2_28, textfield3	 = @textfield3_29, textfield4	 = @textfield4_30, textfield5	 = @textfield5_31, tinyintfield1	 = @tinyintfield1_32, tinyintfield2	 = @tinyintfield2_33, tinyintfield3	 = @tinyintfield3_34, tinyintfield4	 = @tinyintfield4_35, tinyintfield5	 = @tinyintfield5_36, IDCard          = @IDCard_37, isbirthdaynotify   =@isbirthdaynotify_38, birthdaynotifydays =@birthdaynotifydays_39, interest	 = @interest_1, hobby	 = @hobby_1, managerstr	 = @managerstr_1, subordinate	 = @subordinate_1, strongsuit	 = @strongsuit_1, age	 = @age_1, birthday	 = @birthday_1, home	 = @home_1, school	 = @school_1, speciality	 = @speciality_1, nativeplace	 = @nativeplace_1, experience	 = @experience_1 WHERE ( id	 = @id_1)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerContacter_UMain] (@id	 	[int], @main	 	[tinyint], @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE [CRM_CustomerContacter]  SET	 [main]	 = @main  WHERE ( [id]	 = @id)  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmLocations_Delete] (@id_1 	int, @flag integer output, @msg varchar(4000) output ) AS declare @count0 int select @count0=count(*) from HrmLocations a join HrmResource b on a.id=b.locationid and a.id=@id_1 if @count0>0 begin set @flag=2 set @msg='办公地点在使用中' return end DELETE HrmLocations  WHERE  id= @id_1 if @@error<>0 begin set @flag=1 set @msg='插入储存过程失败' return end else begin set @flag=0 set @msg='插入储存过程成功' return end

GO
alter procedure [FnaAccountLog_Update] ( @fnalogid_1 int, @amount_6 decimal(18,3), @projectid_5 int, @flag          integer output, @msg           varchar(4000) output) AS Update FnaAccountLog set amount=@amount_6, projectid = @projectid_5 WHERE id = @fnalogid_1

GO
alter procedure [FnaAccountLog_Insert] ( @feetypeid_1 int, @resourceid_2 int, @departmentid_3 int, @crmid_4 int, @projectid_5 int, @amount_6 decimal(18,3), @description_7 varchar(4000), @occurdate_8 char(10), @releatedid_9 char(10), @releatedname_10 varchar(4000), @iscontractid_1 char(1), @flag          integer output, @msg           varchar(4000) output)  AS INSERT INTO FnaAccountLog ( feetypeid, resourceid, departmentid, crmid, projectid, amount, description, occurdate, releatedid, releatedname, iscontractid )  VALUES ( @feetypeid_1, @resourceid_2, @departmentid_3, @crmid_4, @projectid_5, @amount_6, @description_7, @occurdate_8, @releatedid_9, @releatedname_10, @iscontractid_1 ) select max(id) from FnaAccountLog

GO
alter procedure [Doc_DirAcl_Insert_Type6](@dirid_1 int, @dirtype_1 int, @operationcode_1 int, @subcompanyid_1 int, @seclevel_1 int, @flag int output, @msg varchar(4000) output)  AS insert into DirAccessControlList(dirid, dirtype, subcompanyid, seclevel, operationcode, permissiontype) values(@dirid_1, @dirtype_1, @subcompanyid_1, @seclevel_1, @operationcode_1, 6) if @@error<>0 begin set @flag=1 set @msg='插入目录访问权限主表成功' return end else begin set @flag=0 set @msg='插入目录访问权限主表失败' return end

GO
alter procedure [Doc_DirAcl_Insert_Type5](@dirid_1 int, @dirtype_1 int, @operationcode_1 int, @userid_1 int, @flag int output, @msg varchar(4000) output)  AS insert into DirAccessControlList(dirid, dirtype, userid, operationcode, permissiontype) values(@dirid_1, @dirtype_1, @userid_1, @operationcode_1, 5) if @@error<>0 begin set @flag=1 set @msg='插入目录访问权限主表成功' return end else begin set @flag=0 set @msg='插入目录访问权限主表失败' return end

GO
alter procedure [Doc_DirAcl_Insert_Type4](@dirid_1 int, @dirtype_1 int, @operationcode_1 int, @usertype_1 int, @seclevel_1 int, @flag int output, @msg varchar(4000) output)  AS insert into DirAccessControlList(dirid, dirtype, usertype, seclevel, operationcode, permissiontype) values(@dirid_1, @dirtype_1, @usertype_1, @seclevel_1, @operationcode_1, 4) if @@error<>0 begin set @flag=1 set @msg='插入目录访问权限主表成功' return end else begin set @flag=0 set @msg='插入目录访问权限主表失败' return end

GO
alter procedure [DocImageFile_DByDocfileid] (@docid_1 	int , @imagefileid_2 	int , @flag int output, @msg varchar(4000) output) AS delete from DocImageFile where imagefileid=@imagefileid_2 and docid=@docid_1 update ImageFile set imagefileused=imagefileused-1 where imagefileid = @imagefileid_2 Declare @AccessoryCount int; Select @AccessoryCount = Count(*) From DocImageFile where docid = @docid_1 and docfiletype<>'1'  and docfiletype<>'11' and isextfile = '1' Update Docdetail set accessorycount= @AccessoryCount where id = @docid_1 select filerealpath from  ImageFile where imagefileid=@imagefileid_2 and imagefileused = 0 delete ImageFile where imagefileid=@imagefileid_2 and imagefileused = 0

 GO
alter procedure [Doc_SubCategory_FindByUser_Out] @usertype_1 int, @seclevel_1 int, @operationcode_1 int, @flag	int	output, @msg	varchar(4000) output as if @operationcode_1 = 0 begin select distinct subcategoryid mainid from DocSecCategory where id in ( select distinct dirid from DirAccessControlList where dirtype=2 and operationcode=@operationcode_1 and ((permissiontype=3 and seclevel<=@seclevel_1) or (permissiontype=4 and usertype=@usertype_1 and seclevel<=@seclevel_1)) ) end else if (@operationcode_1 = 1) or (@operationcode_1 = 2) or (@operationcode_1 = 3) begin select distinct id mainid from DocSubCategory where id in ( select distinct dirid from DirAccessControlList where dirtype=1 and operationcode=@operationcode_1 and ((permissiontype=3 and seclevel<=@seclevel_1) or (permissiontype=4 and usertype=@usertype_1 and seclevel<=@seclevel_1)) ) end

GO
alter procedure [Doc_SubCategory_FindByUser] @userid_1 int, @usertype_1 int,@seclevel_1 int, @operationcode_1 int, @departmentid_1 int,@subcompanyid_1 int, @roleid_1 varchar(4000), @flag	int	output, @msg	varchar(4000) output as if @operationcode_1 = 0 begin select distinct subcategoryid mainid from DocSecCategory where id in (select distinct sourceid from DirAccessControlDetail where sourcetype=2  and sharelevel=@operationcode_1 and ((type=1 and content=@departmentid_1 and seclevel<=@seclevel_1) or (type=2 and content in (select * from SplitStr(@roleid_1,',')) and seclevel<=@seclevel_1) or (type=3 and seclevel<=@seclevel_1) or (type=4 and content=@usertype_1 and seclevel<=@seclevel_1) or (type=5 and content=@userid_1) or (type=6 and content=@subcompanyid_1 and seclevel<=@seclevel_1))) end else begin select distinct sourceid mainid from DirAccessControlDetail where sourcetype=1  and sharelevel=@operationcode_1 and ((type=1 and content=@departmentid_1 and seclevel<=@seclevel_1) or (type=2 and  content in (select * from SplitStr(@roleid_1,',')) and seclevel<=@seclevel_1) or (type=3 and seclevel<=@seclevel_1) or (type=4 and content=@usertype_1 and seclevel<=@seclevel_1) or (type=5 and content=@userid_1) or (type=6 and content=@subcompanyid_1 and seclevel<=@seclevel_1)) end

 GO
alter procedure [Doc_SetSecIdsFromOldTable] as declare @subid_1 int declare @secid_1 int declare @secids_1 varchar(4000) declare subcategory_cur cursor for select id from DocSubCategory  open subcategory_cur fetch next from subcategory_cur into @subid_1  while @@fetch_status = 0 begin declare seccategory_cur cursor for select id from DocSecCategory where subcategoryid = @subid_1  set @secids_1 = ''  open seccategory_cur fetch next from seccategory_cur into @secid_1  while @@fetch_status = 0 begin set @secids_1 = @secids_1 + convert(varchar, @secid_1) + ',' fetch next from seccategory_cur into @secid_1 end  close seccategory_cur deallocate seccategory_cur  if @secids_1 <> '' begin set @secids_1 = substring(@secids_1, 1, len(@secids_1)-1) end  update DocSubCategory set seccategoryids = @secids_1 where id = @subid_1  fetch next from subcategory_cur into @subid_1 end  close subcategory_cur deallocate subcategory_cur

GO
alter procedure [Doc_SecCategoryByID] ( @id	int, @flag	int output, @msg	varchar(4000)	output) as select useCustomSearch from docseccategory where id=@id

GO
alter procedure [Doc_SecCategory_Update] ( @id	int, @subcategoryid 	[int], @categoryname 	varchar(4000), @coder	varchar(4000), @docmouldid 	[int], @publishable 	[char](1), @replyable 	[char](1), @shareable 	[char](1), @cusertype 	[int], @cuserseclevel 	[tinyint], @cdepartmentid1 [int], @cdepseclevel1 	[tinyint], @cdepartmentid2 [int], @cdepseclevel2 	[tinyint], @croleid1	[int], @crolelevel1	[char](1), @croleid2	[int], @crolelevel2 	[char](1), @croleid3	[int], @crolelevel3 	[char](1), @hasaccessory	[char](1), @accessorynum	[tinyint], @hasasset	[char](1), @assetlabel	varchar(4000), @hasitems	[char](1), @itemlabel 	varchar(4000), @hashrmres 	[char](1), @hrmreslabel 	varchar(4000), @hascrm	 	[char](1), @crmlabel	varchar(4000), @hasproject 	[char](1), @projectlabel 	varchar(4000), @hasfinance 	[char](1), @financelabel 	varchar(4000), @approveworkflowid	int, @markable  [char](1), @markAnonymity [char](1), @orderable [char](1), @defaultLockedDoc int , @allownModiMShareL int, @allownModiMShareW int, @maxUploadFileSize int, @wordmouldid int, @isSetShare int, @noDownload int, @noRepeatedName int, @isControledByDir int, @pubOperation int, @childDocReadRemind int, @readOpterCanPrint int, @isLogControl char(1), @flag	int output, @msg	varchar(4000)	output) as update docseccategory set subcategoryid=@subcategoryid, categoryname=@categoryname, coder=@coder, docmouldid=@docmouldid, publishable=@publishable, replyable=@replyable, shareable=@shareable, cusertype=@cusertype, cuserseclevel=@cuserseclevel, cdepartmentid1=@cdepartmentid1, cdepseclevel1=@cdepseclevel1, cdepartmentid2=@cdepartmentid2, cdepseclevel2=@cdepseclevel2, croleid1=@croleid1, crolelevel1=@crolelevel1, croleid2=@croleid2, crolelevel2=@crolelevel2, croleid3=@croleid3, crolelevel3=@crolelevel3, approveworkflowid=@approveworkflowid, hasaccessory=@hasaccessory, accessorynum=@accessorynum, hasasset=@hasasset, assetlabel=@assetlabel, hasitems=@hasitems, itemlabel=@itemlabel, hashrmres=@hashrmres, hrmreslabel=@hrmreslabel, hascrm=@hascrm, crmlabel=@crmlabel, hasproject=@hasproject, projectlabel=@projectlabel, hasfinance=@hasfinance, financelabel=@financelabel,markable=@markable ,markAnonymity=@markAnonymity,orderable=@orderable,defaultLockedDoc=@defaultLockedDoc, allownModiMShareL=@allownModiMShareL,allownModiMShareW=@allownModiMShareW ,maxUploadFileSize=@maxUploadFileSize ,wordmouldid=@wordmouldid,isSetShare=@isSetShare, nodownload=@noDownload,norepeatedname=@noRepeatedName,iscontroledbydir=@isControledByDir, puboperation=@pubOperation,childdocreadremind=@childDocReadRemind,readoptercanprint=@readOpterCanPrint,isLogControl=@isLogControl where id=@id

GO
alter procedure [Doc_SecCategory_SelectByID] (@id	int, @flag	int output, @msg	varchar(4000)	output) as select * from docseccategory where id=@id

GO
alter PROCEDURE Doc_SecCategory_Insert_New 
	( @subcategoryid 	int, 
		@categoryname 	varchar(200), 
		@docmouldid 	int, 
		@publishable 	char(1), 
		@replyable 	char(1), 
		@shareable 	char(1), 
		@cusertype 	int, 
		@cuserseclevel 	tinyint, 
		@cdepartmentid1 	int, 
		@cdepseclevel1 	tinyint, 
		@cdepartmentid2 	int, 
		@cdepseclevel2 	tinyint, 
		@croleid1	 		int, 
		@crolelevel1	 	char(1), 
		@croleid2	 	int, 
		@crolelevel2 	char(1), 
		@croleid3	 	int, 
		@crolelevel3 	char(1), 
		@hasaccessory	 	char(1), 
		@accessorynum	 	tinyint, 
		@hasasset		 	char(1), 
		@assetlabel	 	varchar(4000), 
		@hasitems	 	char(1), 
		@itemlabel 	varchar(4000), 
		@hashrmres 	char(1), 
		@hrmreslabel 	varchar(4000), 
		@hascrm	 	char(1), 
		@crmlabel	 	varchar(4000), 
		@hasproject 	char(1), 
		@projectlabel 	varchar(4000), 
		@hasfinance 	char(1), 
		@financelabel 	varchar(4000), 
		@approveworkflowid	int, 
		@markable  char(1), 
		@markAnonymity char(1), 
		@orderable char(1), 
		@defaultLockedDoc int, 
		@allownModiMShareL int, 
		@allownModiMShareW int, 
		@maxUploadFileSize int, 
		@wordmouldid int, 
		@isSetShare int, 
		@noDownload int, 
		@noRepeatedName int, 
		@isControledByDir int, 
		@pubOperation int, 
		@childDocReadRemind int, 
		@readOpterCanPrint int, 
		@isLogControl char(1),
		@subcompanyId int,
		@level int, 
		@parentid int,
		@secorder float,
		@flag	int output, 
		@msg	varchar(4000)	output) as 
		declare @dirid int
		declare @dirtype int
		if @level=1 begin
			set @dirtype = 0
			insert into DocMainCategory(categoryname,categoryiconid,categoryorder,coder,norepeatedname,subcompanyid)
			values(@categoryname,0,@secorder,0,@noRepeatedName,@subcompanyId)
			declare maindir_cursor cursor for
				select MAX(id) from DocMainCategory  where categoryname=@categoryname
			open maindir_cursor
			fetch next from maindir_cursor
			into @dirid
			close maindir_cursor
			deallocate maindir_cursor
		end
		else begin
			if @level=2 begin
				set @dirtype = 1
				declare dirid_cursor cursor for
					select dirid from DocSecCategory where id=@parentid
					open dirid_cursor
					fetch next from dirid_cursor
					into @dirid
				insert into DocSubCategory(categoryname,maincategoryid,subcategoryid,suborder,norepeatedname)
				values(@categoryname,@dirid,-1,@secorder,@noRepeatedName)
				declare subdir_cursor cursor for
					select MAX(id) from DocSubCategory where categoryname=@categoryname
					open subdir_cursor
					fetch next from subdir_cursor
					into @dirid
				close subdir_cursor
				deallocate subdir_cursor
			end
		end
	insert into docseccategory(
		subcategoryid,
		categoryname,
		docmouldid,
		publishable,
		replyable,
		shareable,
		cusertype,
		cuserseclevel,
		cdepartmentid1,
		cdepseclevel1,
		cdepartmentid2,
		cdepseclevel2,
		croleid1,
		crolelevel1,
		croleid2,
		crolelevel2,
		croleid3,
		crolelevel3,
		hasaccessory,
		accessorynum,
		hasasset,
		assetlabel,
		hasitems,
		itemlabel,
		hashrmres,
		hrmreslabel,
		hascrm,
		crmlabel,
		hasproject,
		projectlabel,
		hasfinance,
		financelabel,
		approveworkflowid,
		markable,
		markAnonymity,
		orderable,
		defaultLockedDoc,
		allownModiMShareL,
		allownModiMShareW,
		maxUploadFileSize,
		wordmouldid,
		isSetShare,
		nodownload,
		norepeatedname,
		iscontroledbydir,
		puboperation,
		childdocreadremind,
		readoptercanprint,
		isLogControl,
		subcompanyId,
		parentid,
		dirid,
		dirType
		) 
	values( 
		@subcategoryid, 
		@categoryname, 
		@docmouldid, 
		@publishable, 
		@replyable, 
		@shareable, 
		@cusertype, 
		@cuserseclevel, 
		@cdepartmentid1, 
		@cdepseclevel1, 
		@cdepartmentid2, 
		@cdepseclevel2, 
		@croleid1, 
		@crolelevel1, 
		@croleid2, 
		@crolelevel2, 
		@croleid3, 
		@crolelevel3, 
		@hasaccessory, 
		@accessorynum, 
		@hasasset, 
		@assetlabel, 
		@hasitems, 
		@itemlabel, 
		@hashrmres, 
		@hrmreslabel, 
		@hascrm, 
		@crmlabel, 
		@hasproject, 
		@projectlabel, 
		@hasfinance, 
		@financelabel, 
		@approveworkflowid,
		@markable,
		@markAnonymity,
		@orderable,
		@defaultLockedDoc,
		@allownModiMShareL,
		@allownModiMShareW,
		@maxUploadFileSize,
		@wordmouldid,
		@isSetShare,
		@noDownload,
		@noRepeatedName,
		@isControledByDir,
		@pubOperation,
		@childDocReadRemind,
		@readOpterCanPrint,
		@isLogControl,
		@subcompanyId,
		@parentid,
		@dirid,
		@dirtype
		) 
	select max(id) from docseccategory where categoryname = @categoryname

GO
alter procedure [Doc_SecCategory_Insert] ( @subcategoryid 	int, @categoryname 	varchar(4000), @docmouldid 	int, @publishable 	char(1), @replyable 	char(1), @shareable 	char(1), @cusertype 	int, @cuserseclevel 	tinyint, @cdepartmentid1 	int, @cdepseclevel1 	tinyint, @cdepartmentid2 	int, @cdepseclevel2 	tinyint, @croleid1	 		int, @crolelevel1	 	char(1), @croleid2	 	int, @crolelevel2 	char(1), @croleid3	 	int, @crolelevel3 	char(1), @hasaccessory	 	char(1), @accessorynum	 	tinyint, @hasasset		 	char(1), @assetlabel	 	varchar(4000), @hasitems	 	char(1), @itemlabel 	varchar(4000), @hashrmres 	char(1), @hrmreslabel 	varchar(4000), @hascrm	 	char(1), @crmlabel	 	varchar(4000), @hasproject 	char(1), @projectlabel 	varchar(4000), @hasfinance 	char(1), @financelabel 	varchar(4000), @approveworkflowid	int, @markable  char(1), @markAnonymity char(1), @orderable char(1), @defaultLockedDoc int, @allownModiMShareL int, @allownModiMShareW int, @maxUploadFileSize int, @wordmouldid int, @isSetShare int, @noDownload int, @noRepeatedName int, @isControledByDir int, @pubOperation int, @childDocReadRemind int, @readOpterCanPrint int, @isLogControl char(1), @flag	int output, @msg	varchar(4000)	output) as insert into docseccategory(subcategoryid,categoryname,docmouldid,publishable,replyable,shareable,cusertype,cuserseclevel,cdepartmentid1,cdepseclevel1,cdepartmentid2,cdepseclevel2,croleid1,crolelevel1,croleid2,crolelevel2,croleid3,crolelevel3,hasaccessory,accessorynum,hasasset,assetlabel,hasitems,itemlabel,hashrmres,hrmreslabel,hascrm,crmlabel,hasproject,projectlabel,hasfinance,financelabel,approveworkflowid,markable,markAnonymity,orderable,defaultLockedDoc,allownModiMShareL,allownModiMShareW,maxUploadFileSize,wordmouldid,isSetShare,nodownload,norepeatedname,iscontroledbydir,puboperation,childdocreadremind,readoptercanprint,isLogControl) values( @subcategoryid, @categoryname, @docmouldid, @publishable, @replyable, @shareable, @cusertype, @cuserseclevel, @cdepartmentid1, @cdepseclevel1, @cdepartmentid2, @cdepseclevel2, @croleid1, @crolelevel1, @croleid2, @crolelevel2, @croleid3, @crolelevel3, @hasaccessory, @accessorynum, @hasasset, @assetlabel, @hasitems, @itemlabel, @hashrmres, @hrmreslabel, @hascrm, @crmlabel, @hasproject, @projectlabel, @hasfinance, @financelabel, @approveworkflowid,@markable,@markAnonymity,@orderable,@defaultLockedDoc,@allownModiMShareL,@allownModiMShareW,@maxUploadFileSize,@wordmouldid,@isSetShare,@noDownload,@noRepeatedName,@isControledByDir,@pubOperation,@childDocReadRemind,@readOpterCanPrint,@isLogControl) select max(id) from docseccategory

 GO
alter procedure [Doc_SecCategory_FindByUser_Out](@usertype_1 int, @seclevel_1 int, @operationcode_1 int, @flag int output, @msg varchar(4000) output)  AS  select distinct dirid mainid from DirAccessControlList where dirtype=2 and operationcode=@operationcode_1 and ((permissiontype=3 and seclevel<=@seclevel_1) or (permissiontype=4 and usertype=@usertype_1 and seclevel<=@seclevel_1))  if @@error<>0 begin set @flag=1 set @msg='检查目录访问权限成功' return end else begin set @flag=0 set @msg='检查目录访问权限失败' return end

GO
alter procedure [Doc_SecCategory_FindByUser] @userid_1 int, @usertype_1 int, @seclevel_1 int, @operationcode_1 int, @departmentid_1 int,@subcompanyid_1 int, @roleid_1 varchar(4000), @flag	int	output, @msg	varchar(4000) output as select distinct id mainid from DocSecCategory where id in (select distinct sourceid from DirAccessControlDetail where sourcetype=2  and sharelevel=@operationcode_1 and ((type=1 and content=@departmentid_1 and seclevel<=@seclevel_1) or (type=2 and content in (select * from SplitStr(@roleid_1,',')) and seclevel<=@seclevel_1) or (type=3 and seclevel<=@seclevel_1) or (type=4 and content=@usertype_1 and seclevel<=@seclevel_1) or (type=5 and content=@userid_1) or (type=6 and content=@subcompanyid_1 and seclevel<=@seclevel_1)))

GO
alter procedure [Doc_SecCategory_Delete] (@id	int, @flag	int output, @msg	varchar(4000)	output) as delete from Docseccategory where id=@id

GO
alter procedure [Doc_MainCategory_FindByUser] @userid_1 int, @usertype_1 int,@seclevel_1 int, @operationcode_1 int, @departmentid_1 int,@subcompanyid_1 int, @roleid_1 varchar(4000),@flag	int	output, @msg varchar(4000) output as if @operationcode_1 = 0 begin select 'mainid' = id from DocMainCategory where id in ( select distinct maincategoryid from DocSubCategory where id in ( select distinct subcategoryid from DocSecCategory where id in ( select distinct sourceid from DirAccessControlDetail where sourcetype=2  and sharelevel=@operationcode_1 and ((type=1 and content=@departmentid_1 and seclevel<=@seclevel_1) or (type=2 and content in (select * from SplitStr(@roleid_1,',')) and seclevel<=@seclevel_1) or (type=3 and seclevel<=@seclevel_1) or (type=4 and content=@usertype_1 and seclevel<=@seclevel_1) or (type=5 and content=@userid_1) or (type=6 and content=@subcompanyid_1 and seclevel<=@seclevel_1)) ) ) ) order by categoryorder end else  begin select 'mainid' = id from DocMainCategory where id in ( select distinct sourceid from DirAccessControlDetail where sourcetype=0  and sharelevel=@operationcode_1 and ((type=1 and content=@departmentid_1 and seclevel<=@seclevel_1) or (type=2 and content in (select * from SplitStr(@roleid_1,',')) and seclevel<=@seclevel_1) or (type=3 and seclevel<=@seclevel_1) or (type=4 and content=@usertype_1 and seclevel<=@seclevel_1) or (type=5 and content=@userid_1) or (type=6 and content=@subcompanyid_1 and seclevel<=@seclevel_1)) ) order by categoryorder end

 GO
alter procedure [Doc_MainCategory_FByUser_Out] @usertype_1 int, @seclevel_1 int, @operationcode_1 int, @flag	int	output, @msg varchar(4000) output as if @operationcode_1 = 0 begin select 'mainid' = id from DocMainCategory where id in ( select distinct maincategoryid from DocSubCategory where id in ( select distinct subcategoryid from DocSecCategory where id in ( select distinct dirid from DirAccessControlList where dirtype=2 and operationcode=@operationcode_1 and ((permissiontype=3 and seclevel<=@seclevel_1) or (permissiontype=4 and usertype=@usertype_1 and seclevel<=@seclevel_1)) ) ) ) order by categoryorder end else if (@operationcode_1 = 1) or (@operationcode_1 = 2) or (@operationcode_1 = 3) begin select 'mainid' = id from DocMainCategory where id in ( select distinct dirid from DirAccessControlList where dirtype=0 and operationcode=@operationcode_1 and ((permissiontype=3 and seclevel<=@seclevel_1) or (permissiontype=4 and usertype=@usertype_1 and seclevel<=@seclevel_1)) ) order by categoryorder end

GO
alter procedure [Doc_isUsedCustomSearch] ( @id	int, @flag	int output, @msg	varchar(4000)	output) as select useCustomSearch from docseccategory where id=@id

GO
alter procedure [Doc_GetPermittedCategory_New]( @userid_1 int, @usertype_1 int, @seclevel_1 int, @operationcode_1 int, @departmentid_1 int, @subcompanyid_1 int, @roleid_1 varchar(4000), @categoryname_1 varchar(4000), @flag integer output , @msg varchar(4000) output) as create table #temp(categoryid int, categorytype int, superdirid int, superdirtype int, categoryname varchar(4000), orderid float) declare @secdirid_1 int declare @secdirname_1 varchar(4000) declare @subdirid_1 int, @subdirid1_1 int, @superdirid_1 int, @superdirtype_1 int, @maindirid_1 int declare @subdirname_1 varchar(4000) declare @count_1 int declare @orderid_1 float if @usertype_1 = 0 begin if @categoryname_1 = '' begin declare secdir_cursor cursor for select id mainid, categoryname, subcategoryid,secorder from DocSecCategory where id in (select distinct sourceid from DirAccessControlDetail where sharelevel=@operationcode_1 and ((type=1 and content=@departmentid_1 and seclevel<=@seclevel_1) or (type=2 and  content in (select * from SplitStr(@roleid_1,',')) and seclevel<=@seclevel_1) or (type=3 and seclevel<=@seclevel_1) or (type=4 and content=@usertype_1 and seclevel<=@seclevel_1) or (type=5 and content=@userid_1) or (type=6 and content=@subcompanyid_1 and seclevel<=@seclevel_1))) end else begin declare secdir_cursor cursor for select id mainid, categoryname, subcategoryid,secorder from DocSecCategory where categoryname like '%'+@categoryname_1+'%' and id in (select distinct sourceid from DirAccessControlDetail where sharelevel=@operationcode_1 and ((type=1 and content=@departmentid_1 and seclevel<=@seclevel_1) or (type=2 and  content in (select * from SplitStr(@roleid_1,',')) and seclevel<=@seclevel_1) or (type=3 and seclevel<=@seclevel_1) or (type=4 and content=@usertype_1 and seclevel<=@seclevel_1) or (type=5 and content=@userid_1) or (type=6 and content=@subcompanyid_1 and seclevel<=@seclevel_1))) end end else begin if @categoryname_1 = '' begin declare secdir_cursor cursor for select id mainid, categoryname, subcategoryid,secorder from DocSecCategory where id in (select distinct dirid mainid from DirAccessControlList where dirtype=2 and operationcode=@operationcode_1 and ((permissiontype=3 and seclevel<=@seclevel_1) or (permissiontype=4 and usertype=@usertype_1 and seclevel<=@seclevel_1))) end else begin declare secdir_cursor cursor for select id mainid, categoryname, subcategoryid,secorder from DocSecCategory where categoryname like '%'+@categoryname_1+'%' and  id in (select distinct dirid mainid from DirAccessControlList where dirtype=2 and operationcode=@operationcode_1 and ((permissiontype=3 and seclevel<=@seclevel_1) or (permissiontype=4 and usertype=@usertype_1 and seclevel<=@seclevel_1))) end end open secdir_cursor fetch next from secdir_cursor into @secdirid_1, @secdirname_1, @subdirid_1,@orderid_1 while @@fetch_status = 0 begin insert into #temp values(@secdirid_1, 2, @subdirid_1, 2, @secdirname_1, @orderid_1) fetch next from secdir_cursor into @secdirid_1, @secdirname_1, @subdirid_1,@orderid_1 end close secdir_cursor deallocate secdir_cursor select * from #temp order by orderid,categoryid

GO
alter procedure [Doc_GetPermittedCategory](@userid_1 int, @usertype_1 int, @seclevel_1 int, @operationcode_1 int, @departmentid_1 int,@subcompanyid_1 int, @roleid_1 varchar(4000), @flag integer output , @msg varchar(4000) output) as create table #temp(categoryid int, categorytype int, superdirid int, superdirtype int, categoryname varchar(4000), orderid float) declare @secdirid_1 int declare @secdirname_1 varchar(4000) declare @subdirid_1 int, @subdirid1_1 int, @superdirid_1 int, @superdirtype_1 int, @maindirid_1 int declare @subdirname_1 varchar(4000) declare @count_1 int declare @orderid_1 float if @usertype_1 = 0 begin declare secdir_cursor cursor for select id mainid, categoryname, subcategoryid,secorder from DocSecCategory where id in (select distinct sourceid from DirAccessControlDetail where sharelevel=@operationcode_1 and ((type=1 and content=@departmentid_1 and seclevel<=@seclevel_1) or (type=2 and  content in (select * from SplitStr(@roleid_1,',')) and seclevel<=@seclevel_1) or (type=3 and seclevel<=@seclevel_1) or (type=4 and content=@usertype_1 and seclevel<=@seclevel_1) or (type=5 and content=@userid_1) or (type=6 and content=@subcompanyid_1 and seclevel<=@seclevel_1))) end else begin declare secdir_cursor cursor for select id mainid, categoryname, subcategoryid,secorder from DocSecCategory where id in (select distinct dirid mainid from DirAccessControlList where dirtype=2 and operationcode=@operationcode_1 and ((permissiontype=3 and seclevel<=@seclevel_1) or (permissiontype=4 and usertype=@usertype_1 and seclevel<=@seclevel_1))) end open secdir_cursor fetch next from secdir_cursor into @secdirid_1, @secdirname_1, @subdirid_1,@orderid_1 while @@fetch_status = 0 begin insert into #temp values(@secdirid_1, 2, @subdirid_1, 1, @secdirname_1, @orderid_1) if @subdirid_1 is null set @subdirid_1 = -1 if @subdirid_1 = 0 set @subdirid_1 = -1 while @subdirid_1 <> -1 begin select @subdirid1_1=subcategoryid,@subdirname_1=categoryname,@superdirid_1=subcategoryid,@maindirid_1=maincategoryid,@orderid_1=suborder from DocSubCategory where id = @subdirid_1 if @superdirid_1 = -1 begin set @superdirid_1 = @maindirid_1 set @superdirtype_1 = 0 end else begin set @superdirtype_1 = 1 end set @count_1 = 0 select @count_1=count(categoryid) from #temp where categoryid = @subdirid_1 and categorytype = 1 if @count_1 <= 0 insert into #temp values(@subdirid_1, 1, @superdirid_1, @superdirtype_1, @subdirname_1, @orderid_1) set @subdirid_1 = @subdirid1_1 end fetch next from secdir_cursor into @secdirid_1, @secdirname_1, @subdirid_1, @orderid_1 end close secdir_cursor deallocate secdir_cursor declare maindir_cursor cursor for select id, categoryname, categoryorder from DocMainCategory where id in (select distinct superdirid from #temp where superdirtype = 0) open maindir_cursor fetch next from maindir_cursor into @subdirid_1, @subdirname_1, @orderid_1 while @@fetch_status = 0 begin insert into #temp values(@subdirid_1, 0, -1, -1, @subdirname_1, @orderid_1) fetch next from maindir_cursor into @subdirid_1, @subdirname_1, @orderid_1 end close maindir_cursor deallocate maindir_cursor select * from #temp order by orderid,categoryid

 GO
alter procedure [Doc_GetOrderedFatherSubid](@mainid_1 int, @categorytype_1 int, @flag integer output , @msg varchar(4000) output) as declare @fatherid_1 int, @fatherid1_1 int declare @fathername_1 varchar(4000) declare @orderid_1 int  create table #temp(orderid int, subcategoryid int, subcategoryname varchar(4000)) set @orderid_1 = 0  if @categorytype_1 = 1 begin select @fatherid_1=subcategoryid from DocSubCategory where id = @mainid_1 end else if @categorytype_1 = 2 begin select @fatherid_1=subcategoryid from DocSecCategory where id = @mainid_1 if @fatherid_1 is null set @fatherid_1 = -1 if @fatherid_1 = 0 set @fatherid_1 = -1 end else begin set @fatherid_1 = -1 end  while @fatherid_1 <> -1 begin select @fatherid1_1=subcategoryid,@fathername_1=categoryname from DocSubCategory where id = @fatherid_1 insert into #temp values(@orderid_1, @fatherid_1, @fathername_1) set @fatherid_1 = @fatherid1_1 set @orderid_1 = @orderid_1 + 1 end select orderid, subcategoryid, subcategoryname from #temp order by orderid desc

 GO
alter procedure [Doc_DirAcl_SByDirID] (@dirid_1 int, @dirtype_1 int, @operationcode_1 int, @flag	int output, @msg	varchar(4000)	output) as select * from DirAccessControlList where dirid=@dirid_1 and dirtype=@dirtype_1 and operationcode=@operationcode_1

GO
alter procedure [CRM_CustomerType_SelectByID] (@id int, @flag int	output, @msg varchar(4000) output) AS SELECT t1.*, t2.workflowname AS workflowname FROM CRM_CustomerType t1 LEFT OUTER JOIN workflow_base t2 ON t1.workflowid = t2.id WHERE (t1.id = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_Find_CustomerContacter] (@id	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT id,title,fullname,jobtitle FROM [CRM_CustomerContacter] WHERE (customerid = @id) ORDER BY main DESC,fullname ASC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmCompany_Update] (@id_1 	[tinyint], @companyname_2 	varchar(4000), @companydesc_3 text , @companyweb_4 varchar(4000), @flag integer output, @msg varchar(4000) output )  AS UPDATE [HrmCompany]  SET  [companyname] = @companyname_2 ,companydesc = @companydesc_3, companyweb = @companyweb_4 WHERE ( [id] = @id_1) if @@error<>0 begin set @flag=1 set @msg='	更新储存过程失败' return end else begin set @flag=0 set @msg='	更新储存过程成功' return end

GO
alter procedure [HrmCompany_Select] @flag integer output , @msg varchar(4000) output AS select * from HrmCompany set  @flag = 0 set  @msg = '操作成功完成'

GO
alter procedure [MailResourceFile_SByBackup] (@mailid_1 	int, @flag int output, @msg varchar(4000) output)  AS select mailid , filerealpath from MailResourceFile where mailid > @mailid_1 and ( filerealpath is not null or filerealpath <> '' ) order by mailid

GO
alter procedure [MailResourceFile_Insert]( @mailid_1 	int, @filename_2 	varchar(4000), @filetype_3 	varchar(4000), @filerealpath_4 	varchar(4000), @iszip_5 char(1) , @isencrypt_6 	char(1) , @isfileattrachment_7 	char(1) , @fileContentId_8 	varchar(4000) , @isEncoded_9 char(1), @filesize_10 int, @flag int output, @msg varchar(4000) output ) AS INSERT INTO MailResourceFile ( mailid, filename, filetype, filerealpath, iszip, isencrypt, isfileattrachment, fileContentId, isEncoded, filesize )VALUES( @mailid_1, @filename_2, @filetype_3, @filerealpath_4, @iszip_5 , @isencrypt_6, @isfileattrachment_7, @fileContentId_8, @isEncoded_9, @filesize_10 )

GO
alter procedure [MailResourceContentUpdate]( @mailid int, @content text, @flag int output, @msg varchar(4000) output ) as update MailResource set hasHtmlImage='1',content=@content where id=@mailid

GO
alter procedure [MailResource_UpdateMailtype] (@mailid_1  integer, @mailtype_2  char(1), @flag	[int]	output, @msg	varchar(4000)	output) AS update MailResource set mailtype = @mailtype_2 where id = @mailid_1

GO
alter procedure [MailResource_Update] ( @id_1        int, @resourceid_2 	int, @priority_3 	char(1), @sendfrom_4 	varchar(4000), @sendcc_5 	varchar(4000), @sendbcc_6 	varchar(4000), @sendto_7 	varchar(4000), @senddate_8 	varchar(4000), @size_9 	int, @subject_10 	varchar(4000), @content_11 	text, @mailtype_12	char(1) , @hasHtmlImage_13	char(1) , @mailAccountId_14 int, @status_15 char(1), @folderId_16 int, @flag	int	output, @msg	varchar(4000)	output ) AS update MailResource set resourceid=@resourceid_2, priority=@priority_3, sendfrom=@sendfrom_4, sendcc=@sendcc_5, sendbcc=@sendbcc_6, sendto=@sendto_7, senddate=@senddate_8, size_n=@size_9, subject=@subject_10, content=@content_11, mailtype=@mailtype_12, hasHtmlImage=@hasHtmlImage_13, mailAccountId=@mailAccountId_14, status=@status_15, folderId=@folderId_16 where  id=@id_1;

GO
alter procedure [MailResource_SelectCount] (@resourceid_1  integer, @flag	[int]	output, @msg	varchar(4000)	output) AS declare @localcount integer , @draftcount integer, @deletecount integer , @sendcount integer  select @localcount = count(*) from MailResource where mailtype = '0' and resourceid = @resourceid_1 select @sendcount = count(*) from MailResource where mailtype = '1' and resourceid = @resourceid_1 select @draftcount = count(*) from MailResource where mailtype = '2' and resourceid = @resourceid_1 select @deletecount = count(*) from MailResource where mailtype = '3' and resourceid = @resourceid_1  select @localcount,@sendcount,@draftcount,@deletecount

GO
alter procedure [MailResource_Insert] ( @resourceid_2 	[int], @priority_3 	[char](1), @sendfrom_4 	varchar(4000), @sendcc_5 	varchar(4000), @sendbcc_6 	varchar(4000), @sendto_7 	varchar(4000), @senddate_8 	varchar(4000), @size_9 	[int], @subject_10 	varchar(4000), @content_11 	[text], @mailtype_12	[char](1) , @hasHtmlImage_13	[char](1) , @mailAccountId_14 int, @status_15 char(1), @folderId_16 int, @flag	[int]	output, @msg	varchar(4000)	output) AS INSERT INTO [MailResource] ([resourceid], [priority], [sendfrom], [sendcc], [sendbcc], [sendto], [senddate], [size_n], [subject], [content], mailtype, [hasHtmlImage], mailAccountId, status, folderId) VALUES (@resourceid_2, @priority_3, @sendfrom_4, @sendcc_5, @sendbcc_6, @sendto_7, @senddate_8, @size_9, @subject_10, @content_11, @mailtype_12, @hasHtmlImage_13, @mailAccountId_14, @status_15, @folderId_16) select max(id) from MailResource where resourceid = @resourceid_2

GO
alter procedure [MailResource_Delete] (@mailid_1  integer, @flag	[int]	output, @msg	varchar(4000)	output) AS select filerealpath from MailResourceFile where mailid = @mailid_1 delete from MailResourceFile where mailid = @mailid_1 delete from MailResource where id = @mailid_1

GO
alter procedure [workflow_base_SelectByType] @workflowtypeid	int, @flag integer output , @msg varchar(4000) output AS select * from workflow_base where workflowtype=@workflowtypeid

GO
alter procedure [workflow_base_SelectByFormid] (@formid	int, @isbill	char(1), @flag integer output, @msg varchar(4000) output) AS select * from workflow_base where formid=@formid and isbill=@isbill

GO
alter procedure [importexpense] as Declare @relatedcrm_1 int, @relatedprj_1 int, @organizationid_1 int, @occurdate_1 char(10), @amount_1 decimal(15,3), @subject_1 int, @requestid_1 int, @description_1 varchar(4000), @all_cursor cursor SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select feetypeid,resourceid,crmid,projectid,amount,occurdate,releatedid,description from FnaAccountLog where iscontractid=0 or iscontractid is null OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @subject_1,@organizationid_1,@relatedcrm_1,@relatedprj_1,@amount_1,@occurdate_1,@requestid_1,@description_1 WHILE @@FETCH_STATUS = 0 begin insert into fnaexpenseinfo(subject,organizationtype,organizationid,relatedcrm,relatedprj,amount,occurdate,requestid,status,type,description) values(@subject_1,3,@organizationid_1,@relatedcrm_1,@relatedprj_1,@amount_1,@occurdate_1,@requestid_1,1,2,@description_1) FETCH NEXT FROM @all_cursor INTO @subject_1,@organizationid_1,@relatedcrm_1,@relatedprj_1,@amount_1,@occurdate_1,@requestid_1,@description_1 end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [IDirAccessControlDetailP] as declare  @id_1         integer; declare  @dirid_1         integer; declare  @dirtype_1      integer; declare  @seclevel_1     integer declare  @departmentid_1      integer; declare  @subcompanyid_1      integer; declare  @userid_1            integer; declare  @usertype_1        integer; declare  @sharelevel_1       integer; declare  @roleid_1            integer; declare  @rolelevel_1         integer; declare  @permissiontype_1  integer; declare  @operationcode_1 integer; declare  @docSecCategoryTemplateId_1 integer; declare @sourceid_1           integer; declare  @type_1		    integer; declare  @content_1		    integer; declare  @sourcetype_1        integer; declare  @srcfrom_1        integer; begin DELETE from DirAccessControlDetail ; declare share_cursor cursor for select mainid,dirid, dirtype, seclevel, userid, subcompanyid, departmentid, usertype, roleid, rolelevel, operationcode,permissiontype, DocSecCategoryTemplateId from DirAccessControlList where dirtype >0 and dirid >0 open share_cursor fetch next from share_cursor into @id_1,@dirid_1,@dirtype_1,@seclevel_1,@userid_1,@subcompanyid_1,@departmentid_1,@usertype_1,@roleid_1,@rolelevel_1,@operationcode_1,@permissiontype_1,@DocSecCategoryTemplateId_1 while @@fetch_status=0 begin set	@srcfrom_1 = @id_1; set	@sourceid_1= @dirid_1; set	@sourcetype_1= @dirtype_1; set	@type_1= @permissiontype_1; set	@sharelevel_1 = @operationcode_1; if @type_1=1 set @content_1 = @departmentid_1; else if @type_1=2 set @content_1 =  convert( integer,( convert(varchar(4000),@roleid_1) + convert(varchar(4000),@rolelevel_1)));  else if @type_1=3 begin set @seclevel_1 = @seclevel_1; set @content_1 = 0; end else if @type_1=4 set  @content_1 = @usertype_1; else if @type_1=5 begin set  @content_1 = @userid_1; set  @seclevel_1 = 0; end else if @type_1=6 set @content_1 = @subcompanyid_1; insert into DirAccessControlDetail ( sourceid, type, content, seclevel, sharelevel, sourcetype, srcfrom )values( @sourceid_1, @type_1, @content_1, @seclevel_1, @sharelevel_1, @sourcetype_1, @srcfrom_1 ) if @rolelevel_1 = 0 begin set @content_1=convert( integer,( convert(varchar(4000),@roleid_1) + convert(varchar(4000),1))); insert into DirAccessControlDetail ( sourceid, type, content, seclevel, sharelevel, sourcetype, srcfrom )values( @sourceid_1, @type_1, @content_1, @seclevel_1, @sharelevel_1, @sourcetype_1, @srcfrom_1 ) set @content_1=convert( integer,( convert(varchar(4000),@roleid_1) + convert(varchar(4000),2))); insert into DirAccessControlDetail ( sourceid, type, content, seclevel, sharelevel, sourcetype, srcfrom )values( @sourceid_1, @type_1, @content_1, @seclevel_1, @sharelevel_1, @sourcetype_1, @srcfrom_1 ) end else if @rolelevel_1=1 begin set @content_1=convert( integer,( convert(varchar(4000),@roleid_1) + convert(varchar(4000),2))); insert into DirAccessControlDetail ( sourceid, type, content, seclevel, sharelevel, sourcetype, srcfrom )values( @sourceid_1, @type_1, @content_1, @seclevel_1, @sharelevel_1, @sourcetype_1, @srcfrom_1 ) end fetch next from share_cursor into @id_1, @dirid_1,@dirtype_1,@seclevel_1,@userid_1,@subcompanyid_1,@departmentid_1,@usertype_1,@roleid_1,@rolelevel_1,@operationcode_1,@permissiontype_1,@DocSecCategoryTemplateId_1; end close share_cursor deallocate share_cursor end

GO
alter procedure [Workflow_DetailField_Select] ( @userId INT, @requestId INT, @formId INT, @groupId INT, @flag INTEGER OUTPUT, @msg varchar(4000) OUTPUT )  AS  SELECT A.*, B.* FROM ( SELECT workFlowFormField.fieldId, workFlowFormField.fieldOrder, workFlowFieldLable.fieldLable, workFlowFieldLable.langurageId, workFlowFormDictDetail.fieldName, workFlowFormDictDetail.fieldDBType, workFlowFormDictDetail.fieldHtmlType, workFlowFormDictDetail.type FROM WorkFlow_FormField workflowFormField, WorkFlow_FieldLable workflowFieldLable, WorkFlow_FormDictDetail workflowFormDictDetail WHERE workflowFormField.formID = @formId AND workflowFormField.fieldId = workflowFieldLable.fieldId AND workflowFormField.formId = workflowFieldLable.formId AND workflowFormField.fieldId = workflowFormDictDetail.Id AND workflowFormField.isDetail = '1' AND workflowFormField.groupId = @groupId ) A, ( SELECT workflowNodeForm.fieldId, max(workflowNodeForm.isView) isView, max(workflowNodeForm.isEdit) isEdit, max(workflowNodeForm.isMandatory) isMandatory FROM WorkFlow_NodeForm workflowNodeForm WHERE EXISTS ( SELECT 1 FROM Workflow_CurrentOperator workflowCurrentOperator WHERE workflowNodeForm.nodeId = workflowCurrentOperator.nodeId AND workflowCurrentOperator.requestId = @requestId AND workflowCurrentOperator.userId = @userId ) GROUP BY workflowNodeForm.fieldId ) B WHERE A.fieldID = B.fieldId ORDER BY A.fieldOrder

GO
alter procedure [workflow_FieldForm_Select] ( @nodeid1	int , @flag integer output , @msg varchar(4000) output ) AS declare @isbill1 char(1)  select @isbill1 = a.isbill from workflow_base a, workflow_flownode b where a.id = b.workflowid and b.nodeid = @nodeid1  if @isbill1 = '1' SELECT distinct a.* , b.dsporder from workflow_nodeform a, workflow_billfield b where a.fieldid= b.id and  nodeid=@nodeid1 order by b.dsporder else SELECT * from workflow_nodeform  where  nodeid=@nodeid1 order by fieldid

 GO
alter procedure [workflow_field6_SByWfid] (@workflowid 	int, @flag integer output, @msg varchar(4000) output) AS select c.fieldname from workflow_base a, workflow_formfield b, workflow_formdict c where a.formid=b.formid and a.isbill=0 and b.fieldid=c.id and c.fieldhtmltype=6 and a.id=@workflowid

GO
alter procedure [workflow_currentoperator_SWft] @userid		int, @usertype	int, @flag integer output , @msg varchar(4000) output as select count(distinct t1.requestid) typecount,t1.workflowtype , t2.currentnodetype from workflow_currentoperator t1,workflow_requestbase t2 where t1.userid=@userid  and t1.usertype=@usertype and t1.isremark in( '0','1') and t1.requestid=t2.requestid and ( t2.deleted=0 or t2.deleted is null ) group by t1.workflowtype , t2.currentnodetype

  GO
alter procedure [workflow_currentoperator_SWf] @userid		int, @usertype	int, @flag integer output , @msg varchar(4000) output as select count( distinct t1.requestid) workflowcount,t1.workflowid , t2.currentnodetype from workflow_currentoperator t1,workflow_requestbase t2 where t1.isremark in( '0','1') and t1.userid=@userid and t1.usertype=@usertype and t1.requestid=t2.requestid and ( t2.deleted=0 or t2.deleted is null ) group by t1.workflowid , t2.currentnodetype order by t1.workflowid

GO
alter procedure [workflow_currentoperator_SByUs] @userid		int, @usertype		int, @requestid	int, @flag integer output , @msg varchar(4000) output as select * from workflow_currentoperator where requestid=@requestid and userid=@userid and usertype = @usertype

GO
alter procedure [Workflow_currentoperator_I2]( @requestid        INT, @userid           INT, @groupid          INT, @workflowid       INT, @workflowtype     INT, @usertype         INT, @isremark         CHAR(1), @nodeid           INT, @agentorbyagentid INT, @agenttype        CHAR(1), @showorder        INT, @groupdetailid    INT, @currentdate      CHAR(10), @currenttime      CHAR(8), @flag             INTEGER output, @msg              varchar(4000) output) AS DECLARE @workflowtype1 INTEGER  UPDATE workflow_currentoperator SET    islasttimes = 0 WHERE  requestid = @requestid AND userid = @userid AND usertype = @usertype  IF @workflowtype = '' BEGIN SELECT @workflowtype1 = workflowtype FROM   workflow_base WHERE  id = @workflowid  INSERT INTO workflow_currentoperator (requestid, userid, groupid, workflowid, workflowtype, usertype, isremark, nodeid, agentorbyagentid, agenttype, showorder, receivedate, receivetime, viewtype, iscomplete, islasttimes, groupdetailid, preisremark, needwfback) VALUES      (@requestid, @userid, @groupid, @workflowid, @workflowtype1, @usertype, @isremark, @nodeid, @agentorbyagentid, @agenttype, @showorder, @currentdate, @currenttime, 0, 0, 1, @groupdetailid, @isremark, '1') END ELSE BEGIN INSERT INTO workflow_currentoperator (requestid, userid, groupid, workflowid, workflowtype, usertype, isremark, nodeid, agentorbyagentid, agenttype, showorder, receivedate, receivetime, viewtype, iscomplete, islasttimes, groupdetailid, preisremark, needwfback) VALUES      (@requestid, @userid, @groupid, @workflowid, @workflowtype, @usertype, @isremark, @nodeid, @agentorbyagentid, @agenttype, @showorder, @currentdate, @currenttime, 0, 0, 1, @groupdetailid, @isremark, '1') END

GO
alter procedure [workflow_CurrentOperator_I]( @requestid  int, @userid int, @groupid   int, @workflowid    int, @workflowtype  int, @usertype  int, @isremark  char(1), @nodeid  int,@agentorbyagentid  int,@agenttype  char(1),@showorder int, @groupdetailid int, @flag integer output , @msg varchar(4000) output) AS declare @workflowtype1 integer, @receivedate char(10), @receivetime char(8)  set @receivedate=convert(char(10),getdate(),20) set @receivetime=convert(char(8),getdate(),108)  update workflow_currentoperator set islasttimes=0 where requestid=@requestid and userid=@userid and usertype = @usertype  if @workflowtype = '' begin select @workflowtype1 = workflowtype from workflow_base where id = @workflowid insert into workflow_currentoperator(requestid,userid,groupid, workflowid,workflowtype,usertype,isremark,nodeid,agentorbyagentid,agenttype,showorder,receivedate,receivetime,viewtype,iscomplete,islasttimes,groupdetailid,preisremark,needwfback) values (@requestid,@userid,@groupid, @workflowid,@workflowtype1,@usertype,@isremark,@nodeid,@agentorbyagentid,@agenttype,@showorder,@receivedate,@receivetime,0,0,1,@groupdetailid,@isremark,'1') end else begin insert into workflow_currentoperator(requestid,userid,groupid, workflowid,workflowtype,usertype,isremark,nodeid,agentorbyagentid,agenttype,showorder,receivedate,receivetime,viewtype,iscomplete,islasttimes,groupdetailid,preisremark,needwfback) values (@requestid,@userid,@groupid, @workflowid,@workflowtype,@usertype,@isremark,@nodeid,@agentorbyagentid,@agenttype,@showorder,@receivedate,@receivetime,0,0,1,@groupdetailid,@isremark,'1') end

GO
alter procedure [workflow_CurrentOperator_Copy] (@requestid  	int, @userid     	int, @usertype  	int, @flag integer output , @msg varchar(4000) output) AS declare @operatedate char(10), @operatetime char(8)  ,@isremark char(1),@nodetype char(1) set @operatedate=convert(char(10),getdate(),20) set @operatetime=convert(char(8),getdate(),108) set @isremark='2' select @nodetype=currentnodetype from workflow_requestbase where requestid= @requestid if @nodetype is null  set @nodetype='0' if @nodetype='3'  set @isremark='4'  update workflow_currentoperator set isremark=@isremark,operatedate=@operatedate,operatetime=@operatetime where requestid=@requestid and userid=@userid and usertype=@usertype and isremark in('1','7','8')

GO
alter procedure [workflow_Rbase_UpdateLevel] @requestid	int, @level_n        int, @flag integer output , @msg varchar(4000) output AS Update workflow_requestbase set requestlevel=@level_n where requestid=@requestid

GO
alter procedure [workflow_NodeLink_SPasstime] @nodeid	int, @nodepasstime	float, @flag integer output , @msg varchar(4000) output AS select min(nodepasstime) as nodepasstime from workflow_nodelink where nodeid=@nodeid and nodepasstime>@nodepasstime

GO
alter procedure [workflow_NodeLink_Select_ND] @workflowid int , @nodeid	int, @isreject	char(1),@requestid int, @flag integer output , @msg varchar(4000) output AS if @isreject<>'1'  set @isreject='' select * from workflow_nodelink where workflowid=@workflowid and nodeid=@nodeid and isreject=@isreject and EXISTS (select 1 from workflow_nodebase b where workflow_nodelink.destnodeid=b.id and ((b.requestid=@requestid and b.IsFreeNode='1') or (b.IsFreeNode is null or b.IsFreeNode!='1'))) order by nodepasstime ,id

GO
alter procedure [workflow_NodeLink_Select] @nodeid	int, @isreject	char(1),@requestid int, @flag integer output , @msg varchar(4000) output AS if @isreject<>'1'  set @isreject='' select * from workflow_nodelink where nodeid=@nodeid and isreject=@isreject and EXISTS (select 1 from workflow_nodebase b where workflow_nodelink.destnodeid=b.id and ((b.requestid=@requestid and b.IsFreeNode='1') or (b.IsFreeNode is null or b.IsFreeNode!='1'))) order by nodepasstime ,id

GO
alter procedure [wrkcrt_mutidel] (@flag integer output, @msg varchar(4000) output ) as declare @requestid_1 integer,@userid_1 integer,@isremark_1 integer,@isremark_2 integer, @groupid_1 integer,@workflowid_1 integer,@workflowtype_1 integer  delete from workflow_requestViewLog where (convert(varchar(4000),id)+','+convert(varchar(4000),currentnodeid)) in ( select (convert(varchar(4000),a.id)+','+convert(varchar(4000),a.currentnodeid)) from workflow_requestViewLog a, workflow_requestbase b where a.currentnodeid != b.currentnodeid and a.id = b.requestid )

GO
alter procedure [workflow_Requestbase_Delete] @requestid	int, @flag integer output , @msg varchar(4000) output as update workflow_requestbase set deleted=1 where requestid=@requestid

GO
alter procedure [workflow_requestbase_SWftype] @userid		int, @usertype	int, @complete	int, @flag integer output , @msg varchar(4000) output  as  if @complete=0 begin select count(distinct t1.requestid) typecount,t2.workflowtype from workflow_requestbase t1, workflow_base t2 where t1.creater = @userid and t1.creatertype=@usertype and t1.workflowid=t2.id and t1.deleted=0 and t1.currentnodetype<>'3' group by t2.workflowtype end  if @complete=1 begin select count(distinct t1.requestid) typecount,t2.workflowtype from workflow_requestbase t1, workflow_base t2 where t1.creater = @userid and t1.creatertype=@usertype and t1.workflowid=t2.id and t1.deleted=0 and t1.currentnodetype='3' group by t2.workflowtype end

GO
alter procedure [workflow_requestbase_SelectWf] @userid		int, @usertype	int, @complete	int, @flag integer output , @msg varchar(4000) output as  if @complete=0 begin select count( distinct requestid) workflowcount, workflowid from workflow_requestbase where creater = @userid and creatertype = @usertype and deleted=0 and currentnodetype<>'3' group by workflowid end  if @complete=1 begin select count( distinct requestid) workflowcount, workflowid from workflow_requestbase where creater = @userid and creatertype = @usertype and deleted=0 and currentnodetype='3' group by workflowid end

GO
alter procedure [workflow_requestbase_Select] @userid		int, @wftype	int, @workflowid	int, @complete	int, @flag integer output , @msg varchar(4000) output AS if @wftype<>0 begin if @complete=0 select distinct t1.requestid,t1.requestname,t1.workflowid,t1.lastoperatedate,t1.lastoperatetime,t1.lastoperator,t1.status,t1.createdate,t1.createtime from workflow_requestbase t1,workflow_currentoperator t2 where t2.userid=@userid and t1.requestid=t2.requestid and t2.workflowtype=@wftype and t2.isremark in ('0','1') and t1.deleted=0 and t1.currentnodetype<>'3' order by t1.createdate desc,t1.createtime desc if @complete=1 select distinct t1.requestid,t1.requestname,t1.workflowid,t1.lastoperatedate,t1.lastoperatetime,t1.lastoperator,t1.status,t1.createdate,t1.createtime from workflow_requestbase t1,workflow_currentoperator t2 where t2.userid=@userid and t1.requestid=t2.requestid and t2.workflowtype=@wftype and t2.isremark='0' and t1.deleted=0 and t1.currentnodetype='3' order by t1.createdate desc,t1.createtime desc end else if @wftype=0 and @workflowid<>0 begin if @complete=0 select distinct t1.requestid,t1.requestname,t1.workflowid,t1.lastoperatedate,t1.lastoperatetime,t1.lastoperator,t1.status,t1.createdate,t1.createtime from workflow_requestbase t1,workflow_currentoperator t2 where t2.userid=@userid and t1.requestid=t2.requestid and t2.workflowid=@workflowid and t2.isremark in ('0','1') and t1.deleted=0 and t1.currentnodetype<>'3' order by t1.createdate desc,t1.createtime desc if @complete=1 select distinct t1.requestid,t1.requestname,t1.workflowid,t1.lastoperatedate,t1.lastoperatetime,t1.lastoperator,t1.status,t1.createdate,t1.createtime from workflow_requestbase t1,workflow_currentoperator t2 where t2.userid=@userid and t1.requestid=t2.requestid and t2.workflowid=@workflowid and t2.isremark='0' and t1.deleted=0 and t1.currentnodetype='3' order by t1.createdate desc,t1.createtime desc end

GO
alter procedure [workflow_requestbase_SByUser] @userid		int, @wftype	int, @workflowid	int, @complete	int, @flag integer output , @msg varchar(4000) output AS  if @wftype<>0 begin  if @complete=0  select  t1.* from workflow_requestbase t1,workflow_base t2 where t1.creater = @userid and t1.workflowid=t2.id and t2.workflowtype = @wftype and t1.deleted=0 and t1.currentnodetype<>'3' order by t1.createdate desc,t1.createtime desc  if @complete=1 select  t1.* from workflow_requestbase t1,workflow_base t2 where t1.creater = @userid and t1.workflowid=t2.id and t2.workflowtype = @wftype and t1.deleted=0 and t1.currentnodetype= '3' order by t1.createdate desc,t1.createtime desc  end  else if @wftype=0 and @workflowid<>0 begin  if @complete=0 select * from workflow_requestbase where creater = @userid and workflowid = @workflowid and deleted=0 and currentnodetype<>'3' order by createdate desc,createtime desc  if @complete=1 select * from workflow_requestbase where creater = @userid and workflowid = @workflowid and deleted=0 and currentnodetype='3' order by createdate desc,createtime desc  end

GO
alter procedure [workflow_Requestbase_SByID] @requestid	int, @flag integer output , @msg varchar(4000) output AS select * from workflow_requestbase where requestid=@requestid

GO
alter procedure [workflow_requestbase_MyRequest] @userid		int, @usertype	int, @flag integer output , @msg varchar(4000) output as   select count(distinct t1.requestid) typecount,t2.workflowtype ,t1.workflowid,t1.currentnodetype from workflow_requestbase t1, workflow_base t2 where t1.creater = @userid and t1.creatertype=@usertype and t1.workflowid=t2.id  and t2.isvalid='1' and exists (select 1 from workflow_currentoperator where workflow_currentoperator.requestid=t1.requestid) group by t2.workflowtype,t1.workflowid,t1.currentnodetype

GO
alter procedure [workflow_Requestbase_Insert] @requestid        INT, @workflowid       INT, @lastnodeid       INT, @lastnodetype     CHAR(1), @currentnodeid    INT, @currentnodetype  CHAR(1), @status           varchar(4000), @passedgroups     INT, @totalgroups      INT, @requestname      varchar(4000), @creater          INT, @createdate       CHAR(10), @createtime       CHAR(8), @lastoperator     INT, @lastoperatedate  CHAR(10), @lastoperatetime  CHAR(8), @deleted          INT, @creatertype      INT, @lastoperatortype INT, @nodepasstime     FLOAT, @nodelefttime     FLOAT, @docids           [text], @crmids           [text], @hrmids           [text], @prjids           [text], @cptids           [text], @messageType      INT, @flag             INTEGER OUTPUT, @msg              varchar(4000) OUTPUT AS EXEC [workflow_Requestbase_InsertNew]  @requestid , @workflowid , @lastnodeid , @lastnodetype , @currentnodeid , @currentnodetype , @status , @passedgroups , @totalgroups , @requestname , @creater , @createdate , @createtime , @lastoperator , @lastoperatedate , @lastoperatetime , @deleted , @creatertype , @lastoperatortype , @nodepasstime , @nodelefttime , @docids , @crmids , @hrmids , @prjids , @cptids , @messageType , null , @flag , @msg

GO
alter procedure [CRM_Info_SelectCountByResource] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select count(*) from CRM_CustomerInfo where (deleted is null or deleted<>1) and manager = @id_1 if @@error<>0 begin set @flag=1 set @msg='查询人力资源文档总数信息成功' return end else begin set @flag=0 set @msg='查询人力资源文档总数信息失败' return end

 GO
alter procedure [CRM_CustomerType_Delete] (@id [int], @flag [int]	output, @msg varchar(4000) output) AS IF EXISTS(SELECT id FROM CRM_CustomerInfo WHERE type = @id) BEGIN SELECT -1 RETURN END DELETE [CRM_CustomerType] WHERE ( [id] = @id) set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [CRM_CustomerSize_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS IF EXISTS(SELECT id FROM CRM_CustomerInfo WHERE size_n = @id) BEGIN SELECT -1 RETURN END DELETE [CRM_CustomerSize] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [CRM_ContactWay_Delete] ( @id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS IF EXISTS(SELECT id FROM CRM_CustomerInfo WHERE source = @id) BEGIN SELECT -1 RETURN END DELETE [CRM_ContactWay] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [Doc_DirAcl_InsertFromOldTable] as  declare @secid_1 int, @usertype_1 int, @seclevel_1 int declare @department1_1 int, @dseclevel1_1 int, @department2_1 int, @dseclevel2_1 int declare @roleid1_1 int, @rolelevel1_1 int, @roleid2_1 int, @rolelevel2_1 int, @roleid3_1 int, @rolelevel3_1 int declare oldpermission_cursor cursor for select id,cusertype,cuserseclevel,cdepartmentid1,cdepseclevel1,cdepartmentid2,cdepseclevel2,croleid1,crolelevel1,croleid2,crolelevel2,croleid3,crolelevel3 from DocSecCategory  open oldpermission_cursor fetch next from oldpermission_cursor into @secid_1, @usertype_1, @seclevel_1, @department1_1, @dseclevel1_1, @department2_1, @dseclevel2_1, @roleid1_1, @rolelevel1_1, @roleid2_1, @rolelevel2_1, @roleid3_1, @rolelevel3_1  while @@fetch_status=0 begin execute Doc_DirAcl_Insert_Type4 @secid_1,2,0,@usertype_1,@seclevel_1,1,1 if not (@department1_1=0) begin execute Doc_DirAcl_Insert_Type1 @secid_1,2,0,@department1_1,@dseclevel1_1,1,1 end if not (@department2_1=0) begin execute Doc_DirAcl_Insert_Type1 @secid_1,2,0,@department2_1,@dseclevel2_1,1,1 end if not (@roleid1_1=0) begin execute Doc_DirAcl_Insert_Type2 @secid_1,2,0,@roleid1_1,@rolelevel1_1,0,1,1 end if not (@roleid2_1=0) begin execute Doc_DirAcl_Insert_Type2 @secid_1,2,0,@roleid2_1,@rolelevel2_1,0,1,1 end if not (@roleid3_1=0) begin execute Doc_DirAcl_Insert_Type2 @secid_1,2,0,@roleid3_1,@rolelevel3_1,0,1,1 end  fetch next from oldpermission_cursor into @secid_1, @usertype_1, @seclevel_1, @department1_1, @dseclevel1_1, @department2_1, @dseclevel2_1, @roleid1_1, @rolelevel1_1, @roleid2_1, @rolelevel2_1, @roleid3_1, @rolelevel3_1 end  close oldpermission_cursor deallocate oldpermission_cursor

  GO
alter procedure  [DocMark_Insert]( @docId int , @markHrmType int , @markHrmId int, @mark int, @remark varchar(4000), @markDate char(10), @flag integer output , @msg varchar(4000) output ) AS insert into  DocMark(docId,markHrmType,markHrmId,mark,remark,markDate) values (@docId,@markHrmType,@markHrmId,@mark,@remark,@markDate) select max(id) from  DocMark

GO
alter procedure [DocUserCategory_InsertByUser] @userid	int, @usertype char(1), @flag	int	output, @msg	varchar(4000) output as declare	@mainid	int, @subid	int, @secid	int, @seclevel	tinyint, @crmtype	int, @all_cursor cursor  delete from DocUserCategory where userid=@userid and usertype=@usertype  if @usertype='0' begin SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select distinct t1.id from docseccategory t1,hrmresource t2,hrmrolemembers t5 where t1.cusertype='0' and t2.id=@userid and(( t2.seclevel>=t1.cuserseclevel) or( t2.seclevel >= t1.cdepseclevel1 and t2.departmentid=t1.cdepartmentid1) or( t2.seclevel >= t1.cdepseclevel2 and t2.departmentid=t1.cdepartmentid2) or( t5.roleid=t1.croleid1 and t5.rolelevel=t1.crolelevel1 and t2.id=t5.resourceid ) or( t5.roleid=t1.croleid2 and t5.rolelevel=t1.crolelevel2 and t2.id=t5.resourceid ) or( t5.roleid=t1.croleid3 and t5.rolelevel=t1.crolelevel3 and t2.id=t5.resourceid )) OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @secid WHILE @@FETCH_STATUS = 0 begin select @subid=subcategoryid from docseccategory where id=@secid select @mainid=maincategoryid from docsubcategory where id=@subid insert into  docusercategory (secid,mainid,subid,userid,usertype) values (@secid,@mainid,@subid,@userid,@usertype) FETCH NEXT FROM @all_cursor INTO @secid end CLOSE @all_cursor DEALLOCATE @all_cursor end else begin select @crmtype=type,@seclevel=seclevel from crm_customerinfo where id=@userid SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from DocSecCategory where cusertype=@crmtype and cuserseclevel<=@seclevel OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @secid WHILE @@FETCH_STATUS = 0 begin select @subid=subcategoryid from docseccategory where id=@secid select @mainid=maincategoryid from docsubcategory where id=@subid insert into  docusercategory (secid,mainid,subid,userid,usertype) values (@secid,@mainid,@subid,@userid,@usertype) FETCH NEXT FROM @all_cursor INTO @secid end CLOSE @all_cursor DEALLOCATE @all_cursor end

 GO
alter procedure [DocUserCategory_IByCategory] @secid	int, @flag	int	output, @msg	varchar(4000) output as declare	@mainid	int, @subid	int, @userid	int, @all_cursor cursor, @cusertype	char(1), @cuserseclevel	tinyint, @cdepartmentid1	int, @cdepseclevel1	tinyint, @cdepartmentid2	int, @cdepseclevel2	tinyint, @croleid1		int, @crolelevel1	char(1), @croleid2		int, @crolelevel2	char(1), @croleid3		int, @crolelevel3	char(1), @usertype		char(1)  select @subid=subcategoryid, @cusertype=cusertype, @cuserseclevel=cuserseclevel, @cdepartmentid1=cdepartmentid1, @cdepseclevel1=cdepseclevel1, @cdepartmentid2=cdepartmentid2, @cdepseclevel2=cdepseclevel2, @croleid1=croleid1, @crolelevel1=crolelevel1, @croleid2=croleid2, @crolelevel2=crolelevel2, @croleid3=croleid3, @crolelevel3=crolelevel3 from docseccategory where id=@secid select @mainid=maincategoryid from docsubcategory where id=@subid  if @cusertype='0' begin set @usertype='0' SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR  select id from hrmresource where seclevel>=@cuserseclevel union select t1.id from hrmresource t1,hrmdepartment t2 where (t1.seclevel>=@cdepseclevel1 and t2.id=@cdepartmentid1 and t1.departmentid=t2.id) or (t1.seclevel>=@cdepseclevel2 and t2.id=@cdepartmentid2 and t1.departmentid=t2.id) union select t1.id from hrmresource t1,hrmroles t2,hrmrolemembers t3 where (t1.id=t3.resourceid and t3.roleid=t2.id and t2.id=@croleid1 and t3.rolelevel>=@crolelevel1) or (t1.id=t3.resourceid and t3.roleid=t2.id and t2.id=@croleid2 and t3.rolelevel>=@crolelevel2) or (t1.id=t3.resourceid and t3.roleid=t2.id and t2.id=@croleid3 and t3.rolelevel>=@crolelevel3)  OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin insert into  docusercategory (secid,mainid,subid,userid,usertype) values (@secid,@mainid,@subid,@userid,@usertype) FETCH NEXT FROM @all_cursor INTO @userid end CLOSE @all_cursor DEALLOCATE @all_cursor end else begin set @usertype='1' SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from crm_customerinfo where type=@cusertype and seclevel>=@cuserseclevel OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @userid WHILE @@FETCH_STATUS = 0 begin insert into  docusercategory (secid,mainid,subid,userid,usertype) values (@secid,@mainid,@subid,@userid,@usertype) FETCH NEXT FROM @all_cursor INTO @userid end CLOSE @all_cursor DEALLOCATE @all_cursor end

GO
alter procedure [CRM_SectorRpSum] @parentid	varchar(4000), @flag	int output, @msg varchar(4000) output AS declare @tempstr varchar(4000), @tempid int set @tempstr='%,'+@parentid+',%' set @tempid=cast(@parentid as int)  select count(id) as resultcount from crm_customerinfo where sector in(select id from crm_sectorinfo where id=@tempid or sectors like @tempstr)

 GO
alter procedure [CRM_SectorInfo_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS IF EXISTS(SELECT id FROM CRM_SectorInfo WHERE sectors LIKE ('%,' + CONVERT(varchar(4000), @id) + ',%')) BEGIN SELECT -1 RETURN END IF EXISTS(SELECT id FROM CRM_CustomerInfo WHERE sector = @id) BEGIN SELECT -2 RETURN END DELETE [CRM_SectorInfo] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_RpSum] @optional	varchar(4000), @flag	int output, @msg varchar(4000) output AS if  @optional='contactway' select source AS resultid,COUNT(id) AS resultcount from CRM_Customerinfo where deleted=0 group by source order by resultcount  if  @optional='customersize' select size_n AS resultid,COUNT(id) AS resultcount from CRM_Customerinfo where deleted=0 group by size_n order by resultcount  if  @optional='customertype' select type AS resultid,COUNT(id) AS resultcount from CRM_Customerinfo where deleted=0 group by type order by resultcount  if  @optional='customerdesc' select description AS resultid,COUNT(id) AS resultcount from CRM_Customerinfo where deleted=0 group by description order by resultcount  if  @optional='customerstatus' select status AS resultid,COUNT(id) AS resultcount from CRM_Customerinfo where deleted=0 group by status order by resultcount  if  @optional='paymentterm' select paymentterm AS resultid,COUNT(id) AS resultcount from CRM_Customerinfo where deleted=0 group by paymentterm order by resultcount  if  @optional='customerrating' select rating AS resultid,COUNT(id) AS resultcount from CRM_Customerinfo where deleted=0 group by rating order by resultcount  if  @optional='creditinfo' select creditlevel AS resultid,COUNT(id) AS resultcount from CRM_Customerinfo where deleted=0 group by creditlevel order by resultcount  if  @optional='tradeinfo' select contractlevel AS resultid,COUNT(id) AS resultcount from CRM_Customerinfo where deleted=0 group by contractlevel order by resultcount  if  @optional='manager' select manager AS resultid,COUNT(id) AS resultcount from CRM_Customerinfo where deleted=0 group by manager order by resultcount  if  @optional='department' select department AS resultid,COUNT(id) AS resultcount from CRM_Customerinfo where deleted=0 group by department order by resultcount

 GO
alter procedure [CRM_CustomerDesc_Delete] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS IF EXISTS(SELECT id FROM CRM_CustomerInfo WHERE description = @id) BEGIN SELECT -1 RETURN END DELETE [CRM_CustomerDesc] WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerEvaluationUpdate] (@id_1 	[int] , @evaluation_1 	[decimal](10, 2), @flag	[int]	output, @msg	varchar(4000)	output)  AS UPDATE CRM_CustomerInfo SET evaluation = @evaluation_1 where id = @id_1

GO
alter procedure [CRM_CustomerCount_SelectByType] (@city [int], @type [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT count(id) as countid FROM [CRM_CustomerInfo] where city=@city and type=@type

GO
alter procedure [CptUseLogBack_Insert] ( @capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @usecount_5 	[int], @useaddress_6 	varchar(4000), @userequest_7 	[int], @maintaincompany_8 	varchar(4000), @fee_9 	[decimal](18,3), @usestatus_10 	varchar(4000), @remark_11 	[text], @costcenterid   [int], @sptcount	[char](1), @flag integer output, @msg varchar(4000) output) AS declare @num int  if @sptcount<>'1' begin select @num=capitalnum  from CptCapital where id = @capitalid_1 end INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark]) VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5, @useaddress_6, @userequest_7, @maintaincompany_8, @fee_9, '0', @remark_11)  if @sptcount='1' begin Update CptCapital Set departmentid=null where id = @capitalid_1 Update CptCapital Set  costcenterid=null, resourceid=null, stateid = @usestatus_10, deprestartdate = null where id = @capitalid_1 end  else begin Update CptCapital Set capitalnum = @num+@usecount_5 where id = @capitalid_1 end select 1

GO
alter procedure [LeftMenuConfig_U_ByInfoInsert]( @menuLevel_1     int, @parentId_1      int, @defaultIndex_1  int, @flag            int	output, @msg             varchar(4000)	output) AS  DECLARE @old_updateId int, @old_resourceId int, @old_resourceType char(1), @old_parentId int, @curr_updateId int, @curr_resourceId int, @curr_resourceType char(1), @curr_parentId int, @indexCount int   IF (@menuLevel_1 = 1) BEGIN  DECLARE leftmenuviewindex_cursor CURSOR FOR SELECT t2.id,t2.resourceId,t2.resourceType,t1.parentid FROM LeftMenuInfo t1,LeftMenuConfig t2 WHERE t1.id = t2.infoId AND (t1.parentid IS NULL OR t1.parentid = 0) AND t2.viewIndex >= @defaultIndex_1 ORDER BY resourceid,resourcetype,parentId,defaultIndex,viewindex,infoid  END ELSE BEGIN  DECLARE leftmenuviewindex_cursor CURSOR FOR SELECT t2.id,t2.resourceId,t2.resourceType,t1.parentid FROM LeftMenuInfo t1,LeftMenuConfig t2 WHERE t1.id = t2.infoId AND t1.parentId = @parentId_1 AND t2.viewIndex >= @defaultIndex_1 ORDER BY resourceid,resourcetype,parentId,defaultIndex,viewindex,infoid  END  OPEN leftmenuviewindex_cursor FETCH NEXT FROM leftmenuviewindex_cursor INTO @curr_updateId,@curr_resourceId,@curr_resourceType,@curr_parentId  IF(@defaultIndex_1<1) SET @indexCount = 1; ELSE SET @indexCount = @defaultIndex_1  WHILE @@FETCH_STATUS = 0 BEGIN IF (@curr_resourceId = @old_resourceId AND @curr_resourceType = @old_resourceType AND (@curr_parentId = @old_parentId OR (@curr_parentId IS NULL AND @old_parentId IS NULL)) AND @curr_updateId != @old_updateId) BEGIN  SET @indexCount = @indexCount + 1  UPDATE LeftMenuConfig SET viewIndex = @indexCount WHERE id = @curr_updateId  END ELSE BEGIN  IF(@defaultIndex_1<1) SET @indexCount = 1; ELSE SET @indexCount = @defaultIndex_1  UPDATE LeftMenuConfig SET viewIndex = @indexCount WHERE id = @curr_updateId  END  SET @old_updateId = @curr_updateId SET @old_resourceId = @curr_resourceId SET @old_resourceType = @curr_resourceType SET @old_parentId = @curr_parentId  FETCH NEXT FROM leftmenuviewindex_cursor INTO @curr_updateId,@curr_resourceId,@curr_resourceType,@curr_parentId END  CLOSE leftmenuviewindex_cursor DEALLOCATE leftmenuviewindex_cursor  SET @flag = 1 SET @msg = 'ok'

GO
alter procedure [LeftMenuConfig_InsertByUserId]( @userId_1       int, @flag	int	output, @msg	varchar(4000)	output) AS DECLARE @id_1 int, @defaultIndex_1 int, @subcompany_id int, @locked char(1), @locked_by_id int, @visible_1 char(1), @viewIndex_1 int, @useCustomName_1 char(1), @customName_1 varchar(4000)   DECLARE leftMenuInfo_cursor CURSOR FOR  SELECT id, defaultIndex FROM LeftMenuInfo WHERE isCustom='0' OR isCustom IS NULL OR isCustom='2'  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @id_1,@defaultIndex_1  WHILE @@FETCH_STATUS = 0 BEGIN SET @locked = '0' SET @locked_by_id = 0  SET @visible_1 = '1' SET @viewIndex_1 = @defaultIndex_1 SET @useCustomName_1 = '0' SET @customName_1 = ''   IF EXISTS (SELECT 1 FROM HrmResourceManager WHERE id = @userId_1) BEGIN IF EXISTS (SELECT 1 FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = 1 AND resourceType = '1' AND locked > 0 ) BEGIN SELECT @locked_by_id = id FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = 1 AND resourceType = '1' END ELSE BEGIN DECLARE leftMenuInfo_cursor_1 CURSOR FOR select subcompanyid from SysRoleSubcomRight where roleid in(select a.roleid from HrmRoleMembers a,SystemRightRoles b where a.roleid=b.roleid and a.resourceid=@userId_1 and b.rightid =(select rightid from SystemRightDetail where rightdetail='SubMenu:Maint') ) group by subcompanyid  OPEN leftMenuInfo_cursor_1 FETCH NEXT FROM leftMenuInfo_cursor_1 INTO @subcompany_id  WHILE @@FETCH_STATUS = 0 BEGIN IF EXISTS (SELECT 1 FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = @subcompany_id AND resourceType = '2' AND locked > 0 ) BEGIN SELECT @locked_by_id = id FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = @subcompany_id AND resourceType = '2' BREAK END ELSE BEGIN IF EXISTS (SELECT 1 FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = @subcompany_id AND resourceType = '2' AND lockedbyid > 0 ) BEGIN SELECT @locked_by_id = lockedbyid FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = @subcompany_id AND resourceType = '2' BREAK END END FETCH NEXT FROM leftMenuInfo_cursor_1 INTO @subcompany_id END  CLOSE leftMenuInfo_cursor_1 DEALLOCATE leftMenuInfo_cursor_1  END SELECT @visible_1 = visible,@viewIndex_1=viewIndex,@useCustomName_1=useCustomName,@customName_1=customName FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceType = '1' AND resourceId = 1 END ELSE BEGIN  SELECT @subcompany_id = subcompanyid1 FROM HrmResource WHERE id = @userId_1  IF EXISTS (SELECT 1 FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = 1 AND resourceType = '1' AND locked > 0 ) BEGIN SELECT @locked_by_id = id FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = 1 AND resourceType = '1' END ELSE BEGIN IF EXISTS (SELECT 1 FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = @subcompany_id AND resourceType = '2' AND locked > 0 ) BEGIN SELECT @locked_by_id = id FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = @subcompany_id AND resourceType = '2' END ELSE BEGIN IF EXISTS (SELECT 1 FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = @subcompany_id AND resourceType = '2' AND lockedbyid > 0 ) BEGIN SELECT @locked_by_id = lockedbyid FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceId = @subcompany_id AND resourceType = '2' END END END SELECT @visible_1 = visible,@viewIndex_1=viewIndex,@useCustomName_1=useCustomName,@customName_1=customName FROM LeftMenuConfig WHERE infoid = @id_1 AND resourceType = '2' AND resourceId = @subcompany_id END  IF @locked_by_id > 0 SET @locked = '1'   INSERT INTO LeftMenuConfig (userId,infoId,visible,viewIndex,resourceid,resourcetype,locked,lockedById,useCustomName,customName) VALUES(@userId_1,@id_1,@visible_1,@viewIndex_1,@userId_1,'3',@locked,@locked_by_id,@useCustomName_1,@customName_1)  FETCH NEXT FROM leftMenuInfo_cursor INTO @id_1,@defaultIndex_1  END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor

GO
alter procedure [LeftMenuConfig_Insert_All]( @flag	int	output, @msg	varchar(4000)	output) AS DECLARE @id_1 int, @defaultIndex_1 int, @userId int   DECLARE hrmCompany_cursor CURSOR FOR SELECT id FROM HrmCompany order by id  OPEN hrmCompany_cursor FETCH NEXT FROM hrmCompany_cursor INTO @userId  WHILE @@FETCH_STATUS = 0 BEGIN DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id, defaultIndex FROM LeftMenuInfo  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @id_1,@defaultIndex_1  WHILE @@FETCH_STATUS = 0 BEGIN INSERT INTO LeftMenuConfig (userId,infoId,visible,viewIndex,resourceid,resourcetype,locked,lockedById,useCustomName) VALUES(0,@id_1,1,@defaultIndex_1,@userId,'1',0,0,0) FETCH NEXT FROM leftMenuInfo_cursor INTO @id_1,@defaultIndex_1 END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor  FETCH NEXT FROM hrmCompany_cursor INTO @userId END CLOSE hrmCompany_cursor DEALLOCATE hrmCompany_cursor    DECLARE hrmSubCompany_cursor CURSOR FOR SELECT id FROM HrmSubCompany order by id  OPEN hrmSubCompany_cursor FETCH NEXT FROM hrmSubCompany_cursor INTO @userId  WHILE @@FETCH_STATUS = 0 BEGIN DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id, defaultIndex FROM LeftMenuInfo  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @id_1,@defaultIndex_1  WHILE @@FETCH_STATUS = 0 BEGIN INSERT INTO LeftMenuConfig (userId,infoId,visible,viewIndex,resourceid,resourcetype,locked,lockedById,useCustomName) VALUES(0,@id_1,1,@defaultIndex_1,@userId,'2',0,0,0) FETCH NEXT FROM leftMenuInfo_cursor INTO @id_1,@defaultIndex_1 END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor  FETCH NEXT FROM hrmSubCompany_cursor INTO @userId END CLOSE hrmSubCompany_cursor DEALLOCATE hrmSubCompany_cursor   DECLARE hrmResourceManager_cursor CURSOR FOR SELECT id FROM HrmResourceManager order by id  OPEN hrmResourceManager_cursor FETCH NEXT FROM hrmResourceManager_cursor INTO @userId  WHILE @@FETCH_STATUS = 0 BEGIN DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id, defaultIndex FROM LeftMenuInfo  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @id_1,@defaultIndex_1  WHILE @@FETCH_STATUS = 0 BEGIN INSERT INTO LeftMenuConfig (userId,infoId,visible,viewIndex,resourceid,resourcetype,locked,lockedById,useCustomName) VALUES(@userId,@id_1,1,@defaultIndex_1,@userId,'3',0,0,0) FETCH NEXT FROM leftMenuInfo_cursor INTO @id_1,@defaultIndex_1 END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor  FETCH NEXT FROM hrmResourceManager_cursor INTO @userId END CLOSE hrmResourceManager_cursor DEALLOCATE hrmResourceManager_cursor    DECLARE hrmResource_cursor CURSOR FOR SELECT id FROM HrmResource order by id  OPEN hrmResource_cursor FETCH NEXT FROM hrmResource_cursor INTO @userId  WHILE @@FETCH_STATUS = 0 BEGIN DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id, defaultIndex FROM LeftMenuInfo  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @id_1,@defaultIndex_1  WHILE @@FETCH_STATUS = 0 BEGIN INSERT INTO LeftMenuConfig (userId,infoId,visible,viewIndex,resourceid,resourcetype,locked,lockedById,useCustomName) VALUES(@userId,@id_1,1,@defaultIndex_1,@userId,'3',0,0,0) FETCH NEXT FROM leftMenuInfo_cursor INTO @id_1,@defaultIndex_1 END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor  FETCH NEXT FROM hrmResource_cursor INTO @userId END CLOSE hrmResource_cursor DEALLOCATE hrmResource_cursor

 GO
alter procedure [initDocdetailMarkRead] @flag integer output , @msg varchar(4000) output AS Declare @docid int,@countIds int,@sumMark int,@sumReadCount int,@mark_cursor cursor,@readtag_cursor cursor SET @mark_cursor = CURSOR FORWARD_ONLY STATIC FOR select docid,count(id) as countIds,sum(mark) as sumMark from docmark group by docid OPEN @mark_cursor FETCH NEXT FROM @mark_cursor INTO @docid,@countIds,@sumMark WHILE @@FETCH_STATUS = 0 begin update docdetail set countMark=@countIds,sumMark=@sumMark where id = @docid FETCH NEXT FROM @mark_cursor INTO @docid,@countIds,@sumMark end CLOSE @mark_cursor DEALLOCATE @mark_cursor   SET @readtag_cursor = CURSOR FORWARD_ONLY STATIC FOR select docid,sum(readcount) as sumReadCount from docreadtag group by docid OPEN @readtag_cursor FETCH NEXT FROM @readtag_cursor INTO @docid,@sumReadCount WHILE @@FETCH_STATUS = 0 begin update docdetail set sumReadCount=@sumReadCount where id = @docid FETCH NEXT FROM @readtag_cursor INTO @docid,@sumReadCount end CLOSE @readtag_cursor DEALLOCATE @readtag_cursor

GO
alter procedure [Init_cowork_discussant] @flag		int	output, @msg		varchar(4000) output as Declare @coworkid_1 int, @discussant_1 int, @all_cursor cursor  SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from cowork_items OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @coworkid_1 WHILE @@FETCH_STATUS = 0 begin  select top 1 @discussant_1=discussant   from  cowork_discuss where coworkid=@coworkid_1 order by  createdate desc,createtime desc update cowork_items set lastdiscussant=@discussant_1 where id=@coworkid_1 FETCH NEXT FROM @all_cursor INTO   @coworkid_1 end CLOSE @all_cursor DEALLOCATE @all_cursor

 GO
alter procedure [CptCapitalType_Delete] ( @id_1 int, @flag integer output, @msg varchar(4000) output) AS IF EXISTS (SELECT id FROM CptCapital WHERE capitaltypeid = @id_1) BEGIN SELECT -1 RETURN END DELETE CptCapitalType WHERE [id] = @id_1

GO
alter procedure [CptCapital_UpdatePrice]( @id 		int, @price 		decimal(18,3), @capitalspec	varchar(4000), @customerid	int, @location	varchar(4000), @invoice	varchar(4000)  , @StockInDate	char(10), @flag	int	output, @msg	varchar(4000)	output) AS  UPDATE CptCapital SET  startprice=@price , capitalspec=@capitalspec , customerid=@customerid , location=@location , invoice=@invoice, StockInDate=@StockInDate WHERE ( id = @id)  set @flag = 1 set @msg = 'OK!'

 GO
alter procedure [CptCapital_UpdatePic] (@id_1 	[int], @capitalimageid_2     [int], @flag                             integer output, @msg                             varchar(4000) output ) AS update CptCapital set capitalimageid = 0 where id = @id_1 delete ImageFile where imagefileid = @capitalimageid_2 if @@error<>0 begin set @flag=1 set @msg='删除资产信息图片成功' return end else begin set @flag=0 set @msg='删除资产信息图片失败' return end

GO
alter procedure [CptCapital_Update] (@id_1 	int, @mark_2        varchar(4000), @name_3 	varchar(4000), @barcode_4 	varchar(4000), @startdate		char(10), @enddate		char(10), @seclevel_7 	tinyint, @resourceid	int, @sptcount 	char(1), @currencyid_11 	int, @capitalcost_12 	decimal(18,3), @startprice_13 	decimal(18,3), @depreendprice decimal(18,3), @capitalspec		varchar(4000), @capitallevel		varchar(4000), @manufacturer		varchar(4000), @manudate		char(10), @capitaltypeid_14 	int, @capitalgroupid_15 	int, @unitid_16 	int, @replacecapitalid_18 	int, @version_19 	varchar(4000), @location      varchar(4000), @remark_21 	text, @capitalimageid_22 	int, @depremethod1_23 	int, @depremethod2_24 	int, @customerid_27 	int, @attribute_28 	tinyint, @datefield1_31 	char(10), @datefield2_32 	char(10), @datefield3_33 	char(10), @datefield4_34 	char(10), @datefield5_35 	char(10), @numberfield1_36 	float, @numberfield2_37 	float, @numberfield3_38 	float, @numberfield4_39 	float, @numberfield5_40 	float, @textfield1_41 	varchar(4000), @textfield2_42 	varchar(4000), @textfield3_43 	varchar(4000), @textfield4_44 	varchar(4000), @textfield5_45 	varchar(4000), @tinyintfield1_46 	char(1), @tinyintfield2_47 	char(1), @tinyintfield3_48 	char(1), @tinyintfield4_49 	char(1), @tinyintfield5_50 	char(1), @lastmoderid_51 	int, @lastmoddate_52 	char(10), @lastmodtime_53 	char(8), @relatewfid		int, @alertnum          decimal(18,3), @fnamark			varchar(4000), @isinner			char(1), @invoice		varchar(4000), @StockInDate		char(10), @depreyear	 	decimal(18,2), @deprerate 		decimal(18,2), @deprestartdate	char(10), @contractno    varchar(4000), @flag integer output, @msg varchar(4000) output) AS  declare @tempgroupid int select @tempgroupid=capitalgroupid from CptCapital where id=@id_1 if @tempgroupid<>@capitalgroupid_15 begin update CptCapitalAssortment set capitalcount = capitalcount-1 where id=@tempgroupid update CptCapitalAssortment set capitalcount = capitalcount+1 where id=@capitalgroupid_15 end UPDATE CptCapital SET  	 mark	 = @mark_2, name	 = @name_3, barcode	 = @barcode_4, startdate = @startdate, enddate	 = @enddate, seclevel	 = @seclevel_7, resourceid = @resourceid, sptcount	= @sptcount, currencyid	 = @currencyid_11, capitalcost	 = @capitalcost_12, startprice	 = @startprice_13, depreendprice	= @depreendprice, capitalspec	= @capitalspec, capitallevel	= @capitallevel, manufacturer	= @manufacturer, manudate      = @manudate, capitaltypeid	 = @capitaltypeid_14, capitalgroupid	 = @capitalgroupid_15, unitid	 = @unitid_16, replacecapitalid	 = @replacecapitalid_18, version	 = @version_19, location	  = @location, remark	 = @remark_21, capitalimageid	 = @capitalimageid_22, depremethod1	 = @depremethod1_23, depremethod2	 = @depremethod2_24, customerid	 = @customerid_27, attribute	 = @attribute_28, datefield1	 = @datefield1_31, datefield2	 = @datefield2_32, datefield3	 = @datefield3_33, datefield4	 = @datefield4_34, datefield5	 = @datefield5_35, numberfield1	 = @numberfield1_36, numberfield2	 = @numberfield2_37, numberfield3	 = @numberfield3_38, numberfield4	 = @numberfield4_39, numberfield5	 = @numberfield5_40, textfield1	 = @textfield1_41, textfield2	 = @textfield2_42, textfield3	 = @textfield3_43, textfield4	 = @textfield4_44, textfield5	 = @textfield5_45, tinyintfield1	 = @tinyintfield1_46, tinyintfield2	 = @tinyintfield2_47, tinyintfield3	 = @tinyintfield3_48, tinyintfield4	 = @tinyintfield4_49, tinyintfield5	 = @tinyintfield5_50, lastmoderid	 = @lastmoderid_51, lastmoddate	 = @lastmoddate_52, lastmodtime	 = @lastmodtime_53, relatewfid	= @relatewfid, alertnum	 = @alertnum, fnamark	= @fnamark, isinner	= @isinner, invoice	= @invoice, StockInDate	= @StockInDate, depreyear	= @depreyear, deprerate	= @deprerate, deprestartdate = @deprestartdate, contractno = @contractno   WHERE ( id	 = @id_1)

GO
alter procedure [CptCapital_SSumByResourceid] (@flag	[int]	output, @msg	varchar(4000)	output) AS select resourceid AS resultid, COUNT(id) AS resultcount from CptCapital group by resourceid order by  resultcount desc

GO
alter procedure [CptCapital_SSumByDepartmentid] (@flag	[int]	output, @msg	varchar(4000)	output) AS select departmentid AS resultid, COUNT(id) AS resultcount from CptCapital group by departmentid order by  resultcount desc

GO
alter procedure [CptCapital_SSumByCustomerid] (@flag	[int]	output, @msg	varchar(4000)	output) AS select customerid AS resultid, COUNT(id) AS resultcount from CptCapital group by customerid order by  resultcount desc

GO
alter procedure [CptCapital_SSumByCapitaltypeid] (@flag	[int]	output, @msg	varchar(4000)	output) AS select capitaltypeid AS resultid, COUNT(id) AS resultcount from CptCapital group by capitaltypeid order by  resultcount desc

 GO
alter procedure [CptCapital_SSumByCapitalgroup] (@flag	[int]	output, @msg	varchar(4000)	output) AS select capitalgroupid AS resultid, COUNT(id) AS resultcount from CptCapital group by capitalgroupid order by  resultcount desc

GO
alter procedure [CptCapital_SelectSumByStateid] (@flag	[int]	output, @msg	varchar(4000)	output) AS select stateid AS resultid, COUNT(id) AS resultcount from CptCapital group by stateid order by  resultcount desc

GO
alter procedure [CptCapital_SelectByRandR] (@managerid 	[int], @resourceid   [int], @flag integer output , @msg varchar(4000) output) AS select * from CptCapital where isdata = '2' and resourceid = @resourceid and datatype in (select id from CptCapital where isdata = '1' and resourceid = @managerid)

  GO
alter procedure [CptCapital_SelectByID] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from CptCapital where id = @id_1 if @@error<>0 begin set @flag=1 set @msg='查询资产信息成功' return end else begin set @flag=0 set @msg='查询资产信息失败' return end

GO
alter procedure [CptCapital_SelectByDataType] (@datatype 	int, @departmentid  int, @flag                             integer output, @msg                             varchar(4000) output ) AS select * from CptCapital where datatype = @datatype and blongdepartment = @departmentid if @@error<>0 begin set @flag=1 set @msg='查询资产信息成功' return end else begin set @flag=0 set @msg='查询资产信息失败' return end

 GO
alter procedure [CptCapital_SelectAll] (@flag                             integer output, @msg                             varchar(4000) output ) AS select * from CptCapital order by departmentid if @@error<>0 begin set @flag=1 set @msg='查询资产信息成功' return end else begin set @flag=0 set @msg='查询资产信息失败' return end

GO
alter procedure [CptCapital_SCountByResourceid] (@resourceid 	int, @flag                             integer output, @msg                             varchar(4000) output ) AS select count(id) from CptCapital where resourceid = @resourceid and isdata= '2' if @@error<>0 begin set @flag=1 set @msg='查询资产信息成功' return end else begin set @flag=0 set @msg='查询资产信息失败' return end

GO
alter procedure [CptCapital_SCountByDataType] ( @datatype 	int, @flag		integer output, @msg		varchar(4000) output ) AS select mark from CptCapital where id=(select max(id) from CptCapital where datatype =@datatype and isdata='2')  if @@error<>0 begin set @flag=1 set @msg='查询资产信息成功' return end else begin set @flag=0 set @msg='查询资产信息失败' return end

GO
alter procedure [CptCapital_SCountByCapitalGrou] (@capitalgroupid 	int, @flag                             integer output, @msg                             varchar(4000) output ) AS select count(id) from CptCapital where capitalgroupid = @capitalgroupid if @@error<>0 begin set @flag=1 set @msg='查询资产信息成功' return end else begin set @flag=0 set @msg='查询资产信息失败' return end

 GO
alter procedure [CptCapital_SByCapitalTypeID] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from CptCapital where capitaltypeid = @id_1 if @@error<>0 begin set @flag=1 set @msg='查询资产信息成功' return end else begin set @flag=0 set @msg='查询资产信息失败' return end

GO
alter procedure [CptCapital_SByCapitalGroupID] (@id_1 	[int], @flag                             integer output, @msg                             varchar(4000) output ) AS select * from CptCapital where capitalgroupid = @id_1 and isdata  ='2' if @@error<>0 begin set @flag=1 set @msg='查询资产信息成功' return end else begin set @flag=0 set @msg='查询资产信息失败' return end

GO
alter procedure [CptCapital_Insert] ( @mark                   varchar(4000), @name_2                 varchar(4000), @barcode_3              varchar(4000), @seclevel_6             tinyint, @resourceid             int, @sptcount               char(1), @currencyid_10          int, @capitalcost_11         decimal(18,3), @startprice_12          decimal(18,3), @depreendprice          decimal(18,3), @capitalspec            varchar(4000), @capitallevel           varchar(4000), @manufacturer           varchar(4000), @capitaltypeid_13       int, @capitalgroupid_14      int, @unitid_15              int, @capitalnum             decimal(18,3), @replacecapitalid_17    int, @version_18             varchar(4000), @remark_20              text, @capitalimageid_21      int, @depremethod1_22        int, @depremethod2_23        int, @customerid_26          int, @attribute_27           tinyint, @datefield1_30          char(10), @datefield2_31          char(10), @datefield3_32          char(10), @datefield4_33          char(10), @datefield5_34          char(10), @numberfield1_35        float, @numberfield2_36        float, @numberfield3_37        float, @numberfield4_38        float, @numberfield5_39        float, @textfield1_40          varchar(4000), @textfield2_41          varchar(4000), @textfield3_42          varchar(4000), @textfield4_43          varchar(4000), @textfield5_44          varchar(4000), @tinyintfield1_45       char(1), @tinyintfield2_46       char(1), @tinyintfield3_47       char(1), @tinyintfield4_48       char(1), @tinyintfield5_49       char(1), @createrid_50           int, @createdate_51          char(10), @createtime_52          char(8), @lastmoderid_53         int, @lastmoddate_54         char(10), @lastmodtime_55         char(8), @isdata_56              char(1), @depreyear_57		decimal(18,2), @deprerate_58		decimal(18,2), @flag integer output, @msg varchar(4000) output) AS  INSERT INTO CptCapital ( mark, name, barcode, seclevel, resourceid, sptcount, currencyid, capitalcost, startprice, depreendprice, capitalspec, capitallevel, manufacturer, capitaltypeid, capitalgroupid, unitid, capitalnum, replacecapitalid, version, remark, capitalimageid, depremethod1, depremethod2, customerid, attribute, datefield1, datefield2, datefield3, datefield4, datefield5, numberfield1, numberfield2, numberfield3, numberfield4, numberfield5, textfield1, textfield2, textfield3, textfield4, textfield5, tinyintfield1, tinyintfield2, tinyintfield3, tinyintfield4, tinyintfield5, createrid, createdate, createtime, lastmoderid, lastmoddate, lastmodtime, isdata, depreyear, deprerate)  VALUES ( @mark, @name_2, @barcode_3, @seclevel_6, @resourceid, @sptcount, @currencyid_10, @capitalcost_11, @startprice_12, @depreendprice, @capitalspec, @capitallevel, @manufacturer, @capitaltypeid_13, @capitalgroupid_14, @unitid_15, @capitalnum, @replacecapitalid_17, @version_18, @remark_20, @capitalimageid_21, @depremethod1_22, @depremethod2_23, @customerid_26, @attribute_27, @datefield1_30, @datefield2_31, @datefield3_32, @datefield4_33, @datefield5_34, @numberfield1_35, @numberfield2_36, @numberfield3_37, @numberfield4_38, @numberfield5_39, @textfield1_40, @textfield2_41, @textfield3_42, @textfield4_43, @textfield5_44, @tinyintfield1_45, @tinyintfield2_46, @tinyintfield3_47, @tinyintfield4_48, @tinyintfield5_49, @createrid_50, @createdate_51, @createtime_52, @lastmoderid_53, @lastmoddate_54, @lastmodtime_55, @isdata_56, @depreyear_57, @deprerate_58)  declare @thisid int select @thisid = max(id) from CptCapital update CptCapitalAssortment set capitalcount = capitalcount+1 where id in (select capitalgroupid from CptCapital where id = @thisid)  select max(id) from CptCapital

GO
alter procedure [CptCapital_HandBackSelect] @resourceid	int, @managerid	int, @flag integer output , @msg varchar(4000) output AS select * from CptCapital where isdata = '2' and resourceid = @resourceid and datatype in (select id from CptCapital where isdata = '1' and resourceid = @managerid)

GO
alter procedure [CptCapital_ForcedDelete] ( @id_1 [int], @flag integer output, @msg varchar(4000) output) AS declare @isdata int select @isdata = isdata from CptCapital where id = @id_1 if(@isdata = 1) UPDATE CptCapitalAssortment SET capitalcount = capitalcount-1 WHERE id IN (SELECT capitalgroupid FROM CptCapital WHERE id = @id_1) DELETE [CptCapital] WHERE [id] = @id_1

GO
alter procedure [CptCapital_Duplicate] ( @capitalid 	int, @customerid	int, @price		decimal, @capitalspec	varchar(4000), @location	varchar(4000), @invoice	varchar(4000), @StockInDate	char(10), @SelectDate	char(10), @flag integer output, @msg varchar(4000) output) AS declare @maxid int  INSERT INTO [CptCapital] (mark, name, barcode, startdate, enddate, seclevel, departmentid, costcenterid, resourceid, crmid, sptcount, currencyid , capitalcost, startprice, depreendprice, capitalspec, capitallevel, manufacturer, manudate, capitaltypeid, capitalgroupid, unitid, capitalnum, currentnum, replacecapitalid, version, itemid, remark, capitalimageid, depremethod1, depremethod2, deprestartdate, depreenddate, customerid, attribute, stateid, location, usedhours, datefield1, datefield2, datefield3, datefield4, datefield5, numberfield1, numberfield2, numberfield3, numberfield4, numberfield5, textfield1, textfield2, textfield3, textfield4, textfield5, tinyintfield1, tinyintfield2, tinyintfield3, tinyintfield4, tinyintfield5, createrid, createdate, createtime, lastmoderid, lastmoddate, lastmodtime, isdata, datatype, relatewfid, invoice, StockInDate, depreyear, deprerate, issupervision, amountpay, purchasestate, docff01name, docff02name, docff03name, docff04name, docff05name, depff01name, depff02name, depff03name, depff04name, depff05name, crmff01name, crmff02name, crmff03name, crmff04name, crmff05name, reqff01name, reqff02name, reqff03name, reqff04name, reqff05name, SelectDate)  select mark, name, barcode, startdate, enddate	, seclevel, departmentid, costcenterid, resourceid, crmid, sptcount, currencyid , capitalcost, @price, depreendprice, @capitalspec, capitallevel, manufacturer, manudate, capitaltypeid, capitalgroupid, unitid, capitalnum, currentnum, replacecapitalid, version, itemid, remark, capitalimageid, depremethod1, depremethod2, deprestartdate, depreenddate, @customerid, attribute, stateid, @location, usedhours, datefield1, datefield2, datefield3, datefield4, datefield5, numberfield1, numberfield2, numberfield3, numberfield4, numberfield5, textfield1, textfield2, textfield3, textfield4, textfield5, tinyintfield1, tinyintfield2, tinyintfield3, tinyintfield4, tinyintfield5, createrid, createdate, createtime, lastmoderid, lastmoddate, lastmodtime, isdata, datatype, relatewfid, @invoice, @StockInDate, depreyear, deprerate, issupervision, amountpay, purchasestate, docff01name, docff02name, docff03name, docff04name, docff05name, depff01name, depff02name, depff03name, depff04name, depff05name, crmff01name, crmff02name, crmff03name, crmff04name, crmff05name, reqff01name, reqff02name, reqff03name, reqff04name, reqff05name, @SelectDate from CptCapital where id = @capitalid  select @maxid = max(id)  from CptCapital update CptCapital set capitalnum = 0 where id = @maxid select @maxid

GO
alter procedure [CptCapital_Delete] (@id_1 	[int], @flag integer output, @msg varchar(4000) output)  AS declare @count int declare @isdata int select @count=count(*) from CptCapital where datatype = @id_1 begin if @count<>0 begin select -1 return end end select @isdata = isdata from CptCapital where id = @id_1 if(@isdata = 1) update CptCapitalAssortment set capitalcount = capitalcount-1 where id in (select capitalgroupid from CptCapital where id = @id_1 )  DELETE [CptCapital]  WHERE ( [id]	 = @id_1)  select max(id) from CptCapital

GO
alter procedure [CptUseLogUse_Insert2] ( @capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @usecount_5 	decimal(18,3), @userequest_6 [int], @maintaincompany_8  varchar(4000), @fee_9 	[decimal](18,3), @usestatus_10 	varchar(4000), @remark_11 	[text], @useaddress_12 varchar(4000), @sptcount	[char](1), @flag integer output, @msg varchar(4000) output) AS declare @num decimal(18,3) if @sptcount<>'1' begin select @num=capitalnum  from CptCapital where id = @capitalid_1 if @num<@usecount_5 begin select -1 return end else begin select @num = @num-@usecount_5 end end INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount],[userequest], [maintaincompany], [fee], [usestatus], [remark], [useaddress], [olddeptid])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5,@userequest_6, @maintaincompany_8, @fee_9, '2', @remark_11, @useaddress_12, 0) if @sptcount='1' begin  Update CptCapital Set olddepartment=departmentid where id = @capitalid_1 Update CptCapital Set departmentid = @usedeptid_3, resourceid   = @useresourceid_4, stateid = @usestatus_10 where id = @capitalid_1 insert INTO HrmCapitalUse (capitalid,hrmid,cptnum) values(@capitalid_1,@useresourceid_4,1) end else begin Update CptCapital Set capitalnum = @num where id = @capitalid_1 insert INTO HrmCapitalUse (capitalid,hrmid,cptnum) values(@capitalid_1,@useresourceid_4,@usecount_5) end  select 1

 GO
alter procedure [CptUseLogUse_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @usecount_5 	decimal(18,3), @maintaincompany_8 	varchar(4000), @fee_9 	[decimal](18,3), @usestatus_10 	varchar(4000), @remark_11 	[text], @useaddress_12 varchar(4000), @sptcount	[char](1),  @flag integer output, @msg varchar(4000) output)  AS declare @num decimal(18,3)    if @sptcount<>'1' begin select @num=capitalnum  from CptCapital where id = @capitalid_1 if @num<@usecount_5 begin select -1 return end else begin select @num = @num-@usecount_5 end end  INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [maintaincompany], [fee], [usestatus], [remark], [useaddress], [olddeptid])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5, @maintaincompany_8, @fee_9, '2', @remark_11, @useaddress_12, 0)   if @sptcount='1' begin  Update CptCapital Set olddepartment=departmentid where id = @capitalid_1 Update CptCapital Set departmentid = @usedeptid_3, resourceid   = @useresourceid_4, stateid = @usestatus_10 where id = @capitalid_1 insert INTO HrmCapitalUse (capitalid,hrmid,cptnum) values(@capitalid_1,@useresourceid_4,1) end  else begin Update CptCapital Set capitalnum = @num where id = @capitalid_1 insert INTO HrmCapitalUse (capitalid,hrmid,cptnum) values(@capitalid_1,@useresourceid_4,@usecount_5) end  select 1

 GO
alter procedure [CptUseLogReturn_Insert] (@capitalid_1 	   [int], @usedate		   [char](10), @resourceid 	   [int], @todepartmentid   [int], @costcenterid 	   [int], @fromdepartmentid [int], @capitalnum	   [decimal](18,3), @relatereq 	   [int], @sptcount		   [char](1), @flag integer output, @msg varchar(4000) output)  AS  INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark], [olddeptid])  VALUES ( @capitalid_1, @usedate, @todepartmentid, @resourceid, @capitalnum, '', @relatereq, '', 0, '0', '', @fromdepartmentid)  declare @id int,@num decimal(18,3)  if @sptcount <> '1' begin select @id=id,@num=capitalnum from CptCapital where isdata='2' and datatype in (select datatype from CptCapital where id = @capitalid_1) and departmentid = @todepartmentid if @id<>'' begin Update CptCapital Set capitalnum = @num+@capitalnum, stateid = '1' where id = @id delete from CptCapital where id = @capitalid_1 end else begin Update CptCapital Set departmentid = @todepartmentid, costcenterid = @costcenterid, resourceid   = @resourceid, stateid		 = '1' where id = @capitalid_1 end end else begin Update CptCapital Set departmentid = @todepartmentid, costcenterid = @costcenterid, resourceid   = @resourceid, stateid		 = '1' where id = @capitalid_1 end

 GO
alter procedure [CptUseLogOther_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @usecount_5 	[int], @useaddress_6 	varchar(4000), @userequest_7 	[int], @maintaincompany_8 	varchar(4000), @fee_9 	[decimal](18,3), @usestatus_10 	varchar(4000), @remark_11 	[text], @costcenterid   [int], @sptcount	[char](1), @flag integer output, @msg varchar(4000) output)  AS declare @num int  if @sptcount<>'1' begin select @num=capitalnum  from CptCapital where id = @capitalid_1 if @num<@usecount_5 begin select -1 return end else begin select @num = @num-@usecount_5 end end  INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5, @useaddress_6, @userequest_7, @maintaincompany_8, @fee_9, @usestatus_10, @remark_11)  if @sptcount='1' begin Update CptCapital Set location = @useaddress_6, departmentid = @usedeptid_3, costcenterid = @costcenterid, resourceid   = @useresourceid_4, stateid = @usestatus_10 where id = @capitalid_1 end  else begin Update CptCapital Set capitalnum = @num where id = @capitalid_1 end  select 1

 GO
alter procedure [CptUseLogMoveOut_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @usecount_5 	[int], @useaddress_6 	varchar(4000), @userequest_7 	[int], @maintaincompany_8 	varchar(4000), @fee_9 	[decimal](18,3), @usestatus_10 	varchar(4000), @remark_11 	[text], @costcenterid   [int], @flag integer output, @msg varchar(4000) output)  AS declare @num int  select @num=capitalnum  from CptCapital where id = @capitalid_1 if @num<@usecount_5 begin select -1 return end else begin select @num = @num-@usecount_5 end  INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5, @useaddress_6, @userequest_7, @maintaincompany_8, @fee_9, '-5', @remark_11)  Update CptCapital Set capitalnum = @num where id = @capitalid_1  select 1

 GO
alter procedure [CptUseLogMove_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @departmentid   [int], @costcenterid   [int], @resourceid      [int], @usecount_5 	decimal(18,3), @userequest_7  [int], @location	varchar(4000), @fee	     [decimal](18,3), @remark_11 	[text], @olddepartmentid [int], @flag integer output, @msg varchar(4000) output) AS  INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark], [olddeptid])  VALUES ( @capitalid_1, @usedate_2, @departmentid, @resourceid, 1, @location, @userequest_7, '', @fee, '-4', @remark_11, @olddepartmentid)  Update CptCapital Set departmentid = @departmentid, costcenterid = @costcenterid, resourceid    = @resourceid, stateid = '2' where id = @capitalid_1

 GO
alter procedure [CptUseLogMend_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @usecount_5 	[int], @useaddress_6 	varchar(4000), @userequest_7 	[int], @maintaincompany_8 	varchar(4000), @fee_9 	[decimal](18,3), @usestatus_10 	varchar(4000), @remark_11 	[text], @resourceid_12 varchar(4000),@mendperioddate_13 varchar(4000),@flag integer output, @msg varchar(4000) output)  AS  INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark],[resourceid],[mendperioddate])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5, @useaddress_6, @userequest_7, @maintaincompany_8, @fee_9, '4', @remark_11,@resourceid_12,@mendperioddate_13)  Update CptCapital Set stateid = @usestatus_10 where id = @capitalid_1

 GO
alter procedure [CptUseLogLoss_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @usecount_5 	[int], @useaddress_6 	varchar(4000), @userequest_7 	[int], @maintaincompany_8 	varchar(4000), @fee_9 	[decimal](18,3), @usestatus_10 	varchar(4000), @remark_11 	[text], @costcenterid   [int], @sptcount	[char](1), @flag integer output, @msg varchar(4000) output)  AS declare @num int  if @sptcount<>'1' begin select @num=capitalnum  from CptCapital where id = @capitalid_1 if @num<@usecount_5 begin select -1 return end else begin select @num = @num-@usecount_5 end end  INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5, @useaddress_6, @userequest_7, @maintaincompany_8, @fee_9, '-7', @remark_11)  if @sptcount='1' begin Update CptCapital Set departmentid=null, costcenterid=null, resourceid=null, stateid = @usestatus_10 where id = @capitalid_1 end  else begin Update CptCapital Set capitalnum = @num where id = @capitalid_1 end  select 1

 GO
alter procedure [CptUseLogLend_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @usecount_5 	[int], @useaddress_6 	varchar(4000), @userequest_7 	[int], @maintaincompany_8 	varchar(4000), @fee_9 	[decimal](18,3), @usestatus_10 	varchar(4000), @remark_11 	[text], @costcenterid   [int], @flag integer output, @msg varchar(4000) output)  AS INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5, @useaddress_6, @userequest_7, @maintaincompany_8, @fee_9, '3', @remark_11)  Update CptCapital Set departmentid = @usedeptid_3, resourceid   = @useresourceid_4, location	     =  @useaddress_6, stateid = @usestatus_10 where id = @capitalid_1

 GO
alter procedure [CptUseLogInStock2_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @usecount_5 	[int], @userequest_7  [int], @remark_11 	[text], @flag integer output, @msg varchar(4000) output)  AS declare @departmentid  int,@resourceid int,@location varchar(4000),@num int  select 	@departmentid 	=departmentid, @resourceid	=resourceid, @location	=location, @num		=capitalnum from CptCapital where id = @capitalid_1  INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark])  VALUES ( @capitalid_1, @usedate_2, @departmentid, @resourceid, @usecount_5, @location, @userequest_7, '', 0, '1', @remark_11)  Update CptCapital Set capitalnum = @num+@usecount_5 where id = @capitalid_1

 GO
alter procedure [CptUseLogInStock_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @checkerid 	[int], @usecount_5 	[decimal](18,3), @useaddress_6 	varchar(4000), @userequest_7 	[int], @maintaincompany_8 varchar(4000), @fee_9 			[decimal](18,3), @usestatus_10 		varchar(4000), @remark_11 		[text], @mark				varchar(4000), @datatype			[int], @startdate			[char](10), @enddate			[char](10), @deprestartdate	[char](10), @depreenddate		[char](10), @manudate			[char](10), @lastmoderid		[int], @lastmoddate		[char](10), @lastmodtime    	[char](8), @inprice		[decimal](18,3), @crmid		[int], @counttype		[char](1), @isinner		[char](1), @flag integer output, @msg varchar(4000) output)  AS if @usestatus_10='2' begin INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @checkerid, @usecount_5, @useaddress_6, @userequest_7, @maintaincompany_8, @fee_9, '1', @remark_11) end  INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5, @useaddress_6, @userequest_7, @maintaincompany_8, @fee_9, @usestatus_10, @remark_11)  declare @num decimal(18,3) select @num=capitalnum from CptCapital where id = @capitalid_1  if @usestatus_10 = '1' begin set @useresourceid_4 = 0 end  if @usedeptid_3 = 0 begin set @usedeptid_3 = null end  Update CptCapital Set mark = @mark, capitalnum = @usecount_5+@num, location = @useaddress_6, departmentid = @usedeptid_3, resourceid   = @useresourceid_4, stateid = @usestatus_10, datatype = @datatype, isdata = '2', startdate = @startdate, enddate = @enddate, deprestartdate = @deprestartdate, depreenddate = @depreenddate, manudate = @manudate, [lastmoderid] = @lastmoderid, [lastmoddate] = @lastmoddate, [lastmodtime] = @lastmodtime, [startprice]  = @inprice, [customerid]		  =	@crmid, [counttype]    = @counttype, [isinner]     = @isinner where id = @capitalid_1

 GO
alter procedure [CptUseLogHandOver_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @usecount_5 	[int], @useaddress_6 	varchar(4000), @userequest_7 	[int], @maintaincompany_8 	varchar(4000), @fee_9 	[decimal](18,3), @usestatus_10 	varchar(4000), @remark_11 	[text], @costcenterid   [int], @flag integer output, @msg varchar(4000) output)  AS  INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5, @useaddress_6, @userequest_7, @maintaincompany_8, @fee_9, '-6', @remark_11)  Update CptCapital Set location = @useaddress_6, departmentid = @usedeptid_3, costcenterid = @costcenterid, resourceid   = @useresourceid_4, stateid = @usestatus_10 where id = @capitalid_1

GO
alter procedure [CptUseLogDiscard_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @usecount_5 	[decimal](18,3), @useaddress_6 	varchar(4000), @userequest_7 	[int], @maintaincompany_8 	varchar(4000), @fee_9 	[decimal](18,3), @usestatus_10 	varchar(4000), @remark_11 	[text], @sptcount_12	[char](1), @flag integer output, @msg varchar(4000) output)  AS declare @num [decimal](18,3)  if @sptcount_12<>'1' begin select @num=capitalnum  from CptCapital where id = @capitalid_1 if @num<@usecount_5 begin select -1 return end else begin select @num = @num-@usecount_5 end end INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5, @useaddress_6, @userequest_7, @maintaincompany_8, @fee_9, '5', @remark_11)  if @sptcount_12 ='1' begin Update CptCapital Set departmentid = null, costcenterid = null, resourceid   = null, location	     =  null, stateid = @usestatus_10 where id = @capitalid_1 end  else begin Update CptCapital Set capitalnum = @num where id = @capitalid_1 end  select 1

 GO
alter procedure [CptUseLogCheckStock_Update] (@capitalid_1 	[int], @userequest_2 	[int], @usestatus_3 	varchar(4000), @usecount_4 	[int], @fee		[decimal](18,3), @realnum	[int], @remark           text, @flag integer output , @msg varchar(4000) output)  AS UPDATE [CptUseLog]  SET  [usecount]	 = @usecount_4, [fee] = @fee, [usestatus]	 = @usestatus_3, remark = @remark   WHERE ( [capitalid]	 = @capitalid_1 AND [userequest]	 = @userequest_2 AND ([usestatus]	 = '-1' or [usestatus]	 = '-2'))  update CptCapital set capitalnum = @realnum where id = @capitalid_1

 GO
alter procedure [CptUseLogCheckStock_Insert] (@capitalid_1 	[int], @usedate_2 	[char](10), @usedeptid_3 	[int], @useresourceid_4 	[int], @usecount_5 	[int], @useaddress_6 	varchar(4000), @userequest_7 	[int], @maintaincompany_8 	varchar(4000), @fee_9 	[decimal](18,3), @usestatus_10 	varchar(4000), @remark_11 	[text], @realnum	[int], @flag integer output, @msg varchar(4000) output)  AS  INSERT INTO [CptUseLog] ( [capitalid], [usedate], [usedeptid], [useresourceid], [usecount], [useaddress], [userequest], [maintaincompany], [fee], [usestatus], [remark])  VALUES ( @capitalid_1, @usedate_2, @usedeptid_3, @useresourceid_4, @usecount_5, @useaddress_6, @userequest_7, @maintaincompany_8, @fee_9, @usestatus_10, @remark_11)  update CptCapital set capitalnum = @realnum where id = @capitalid_1

GO
alter procedure [Prj_Plan_Submit] (@prjid [int], @flag integer output, @msg varchar(4000) output )  AS UPDATE [Prj_TaskProcess]  SET [isactived]	 = '1'  WHERE ( [prjid]	 = @prjid ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Plan_SaveFromProcess] (@prjid 	[int], @version	[int],@creater	[int],@createdate	varchar(4000),@createtime	varchar(4000), @flag integer output, @msg varchar(4000) output  ) AS declare @taskid 	[int], @wbscoding 	varchar(4000), @subject 	varchar(4000), @begindate 	varchar(4000), @enddate 	varchar(4000), @workday        [decimal] (10,1), @content 	varchar(4000), @fixedcost	[decimal](10,2), @parentid	[int], @parentids	varchar(4000), @parenthrmids	varchar(4000), @level_n		[tinyint], @hrmid		[int],@taskindex int, @all_cursor	cursor SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select  id , wbscoding, subject , begindate, enddate, workday, content, fixedcost, parentid, parentids, parenthrmids, level_n, hrmid,taskindex from [Prj_TaskProcess] where prjid = @prjid OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @taskid,@wbscoding,@subject,@begindate,@enddate, @workday,@content,@fixedcost,@parentid,@parentids,@parenthrmids,@level_n,@hrmid,@taskindex WHILE @@FETCH_STATUS = 0 begin INSERT INTO [Prj_TaskInfo] ( prjid, taskid , wbscoding, subject ,begindate, enddate, workday, content, fixedcost, parentid, parentids, parenthrmids, level_n, hrmid,taskindex, isactived, version,creater,createdate,createtime)  VALUES (  @prjid, @taskid , @wbscoding, @subject , @begindate, @enddate, @workday, @content, @fixedcost, @parentid, @parentids, @parenthrmids, @level_n, @hrmid,@taskindex,'1',@version,@creater,@createdate,@createtime) FETCH NEXT FROM @all_cursor INTO @taskid,@wbscoding,@subject,@begindate,@enddate, @workday,@content,@fixedcost,@parentid,@parentids,@parenthrmids,@level_n,@hrmid,@taskindex end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [Prj_Plan_Approve] (@prjid 	[int],@creater	[int],@createdate	varchar(4000),@createtime	varchar(4000), @flag integer output, @msg varchar(4000) output  ) AS declare @taskid 	[int], @wbscoding 	varchar(4000), @subject 	varchar(4000), @begindate 	varchar(4000), @enddate 	varchar(4000), @workday        [decimal] (10,1), @content 	varchar(4000), @fixedcost	[decimal](18,2), @parentid	[int], @parentids	varchar(4000), @parenthrmids	varchar(4000), @level_n		[tinyint], @hrmid		[int], @all_cursor	cursor SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select   id , wbscoding, subject , begindate, enddate, workday, content, fixedcost, parentid, parentids, parenthrmids, level_n, hrmid from [Prj_TaskProcess] where prjid = @prjid OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @taskid,@wbscoding,@subject,@begindate,@enddate, @workday,@content,@fixedcost,@parentid,@parentids,@parenthrmids,@level_n,@hrmid WHILE @@FETCH_STATUS = 0 begin INSERT INTO [Prj_TaskInfo] (  prjid, taskid , wbscoding, subject ,begindate, enddate, workday, content, fixedcost, parentid, parentids, parenthrmids, level_n, hrmid, isactived, version,creater,createdate,createtime)  VALUES (  @prjid, @taskid , @wbscoding, @subject , @begindate, @enddate, @workday, @content, @fixedcost, @parentid, @parentids, @parenthrmids, @level_n, @hrmid,'2','1',@creater,@createdate,@createtime) FETCH NEXT FROM @all_cursor INTO @taskid,@wbscoding,@subject,@begindate,@enddate, @workday,@content,@fixedcost,@parentid,@parentids,@parenthrmids,@level_n,@hrmid end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [Prj_TaskInfo_Insert] (@prjid 	[int], @taskid 	[int],  @wbscoding 	varchar(4000), @subject 	varchar(4000) , @version 	[tinyint], @begindate 	varchar(4000), @enddate 	varchar(4000), @workday [decimal] (10,1), @content 	varchar(4000), @fixedcost [decimal] (10,2),  @flag integer output, @msg varchar(4000) output  )  AS INSERT INTO [Prj_TaskInfo] ( prjid, taskid , wbscoding, subject , version , begindate, enddate, workday, content, fixedcost)  VALUES ( @prjid, @taskid , @wbscoding, @subject , @version , @begindate, @enddate, @workday, @content, @fixedcost) INSERT INTO [Prj_TaskProcess] ( prjid, taskid ,  version, begindate, enddate )  VALUES ( @prjid, @taskid ,  @version, 'x', '-') set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskInfo_DeleteByVesion] (@prjid [int], @version varchar(4000), @flag integer output, @msg varchar(4000) output )  AS delete [Prj_TaskInfo]  WHERE ( [prjid]	 = @prjid and [version]	 = @version ) delete [Prj_TaskProcess]  WHERE ( [prjid]	 = @prjid and [version]	 = @version ) update [Prj_TaskProcess] set isactived='2'  WHERE ( [prjid]	 = @prjid and [version]<>@version  and isactived <> '1' ) update [Prj_Member] set version=replace(version, '|'+@version+'|', '')  WHERE ( [prjid]	 = @prjid and [version]	 like  '%' + '|'+@version+'|' + '%' ) delete [Prj_Member] WHERE ( [prjid]	 = @prjid and version='' ) update [Prj_Tool] set version=replace(version, '|'+@version+'|', '')  WHERE ( [prjid]	 = @prjid and [version]	 like  '%' + '|'+@version+'|' + '%' ) delete [Prj_Tool] WHERE ( [prjid]	 = @prjid and version='' ) update [Prj_Material] set version=replace(version, '|'+@version+'|', '')  WHERE ( [prjid]	 = @prjid and [version]	 like  '%' + '|'+@version+'|' + '%' ) delete [Prj_Material] WHERE ( [prjid]	 = @prjid and version='' ) delete [Prj_MemberProcess] WHERE ( [prjid] = @prjid  and isactived='0' ) delete [Prj_ToolProcess] WHERE ( [prjid] = @prjid   and isactived='0' ) delete [Prj_MaterialProcess] WHERE ( [prjid] = @prjid  and isactived='0' ) update [Prj_MemberProcess] set isactived='2'  WHERE ( [prjid]	 = @prjid and [isactived]='3'  ) update [Prj_ToolProcess] set isactived='2'  WHERE ( [prjid]	 = @prjid and [isactived]='3'  ) update [Prj_MaterialProcess] set isactived='2'  WHERE ( [prjid]	 = @prjid and [isactived]='3'  ) set @flag=1 set @msg='ok'

GO
alter procedure [Prj_TaskInfo_DeleteByID] (@id 	[int], @prjid [int], @version varchar(4000), @taskid [int] , @flag integer output, @msg varchar(4000) output )  AS delete [Prj_TaskInfo]  WHERE ( [id]	 = @id) update [Prj_TaskProcess] set isactived='3'  WHERE ( [prjid]	 = @prjid and [taskid] = @taskid and [version]<>@version  ) delete [Prj_TaskProcess] WHERE ( [prjid] = @prjid  and [taskid] = @taskid and version=@version ) update [Prj_Member] set version=replace(version, '|'+@version+'|', '')  WHERE ( [prjid]	 = @prjid and [taskid] = @taskid  ) delete [Prj_Member] WHERE ( [prjid] = @prjid  and [taskid] = @taskid and version='' ) update [Prj_Tool] set version=replace(version, '|'+@version+'|', '')  WHERE ( [prjid]	 = @prjid and [taskid] = @taskid ) delete [Prj_Tool] WHERE ( [prjid]	 = @prjid  and [taskid] = @taskid and version='' ) update [Prj_Material] set version=replace(version, '|'+@version+'|', '')  WHERE ( [prjid]	 = @prjid and [taskid] = @taskid ) delete [Prj_Material] WHERE ( [prjid]	 = @prjid  and [taskid] = @taskid and version='' ) delete [Prj_MemberProcess] WHERE ( [prjid] = @prjid  and [taskid] = @taskid and isactived='0' ) update [Prj_MemberProcess] set isactived='3'  WHERE ( [prjid]	 = @prjid and [taskid] = @taskid and [isactived]<>'1'  ) delete [Prj_ToolProcess] WHERE ( [prjid] = @prjid  and [taskid] = @taskid and isactived='0' ) update [Prj_ToolProcess] set isactived='3'  WHERE ( [prjid]	 = @prjid and [taskid] = @taskid and [isactived]<>'1'  ) delete [Prj_MaterialProcess] WHERE ( [prjid] = @prjid  and [taskid] = @taskid and isactived='0' ) update [Prj_MaterialProcess] set isactived='3'  WHERE ( [prjid]	 = @prjid and [taskid] = @taskid and [isactived]<>'1'  ) set @flag=1 set @msg='ok'

GO
alter procedure [Prj_TaskInfo_Approve] (@prjid [int], @version [tinyint], @isactived [tinyint], @flag integer output, @msg varchar(4000) output )  AS UPDATE [Prj_TaskInfo]  SET [isactived]	 = @isactived  WHERE ( [prjid]	 = @prjid and [version]	 = @version ) if @isactived='2' begin UPDATE [Prj_TaskProcess]  SET [isactived]	 = '1', [version]=@version  WHERE ( [prjid]	 = @prjid and [isactived]	 = '3'  ) UPDATE [Prj_TaskProcess]  SET [isactived]	 = '2', [version]=@version  WHERE ( [prjid]	 = @prjid and [isactived]	 <> '1'  ) UPDATE [Prj_MemberProcess]  SET [isactived]	 = '2'  WHERE ( [prjid]	 = @prjid and [isactived]	 = '0'  ) UPDATE [Prj_ToolProcess]  SET [isactived]	 = '2'  WHERE ( [prjid]	 = @prjid and [isactived]	 = '0'  ) UPDATE [Prj_MaterialProcess]  SET [isactived]	 = '2'  WHERE ( [prjid]	 = @prjid and [isactived]	 = '0'  ) update [Prj_MemberProcess] set isactived='1'  WHERE ( [prjid]	 = @prjid and [isactived]='3'  ) update [Prj_ToolProcess] set isactived='1'  WHERE ( [prjid]	 = @prjid and [isactived]='3'  ) update [Prj_MaterialProcess] set isactived='1'  WHERE ( [prjid]	 = @prjid and [isactived]='3'  )  end set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Material_SelectAllProcess] (@prjid [int], @material varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT t1.*,t3.wbscoding,t3.subject,t2.id as taskrecordid FROM [Prj_MaterialProcess] as t1, [Prj_TaskProcess] as t2 , [Prj_TaskInfo] as t3 WHERE ( t1.prjid	 = @prjid and ( t1.isactived = '2' or t1.isactived = '3' ) and t1.material = @material and t2.prjid	 = @prjid and ( t2.isactived = '2' or t2.isactived = '3' )  and t1.taskid=t2.taskid and t3.prjid = @prjid and t3.taskid = t2.taskid and t3.version =t2.version ) order by t3.wbscoding  set @flag = 1 set @msg = 'OK!'

    GO
alter procedure [PrjTaskProcess_UOrder] (@processid_1  int , @upordown  int , @flag	int	output, @msg	varchar(4000)	output)  AS declare  @otherprocessid_1 int , @version_2 int , @projid_3 int , @parentid_4 int, @dsporderid_5 int select @dsporderid_5 = dsporder , @version_2 = version, @projid_3 = prjid, @parentid_4 = parentid from Prj_TaskProcess where ( id	 = @processid_1)  if @upordown = 1 begin select @otherprocessid_1 = id from Prj_TaskProcess where version = @version_2 and prjid = @projid_3 and parentid = @parentid_4 and dsporder = @dsporderid_5 - 1 update Prj_TaskProcess set dsporder = @dsporderid_5 - 1 where id = @processid_1 update Prj_TaskProcess set dsporder = @dsporderid_5 where id = @otherprocessid_1 end else begin select @otherprocessid_1 = id from Prj_TaskProcess where version = @version_2 and prjid = @projid_3 and parentid = @parentid_4 and dsporder = @dsporderid_5 + 1 update Prj_TaskProcess set dsporder = @dsporderid_5 + 1 where id = @processid_1 update Prj_TaskProcess set dsporder = @dsporderid_5 where id = @otherprocessid_1 end

GO
alter procedure [Prj_Process_SumCostTool] (@prjid [int], @wbscoding varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT sum(t3.workday*t3.cost) as cost FROM [Prj_TaskProcess] as t1, [Prj_TaskInfo] as t2, [Prj_ToolProcess] as t3 WHERE ( t1.prjid = @prjid and t1.isactived <> '0' and t1.isactived <> '1' and t2.prjid = @prjid and t1.taskid = t2.taskid  and t1.version	 = t2.version and t2.wbscoding like @wbscoding+'%' and t3.prjid = @prjid and t3.taskid = t1.taskid and (t3.isactived = '2' or t3.isactived = '3')) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Process_SumCostMember] (@prjid [int], @wbscoding varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT sum(t3.workday*t3.cost) as cost FROM [Prj_TaskProcess] as t1, [Prj_TaskInfo] as t2, [Prj_MemberProcess] as t3 WHERE ( t1.prjid = @prjid and t1.isactived <> '0' and t1.isactived <> '1' and t2.prjid = @prjid and t1.taskid = t2.taskid  and t1.version	 = t2.version and t2.wbscoding like @wbscoding+'%' and t3.prjid = @prjid and t3.taskid = t1.taskid and (t3.isactived = '2' or t3.isactived = '3')) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Process_SumCostMaterial] (@prjid [int], @wbscoding varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT sum(t3.quantity*t3.cost) as cost FROM [Prj_TaskProcess] as t1, [Prj_TaskInfo] as t2, [Prj_MaterialProcess] as t3 WHERE ( t1.prjid = @prjid and t1.isactived <> '0' and t1.isactived <> '1' and t2.prjid = @prjid and t1.taskid = t2.taskid  and t1.version	 = t2.version and t2.wbscoding like @wbscoding+'%' and t3.prjid = @prjid and t3.taskid = t1.taskid and (t3.isactived = '2' or t3.isactived = '3')) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Employee_CptSelectByID] @hrmid_1 int, @flag		int	output, @msg		varchar(4000) output as declare @mark_1 varchar(4000), @name_1 varchar(4000), @cptnum_1 int, @capitalid_1 int create table #temp(mark  varchar(4000) ,name  varchar(4000) ,cptnum int )  declare cpt_cursor cursor for select capitalid,cptnum from HrmCapitalUse WHERE hrmid =@hrmid_1 open cpt_cursor fetch next from cpt_cursor into @capitalid_1,@cptnum_1 while @@fetch_status=0 begin select @mark_1=mark,@name_1=name from CptCapital where id= @capitalid_1 insert INTO #temp(mark,name,cptnum) values(@mark_1,@name_1,@cptnum_1) fetch next from cpt_cursor into @capitalid_1,@cptnum_1 end close cpt_cursor deallocate cpt_cursor select * from #temp

GO
alter procedure [Doc_DirAcl_CheckPermissionEx2](@dirid_1 int, @dirtype_1 int, @userid_1 int, @usertype_1 int, @seclevel_1 int, @operationcode_1 int,@departmentid_1 int,@subcompanyid_1 int, @roleid_1 varchar(4000),@flag int output, @msg varchar(4000) output) AS declare @result_1 int declare @mainid_1 int execute Doc_DirAcl_CheckPermissionEx1 @dirid_1, @dirtype_1, @userid_1, @usertype_1, @seclevel_1, @operationcode_1,@departmentid_1,@subcompanyid_1,@roleid_1, @result_1 output, 1, 1 if @result_1 <> 1 begin declare @fatherid_1 int, @fatherid1_1 int if @dirtype_1 = 1 begin select @fatherid_1=parentid from DocSecCategory where id = @dirid_1 end else if @dirtype_1 = 2 begin select @fatherid_1=parentid from DocSecCategory where id = @dirid_1 if @fatherid_1 is null set @fatherid_1 = -1 if @fatherid_1 = 0 set @fatherid_1 = -1 end else begin set @fatherid_1 = -1 end while @fatherid_1 <> -1 begin execute Doc_DirAcl_CheckPermissionEx1 @fatherid_1, 2, @userid_1, @usertype_1, @seclevel_1, @operationcode_1,@departmentid_1,@subcompanyid_1,@roleid_1, @result_1 output, 1, 1 if @result_1 <> 1 begin select @fatherid1_1=parentid from DocSecCategory where id = @fatherid_1 set @fatherid_1 = @fatherid1_1 if @fatherid_1 is null set @fatherid_1 = -1 if @fatherid_1 = 0 set @fatherid_1 = -1 end else begin set @fatherid_1 = -1 end end end select @result_1 result if @@error<>0 begin set @flag=1 set @msg='检查目录访问权限成功' return end else begin set @flag=0 set @msg='检查目录访问权限失败' return end

GO
alter procedure [Doc_DirAcl_CheckPermissionEx](@dirid_1 int, @dirtype_1 int, @userid_1 int, @usertype_1 int, @seclevel_1 int, @operationcode_1 int,@departmentid_1 int,@subcompanyid_1 int, @roleid_1 varchar(4000),@flag int output, @msg varchar(4000) output) AS declare @result_1 int declare @mainid_1 int execute Doc_DirAcl_CheckPermissionEx1 @dirid_1, @dirtype_1, @userid_1, @usertype_1, @seclevel_1, @operationcode_1,@departmentid_1,@subcompanyid_1,@roleid_1, @result_1 output, 1, 1 if @result_1 <> 1 begin declare @fatherid_1 int, @fatherid1_1 int if @dirtype_1 = 1 begin select @fatherid_1=subcategoryid from DocSubCategory where id = @dirid_1 end else if @dirtype_1 = 2 begin select @fatherid_1=subcategoryid from DocSecCategory where id = @dirid_1 if @fatherid_1 is null set @fatherid_1 = -1 if @fatherid_1 = 0 set @fatherid_1 = -1 end else begin set @fatherid_1 = -1 end if @dirtype_1 = 1 begin select @mainid_1=maincategoryid from DocSubCategory where id = @dirid_1 execute Doc_DirAcl_CheckPermissionEx1 @mainid_1, 0, @userid_1, @usertype_1, @seclevel_1, @operationcode_1,@departmentid_1,@subcompanyid_1,@roleid_1, @result_1 output, 1, 1 if @result_1=1 begin set @fatherid_1 = -1 end end else if @dirtype_1 = 2 and @fatherid_1 <> -1 begin select @mainid_1=maincategoryid from DocSubCategory where id = @fatherid_1 execute Doc_DirAcl_CheckPermissionEx1 @mainid_1, 0, @userid_1, @usertype_1, @seclevel_1, @operationcode_1,@departmentid_1,@subcompanyid_1,@roleid_1, @result_1 output, 1, 1 if @result_1=1 begin set @fatherid_1 = -1 end end while @fatherid_1 <> -1 begin execute Doc_DirAcl_CheckPermissionEx1 @fatherid_1, 1, @userid_1, @usertype_1, @seclevel_1, @operationcode_1,@departmentid_1,@subcompanyid_1,@roleid_1, @result_1 output, 1, 1 if @result_1 <> 1 begin select @fatherid1_1=subcategoryid from DocSubCategory where id = @fatherid_1 set @fatherid_1 = @fatherid1_1 end else begin set @fatherid_1 = -1 end end end select @result_1 result if @@error<>0 begin set @flag=1 set @msg='检查目录访问权限成功' return end else begin set @flag=0 set @msg='检查目录访问权限失败' return end

GO
alter procedure [Share_forDoc_init] ( @docid int ) AS declare @sharetype int declare @newsharetype int declare @sharecontent varchar(4000)  declare @sharelevel int declare @foralluser int declare @departmentid int declare @subcompanyid int declare @userid int declare @ownerid int declare @createrid int declare @crmid int declare @temp_userid int declare @srcfrom int declare @opuser int declare @temp_departmentid int  declare @roleid int declare @rolelevel int declare @rolevalue int declare @seclevel int declare @sharesource int  declare @isExistInner int declare @isExistOuter int  declare @isSysadmin int BEGIN      declare docid_cursor cursor for select docid,sharetype,seclevel,userid,subcompanyid,departmentid,foralluser,sharelevel,roleid,rolelevel,crmid,sharesource from docshare where docid=@docid and docid>0  open docid_cursor fetch next from docid_cursor into @docid,@sharetype,@seclevel,@userid,@subcompanyid,@departmentid,@foralluser,@sharelevel,@roleid,@rolelevel,@crmid,@sharesource  while @@fetch_status=0 begin set @isExistInner=0 set @isExistOuter=0  if @sharetype=1 begin set @newsharetype=1 set @sharecontent=@userid set @seclevel=0 set @srcfrom=1 set @opuser=@userid  set @isExistInner=1 end  else if  @sharetype=2 begin set @newsharetype=2 set @sharecontent=@subcompanyid set @seclevel=@seclevel set @srcfrom=2 set @opuser=@subcompanyid set @isExistInner=1 end  else if  @sharetype=3 begin set @newsharetype=3 set @sharecontent=@departmentid set @seclevel=@seclevel set @srcfrom=3 set @opuser=@departmentid  set @isExistInner=1 end else if  @sharetype=5 begin set @newsharetype=5 set @sharecontent=1 set @seclevel=@seclevel set @srcfrom=5 set @opuser=0  set @isExistInner=1 end else if  @sharetype=80 begin set @newsharetype=1 set @sharecontent=@userid set @seclevel=0 set @srcfrom=80 set @opuser=@userid set @isExistInner=1   select @ownerid=ownerid, @createrid=doccreaterid  from docdetail where id=@docid if (@ownerid!=@createrid) begin insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource) values(@docid,1,@ownerid,0,@sharelevel,86,0,0) end end else if  @sharetype=81 begin select @isSysadmin=count(*) from hrmresourcemanager where id=@userid if (@isSysadmin!=1) begin set @newsharetype=1  SELECT  @sharecontent=managerid FROM HrmResource where id=@userid set @seclevel=0 set @srcfrom=81 set @opuser=@userid  set @isExistInner=1 end end else if  @sharetype=84 begin select @isSysadmin=count(*) from hrmresourcemanager where id=@userid if (@isSysadmin!=1) begin set @newsharetype=2  SELECT  @temp_departmentid=departmentid  FROM HrmResource where id=@userid select @sharecontent=subcompanyid1   from  HrmDepartment where id=@temp_departmentid  set @seclevel=@seclevel set @srcfrom=84 set @opuser=@userid  set @isExistInner=1 end end else if  @sharetype=85 begin select @isSysadmin=count(*) from hrmresourcemanager where id=@userid if (@isSysadmin!=1) begin set @newsharetype=3  SELECT @sharecontent=departmentid  FROM HrmResource where id=@userid set @seclevel=@seclevel set @srcfrom=85 set @opuser=@userid  set @isExistInner=1 end end  else if  @sharetype=-81 begin set @newsharetype=1 select @sharecontent=manager from CRM_CustomerInfo where id=@userid set @seclevel=0 set @srcfrom=-81 set @opuser=@userid  set @isExistInner=1 end else if  @sharetype=9 begin set @newsharetype=9 select @sharecontent=@crmid set @seclevel=0 set @srcfrom=9 set @opuser=@crmid  set @isExistOuter=1 end  else if  @sharetype=-80 begin set @newsharetype=9 select @sharecontent=@userid set @seclevel=0 set @srcfrom=-80 set @opuser=@userid  set @isExistOuter=1 end else if  @sharetype<0 and @sharetype>-80 begin set @newsharetype=10 select @sharecontent=STR(@sharetype*-1) set @srcfrom=10 set @opuser=@sharetype  set @isExistOuter=1 end else if  @sharetype=4 begin set @newsharetype=4 set @srcfrom=4 set @opuser=@roleid  if @docid is null set @docid=0 if @newsharetype is null set @newsharetype=0 if @sharecontent is null set @sharecontent=0 if @seclevel is null set @seclevel=0 if @sharelevel is null set @sharelevel=0 if @srcfrom is null set @srcfrom=0 if @opuser is null set @opuser=0 if @sharesource is null set @sharesource=0   IF @rolelevel=0 BEGIN set @sharecontent=CAST(STR(@roleid,9)+STR(0,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource ) set @sharecontent=CAST(STR(@roleid,9)+STR(1,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource ) set @sharecontent=CAST(STR(@roleid,9)+STR(2,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource ) END else  IF @rolelevel=1 BEGIN set @sharecontent=CAST(STR(@roleid,9)+STR(1,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource ) set @sharecontent=CAST(STR(@roleid,9)+STR(2,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource ) END else IF @rolelevel=2 BEGIN set @sharecontent=CAST(STR(@roleid,9)+STR(2,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource ) END set @isExistInner=0 end IF  @isExistInner=1 BEGIN if @docid is null set @docid=0 if @newsharetype is null set @newsharetype=0 if @sharecontent is null set @sharecontent=0 if @seclevel is null set @seclevel=0 if @sharelevel is null set @sharelevel=0 if @srcfrom is null set @srcfrom=0 if @opuser is null set @opuser=0 if @sharesource is null set @sharesource=0  insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource) values (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource) END  IF  @isExistOuter=1 BEGIN if @docid is null set @docid=0 if @newsharetype is null set @newsharetype=0 if @sharecontent is null set @sharecontent=0 if @seclevel is null set @seclevel=0 if @sharelevel is null set @sharelevel=0 if @srcfrom is null set @srcfrom=0 if @opuser is null set @opuser=0 if @sharesource is null set @sharesource=0  insert into ShareouterDoc(sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource) values (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource) END  fetch next from docid_cursor into  @docid,@sharetype,@seclevel,@userid,@subcompanyid,@departmentid,@foralluser,@sharelevel,@roleid,@rolelevel,@crmid,@sharesource end close docid_cursor deallocate docid_cursor END

GO
alter procedure [Share_forDoc] ( @docid int , @flag int output, @msg varchar(4000) output ) AS declare @sharetype int declare @newsharetype int declare @sharecontent varchar(4000)  declare @sharelevel int declare @foralluser int declare @departmentid int declare @subcompanyid int declare @userid int declare @ownerid int declare @createrid int declare @crmid int declare @orgGroupId int declare @temp_userid int declare @srcfrom int declare @opuser int declare @temp_departmentid int  declare @roleid int declare @rolelevel int declare @rolevalue int declare @seclevel int declare @sharesource int  declare @isExistInner int declare @isExistOuter int  declare @isSysadmin int declare @hasmanager int declare @downloadlevel int BEGIN  DELETE ShareinnerDoc  WHERE  sourceid=@docid DELETE ShareouterDoc  WHERE  sourceid=@docid    declare docid_cursor cursor for select docid,sharetype,seclevel,userid,subcompanyid,departmentid,foralluser,sharelevel,roleid,rolelevel,crmid,orgGroupId,sharesource,downloadlevel from docshare where docid=@docid and docid>0  open docid_cursor fetch next from docid_cursor into @docid,@sharetype,@seclevel,@userid,@subcompanyid,@departmentid,@foralluser,@sharelevel,@roleid,@rolelevel,@crmid,@orgGroupId,@sharesource,@downloadlevel  while @@fetch_status=0 begin set @isExistInner=0 set @isExistOuter=0 if @downloadlevel is null set @downloadlevel=0  if @sharetype=1    begin set @newsharetype=1 set @sharecontent=@userid set @seclevel=0 set @srcfrom=1 set @opuser=@userid  set @isExistInner=1 end  else if  @sharetype=2   begin set @newsharetype=2 set @sharecontent=@subcompanyid set @seclevel=@seclevel set @srcfrom=2 set @opuser=@subcompanyid set @isExistInner=1 end  else if  @sharetype=3   begin set @newsharetype=3 set @sharecontent=@departmentid set @seclevel=@seclevel set @srcfrom=3 set @opuser=@departmentid  set @isExistInner=1 end else if  @sharetype=6   begin set @newsharetype=6 set @sharecontent=@orgGroupId set @seclevel=@seclevel set @srcfrom=6 set @opuser=@orgGroupId  set @isExistInner=1 end else if  @sharetype=5   begin set @newsharetype=5 set @sharecontent=1 set @seclevel=@seclevel set @srcfrom=5 set @opuser=0  set @isExistInner=1 end else if  @sharetype=80   begin set @newsharetype=1 set @sharecontent=@userid set @seclevel=0 set @srcfrom=80 set @opuser=@userid set @isExistInner=1   select @ownerid=ownerid, @createrid=doccreaterid  from docdetail where id=@docid if (@ownerid!=@createrid) begin insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource,downloadlevel) values(@docid,1,@ownerid,0,@sharelevel,86,0,0,@downloadlevel) end end else if  @sharetype=81   begin select @isSysadmin=count(*) from hrmresourcemanager where id=@userid select  @hasmanager=count(*)  from hrmresource a,hrmresource b     where a.id=b.managerid and b.id= @userid  if (@isSysadmin!=1 and @hasmanager=1) begin set @newsharetype=1  SELECT  @sharecontent=managerid FROM HrmResource where id=@userid set @seclevel=0 set @srcfrom=81 set @opuser=@userid  set @isExistInner=1 end end else if  @sharetype=84   begin select @isSysadmin=count(*) from hrmresourcemanager where id=@userid if (@isSysadmin!=1) begin set @newsharetype=2  SELECT  @temp_departmentid=departmentid  FROM HrmResource where id=@userid select @sharecontent=subcompanyid1   from  HrmDepartment where id=@temp_departmentid  set @seclevel=@seclevel set @srcfrom=84 set @opuser=@userid  set @isExistInner=1 end end else if  @sharetype=85   begin select @isSysadmin=count(*) from hrmresourcemanager where id=@userid if (@isSysadmin!=1) begin set @newsharetype=3  SELECT @sharecontent=departmentid  FROM HrmResource where id=@userid set @seclevel=@seclevel set @srcfrom=85 set @opuser=@userid  set @isExistInner=1 end end  else if  @sharetype=-81   begin set @newsharetype=1 select @sharecontent=manager from CRM_CustomerInfo where id=@userid  set @seclevel=0 set @srcfrom=-81 set @opuser=@userid  set @isExistInner=1 end else if  @sharetype=9   begin set @newsharetype=9 select @sharecontent=@crmid set @seclevel=0 set @srcfrom=9 set @opuser=@crmid  set @isExistOuter=1 end  else if  @sharetype=-80   begin set @newsharetype=9 select @sharecontent=@userid set @seclevel=0 set @srcfrom=-80 set @opuser=@userid  set @isExistOuter=1 end else if  @sharetype<0  begin set @newsharetype=10 select @sharecontent=STR(@sharetype*-1) set @srcfrom=10 set @opuser=@sharetype  set @isExistOuter=1 end else if  @sharetype=4   begin set @newsharetype=4 set @srcfrom=4 set @opuser=@roleid  if @docid is null set @docid=0 if @newsharetype is null set @newsharetype=0 if @sharecontent is null set @sharecontent=0 if @seclevel is null set @seclevel=0 if @sharelevel is null set @sharelevel=0 if @srcfrom is null set @srcfrom=0 if @opuser is null set @opuser=0 if @sharesource is null set @sharesource=0   IF @rolelevel=0  BEGIN set @sharecontent=CAST(STR(@roleid,9)+STR(0,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource,downloadlevel) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource,@downloadlevel ) set @sharecontent=CAST(STR(@roleid,9)+STR(1,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource,downloadlevel) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource,@downloadlevel ) set @sharecontent=CAST(STR(@roleid,9)+STR(2,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource,downloadlevel) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource,@downloadlevel ) END else  IF @rolelevel=1  BEGIN set @sharecontent=CAST(STR(@roleid,9)+STR(1,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource,downloadlevel) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource,@downloadlevel ) set @sharecontent=CAST(STR(@roleid,9)+STR(2,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource,downloadlevel) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource,@downloadlevel ) END else IF @rolelevel=2  BEGIN set @sharecontent=CAST(STR(@roleid,9)+STR(2,1) AS INT) insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource,downloadlevel) values  (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource,@downloadlevel ) END set @isExistInner=0   end IF  @isExistInner=1 BEGIN if @docid is null set @docid=0 if @newsharetype is null set @newsharetype=0 if @sharecontent is null set @sharecontent=0 if @seclevel is null set @seclevel=0 if @sharelevel is null set @sharelevel=0 if @srcfrom is null set @srcfrom=0 if @opuser is null set @opuser=0 if @sharesource is null set @sharesource=0   insert into ShareinnerDoc  (sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource,downloadlevel) values (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource,@downloadlevel) END  IF  @isExistOuter=1 BEGIN if @docid is null set @docid=0 if @newsharetype is null set @newsharetype=0 if @sharecontent is null set @sharecontent=0 if @seclevel is null set @seclevel=0 if @sharelevel is null set @sharelevel=0 if @srcfrom is null set @srcfrom=0 if @opuser is null set @opuser=0 if @sharesource is null set @sharesource=0   insert into ShareouterDoc(sourceid,type,content,seclevel,sharelevel,srcfrom,opuser,sharesource,downloadlevel) values (@docid,@newsharetype,@sharecontent,@seclevel,@sharelevel,@srcfrom,@opuser,@sharesource,@downloadlevel) END   fetch next from docid_cursor into  @docid,@sharetype,@seclevel,@userid,@subcompanyid,@departmentid,@foralluser,@sharelevel,@roleid,@rolelevel,@crmid,@orgGroupId,@sharesource,@downloadlevel end close docid_cursor deallocate docid_cursor END

GO
alter procedure [Share_forcrm_init] ( @crmid int ) AS  declare @managerid int declare @managerstr varchar(4000) declare @tempmanagerid int  delete  from CRM_ShareInfo where isdefault='1' and relateditemid=@crmid  select @managerid=manager from CRM_CustomerInfo where id=@crmid if @managerid is not null begin   select @managerstr=managerstr+'-1' from hrmresource where id=@managerid if @managerstr is not null begin declare hrmid_cursor cursor for  select id from hrmresource where charindex(','+convert(varchar(4000),id)+',',','+@managerstr+',')>0  and id!=@managerid open hrmid_cursor fetch next from hrmid_cursor into @tempmanagerid while @@fetch_status=0 begin insert into CRM_ShareInfo (relateditemid,sharetype,seclevel,sharelevel,crmid,isdefault,userid) values (@crmid,1,0,3,0,1,@tempmanagerid) fetch next from hrmid_cursor into @tempmanagerid end close hrmid_cursor deallocate hrmid_cursor end    end

GO
alter procedure [CRM_SellChance_Statistics] ( @userid_1 int, @usertype_1 char(1), @flag	int	output, @msg	varchar(4000)	output) as declare @result_1 int, @sucess_1 int, @failure_1 int, @nothing_1 int  create table #temp( result  int , sucess  int, failure	int, nothing	int) select @result_1= count(*) from CRM_SellChance t1,CrmShareDetail t2,CRM_CustomerInfo t3 where  t3.deleted=0 and t3.id= t1.customerid and t1.customerid = t2.crmid and t2.usertype=@usertype_1  and t2.userid=@userid_1  select @sucess_1= count(t1.id) from CRM_SellChance t1,CrmShareDetail t2,CRM_CustomerInfo t3 where   t1.endtatusid ='1' and t3.deleted=0 and t3.id= t1.customerid and t1.customerid = t2.crmid and t2.usertype=@usertype_1  and t2.userid=@userid_1  select @failure_1= count(t1.id)  from CRM_SellChance t1,CrmShareDetail t2,CRM_CustomerInfo t3 where   t1.endtatusid ='2' and t3.deleted=0 and t3.id= t1.customerid and t1.customerid = t2.crmid and t2.usertype=@usertype_1  and t2.userid=@userid_1  select @nothing_1= count(t1.id)  from CRM_SellChance t1,CrmShareDetail t2,CRM_CustomerInfo t3 where   t1.endtatusid ='0' and t3.deleted=0 and t3.id= t1.customerid and t1.customerid = t2.crmid and t2.usertype=@usertype_1  and t2.userid=@userid_1  insert INTO #temp(result,sucess,failure,nothing) values(@result_1,@sucess_1,@failure_1,@nothing_1) select * from #temp

GO
alter procedure [Crm_ExcelToDB] ( @department int, @subcompanyid1 int, @name varchar(4000), @engname varchar(4000), @address1 varchar(4000), @zipcode varchar(4000), @phone varchar(4000), @fax varchar(4000), @email varchar(4000), @country  varchar(4000), @type int, @description int, @size int, @sector int, @creditamount varchar(4000), @credittime int, @website varchar(4000), @city int, @province int , @manager int, @status int, @crmCode varchar(4000), @bankName varchar(4000), @accountName varchar(4000), @accounts varchar(4000), @createdate varchar(4000), @flag int output, @msg varchar(4000) output ) as insert into Crm_CustomerInfo (department,subcompanyid1,name,engname,address1,zipcode,phone,fax,email,country,type,description , size_n,sector,creditamount,credittime,deleted,status,rating,website,source,manager,city,province,language,crmcode,bankName,accountName,accounts,createdate,seclevel) values (@department,@subcompanyid1,@name,@engname,@address1,@zipcode,@phone,@fax,@email,@country,@type,@description, @size, @sector,cast(@creditamount as decimal(9)),@credittime,'0',@status,'1',@website,'9',@manager,@city,@province,'7',@crmCode,@bankName,@accountName,@accounts,@createdate,0)

GO
alter procedure [CRM_Evaluation_L_Delete] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output) AS IF EXISTS(SELECT id FROM CRM_CustomerInfo WHERE evaluation = @id_1) BEGIN SELECT -1 RETURN END  DELETE CRM_Evaluation_Level WHERE id = @id_1

GO
alter procedure [CRM_CustomerInfo_Update] ( @id int, @name varchar(4000), @language int, @engname varchar(4000), @address1 varchar(4000), @address2 varchar(4000), @address3 varchar(4000), @zipcode varchar(4000), @city	int, @country int, @province int, @county varchar(4000), @phone varchar(4000), @fax varchar(4000), @email varchar(4000), @website varchar(4000), @source int, @sector int, @size_n	int, @manager int, @agent int, @parentid int, @department int, @subcompanyid1 int, @fincode int, @currency int, @contractlevel	int, @creditlevel int, @creditoffset varchar(4000), @discount real, @taxnumber varchar(4000), @bankacount varchar(4000), @invoiceacount int, @deliverytype int, @paymentterm int, @paymentway int, @saleconfirm int, @creditcard varchar(4000), @creditexpire varchar(4000), @documentid int, @seclevel int, @picid int, @type int, @typebegin varchar(4000), @description int, @status int, @rating int, @introductionDocid int, @CreditAmount decimal(10, 2), @CreditTime int, @datefield1 varchar(4000), @datefield2 varchar(4000), @datefield3 varchar(4000), @datefield4 varchar(4000), @datefield5 varchar(4000), @numberfield1 float, @numberfield2 float, @numberfield3 float, @numberfield4 float, @numberfield5 float, @textfield1 varchar(4000), @textfield2 varchar(4000), @textfield3 varchar(4000), @textfield4 varchar(4000), @textfield5 varchar(4000), @tinyintfield1 tinyint, @tinyintfield2 tinyint, @tinyintfield3 tinyint, @tinyintfield4 tinyint, @tinyintfield5 tinyint, @bankName varchar(4000), @accountName varchar(4000), @accounts varchar(4000), @crmCode varchar(4000),@introduction varchar(4000), @flag int output, @msg varchar(4000) output) AS UPDATE CRM_CustomerInfo SET name = @name, language = @language, engname = @engname, address1 = @address1, address2 = @address2, address3 = @address3, zipcode = @zipcode, city = @city, country = @country, province = @province, county = @county, phone = @phone, fax = @fax, email = @email, website	= @website, source = @source, sector = @sector, size_n = @size_n, manager = @manager, agent = @agent, parentid = @parentid, department = @department, subcompanyid1	= @subcompanyid1, fincode = @fincode, currency = @currency, contractlevel = @contractlevel, creditlevel = @creditlevel, creditoffset = convert(money,@creditoffset), discount = @discount, taxnumber = @taxnumber, bankacount = @bankacount, invoiceacount = @invoiceacount, deliverytype = @deliverytype, paymentterm = @paymentterm, paymentway = @paymentway, saleconfirm = @saleconfirm, creditcard = @creditcard, creditexpire = @creditexpire, documentid = @documentid, seclevel = @seclevel, picid = @picid, type = @type, typebegin = @typebegin, description = @description, status = @status, rating = @rating, datefield1 = @datefield1, datefield2 = @datefield2, datefield3 = @datefield3, datefield4 = @datefield4, datefield5 = @datefield5, numberfield1 = @numberfield1, numberfield2 = @numberfield2, numberfield3 = @numberfield3, numberfield4 = @numberfield4, numberfield5 = @numberfield5, textfield1 = @textfield1, textfield2 = @textfield2, textfield3 = @textfield3, textfield4 = @textfield4, textfield5 = @textfield5, tinyintfield1 = @tinyintfield1, tinyintfield2 = @tinyintfield2, tinyintfield3 = @tinyintfield3, tinyintfield4	= @tinyintfield4, tinyintfield5 = @tinyintfield5, introductionDocid = @introductionDocid, CreditAmount = @CreditAmount, CreditTime = @CreditTime, bankName = @bankName, accountName = @accountName, accounts = @accounts, crmcode = @crmCode,introduction = @introduction WHERE (id = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerInfo_SSumByManager] @id	int , @flag	[int]	output, @msg	varchar(4000)	output AS select count(id) from CRM_CustomerInfo where manager = @id

GO
alter procedure [CRM_CustomerInfo_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerInfo] WHERE ([id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerInfo_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [CRM_CustomerInfo] set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerInfo_SByLoginID] ( @portalloginid varchar(4000), @flag  integer output, @msg  varchar(4000) output ) AS select * from CRM_CustomerInfo where portalloginid = @portalloginid set @flag=1 set @msg='ok'

GO
alter procedure [CRM_CustomerInfo_PortalPasswor] (@id [int], @portalloginid varchar(4000), @portalpassword varchar(4000), @flag	[int] output, @msg varchar(4000) output) AS UPDATE [CRM_CustomerInfo]  SET [portalloginid] = @portalloginid , [portalpassword] = @portalpassword  WHERE ( [id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerInfo_Portal] (@id [int], @portalstatus [int], @flag	[int] output, @msg varchar(4000) output) AS UPDATE [CRM_CustomerInfo]  SET [portalstatus] = @portalstatus WHERE ( [id] = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerInfo_InsertID] (@flag	[int]	output, @msg	varchar(4000)	output)  AS SELECT top 1 id from CRM_CustomerInfo ORDER BY id DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerInfo_InsertByCpt] ( @name varchar(4000), @manager int, @CreditAmount decimal(15, 2), @CreditTime int, @flag int output, @msg	varchar(4000) output) AS INSERT INTO CRM_CustomerInfo ( name, engname, manager, CreditAmount, CreditTime, status, deleted, type) VALUES ( @name, @name, @manager, @CreditAmount, @CreditTime, 1, 0, 2) SELECT top 1 id from CRM_CustomerInfo ORDER BY id DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerInfo_Insert] ( @name varchar(4000), @language int, @engname varchar(4000), @address1 varchar(4000), @address2 varchar(4000), @address3 varchar(4000), @zipcode varchar(4000), @city	int, @country int, @province int, @county varchar(4000), @phone varchar(4000), @fax varchar(4000), @email varchar(4000), @website varchar(4000), @source int, @sector int, @size_n	int, @manager int, @agent int, @parentid int, @department int, @subcompanyid1 int, @fincode int, @currency int, @contractlevel	int, @creditlevel int, @creditoffset varchar(4000), @discount real, @taxnumber varchar(4000), @bankacount varchar(4000), @invoiceacount	int, @deliverytype int, @paymentterm int, @paymentway int, @saleconfirm int, @creditcard varchar(4000), @creditexpire varchar(4000), @documentid int, @seclevel int, @picid int, @type int, @typebegin varchar(4000), @description int, @status int, @rating int, @introductionDocid int, @CreditAmount decimal(10, 2) , @CreditTime int, @datefield1 varchar(4000), @datefield2 varchar(4000), @datefield3 varchar(4000), @datefield4 varchar(4000), @datefield5 varchar(4000), @numberfield1 float, @numberfield2 float, @numberfield3 float, @numberfield4 float, @numberfield5 float, @textfield1 varchar(4000), @textfield2 varchar(4000), @textfield3 varchar(4000), @textfield4 varchar(4000), @textfield5 varchar(4000), @tinyintfield1 tinyint, @tinyintfield2 tinyint, @tinyintfield3 tinyint, @tinyintfield4 tinyint, @tinyintfield5 tinyint, @createdate varchar(4000), @bankName varchar(4000), @accountName varchar(4000), @accounts varchar(4000), @crmCode varchar(4000),@introduction varchar(4000), @flag int output, @msg	varchar(4000) output) AS INSERT INTO CRM_CustomerInfo ( name, language, engname, address1, address2, address3, zipcode, city, country, province, county, phone, fax, email, website, source, sector, size_n, manager, agent, parentid, department, subcompanyid1, fincode, currency, contractlevel, creditlevel, creditoffset, discount, taxnumber, bankacount, invoiceacount, deliverytype, paymentterm, paymentway, saleconfirm, creditcard, creditexpire, documentid, seclevel, picid, type, typebegin, description, status, rating, datefield1, datefield2, datefield3, datefield4, datefield5, numberfield1, numberfield2, numberfield3, numberfield4, numberfield5, textfield1, textfield2, textfield3, textfield4, textfield5, tinyintfield1, tinyintfield2, tinyintfield3, tinyintfield4, tinyintfield5, deleted, createdate, introductionDocid, CreditAmount, CreditTime, bankName, accountName, accounts, crmcode,introduction) VALUES ( @name, @language, @engname, @address1, @address2, @address3, @zipcode, @city, @country, @province, @county, @phone, @fax, @email, @website, @source, @sector, @size_n, @manager, @agent, @parentid, @department, @subcompanyid1, @fincode, @currency, @contractlevel, @creditlevel, convert(money,@creditoffset), @discount, @taxnumber, @bankacount, @invoiceacount, @deliverytype, @paymentterm, @paymentway, @saleconfirm, @creditcard, @creditexpire, @documentid, @seclevel, @picid, @type, @typebegin, @description, @status, @rating, @datefield1, @datefield2, @datefield3, @datefield4, @datefield5, @numberfield1, @numberfield2, @numberfield3, @numberfield4, @numberfield5, @textfield1, @textfield2, @textfield3, @textfield4, @textfield5, @tinyintfield1, @tinyintfield2, @tinyintfield3, @tinyintfield4, @tinyintfield5, 0, @createdate, @introductionDocid, @CreditAmount , @CreditTime, @bankName, @accountName, @accounts, @crmCode,@introduction) SELECT top 1 id from CRM_CustomerInfo ORDER BY id DESC set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerInfo_Delete] (@id 		[int], @deleted 	[tinyint], @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_CustomerInfo]  SET [deleted] = @deleted WHERE ( [id] = @id) delete from CRM_Contract where( crmId = @id ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [CRM_CustomerInfo_Approve] (@id 		[int], @status 	[int], @rating 	[int],  @flag	[int]	output, @msg	varchar(4000)	output) AS UPDATE [CRM_CustomerInfo]  SET  	  [status]	 = @status, [rating]	 = @rating  WHERE ( [id]	 = @id) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Tool_SelectAllProcess] (@prjid [int], @relateid [int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT t1.*,t3.wbscoding,t3.subject,t2.id as taskrecordid FROM [Prj_toolProcess] as t1, [Prj_TaskProcess] as t2 , [Prj_TaskInfo] as t3 WHERE ( t1.prjid	 = @prjid and ( t1.isactived = '2' or t1.isactived = '3' ) and t1.relateid = @relateid and t2.prjid	 = @prjid and ( t2.isactived = '2' or t2.isactived = '3' )  and t1.taskid=t2.taskid and t3.prjid = @prjid and t3.taskid = t2.taskid and t3.version =t2.version ) order by t3.wbscoding  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [docDetailLog_QueryByDate] (@fromdate_1 	[char](10) , @todate_1 	[char](10) , @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT docid, SUM(readCount) AS COUNT FROM docReadTag where docid in (select id from docdetail) and docid in (SELECT docid FROM DocDetailLog WHERE (operatedate >= @fromdate_1) AND (operatedate <= @todate_1))GROUP BY docid ORDER BY COUNT DESC

GO
alter procedure [Prj_TaskProcess_UpdateParent] (@parentid	int, @flag integer output, @msg varchar(4000) output ) AS Declare @begindate varchar(4000), @enddate varchar(4000), @workday decimal (10,1), @finish int , @fixedcost_1 decimal(10,2) select @begindate = min(begindate), @enddate = max(enddate), @workday = sum(workday), @finish = convert(int,sum(workday*finish)/sum(workday)) , @fixedcost_1 = sum(fixedcost) from Prj_TaskProcess where parentid=@parentid   if @finish>100 set @finish=100  UPDATE Prj_TaskProcess SET begindate = @begindate, enddate = @enddate, workday = @workday, finish = @finish  , fixedcost = @fixedcost_1 WHERE ( id = @parentid)

GO
alter procedure [Prj_TaskProcess_Update] (@id	int, @wbscoding varchar(4000), @subject 	varchar(4000) , @begindate 	varchar(4000), @enddate 	varchar(4000), @actualbegindate 	varchar(4000), @actualenddate 	varchar(4000), @workday decimal (10,1), @content 	text,  @fixedcost decimal (18,2), @hrmid int, @oldhrmid int, @finish tinyint, @taskconfirm char(1), @islandmark char(1), @prefinish_1 varchar(4000), @realManDays decimal (6,1), @flag integer output, @msg varchar(4000) output ) AS UPDATE Prj_TaskProcess SET wbscoding = @wbscoding, subject = @subject , begindate = @begindate, enddate = @enddate 	, actualbegindate = @actualbegindate, actualenddate = @actualenddate 	, workday = @workday, content = @content, fixedcost = @fixedcost, hrmid = @hrmid, finish = @finish , taskconfirm = @taskconfirm, islandmark = @islandmark, prefinish = @prefinish_1, realManDays = @realManDays WHERE ( id	 = @id) if @hrmid<>@oldhrmid begin Declare @currenthrmid varchar(4000), @currentoldhrmid varchar(4000) set @currenthrmid='|' + convert(varchar(4000), @id) + ',' + convert(varchar(4000), @hrmid) + '|' set @currentoldhrmid='|' + convert(varchar(4000), @id) + ',' + convert(varchar(4000), @oldhrmid) + '|' UPDATE Prj_TaskProcess set parenthrmids=replace(parenthrmids,@currentoldhrmid,@currenthrmid) where (parenthrmids like '%'+@currentoldhrmid+'%') end set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskProcess_UParentHrmIds]( @hrmid int, @oldhrmid int, @id int, @flag int output, @msg varchar(4000) output ) AS  if @hrmid<>@oldhrmid begin Declare @currenthrmid varchar(4000), @currentoldhrmid varchar(4000) set @currenthrmid='|' + convert(varchar(4000), @id) + ',' + convert(varchar(4000), @hrmid) + '|' set @currentoldhrmid='|' + convert(varchar(4000), @id) + ',' + convert(varchar(4000), @oldhrmid) + '|' UPDATE Prj_TaskProcess set parenthrmids=replace(parenthrmids,@currentoldhrmid,@currenthrmid) where (parenthrmids like '%'+@currentoldhrmid+'%') end set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskProcess_Sum] ( @prjid 	int, @flag	int		output, @msg	varchar(4000)	output) AS  DECLARE @sumWorkday decimal(9) SELECT @sumWorkday=SUM(workday) FROM Prj_TaskProcess WHERE ( prjid = @prjid and parentid = '0' and isdelete<>'1') IF @sumWorkday<>0 BEGIN SELECT sum(workday) as workday, min(begindate) as begindate, max(enddate) as enddate, min(actualBeginDate) as actualBeginDate, max(actualEndDate) as actualEndDate, sum(finish*workday)/sum(workday) as finish, sum(fixedcost) as fixedcost FROM Prj_TaskProcess WHERE ( prjid = @prjid and parentid = '0' and isdelete<>'1') END ELSE BEGIN SELECT sum(workday) as workday, min(begindate) as begindate, max(enddate) as enddate, min(actualBeginDate) as actualBeginDate, max(actualEndDate) as actualEndDate, 0 as finish, sum(fixedcost) as fixedcost FROM Prj_TaskProcess WHERE ( prjid = @prjid and parentid = '0' and isdelete<>'1') END

GO
alter procedure [Prj_TaskProcess_SMAXID] @flag integer output, @msg varchar(4000) output as  select max(id) as maxid_1  from Prj_TaskProcess

GO
alter procedure [Prj_TaskProcess_SelectByID] (@id 	[int], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_TaskProcess] WHERE ( id	 = @id ) set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskProcess_SelectAll] (@prjid [int], @level_n [tinyint], @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_TaskProcess] WHERE ( [prjid]	 = @prjid and  [level_n] <= @level_n and isdelete<>'1') order by parentids  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_TaskProcess_Insert] (@prjid 	int, @taskid 	int, @wbscoding 	varchar(4000), @subject 	varchar(4000) , @version 	tinyint, @begindate 	varchar(4000), @enddate 	varchar(4000), @workday decimal (10,1), @content 	text, @fixedcost decimal (18,2), @parentid int, @parentids varchar(4000), @parenthrmids varchar(4000), @level_n tinyint, @hrmid int, @prefinish_1 varchar(4000), @realManDays decimal (6,1), @taskIndex int, @flag integer output, @msg varchar(4000) output  ) AS declare @dsporder_9 int, @current_maxid int  select @current_maxid = max(dsporder) from Prj_TaskProcess where prjid = @prjid and version = @version and parentid = @parentid and isdelete<>'1' if @current_maxid is null set @current_maxid = 0 set @dsporder_9 = @current_maxid + 1  INSERT INTO Prj_TaskProcess ( prjid, taskid , wbscoding, subject , version , begindate, enddate, workday, content, fixedcost, parentid, parentids, parenthrmids, level_n, hrmid, islandmark, prefinish, dsporder, realManDays, taskIndex ) VALUES ( @prjid, @taskid , @wbscoding, @subject , @version , @begindate, @enddate, @workday, @content, @fixedcost, @parentid, @parentids, @parenthrmids, @level_n, @hrmid,'0',@prefinish_1,@dsporder_9, @realManDays,@taskIndex) Declare @id int, @maxid varchar(4000), @maxhrmid varchar(4000) select @id = max(id) from Prj_TaskProcess set @maxid = convert(varchar(4000), @id) + ',' set @maxhrmid = '|' + convert(varchar(4000), @id) + ',' + convert(varchar(4000), @hrmid) + '|' update Prj_TaskProcess set parentids=parentids+@maxid, parenthrmids=parenthrmids+@maxhrmid  where id=@id  set @flag = @@identity set @msg = 'OK!'

GO
alter procedure [Prj_TaskProcess_DeleteByID] (@id varchar(4000), @flag integer output, @msg varchar(4000) output ) AS declare @dsporder_1 int ,  @prjid_2 int , @version_3 int , @parentid_4 int  select @dsporder_1 = dsporder , @prjid_2 = prjid, @version_3 = version , @parentid_4 = parentid from Prj_TaskProcess where ( id	 = @id )  update Prj_TaskProcess set dsporder = dsporder - 1 where  prjid = @prjid_2 and version = @version_3 and parentid = @parentid_4 and isdelete<>'1' and dsporder > @dsporder_1  update Prj_TaskProcess set isdelete='1' , dsporder = -1 WHERE ( id	 = @id or ','+parentids like  '%,'+@id+',%')  update Prj_TaskProcess set childnum = childnum -1 where id = @parentid_4

GO
alter procedure [HrmRightTransfer_CRM] @fromid	int, @toid	int, @customerid	int, @flag	int	output, @msg	varchar(4000) output as if	@customerid=0 begin declare @all_cursor cursor, @tempid		int SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id from CRM_CustomerInfo where manager=@fromid OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @tempid  WHILE @@FETCH_STATUS = 0 begin update CRM_CustomerInfo set manager=@toid where id=@tempid FETCH NEXT FROM @all_cursor INTO @tempid end CLOSE @all_cursor DEALLOCATE @all_cursor end else update CRM_CustomerInfo set manager=@toid where id=@customerid if @@error<>0 begin set @flag=1 set @msg='插入失败' end else begin set @flag=0 set @msg='操作成功' end

  GO
alter procedure  [DocMark_update]( @id int , @docId int , @markHrmType int , @markHrmId int, @mark int, @remark varchar(4000), @markDate char(10), @flag integer output , @msg varchar(4000) output ) AS update  docmark set docId = @docId,markHrmType = @markHrmType,markHrmId = @markHrmId,mark = @mark,remark = @remark,markDate = @markDate where id = @id select max(id) from  DocMark

  GO
alter procedure [DocMark_SelectById]( @id int , @flag integer output , @msg varchar(4000) output ) AS select * from DocMark where id =  @id

  GO
alter procedure [DocMark_SelectByDocId]( @docId int , @flag integer output , @msg varchar(4000) output ) AS select * from DocMark where docid =  @docId

GO
alter procedure [docReadTag_SRead] @docid_1  int, @userid_2 int, @usertype_3 int, @flag integer output , @msg varchar(4000) output as declare @count1 int , @count2 int select @count1 = count(docid) from docReadTag where docid=@docid_1 and userid=@userid_2 and usertype=@usertype_3 select @count2 = count(id) from docdetail where id=@docid_1 and doccreaterid=@userid_2 and usertype=convert(char(1),@usertype_3)  if @count1 is null set @count1 = 0 ; if @count2 is null set @count2 = 0 ; select @count1 + @count2

GO
alter procedure [docReadTag_SelectByuserid] (@docid_1 	[int] , @userid_2 	[int] , @userType_3	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS select  userid   from docReadTag where docid = @docid_1 and userid = @userid_2 and userType = @userType_3

  GO
alter procedure [docReadTag_AddByUser] (@docid_1 	int , @userid_2 	int , @userType_3	int , @flag	int	output, @msg	varchar(4000)	output) AS declare @readcount int select @readcount = count(userid) from docReadTag where docid = @docid_1 and userid = @userid_2 and userType = @userType_3  if @readcount is not null and @readcount > 0 update DocReadTag set readcount = readcount+1 where docid = @docid_1 and userid = @userid_2 and userType = @userType_3 else insert into  DocReadTag (docid,userid,readcount,usertype) values(@docid_1, @userid_2, 1, @userType_3)

GO
alter procedure [HrmRSRPath_SeByURId] @userid int,@rightstr varchar(4000), @flag integer output , @msg varchar(4000) output AS  declare @temptree1 Table (subcompanyid int ,rightlevel int) declare @temptree2 Table (id int ) declare @temptree3 Table (id int )   insert @temptree1 select subcompanyid,min(rightlevel) as rightlevel from SysRoleSubcomRight where roleid in(select a.roleid from HrmRoleMembers a,SystemRightRoles b where a.roleid=b.roleid and a.resourceid=@userid and b.rightid =(select rightid from SystemRightDetail where rightdetail=@rightstr) ) group by subcompanyid   insert @temptree2 select b.subcompanyid from hrmsubcompany a,@temptree1 b where a.id=b.subcompanyid and a.supsubcomid<>0 and a.supsubcomid not in(select subcompanyid from @temptree1)   declare c1 cursor for select id from @temptree2 open c1 declare  @tempsubid int fetch next from c1 into @tempsubid while @@fetch_status=0 begin insert @temptree3 select id from getSubComParentTree(@tempsubid) fetch next from c1 into @tempsubid end close c1 deallocate c1  select * from  @temptree1 union select distinct(id),-1 from @temptree3

GO
alter procedure [HrmResourceShare] ( @resourceid_1 INT , @departmentid_1 INT , @subcompanyid_1 INT , @managerid_1 INT , @seclevel_1 INT , @managerstr_1 varchar(4000) , @olddepartmentid_1 INT , @oldsubcompanyid_1 INT , @oldmanagerid_1 INT , @oldseclevel_1 INT , @oldmanagerstr_1 varchar(4000) , @flag_1 INT , @flag INT OUTPUT , @msg varchar(4000) OUTPUT ) AS DECLARE @supresourceid_1 INT , @docid_1 INT , @crmid_1 INT , @prjid_1 INT , @cptid_1 INT , @sharelevel_1 INT , @countrec INT , @countdelete INT , @contractid_1 INT , @contractroleid_1 INT , @sharelevel_Temp INT , @workPlanId_1 INT IF ( ( @flag_1 = 1 AND ( @departmentid_1 <> @olddepartmentid_1 OR @oldsubcompanyid_1 <> @subcompanyid_1 OR @seclevel_1 <> @oldseclevel_1 OR @oldseclevel_1 IS NULL ) ) OR @flag_1 = 0 ) BEGIN  DECLARE @temptablevaluecrm TABLE ( crmid INT , sharelevel INT )  DECLARE @managerstr_11 varchar(4000)  SET @managerstr_11 = '%,' + CONVERT(varchar(4000), @resourceid_1) + ',%'   DECLARE @temptablevaluecontract TABLE ( contractid INT , sharelevel INT ) SET @managerstr_11 = '%,' + CONVERT(varchar(4000), @resourceid_1) + ',%'  DECLARE subcontractid_cursor CURSOR FOR SELECT  id FROM    CRM_Contract WHERE   ( manager IN ( SELECT DISTINCT id FROM      HrmResource WHERE     ',' + managerstr LIKE @managerstr_11 ) ) OPEN subcontractid_cursor FETCH NEXT FROM subcontractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF @countrec = 0 INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, 3 ) FETCH NEXT FROM subcontractid_cursor INTO @contractid_1 END CLOSE subcontractid_cursor DEALLOCATE subcontractid_cursor  DECLARE contractid_cursor CURSOR FOR SELECT  id FROM    CRM_Contract WHERE   manager = @resourceid_1 OPEN contractid_cursor FETCH NEXT FROM contractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, 2 ) FETCH NEXT FROM contractid_cursor INTO @contractid_1 END CLOSE contractid_cursor DEALLOCATE contractid_cursor   DECLARE roleids_cursor CURSOR FOR SELECT  roleid FROM    SystemRightRoles WHERE   rightid = 396 OPEN roleids_cursor FETCH NEXT FROM roleids_cursor INTO @contractroleid_1 WHILE @@fetch_status = 0 BEGIN DECLARE rolecontractid_cursor CURSOR FOR SELECT DISTINCT t1.id FROM    CRM_Contract t1 , hrmrolemembers t2 WHERE   t2.roleid = @contractroleid_1 AND t2.resourceid = @resourceid_1 AND ( t2.rolelevel = 2 OR ( t2.rolelevel = 0 AND t1.department = @departmentid_1 ) OR ( t2.rolelevel = 1 AND t1.subcompanyid1 = @subcompanyid_1 ) ); OPEN rolecontractid_cursor FETCH NEXT FROM rolecontractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF @countrec = 0 BEGIN INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, 2 ) END ELSE BEGIN SELECT  @sharelevel_1 = sharelevel FROM    ContractShareDetail WHERE   contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 IF @sharelevel_1 = 1 BEGIN UPDATE  ContractShareDetail SET     sharelevel = 2 WHERE   contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 END END FETCH NEXT FROM rolecontractid_cursor INTO @contractid_1 END CLOSE rolecontractid_cursor DEALLOCATE rolecontractid_cursor FETCH NEXT FROM roleids_cursor INTO @contractroleid_1 END CLOSE roleids_cursor DEALLOCATE roleids_cursor   DECLARE sharecontractid_cursor CURSOR FOR SELECT DISTINCT t2.relateditemid , t2.sharelevel FROM    Contract_ShareInfo t2 WHERE   ( ( t2.foralluser = 1 AND t2.seclevel <= @seclevel_1 ) OR ( t2.userid = @resourceid_1 ) OR ( t2.departmentid = @departmentid_1 AND t2.seclevel <= @seclevel_1 ) ) OPEN sharecontractid_cursor FETCH NEXT FROM sharecontractid_cursor INTO @contractid_1, @sharelevel_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF @countrec = 0 BEGIN INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, @sharelevel_1 ) END ELSE BEGIN SELECT  @sharelevel_Temp = sharelevel FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF ( ( @sharelevel_Temp = 1 ) AND ( @sharelevel_1 = 2 ) ) UPDATE  @temptablevaluecontract SET     sharelevel = @sharelevel_1 WHERE   contractid = @contractid_1 END FETCH NEXT FROM sharecontractid_cursor INTO @contractid_1, @sharelevel_1 END CLOSE sharecontractid_cursor DEALLOCATE sharecontractid_cursor   DECLARE sharecontractid_cursor CURSOR FOR SELECT DISTINCT t2.relateditemid , t2.sharelevel FROM    CRM_Contract t1 , Contract_ShareInfo t2 , HrmRoleMembers t3 WHERE   t1.id = t2.relateditemid AND t3.resourceid = @resourceid_1 AND t3.roleid = t2.roleid AND t3.rolelevel >= t2.rolelevel AND t2.seclevel <= @seclevel_1 AND ( ( t2.rolelevel = 0 AND t1.department = @departmentid_1 ) OR ( t2.rolelevel = 1 AND t1.subcompanyid1 = @subcompanyid_1 ) OR ( t3.rolelevel = 2 ) ) OPEN sharecontractid_cursor FETCH NEXT FROM sharecontractid_cursor INTO @contractid_1, @sharelevel_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF @countrec = 0 BEGIN INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, @sharelevel_1 ) END ELSE BEGIN SELECT  @sharelevel_Temp = sharelevel FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF ( ( @sharelevel_Temp = 1 ) AND ( @sharelevel_1 = 2 ) ) UPDATE  @temptablevaluecontract SET     sharelevel = @sharelevel_1 WHERE   contractid = @contractid_1 END FETCH NEXT FROM sharecontractid_cursor INTO @contractid_1, @sharelevel_1 END CLOSE sharecontractid_cursor DEALLOCATE sharecontractid_cursor  SET @managerstr_11 = '%,' + CONVERT(varchar(4000), @resourceid_1) + ',%'  DECLARE subcontractid_cursor CURSOR FOR SELECT  t2.id FROM    CRM_CustomerInfo t1 , CRM_Contract t2 WHERE   ( t1.manager IN ( SELECT DISTINCT id FROM      HrmResource WHERE     ',' + managerstr LIKE @managerstr_11 ) ) AND ( t2.crmId = t1.id ) OPEN subcontractid_cursor FETCH NEXT FROM subcontractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF @countrec = 0 INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, 1 ) FETCH NEXT FROM subcontractid_cursor INTO @contractid_1 END CLOSE subcontractid_cursor DEALLOCATE subcontractid_cursor  DECLARE contractid_cursor CURSOR FOR SELECT  t2.id FROM    CRM_CustomerInfo t1 , CRM_Contract t2 WHERE   ( t1.manager = @resourceid_1 ) AND ( t2.crmId = t1.id ) OPEN contractid_cursor FETCH NEXT FROM contractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, 1 ) FETCH NEXT FROM contractid_cursor INTO @contractid_1 END CLOSE contractid_cursor DEALLOCATE contractid_cursor  DELETE  FROM ContractShareDetail WHERE   userid = @resourceid_1 AND usertype = 1  DECLARE allcontractid_cursor CURSOR FOR SELECT  * FROM    @temptablevaluecontract OPEN allcontractid_cursor FETCH NEXT FROM allcontractid_cursor INTO @contractid_1, @sharelevel_1 WHILE @@fetch_status = 0 BEGIN INSERT  INTO ContractShareDetail ( contractid , userid , usertype , sharelevel ) VALUES  ( @contractid_1 , @resourceid_1 , 1 , @sharelevel_1 ) FETCH NEXT FROM allcontractid_cursor INTO @contractid_1, @sharelevel_1 END CLOSE allcontractid_cursor DEALLOCATE allcontractid_cursor  END  IF ( ( @flag_1 = 1 AND @managerstr_1 <> @oldmanagerstr_1 ) OR @flag_1 = 0 )  BEGIN IF ( @managerstr_1 IS NOT NULL AND LEN(@managerstr_1) > 1 )  BEGIN  SET @managerstr_1 = ',' + @managerstr_1  DECLARE supuserid_cursor CURSOR FOR SELECT DISTINCT t1.id , t3.id FROM    HrmResource t1 , CRM_CustomerInfo t2 , CRM_Contract t3 WHERE   @managerstr_1 LIKE '%,' + CONVERT(varchar(4000), t1.id) + ',%' AND t2.manager = @resourceid_1 AND t2.id = t3.crmId; OPEN supuserid_cursor FETCH NEXT FROM supuserid_cursor INTO @supresourceid_1, @contractid_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    ContractShareDetail WHERE   contractid = @contractid_1 AND userid = @supresourceid_1 AND usertype = 1 IF @countrec = 0 BEGIN INSERT  INTO ContractShareDetail ( contractid , userid , usertype , sharelevel ) VALUES  ( @contractid_1 , @supresourceid_1 , 1 , 1 ) END FETCH NEXT FROM supuserid_cursor INTO @supresourceid_1, @contractid_1 END CLOSE supuserid_cursor DEALLOCATE supuserid_cursor   END END

GO
alter procedure [HrmResource_DepUpdate] ( @id_1 int, @departmentid_2 int, @joblevel_3 int, @costcenterid_4 int, @jobtitle_5 int, @newmanagerid_1 int, @flag int output, @msg varchar(4000) output ) as update HrmResource set departmentid = @departmentid_2, joblevel = @joblevel_3, costcenterid = @costcenterid_4, jobtitle = @jobtitle_5, managerid = @newmanagerid_1 where id = @id_1  update CRM_CustomerInfo set department= @departmentid_2 where manager = @id_1

GO
alter procedure [HrmEditRightPath_SeByURId] @userid int,@rightstr varchar(4000),@level int, @flag integer output , @msg varchar(4000) output AS  declare @temptree1 Table (subcompanyid int ,rightlevel int) declare @temptree2 Table (id int ) declare @temptree3 Table (id int )   insert @temptree1 select a.subcompanyid,a.rightlevel from (select subcompanyid,max(rightlevel) as rightlevel from SysRoleSubcomRight where roleid in(select a.roleid from HrmRoleMembers a,SystemRightRoles b where a.roleid=b.roleid and a.resourceid=@userid and b.rightid =(select rightid from SystemRightDetail where rightdetail=@rightstr) ) group by subcompanyid ) a where a.rightlevel>=@level     insert @temptree2 select b.subcompanyid from hrmsubcompany a,@temptree1 b where a.id=b.subcompanyid and a.supsubcomid<>0 and a.supsubcomid not in(select subcompanyid from @temptree1)   declare c1 cursor for select id from @temptree2 open c1 declare  @tempsubid int fetch next from c1 into @tempsubid while @@fetch_status=0 begin insert @temptree3 select id from getSubComParentTree(@tempsubid) fetch next from c1 into @tempsubid end close c1 deallocate c1  select * from  @temptree1 union select distinct(id),-1 from @temptree3

GO
alter procedure [cowork_sys_update] as declare @coworkid int declare @discussid int declare @floorNum int declare @isnew varchar(4000) declare @important varchar(4000) declare @coworkers varchar(4000) declare @creater int declare @principal int declare @splitChar varchar(4000) declare @userid varchar(4000) set @splitChar=',' declare cursor0 cursor for select id,isnew,userids,coworkers,creater,principal from cowork_items open cursor0 fetch next from cursor0  into @coworkid,@isnew,@important,@coworkers,@creater,@principal while(@@fetch_status=0) begin   while(@isnew<>'' and @isnew is not null) begin set   @userid=left(@isnew,charindex(',',@isnew,1)-1) if(@userid<>'') begin insert into cowork_read(coworkid,userid) values(@coworkid,@userid) end set   @isnew=stuff(@isnew,1,charindex(',',@isnew,1),'') end    while(@coworkers<>'' and @coworkers is not null) begin if(len(@coworkers)>4000) begin insert into coworkshare(sourceid,type,content,seclevel,sharelevel,srcfrom) values(@coworkid,1,left(@coworkers,charindex(',',@coworkers,3500)),0,1,1) set @coworkers=stuff(@coworkers,1,charindex(',',@coworkers,3500)-1,'') end else begin insert into coworkshare(sourceid,type,content,seclevel,sharelevel,srcfrom) values(@coworkid,1,@coworkers,0,1,1) set @coworkers='' end end  insert into coworkshare (sourceid,type,content,seclevel,sharelevel,srcfrom) values(@coworkid,1,@creater,0,2,2) insert into coworkshare (sourceid,type,content,seclevel,sharelevel,srcfrom) values(@coworkid,1,@principal,0,2,3)    while(@important<>'' and @important is not null) begin set   @userid=left(@important,charindex(',',@important,1)-1) if(@userid<>'') begin insert into cowork_important(coworkid,userid) values(@coworkid,@userid) end set   @important=stuff(@important,1,charindex(',',@important,1),'') end    declare cursor1 cursor for select id from cowork_discuss where coworkid=@coworkid order by createdate asc,createtime asc open cursor1 set @floorNum=1 fetch next from cursor1  into @discussid while(@@fetch_status=0) begin update cowork_discuss set  floorNum=@floorNum,replayid=0 where id=@discussid set @floorNum=@floorNum+1 fetch next from cursor1 into @discussid end close cursor1 deallocate cursor1   fetch next from cursor0 into @coworkid,@isnew,@important,@coworkers,@creater,@principal end close cursor0 deallocate cursor0

GO
alter procedure [cowork_discuss_insert] ( @coworkid_1 	[int], @discussant_2 	[int], @createdate_3 	[char](10), @createtime_4 	[char](8), @remark_5 	[text], @relatedprj_6  varchar(4000), @relatedcus_7  varchar(4000), @relatedwf_8 	varchar(4000), @relateddoc_9  varchar(4000), @relatedacc_10 varchar(4000), @mutil_prjs_11 varchar(4000), @floorNum_12 [int],@replayid_13 [int], @flag integer output , @msg varchar(4000) output ) AS INSERT INTO [cowork_discuss] ( [coworkid], [discussant], [createdate], [createtime], [remark], [relatedprj], [relatedcus], [relatedwf], [relateddoc], [ralatedaccessory], [mutil_prjs], [floorNum], [replayid]) VALUES ( @coworkid_1, @discussant_2, @createdate_3, @createtime_4, @remark_5, @relatedprj_6, @relatedcus_7, @relatedwf_8, @relateddoc_9, @relatedacc_10, @mutil_prjs_11, @floorNum_12, @replayid_13)

GO
alter procedure [_initMenuConfig] @flag		int	output, @msg		varchar(4000) output as declare @viewIndex int declare @useCustomName int declare @customName  varchar(4000) declare @customName_e varchar(4000) declare @infoid varchar(4000)  declare mainmenu_cursor cursor for   select id,defaultindex,useCustomName,customName,customName_e from mainmenuinfo   open mainmenu_cursor fetch next from mainmenu_cursor into @infoid,@viewIndex,@useCustomName,@customName,@customName_e while @@fetch_status=0 begin  insert into mainmenuconfig(infoid,visible,viewIndex,resourceid,resourcetype,useCustomName,customName,customName_e) values (@infoid,1, @viewIndex,1,1,@useCustomName,@customName,@customName_e)  insert into mainmenuconfig(infoid,visible,viewIndex,resourceid,resourcetype,useCustomName,customName,customName_e) select @infoid,1,@viewIndex,id,2,@useCustomName,@customName,@customName_e from hrmsubcompany  fetch next from mainmenu_cursor into @infoid,@viewIndex,@useCustomName,@customName,@customName_e end  close mainmenu_cursor deallocate mainmenu_cursor

GO
alter procedure [SystemSet_DftSCUpdate] ( @dftsubcomid INT , @hrmdftsubcomid INT , @wfdftsubcomid INT , @docdftsubcomid INT , @portaldftsubcomid INT , @cptdftsubcomid INT , @mtidftsubcomid INT , @flag INT OUTPUT , @msg varchar(4000) OUTPUT ) AS UPDATE  HrmRoles SET     subcompanyid = @dftsubcomid WHERE   subcompanyid IS NULL OR subcompanyid = 0 OR subcompanyid = -1 OR subcompanyid NOT IN ( SELECT id FROM   hrmsubcompany ) UPDATE  HrmContractTemplet SET     subcompanyid = @dftsubcomid WHERE   subcompanyid IS NULL OR subcompanyid = 0 OR subcompanyid = -1 OR subcompanyid NOT IN ( SELECT id FROM   hrmsubcompany ) UPDATE  HrmContractType SET     subcompanyid = @dftsubcomid WHERE   subcompanyid IS NULL OR subcompanyid = 0 OR subcompanyid = -1 OR subcompanyid NOT IN ( SELECT id FROM   hrmsubcompany ) UPDATE  HrmCareerApply SET     subCompanyId = @dftsubcomid WHERE   subCompanyId IS NULL OR subCompanyId = 0 OR subCompanyId = -1 OR subCompanyId NOT IN ( SELECT id FROM   hrmsubcompany ) UPDATE  workflow_formdict SET     subcompanyid = @wfdftsubcomid WHERE   subcompanyid IS NULL OR subcompanyid = 0 OR subcompanyid = -1 OR subcompanyid NOT IN ( SELECT id FROM   hrmsubcompany ) UPDATE  workflow_formdictdetail SET     subcompanyid = @wfdftsubcomid WHERE   subcompanyid IS NULL OR subcompanyid = 0 OR subcompanyid = -1 OR subcompanyid NOT IN ( SELECT id FROM   hrmsubcompany ) UPDATE  workflow_formbase SET     subcompanyid = @wfdftsubcomid WHERE   subcompanyid IS NULL OR subcompanyid = 0 OR subcompanyid = -1 OR subcompanyid NOT IN ( SELECT id FROM   hrmsubcompany ) UPDATE  workflow_base SET     subcompanyid = @wfdftsubcomid WHERE   subcompanyid IS NULL OR subcompanyid = 0 OR subcompanyid = -1 OR subcompanyid NOT IN ( SELECT id FROM   hrmsubcompany ) UPDATE  cptcapital SET     blongsubcompany = @cptdftsubcomid WHERE   blongsubcompany IS NULL OR blongsubcompany = 0 OR blongsubcompany = -1 OR blongsubcompany NOT IN ( SELECT  id FROM    hrmsubcompany ) UPDATE  MeetingRoom SET     subcompanyId = @mtidftsubcomid WHERE   subcompanyId IS NULL OR subcompanyId = 0 OR subcompanyId = -1 OR subcompanyid NOT IN ( SELECT id FROM   hrmSubcompany ) UPDATE  Meeting_Type SET     subcompanyId = @mtidftsubcomid WHERE   subcompanyId IS NULL OR subcompanyId = 0 OR subcompanyId = -1 OR subcompanyid NOT IN ( SELECT id FROM   hrmSubcompany )

GO
alter procedure [RoleStrTree_SByURId] @userid int,@roleid int, @flag integer output , @msg varchar(4000) output AS   declare @temptree1 Table (id int,operateType_Range int)  declare @temptree2 Table (id int,parent_id int,operateType_Range int)  declare @temptree3 Table (id int,parent_id int,nodetype int,operateType_Range int)  declare @temptree4 Table (rightid int,subcomid int,rightlevel int) declare @rowcount int declare @c1 cursor declare @id int   select @rowcount=count(*) from SystemRightRoles where roleid=@roleid  if @rowcount>0 begin  insert @temptree4 select b.rightid,c.subcompanyid,max(c.rightlevel) from HrmRoleMembers a,SystemRightRoles b,SysRoleSubcomRight c where a.roleid=b.roleid and a.roleid=c.roleid and a.resourceid=@userid and b.rightid in(select rightid from SystemRightRoles where roleid=@roleid) and b.roleid<>@roleid group by b.rightid,c.subcompanyid  insert @temptree1 select subcomid,min(rightlevel) from @temptree4 group by subcomid having count(subcomid)=(select count(distinct(rightid)) from @temptree4)  end else begin  insert @temptree1 select subcompanyid,min(rightlevel) from SysRoleSubcomRight where roleid in(select roleid from HrmRoleMembers where resourceid=@userid) and roleid<>@roleid group by subcompanyid having count(subcompanyid)=(select count(roleid) from HrmRoleMembers where resourceid=@userid and roleid<>@roleid) end   insert @temptree2 select a.id,b.supsubcomid,a.operateType_Range from @temptree1 a,hrmsubcompany b where a.id=b.id   SET @c1 = CURSOR FORWARD_ONLY STATIC FOR select id from @temptree2 where parent_id<>0 and parent_id not in(select id from @temptree2) OPEN @c1 FETCH NEXT FROM @c1 INTO @id WHILE @@FETCH_STATUS = 0 begin select @rowcount=count(*) from @temptree3 where id in (select id from getSubComParentTree(@id)) if @rowcount=0 begin insert into @temptree3 select id,supsubcomid,0,0 from getSubComParentTree(@id) end FETCH NEXT FROM @c1 INTO @id end   insert into @temptree3 select id ,parent_id ,1,operateType_Range from @temptree2  select * from @temptree3

   GO
alter procedure [LgcAssetUnit_Delete] ( @id_1 	[int], @flag integer output , @msg varchar(4000) output) AS DECLARE @count int SELECT @count = count(id) FROM LgcAsset WHERE assetunitid = @id_1 IF @count <> 0 BEGIN SELECT -1 RETURN END SELECT @count = count(id) FROM CptCapital WHERE unitid = @id_1 IF @count <> 0 BEGIN SELECT -1 RETURN END DELETE [LgcAssetUnit] WHERE ( [id]	 = @id_1)

 GO
alter procedure [MainMenuInfo_Insert]( @id_1 int, @labelId_1 int, @menuName_1 Varchar(100), @linkAddress_1 Varchar(100), @parentFrame_1 Varchar(100), @defaultParentId_1 int, @defaultLevel_1 int, @defaultIndex_1 int, @needRightToVisible_1 char(1), @rightDetailToVisible_1 Varchar(100), @needRightToView_1 char(1), @rightDetailToView_1 Varchar(100), @needSwitchToVisible_1 char(1), @switchClassNameToVisible_1 Varchar(100), @switchMethodNameToVisible_1 Varchar(100), @needSwitchToView_1 char(1), @switchClassNameToView_1 Varchar(100), @switchMethodNameToView_1 Varchar(100), @relatedModuleId_1 int, @flag	int	output, @msg	varchar(4000)	output) AS  DECLARE @updateId int; DECLARE @updateIndex int;  SET @updateIndex = @defaultIndex_1;    DECLARE @updateId_1 int DECLARE @updateIndex_1 int DECLARE mainMenuInfo_cursor CURSOR FOR SELECT id FROM MainMenuInfo WHERE defaultParentId = @defaultParentId_1 AND defaultIndex >= @defaultIndex_1 ORDER BY defaultIndex  OPEN mainMenuInfo_cursor FETCH NEXT FROM mainMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN SET @updateIndex = @updateIndex + 1; UPDATE MainMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId FETCH NEXT FROM mainMenuInfo_cursor INTO @updateId END  CLOSE mainMenuInfo_cursor DEALLOCATE mainMenuInfo_cursor  IF(@linkAddress_1 = '') BEGIN INSERT INTO MainMenuInfo ( id, labelId, menuName, linkAddress, parentFrame, defaultParentId, defaultLevel, defaultIndex, needRightToVisible, rightDetailToVisible, needRightToView, rightDetailToView, needSwitchToVisible, switchClassNameToVisible, switchMethodNameToVisible, needSwitchToView, switchClassNameToView, switchMethodNameToView, relatedModuleId) VALUES ( @id_1, @labelId_1, @menuName_1, NULL , @parentFrame_1 , @defaultParentId_1 , @defaultLevel_1 , @defaultIndex_1 , @needRightToVisible_1 , @rightDetailToVisible_1 , @needRightToView_1 , @rightDetailToView_1 , @needSwitchToVisible_1 , @switchClassNameToVisible_1 , @switchMethodNameToVisible_1 , @needSwitchToView_1 , @switchClassNameToView_1 , @switchMethodNameToView_1 , @relatedModuleId_1 ) END ELSE BEGIN INSERT INTO MainMenuInfo ( id, labelId, menuName, linkAddress, parentFrame, defaultParentId, defaultLevel, defaultIndex, needRightToVisible, rightDetailToVisible, needRightToView, rightDetailToView, needSwitchToVisible, switchClassNameToVisible, switchMethodNameToVisible, needSwitchToView, switchClassNameToView, switchMethodNameToView, relatedModuleId) VALUES ( @id_1, @labelId_1, @menuName_1, @linkAddress_1 , @parentFrame_1 , @defaultParentId_1 , @defaultLevel_1 , @defaultIndex_1 , @needRightToVisible_1 , @rightDetailToVisible_1 , @needRightToView_1 , @rightDetailToView_1 , @needSwitchToVisible_1 , @switchClassNameToVisible_1 , @switchMethodNameToVisible_1 , @needSwitchToView_1 , @switchClassNameToView_1 , @switchMethodNameToView_1 , @relatedModuleId_1 ) END   SET @flag = 1 SET @msg = 'ok'

 GO
alter procedure [MainMenuInfo_DeleteById]( @id_1 	int , @flag	int	output, @msg	varchar(4000)	output) AS DECLARE @defaultLevel int DECLARE @updateId int DECLARE @updateIndex int DECLARE @defaultIndex int DECLARE @defaultParentId int  SELECT @defaultLevel = defaultLevel ,@defaultParentId = defaultParentId , @defaultIndex = defaultIndex FROM MainMenuInfo WHERE id = @id_1   DELETE FROM MainMenuInfo WHERE id = @id_1  SET @updateIndex = @defaultIndex;    DECLARE mainMenuInfo_cursor CURSOR FOR SELECT id FROM MainMenuInfo WHERE defaultParentId = @defaultParentId AND defaultIndex > @defaultIndex ORDER BY defaultIndex  OPEN mainMenuInfo_cursor FETCH NEXT FROM mainMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN UPDATE MainMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId  SET @updateIndex = @updateIndex + 1;  FETCH NEXT FROM mainMenuInfo_cursor INTO @updateId END  CLOSE mainMenuInfo_cursor DEALLOCATE mainMenuInfo_cursor

 GO
alter procedure [LMInfo_Insert]( @id_1 		int , @labelId_1 		int , @iconUrl_1		varchar(4000), @linkAddress_1      varchar(4000), @menuLevel_1	int, @parentId_1		int, @defaultIndex_1	int, @relatedModuleId_1  int) AS   DECLARE @updateId int; DECLARE @updateIndex int;   IF (@menuLevel_1 = 1) BEGIN  SET @updateIndex = @defaultIndex_1;   DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id FROM LeftMenuInfo WHERE parentId IS NULL AND defaultIndex >= @defaultIndex_1 ORDER BY defaultIndex  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN SET @updateIndex = @updateIndex + 1; UPDATE LeftMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor  INSERT INTO LeftMenuInfo ( id, labelId, iconUrl, linkAddress, menuLevel, parentId, defaultIndex, relatedModuleId) VALUES ( @id_1, @labelId_1, NULL, NULL, @menuLevel_1, NULL, @defaultIndex_1, @relatedModuleId_1 ) END ELSE BEGIN  SET @updateIndex = @defaultIndex_1;  DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id FROM LeftMenuInfo WHERE parentId = @parentId_1 AND defaultIndex >= @defaultIndex_1 ORDER BY defaultIndex  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN SET @updateIndex = @updateIndex + 1;  UPDATE LeftMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor  INSERT INTO LeftMenuInfo ( id, labelId, iconUrl, linkAddress, menuLevel, parentId, defaultIndex, relatedModuleId) VALUES ( @id_1, @labelId_1, @iconUrl_1, @linkAddress_1, @menuLevel_1, @parentId_1, @defaultIndex_1, @relatedModuleId_1 ) END

GO
alter procedure [LMConfig_U_ByInfoInsert]( @menuLevel_1	int, @parentId_1	int, @defaultIndex_1	int ) AS DECLARE @old_updateId int, @old_resourceId int, @old_resourceType char(1), @old_parentId int, @curr_updateId int, @curr_resourceId int, @curr_resourceType char(1), @curr_parentId int, @indexCount int   IF (@menuLevel_1 = 1) BEGIN  DECLARE leftmenuviewindex_cursor CURSOR FOR SELECT t2.id,t2.resourceId,t2.resourceType,t1.parentid FROM LeftMenuInfo t1,LeftMenuConfig t2 WHERE t1.id = t2.infoId AND (t1.parentid IS NULL OR t1.parentid = 0) AND t2.viewIndex >= @defaultIndex_1 ORDER BY resourceid,resourcetype,parentId,viewindex,defaultIndex,infoid desc  END ELSE BEGIN  DECLARE leftmenuviewindex_cursor CURSOR FOR SELECT t2.id,t2.resourceId,t2.resourceType,t1.parentid FROM LeftMenuInfo t1,LeftMenuConfig t2 WHERE t1.id = t2.infoId AND t1.parentId = @parentId_1 AND t2.viewIndex >= @defaultIndex_1 ORDER BY resourceid,resourcetype,parentId,viewindex,defaultIndex,infoid desc  END  OPEN leftmenuviewindex_cursor FETCH NEXT FROM leftmenuviewindex_cursor INTO @curr_updateId,@curr_resourceId,@curr_resourceType,@curr_parentId  IF(@defaultIndex_1<1) SET @indexCount = 1; ELSE SET @indexCount = @defaultIndex_1  WHILE @@FETCH_STATUS = 0 BEGIN IF (@curr_resourceId = @old_resourceId AND @curr_resourceType = @old_resourceType AND (@curr_parentId = @old_parentId OR (@curr_parentId IS NULL AND @old_parentId IS NULL)) AND @curr_updateId != @old_updateId) BEGIN  SET @indexCount = @indexCount + 1  UPDATE LeftMenuConfig SET viewIndex = @indexCount WHERE id = @curr_updateId  END ELSE BEGIN  IF(@defaultIndex_1<1) SET @indexCount = 1; ELSE SET @indexCount = @defaultIndex_1  UPDATE LeftMenuConfig SET viewIndex = @indexCount WHERE id = @curr_updateId  END  SET @old_updateId = @curr_updateId SET @old_resourceId = @curr_resourceId SET @old_resourceType = @curr_resourceType SET @old_parentId = @curr_parentId  FETCH NEXT FROM leftmenuviewindex_cursor INTO @curr_updateId,@curr_resourceId,@curr_resourceType,@curr_parentId END  CLOSE leftmenuviewindex_cursor DEALLOCATE leftmenuviewindex_cursor

GO
alter procedure [Prj_Member_SelectAllProcess] (@prjid [int], @hrmid varchar(4000), @flag	[int]	output, @msg	varchar(4000)	output) AS SELECT * FROM [Prj_TaskProcess] WHERE ( [prjid]	 = @prjid and  [parenthrmids] like '%,'+@hrmid+'|%'  and isdelete<>'1') order by parentids  set @flag = 1 set @msg = 'OK!'

GO
alter procedure [Prj_Member_SumProcess] (@prjid [int], @hrmid [int], @flag	[int]	output, @msg	varchar(4000)	output) AS if @hrmid='' begin SELECT hrmid,  min(begindate) as begindate, max(enddate) as enddate FROM [Prj_TaskProcess] WHERE ( prjid	 = @prjid  and isdelete<>'1' ) group by hrmid end else begin SELECT hrmid,  min(begindate) as begindate, max(enddate) as enddate FROM [Prj_TaskProcess] WHERE ( prjid	 = @prjid  and isdelete<>'1' and hrmid=@hrmid) group by hrmid end set @flag = 1 set @msg = 'OK!'

GO
alter procedure [HrmResourceBasicInfo_Update] ( @id_1 INT , @workcode_2 varchar(4000) , @lastname_3 varchar(4000) , @sex_5 CHAR(1) , @resoureimageid_6 INT , @departmentid_7 INT , @costcenterid_8 INT , @jobtitle_9 INT , @joblevel_10 INT , @jobactivitydesc_11 varchar(4000) , @managerid_12 INT , @assistantid_13 INT , @status_14 CHAR(1) , @locationid_15 INT , @workroom_16 varchar(4000) , @telephone_17 varchar(4000) , @mobile_18 varchar(4000) , @mobilecall_19 varchar(4000) , @fax_20 varchar(4000) , @jobcall_21 INT , @systemlanguage_22 INT , @accounttype_23 INT , @belongto_24 INT , @email_25 varchar(4000)=NULL , @dsporder_26 FLOAT =NULL, @mobileshowtype_27 int =NULL, @flag INT OUTPUT , @msg varchar(4000) OUTPUT ) AS UPDATE  HrmResource SET     workcode = @workcode_2 , lastname = @lastname_3 , sex = @sex_5 , resourceimageid = @resoureimageid_6 , departmentid = @departmentid_7 , costcenterid = @costcenterid_8 , jobtitle = @jobtitle_9 , joblevel = @joblevel_10 , jobactivitydesc = @jobactivitydesc_11 , managerid = @managerid_12 , assistantid = @assistantid_13 , status = @status_14 , locationid = @locationid_15 , workroom = @workroom_16 , telephone = @telephone_17 , mobile = @mobile_18 , mobilecall = @mobilecall_19 , fax = @fax_20 , jobcall = @jobcall_21 , systemlanguage = @systemlanguage_22 , accounttype = @accounttype_23 , belongto = @belongto_24, email = @email_25, dsporder = @dsporder_26, mobileshowtype = @mobileshowtype_27 WHERE   id = @id_1 UPDATE  CRM_CustomerInfo SET     department = @departmentid_7 WHERE   manager = @id_1

GO
alter procedure [Capital_Adjust2] ( @capitalid_1 int, @usedate_1 varchar(4000), @usedeptid_1 int, @useresourceid_1 int, @userequest_1 int, @usecount_1 int, @useaddress_1 varchar(4000), @usestatus_1 varchar(4000), @remark_1 text, @olddeptid_1 int, @flag integer output, @msg varchar(4000) output ) as insert INTO CptUseLog ( capitalid, usedate, usedeptid, useresourceid, userequest,usecount, useaddress, usestatus, remark, olddeptid) values ( @capitalid_1  , @usedate_1  , @usedeptid_1  , @useresourceid_1  ,@userequest_1 , @usecount_1  , @useaddress_1   , @usestatus_1   , @remark_1  , @olddeptid_1  )   update CptCapital set departmentid = @usedeptid_1  , resourceid = @useresourceid_1 WHERE id=@capitalid_1

GO
alter procedure [Capital_Adjust] ( @capitalid_1 int, @usedate_1 varchar(4000), @usedeptid_1 int, @useresourceid_1 int, @usecount_1 int, @useaddress_1 varchar(4000), @usestatus_1 varchar(4000), @remark_1 text, @olddeptid_1 int, @flag integer output, @msg varchar(4000) output ) as insert INTO CptUseLog ( capitalid, usedate, usedeptid, useresourceid, usecount, useaddress, usestatus, remark, olddeptid) values ( @capitalid_1  , @usedate_1  , @usedeptid_1  , @useresourceid_1  , @usecount_1  , @useaddress_1   , @usestatus_1   , @remark_1  , @olddeptid_1  )   update CptCapital set departmentid = @usedeptid_1  , resourceid = @useresourceid_1 WHERE id=@capitalid_1

GO
alter procedure  [workflow_RequestLogCurDate_I] @requestid int, @workflowid    int, @nodeid    int, @logtype   char(1), @operatedate   char(10), @operatetime  char(8), @operator  int, @remark    text, @clientip char(15), @operatortype int, @destnodeid    int, @operate varchar(4000), @agentorbyagentid  int,@agenttype  char(1),@showorder int,@annexdocids varchar(4000), @requestLogId int,@signdocids varchar(4000),@signworkflowids varchar(4000), @flag integer output , @msg varchar(4000) output AS exec workflow_RequestLogCurDate_New @requestid, @workflowid, @nodeid, @logtype, @operatedate, @operatetime, @operator, @remark, @clientip, @operatortype, @destnodeid, @operate, @agentorbyagentid, @agenttype, @showorder, @annexdocids, @requestLogId, @signdocids, @signworkflowids, '0', 0, 0, @flag, @msg

GO
alter procedure  [workflow_RequestLog_Insert] @requestid int, @workflowid    int, @nodeid    int, @logtype   char(1), @operatedate   char(10), @operatetime  char(8), @operator  int, @remark    text, @clientip char(15), @operatortype int, @destnodeid    int, @operate varchar(4000), @agentorbyagentid  int,@agenttype  char(1),@showorder int,@annexdocids varchar(4000), @requestLogId int,@signdocids varchar(4000),@signworkflowids varchar(4000), @flag integer output , @msg varchar(4000) output AS exec [workflow_RequestLog_Insert_New] @requestid, @workflowid, @nodeid, @logtype, @operatedate, @operatetime, @operator, @remark, @clientip, @operatortype, @destnodeid, @operate, @agentorbyagentid, @agenttype, @showorder, @annexdocids, @requestLogId, @signdocids, @signworkflowids, '0', 0, 0, @flag, @msg

GO
alter procedure [WorkPlanExchange_Add] ( @workPlanId_1 int, @userId_1 int, @userType_1 char(1), @flag integer output , @msg varchar(4000) output) AS IF NOT EXISTS(SELECT workPlanId FROM WorkPlanExchange WHERE workPlanId = @workPlanId_1) EXEC WorkPlanExchange_WP_Add @workPlanId_1, '', '' UPDATE WorkPlanExchange SET exchangeCount = exchangeCount + 1 WHERE workPlanId = @workPlanId_1 AND ((memberId <> @userId_1 AND memberType = @userType_1) OR memberType <> @userType_1)

 GO
alter procedure [HrmRoleMembersShare] ( @resourceid_1 INT , @roleid_1 INT , @rolelevel_1 INT , @rolelevel_2 INT , @flag_1 INT , @flag INTEGER OUTPUT , @msg varchar(4000) OUTPUT ) AS DECLARE @docid_1 INT , @crmid_1 INT , @prjid_1 INT , @cptid_1 INT , @sharelevel_1 INT , @departmentid_1 INT , @subcompanyid_1 INT , @seclevel_1 INT , @countrec INT , @countdelete INT , @countinsert INT , @contractid_1 INT , @contractroleid_1 INT , @sharelevel_Temp INT , @workPlanId_1 INT , @managerstr_11 CHAR(500) IF ( @flag_1 = 0 OR ( @flag_1 = 1 AND @rolelevel_1 > @rolelevel_2 ) ) BEGIN SELECT  @departmentid_1 = departmentid , @subcompanyid_1 = subcompanyid1 , @seclevel_1 = seclevel FROM    hrmresource WHERE   id = @resourceid_1 IF @departmentid_1 IS NULL SET @departmentid_1 = 0 IF @subcompanyid_1 IS NULL SET @subcompanyid_1 = 0 IF @seclevel_1 IS NULL SET @seclevel_1 = 0 IF @rolelevel_1 = '2'        BEGIN       DECLARE roleids_cursor CURSOR FOR SELECT  roleid FROM    SystemRightRoles WHERE   rightid = 396  OPEN roleids_cursor FETCH NEXT FROM roleids_cursor INTO @contractroleid_1 WHILE @@fetch_status = 0 BEGIN DECLARE rolecontractid_cursor CURSOR FOR SELECT DISTINCT t1.id FROM    CRM_Contract t1 , hrmrolemembers t2 WHERE   t2.roleid = @contractroleid_1 AND t2.resourceid = @resourceid_1 AND t2.rolelevel = 2; OPEN rolecontractid_cursor FETCH NEXT FROM rolecontractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    ContractShareDetail WHERE   contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 IF @countrec = 0 BEGIN INSERT  INTO ContractShareDetail VALUES  ( @contractid_1, @resourceid_1, 1, 2 ) END ELSE BEGIN SELECT  @sharelevel_1 = sharelevel FROM    ContractShareDetail WHERE   contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 IF @sharelevel_1 = 1 BEGIN UPDATE  ContractShareDetail SET     sharelevel = 2 WHERE   contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 END END FETCH NEXT FROM rolecontractid_cursor INTO @contractid_1 END CLOSE rolecontractid_cursor DEALLOCATE rolecontractid_cursor FETCH NEXT FROM roleids_cursor INTO @contractroleid_1 END CLOSE roleids_cursor DEALLOCATE roleids_cursor     END ELSE IF @rolelevel_1 = '1'           BEGIN  DECLARE roleids_cursor CURSOR FOR SELECT  roleid FROM    SystemRightRoles WHERE   rightid = 396  OPEN roleids_cursor FETCH NEXT FROM roleids_cursor INTO @contractroleid_1 WHILE @@fetch_status = 0 BEGIN DECLARE rolecontractid_cursor CURSOR FOR SELECT DISTINCT t1.id FROM    CRM_Contract t1 , hrmrolemembers t2 WHERE   t2.roleid = @contractroleid_1 AND t2.resourceid = @resourceid_1 AND ( t2.rolelevel = 1 AND t1.subcompanyid1 = @subcompanyid_1 ); OPEN rolecontractid_cursor FETCH NEXT FROM rolecontractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    ContractShareDetail WHERE   contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 IF @countrec = 0 BEGIN INSERT  INTO ContractShareDetail VALUES  ( @contractid_1, @resourceid_1, 1, 2 ) END ELSE BEGIN SELECT  @sharelevel_1 = sharelevel FROM    ContractShareDetail WHERE   contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 IF @sharelevel_1 = 1 BEGIN UPDATE ContractShareDetail SET   sharelevel = 2 WHERE contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 END END FETCH NEXT FROM rolecontractid_cursor INTO @contractid_1 END CLOSE rolecontractid_cursor DEALLOCATE rolecontractid_cursor FETCH NEXT FROM roleids_cursor INTO @contractroleid_1 END CLOSE roleids_cursor DEALLOCATE roleids_cursor   END ELSE IF @rolelevel_1 = '0'           BEGIN  DECLARE roleids_cursor CURSOR FOR SELECT  roleid FROM    SystemRightRoles WHERE   rightid = 396  OPEN roleids_cursor FETCH NEXT FROM roleids_cursor INTO @contractroleid_1 WHILE @@fetch_status = 0 BEGIN DECLARE rolecontractid_cursor CURSOR FOR SELECT DISTINCT t1.id FROM    CRM_Contract t1 , hrmrolemembers t2 WHERE   t2.roleid = @contractroleid_1 AND t2.resourceid = @resourceid_1 AND ( t2.rolelevel = 0 AND t1.department = @departmentid_1 ); OPEN rolecontractid_cursor FETCH NEXT FROM rolecontractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    ContractShareDetail WHERE   contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 IF @countrec = 0 BEGIN INSERT  INTO ContractShareDetail VALUES  ( @contractid_1, @resourceid_1, 1, 2 ) END ELSE BEGIN SELECT  @sharelevel_1 = sharelevel FROM    ContractShareDetail WHERE   contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 IF @sharelevel_1 = 1 BEGIN UPDATE ContractShareDetail SET sharelevel = 2 WHERE contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 END END FETCH NEXT FROM rolecontractid_cursor INTO @contractid_1 END CLOSE rolecontractid_cursor DEALLOCATE rolecontractid_cursor FETCH NEXT FROM roleids_cursor INTO @contractroleid_1 END CLOSE roleids_cursor DEALLOCATE roleids_cursor    END END ELSE IF ( @flag_1 = 2 OR ( @flag_1 = 1 AND @rolelevel_1 < @rolelevel_2 ) )  BEGIN SELECT  @departmentid_1 = departmentid , @subcompanyid_1 = subcompanyid1 , @seclevel_1 = seclevel FROM    hrmresource WHERE   id = @resourceid_1 IF @departmentid_1 IS NULL SET @departmentid_1 = 0 IF @subcompanyid_1 IS NULL SET @subcompanyid_1 = 0      DECLARE @temptablevaluecontract TABLE ( contractid INT , sharelevel INT )     SET @managerstr_11 = '%,' + CONVERT(varchar(4000), @resourceid_1) + ',%' DECLARE subcontractid_cursor CURSOR FOR SELECT  id FROM    CRM_Contract WHERE   ( manager IN ( SELECT DISTINCT id FROM      HrmResource WHERE     ',' + managerstr LIKE @managerstr_11 ) ) OPEN subcontractid_cursor FETCH NEXT FROM subcontractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF @countrec = 0 INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, 3 ) FETCH NEXT FROM subcontractid_cursor INTO @contractid_1 END CLOSE subcontractid_cursor DEALLOCATE subcontractid_cursor   DECLARE contractid_cursor CURSOR FOR SELECT  id FROM    CRM_Contract WHERE   manager = @resourceid_1 OPEN contractid_cursor FETCH NEXT FROM contractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, 2 ) FETCH NEXT FROM contractid_cursor INTO @contractid_1 END CLOSE contractid_cursor DEALLOCATE contractid_cursor   DECLARE roleids_cursor CURSOR FOR SELECT  roleid FROM    SystemRightRoles WHERE   rightid = 396 OPEN roleids_cursor FETCH NEXT FROM roleids_cursor INTO @contractroleid_1 WHILE @@fetch_status = 0 BEGIN DECLARE rolecontractid_cursor CURSOR FOR SELECT DISTINCT t1.id FROM    CRM_Contract t1 , hrmrolemembers t2 WHERE   t2.roleid = @contractroleid_1 AND t2.resourceid = @resourceid_1 AND ( t2.rolelevel = 2 OR ( t2.rolelevel = 0 AND t1.department = @departmentid_1 ) OR ( t2.rolelevel = 1 AND t1.subcompanyid1 = @subcompanyid_1 ) ); OPEN rolecontractid_cursor FETCH NEXT FROM rolecontractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF @countrec = 0 BEGIN INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, 2 ) END ELSE BEGIN SELECT  @sharelevel_1 = sharelevel FROM    ContractShareDetail WHERE   contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 IF @sharelevel_1 = 1 BEGIN UPDATE  ContractShareDetail SET     sharelevel = 2 WHERE   contractid = @contractid_1 AND userid = @resourceid_1 AND usertype = 1 END END FETCH NEXT FROM rolecontractid_cursor INTO @contractid_1 END CLOSE rolecontractid_cursor DEALLOCATE rolecontractid_cursor FETCH NEXT FROM roleids_cursor INTO @contractroleid_1 END CLOSE roleids_cursor DEALLOCATE roleids_cursor   DECLARE sharecontractid_cursor CURSOR FOR SELECT DISTINCT t2.relateditemid , t2.sharelevel FROM    Contract_ShareInfo t2 WHERE   ( ( t2.foralluser = 1 AND t2.seclevel <= @seclevel_1 ) OR ( t2.userid = @resourceid_1 ) OR ( t2.departmentid = @departmentid_1 AND t2.seclevel <= @seclevel_1 ) ) OPEN sharecontractid_cursor FETCH NEXT FROM sharecontractid_cursor INTO @contractid_1, @sharelevel_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF @countrec = 0 BEGIN INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, @sharelevel_1 ) END ELSE BEGIN SELECT  @sharelevel_Temp = sharelevel FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF ( ( @sharelevel_Temp = 1 ) AND ( @sharelevel_1 = 2 ) ) UPDATE  @temptablevaluecontract SET     sharelevel = @sharelevel_1 WHERE   contractid = @contractid_1 END FETCH NEXT FROM sharecontractid_cursor INTO @contractid_1, @sharelevel_1 END CLOSE sharecontractid_cursor DEALLOCATE sharecontractid_cursor  DECLARE sharecontractid_cursor CURSOR FOR SELECT DISTINCT t2.relateditemid , t2.sharelevel FROM    CRM_Contract t1 , Contract_ShareInfo t2 , HrmRoleMembers t3 WHERE   t1.id = t2.relateditemid AND t3.resourceid = @resourceid_1 AND t3.roleid = t2.roleid AND t3.rolelevel >= t2.rolelevel AND t2.seclevel <= @seclevel_1 AND ( ( t2.rolelevel = 0 AND t1.department = @departmentid_1 ) OR ( t2.rolelevel = 1 AND t1.subcompanyid1 = @subcompanyid_1 ) OR ( t3.rolelevel = 2 ) ) OPEN sharecontractid_cursor FETCH NEXT FROM sharecontractid_cursor INTO @contractid_1, @sharelevel_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF @countrec = 0 BEGIN INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, @sharelevel_1 ) END ELSE BEGIN SELECT  @sharelevel_Temp = sharelevel FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF ( ( @sharelevel_Temp = 1 ) AND ( @sharelevel_1 = 2 ) ) UPDATE  @temptablevaluecontract SET     sharelevel = @sharelevel_1 WHERE   contractid = @contractid_1 END FETCH NEXT FROM sharecontractid_cursor INTO @contractid_1, @sharelevel_1 END CLOSE sharecontractid_cursor DEALLOCATE sharecontractid_cursor   SET @managerstr_11 = '%,' + CONVERT(varchar(4000), @resourceid_1) + ',%'  DECLARE subcontractid_cursor CURSOR FOR SELECT  t2.id FROM    CRM_CustomerInfo t1 , CRM_Contract t2 WHERE   ( t1.manager IN ( SELECT DISTINCT id FROM      HrmResource WHERE     ',' + managerstr LIKE @managerstr_11 ) ) AND ( t2.crmId = t1.id ) OPEN subcontractid_cursor FETCH NEXT FROM subcontractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN SELECT  @countrec = COUNT(contractid) FROM    @temptablevaluecontract WHERE   contractid = @contractid_1 IF @countrec = 0 INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, 1 ) FETCH NEXT FROM subcontractid_cursor INTO @contractid_1 END CLOSE subcontractid_cursor DEALLOCATE subcontractid_cursor    DECLARE contractid_cursor CURSOR FOR SELECT  t2.id FROM    CRM_CustomerInfo t1 , CRM_Contract t2 WHERE   ( t1.manager = @resourceid_1 ) AND ( t2.crmId = t1.id ) OPEN contractid_cursor FETCH NEXT FROM contractid_cursor INTO @contractid_1 WHILE @@fetch_status = 0 BEGIN INSERT  INTO @temptablevaluecontract VALUES  ( @contractid_1, 1 ) FETCH NEXT FROM contractid_cursor INTO @contractid_1 END CLOSE contractid_cursor DEALLOCATE contractid_cursor   DELETE  FROM ContractShareDetail WHERE   userid = @resourceid_1 AND usertype = 1   DECLARE allcontractid_cursor CURSOR FOR SELECT  * FROM    @temptablevaluecontract OPEN allcontractid_cursor FETCH NEXT FROM allcontractid_cursor INTO @contractid_1, @sharelevel_1 WHILE @@fetch_status = 0 BEGIN INSERT  INTO ContractShareDetail ( contractid , userid , usertype , sharelevel ) VALUES  ( @contractid_1 , @resourceid_1 , 1 , @sharelevel_1 ) FETCH NEXT FROM allcontractid_cursor INTO @contractid_1, @sharelevel_1 END CLOSE allcontractid_cursor DEALLOCATE allcontractid_cursor  END  

 GO
alter procedure [MainMenuInfo_Update]( @id_1 		int, @oldIndex_1     int, @labelId_1	int, @menuName_1	Varchar(100), @linkAddress_1  Varchar(100), @parentFrame_1  Varchar(100), @defaultParentId_1 int, @defaultLevel_1 int, @defaultIndex_1 int, @needRightToVisible_1 char(1), @rightDetailToVisible_1 Varchar(100), @needRightToView_1 char(1), @rightDetailToView_1 Varchar(100), @needSwitchToVisible_1 char(1), @switchClassNameToVisible_1 Varchar(100), @switchMethodNameToVisible_1 Varchar(100), @needSwitchToView_1 char(1), @switchClassNameToView_1 Varchar(100), @switchMethodNameToView_1 Varchar(100), @relatedModuleId_1 int, @flag		int	output, @msg		varchar(4000)	output) AS   DECLARE @updateId int; DECLARE @updateIndex int;      IF (@defaultIndex_1<@oldIndex_1) BEGIN  SET @updateIndex = @defaultIndex_1;  DECLARE mainMenuInfo_cursor CURSOR FOR SELECT id FROM MainMenuInfo WHERE defaultParentId = @defaultParentId_1 AND defaultIndex >= @defaultIndex_1 AND defaultIndex <  @oldIndex_1 ORDER BY defaultIndex  OPEN mainMenuInfo_cursor FETCH NEXT FROM mainMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN SET @updateIndex = @updateIndex + 1;  UPDATE MainMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId FETCH NEXT FROM mainMenuInfo_cursor INTO @updateId END  CLOSE mainMenuInfo_cursor DEALLOCATE mainMenuInfo_cursor END IF (@defaultIndex_1>@oldIndex_1) BEGIN  SET @updateIndex = @oldIndex_1;  DECLARE mainMenuInfo_cursor CURSOR FOR SELECT id FROM MainMenuInfo WHERE defaultParentId = @defaultParentId_1 AND defaultIndex > @oldIndex_1 AND defaultIndex <= @defaultIndex_1 ORDER BY defaultIndex  OPEN mainMenuInfo_cursor FETCH NEXT FROM mainMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN UPDATE MainMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId SET @updateIndex = @updateIndex + 1; FETCH NEXT FROM mainMenuInfo_cursor INTO @updateId END  CLOSE mainMenuInfo_cursor DEALLOCATE mainMenuInfo_cursor END  UPDATE MainMenuInfo SET labelId = @labelId_1, menuName = @menuName_1, linkAddress = @linkAddress_1 , parentFrame = @parentFrame_1 , defaultParentId = @defaultParentId_1 , defaultLevel = @defaultLevel_1 , defaultIndex = @defaultIndex_1-1 , needRightToVisible = @needRightToVisible_1 , rightDetailToVisible = @rightDetailToVisible_1 , needRightToView = @needRightToView_1 , rightDetailToView = @rightDetailToView_1 , needSwitchToVisible = @needSwitchToVisible_1 , switchClassNameToVisible = @switchClassNameToVisible_1 , switchMethodNameToVisible = @switchMethodNameToVisible_1, needSwitchToView = @needSwitchToView_1 , switchClassNameToView = @switchClassNameToView_1 , switchMethodNameToView = @switchMethodNameToView_1, relatedModuleId = @relatedModuleId_1  WHERE id = @id_1   SET @flag = 1 SET @msg = 'ok'

 GO
alter procedure [MainMenuInfo_SelectByParentId]( @parentId_1 	int , @flag	int	output, @msg	varchar(4000)	output) AS SELECT id,labelId,menuName,linkAddress,parentFrame,defaultParentId, defaultLevel,defaultIndex,needRightToVisible,rightDetailToVisible,needRightToView,rightDetailToView, needSwitchToVisible,switchClassNameToVisible,switchMethodNameToVisible, needSwitchToView,switchClassNameToView,switchMethodNameToView,relatedModuleId FROM MainMenuInfo WHERE defaultParentId = @parentId_1 ORDER BY id SET @flag = 1 SET @msg = 'ok'

 GO
alter procedure [MainMenuInfo_SelectByLevel]( @menuLevel_1 	int , @flag	int	output, @msg	varchar(4000)	output) AS SELECT id,labelId,menuName,linkAddress,parentFrame,defaultParentId, defaultLevel,defaultIndex,needRightToVisible,rightDetailToVisible,needRightToView,rightDetailToView, needSwitchToVisible,switchClassNameToVisible,switchMethodNameToVisible, needSwitchToView,switchClassNameToView,switchMethodNameToView,relatedModuleId FROM MainMenuInfo WHERE defaultLevel = @menuLevel_1 ORDER BY id SET @flag = 1 SET @msg = 'ok'

 GO
alter procedure [MainMenuInfo_SelectById]( @id_1 	int , @flag	int	output, @msg	varchar(4000)	output) AS SELECT id,labelId,menuName,linkAddress,parentFrame,defaultParentId, defaultLevel,defaultIndex,needRightToVisible,rightDetailToVisible,needRightToView,rightDetailToView, needSwitchToVisible,switchClassNameToVisible,switchMethodNameToVisible, needSwitchToView,switchClassNameToView,switchMethodNameToView,relatedModuleId FROM MainMenuInfo WHERE id = @id_1 SET @flag = 1 SET @msg = 'ok'

GO
alter procedure [MMInfo_Insert]( @id_1 int, @labelId_1 int, @menuName_1 Varchar(100), @linkAddress_1 Varchar(100), @parentFrame_1 Varchar(100), @defaultParentId_1 int, @defaultLevel_1 int, @defaultIndex_1 int, @needRightToVisible_1 char(1), @rightDetailToVisible_1 Varchar(100), @needRightToView_1 char(1), @rightDetailToView_1 Varchar(100), @needSwitchToVisible_1 char(1), @switchClassNameToVisible_1 Varchar(100), @switchMethodNameToVisible_1 Varchar(100), @needSwitchToView_1 char(1), @switchClassNameToView_1 Varchar(100), @switchMethodNameToView_1 Varchar(100), @relatedModuleId_1 int) AS  DECLARE @updateId int; DECLARE @updateIndex int;  SET @updateIndex = @defaultIndex_1;  DECLARE @updateId_1 int DECLARE @updateIndex_1 int DECLARE mainMenuInfo_cursor CURSOR FOR SELECT id FROM MainMenuInfo WHERE defaultParentId = @defaultParentId_1 AND defaultIndex >= @defaultIndex_1 ORDER BY defaultIndex  OPEN mainMenuInfo_cursor FETCH NEXT FROM mainMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN SET @updateIndex = @updateIndex + 1; UPDATE MainMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId FETCH NEXT FROM mainMenuInfo_cursor INTO @updateId END  CLOSE mainMenuInfo_cursor DEALLOCATE mainMenuInfo_cursor  IF(@linkAddress_1 = '') BEGIN INSERT INTO MainMenuInfo ( id, labelId, menuName, linkAddress, parentFrame, defaultParentId, defaultLevel, defaultIndex, needRightToVisible, rightDetailToVisible, needRightToView, rightDetailToView, needSwitchToVisible, switchClassNameToVisible, switchMethodNameToVisible, needSwitchToView, switchClassNameToView, switchMethodNameToView, parentId, relatedModuleId) VALUES ( @id_1, @labelId_1, @menuName_1, NULL , @parentFrame_1 , @defaultParentId_1 , @defaultLevel_1 , @defaultIndex_1 , @needRightToVisible_1 , @rightDetailToVisible_1 , @needRightToView_1 , @rightDetailToView_1 , @needSwitchToVisible_1 , @switchClassNameToVisible_1 , @switchMethodNameToVisible_1 , @needSwitchToView_1 , @switchClassNameToView_1 , @switchMethodNameToView_1 , @defaultParentId_1 , @relatedModuleId_1 ) END ELSE BEGIN INSERT INTO MainMenuInfo ( id, labelId, menuName, linkAddress, parentFrame, defaultParentId, defaultLevel, defaultIndex, needRightToVisible, rightDetailToVisible, needRightToView, rightDetailToView, needSwitchToVisible, switchClassNameToVisible, switchMethodNameToVisible, needSwitchToView, switchClassNameToView, switchMethodNameToView, parentId, relatedModuleId) VALUES ( @id_1, @labelId_1, @menuName_1, @linkAddress_1 , @parentFrame_1 , @defaultParentId_1 , @defaultLevel_1 , @defaultIndex_1 , @needRightToVisible_1 , @rightDetailToVisible_1 , @needRightToView_1 , @rightDetailToView_1 , @needSwitchToVisible_1 , @switchClassNameToVisible_1 , @switchMethodNameToVisible_1 , @needSwitchToView_1 , @switchClassNameToView_1 , @switchMethodNameToView_1 , @defaultParentId_1 , @relatedModuleId_1 ) END

GO
alter procedure [MMConfig_U_ByInfoInsert]( @parentId_1	int, @defaultIndex_1	int ) AS begin UPDATE MainMenuConfig SET viewIndex=viewIndex+1 WHERE infoId IN (SELECT id FROM MainMenuInfo WHERE parentId=@parentId_1) AND viewIndex>=@defaultIndex_1 END

 GO
alter procedure [LeftMenuInfo_Update]( @id_1 		int, @oldIndex_1		int, @labelId_1 		int, @iconUrl_1		varchar(4000), @linkAddress_1      varchar(4000), @menuLevel_1	int, @parentId_1		int, @defaultIndex_1	int, @relatedModuleId_1  int, @flag		int	output, @msg		varchar(4000)	output) AS   DECLARE @updateId int; DECLARE @updateIndex int;     IF (@menuLevel_1 = 1) BEGIN    IF (@defaultIndex_1<@oldIndex_1) BEGIN  SET @updateIndex = @defaultIndex_1;  DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id FROM LeftMenuInfo WHERE parentId IS NULL AND defaultIndex >= @defaultIndex_1 AND defaultIndex <  @oldIndex_1 ORDER BY defaultIndex  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN SET @updateIndex = @updateIndex + 1;  UPDATE LeftMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor  UPDATE LeftMenuInfo SET labelId = @labelId_1, defaultIndex = @defaultIndex_1, relatedModuleId = @relatedModuleId_1 WHERE id = @id_1 END IF (@defaultIndex_1>@oldIndex_1) BEGIN  SET @updateIndex = @oldIndex_1;  DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id FROM LeftMenuInfo WHERE parentId IS NULL AND defaultIndex > @oldIndex_1 AND defaultIndex <= @defaultIndex_1 ORDER BY defaultIndex  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN UPDATE LeftMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId SET @updateIndex = @updateIndex + 1; FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor  UPDATE LeftMenuInfo SET labelId = @labelId_1, defaultIndex = @defaultIndex_1-1, relatedModuleId = @relatedModuleId_1 WHERE id = @id_1 END END ELSE BEGIN    IF (@defaultIndex_1<@oldIndex_1) BEGIN  SET @updateIndex = @defaultIndex_1;  DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id FROM LeftMenuInfo WHERE parentId = @parentId_1 AND defaultIndex >= @defaultIndex_1 AND defaultIndex <  @oldIndex_1 ORDER BY defaultIndex  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN  SET @updateIndex = @updateIndex + 1; UPDATE LeftMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor UPDATE LeftMenuInfo SET labelId = @labelId_1, iconUrl = @iconUrl_1, linkAddress = @linkAddress_1, parentId = @parentId_1, defaultIndex = @defaultIndex_1, relatedModuleId = @relatedModuleId_1 WHERE id = @id_1 END IF (@defaultIndex_1>@oldIndex_1) BEGIN  SET @updateIndex = @oldIndex_1;  DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id FROM LeftMenuInfo WHERE parentId = @parentId_1 AND defaultIndex > @oldIndex_1 AND defaultIndex <= @defaultIndex_1 ORDER BY defaultIndex  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN  UPDATE LeftMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId SET @updateIndex = @updateIndex + 1; FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor  UPDATE LeftMenuInfo SET labelId = @labelId_1, iconUrl = @iconUrl_1, linkAddress = @linkAddress_1, parentId = @parentId_1, defaultIndex = @defaultIndex_1-1, relatedModuleId = @relatedModuleId_1 WHERE id = @id_1 END   END   SET @flag = 1 SET @msg = 'ok'

 GO
alter procedure [LeftMenuInfo_SelectByParentId]( @parentId_1 	int , @flag	int	output, @msg	varchar(4000)	output) AS SELECT id,labelId,iconUrl,linkAddress,menuLevel,parentId,defaultIndex,relatedModuleId FROM LeftMenuInfo WHERE parentId = @parentId_1 ORDER BY id SET @flag = 1 SET @msg = 'ok'

 GO
alter procedure [LeftMenuInfo_SelectByLevel]( @menuLevel_1 	int , @flag	int	output, @msg	varchar(4000)	output) AS SELECT id,labelId,iconUrl,linkAddress,menuLevel,parentId,defaultIndex,relatedModuleId FROM LeftMenuInfo WHERE menuLevel = @menuLevel_1 ORDER BY id SET @flag = 1 SET @msg = 'ok'

 GO
alter procedure [LeftMenuInfo_SelectById]( @id_1 	int , @flag	int	output, @msg	varchar(4000)	output) AS SELECT id,labelId,iconUrl,linkAddress,menuLevel,parentId,defaultIndex,relatedModuleId FROM LeftMenuInfo WHERE id = @id_1 SET @flag = 1 SET @msg = 'ok'

GO
alter procedure [LeftMenuInfo_Insert]( @id_1 				int , @labelId_1 			int , @iconUrl_1			varchar(4000), @linkAddress_1      varchar(4000), @menuLevel_1		int, @parentId_1			int, @defaultIndex_1		int, @useCustomName_1	char(1), @customName_1		varchar(4000), @relatedModuleId_1  int, @isCustom_1			char(1), @flag				int	output, @msg				varchar(4000)	output) AS  DECLARE @updateId int; DECLARE @updateIndex int;   IF (@menuLevel_1 = 1) BEGIN  SET @updateIndex = @defaultIndex_1;   DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id FROM LeftMenuInfo WHERE parentId IS NULL AND defaultIndex >= @defaultIndex_1 ORDER BY defaultIndex  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN SET @updateIndex = @updateIndex + 1; UPDATE LeftMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor  INSERT INTO LeftMenuInfo ( id, labelId, iconUrl, linkAddress, menuLevel, parentId, defaultIndex, useCustomName, customName, relatedModuleId, isCustom) VALUES ( @id_1, @labelId_1, NULL, NULL, @menuLevel_1, NULL, @defaultIndex_1, @useCustomName_1, @customName_1, @relatedModuleId_1, @isCustom_1 ) END ELSE BEGIN  SET @updateIndex = @defaultIndex_1;  DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id FROM LeftMenuInfo WHERE parentId = @parentId_1 AND defaultIndex >= @defaultIndex_1 ORDER BY defaultIndex  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN SET @updateIndex = @updateIndex + 1;  UPDATE LeftMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor  INSERT INTO LeftMenuInfo ( id, labelId, iconUrl, linkAddress, menuLevel, parentId, defaultIndex, useCustomName, customName, relatedModuleId, isCustom) VALUES ( @id_1, @labelId_1, @iconUrl_1, @linkAddress_1, @menuLevel_1, @parentId_1, @defaultIndex_1, @useCustomName_1, @customName_1, @relatedModuleId_1, @isCustom_1 ) END   SET @flag = 1 SET @msg = 'ok'

 GO
alter procedure [LeftMenuInfo_DeleteById]( @id_1 	int , @flag	int	output, @msg	varchar(4000)	output) AS DECLARE @menuLevel int DECLARE @updateId int DECLARE @updateIndex int DECLARE @defaultIndex int DECLARE @parentId int  SELECT @menuLevel = menuLevel ,@parentId = parentId,@defaultIndex = defaultIndex FROM LeftMenuInfo WHERE id = @id_1  DELETE FROM LeftMenuInfo WHERE id = @id_1  SET @updateIndex = @defaultIndex;   IF (@menuLevel = 1) BEGIN   DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id FROM LeftMenuInfo WHERE parentId IS NULL AND defaultIndex > @defaultIndex ORDER BY defaultIndex  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN  UPDATE LeftMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId  SET @updateIndex = @updateIndex + 1;  FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor END ELSE BEGIN   DECLARE leftMenuInfo_cursor CURSOR FOR SELECT id FROM LeftMenuInfo WHERE parentId = @parentId AND defaultIndex > @defaultIndex ORDER BY defaultIndex  OPEN leftMenuInfo_cursor FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId  WHILE @@FETCH_STATUS = 0 BEGIN UPDATE LeftMenuInfo SET defaultIndex = @updateIndex WHERE id = @updateId  SET @updateIndex = @updateIndex + 1;  FETCH NEXT FROM leftMenuInfo_cursor INTO @updateId END  CLOSE leftMenuInfo_cursor DEALLOCATE leftMenuInfo_cursor END  SET @flag = 1 SET @msg = 'ok'

GO
alter procedure [LgcAssetCrm_SelectType] (@assetid [int], @flag integer output , @msg varchar(4000) output) AS SELECT type FROM CRM_CustomerInfo a INNER JOIN LgcAssetCrm b ON a.id = b.crmid where b.assetid=@assetid group by type

GO
alter procedure [LgcAssetCrm_SelectByAsset] (@assetid [int], @type [int], @flag integer output , @msg varchar(4000) output) AS select a.id,a.crmid,a.countryid,a.purchaseprice,a.currencyid,a.ismain from LgcAssetCrm a,CRM_CustomerInfo b where a.assetid = @assetid and  b.type=@type and a.crmid=b.id order by a.countryid

GO
alter procedure [CptBorrowBuffer_Check] ( @currDate char(10), @flag integer output , @msg varchar(4000) output) AS DECLARE @m_recId int DECLARE @m_cptId int DECLARE @m_useDate char(10) DECLARE @m_deptId int DECLARE @m_userId int DECLARE @m_depositary varchar(4000) DECLARE @m_remark varchar(4000) DECLARE all_cursor CURSOR FOR SELECT id, cptId, useDate, deptId, userId, depositary, remark FROM CptBorrowBuffer OPEN all_cursor FETCH NEXT FROM all_cursor INTO @m_recId, @m_cptId, @m_useDate, @m_deptId, @m_userId, @m_depositary, @m_remark WHILE (@@FETCH_STATUS = 0) BEGIN IF (@currDate >= @m_useDate) BEGIN EXEC CptUseLogLend_Insert @m_cptId, @m_useDate, @m_deptId, @m_userId, 1, @m_depositary, 0, '', 0, '3', @m_remark, 0, '', '' DELETE CptBorrowBuffer WHERE id = @m_recId END  FETCH NEXT FROM all_cursor INTO @m_recId, @m_cptId, @m_useDate, @m_deptId, @m_userId, @m_depositary, @m_remark END CLOSE all_cursor DEALLOCATE all_cursor

GO
alter procedure [WorkPlan_Update] ( @id_1 int, @type_n_1 int, @name_1 varchar(4000), @resourceid_1 varchar(4000), @begindate_1 char(10), @begintime_1 char(8), @enddate_1 char(10), @endtime_1 char(8), @description_1 text, @requestid_1 varchar(4000), @projectid_1 varchar(4000), @crmid_1 varchar(4000), @docid_1 varchar(4000), @meetingid_1 varchar(4000), @isremind_1 int, @waketime_1 int, @taskid_1 varchar(4000), @urgentLevel_1 char(1),  @remindType_1 CHAR(1), @remindBeforeStart_1 CHAR(1), @remindBeforeEnd_1 CHAR(1), @remindTimesBeforeStart_1 int, @remindTimesBeforeEnd_1 int, @remindDateBeforeStart_1 CHAR(10), @remindTimeBeforeStart_1 CHAR(8), @remindDateBeforeEnd_1 CHAR(10), @remindTimeBeforeEnd_1 CHAR(8),  @hrmPerformanceCheckDetailID_1 int,  @flag integer output, @msg varchar(4000) output ) AS UPDATE WorkPlan SET type_n = @type_n_1, name = @name_1, resourceid = @resourceid_1, begindate = @begindate_1, begintime = @begintime_1, enddate = @enddate_1, endtime  = @endtime_1, description = @description_1, requestid  = @requestid_1, projectid = @projectid_1, crmid  = @crmid_1, docid  = @docid_1, meetingid = @meetingid_1, isremind  = @isremind_1, waketime  = @waketime_1, taskid = @taskid_1, urgentLevel = @urgentLevel_1,  remindType = @remindType_1, remindBeforeStart = @remindBeforeStart_1, remindBeforeEnd = @remindBeforeEnd_1, remindTimesBeforeStart = @remindTimesBeforeStart_1, remindTimesBeforeEnd = @remindTimesBeforeEnd_1, remindDateBeforeStart = @remindDateBeforeStart_1, remindTimeBeforeStart = @remindTimeBeforeStart_1, remindDateBeforeEnd = @remindDateBeforeEnd_1, remindTimeBeforeEnd = @remindTimeBeforeEnd_1,  hrmPerformanceCheckDetailID = @hrmPerformanceCheckDetailID_1  WHERE id = @id_1

GO
alter procedure [WorkPlan_InsertPlus] ( @type_n_1 int, @name_1 varchar(4000), @resourceid_1 varchar(4000), @begindate_1 char(10), @begintime_1 char(8), @enddate_1 char(10), @endtime_1 char(8), @description_1 text, @requestid_1 varchar(4000), @projectid_1 varchar(4000), @crmid_1 varchar(4000), @docid_1 varchar(4000), @meetingid_1 varchar(4000), @isremind_1 int, @waketime_1 int, @createrid_1 int, @createrType_1 char(1), @createdate_1 char(10), @createtime_1 char(8), @taskid_1 varchar(4000), @urgentLevel_1 char(1), @status_1 char(1), @relatedprj_1	varchar(4000), @relatedcus_1	varchar(4000), @relatedwf_1	varchar(4000), @relateddoc_1	varchar(4000),  @remindType_1 CHAR(1), @remindBeforeStart_1 CHAR(1), @remindBeforeEnd_1 CHAR(1), @remindTimesBeforeStart_1 int, @remindTimesBeforeEnd_1 int, @remindDateBeforeStart_1 CHAR(10), @remindTimeBeforeStart_1 CHAR(8), @remindDateBeforeEnd_1 CHAR(10), @remindTimeBeforeEnd_1 CHAR(8), @hrmPerformanceCheckDetailID_1 int,  @flag integer output, @msg varchar(4000) output ) AS INSERT INTO WorkPlan ( type_n, name, resourceid, begindate, begintime, enddate, endtime, description, requestid, projectid, crmid, docid, meetingid, status, isremind, waketime, createrid, createdate, createtime, deleted, taskid, urgentLevel, createrType, relatedprj, relatedcus, relatedwf, relateddoc,  remindType, remindBeforeStart, remindBeforeEnd, remindTimesBeforeStart, remindTimesBeforeEnd, remindDateBeforeStart, remindTimeBeforeStart, remindDateBeforeEnd, remindTimeBeforeEnd, hrmPerformanceCheckDetailID ) VALUES ( @type_n_1, @name_1, @resourceid_1, @begindate_1, @begintime_1, @enddate_1, @endtime_1, @description_1, @requestid_1, @projectid_1, @crmid_1, @docid_1, @meetingid_1, @status_1, @isremind_1, @waketime_1, @createrid_1, @createdate_1, @createtime_1, '0', @taskid_1, @urgentLevel_1, @createrType_1, @relatedprj_1, @relatedcus_1, @relatedwf_1, @relateddoc_1, @remindType_1, @remindBeforeStart_1, @remindBeforeEnd_1, @remindTimesBeforeStart_1, @remindTimesBeforeEnd_1, @remindDateBeforeStart_1, @remindTimeBeforeStart_1, @remindDateBeforeEnd_1, @remindTimeBeforeEnd_1, @hrmPerformanceCheckDetailID_1 ) DECLARE @m_id int DECLARE @m_deptId int DECLARE @m_subcoId int SELECT @m_id = MAX(id) FROM WorkPlan SELECT @m_deptId = departmentid, @m_subcoId = subcompanyid1 FROM HrmResource WHERE id = @createrid_1 UPDATE WorkPlan SET deptId = @m_deptId, subcompanyId = @m_subcoId where id = @m_id SELECT @m_id AS id

GO
alter procedure [WorkPlan_Insert] ( @type_n_1  [char] (1)   , @name_1  varchar(4000)   , @resourceid_1  varchar(4000)   , @begindate_1  [char] (10)   , @begintime_1  [char] (8)   , @enddate_1  [char] (10)   , @endtime_1  [char] (8)   , @description_1  [text]    , @requestid_1  varchar(4000)   , @projectid_1  varchar(4000)   , @crmid_1  varchar(4000)   , @docid_1  varchar(4000)   , @meetingid_1  varchar(4000)   , @status_1  [char] (1)   , @isremind_1 [int]  , @waketime_1 [int]   , @createrid_1 [int]   , @createdate_1 [char] (10)   , @createtime_1 [char] (8) , @deleted_1 [char] (1)   , @taskid_1 varchar(4000), @urgentLevel_1 [char] (1), @agentId_1 [int], @flag integer output, @msg varchar(4000) output) AS INSERT INTO [WorkPlan] ( type_n , name  , resourceid , begindate , begintime , enddate , endtime  , description , requestid  , projectid , crmid  , docid  , meetingid , status  , isremind  , waketime  , createrid  , createdate  , createtime , deleted, taskid, urgentLevel, agentId ) VALUES ( @type_n_1 , @name_1  , @resourceid_1 , @begindate_1 , @begintime_1 , @enddate_1 , @endtime_1  , @description_1 , @requestid_1  , @projectid_1 , @crmid_1  , @docid_1  , @meetingid_1 , @status_1  , @isremind_1  , @waketime_1  , @createrid_1  , @createdate_1  , @createtime_1 , @deleted_1, @taskid_1, @urgentLevel_1, @agentId_1 )  DECLARE @m_id int DECLARE @m_deptId int DECLARE @m_subcoId int  SELECT @m_id = MAX(id) FROM WorkPlan SELECT @m_deptId = departmentid, @m_subcoId = subcompanyid1 FROM HrmResource WHERE id = @createrid_1 UPDATE WorkPlan SET deptId = @m_deptId, subcompanyId = @m_subcoId where id = @m_id SELECT @m_id AS id

GO
alter procedure [PDocShare_SetById] ( @docid_1  int , @flag int output, @msg varchar(4000) output ) AS Declare @doccreaterid int , @hrmid int, @sharelevel int, @all_cursor cursor   delete shareinnerdoc where sourceid = @docid_1   select @doccreaterid = doccreaterid from docdetail where id =  @docid_1   exec Share_forDoc @docid_1,'',''

GO
alter procedure [NewPageInfo_Insert_All]( @flag	int	output, @msg	varchar(4000)	output) AS DECLARE @id_1 int, @frontpagename_1 varchar(4000), @defaultIndex_1 int  SET @defaultIndex_1 = 1  DECLARE docFrontpage_cursor CURSOR FOR SELECT id, frontpagename FROM DocFrontpage WHERE isactive = 1 and publishtype = 1 ORDER BY id  OPEN docFrontpage_cursor FETCH NEXT FROM docFrontpage_cursor INTO @id_1,@frontpagename_1   WHILE @@FETCH_STATUS = 0  BEGIN INSERT INTO MainMenuInfo (id,menuName,linkAddress,parentFrame,defaultLevel,defaultParentId,defaultIndex,needRightToVisible,needRightToView,needSwitchToVisible,relatedModuleId) VALUES(-@id_1,@frontpagename_1,'/docs/news/NewsDsp.jsp?id='+CAST(@id_1 AS varchar(4000)),'mainFrame',1,1,@defaultIndex_1,0,0,0,9) SET @defaultIndex_1=@defaultIndex_1+1; FETCH NEXT FROM docFrontpage_cursor INTO @id_1,@frontpagename_1 END   INSERT INTO MainMenuInfo (id,labelId,linkAddress,parentFrame,defaultParentId,defaultLevel,defaultIndex,needRightToVisible,needRightToView,needSwitchToVisible,relatedModuleId) VALUES(-1000,16390,'/docs/news/DocNews.jsp','mainFrame',1,1,1000,0,0,0,9)   CLOSE docFrontpage_cursor DEALLOCATE docFrontpage_cursor

GO
alter procedure [Mail2CRMContact] @userid int, @crmid int, @mailid int, @flag int output, @msg varchar(4000) output as INSERT INTO WorkPlan (type_n,begindate,begintime,resourceid,description,name,status,urgentLevel,createrid,createrType,crmid) SELECT '3',LEFT(senddate,10),RIGHT(senddate,8),@userid,content,subject,'2','1',@userid,'1',@crmid FROM MailResource WHERE id=@mailid select ident_current('WorkPlan')

GO
alter procedure [DocRpSum] ( @optional	varchar(4000), @userid int, @flag	int output, @msg 	varchar(4000)  output ) AS declare @resultid  int, @count  int, @replycount  int create table #temp( resultid  int , acount  int, replycount int ) if   @optional='doccreater' begin declare resultid_cursor cursor for select top 20 count(id) resultcount, ownerid resultid from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) group by ownerid order by resultcount desc  open resultid_cursor fetch next from resultid_cursor into @count, @resultid while @@fetch_status=0 begin select @replycount=count(id) from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) and doccreaterid=@resultid and isreply='1' insert into #temp values(@resultid, @count, @replycount)  fetch next from resultid_cursor into @count, @resultid end close resultid_cursor deallocate resultid_cursor  select * from #temp order by acount desc end  if @optional='crm' begin declare resultid_cursor cursor for select top 20 count(id) resultcount, t1.crmid resultid from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) group by t1.crmid order by resultcount desc  open resultid_cursor fetch next from resultid_cursor into @count, @resultid while @@fetch_status=0 begin select @replycount=count(id) from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) and t1.crmid=@resultid and isreply='1' insert into #temp values(@resultid, @count, @replycount) fetch next from resultid_cursor into @count, @resultid end close resultid_cursor deallocate resultid_cursor select * from #temp order by acount  desc end if   @optional='resource' begin declare resultid_cursor cursor for select top 20 count(id) resultcount, hrmresid resultid from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) group by hrmresid order by resultcount desc  open resultid_cursor fetch next from resultid_cursor into @count, @resultid while @@fetch_status=0 begin select @replycount=count(id) from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) and hrmresid=@resultid and isreply='1'  insert into #temp values(@resultid, @count, @replycount) fetch next from resultid_cursor into @count, @resultid end close resultid_cursor deallocate resultid_cursor  Select * from #temp order by acount desc end if   @optional='project' begin declare resultid_cursor cursor for select top 20 count(id) resultcount, projectid resultid from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) group by projectid order by resultcount desc  open resultid_cursor fetch next from resultid_cursor into @count, @resultid while @@fetch_status=0 begin select @replycount=count(id) from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) and projectid=@resultid and isreply='1'  insert into #temp values(@resultid, @count, @replycount)  fetch next from resultid_cursor  into @count, @resultid end close resultid_cursor deallocate resultid_cursor select * from #temp order by acount desc end if   @optional='department' begin declare resultid_cursor cursor for select top 20 count(id) resultcount, docdepartmentid resultid from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) and docdepartmentid>0  group by docdepartmentid order by resultcount desc  open resultid_cursor fetch next from resultid_cursor into @count, @resultid while @@fetch_status=0 begin select @replycount=count(id) from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) and docdepartmentid=@resultid and isreply='1' insert into #temp values(@resultid, @count, @replycount) fetch next from resultid_cursor into @count, @resultid end close resultid_cursor deallocate resultid_cursor select * from #temp order by acount desc end if   @optional='language' begin declare resultid_cursor cursor for select top 20 count(id) resultcount, doclangurage resultid from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) group by doclangurage order by resultcount desc  open resultid_cursor fetch next from resultid_cursor into @count, @resultid while @@fetch_status=0 begin select @replycount=count(id) from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) and doclangurage=@resultid and isreply='1'  insert into #temp values(@resultid, @count, @replycount) fetch next from resultid_cursor into @count, @resultid end close resultid_cursor deallocate resultid_cursor select * from #temp order by acount desc end if   @optional='item' begin declare resultid_cursor cursor for select top 20 count(id) resultcount, itemid resultid from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) group by itemid order by resultcount desc  open resultid_cursor fetch next from resultid_cursor into @count, @resultid while @@fetch_status=0 begin select @replycount=count(id) from docdetail as t1, GetDocShareDetailTable(@userid ,1)  as t2 where t1.id=t2.sourceid and t1.docstatus in (1,2,5) and itemid=@resultid and isreply='1' insert into #temp values(@resultid, @count, @replycount)  fetch next from resultid_cursor into @count, @resultid end close resultid_cursor deallocate resultid_cursor select * from #temp order by acount desc end

GO
alter procedure [DocFrontpage_SelectDefID] (@usertype 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS select min(id) from DocFrontpage where publishtype = @usertype

GO
alter procedure [DocFrontpage_SelectByid] (@id_1  integer , @flag	[int]	output, @msg	varchar(4000)	output) AS select * from DocFrontpage where id = @id_1

GO
alter procedure [DocFrontpage_SelectAll] (@flag	[int]	output, @msg	varchar(4000)	output) AS select * from DocFrontpage order by id

GO
alter procedure [DocFrontpage_Insert_New](@frontpagename_1 	varchar(4000), @frontpagedesc_2 	varchar(4000), @isactive_3 	char(1), @departmentid_4 	int, @linktype_5 	varchar(4000), @hasdocsubject_6 	char(1), @hasfrontpagelist_7 	char(1), @newsperpage_8 	tinyint, @titlesperpage_9 	tinyint, @defnewspicid_10 	int, @backgroundpicid_11 	int, @importdocid_12 	varchar(4000), @headerdocid_13 	int, @footerdocid_14 	int, @secopt_15 	varchar(4000), @seclevelopt_16 	tinyint, @departmentopt_17 	int, @dateopt_18 	int, @languageopt_19 	int, @clauseopt_20 	text, @newsclause_21 	text, @languageid_22 	int, @publishtype_23 	int , @newstypeid_24 	int , @typeordernum_25 int, @subcompanyid_26 int, @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO DocFrontpage ( frontpagename, frontpagedesc, isactive, departmentid, linktype, hasdocsubject, hasfrontpagelist, newsperpage, titlesperpage, defnewspicid, backgroundpicid, importdocid, headerdocid, footerdocid, secopt, seclevelopt, departmentopt, dateopt, languageopt, clauseopt, newsclause, languageid, publishtype, newstypeid, typeordernum,subcompanyid) VALUES ( @frontpagename_1, @frontpagedesc_2, @isactive_3, @departmentid_4, @linktype_5, @hasdocsubject_6, @hasfrontpagelist_7, @newsperpage_8, @titlesperpage_9, @defnewspicid_10, @backgroundpicid_11, @importdocid_12, @headerdocid_13, @footerdocid_14, @secopt_15, @seclevelopt_16, @departmentopt_17, @dateopt_18, @languageopt_19, @clauseopt_20, @newsclause_21, @languageid_22, @publishtype_23, @newstypeid_24,@typeordernum_25,@subcompanyid_26) select max(id) from DocFrontpage

GO
alter procedure [DocFrontpage_Insert] (@frontpagename_1 	varchar(4000), @frontpagedesc_2 	varchar(4000), @isactive_3 	char(1), @departmentid_4 	int, @linktype_5 	varchar(4000), @hasdocsubject_6 	char(1), @hasfrontpagelist_7 	char(1), @newsperpage_8 	tinyint, @titlesperpage_9 	tinyint, @defnewspicid_10 	int, @backgroundpicid_11 	int, @importdocid_12 	varchar(4000), @headerdocid_13 	int, @footerdocid_14 	int, @secopt_15 	varchar(4000), @seclevelopt_16 	tinyint, @departmentopt_17 	int, @dateopt_18 	int, @languageopt_19 	int, @clauseopt_20 	text, @newsclause_21 	text, @languageid_22 	int, @publishtype_23 	int , @newstypeid_24 	int , @typeordernum_25 int, @flag	int	output, @msg	varchar(4000)	output) AS INSERT INTO DocFrontpage ( frontpagename, frontpagedesc, isactive, departmentid, linktype, hasdocsubject, hasfrontpagelist, newsperpage, titlesperpage, defnewspicid, backgroundpicid, importdocid, headerdocid, footerdocid, secopt, seclevelopt, departmentopt, dateopt, languageopt, clauseopt, newsclause, languageid, publishtype, newstypeid, typeordernum) VALUES ( @frontpagename_1, @frontpagedesc_2, @isactive_3, @departmentid_4, @linktype_5, @hasdocsubject_6, @hasfrontpagelist_7, @newsperpage_8, @titlesperpage_9, @defnewspicid_10, @backgroundpicid_11, @importdocid_12, @headerdocid_13, @footerdocid_14, @secopt_15, @seclevelopt_16, @departmentopt_17, @dateopt_18, @languageopt_19, @clauseopt_20, @newsclause_21, @languageid_22, @publishtype_23, @newstypeid_24,@typeordernum_25) select max(id) from DocFrontpage

GO
alter procedure [DocFrontpage_Delete] (@id_1 	[int] , @flag	[int]	output, @msg	varchar(4000)	output)  AS DELETE [DocFrontpage]  WHERE ( [id]	 = @id_1)

GO
alter procedure [fix_workplan_data] as Declare @id int, @crmid varchar(4000), @relatedprj varchar(4000), @relatedcus varchar(4000), @relatedwf varchar(4000), @relateddoc varchar(4000), @all_cursor cursor SET @all_cursor = CURSOR FORWARD_ONLY STATIC FOR select id,crmid,relatedprj,relatedcus,relatedwf,relateddoc from WorkPlan where (relatedprj!='' or relatedcus!='' or relatedwf!='' or relateddoc!='') and (relatedprj!='0' and relatedcus!='0' and relatedwf!='0' and relateddoc!='0') OPEN @all_cursor FETCH NEXT FROM @all_cursor INTO @id,@crmid,@relatedprj,@relatedcus,@relatedwf,@relateddoc WHILE @@FETCH_STATUS = 0 begin update WorkPlan set taskid=@relatedprj,crmid=@crmid+','+@relatedcus,requestid=@relatedwf,docid=@relateddoc where id=@id FETCH NEXT FROM @all_cursor INTO @id,@crmid,@relatedprj,@relatedcus,@relatedwf,@relateddoc end CLOSE @all_cursor DEALLOCATE @all_cursor

GO
alter procedure [DocFrontpage_Update_New](@id_1 	int, @frontpagename_2 	varchar(4000), @frontpagedesc_3 	varchar(4000), @isactive_4 	char(1), @departmentid_5 	int, @hasdocsubject_7 	char(1), @hasfrontpagelist_8 	char(1), @newsperpage_9 	tinyint, @titlesperpage_10 	tinyint, @defnewspicid_11 	int, @backgroundpicid_12 	int, @importdocid_13 	varchar(4000), @headerdocid_14 	int, @footerdocid_15 	int, @secopt_16 	varchar(4000), @seclevelopt_17 	tinyint, @departmentopt_18 	int, @dateopt_19 	int, @languageopt_20 	int, @clauseopt_21 	text, @newsclause_22 	text, @languageid_23 	int, @publishtype_24 	int , @newstypeid_25  int, @typeordernum_26  int, @checkOutStatus_27  int, @checkOutUserId_28  int, @subcompanyid_29 int, @flag	int	output, @msg	varchar(4000)	output) AS UPDATE DocFrontpage  SET  frontpagename	 = @frontpagename_2, frontpagedesc	 = @frontpagedesc_3, isactive	 = @isactive_4, departmentid	 = @departmentid_5, hasdocsubject	 = @hasdocsubject_7, hasfrontpagelist	 = @hasfrontpagelist_8, newsperpage	 = @newsperpage_9, titlesperpage	 = @titlesperpage_10, defnewspicid	 = @defnewspicid_11, backgroundpicid	 = @backgroundpicid_12, importdocid	 = @importdocid_13, headerdocid	 = @headerdocid_14, footerdocid	 = @footerdocid_15, secopt	 = @secopt_16, seclevelopt	 = @seclevelopt_17, departmentopt	 = @departmentopt_18, dateopt	 = @dateopt_19, languageopt	 = @languageopt_20, clauseopt	 = @clauseopt_21, newsclause	 = @newsclause_22, languageid	 = @languageid_23, publishtype	 = @publishtype_24, newstypeid=@newstypeid_25, typeordernum=@typeordernum_26, checkOutStatus=@checkOutStatus_27, checkOutUserId=@checkOutUserId_28,subcompanyid=@subcompanyid_29  WHERE ( id = @id_1)

GO
alter procedure [DocFrontpage_Update] (@id_1 	int, @frontpagename_2 	varchar(4000), @frontpagedesc_3 	varchar(4000), @isactive_4 	char(1), @departmentid_5 	int, @hasdocsubject_7 	char(1), @hasfrontpagelist_8 	char(1), @newsperpage_9 	tinyint, @titlesperpage_10 	tinyint, @defnewspicid_11 	int, @backgroundpicid_12 	int, @importdocid_13 	varchar(4000), @headerdocid_14 	int, @footerdocid_15 	int, @secopt_16 	varchar(4000), @seclevelopt_17 	tinyint, @departmentopt_18 	int, @dateopt_19 	int, @languageopt_20 	int, @clauseopt_21 	text, @newsclause_22 	text, @languageid_23 	int, @publishtype_24 	int , @newstypeid_25  int, @typeordernum_26  int, @checkOutStatus_27  int, @checkOutUserId_28  int, @flag	int	output, @msg	varchar(4000)	output) AS UPDATE DocFrontpage  SET  frontpagename	 = @frontpagename_2, frontpagedesc	 = @frontpagedesc_3, isactive	 = @isactive_4, departmentid	 = @departmentid_5, hasdocsubject	 = @hasdocsubject_7, hasfrontpagelist	 = @hasfrontpagelist_8, newsperpage	 = @newsperpage_9, titlesperpage	 = @titlesperpage_10, defnewspicid	 = @defnewspicid_11, backgroundpicid	 = @backgroundpicid_12, importdocid	 = @importdocid_13, headerdocid	 = @headerdocid_14, footerdocid	 = @footerdocid_15, secopt	 = @secopt_16, seclevelopt	 = @seclevelopt_17, departmentopt	 = @departmentopt_18, dateopt	 = @dateopt_19, languageopt	 = @languageopt_20, clauseopt	 = @clauseopt_21, newsclause	 = @newsclause_22, languageid	 = @languageid_23, publishtype	 = @publishtype_24, newstypeid=@newstypeid_25, typeordernum=@typeordernum_26, checkOutStatus=@checkOutStatus_27, checkOutUserId=@checkOutUserId_28  WHERE ( id = @id_1)

GO
alter procedure [CRM_ShareByHrm_WorkPlan] ( @crmId_1 varchar(4000), @userId_1 int, @flag integer output , @msg varchar(4000) output) AS DECLARE @m_workid int DECLARE all_cursor CURSOR FOR SELECT id FROM WorkPlan WHERE type_n = '3' AND (','+crmid+',') LIKE ('%,'+@crmId_1+',%') OPEN all_cursor FETCH NEXT FROM all_cursor INTO @m_workid WHILE (@@FETCH_STATUS = 0) BEGIN IF NOT EXISTS (SELECT workid FROM WorkPlanShareDetail WHERE workid = @m_workid AND userid = @userId_1 AND usertype = 1) INSERT INTO WorkPlanShareDetail (workid, userid, usertype, sharelevel) VALUES ( @m_workid, @userId_1, 1, 0) FETCH NEXT FROM all_cursor INTO @m_workid END CLOSE all_cursor DEALLOCATE all_cursor

GO
alter procedure [CRM_Share_WorkPlan_Del] ( @crmId_1 int, @flag integer output , @msg varchar(4000) output) AS DECLARE @m_workid int DECLARE all_cursor CURSOR FOR SELECT id FROM WorkPlan WHERE type_n = '3' AND crmid = CONVERT(varchar(4000), @crmId_1) OPEN all_cursor FETCH NEXT FROM all_cursor INTO @m_workid WHILE (@@FETCH_STATUS = 0) BEGIN DELETE WorkPlanShareDetail WHERE workid = @m_workid AND sharelevel = 0 FETCH NEXT FROM all_cursor INTO @m_workid END CLOSE all_cursor DEALLOCATE all_cursor

GO
alter procedure [CRM_Share_WorkPlan] ( @crmId_1 varchar(4000), @flag integer output , @msg varchar(4000) output) AS DECLARE @m_workid int DECLARE @m_userid int DECLARE @m_usertype int  DECLARE @t_sharetype int DECLARE @t_seclevel int DECLARE @t_rolelevel int DECLARE @t_userid int DECLARE @t_departmentid int DECLARE @t_roleid int DECLARE @t_foralluser char(1)  DECLARE all_cursor CURSOR FOR SELECT id FROM WorkPlan WHERE type_n = '3' AND (','+crmid+',') LIKE ('%,'+@crmId_1+',%') OPEN all_cursor FETCH NEXT FROM all_cursor INTO @m_workid WHILE (@@FETCH_STATUS = 0) BEGIN DECLARE m_cursor CURSOR FOR SELECT sharetype,seclevel,rolelevel,userid,departmentid,roleid,foralluser FROM CRM_ShareInfo WHERE relateditemid = @crmId_1 OPEN m_cursor FETCH NEXT FROM m_cursor INTO @t_sharetype, @t_seclevel, @t_rolelevel, @t_userid, @t_departmentid, @t_roleid, @t_foralluser WHILE (@@FETCH_STATUS = 0) BEGIN IF NOT EXISTS (SELECT workPlanId FROM WorkPlanShare WHERE workPlanId = @m_workid AND shareType = @t_sharetype AND userId = @t_userid AND deptId = @t_departmentid AND roleId = @t_roleid AND forAll = @t_foralluser AND roleLevel = @t_rolelevel AND securityLevel = @t_seclevel AND shareLevel=0 AND isdefault=1) INSERT INTO WorkPlanShare (workPlanId,shareType,userId,deptId,roleId,forAll,roleLevel,securityLevel,shareLevel,isdefault) VALUES (@m_workid,@t_sharetype,@t_userid,@t_departmentid,@t_roleid,@t_foralluser,@t_rolelevel,@t_seclevel,0,1) FETCH NEXT FROM m_cursor INTO @t_sharetype, @t_seclevel, @t_rolelevel, @t_userid, @t_departmentid, @t_roleid, @t_foralluser END CLOSE m_cursor DEALLOCATE m_cursor FETCH NEXT FROM all_cursor INTO @m_workid END CLOSE all_cursor DEALLOCATE all_cursor

GO
alter procedure [CRM_ContactLog_WorkPlan] ( @flag integer output , @msg varchar(4000) output) AS DECLARE @m_logid int DECLARE @m_customerid int DECLARE @m_resourceid int DECLARE @m_subject varchar(4000) DECLARE @m_contactdate char(10) DECLARE @m_contacttime char(8) DECLARE @m_enddate char(10) DECLARE @m_endtime char(10) DECLARE @m_contactinfo varchar(4000) DECLARE @m_documentid int DECLARE @m_submitdate char(10) DECLARE @m_submittime char(8) DECLARE @m_isfinished tinyint DECLARE @m_isprocessed tinyint DECLARE @m_agentid int DECLARE @m_status char(1) DECLARE @m_workid int DECLARE @m_userid int DECLARE @m_usertype int DECLARE @m_deptId int DECLARE @m_subcoId int  DECLARE all_cursor CURSOR FOR SELECT id, customerid, resourceid, subject, contactdate, contacttime, enddate, endtime, contactinfo, documentid, submitdate, submittime, isfinished, isprocessed, agentid FROM CRM_ContactLog OPEN all_cursor FETCH NEXT FROM all_cursor INTO @m_logid, @m_customerid, @m_resourceid, @m_subject, @m_contactdate, @m_contacttime, @m_enddate, @m_endtime, @m_contactinfo, @m_documentid, @m_submitdate, @m_submittime, @m_isfinished, @m_isprocessed, @m_agentid WHILE (@@FETCH_STATUS = 0) BEGIN IF (@m_subject <> 'Create') BEGIN  IF (@m_isfinished = 0) SET @m_status = '0' ELSE IF (@m_isprocessed = 0) SET @m_status = '1' ELSE SET @m_status = '2'  INSERT INTO WorkPlan ( type_n, urgentLevel, crmid, resourceid, name, begindate, begintime, enddate, endtime, description, docid, createdate, createtime, agentId, status, createrid) VALUES ('3', '1', @m_customerid, @m_resourceid, @m_subject, @m_contactdate, @m_contacttime, @m_enddate, @m_endtime, @m_contactinfo, @m_documentid, @m_submitdate, @m_submittime, @m_agentid, @m_status, @m_resourceid) SELECT @m_workid = MAX(id) FROM WorkPlan  IF EXISTS(SELECT id FROM CRM_SellChance WHERE comefromid = @m_logid) UPDATE CRM_SellChance SET comefromid = @m_workid WHERE comefromid = @m_logid  SELECT @m_deptId = departmentid, @m_subcoId = subcompanyid1 FROM HrmResource WHERE id = @m_resourceid UPDATE WorkPlan SET deptId = @m_deptId, subcompanyId = @m_subcoId where id = @m_workid  INSERT INTO WorkPlanShare (workPlanId,shareType,userId,deptId,roleId,forAll,roleLevel,securityLevel,shareLevel,isdefault) SELECT @m_workid,sharetype,seclevel,rolelevel,userid,departmentid,roleid,foralluser,0,1 FROM CRM_ShareInfo WHERE relateditemid = @m_customerid END  FETCH NEXT FROM all_cursor INTO @m_logid, @m_customerid, @m_resourceid, @m_subject, @m_contactdate, @m_contacttime, @m_enddate, @m_endtime, @m_contactinfo, @m_documentid, @m_submitdate, @m_submittime, @m_isfinished, @m_isprocessed, @m_agentid END CLOSE all_cursor DEALLOCATE all_cursor

 GO
alter procedure [WorkPlanViewLog_Insert] ( @workPlanId_1 int, @viewType_1 char(1), @userId_1 int, @userType_1 char(1), @ipAddress_1 char(15), @logDate_1 char(10), @logTime_1 char(8), @flag integer output , @msg varchar(4000) output) AS INSERT INTO WorkPlanViewLog ( workPlanId, viewType, userId, userType, ipAddress, logDate, logTime) VALUES ( @workPlanId_1, @viewType_1, @userId_1, @userType_1, @ipAddress_1, @logDate_1, @logTime_1)
GO
