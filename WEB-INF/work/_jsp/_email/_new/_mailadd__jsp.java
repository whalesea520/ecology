/*
 * JSP generated by Resin-3.1.8 (built Mon, 17 Nov 2008 12:15:21 PST)
 */

package _jsp._email._new;
import javax.servlet.*;
import javax.servlet.jsp.*;
import javax.servlet.http.*;
import com.alibaba.fastjson.JSONObject;
import com.alibaba.fastjson.JSONArray;
import weaver.email.po.Mailconfigureinfo;
import weaver.email.MailReciveStatusUtils;
import weaver.hrm.resource.ResourceUtil;
import weaver.email.domain.MailContact;
import weaver.email.domain.MailGroup;
import weaver.email.service.MailManagerService;
import weaver.general.Util;
import weaver.email.service.MailSystemSettingService;
import weaver.hrm.resource.ResourceComInfo;
import weaver.conn.RecordSet;
import java.util.*;
import java.net.*;
import weaver.hrm.*;
import weaver.systeminfo.*;
import weaver.general.*;
import ln.LN;
import weaver.hrm.settings.ChgPasswdReminder;
import weaver.hrm.settings.HrmSettingsComInfo;
import weaver.hrm.settings.RemindSettings;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import weaver.workflow.workflow.TestWorkflowCheck;
import weaver.systeminfo.template.UserTemplate;
import weaver.systeminfo.setting.*;
import weaver.login.LicenseCheckLogin;
import weaver.hrm.online.IPUtil;
import java.util.Map;

public class _mailadd__jsp extends com.caucho.jsp.JavaPage
{
  private static final java.util.HashMap<String,java.lang.reflect.Method> _jsp_functionMap = new java.util.HashMap<String,java.lang.reflect.Method>();
  private boolean _caucho_isDead;

  
  private String getCurrWuiConfig(HttpSession session, User user, String keyword) throws Exception {
  	
  	if (keyword == null || "".equals(keyword)) {
  		return "";
  	}
  	
  	String curTheme = "";
  	String curskin = "";
  
  	
  		String[] rtnValue = getHrmUserSetting(user);
  		
  		curTheme = rtnValue[0];
  		curskin = rtnValue[1];
  		if(curTheme.equals("")||curskin.equals("")){
  			String templatetype = getCurrE8TemplateType(user);
  			if("".equals(templatetype)){
  				curTheme = "ecologyBasic";
  				curskin = "default";
  			}else if("ecology7".equals(templatetype)){
  				curTheme ="ecology7";
  				curskin = getCurrE8SkinInfo(user);
  			}else{
  				curTheme ="ecology8";
  				curskin = "default";
  			}
  			
  			
  			
  			
  		}else{
  			curTheme = rtnValue[0];
  			curskin = rtnValue[1];
  		}
  		
  		if(curTheme.equals("custom")){
  			curTheme ="ecology8";
  		}
  		
  		session.setAttribute("SESSION_CURRENT_THEME", curTheme);
  		session.setAttribute("SESSION_CURRENT_SKIN", curskin);
  	
  	if ("THEME".equals(keyword.toUpperCase())) {
  		return curTheme;
  	}
  	
  	if ("SKIN".equals(keyword.toUpperCase())) {
  		return curskin;
  	}
  	return "";
  }
  
  
  
  private String getCurrSkinFolder(User user) throws Exception {
  	String pslSkinfolder = "";
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  
  	int userid = user.getUID();
  
  	rs.executeSql("select skin from HrmUserSetting where resourceId=" + userid);
  	
  	if (rs.next()) {
  		pslSkinfolder = rs.getString("skin");
  	}
  
  	if (pslSkinfolder == null || "".equals(pslSkinfolder)) {
  	    pslSkinfolder = "default";
  	}
  	return pslSkinfolder;
  }
  
  private String getCurrE8TemplateType(User user){
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  	weaver.systeminfo.template.UserTemplate  userTemplate = new weaver.systeminfo.template.UserTemplate();
  	userTemplate.getTemplateByUID(user.getUID(),user.getUserSubCompany1());
  	
  	
  	String skin =  userTemplate.getTemplatetype();
  	
  	
  	return skin;
  	
  }
  
  private String getCurrE8SkinInfo(User user){
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  	weaver.systeminfo.template.UserTemplate  userTemplate = new weaver.systeminfo.template.UserTemplate();
  	userTemplate.getTemplateByUID(user.getUID(),user.getUserSubCompany1());
  	
  	
  	String skin =  userTemplate.getSkin();
  	
  	
  	return skin;
  	
  }
  
  private int getCurrTemplateId(User user){
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  	weaver.systeminfo.template.UserTemplate  userTemplate = new weaver.systeminfo.template.UserTemplate();
  	userTemplate.getTemplateByUID(user.getUID(),user.getUserSubCompany1());
  	
  	
  	int id =  userTemplate.getTemplateId();
  	
  	
  	return id;
  	
  }
  
  private String getCurrTemplateLogo(User user){
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  	weaver.systeminfo.template.UserTemplate  userTemplate = new weaver.systeminfo.template.UserTemplate();
  	userTemplate.getTemplateByUID(user.getUID(),user.getUserSubCompany1());
  	
  	
  	String logo =  userTemplate.getLogo();
  	
  	
  	return logo;
  	
  }
  
  private String[] getHrmUserSetting(User user) throws Exception {
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  
  	String[] result = new String[2];
  	String theme = "";
  	String skin = "";
  	
  	String sql="select templateid from SystemTemplateSubComp where subcompanyid="+user.getUserSubCompany1();
  	rs.executeSql(sql);
  	if(rs.next()){	
  	
  		String curUserCanUse = rs.getString("templateid");
  		sql = "SELECT a.* FROM HrmUserSetting a, SystemTemplate  b WHERE a.resourceId="+user.getUID()+" AND a.templateId=b.id  and  b.id="+curUserCanUse;
  		rs.execute(sql);
  		if(rs.next()){
  			theme = rs.getString("theme");
  			skin = rs.getString("skin");
  			if("ecology8".equals(theme)){
  				skin = "default";
  			}
  			result[0] = theme;
  			result[1] = skin;
  			return result;
  		}
  	}
  	
  	
  
  	
  	int userid = user.getUID();
  	rs.executeSql("select theme, skin from HrmUserSetting where resourceId=" + userid);
  	
  	if (rs.next()) {
  		theme = rs.getString("theme");
  		skin = rs.getString("skin");
  	}
  	
  	//rs.executeSql("select * from extandHpThemeItem where extandHpThemeId=" + sqltemplateid1 + " and isopen=1 and theme='" + theme + "' and skin='" + skin + "'");
  	result[0] = theme;
  	result[1] = skin;
  	
  	
  	
  	//System.out.println("result"+result[0]+result[1]);
  	return result;
  }
  
  
  private java.util.Map getPageConfigInfo(HttpSession session, User user) throws Exception{
  	
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  	java.util.Map pageConfigkv = new java.util.HashMap();
  	
  	weaver.systeminfo.template.UserTemplate  userTemplate = new weaver.systeminfo.template.UserTemplate();
  	userTemplate.getTemplateByUID(user.getUID(),user.getUserSubCompany1());
  	
  	pageConfigkv.put("logoTop",userTemplate.getLogo());
  	pageConfigkv.put("logoBottom", userTemplate.getLogo());
  	pageConfigkv.put("isopen", userTemplate.getIsopen());
  	//pageConfigkv.put("islock", rs.getString("islock"));
  	
  	int extendtempletvalueid = userTemplate.getExtendtempletvalueid();
  	rs.executeSql("select * from extandHpThemeItem where extandHpThemeId=" + extendtempletvalueid + " and isopen=1 and theme='" + getCurrWuiConfig(session, user, "THEME") + "' and skin='" + getCurrWuiConfig(session, user, "SKIN") + "'");
  	
  	if (rs.next()) {
  	
  		
  		/**
  		 * ecologybasic\u4e3b\u9898\u7528\u8bbe\u7f6e\u9879
  		 */
  		pageConfigkv.put("bodyBg", rs.getString("bodyBg"));
  		pageConfigkv.put("topBgImage", rs.getString("topBgImage"));
  		pageConfigkv.put("toolbarBgColor", rs.getString("toolbarBgColor"));
  		pageConfigkv.put("menuborderColor", rs.getString("menuborderColor"));
  
  		pageConfigkv.put("leftbarBgImage", rs.getString("leftbarBgImage"));
  		pageConfigkv.put("leftbarBgImageH", rs.getString("leftbarBgImageH"));
  
  		pageConfigkv.put("leftbarborderColor", rs.getString("leftbarborderColor"));
  		pageConfigkv.put("leftbarFontColor", rs.getString("leftbarFontColor"));
  
  		pageConfigkv.put("topleftbarBgImage_left", rs.getString("topleftbarBgImage_left"));
  		pageConfigkv.put("topleftbarBgImage_center", rs.getString("topleftbarBgImage_center"));
  		pageConfigkv.put("topleftbarBgImage_right", rs.getString("topleftbarBgImage_right"));
  
  		pageConfigkv.put("bottomleftbarBgImage_left", rs.getString("bottomleftbarBgImage_left"));
  		pageConfigkv.put("bottomleftbarBgImage_center", rs.getString("bottomleftbarBgImage_center"));
  		pageConfigkv.put("bottomleftbarBgImage_right", rs.getString("bottomleftbarBgImage_right"));
  
  	}
  	
  	return pageConfigkv;
  	
  }


  
      public String getDefaultSendFrom(MailManagerService mms,String accountMail){
          if(mms.getTagvalues().indexOf(accountMail.toLowerCase())>-1){
              return accountMail;
          }
          if(mms.getSendcc().toLowerCase().indexOf(accountMail.toLowerCase())>-1){
              return accountMail;
          }
          if(mms.getSendbcc().toLowerCase().indexOf(accountMail.toLowerCase())>-1){
              return accountMail;
          }
          return "";
      }

  
  public void
  _jspService(javax.servlet.http.HttpServletRequest request,
              javax.servlet.http.HttpServletResponse response)
    throws java.io.IOException, javax.servlet.ServletException
  {
    javax.servlet.http.HttpSession session = request.getSession(true);
    com.caucho.server.webapp.WebApp _jsp_application = _caucho_getApplication();
    javax.servlet.ServletContext application = _jsp_application;
    com.caucho.jsp.PageContextImpl pageContext = _jsp_application.getJspApplicationContext().allocatePageContext(this, _jsp_application, request, response, null, session, 8192, true, false);
    javax.servlet.jsp.PageContext _jsp_parentContext = pageContext;
    javax.servlet.jsp.JspWriter out = pageContext.getOut();
    final javax.el.ELContext _jsp_env = pageContext.getELContext();
    javax.servlet.ServletConfig config = getServletConfig();
    javax.servlet.Servlet page = this;
    response.setContentType("text/html; charset=UTF-8");
    request.setCharacterEncoding("UTF-8");
    try {
      out.write(_jsp_string0, 0, _jsp_string0.length);
      
	try{
		response.setBufferSize(1*1024*1024);
	}catch(Exception e){}

      out.write(_jsp_string1, 0, _jsp_string1.length);
      
// \u589e\u52a0\u53c2\u6570\u5224\u65ad\u7f13\u5b58
int isIncludeToptitle = 0;
response.setHeader("cache-control", "no-cache");
response.setHeader("pragma", "no-cache");
response.setHeader("expires", "Mon 1 Jan 1990 00:00:00 GMT");

      out.write(_jsp_string2, 0, _jsp_string2.length);
      
//
User user = HrmUserVarify.getUser (request , response) ;
LicenseCheckLogin licenseCheckLogin = new LicenseCheckLogin();
licenseCheckLogin.setOutLineDate(user.getUID(),IPUtil.getIp(request));

//\u95ee\u98981
TestWorkflowCheck twc=new TestWorkflowCheck();
if(twc.checkURI(session,request.getRequestURI(),request.getQueryString())){
    /*
    response.sendRedirect("/login/Logout.jsp");
    */
    String forwardurl = twc.reLoginMrg(request, response, request.getRequestURI());
    if (!"".equals(forwardurl)) { 
        response.sendRedirect(forwardurl);
        return;
    }
}
String userOffline = Util.null2String((String)session.getAttribute("userOffline"));	
if(userOffline.equals("1")){
	//\u5f3a\u5236\u4e0b\u7ebf
	String loginfile = Util.getCookie(request , "loginfileweaver") ;
	Map userSessions = (Map) application.getAttribute("userSessions");
	if (userSessions != null) {
		Map logmessages = (Map) application.getAttribute("logmessages");
		if (logmessages != null)logmessages.remove("" + user.getUID());
		session.removeValue("moniter");
		session.removeValue("WeaverMailSet");
		userSessions.remove(user.getUID());
		//session.invalidate();
	}
      out.write(_jsp_string3, 0, _jsp_string3.length);
      out.print((SystemEnv.getErrorMsgName(175,user.getLanguage())));
      out.write(_jsp_string4, 0, _jsp_string4.length);
      out.print(("/Refresh.jsp?loginfile="+loginfile+"&message=175"));
      out.write(_jsp_string5, 0, _jsp_string5.length);
      
  return;
}
if(user == null)  return ;
String isIE = (String)session.getAttribute("browser_isie");
if (isIE == null || "".equals(isIE)) {
	isIE = "true";
	session.setAttribute("browser_isie", "true");
}
String agentT = request.getHeader("user-agent");
//if(!"true".equals(isIE)){
//if((agentT.contains("Firefox")||agentT.contains(" Chrome")||agentT.contains("Safari") )&& !agentT.contains("Edge")){
if(agentT.contains("Firefox")||agentT.contains(" Chrome")||agentT.contains("Safari") || agentT.contains("Edge")){	
    isIE = "false";	
}
else{
    isIE = "true";	
}
//}

Log logger= LogFactory.getLog(this.getClass());



//************************************************
//\u8d85\u65f6\u6216\u8005\u91cd\u542fresin\u670d\u52a1\u65f6\uff0c\u5f39\u51fa\u767b\u9646\u5c0f\u7a97\u53e3(TD 2227)
//hubo,050707

//************************************************

String pagepath = request.getServletPath();
if(pagepath.indexOf("HrmResourceOperation.jsp")<0&&pagepath.indexOf("RemindLogin.jsp")<0&&pagepath.indexOf("HrmResourcePassword.jsp")<0){
	String changepwd = (String)request.getSession().getAttribute("changepwd");
	if("n".equals(changepwd)){
		request.getSession().removeAttribute("changepwd");
		response.sendRedirect("/login/Login.jsp");
		return;
	}else if("y".equals(changepwd)){
		request.getSession().removeAttribute("changepwd");
	}
}



//licence\u4fe1\u606f
String companyNametools="";
LN Licenseinit_1 = new LN();
try{
	Licenseinit_1.CkHrmnum();
}catch(Exception e){
	e.printStackTrace();
	out.println("<script type='text/javascript'> top.location.href='/system/InLicense.jsp?message=6&code=';</script>");
	return;
}
companyNametools = Licenseinit_1.getCompanyname();

//\u7248\u672c\u4fe1\u606f
StaticObj staticobj = null;
staticobj = StaticObj.getInstance();
String software = (String)staticobj.getObject("software") ;
if(software == null) software="ALL";
String portal = (String)staticobj.getObject("portal") ;
if(portal == null) portal="n";
boolean isPortalOK = false;
if(portal.equals("y")) isPortalOK = true;
String multilanguage = (String)staticobj.getObject("multilanguage") ;
if(multilanguage == null) multilanguage="n";
boolean isMultilanguageOK = false;
if(multilanguage.equals("y")) isMultilanguageOK = true;


      out.write(_jsp_string2, 0, _jsp_string2.length);
      
  String fromlogin=(String)session.getAttribute("fromlogin");
  session.removeAttribute("fromlogin");
  if(fromlogin==null) fromlogin="no";

  ChgPasswdReminder reminder0 = new ChgPasswdReminder();
  RemindSettings settings0=reminder0.getRemindSettings();
  String firmcode0=settings0.getFirmcode();
  String usercode0=settings0.getUsercode();

  int needusb0=user.getNeedusb();
  String usbtype0 = settings0.getUsbType();
  String serial0=user.getSerial();

//\u9650\u5236\u6bcf\u4e2a\u7528\u6237\u53ea\u80fd\u6709\u4e00\u4e2a\u767b\u5165\u7684\u7a97\u53e3
String frommain = Util.null2String(request.getParameter("frommain")) ;

Map logmessages=(Map)application.getAttribute("logmessages");
String a_logmessage="";
if(logmessages!=null)
	a_logmessage=Util.null2String((String)logmessages.get(""+user.getUID()));

String s_logmessage=Util.null2String((String)session.getAttribute("logmessage"));


//TD2125 by mackjoe \u89e3\u51b3\u6570\u636e\u4e2d\u5fc3\u767b\u9646\u4e0d\u4e86\u95ee\u9898
if(s_logmessage==null)  s_logmessage="";

String relogin0=Util.null2String(settings0.getRelogin());

String changepwd = (String)session.getAttribute("changepwd");

if(!relogin0.equals("1")&&"yes".equals(changepwd)){
logmessages=(Map)application.getAttribute("logmessages");
logmessages.put(""+user.getUID(),s_logmessage);
if(logmessages!=null)
	a_logmessage=Util.null2String((String)logmessages.get(""+user.getUID()));
}

String layoutStyle = (String)request.getSession(true).getAttribute("layoutStyle");
if(layoutStyle==null) layoutStyle ="";

String rtxFromLogintmp = (String)session.getAttribute("RtxFromLogin");


if("1".equals(user.getLogintype())&&!relogin0.equals("1")&&!fromlogin.equals("yes")&&!frommain.equals("yes")&&!s_logmessage.equals(a_logmessage) && !"true".equals(rtxFromLogintmp)){
	if(layoutStyle.equals("") || !layoutStyle.equals("1")){	//\u5982\u679c\u662f\u5c0f\u7a97\u53e3\u767b\u5f55\uff0c\u5219\u4e0d\u5224\u65ad\u662f\u5426\u4e3a\u5f53\u524d\u5de5\u4f5c\u7a97\u53e3


      out.write(_jsp_string6, 0, _jsp_string6.length);
      out.print((SystemEnv.getHtmlLabelName(23274,user.getLanguage())));
      out.write(_jsp_string7, 0, _jsp_string7.length);
      return;}}
      out.write(_jsp_string2, 0, _jsp_string2.length);
      
//\u6d41\u7a0b\u7684\u4e09\u4e2a\u9875\u9762\u9700\u8981\u4f7f\u7528\u9ad8\u7248\u672c\u7684jQuery
if (request.getRequestURI().indexOf("/workflow/request/") != -1 &&
        (request.getRequestURI().indexOf("/workflow/request/ManageRequestNoForm") != -1 
                || request.getRequestURI().indexOf("/workflow/request/ViewRequestIframe.jsp") != -1
                || request.getRequestURI().indexOf("/workflow/request/RemarkFrame.jsp") != -1)) {

      out.write(_jsp_string8, 0, _jsp_string8.length);
      
} else {

      out.write(_jsp_string9, 0, _jsp_string9.length);
      
}

      out.write(_jsp_string10, 0, _jsp_string10.length);
      
//\u6a21\u677f\u6a21\u5f0f\u5bfc\u5165
if ((request.getRequestURI().indexOf("/workflow/") != -1 && request.getRequestURI().indexOf("mode") != -1)
        || request.getRequestURI().indexOf("/workflow/request/AddRequest") != -1) {
        
      out.write(_jsp_string11, 0, _jsp_string11.length);
      
}

      out.write(_jsp_string12, 0, _jsp_string12.length);
      out.print((user.getLanguage()));
      out.write(_jsp_string13, 0, _jsp_string13.length);
      out.print((request.getSession().getId()));
      out.write(_jsp_string14, 0, _jsp_string14.length);
      out.print((SystemEnv.getHtmlLabelName(21403,user.getLanguage())));
      out.write(_jsp_string15, 0, _jsp_string15.length);
      out.print((SystemEnv.getHtmlLabelName(21791,user.getLanguage())));
      out.write(_jsp_string16, 0, _jsp_string16.length);
      out.print((SystemEnv.getHtmlLabelNames("17480",user.getLanguage())));
      out.write(_jsp_string17, 0, _jsp_string17.length);
      out.print((SystemEnv.getHtmlLabelNames("25484,83",user.getLanguage())));
      out.write(_jsp_string18, 0, _jsp_string18.length);
      out.print((user.getUID()));
      out.write(_jsp_string19, 0, _jsp_string19.length);
      out.print((user.getUID()));
      out.write(_jsp_string20, 0, _jsp_string20.length);
      out.print((user.getType()));
      out.write(_jsp_string21, 0, _jsp_string21.length);
      out.print((SystemEnv.getHtmlLabelName(26263,user.getLanguage())));
      out.write(_jsp_string22, 0, _jsp_string22.length);
      out.print((URLEncoder.encode(user.getLoginid())));
      out.write(_jsp_string23, 0, _jsp_string23.length);
      out.print((SystemEnv.getHtmlLabelName(21403,user.getLanguage())));
      out.write(_jsp_string24, 0, _jsp_string24.length);
      out.print((SystemEnv.getHtmlLabelName(23670,user.getLanguage())));
      out.write(_jsp_string25, 0, _jsp_string25.length);
      out.print((SystemEnv.getHtmlLabelName(21791,user.getLanguage())));
      out.write(_jsp_string26, 0, _jsp_string26.length);
      if(new weaver.conn.RecordSet().getDBType().equals("oracle")){
      out.write(_jsp_string27, 0, _jsp_string27.length);
      out.print((SystemEnv.getHtmlLabelName(524,user.getLanguage())));
      out.print((SystemEnv.getHtmlLabelName(698,user.getLanguage())));
      out.write(_jsp_string28, 0, _jsp_string28.length);
      out.print((SystemEnv.getHtmlLabelName(20246,user.getLanguage())));
      out.write(_jsp_string28, 0, _jsp_string28.length);
      out.print((SystemEnv.getHtmlLabelName(124962,user.getLanguage())));
      out.write(_jsp_string29, 0, _jsp_string29.length);
      }
      out.write(_jsp_string30, 0, _jsp_string30.length);
      out.print((SystemEnv.getHtmlLabelName(21423,user.getLanguage())));
      out.write(_jsp_string31, 0, _jsp_string31.length);
      out.print((SystemEnv.getHtmlLabelName(21423,user.getLanguage())));
      out.write(_jsp_string32, 0, _jsp_string32.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string33, 0, _jsp_string33.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string34, 0, _jsp_string34.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string33, 0, _jsp_string33.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string35, 0, _jsp_string35.length);
      out.print((SystemEnv.getHtmlLabelName(21423,user.getLanguage())));
      out.write(_jsp_string36, 0, _jsp_string36.length);
      out.print((SystemEnv.getHtmlLabelName(21423,user.getLanguage())));
      out.write(_jsp_string37, 0, _jsp_string37.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string38, 0, _jsp_string38.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string39, 0, _jsp_string39.length);
      out.print((SystemEnv.getHtmlLabelName(15097,user.getLanguage())));
      out.write(_jsp_string40, 0, _jsp_string40.length);
      out.print((SystemEnv.getHtmlLabelName(22161,user.getLanguage())));
      out.write(_jsp_string41, 0, _jsp_string41.length);
      out.print((companyNametools));
      out.write(_jsp_string42, 0, _jsp_string42.length);
      out.print((SystemEnv.getHtmlLabelName(23714,user.getLanguage())));
      out.write(_jsp_string43, 0, _jsp_string43.length);
      
  if(!fromlogin.equals("yes")&&needusb0==1&&"1".equals(usbtype0)){

      out.write(_jsp_string44, 0, _jsp_string44.length);
      out.print((firmcode0));
      out.write(_jsp_string45, 0, _jsp_string45.length);
      out.print((usercode0));
      out.write(_jsp_string46, 0, _jsp_string46.length);
      out.print((serial0));
      out.write(_jsp_string47, 0, _jsp_string47.length);
      out.print((user.getLanguage()));
      out.write(_jsp_string48, 0, _jsp_string48.length);
      }
      out.write(_jsp_string49, 0, _jsp_string49.length);
      weaver.workflow.workflow.TestWorkflowCheck TestWorkflowCheckInitWui;
      TestWorkflowCheckInitWui = (weaver.workflow.workflow.TestWorkflowCheck) pageContext.getAttribute("TestWorkflowCheckInitWui");
      if (TestWorkflowCheckInitWui == null) {
        TestWorkflowCheckInitWui = new weaver.workflow.workflow.TestWorkflowCheck();
        pageContext.setAttribute("TestWorkflowCheckInitWui", TestWorkflowCheckInitWui);
      }
      out.write(_jsp_string50, 0, _jsp_string50.length);
      out.println(TestWorkflowCheckInitWui.ReloadByDialogClose(request));
      out.write(_jsp_string51, 0, _jsp_string51.length);
      
    if(TestWorkflowCheckInitWui.checkURI(session,request.getRequestURI(),request.getQueryString())){
        response.sendRedirect("/login/Login.jsp");
        return;
    }

      out.write(_jsp_string52, 0, _jsp_string52.length);
      

String curTheme = "ecology7";
//\u5f53\u524d\u76ae\u80a4
String curskin = "";
String cutoverWay = "";
String transitionTime = "";
String transitionWay = "";

HrmUserSettingComInfo instance = new HrmUserSettingComInfo();

String huscifId = String.valueOf(instance.getId(String.valueOf(user.getUID())));

curTheme = getCurrWuiConfig(session, user, "theme");
curskin = getCurrWuiConfig(session, user, "skin");

cutoverWay = instance.getCutoverWay(huscifId);
transitionTime = instance.getTransitionTime(huscifId);
transitionWay = instance.getTransitionWays(huscifId);

      out.write(_jsp_string53, 0, _jsp_string53.length);
      
String ely6flg = "";
if ("ecology6".equals(curTheme.toLowerCase())) {
	curTheme = "ecology7";
	ely6flg = "ecology6";
}

      out.write(_jsp_string54, 0, _jsp_string54.length);
      out.print((curTheme ));
      out.write(_jsp_string55, 0, _jsp_string55.length);
      out.print((curskin ));
      out.write(_jsp_string56, 0, _jsp_string56.length);
      
curTheme = "ecology8";//\u540e\u53f0\u914d\u7f6e\u9875\u9762\u5747\u4e3aE8\u4e3b\u9898\uff0c\u5982\u4f7f\u7528\u5176\u4ed6\u4e3b\u9898\u65f6\uff0c\u4f1a\u5bfc\u81f4\u6837\u5f0f\u6df7\u4e71\u3002\u6240\u4ee5\u6b64\u5904\u4e3b\u9898\u5f3a\u5236\u8d4b\u503cecology8
if("ecology8".equals(curTheme)) curskin="default";
session.setAttribute("SESSION_TEMP_CURRENT_THEME", curTheme);
session.setAttribute("SESSION_TEMP_CURRENT_SKIN", curskin);

      out.write(_jsp_string57, 0, _jsp_string57.length);
      
if (transitionTime != null && !transitionTime.equals("") && !transitionTime.equals("0")) {

      out.write(_jsp_string58, 0, _jsp_string58.length);
      out.print((cutoverWay ));
      out.write(_jsp_string59, 0, _jsp_string59.length);
      out.print((transitionTime ));
      out.write(_jsp_string60, 0, _jsp_string60.length);
      out.print((transitionWay ));
      out.write(_jsp_string61, 0, _jsp_string61.length);
      
}

      out.write(_jsp_string62, 0, _jsp_string62.length);
      out.print((curTheme ));
      out.write(_jsp_string63, 0, _jsp_string63.length);
      out.print((curskin ));
      out.write(_jsp_string64, 0, _jsp_string64.length);
      if(!"1".equals(session.getAttribute("istest"))){//\u6d41\u7a0b\u6d4b\u8bd5
      out.write(_jsp_string53, 0, _jsp_string53.length);
      pageContext.include("/synergy/showSynergy.jsp", "requestid=" + com.caucho.el.Expr.toString(Util.getIntValue(request.getParameter("requestid"),-1), null), false);
      out.write(_jsp_string53, 0, _jsp_string53.length);
      }
      out.write(_jsp_string65, 0, _jsp_string65.length);
      weaver.email.service.MailTemplateUserService mtus;
      mtus = (weaver.email.service.MailTemplateUserService) pageContext.getAttribute("mtus");
      if (mtus == null) {
        mtus = new weaver.email.service.MailTemplateUserService();
        pageContext.setAttribute("mtus", mtus);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.email.service.MailTemplateService mts;
      mts = (weaver.email.service.MailTemplateService) pageContext.getAttribute("mts");
      if (mts == null) {
        mts = new weaver.email.service.MailTemplateService();
        pageContext.setAttribute("mts", mts);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.email.service.MailManagerService mms;
      mms = (weaver.email.service.MailManagerService) pageContext.getAttribute("mms");
      if (mms == null) {
        mms = new weaver.email.service.MailManagerService();
        pageContext.setAttribute("mms", mms);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.email.service.MailAccountService mas;
      mas = (weaver.email.service.MailAccountService) pageContext.getAttribute("mas");
      if (mas == null) {
        mas = new weaver.email.service.MailAccountService();
        pageContext.setAttribute("mas", mas);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.email.service.ContactManagerService cms;
      cms = (weaver.email.service.ContactManagerService) pageContext.getAttribute("cms");
      if (cms == null) {
        cms = new weaver.email.service.ContactManagerService();
        pageContext.setAttribute("cms", cms);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.email.service.GroupManagerService gms;
      gms = (weaver.email.service.GroupManagerService) pageContext.getAttribute("gms");
      if (gms == null) {
        gms = new weaver.email.service.GroupManagerService();
        pageContext.setAttribute("gms", gms);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.email.service.MailSignService mss;
      mss = (weaver.email.service.MailSignService) pageContext.getAttribute("mss");
      if (mss == null) {
        mss = new weaver.email.service.MailSignService();
        pageContext.setAttribute("mss", mss);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.splitepage.transform.SptmForMail SptmForMail;
      SptmForMail = (weaver.splitepage.transform.SptmForMail) pageContext.getAttribute("SptmForMail");
      if (SptmForMail == null) {
        SptmForMail = new weaver.splitepage.transform.SptmForMail();
        pageContext.setAttribute("SptmForMail", SptmForMail);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.email.service.MailSettingService msst;
      msst = (weaver.email.service.MailSettingService) pageContext.getAttribute("msst");
      if (msst == null) {
        msst = new weaver.email.service.MailSettingService();
        pageContext.setAttribute("msst", msst);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.conn.RecordSet rs;
      rs = (weaver.conn.RecordSet) pageContext.getAttribute("rs");
      if (rs == null) {
        rs = new weaver.conn.RecordSet();
        pageContext.setAttribute("rs", rs);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.conn.RecordSet rst;
      rst = (weaver.conn.RecordSet) pageContext.getAttribute("rst");
      if (rst == null) {
        rst = new weaver.conn.RecordSet();
        pageContext.setAttribute("rst", rst);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.email.WeavermailUtil weavermailUtil;
      weavermailUtil = (weaver.email.WeavermailUtil) pageContext.getAttribute("weavermailUtil");
      if (weavermailUtil == null) {
        weavermailUtil = new weaver.email.WeavermailUtil();
        pageContext.setAttribute("weavermailUtil", weavermailUtil);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.hrm.resource.ResourceComInfo ResourceComInfo;
      ResourceComInfo = (weaver.hrm.resource.ResourceComInfo) pageContext.getAttribute("ResourceComInfo");
      if (ResourceComInfo == null) {
        ResourceComInfo = new weaver.hrm.resource.ResourceComInfo();
        pageContext.setAttribute("ResourceComInfo", ResourceComInfo);
      }
      out.write(_jsp_string66, 0, _jsp_string66.length);
      out.print((user.getLanguage()));
      out.write(_jsp_string67, 0, _jsp_string67.length);
      
    //\u5224\u65ad\u6d4f\u89c8\u5668\u662f\u5426\u652f\u6301select\u7f8e\u5316\uff0cIE8\u53ca\u4ee5\u4e0b\u4e0d\u884c
    boolean isNiceSelect = true;
    if("true".equals(isIE)) {
        String agent = Util.null2String(request.getHeader("user-agent"));
        StringTokenizer st = new StringTokenizer(agent,";"); 
        try{
            st.nextToken();
            //\u5f97\u5230\u7528\u6237\u7684\u6d4f\u89c8\u5668\u540d 
            String userbrowser = st.nextToken();
            String versinString = userbrowser.substring(userbrowser.indexOf("MSIE")+4,userbrowser.indexOf(".")).trim();
            int browserVersion = Integer.parseInt(versinString);
            if(browserVersion <= 8) {
                isNiceSelect = false;
            }
        }catch(Exception e){
        }
    }

      out.write(_jsp_string2, 0, _jsp_string2.length);
      
    float space = 1;
    rst.execute("select totalSpace , occupySpace from HrmResource where id = "+user.getUID());
    if(rst.next()){
        space =  rst.getFloat("totalSpace") - rst.getFloat("occupySpace");
    }
    
    int mailid = Util.getIntValue(request.getParameter("mailId")); // \u8001\u90ae\u4ef6\u6a21\u5757\u90ae\u4ef6ID\u53c2\u6570
    String fileid = Util.null2String(request.getParameter("fileid"));//\u53d1\u9001\u9009\u4e2d\u9644\u4ef6
    String fileAccStr = weavermailUtil.getAccInfo(fileid,user);
    if(mailid==-1){
        mailid = Util.getIntValue(request.getParameter("id"));
    }
    
    String to = Util.null2String(request.getParameter("to"));
    int flag = Util.getIntValue(request.getParameter("flag"));
    
    int isInternal =0;
    if(Util.null2String(request.getParameter("isInternal")).equals("")){
        msst.selectMailSetting(user.getUID());
        isInternal = "0".equals(msst.getDefaulttype())?1:0;
    }else{
        isInternal = Util.getIntValue(request.getParameter("isInternal"),0);
    }
    
    String internalto = Util.null2String(request.getParameter("internalto"));
    String internaltodpids = Util.null2String(request.getParameter("internaltodpids"));
    String internalcc = "";
    String internalbcc = "";
    
    //int mailfilesize = MailSystemSettingService.getMailFileSizeSetting(); // \u9644\u4ef6\u5927\u5c0f\u9650\u5236
    
    mtus.selectDefaultMailTemplate(user.getUID());
    
    //\u9ed8\u8ba4\u6a21\u7248\u4fe1\u606f
    int templateType = mtus.getTemplatetype();//0:\u4e2a\u4eba\u6a21\u677f 1:\u516c\u53f8\u6a21\u677f
    int defaultTemplateId = mtus.getTemplateid();
    
    //System.out.println("flag=" + flag);
    //System.out.println("templateType=" + templateType);
    //System.out.println("defaultTemplateId=" + defaultTemplateId);
    /**
        flag\u72b6\u6001\uff1a
            -1\uff1a\u65b0\u5efa\u90ae\u4ef6 
             1\uff1a\u56de\u590d
             2\uff1a\u56de\u590d\u5168\u90e8
             3\uff1a\u8f6c\u53d1
             4\uff1a\u8349\u7a3f
             5\uff1a\u518d\u6b21\u7f16\u8f91
    */
    
    String subject="";
    String sendfrom ="";
    String sendto = "";
    String sendcc = "";
    String sendbcc = "";
    String toall="";
    String toids="";
    String todpids="";
    String ccall = "";
    String ccids="";
    String bccids="";
    String ccdpids="";
    String bccall="";
    String bccdpids="";
    String mailContent="";
    String defaultSign="";
    String mailaccountid="";
    String priority="";
    String accStr="";
    String accids ="";
    String needReceipt ="";//\u662f\u5426\u9700\u8981\u56de\u6267
    String timingdate =""; //\u5b9a\u65f6\u53d1\u9001\u65e5\u671f
    defaultSign = mms.getDefaultSign(user.getUID(), user); //\u53d1\u9001\u90ae\u4ef6\u65f6\u6dfb\u52a0\u7684\u9ed8\u8ba4\u7b7e\u540d
    if(flag!=-1){
        if(flag ==1){ //\u56de\u590d
            mms.getReplayMailInfo(mailid+"",user);
        }else if(flag==2){ // \u56de\u590d\u5168\u90e8
            mms.getReplayAllMailInfo(mailid+"",user);
        }else if(flag==3){ // \u8f6c\u53d1
            mms.getForwardMailInfo(mailid+"",user);
        }else if(flag==4 || flag == 5){//\u8349\u7a3f\u7bb1\uff0c\u6216\u8005\u518d\u6b21\u7f16\u8f91
            mms.getDraftMailInfo(mailid+"",user);
        }
        
        subject = mms.getSubject();
        isInternal = mms.getIsInternal();
        if(isInternal==1){
        
            if(flag ==1){
                //\u56de\u590d\u7684\u65f6\u5019\uff0c\u6536\u4ef6\u4eba\u4e3a\u90ae\u4ef6\u7684\u53d1\u8d77\u4eba
                 toall="";
                 todpids="";
                 toids=mms.getToids();
                 internalto=mms.getToids();
                 
            } else if(flag ==2) {
                //\u56de\u590d\u5168\u90e8
                 toall=mms.getToall();
                 todpids=mms.getTodpids();
                 toids=mms.getToids();
                 internalto=mms.getToids();
                ccall =mms.getCcall();
                ccdpids = mms.getCcdpids();
                ccids=mms.getCcids();
                internalcc =mms.getCcids();
                
            }else if(flag ==3){
                 toall="";
                 todpids="";
                 toids="";
                 internalto="";
            }
            else  if(flag==4 || flag == 5){
                toall=mms.getToall();
                todpids=mms.getTodpids();
                toids=mms.getToids();
                internalto=mms.getToids();
                //\u8349\u7a3f\u7684\u65f6\u5019
                ccall =mms.getCcall();
                ccdpids = mms.getCcdpids();
                ccids=mms.getCcids();
                internalcc =mms.getCcids();

                bccall =mms.getBccall();
                bccdpids =mms.getBccdpids();
                bccids=mms.getBccids();
                internalbcc =mms.getBccids();
                
            }
            sendfrom = mms.getSendfrom();
            
        }else{
            sendfrom = mms.getSendfrom();
            sendto = mms.getSendto();
            sendcc = mms.getSendcc();
            sendbcc = mms.getSendbcc();
        }
        
        mailContent = mms.getContent();
        mailContent = Util.replace(mailContent, "==br==", "\n", 0);
        priority = mms.getPriority();
        
        needReceipt=mms.getNeedReceipt();
        timingdate=mms.getTimingdate();
        
        accStr = mms.getAccStr();
        accids = mms.getAccids();
    }else{
        mas.clear();
        mas.setIsDefault("1");
        mas.setUserid(user.getUID()+"");
        mas.selectMailAccount();
        
        if(mas.next()){
            sendfrom = mas.getAccountMailAddress();
            mailaccountid = mas.getAccountid();
        }
        if(!to.equals("")){
            sendto = to;
        }
         toids=internalto;
         internalto=internalto;
         todpids=internaltodpids;
    }
    
    Mailconfigureinfo mailconfigureinfo = MailReciveStatusUtils.getMailconfigureinfoFromCache();
    int innerMail = mailconfigureinfo.getInnerMail();
    int outterMail = mailconfigureinfo.getOutterMail();
    int totalAttachmentSize = mailconfigureinfo.getTotalAttachmentSize();
    int perAttachmentSize = mailconfigureinfo.getPerAttachmentSize();
    int attachmentCount = mailconfigureinfo.getAttachmentCount();
    int isAll = mailconfigureinfo.getIsAll();
    
    if(innerMail ==1 && outterMail ==0 ){//\u53ea\u5f00\u542f\u4e86\u5185\u90e8\u90ae\u4ef6
        isInternal = 1;
    }
    if(innerMail ==0 && outterMail ==1 ){//\u53ea\u5f00\u542f\u4e86\u5916\u90e8\u90ae\u4ef6
        isInternal =0;
    }
    
    if(flag==1 || flag==2 || flag==3 || flag==-1) {
        //System.out.println("-----------defaultSign=" + defaultSign);
        mailContent = defaultSign + mailContent;
    }
    
    if(flag == 5){
        mailid = -1;//\u518d\u6b21\u7f16\u8f91\uff0c\u4ea7\u751f\u65b0\u90ae\u4ef6\uff0c\u91cd\u7f6emailid\u503c
        accids  = "";
        accStr = "";
        fileAccStr= mms.getAccStr();
        fileid = mms.getAccids();
    }
    
    session.setAttribute("mailcontent", mailContent);

      out.write(_jsp_string53, 0, _jsp_string53.length);
      
String date = "";
String time = "";
if(!"".equals(timingdate)){
    date = timingdate.substring(0, 10);
    time = timingdate.substring(11, 16);
}

String fontsize = "";
RecordSet rss = new RecordSet();
rss.executeSql("SELECT fontsize FROM MailSetting WHERE userId="+user.getUID()+"");
if(rss.next()) {
    fontsize = rss.getString("fontsize");
}
if(fontsize==null || "".equals(fontsize))fontsize = "12px";


      out.write(_jsp_string68, 0, _jsp_string68.length);
      out.print((accids));
      out.write(_jsp_string69, 0, _jsp_string69.length);
      out.print((","+fileid+","));
      out.write(_jsp_string70, 0, _jsp_string70.length);
      out.print((flag ));
      out.write(_jsp_string71, 0, _jsp_string71.length);
      out.print((timingdate));
      out.write(_jsp_string72, 0, _jsp_string72.length);
      out.print((mailid ));
      out.write(_jsp_string73, 0, _jsp_string73.length);
      
if(flag==4){
    
      out.write(_jsp_string74, 0, _jsp_string74.length);
      out.print((mailid ));
      out.write(_jsp_string75, 0, _jsp_string75.length);
      
}else{
      out.write(_jsp_string76, 0, _jsp_string76.length);
      }

      out.write(_jsp_string77, 0, _jsp_string77.length);
      out.print((SystemEnv.getHtmlLabelName(19809, user.getLanguage())));
      out.write(_jsp_string78, 0, _jsp_string78.length);
      out.print((SystemEnv.getHtmlLabelName(81320, user.getLanguage())));
      out.write(_jsp_string79, 0, _jsp_string79.length);
      out.print((SystemEnv.getHtmlLabelName(19810, user.getLanguage())));
      out.write(_jsp_string80, 0, _jsp_string80.length);
      out.print((SystemEnv.getHtmlLabelName(81321, user.getLanguage())));
      out.write(_jsp_string81, 0, _jsp_string81.length);
      out.print((SystemEnv.getHtmlLabelName(2034, user.getLanguage())));
      out.write(_jsp_string82, 0, _jsp_string82.length);
      if(1==innerMail && 1 == outterMail){ 
      out.write(_jsp_string83, 0, _jsp_string83.length);
      } 
      out.write(_jsp_string84, 0, _jsp_string84.length);
      if(1==innerMail && 1 == outterMail){ 
      out.write(_jsp_string85, 0, _jsp_string85.length);
      if(isInternal==1){ out.print("selected");}else{out.print("");} 
      out.write(_jsp_string86, 0, _jsp_string86.length);
      out.print((SystemEnv.getHtmlLabelName(24714, user.getLanguage())));
      out.write(_jsp_string87, 0, _jsp_string87.length);
      if(isInternal!=1){ out.print("selected");}else{out.print("");} 
      out.write(_jsp_string86, 0, _jsp_string86.length);
      out.print((SystemEnv.getHtmlLabelName(31139, user.getLanguage())));
      out.write(_jsp_string88, 0, _jsp_string88.length);
      }
      out.write(_jsp_string89, 0, _jsp_string89.length);
      if(isInternal==1){ out.print("checked='checked'");} 
      out.write(_jsp_string90, 0, _jsp_string90.length);
      if(1==innerMail && 1 == outterMail){ 
      out.write(_jsp_string91, 0, _jsp_string91.length);
      } 
      out.write(_jsp_string92, 0, _jsp_string92.length);
      
                                    mas.clear();
                                    mas.setUserid(user.getUID()+"");
                                    mas.selectMailAccount();
                                    if(mas.getCount() > 0){
                                    
      out.write(_jsp_string93, 0, _jsp_string93.length);
       if(!isNiceSelect) { 
      out.write(_jsp_string94, 0, _jsp_string94.length);
       } 
      out.write(_jsp_string95, 0, _jsp_string95.length);
      
                                                if(null == sendfrom || "".equals(sendfrom)||flag ==3){
                                                    while(mas.next()){
                                                    if(mas.getIsDefault().equals("1")){
                                                        
      out.write(_jsp_string96, 0, _jsp_string96.length);
      out.print((mas.getId()));
      out.write(_jsp_string97, 0, _jsp_string97.length);
      out.print((mas.getAccountname() ));
      out.write(_jsp_string98, 0, _jsp_string98.length);
      
                                                        }else{
                                                        
                                                            
      out.write(_jsp_string96, 0, _jsp_string96.length);
      out.print((mas.getId()));
      out.write(_jsp_string99, 0, _jsp_string99.length);
      out.print((mas.getAccountname() ));
      out.write(_jsp_string98, 0, _jsp_string98.length);
      
                                                        }
                                                    }
                                                }else{
                                                    if(flag == 1 || flag == 2) {
                                                        RecordSet rss1 = new RecordSet();
                                                        rss1.executeSql("SELECT sendto FROM mailresource WHERE id="+mailid+"");
                                                        String sendtomail = "";
                                                        if(rss1.next())sendtomail = rss1.getString("sendto");
                                                        while(mas.next()){
                                                            String sendtoMailStr="";
                                                            if(sendtomail!=null&&sendtomail.indexOf(mas.getAccountMailAddress())!=-1){
                                                                
      out.write(_jsp_string100, 0, _jsp_string100.length);
      out.print((mas.getId()));
      out.write(_jsp_string97, 0, _jsp_string97.length);
      out.print((mas.getAccountname() ));
      out.write(_jsp_string101, 0, _jsp_string101.length);
      
                                                            }else{
                                                            
                                                                
      out.write(_jsp_string100, 0, _jsp_string100.length);
      out.print((mas.getId()));
      out.write(_jsp_string99, 0, _jsp_string99.length);
      out.print((mas.getAccountname() ));
      out.write(_jsp_string101, 0, _jsp_string101.length);
      
                                                            }
                                                        
                                                        }
                                                    }else {
                                                        while(mas.next()){
                                                            if(mas.getAccountMailAddress().equals(sendfrom)){
                                                                
      out.write(_jsp_string100, 0, _jsp_string100.length);
      out.print((mas.getId()));
      out.write(_jsp_string97, 0, _jsp_string97.length);
      out.print((mas.getAccountname() ));
      out.write(_jsp_string101, 0, _jsp_string101.length);
      
                                                            }else{
                                                                
      out.write(_jsp_string100, 0, _jsp_string100.length);
      out.print((mas.getId()));
      out.write(_jsp_string99, 0, _jsp_string99.length);
      out.print((mas.getAccountname() ));
      out.write(_jsp_string101, 0, _jsp_string101.length);
      
                                                            }   
                                                        }
                                                    }
                                                
                                                }
                                             
      out.write(_jsp_string102, 0, _jsp_string102.length);
      } 
      out.write(_jsp_string103, 0, _jsp_string103.length);
      if(1==innerMail && 1 == outterMail){ 
      out.write(_jsp_string91, 0, _jsp_string91.length);
      } 
      out.write(_jsp_string104, 0, _jsp_string104.length);
      
                                            String[] resourceids=Util.TokenizerString2(Util.null2String(mms.getAllResourceids(""+user.getUID())),","); 
                                            if(resourceids.length>1){
                                        
      out.write(_jsp_string105, 0, _jsp_string105.length);
      for(int i=0;i<resourceids.length;i++){
      out.write(_jsp_string106, 0, _jsp_string106.length);
      out.print((resourceids[i]));
      out.write(_jsp_string107, 0, _jsp_string107.length);
      out.print((resourceids[i].equals(sendfrom)?"selected":""));
      out.write('>');
      out.print((ResourceComInfo.getLastname(resourceids[i])));
      out.write(_jsp_string108, 0, _jsp_string108.length);
      }
      out.write(_jsp_string109, 0, _jsp_string109.length);
      }else{
      out.write(_jsp_string110, 0, _jsp_string110.length);
      out.print((ResourceComInfo.getLastname(resourceids[0])));
      out.write(_jsp_string111, 0, _jsp_string111.length);
      out.print((resourceids[0]));
      out.write(_jsp_string112, 0, _jsp_string112.length);
      } 
      out.write(_jsp_string113, 0, _jsp_string113.length);
      if(isInternal!=1){ out.print("class='hide'"); } 
      out.write(_jsp_string114, 0, _jsp_string114.length);
      out.print((SystemEnv.getHtmlLabelName(2046, user.getLanguage())));
      out.write(_jsp_string115, 0, _jsp_string115.length);
      out.print((sendto));
      out.write(_jsp_string116, 0, _jsp_string116.length);
      
                                        
                                        String hrmSpan = SptmForMail.getHrmShowNameHref(internalto);
                                        ResourceUtil ru = new ResourceUtil();
                                        String hrmName= ru.getHrmShowName(internalto);
                                        String hrmdpids = ru.getHrmShowDepartmentID(internalto);
                                        String hrmdpname = ru.getHrmDepartmentName(todpids);
                    
                                        //\u6536\u4ef6\u4eba
                                        if(isInternal==1){
                                             hrmName= ru.getHrmShowName(toids);
                                             //hrmdpids = ru.getHrmShowDepartmentID(internalto);
                                             hrmdpname = ru.getHrmDepartmentName(todpids);
                                        }
                                        
      out.write(_jsp_string117, 0, _jsp_string117.length);
      out.print((internalto));
      out.write(_jsp_string118, 0, _jsp_string118.length);
      out.print((SystemEnv.getHtmlLabelName(2046, user.getLanguage())));
      out.write(_jsp_string119, 0, _jsp_string119.length);
      out.print((todpids));
      out.write(_jsp_string120, 0, _jsp_string120.length);
      out.print((toall));
      out.write(_jsp_string121, 0, _jsp_string121.length);
      out.print((hrmName));
      out.write(_jsp_string122, 0, _jsp_string122.length);
      out.print((hrmdpids));
      out.write(_jsp_string123, 0, _jsp_string123.length);
      out.print((hrmdpname));
      out.write(_jsp_string124, 0, _jsp_string124.length);
      out.print((SystemEnv.getHtmlLabelName(31184, user.getLanguage())));
      out.write(_jsp_string99, 0, _jsp_string99.length);
      out.print((SystemEnv.getHtmlLabelName(31184, user.getLanguage())));
      out.write(_jsp_string125, 0, _jsp_string125.length);
      out.print((SystemEnv.getHtmlLabelName(127204, user.getLanguage())));
      out.write(_jsp_string99, 0, _jsp_string99.length);
      out.print((SystemEnv.getHtmlLabelName(127204, user.getLanguage())));
      out.write(_jsp_string126, 0, _jsp_string126.length);
      out.print((SystemEnv.getHtmlLabelName(17051, user.getLanguage())));
      out.write(_jsp_string127, 0, _jsp_string127.length);
      out.print((sendto));
      out.write(_jsp_string116, 0, _jsp_string116.length);
      
                                        
                                        hrmSpan = SptmForMail.getHrmShowNameHref(internalcc);
                                        
                                        hrmName= ru.getHrmShowName(internalcc);
                                        hrmdpids = ru.getHrmShowDepartmentID(internalcc);
                                        hrmdpname = ru.getHrmDepartmentName(ccdpids);
                                        //\u6284\u9001\u4eba
                                        if(isInternal==1){
                                             hrmName= ru.getHrmShowName(ccids);
                                            // hrmdpids = ru.getHrmShowDepartmentID(internalto);
                                             hrmdpname = ru.getHrmDepartmentName(ccdpids);
                                        }
                                        
      out.write(_jsp_string128, 0, _jsp_string128.length);
      out.print((internalcc));
      out.write(_jsp_string129, 0, _jsp_string129.length);
      out.print((ccdpids));
      out.write(_jsp_string130, 0, _jsp_string130.length);
      out.print((ccall));
      out.write(_jsp_string131, 0, _jsp_string131.length);
      out.print((hrmName));
      out.write(_jsp_string132, 0, _jsp_string132.length);
      out.print((hrmdpids));
      out.write(_jsp_string133, 0, _jsp_string133.length);
      out.print((hrmdpname));
      out.write(_jsp_string134, 0, _jsp_string134.length);
      out.print((SystemEnv.getHtmlLabelName(81316, user.getLanguage())));
      out.write(_jsp_string135, 0, _jsp_string135.length);
      out.print((sendto));
      out.write(_jsp_string116, 0, _jsp_string116.length);
      
                                        
                                        hrmSpan = SptmForMail.getHrmShowNameHref(internalbcc);
                                        
                                        hrmName= ru.getHrmShowName(internalbcc);
                                        hrmdpids = ru.getHrmShowDepartmentID(internalbcc);
                                        hrmdpname = ru.getHrmDepartmentName(bccdpids);
                                            //\u6284\u9001\u4eba
                                        if(isInternal==1){
                                             hrmName= ru.getHrmShowName(bccids);
                                            // hrmdpids = ru.getHrmShowDepartmentID(internalto);
                                             hrmdpname = ru.getHrmDepartmentName(bccdpids);
                                        }
                                        
      out.write(_jsp_string136, 0, _jsp_string136.length);
      out.print((internalbcc));
      out.write(_jsp_string137, 0, _jsp_string137.length);
      out.print((bccdpids));
      out.write(_jsp_string138, 0, _jsp_string138.length);
      out.print((bccall));
      out.write(_jsp_string139, 0, _jsp_string139.length);
      out.print((hrmName));
      out.write(_jsp_string140, 0, _jsp_string140.length);
      out.print((hrmdpids));
      out.write(_jsp_string141, 0, _jsp_string141.length);
      out.print((hrmdpname));
      out.write(_jsp_string142, 0, _jsp_string142.length);
      if(isInternal==1){ out.print("class='hide'"); } 
      out.write(_jsp_string143, 0, _jsp_string143.length);
      out.print((SystemEnv.getHtmlLabelName(2046, user.getLanguage())));
      out.write(_jsp_string144, 0, _jsp_string144.length);
      
                                        String[] sendtoMails=sendto.split(",");
                                        String sendtoMailStr="";
                                        for(int i=0;i<sendtoMails.length;i++){
                                            if(sendtoMails[i].equals("") || sendtoMails[i].indexOf("@") == -1)  {
                                                continue; 
                                            }
                                            sendtoMailStr+=","+weavermailUtil.getEmailRealName(sendtoMails[i],user.getUID()+"",false)+"<"+sendtoMails[i]+">"; 
                                        }
                                        sendtoMailStr=sendtoMailStr.length()>0?sendtoMailStr.substring(1):sendtoMailStr;
                                        
      out.write(_jsp_string145, 0, _jsp_string145.length);
      out.print((sendtoMailStr));
      out.write(_jsp_string118, 0, _jsp_string118.length);
      out.print((SystemEnv.getHtmlLabelName(2046, user.getLanguage())));
      out.write(_jsp_string146, 0, _jsp_string146.length);
      out.print((SystemEnv.getHtmlLabelName(129761, user.getLanguage())));
      out.write(_jsp_string99, 0, _jsp_string99.length);
      out.print((SystemEnv.getHtmlLabelName(129761, user.getLanguage())));
      out.write(_jsp_string147, 0, _jsp_string147.length);
      out.print((SystemEnv.getHtmlLabelName(127204, user.getLanguage())));
      out.write(_jsp_string99, 0, _jsp_string99.length);
      out.print((SystemEnv.getHtmlLabelName(127204, user.getLanguage())));
      out.write(_jsp_string148, 0, _jsp_string148.length);
      out.print((SystemEnv.getHtmlLabelName(17051, user.getLanguage())));
      out.write(_jsp_string149, 0, _jsp_string149.length);
      
                                        String[] sendccMails=sendcc.split(",");
                                        String sendccMailStr="";
                                        for(int i=0;i<sendccMails.length;i++){
                                            if(sendccMails[i].equals("") || sendccMails[i].indexOf("@") == -1)  {
                                                continue; 
                                            }
                                        sendccMailStr+=","+weavermailUtil.getEmailRealName(sendccMails[i],user.getUID()+"",false)+"<"+sendccMails[i]+">"; 
                                        }
                                        sendccMailStr=sendccMailStr.length()>0?sendccMailStr.substring(1):sendccMailStr;
                                    
      out.write(_jsp_string150, 0, _jsp_string150.length);
      out.print((sendccMailStr));
      out.write(_jsp_string151, 0, _jsp_string151.length);
      out.print((SystemEnv.getHtmlLabelName(81316, user.getLanguage())));
      out.write(_jsp_string152, 0, _jsp_string152.length);
      out.print((sendbcc));
      out.write(_jsp_string153, 0, _jsp_string153.length);
      out.print((SystemEnv.getHtmlLabelName(344, user.getLanguage())));
      out.write(_jsp_string154, 0, _jsp_string154.length);
      out.print((subject ));
      out.write(_jsp_string118, 0, _jsp_string118.length);
      out.print((SystemEnv.getHtmlLabelName(344, user.getLanguage())));
      out.write(_jsp_string155, 0, _jsp_string155.length);
      if(subject.equals("")) out.print("<img src='/images/BacoError_wev8.gif' align=\"absMiddle\">"); 
      out.write(_jsp_string156, 0, _jsp_string156.length);
      out.print((SystemEnv.getHtmlLabelName(19812, user.getLanguage())));
      out.write(_jsp_string157, 0, _jsp_string157.length);
      out.print((accStr ));
      out.write(_jsp_string158, 0, _jsp_string158.length);
      out.print((fileAccStr ));
      out.write(_jsp_string159, 0, _jsp_string159.length);
      out.print((SystemEnv.getHtmlLabelName(83091, user.getLanguage())));
      out.write(_jsp_string160, 0, _jsp_string160.length);
      out.print((SystemEnv.getHtmlLabelName(91, user.getLanguage())));
      out.write(_jsp_string161, 0, _jsp_string161.length);
      out.print((SystemEnv.getHtmlLabelName(2083, user.getLanguage())));
      out.write(_jsp_string162, 0, _jsp_string162.length);
      out.print((SystemEnv.getHtmlLabelName(220, user.getLanguage())));
      out.write(_jsp_string163, 0, _jsp_string163.length);
      if("1".equals(mms.getPriority())){ 
      out.write(_jsp_string164, 0, _jsp_string164.length);
       }else {
      out.write(_jsp_string165, 0, _jsp_string165.length);
      } 
      out.write(_jsp_string166, 0, _jsp_string166.length);
      out.print((SystemEnv.getHtmlLabelName(2087, user.getLanguage())));
      out.write(_jsp_string167, 0, _jsp_string167.length);
      out.print((SystemEnv.getHtmlLabelName(2092, user.getLanguage())));
      out.write(_jsp_string168, 0, _jsp_string168.length);
      out.print((SystemEnv.getHtmlLabelName(19111, user.getLanguage())));
      out.write(_jsp_string169, 0, _jsp_string169.length);
      out.print((SystemEnv.getHtmlLabelName(25233, user.getLanguage())));
      out.write(_jsp_string170, 0, _jsp_string170.length);
      out.print((SystemEnv.getHtmlLabelName(32028, user.getLanguage())));
      out.write(_jsp_string171, 0, _jsp_string171.length);
      out.print((date));
      out.write(_jsp_string172, 0, _jsp_string172.length);
      out.print((date));
      out.write(_jsp_string173, 0, _jsp_string173.length);
      out.print((time));
      out.write(_jsp_string174, 0, _jsp_string174.length);
      out.print((time));
      out.write(_jsp_string175, 0, _jsp_string175.length);
      out.print((SystemEnv.getHtmlLabelName(572, user.getLanguage())));
      out.write(_jsp_string176, 0, _jsp_string176.length);
      out.print((SystemEnv.getHtmlLabelName(81554, user.getLanguage())));
      out.write(_jsp_string177, 0, _jsp_string177.length);
      out.print((SystemEnv.getHtmlLabelName(83092, user.getLanguage())));
      out.write(_jsp_string178, 0, _jsp_string178.length);
      out.print((SystemEnv.getHtmlLabelName(83093, user.getLanguage())));
      out.write(_jsp_string179, 0, _jsp_string179.length);
      out.print((SystemEnv.getHtmlLabelName(19956,user.getLanguage()) ));
      out.write(_jsp_string180, 0, _jsp_string180.length);
      out.print((SystemEnv.getHtmlLabelName(179,user.getLanguage())));
      out.write(_jsp_string181, 0, _jsp_string181.length);
      out.print((SystemEnv.getHtmlLabelName(179,user.getLanguage())));
      out.write(_jsp_string182, 0, _jsp_string182.length);
      out.print((SystemEnv.getHtmlLabelName(17129,user.getLanguage())));
      out.write(_jsp_string181, 0, _jsp_string181.length);
      out.print((SystemEnv.getHtmlLabelName(17129,user.getLanguage())));
      out.write(_jsp_string183, 0, _jsp_string183.length);
      out.print((SystemEnv.getHtmlLabelName(1867,user.getLanguage())));
      out.write(_jsp_string181, 0, _jsp_string181.length);
      out.print((SystemEnv.getHtmlLabelName(1867,user.getLanguage())));
      out.write(_jsp_string184, 0, _jsp_string184.length);
      out.print((SystemEnv.getHtmlLabelName(124,user.getLanguage())));
      out.write(_jsp_string181, 0, _jsp_string181.length);
      out.print((SystemEnv.getHtmlLabelName(124,user.getLanguage())));
      out.write(_jsp_string185, 0, _jsp_string185.length);
      if(isAll == 1) {
      out.write(_jsp_string186, 0, _jsp_string186.length);
      out.print((SystemEnv.getHtmlLabelName(1340,user.getLanguage())));
      out.write(_jsp_string187, 0, _jsp_string187.length);
      out.print((SystemEnv.getHtmlLabelName(1340,user.getLanguage())));
      out.write(_jsp_string188, 0, _jsp_string188.length);
       }
      out.write(_jsp_string189, 0, _jsp_string189.length);
      out.print((SystemEnv.getHtmlLabelName(19826,user.getLanguage()) ));
      out.write(_jsp_string190, 0, _jsp_string190.length);
      out.print((SystemEnv.getHtmlLabelName(431,user.getLanguage()) ));
      out.write(_jsp_string191, 0, _jsp_string191.length);
      if(isIE.equals("true")){
      out.write(_jsp_string192, 0, _jsp_string192.length);
      }else{
      out.write(_jsp_string193, 0, _jsp_string193.length);
      }
      out.write(_jsp_string194, 0, _jsp_string194.length);
      out.print((SystemEnv.getHtmlLabelName(31199, user.getLanguage())));
      out.write(_jsp_string195, 0, _jsp_string195.length);
      out.print((SystemEnv.getHtmlLabelName(1340, user.getLanguage())));
      out.write(_jsp_string196, 0, _jsp_string196.length);
      out.print((SystemEnv.getHtmlLabelName(179,user.getLanguage())));
      out.write(_jsp_string197, 0, _jsp_string197.length);
      out.print((SystemEnv.getHtmlLabelName(17129,user.getLanguage())));
      out.write(_jsp_string198, 0, _jsp_string198.length);
      out.print((SystemEnv.getHtmlLabelName(18214,user.getLanguage())));
      out.write(_jsp_string199, 0, _jsp_string199.length);
      out.print((SystemEnv.getHtmlLabelName(18214,user.getLanguage())));
      out.write(_jsp_string200, 0, _jsp_string200.length);
      out.print((SystemEnv.getHtmlLabelName(1340,user.getLanguage())));
      out.write(_jsp_string201, 0, _jsp_string201.length);
      out.print((SystemEnv.getHtmlLabelName(1340,user.getLanguage())));
      out.write(_jsp_string202, 0, _jsp_string202.length);
      out.print((SystemEnv.getHtmlLabelName(31185,user.getLanguage()) ));
      out.write(_jsp_string203, 0, _jsp_string203.length);
      out.print((SystemEnv.getHtmlLabelName(125940,user.getLanguage()) ));
      out.write(_jsp_string204, 0, _jsp_string204.length);
      out.print((SystemEnv.getHtmlLabelName(125940,user.getLanguage()) ));
      out.write(_jsp_string205, 0, _jsp_string205.length);
      out.print((isIE));
      out.write(_jsp_string206, 0, _jsp_string206.length);
      out.print((SystemEnv.getHtmlLabelName(22306,user.getLanguage()) ));
      out.write(_jsp_string207, 0, _jsp_string207.length);
      out.print((SystemEnv.getHtmlLabelNames("127204", user.getLanguage())));
      out.write(_jsp_string208, 0, _jsp_string208.length);
      out.print((SystemEnv.getHtmlLabelName(31184,user.getLanguage()) ));
      out.write(_jsp_string209, 0, _jsp_string209.length);
      out.print((isInternal));
      out.write(_jsp_string210, 0, _jsp_string210.length);
      out.print((ccall));
      out.write(_jsp_string211, 0, _jsp_string211.length);
      out.print((ccdpids));
      out.write(_jsp_string212, 0, _jsp_string212.length);
      out.print((internalcc));
      out.write(_jsp_string213, 0, _jsp_string213.length);
      out.print((bccall));
      out.write(_jsp_string214, 0, _jsp_string214.length);
      out.print((bccdpids));
      out.write(_jsp_string215, 0, _jsp_string215.length);
      out.print((internalbcc));
      out.write(_jsp_string216, 0, _jsp_string216.length);
      out.print((sendcc));
      out.write(_jsp_string217, 0, _jsp_string217.length);
      out.print((sendbcc));
      out.write(_jsp_string218, 0, _jsp_string218.length);
      out.print((SystemEnv.getHtmlLabelName(83094,user.getLanguage())));
      out.write(_jsp_string219, 0, _jsp_string219.length);
      out.print((SystemEnv.getHtmlLabelName(83094,user.getLanguage())));
      out.write(_jsp_string220, 0, _jsp_string220.length);
      out.print((SystemEnv.getHtmlLabelName(125940,user.getLanguage()) ));
      out.write(_jsp_string221, 0, _jsp_string221.length);
      out.print((SystemEnv.getHtmlLabelName(20148,user.getLanguage()) ));
      out.write(_jsp_string222, 0, _jsp_string222.length);
      
            List<Map<String, String>> signList = new ArrayList<Map<String, String>>();
            mss.selectMailSignByUser(user.getUID());
            while(mss.next()) {
                Map<String, String> map = new HashMap<String, String>();
                map.put("id", mss.getId());
                map.put("descName", Util.getMoreStr(mss.getSignName(),7,"..."));
                map.put("name", mss.getSignName());
                map.put("desc", mss.getSignDesc());
                map.put("signContent", mss.getSignContent("", user));
                signList.add(map);
            }
        
      out.write(_jsp_string223, 0, _jsp_string223.length);
      out.print((JSONArray.toJSONString(signList) ));
      out.write(_jsp_string224, 0, _jsp_string224.length);
      out.print((SystemEnv.getHtmlLabelName(64,user.getLanguage()) ));
      out.write(_jsp_string225, 0, _jsp_string225.length);
      out.print((SystemEnv.getHtmlLabelName(129750, user.getLanguage())));
      out.write(_jsp_string226, 0, _jsp_string226.length);
      out.print((SystemEnv.getHtmlLabelNames("93,16218",user.getLanguage())));
      out.write(_jsp_string227, 0, _jsp_string227.length);
      out.print((SystemEnv.getHtmlLabelName(22243,user.getLanguage()) ));
      out.write(_jsp_string228, 0, _jsp_string228.length);
      out.print((SystemEnv.getHtmlLabelName(101,user.getLanguage()) ));
      out.write(_jsp_string229, 0, _jsp_string229.length);
      out.print((SystemEnv.getHtmlLabelName(2211,user.getLanguage()) ));
      out.write(_jsp_string230, 0, _jsp_string230.length);
      out.print((SystemEnv.getHtmlLabelName(22244,user.getLanguage()) ));
      out.write(_jsp_string231, 0, _jsp_string231.length);
      out.print((SystemEnv.getHtmlLabelName(136,user.getLanguage()) ));
      out.write(_jsp_string232, 0, _jsp_string232.length);
      out.print((SystemEnv.getHtmlLabelName(1332,user.getLanguage()) ));
      out.write(_jsp_string233, 0, _jsp_string233.length);
      out.print((fontsize));
      out.write(_jsp_string234, 0, _jsp_string234.length);
      out.print((fontsize));
      out.write(_jsp_string235, 0, _jsp_string235.length);
      out.print((defaultTemplateId));
      out.write(_jsp_string236, 0, _jsp_string236.length);
      out.print((templateType));
      out.write(_jsp_string237, 0, _jsp_string237.length);
      out.print((isInternal ));
      out.write(_jsp_string238, 0, _jsp_string238.length);
      out.print((flag ));
      out.write(_jsp_string239, 0, _jsp_string239.length);
      out.print((SystemEnv.getHtmlLabelName(31242, user.getLanguage())));
      out.write(_jsp_string240, 0, _jsp_string240.length);
      out.print((SystemEnv.getHtmlLabelName(83095,user.getLanguage())));
      out.write(_jsp_string241, 0, _jsp_string241.length);
      out.print((SystemEnv.getHtmlLabelName(83096,user.getLanguage())));
      out.write(_jsp_string242, 0, _jsp_string242.length);
      out.print((SystemEnv.getHtmlLabelName(83095,user.getLanguage())));
      out.write(_jsp_string243, 0, _jsp_string243.length);
      out.print((SystemEnv.getHtmlLabelName(83096,user.getLanguage())));
      out.write(_jsp_string244, 0, _jsp_string244.length);
      out.print((SystemEnv.getHtmlLabelName(83095,user.getLanguage())));
      out.write(_jsp_string245, 0, _jsp_string245.length);
      out.print((SystemEnv.getHtmlLabelName(83096,user.getLanguage())));
      out.write(_jsp_string246, 0, _jsp_string246.length);
      out.print((perAttachmentSize*1024));
      out.write(_jsp_string247, 0, _jsp_string247.length);
      out.print((attachmentCount));
      out.write(_jsp_string248, 0, _jsp_string248.length);
      out.print((SystemEnv.getHtmlLabelName(124897, user.getLanguage())));
      out.write(_jsp_string249, 0, _jsp_string249.length);
      out.print((attachmentCount));
      out.write(_jsp_string250, 0, _jsp_string250.length);
      out.print((SystemEnv.getHtmlLabelName(83076,user.getLanguage()) ));
      out.print((attachmentCount));
      out.print((SystemEnv.getHtmlLabelName(83077,user.getLanguage()) ));
      out.write(_jsp_string251, 0, _jsp_string251.length);
      out.print((perAttachmentSize));
      out.write(_jsp_string252, 0, _jsp_string252.length);
      out.print((perAttachmentSize*1024*1024));
      out.write(_jsp_string250, 0, _jsp_string250.length);
      out.print((SystemEnv.getHtmlLabelName(24494,user.getLanguage()) ));
      out.print((perAttachmentSize));
      out.write(_jsp_string253, 0, _jsp_string253.length);
      out.print((user.getUID()));
      out.write(_jsp_string254, 0, _jsp_string254.length);
      out.print((space*1024));
      out.write(_jsp_string255, 0, _jsp_string255.length);
      out.print((space));
      out.write(_jsp_string256, 0, _jsp_string256.length);
      out.print((SystemEnv.getHtmlLabelName(83097,user.getLanguage()) ));
      out.write(_jsp_string257, 0, _jsp_string257.length);
      out.print((String.format("%.2f",(-1 * space))));
      out.write(_jsp_string258, 0, _jsp_string258.length);
      out.print((SystemEnv.getHtmlLabelName(83098,user.getLanguage()) ));
      out.write(_jsp_string259, 0, _jsp_string259.length);
      out.print((SystemEnv.getHtmlLabelName(83078,user.getLanguage()) ));
      out.write(_jsp_string260, 0, _jsp_string260.length);
      out.print((space*1024));
      out.write(_jsp_string261, 0, _jsp_string261.length);
      out.print((SystemEnv.getHtmlLabelName(83076,user.getLanguage()) ));
      out.print((attachmentCount));
      out.print((SystemEnv.getHtmlLabelName(83077,user.getLanguage()) ));
      out.write(_jsp_string262, 0, _jsp_string262.length);
      out.print((SystemEnv.getHtmlLabelName(24494,user.getLanguage()) ));
      out.print((perAttachmentSize));
      out.write(_jsp_string263, 0, _jsp_string263.length);
      out.print((SystemEnv.getHtmlLabelName(83072,user.getLanguage()) ));
      out.write(_jsp_string264, 0, _jsp_string264.length);
      out.print((SystemEnv.getHtmlLabelName(25389,user.getLanguage()) ));
      out.write(_jsp_string265, 0, _jsp_string265.length);
      out.print((SystemEnv.getHtmlLabelName(125955,user.getLanguage()) ));
      out.write(_jsp_string266, 0, _jsp_string266.length);
      out.print((SystemEnv.getHtmlLabelName(221,user.getLanguage()) ));
      out.write(_jsp_string267, 0, _jsp_string267.length);
      out.print((SystemEnv.getHtmlLabelNames("156,221",user.getLanguage()) ));
      out.write(_jsp_string268, 0, _jsp_string268.length);
      out.print(( ("".equals(subject) || subject == null) ? false : true));
      out.write(_jsp_string269, 0, _jsp_string269.length);
      out.print((flag));
      out.write(_jsp_string270, 0, _jsp_string270.length);
      out.print((SystemEnv.getHtmlLabelName(2046,user.getLanguage()) ));
      out.write(_jsp_string271, 0, _jsp_string271.length);
      out.print((SystemEnv.getHtmlLabelName(17051,user.getLanguage()) ));
      out.write(_jsp_string272, 0, _jsp_string272.length);
      out.print((SystemEnv.getHtmlLabelName(-81316,user.getLanguage()) ));
      out.write(_jsp_string273, 0, _jsp_string273.length);
      out.print((SystemEnv.getHtmlLabelName(2046,user.getLanguage()) ));
      out.write(_jsp_string274, 0, _jsp_string274.length);
      out.print((SystemEnv.getHtmlLabelName(17051,user.getLanguage()) ));
      out.write(_jsp_string275, 0, _jsp_string275.length);
      out.print((SystemEnv.getHtmlLabelName(-81316,user.getLanguage()) ));
      out.write(_jsp_string276, 0, _jsp_string276.length);
      out.print((SystemEnv.getHtmlLabelName(81851,user.getLanguage()) ));
      out.write(_jsp_string277, 0, _jsp_string277.length);
      out.print((fontsize));
      out.write(_jsp_string278, 0, _jsp_string278.length);
      out.print((space));
      out.write(_jsp_string279, 0, _jsp_string279.length);
      out.print((SystemEnv.getHtmlLabelName(83075,user.getLanguage()) ));
      out.write(_jsp_string280, 0, _jsp_string280.length);
      out.print((SystemEnv.getHtmlLabelName(83099,user.getLanguage()) ));
      out.write(_jsp_string281, 0, _jsp_string281.length);
      out.print((SystemEnv.getHtmlLabelName(18779,user.getLanguage()) ));
      out.write(_jsp_string282, 0, _jsp_string282.length);
      out.print((SystemEnv.getHtmlLabelName(19941, user.getLanguage())));
      out.write(_jsp_string283, 0, _jsp_string283.length);
      out.print((SystemEnv.getHtmlLabelName(31199, user.getLanguage())));
      out.write(_jsp_string284, 0, _jsp_string284.length);
      out.print((SystemEnv.getHtmlLabelName(18779,user.getLanguage()) ));
      out.write(_jsp_string285, 0, _jsp_string285.length);
      out.print((SystemEnv.getHtmlLabelName(18779,user.getLanguage()) ));
      out.write(_jsp_string286, 0, _jsp_string286.length);
      out.print((SystemEnv.getHtmlLabelName(18779,user.getLanguage())));
      out.write(_jsp_string287, 0, _jsp_string287.length);
      out.print((SystemEnv.getHtmlLabelName(27541,user.getLanguage())));
      out.write(_jsp_string288, 0, _jsp_string288.length);
      out.print((user.getUID()));
      out.write(_jsp_string289, 0, _jsp_string289.length);
      out.print((SystemEnv.getHtmlLabelName(19925, user.getLanguage())));
      out.write(_jsp_string290, 0, _jsp_string290.length);
      out.print((user.getUID()));
      out.write(_jsp_string291, 0, _jsp_string291.length);
      out.print((SystemEnv.getHtmlLabelName(19956,user.getLanguage()) ));
      out.write(_jsp_string292, 0, _jsp_string292.length);
      out.print((SystemEnv.getHtmlLabelName(17499, user.getLanguage())));
      out.write(_jsp_string293, 0, _jsp_string293.length);
      out.print((SystemEnv.getHtmlLabelName(31243,user.getLanguage())));
      out.write(_jsp_string294, 0, _jsp_string294.length);
      if(1 == isInternal){
      out.write(_jsp_string295, 0, _jsp_string295.length);
      }
      out.write(_jsp_string296, 0, _jsp_string296.length);
      out.print((SystemEnv.getHtmlLabelName(31243,user.getLanguage())));
      out.write(_jsp_string297, 0, _jsp_string297.length);
      out.print((SystemEnv.getHtmlLabelName(31237,user.getLanguage())));
      out.write(_jsp_string298, 0, _jsp_string298.length);
      out.print((SystemEnv.getHtmlLabelName(25379,user.getLanguage())));
      out.write(_jsp_string299, 0, _jsp_string299.length);
      out.print((SystemEnv.getHtmlLabelName(27541,user.getLanguage())));
      out.write(_jsp_string300, 0, _jsp_string300.length);
      out.print((SystemEnv.getHtmlLabelName(83099,user.getLanguage()) ));
      out.write(_jsp_string301, 0, _jsp_string301.length);
      out.print((SystemEnv.getHtmlLabelName(18779,user.getLanguage()) ));
      out.write(_jsp_string302, 0, _jsp_string302.length);
      out.print((SystemEnv.getHtmlLabelName(32029, user.getLanguage())));
      out.write(_jsp_string303, 0, _jsp_string303.length);
      out.print((SystemEnv.getHtmlLabelName(32030, user.getLanguage())));
      out.write(_jsp_string304, 0, _jsp_string304.length);
      out.print((needReceipt));
      out.write(_jsp_string305, 0, _jsp_string305.length);
      out.print((timingdate));
      out.write(_jsp_string306, 0, _jsp_string306.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string307, 0, _jsp_string307.length);
      out.print((SystemEnv.getHtmlLabelName(23073,user.getLanguage())));
      out.write(_jsp_string308, 0, _jsp_string308.length);
      out.print((space));
      out.write(_jsp_string279, 0, _jsp_string279.length);
      out.print((SystemEnv.getHtmlLabelName(83075,user.getLanguage()) ));
      out.write(_jsp_string309, 0, _jsp_string309.length);
    } catch (java.lang.Throwable _jsp_e) {
      pageContext.handlePageException(_jsp_e);
    } finally {
      _jsp_application.getJspApplicationContext().freePageContext(pageContext);
    }
  }

  private java.util.ArrayList _caucho_depends = new java.util.ArrayList();

  public java.util.ArrayList _caucho_getDependList()
  {
    return _caucho_depends;
  }

  public void _caucho_addDepend(com.caucho.vfs.PersistentDependency depend)
  {
    super._caucho_addDepend(depend);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  public boolean _caucho_isModified()
  {
    if (_caucho_isDead)
      return true;
    if (com.caucho.server.util.CauchoSystem.getVersionId() != 1886798272571451039L)
      return true;
    for (int i = _caucho_depends.size() - 1; i >= 0; i--) {
      com.caucho.vfs.Dependency depend;
      depend = (com.caucho.vfs.Dependency) _caucho_depends.get(i);
      if (depend.isModified())
        return true;
    }
    return false;
  }

  public long _caucho_lastModified()
  {
    return 0;
  }

  public java.util.HashMap<String,java.lang.reflect.Method> _caucho_getFunctionMap()
  {
    return _jsp_functionMap;
  }

  public void init(ServletConfig config)
    throws ServletException
  {
    com.caucho.server.webapp.WebApp webApp
      = (com.caucho.server.webapp.WebApp) config.getServletContext();
    super.init(config);
    com.caucho.jsp.TaglibManager manager = webApp.getJspApplicationContext().getTaglibManager();
    manager.addTaglibFunctions(_jsp_functionMap, "brow", "/WEB-INF/tld/browser.tld");
    com.caucho.jsp.PageContextImpl pageContext = new com.caucho.jsp.PageContextImpl(webApp, this);
  }

  public void destroy()
  {
      _caucho_isDead = true;
      super.destroy();
  }

  public void init(com.caucho.vfs.Path appDir)
    throws javax.servlet.ServletException
  {
    com.caucho.vfs.Path resinHome = com.caucho.server.util.CauchoSystem.getResinHome();
    com.caucho.vfs.MergePath mergePath = new com.caucho.vfs.MergePath();
    mergePath.addMergePath(appDir);
    mergePath.addMergePath(resinHome);
    com.caucho.loader.DynamicClassLoader loader;
    loader = (com.caucho.loader.DynamicClassLoader) getClass().getClassLoader();
    String resourcePath = loader.getResourcePathSpecificFirst();
    mergePath.addClassPath(resourcePath);
    com.caucho.vfs.Depend depend;
    depend = new com.caucho.vfs.Depend(appDir.lookup("email/new/MailAdd.jsp"), -3466592729243918446L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("systeminfo/init_wev8.jsp"), 8775654873609053482L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("wui/common/page/initWui.jsp"), 3390533274175540290L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  private final static char []_jsp_string85;
  private final static char []_jsp_string251;
  private final static char []_jsp_string20;
  private final static char []_jsp_string197;
  private final static char []_jsp_string307;
  private final static char []_jsp_string253;
  private final static char []_jsp_string122;
  private final static char []_jsp_string120;
  private final static char []_jsp_string184;
  private final static char []_jsp_string96;
  private final static char []_jsp_string75;
  private final static char []_jsp_string282;
  private final static char []_jsp_string21;
  private final static char []_jsp_string292;
  private final static char []_jsp_string291;
  private final static char []_jsp_string289;
  private final static char []_jsp_string63;
  private final static char []_jsp_string8;
  private final static char []_jsp_string235;
  private final static char []_jsp_string195;
  private final static char []_jsp_string180;
  private final static char []_jsp_string32;
  private final static char []_jsp_string240;
  private final static char []_jsp_string261;
  private final static char []_jsp_string201;
  private final static char []_jsp_string48;
  private final static char []_jsp_string170;
  private final static char []_jsp_string94;
  private final static char []_jsp_string222;
  private final static char []_jsp_string293;
  private final static char []_jsp_string38;
  private final static char []_jsp_string108;
  private final static char []_jsp_string212;
  private final static char []_jsp_string157;
  private final static char []_jsp_string309;
  private final static char []_jsp_string43;
  private final static char []_jsp_string177;
  private final static char []_jsp_string114;
  private final static char []_jsp_string54;
  private final static char []_jsp_string287;
  private final static char []_jsp_string107;
  private final static char []_jsp_string84;
  private final static char []_jsp_string248;
  private final static char []_jsp_string290;
  private final static char []_jsp_string308;
  private final static char []_jsp_string193;
  private final static char []_jsp_string104;
  private final static char []_jsp_string218;
  private final static char []_jsp_string165;
  private final static char []_jsp_string179;
  private final static char []_jsp_string87;
  private final static char []_jsp_string19;
  private final static char []_jsp_string99;
  private final static char []_jsp_string227;
  private final static char []_jsp_string129;
  private final static char []_jsp_string168;
  private final static char []_jsp_string16;
  private final static char []_jsp_string305;
  private final static char []_jsp_string68;
  private final static char []_jsp_string18;
  private final static char []_jsp_string150;
  private final static char []_jsp_string117;
  private final static char []_jsp_string285;
  private final static char []_jsp_string12;
  private final static char []_jsp_string132;
  private final static char []_jsp_string154;
  private final static char []_jsp_string74;
  private final static char []_jsp_string266;
  private final static char []_jsp_string56;
  private final static char []_jsp_string152;
  private final static char []_jsp_string171;
  private final static char []_jsp_string91;
  private final static char []_jsp_string140;
  private final static char []_jsp_string78;
  private final static char []_jsp_string178;
  private final static char []_jsp_string121;
  private final static char []_jsp_string100;
  private final static char []_jsp_string118;
  private final static char []_jsp_string268;
  private final static char []_jsp_string246;
  private final static char []_jsp_string203;
  private final static char []_jsp_string204;
  private final static char []_jsp_string134;
  private final static char []_jsp_string249;
  private final static char []_jsp_string231;
  private final static char []_jsp_string210;
  private final static char []_jsp_string17;
  private final static char []_jsp_string276;
  private final static char []_jsp_string93;
  private final static char []_jsp_string245;
  private final static char []_jsp_string160;
  private final static char []_jsp_string81;
  private final static char []_jsp_string158;
  private final static char []_jsp_string259;
  private final static char []_jsp_string190;
  private final static char []_jsp_string61;
  private final static char []_jsp_string130;
  private final static char []_jsp_string79;
  private final static char []_jsp_string297;
  private final static char []_jsp_string295;
  private final static char []_jsp_string44;
  private final static char []_jsp_string6;
  private final static char []_jsp_string238;
  private final static char []_jsp_string252;
  private final static char []_jsp_string209;
  private final static char []_jsp_string185;
  private final static char []_jsp_string46;
  private final static char []_jsp_string278;
  private final static char []_jsp_string199;
  private final static char []_jsp_string92;
  private final static char []_jsp_string198;
  private final static char []_jsp_string5;
  private final static char []_jsp_string244;
  private final static char []_jsp_string51;
  private final static char []_jsp_string115;
  private final static char []_jsp_string173;
  private final static char []_jsp_string14;
  private final static char []_jsp_string301;
  private final static char []_jsp_string155;
  private final static char []_jsp_string86;
  private final static char []_jsp_string97;
  private final static char []_jsp_string27;
  private final static char []_jsp_string258;
  private final static char []_jsp_string57;
  private final static char []_jsp_string64;
  private final static char []_jsp_string116;
  private final static char []_jsp_string299;
  private final static char []_jsp_string196;
  private final static char []_jsp_string34;
  private final static char []_jsp_string272;
  private final static char []_jsp_string67;
  private final static char []_jsp_string149;
  private final static char []_jsp_string131;
  private final static char []_jsp_string237;
  private final static char []_jsp_string267;
  private final static char []_jsp_string182;
  private final static char []_jsp_string161;
  private final static char []_jsp_string296;
  private final static char []_jsp_string225;
  private final static char []_jsp_string83;
  private final static char []_jsp_string11;
  private final static char []_jsp_string136;
  private final static char []_jsp_string90;
  private final static char []_jsp_string65;
  private final static char []_jsp_string138;
  private final static char []_jsp_string123;
  private final static char []_jsp_string254;
  private final static char []_jsp_string224;
  private final static char []_jsp_string69;
  private final static char []_jsp_string257;
  private final static char []_jsp_string219;
  private final static char []_jsp_string294;
  private final static char []_jsp_string25;
  private final static char []_jsp_string144;
  private final static char []_jsp_string77;
  private final static char []_jsp_string9;
  private final static char []_jsp_string239;
  private final static char []_jsp_string106;
  private final static char []_jsp_string232;
  private final static char []_jsp_string300;
  private final static char []_jsp_string42;
  private final static char []_jsp_string7;
  private final static char []_jsp_string33;
  private final static char []_jsp_string275;
  private final static char []_jsp_string73;
  private final static char []_jsp_string206;
  private final static char []_jsp_string45;
  private final static char []_jsp_string30;
  private final static char []_jsp_string271;
  private final static char []_jsp_string145;
  private final static char []_jsp_string3;
  private final static char []_jsp_string124;
  private final static char []_jsp_string167;
  private final static char []_jsp_string306;
  private final static char []_jsp_string31;
  private final static char []_jsp_string189;
  private final static char []_jsp_string260;
  private final static char []_jsp_string187;
  private final static char []_jsp_string169;
  private final static char []_jsp_string163;
  private final static char []_jsp_string36;
  private final static char []_jsp_string89;
  private final static char []_jsp_string303;
  private final static char []_jsp_string229;
  private final static char []_jsp_string186;
  private final static char []_jsp_string162;
  private final static char []_jsp_string98;
  private final static char []_jsp_string228;
  private final static char []_jsp_string26;
  private final static char []_jsp_string236;
  private final static char []_jsp_string151;
  private final static char []_jsp_string52;
  private final static char []_jsp_string111;
  private final static char []_jsp_string47;
  private final static char []_jsp_string55;
  private final static char []_jsp_string243;
  private final static char []_jsp_string226;
  private final static char []_jsp_string71;
  private final static char []_jsp_string82;
  private final static char []_jsp_string37;
  private final static char []_jsp_string175;
  private final static char []_jsp_string127;
  private final static char []_jsp_string15;
  private final static char []_jsp_string214;
  private final static char []_jsp_string211;
  private final static char []_jsp_string284;
  private final static char []_jsp_string242;
  private final static char []_jsp_string142;
  private final static char []_jsp_string135;
  private final static char []_jsp_string58;
  private final static char []_jsp_string62;
  private final static char []_jsp_string221;
  private final static char []_jsp_string41;
  private final static char []_jsp_string213;
  private final static char []_jsp_string113;
  private final static char []_jsp_string194;
  private final static char []_jsp_string247;
  private final static char []_jsp_string302;
  private final static char []_jsp_string141;
  private final static char []_jsp_string137;
  private final static char []_jsp_string256;
  private final static char []_jsp_string133;
  private final static char []_jsp_string119;
  private final static char []_jsp_string1;
  private final static char []_jsp_string183;
  private final static char []_jsp_string13;
  private final static char []_jsp_string230;
  private final static char []_jsp_string147;
  private final static char []_jsp_string202;
  private final static char []_jsp_string176;
  private final static char []_jsp_string216;
  private final static char []_jsp_string72;
  private final static char []_jsp_string35;
  private final static char []_jsp_string4;
  private final static char []_jsp_string263;
  private final static char []_jsp_string286;
  private final static char []_jsp_string50;
  private final static char []_jsp_string277;
  private final static char []_jsp_string143;
  private final static char []_jsp_string23;
  private final static char []_jsp_string188;
  private final static char []_jsp_string0;
  private final static char []_jsp_string126;
  private final static char []_jsp_string109;
  private final static char []_jsp_string102;
  private final static char []_jsp_string280;
  private final static char []_jsp_string217;
  private final static char []_jsp_string174;
  private final static char []_jsp_string159;
  private final static char []_jsp_string250;
  private final static char []_jsp_string181;
  private final static char []_jsp_string110;
  private final static char []_jsp_string53;
  private final static char []_jsp_string10;
  private final static char []_jsp_string146;
  private final static char []_jsp_string148;
  private final static char []_jsp_string273;
  private final static char []_jsp_string223;
  private final static char []_jsp_string49;
  private final static char []_jsp_string200;
  private final static char []_jsp_string40;
  private final static char []_jsp_string208;
  private final static char []_jsp_string220;
  private final static char []_jsp_string125;
  private final static char []_jsp_string101;
  private final static char []_jsp_string207;
  private final static char []_jsp_string172;
  private final static char []_jsp_string22;
  private final static char []_jsp_string215;
  private final static char []_jsp_string156;
  private final static char []_jsp_string139;
  private final static char []_jsp_string95;
  private final static char []_jsp_string88;
  private final static char []_jsp_string66;
  private final static char []_jsp_string298;
  private final static char []_jsp_string233;
  private final static char []_jsp_string29;
  private final static char []_jsp_string234;
  private final static char []_jsp_string153;
  private final static char []_jsp_string304;
  private final static char []_jsp_string279;
  private final static char []_jsp_string166;
  private final static char []_jsp_string164;
  private final static char []_jsp_string80;
  private final static char []_jsp_string269;
  private final static char []_jsp_string191;
  private final static char []_jsp_string264;
  private final static char []_jsp_string128;
  private final static char []_jsp_string103;
  private final static char []_jsp_string60;
  private final static char []_jsp_string59;
  private final static char []_jsp_string241;
  private final static char []_jsp_string288;
  private final static char []_jsp_string274;
  private final static char []_jsp_string28;
  private final static char []_jsp_string24;
  private final static char []_jsp_string265;
  private final static char []_jsp_string70;
  private final static char []_jsp_string255;
  private final static char []_jsp_string192;
  private final static char []_jsp_string39;
  private final static char []_jsp_string281;
  private final static char []_jsp_string205;
  private final static char []_jsp_string112;
  private final static char []_jsp_string283;
  private final static char []_jsp_string270;
  private final static char []_jsp_string262;
  private final static char []_jsp_string76;
  private final static char []_jsp_string105;
  private final static char []_jsp_string2;
  static {
    _jsp_string85 = "\r\n                                        <label class=\"cb-enable ".toCharArray();
    _jsp_string251 = "\");\r\n                var swfu = $.swfupload.getInstance('.swfupload-control');\r\n                swfu.cancelUpload(file.id);\r\n                return;\r\n            }\r\n            \r\n            //\u5355\u4e2a\u9644\u4ef6\u5927\u5c0f\u9650\u5236\r\n            if(".toCharArray();
    _jsp_string20 = "&f_weaver_belongto_usertype=".toCharArray();
    _jsp_string197 = "\";\r\n    if (mailtype == \"contacter\") {\r\n        url = \"/systeminfo/BrowserMain.jsp?url=/email/MailContacterBrowserMulti.jsp\";\r\n        tabTitle = \"".toCharArray();
    _jsp_string307 = "!\"\r\n                if (temptitle) msg = \"".toCharArray();
    _jsp_string253 = "M\");\r\n                var swfu = $.swfupload.getInstance('.swfupload-control');\r\n                swfu.cancelUpload(file.id);\r\n                return;\r\n            }\r\n            //\u603b\u5927\u5c0f\u9650\u5236\r\n            var total = parseFloat(file.size) + parseFloat(totalSize);\r\n            if(1!=".toCharArray();
    _jsp_string122 = "\">\r\n                                        <input class=\"\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internaltohrmdpid\" id=\"internaltohrmdpid\" value=\"".toCharArray();
    _jsp_string120 = "\">\r\n                                        <input class=\"mailInputHide\" width=\"20\" style=\"width: 20\" type=\"hidden\" relid=\"internalto\" name=\"internaltoall\" id=\"internaltoall\" value=\"".toCharArray();
    _jsp_string184 = "\r\n    </li>\r\n    <li class=\"\"  style=\"font-weight: normal;line-height: 20px;\" onclick=\"onShowDepartment(this)\" ><button type=\"button\" class=\"Browser\"  title=\"".toCharArray();
    _jsp_string96 = "\r\n                                                                <option value=\"".toCharArray();
    _jsp_string75 = "\" />\r\n    ".toCharArray();
    _jsp_string282 = "\")\r\n            return false;\r\n        }\r\n        if((check_form($G(\"mailAddForm\"),'to,subject'))){\r\n            if(!check_receiveStr(false))\r\n                return;\r\n        \r\n            var swfu = $.swfupload.getInstance('.swfupload-control');\r\n            if(swfu.getStats().files_queued >0){\r\n                swfu.setButtonDisabled(true);\r\n                swfu.startUpload();\r\n                \r\n                showLoading();\r\n                obj.disabled=true;\r\n                jQuery(\"#mailAddForm\").submit();\r\n            }else{\r\n                showLoading();\r\n                obj.disabled=true;\r\n                jQuery(\"#mailAddForm\").submit();\r\n            }\r\n            \r\n        }\r\n    }\r\n}\r\n\r\nfunction showLoading(type){\r\n   $(\"#bgAlpha\").show();\r\n   switch(type){\r\n      case 'saveing':\r\n         $(\"#loading-msg\").html(\"".toCharArray();
    _jsp_string21 = "\";\r\n	    xmlhttp.open(\"GET\",URL, false);\r\n	    xmlhttp.send(null);\r\n	    var result = xmlhttp.status;\r\n	    if(result==200) {\r\n		    isconn = true;\r\n	    	var response_flag = xmlhttp.responseText;\r\n	    	if(response_flag!='0') {\r\n	    		var flag_msg = '';\r\n	    		if(response_flag=='1') {\r\n	    			var diag = new Dialog();\r\n					diag.Width = 300;\r\n					diag.Height = 180;\r\n					diag.ShowCloseButton=false;\r\n					diag.Title = \"".toCharArray();
    _jsp_string292 = "\";\r\n    diag.URL = \"/email/new/MailContacterAdd.jsp\";\r\n    diag.show();\r\n}\r\n\r\nfunction closeWin(){\r\n    diag.close();\r\n    $(\"div#contactsContent div#contactsTree\").load(\"/email/new/MailAddContactsTree.jsp\");\r\n}\r\n/**************end*****************MailContactAdd.jsp\u9875\u9762\u4f9d\u8d56\u4ee3\u7801******************************************/\r\n\r\nfunction Spage(groupid,num,event,obj){\r\n            num=parseInt(num)+1;\r\n            //\u603b\u9875\u7801\r\n            var prevnum=$(obj).parent().prev().attr(\"_pagesize\");\r\n            var keyword =encodeURI($(\"#fromSearch\").val())\r\n            var t_str=\"?groupid=\"+groupid+\"&type=1&fx=1&_pagenum=\"+num+\"&keyword=\"+keyword;\r\n            $.post(\"/email/new/MailAddContactsTree.jsp\"+t_str,\"\",function(data){\r\n                    $(obj).parent().append(data);   \r\n                    var $pare=$(obj).parent();\r\n                     $pare.find(\".more_class\").remove();\r\n                     //\"+groupId+\",\"+_pagenum+\",event,this\r\n                    if(num<prevnum){\r\n                             $pare.append(\"<div style=\\\"cursor: pointer;text-align: center;\\\" onclick=\\\"Spage('\"+groupid+\"','\"+num+\"',event,this)\\\"   class='more_class'>".toCharArray();
    _jsp_string291 = "&' + new Date(),\r\n                success: function(data) {\r\n                    setTemplate(data);\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\n//\u8bbe\u7f6e\u90ae\u4ef6\u6a21\u7248\r\nfunction setTemplate(data) {\r\n    var templateContent = data;\r\n    var reg = /\\@\\@\\@(.*)\\@\\@\\@/;\r\n    if (templateContent.match(reg)) {\r\n        $(\"#subject\").val(templateContent.match(reg)[1]);\r\n    }\r\n    if ($(\"#subject\").val() != \"\") {\r\n        $(\"#subjectSpan\").html('');\r\n        autoChangeSubject = true; //\u90ae\u4ef6\u6807\u9898\u53d1\u751f\u53d8\u66f4\u8fc7\r\n    } else {\r\n        $(\"#subjectSpan\").html(\"<img src='/images/BacoError_wev8.gif' align=\\\"absMiddle\\\">\");\r\n    }\r\n    KE.html(\"mouldtext\", templateContent.replace(reg, \"\"));\r\n}\r\n\r\n/**************start*****************MailContactAdd.jsp\u9875\u9762\u4f9d\u8d56\u4ee3\u7801******************************************/\r\n//\u8f7d\u5165\u6dfb\u52a0\u8054\u7cfb\u4eba\u9875\u9762\r\nfunction addContact() {\r\n    diag = new window.top.Dialog();\r\n    diag.currentWindow = window;\r\n    diag.Width = 500;\r\n    diag.Height = 520;\r\n    diag.Title = \"".toCharArray();
    _jsp_string289 = "&t=' + Math.random(),\r\n            success: function(data) {\r\n                setTemplate(data);\r\n            }\r\n        });\r\n    } else {\r\n        if (confirm(\"".toCharArray();
    _jsp_string63 = "\";\r\n//\u5f53\u524d\u4e3b\u9898\u4f7f\u7528\u7684\u76ae\u80a4\r\nvar GLOBAL_SKINS_FOLDER = \"".toCharArray();
    _jsp_string8 = "\r\n<script type=\"text/javascript\" src=\"/js/select/script/jquery-1.8.3.min_wev8.js\"></script>	    \r\n".toCharArray();
    _jsp_string235 = "',\r\n            newlineTag: 'br',  // \u6bb5\u843d\u5206\u9694\u7b26\r\n            afterCreate: function() {\r\n                if(!isEdtiorFirstReady) {\r\n                    isEdtiorFirstReady = true;  // \u7f6e\u72b6\u6001\r\n                    \r\n                    var defaultTemplateId = ".toCharArray();
    _jsp_string195 = "...</span>\r\n</div>\r\n\r\n    \r\n</body>\r\n</html> \r\n<style>\r\n.sapn_top{\r\n        padding-top:5px !important ;\r\n        padding-top:2px ;\r\n}\r\n\r\n table td{\r\n    vertical-align: top;\r\n }\r\n.ke-container{\r\n    width: 100%!important;\r\n}\r\n\r\n\r\n .inputSelected{\r\n    border: 1px solid #bababa !important;\r\n } \r\n\r\n div{\r\n    font-size: 12px;\r\n }\r\n .overText{\r\n    display:inline-block;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    -o-text-overflow: ellipsis; /*--4 opera--*/\r\n    text-overflow: ellipsis;\r\n }\r\n .spanBtn{\r\n    \r\n    margin-left:5px;\r\n    padding:1px;\r\n    cursor: pointer;\r\n }\r\n .spanBtnOver{\r\n    padding:1px;\r\n    cursor: pointer;\r\n    color:#ffffff;\r\n    background: #0083ff;\r\n    border-radius:3px;\r\n    margin-left:5px;    \r\n }\r\n \r\n .mailAdSelect{ \r\n    color:#ffffff!important;\r\n    background: #0083ff !important;\r\n    border-radius:3px;      \r\n }\r\n \r\n .mailAdOK{\r\n    background: #DBF2E0;\r\n    border-color:#8EAF95;\r\n    border-radius:2px;  \r\n }\r\n  .mailAdOK span{\r\n    vertical-align: middle;\r\n    margin-left: 5px;\r\n  }\r\n .mailAdError{  \r\n    color:#c30;\r\n    background:  #FFEAEA;\r\n    border-radius:3px;      \r\n }\r\n\r\n .tab{\r\n    width: 102px !important ;\r\n    height: 30px;\r\n    border-top-left-radius:3px;\r\n    border-top-right-radius:3px;\r\n    border: 1px solid #cccccc;\r\n    outline-color:#222222;\r\n    line-height: 30px;\r\n    text-align:center;\r\n    color:#222222;\r\n    font-weight: bold;\r\n    cursor:pointer;\r\n }\r\n .tabSelected{\r\n    background: #ffffff;\r\n    border-bottom:0px;\r\n }\r\n .tabUnSelected{\r\n    background: #eeeeee;\r\n }\r\n \r\n .tabContent{\r\n    border-bottom: 1px solid #cccccc;\r\n    border-left: 1px solid #cccccc;\r\n    border-right: 1px solid #cccccc;\r\n    \r\n    overflow-y: scroll;\r\n    overflow-x: hidden;\r\n }\r\n \r\n .searchFrom{\r\n    background: url('/email/images/search_wev8.png') no-repeat;\r\n    width: 13px;\r\n    height: 13px;\r\n    position: absolute;\r\n    cursor: pointer;\r\n    left: 138px;\r\n    top:15px;\r\n }\r\n  .clearFrom{\r\n    color:#cccccc;\r\n    width: 13px;\r\n    height: 13px;\r\n    position: absolute;\r\n    cursor: pointer;\r\n    left: 145px;\r\n    top:13px;\r\n    font-family: verdana!important;\r\n }\r\n \r\n  .addFrom{\r\n    /*background: url('/email/images/add_wev8.png') no-repeat;*/\r\n    /*width: 60px;*/\r\n    height: 35px;\r\n    line-height: 35px;\r\n    position: absolute;\r\n    cursor: pointer;\r\n    left: 160px;\r\n    top:15px;\r\n    font-size:12px;\r\n    color:#0183fd;\r\n }\r\n .addFrom:hover{\r\n    /*background: url('/email/images/addOver_wev8.png') no-repeat;*/\r\n    color:#0183fd;\r\n }\r\n\r\n .contactsItem{\r\n    height: 24px;\r\n    line-height:24px;\r\n    \r\n }\r\n .contactsItemOver{\r\n    background: whiteSmoke;\r\n }\r\n \r\n .contactsFold{\r\n    margin-top: 5px;\r\n }\r\n \r\n .ke-icon-sign {\r\n    width: 16px;\r\n    height: 16px;\r\n    background:url(\"/email/images/sign_wev8.png\"); \r\n    background-repeat: no-repeat;\r\n}\r\n\r\n .ke-icon-mailTemplate {\r\n    width: 16px;\r\n    height: 16px;\r\n    background:url(\"/email/images/template_wev8.png\"); \r\n    background-repeat: no-repeat;\r\n}\r\n\r\n .ke-icon-doc{\r\n    width: 16px;\r\n    height: 16px;\r\n    background:url(\"/email/images/app-doc_wev8.png\"); \r\n    background-repeat: no-repeat;\r\n}\r\n\r\n.ke-icon-project{\r\n    width: 16px;\r\n    height: 16px;\r\n    background:url(\"/email/images/app-project_wev8.png\"); \r\n    background-repeat: no-repeat;\r\n}\r\n\r\n.ke-icon-crm{\r\n    width: 16px;\r\n    height: 16px;\r\n    background:url(\"/email/images/app-crm_wev8.png\"); \r\n    background-repeat: no-repeat;\r\n}\r\n\r\n.ke-icon-workflow{\r\n    width: 16px;\r\n    height: 16px;\r\n    background:url(\"/email/images/app-wl_wev8.png\"); \r\n    background-repeat: no-repeat;\r\n}\r\n\r\n.ke-icon-task{\r\n    width: 16px;\r\n    height: 16px;\r\n    background:url(\"/email/images/app-task_wev8.png\"); \r\n    background-repeat: no-repeat;\r\n}\r\n\r\n.ke-icon-workplan{\r\n    width: 16px;\r\n    height: 16px;\r\n    background:url(\"/workplan/calendar/css/images/icons/appt_wev8.gif\"); \r\n    background-repeat: no-repeat;\r\n}\r\n\r\n\r\n\r\n BUTTON.Browser{\r\n    height: 16px;\r\n }\r\n \r\n .editableAddr-ipt{\r\n    position:relative;\r\n    left: 0;\r\n    top: 0;\r\n    width: 100%;\r\n    font-family: tahoma,verdana;\r\n    margin: 0;\r\n    padding: 0;\r\n    display: inline;\r\n    border: 0;\r\n    outline: 0;\r\n    background: transparent;\r\n\r\n    \r\n}\r\n.editableAddr-txt{\r\n    visibility: hidden;\r\n    color: #999;\r\n    \r\n}\r\n.editableAddr {\r\n    float: left;\r\n    margin:3px;\r\n    white-space: nowrap;\r\n    position: relative;\r\n    max-width: 465px;\r\n    \r\n    height: 15px;\r\n    line-height: 15px;\r\n    color: #999;\r\n    font-size: 12px;\r\n    cursor: text;\r\n    \r\n}\r\n\r\n.mailInput{\r\n    min-height: 28px;\r\n    height:auto !important;height:28px;\r\n    display: block;\r\n    cursor: text;\r\n    padding: 0px;\r\n}\r\n\r\n.huotu_dialog_overlay\r\n    {\r\n        z-index:99991;\r\n        position:fixed;\r\n        filter:alpha(opacity=30); BACKGROUND-COLOR: rgb(0, 0, 0);\r\n        width:100%;\r\n        bottom:0px;\r\n        height:100%;\r\n        top:0px;\r\n        right:0px;\r\n        left:0px;\r\n        opacity:0.3;\r\n        _position:absolute!important;       \r\n        margin: 0px;\r\n        padding: 0px;\r\n        overflow: hidden;\r\n        display: none;\r\n    }\r\n    .bd_dialog_main\r\n    {   \r\n    \r\n          box-shadow:rgba(0,0,0,0.2) 0px 0px 5px 0px;\r\n          border: 2px solid #90969E;\r\n          background: #ffffff;\r\n         display: none; \r\n         z-index:99998;\r\n         position:fixed;\r\n        _position:absolute!important;   \r\n         width: 400px; \r\n         height: 200px; \r\n         background-color:white;    \r\n         text-align: left; \r\n         line-height: 27px; \r\n         font-size:14px;\r\n         font-weight: bold; \r\n    }\r\n    .li_decimal{ list-style-type:decimal ; list-style-position: inside;}\r\n    \r\n    .mailAdItem{\r\n        white-space: nowrap;\r\n        cursor: pointer;\r\n        float:left;\r\n        margin:3px;\r\n        line-height: 20px;\r\n    } \r\n    \r\n    .mailInputOverDisplay{\r\n        height: 100px!important;\r\n        overflow-y: auto!important;\r\n    }\r\n</style>\r\n\r\n<script>\r\n\r\nvar currentInputId=\"\";\r\nvar editorHeight=0;\r\n\r\nvar mailobj;\r\nvar diag=null;\r\n\r\nfunction doInput(obj){\r\n    //$(obj).css('position','relative');    \r\n    //var oTextCount = document.getElementById(\"char\"); \r\n    iCount = obj.value.replace(/([^\\u0000-\\u00FF])/g,'aa').length; \r\n    obj.size=iCount+1;          \r\n}\r\n\r\nfunction doRemove(obj){\r\n    if($('.ac_results:visible').length > 0){\r\n        return;\r\n    }\r\n    try {\r\n        $(obj).parent().remove();\r\n    } catch(e) {}\r\n}\r\n\r\nfunction mailLeave(obj){\r\n    $(obj).removeClass('mailAdOver')\r\n}\r\n\r\nfunction mailOver(obj){\r\n    $(\".mailAdOver\").removeClass(\"mailAdOver\");\r\n    $(obj).addClass('mailAdOver');\r\n}\r\n\r\nfunction insertBeforeThis(obj, event){\r\n    $(\".mailAdOver\").removeClass(\"mailAdOver\");\r\n    $(\".mailAdSelect\").removeClass(\"mailAdSelect\");\r\n    $('.mailInput').find(\".mailinputdiv\").remove();\r\n    var edit = $('<span class=\"mailinputdiv editableAddr\"><input size=1 style=\"*width:1px;overflow-x:visible;overflow-y:visible;\" onchange=\"addMailAddress(this)\" class=\"editableAddr-ipt\" oninput=\"doInput(this)\" onpropertychange=\"doInput(this)\" onblur=\"doRemove(this)\" /><span class=\"editableAddr-txt\"></span></span>')\r\n    edit.insertBefore($(obj).parent());\r\n    $('.mailInput').find('.editableAddr-ipt').focus();\r\n    $(\".editableAddr-ipt\").bind('keydown', 'backspace',function (evt){\r\n        if($(this).val()==''){\r\n            $(this).parent().prev().remove();\r\n        }\r\n    });\r\n    if($(obj).parent().parent().attr(\"type\")==\"hrm\"){\r\n        edit.find('.editableAddr-ipt').autocomplete(\"/email/new/GetData.jsp?searchtype=hrm\", {\r\n            minChars: 1,\r\n            scroll: true,\r\n            //max:30,\r\n            width:400,\r\n            multiple:\"\",\r\n            matchSubset: false,\r\n            scrollHeight: 240,\r\n            matchContains: \"word\",\r\n            autoFill: false,\r\n            formatItem: function(row, i, max) {\r\n                return  row.name +\"&lt;\"+row.department+\"&gt;\";\r\n            },\r\n            formatMatch: function(row, i, max) {\r\n                return row.name+ \" \" + row.pinyin+ \" \" + row.loginid;\r\n            },\r\n            formatResult: function(row) {\r\n                return row.name+\"|\"+row.id+\"|\"+row.dpid;\r\n            }\r\n        });\r\n    }else{\r\n        edit.find('.editableAddr-ipt').autocomplete(\"/email/new/EmailData.jsp\", {\r\n            minChars: 1,\r\n            scroll: true,\r\n            max:50,\r\n            width:400,\r\n            multiple:\"\",\r\n            scrollHeight: 240,\r\n            matchContains: \"word\",\r\n            autoFill: false,\r\n            formatItem: function(row, i, max) {\r\n                return  row.name +\"&lt;\" + row.to + \"&gt;\";\r\n            },\r\n            formatMatch: function(row, i, max) {\r\n                return row.name + \" \" + row.to;\r\n            },\r\n            formatResult: function(row) {\r\n                return row.name +\"|\" + row.to;\r\n            }\r\n        });\r\n    }\r\n    stopEvent(event);\r\n}\r\n\r\nfunction insertAfterThis(obj,event){\r\n    $(\".mailAdOver\").removeClass(\"mailAdOver\");\r\n    $(\".mailAdSelect\").removeClass(\"mailAdSelect\");\r\n    $('.mailInput').find(\".mailinputdiv\").remove();\r\n    var edit = $('<span class=\"mailinputdiv editableAddr \" ><input size=1 style=\"*width:1px;overflow-x:visible;overflow-y:visible;\" class=\"editableAddr-ipt\" oninput=\"doInput(this)\" onpropertychange=\"doInput(this)\" onchange=\"addMailAddress(this)\" onblur=\"doRemove(this)\"><span class=\"editableAddr-txt\"></span></span>')\r\n    \r\n    edit.insertAfter($(obj).parent());\r\n    $('.mailInput').find('.editableAddr-ipt').focus();\r\n    $(\".editableAddr-ipt\").bind('keydown', 'backspace',function (evt){\r\n        if($(this).val()==''){\r\n            $(this).parent().prev().remove();\r\n        }\r\n    });\r\n    if($(obj).parent().parent().attr(\"type\")==\"hrm\"){\r\n        edit.find('.editableAddr-ipt').autocomplete(\"/email/new/GetData.jsp?searchtype=hrm\", {\r\n            minChars: 1,\r\n            scroll: true,\r\n            //max:30,\r\n            width:400,\r\n            multiple:\"\",\r\n            matchSubset: false,\r\n            scrollHeight: 240,\r\n            matchContains: \"word\",\r\n            autoFill: false,\r\n            formatItem: function(row, i, max) {\r\n                return  row.name +\"&lt;\"+row.department+\"&gt;\";\r\n            },\r\n            formatMatch: function(row, i, max) {\r\n                return row.name+ \" \" + row.pinyin+ \" \" + row.loginid;\r\n            },\r\n            formatResult: function(row) {\r\n                return row.name+\"|\"+row.id+\"|\"+row.dpid;\r\n            }\r\n        });\r\n    }else{\r\n        edit.find('.editableAddr-ipt').autocomplete(\"/email/new/EmailData.jsp\", {\r\n            minChars: 1,\r\n            scroll: true,\r\n            max:50,\r\n            width:400,\r\n            multiple:\"\",\r\n            scrollHeight: 240,\r\n            matchContains: \"word\",\r\n            autoFill: false,\r\n            formatItem: function(row, i, max) {\r\n                return  row.name +\"&lt;\" + row.to + \"&gt;\";\r\n            },\r\n            formatMatch: function(row, i, max) {\r\n                return row.name + \" \" + row.to;\r\n            },\r\n            formatResult: function(row) {\r\n                return row.name +\"|\" + row.to;\r\n            }\r\n        });\r\n    }\r\n    stopEvent(event);\r\n}\r\n\r\nfunction selectMail(obj,event){\r\n    $(\".mailAdSelect\").removeClass(\"mailAdSelect\");\r\n    $(obj).parent().addClass(\"mailAdSelect\");\r\n    \r\n}\r\n\r\nfunction mailUnselect(obj,event){\r\n    $(obj).remove(\"mailAdSelect\");\r\n    \r\n}\r\n\r\nfunction mail_keypress(obj){\r\n    var evt = getEvent() || event;\r\n    var keyCode = evt.which ? evt.which : evt.keyCode;\r\n    if(keyCode == 186){\r\n        $(obj).blur();\r\n        \r\n        $('.mailInput').click();\r\n        if (evt.keyCode) {\r\n            evt.keyCode = 0;evt.returnValue=false;     \r\n        } else {\r\n            evt.which = 0;evt.preventDefault();\r\n        }\r\n    }\r\n    \r\n}\r\n\r\nfunction addMailAddress(obj){\r\n    obj.value = obj.value.toLowerCase();\r\n    if($('.ac_results:visible').length>0){\r\n        // $('.ac_results').hide();\r\n        return;\r\n    }\r\n    if(!addToInput($(obj).parent().parent().attr(\"id\"),obj.value,obj)){\r\n        obj.value = \"\";\r\n    }\r\n}\r\n\r\nfunction showMailAddDiv($obj) {\r\n    var value = $obj.val();\r\n    var objId = $obj.attr('id');\r\n    var list = $obj.val().split(\",\");\r\n    var div = $(\".mailInput[target='\" + objId + \"']\");\r\n    div.html(\"\");\r\n    if (objId == 'internalto' || objId == 'internalcc' || objId == 'internalbcc') {\r\n        var listname = $(\"#\" + objId + \"hrmname\").val().split(\",\");\r\n        var listnamedpid = $(\"#\" + objId + \"hrmdpid\").val().split(\",\");\r\n        for (var i = 0; i < list.length; i++) {\r\n            var mail = list[i];\r\n            var dpid = listnamedpid[i];\r\n            var name = listname[i];\r\n            if (mail != '' && mail != '0') {\r\n                addToInput(objId + \"Div\", name + \"|\" + mail + \"|\" + dpid);\r\n            }\r\n        }\r\n        $(\"#\" + objId + \"Div\").find(\".clear\").remove();\r\n        \r\n    } else if (objId == 'internaltodpid' || objId == 'internalccdpid' || objId == 'internalbccdpid') {\r\n        var listname = $(\"#\" + objId + \"name\").val().split(\",\");\r\n        for (var i = 0; i < list.length; i++) {\r\n            var dpid = list[i];\r\n            var name = listname[i];\r\n            if (dpid != '' && dpid != '0') {\r\n                addToInput($obj.attr(\"relid\") + \"Div\", name + \"|0|\" + dpid);\r\n            }\r\n        }\r\n        $(\"#\" + $obj.attr(\"relid\") + \"Div\").find(\".clear\").remove();\r\n        \r\n    } else if (objId == 'internaltoall' || objId == 'internalccall' || objId == 'internalbccall') {\r\n        var listname = '".toCharArray();
    _jsp_string180 = "\" onclick=\"addContact()\">+</div>\r\n                            </div>\r\n                            <div id=\"contactsContent\">\r\n                                <!-- \u8054\u7cfb\u4eba\u5217\u8868 -->\r\n                                <div id=\"contactsTree\" class=\"m-t-10\">\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                       \r\n                        <!-- \u5185\u90e8\u5458\u5de5 -->\r\n                        <div id=\"innerHrmContent\" class=\"tabContent h-all hide relative\" >\r\n                            <div onclick=\"reflashHrmTree(this)\" style=\"position: absolute;left: 160px;padding-left: 2px;padding-right: 5px;margin-top: 5px;z-index: 11\">\r\n                                <img id=\"showaccounthrm\" style=\"cursor:pointer;\" src=\"/hrm/css/zTreeStyle/img/noaccounthide_wev8.png\" title=\"\u663e\u793a\u65e0\u8d26\u53f7\u4eba\u5458\">\r\n                                <img id=\"hideaccounthrm\" style=\"cursor:pointer;\" class=\"hide\" src=\"/hrm/css/zTreeStyle/img/noaccountshow_wev8.png\" title=\"\u9690\u85cf\u65e0\u8d26\u53f7\u4eba\u5458\">\r\n                            </div>\r\n                            <ul id=\"innerHrmTree\" style=\"width: 100%\"></ul> \r\n                        </div>\r\n                        <!-- \u79c1\u4eba\u7ec4 -->\r\n                        <div id=\"privateContent\" class=\"tabContent h-all hide relative\" >\r\n                            <ul id=\"hrmOrgTree\" style=\"width: 100%\"></ul>\r\n                        </div>\r\n                        \r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </td>\r\n    </tr>\r\n    \r\n</table>\r\n<ul class=\"btnGrayDropContent importBtnDown hide \" style=\"width: 100px;left: 0px;top:28px;\" >\r\n                                                \r\n    <li class=\"\"  style=\"font-weight: normal;line-height: 20px;\" onclick=\"onShowResourcemail(this,'hrm')\" ><button type=\"button\" class=\"Browser\"  title=\"".toCharArray();
    _jsp_string32 = "\", function () {\r\n						    formElementFocus(tempElement);						\r\n							});\r\n						}\r\n						return false;\r\n					}else{\r\n						if(window.__oriAlert__){\r\n							try{\r\n								window.top.Dialog.alert(\"".toCharArray();
    _jsp_string240 = "\", function() {\r\n            removeEditor(\"mouldtext\");\r\n        }, function() {\r\n            changeCheckboxStatus_1_8_3(obj, false);\r\n        });\r\n    } else {\r\n        if ($(\"#isInternal\").is(':checked')) {\r\n            highEditor(\"mouldtext\", editorHeight, 1);\r\n        } else {\r\n            highEditor(\"mouldtext\", editorHeight, 0);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * \u9644\u4ef6\u4e0a\u4f20\u63a7\u4ef6\r\n */\r\nvar totalSize = 0;//\u8bb0\u5f55\u603b\u9644\u4ef6\u5927\u5c0f\r\nvar fileIdArr = new Array();//\u9644\u4ef6file.id+\"-\"+\u9644\u4ef6\u6570\u636e\u5e93id\r\nvar arr = new Array();\r\nvar fileSid = 0;  //\u4e0a\u4f20\u9644\u4ef6ID\r\njQuery(function(){\r\n    getFileSize();//\u83b7\u53d6\u603b\u7684\u9644\u4ef6\u5927\u5c0f\r\n    setUploadInfo();\r\n});\r\n\r\nfunction getFileSize(){\r\n    totalSize = 0;\r\n    jQuery(\"input[name='fileSize']\").each(function(){\r\n        totalSize += parseFloat(this.value);\r\n    });\r\n}\r\n\r\nfunction setUploadInfo(){\r\n    if(totalSize <=0){\r\n        jQuery(\"#uploadInfo\").html(\"\");\r\n        return;\r\n    }\r\n    if(totalSize < 511){\r\n        return jQuery(\"#uploadInfo\").html(\"\uff08100%\uff0c".toCharArray();
    _jsp_string261 = "))+\"KB\");\r\n                }\r\n                \r\n                return;\r\n            }\r\n            }\r\n            totalSize = total;\r\n            \r\n            $progress = $(\"#progressDemo\").clone();\r\n            $progress.attr(\"id\",file.id);\r\n            //var index = $(\"#fsUploadProgress\").find(\".progressBar\").size();\r\n            //$progress.find(\".fileIndex\").text(index);\r\n            $progress.find(\".fileName\").text(file.name);\r\n            \r\n            var size = file.size/1024;\r\n            var size_str;\r\n            \r\n            if(file.size <= 511){ \r\n                size_str = file.size+\" B\";\r\n            }else if(size>511){\r\n                size = size/1024;\r\n                size_str = size.toFixed(2)+\" MB\";\r\n            }else{\r\n                size_str = size.toFixed(2)+\" KB\";\r\n            }\r\n            \r\n            $progress.find(\".fileSize\").html(\"(\"+size_str+\")<input type='hidden' name='fileSize' value='\"+Math.round(file.size).toFixed()+\"'>\");\r\n            $(\"#fsUploadProgress\").append($progress);\r\n            \r\n            var saveFileName = arr.length+\":\"+file.name;\r\n            arr[arr.length] = saveFileName;\r\n            setSubject();//\u8bbe\u7f6e\u90ae\u4ef6\u4e3b\u9898\r\n            \r\n            $progress.find(\".del\").bind('click', function () { //Remove from queue on cancel click\r\n                            var swfu = $.swfupload.getInstance('.swfupload-control');\r\n                            swfu.cancelUpload(file.id);\r\n                            $(\"#\"+file.id).remove();\r\n                            doDelAccFile(file.id);\r\n                            //setButton();\r\n                            getFileSize();//\u83b7\u53d6\u603b\u7684\u9644\u4ef6\u5927\u5c0f\r\n                            setUploadInfo();\r\n                            \r\n                            for(var i =0 ;i <arr.length; i ++){\r\n                                if(arr[i] == saveFileName){\r\n                                    arr.splice(i,1);\r\n                                }\r\n                            }\r\n                            setSubject();//\u8bbe\u7f6e\u90ae\u4ef6\u4e3b\u9898\r\n                        });\r\n            $progress.show();\r\n         \r\n            $(this).swfupload('startUpload');\r\n        })\r\n        .bind('fileQueueError', function (event, file, errorCode, message) {\r\n            if(errorCode==-100){\r\n                window.top.Dialog.alert(\"".toCharArray();
    _jsp_string201 = "|0|0\");\r\n        $(\"#\" + target).attr(\"disabled\", \"true\");\r\n    }\r\n    $(\".btnGrayDropContent\").hide();\r\n    stopEvent(event);\r\n}\r\n\r\n// jquery_1.8.3\u7248\u672c\u4e0b\u53d8\u66f4jnicecheckbox\u7684\u65b9\u6cd5\r\nfunction changeCheckboxStatus_1_8_3(obj, val) {\r\n    var $obj = jQuery(obj);\r\n    $obj.attr('checked', val);\r\n    $obj.siblings('span.jNiceCheckbox').toggleClass('jNiceChecked');\r\n}\r\n\r\n//\u6dfb\u52a0\u6240\u6709\u4eba\u4e3a\u6536\u4ef6\u4eba\r\nfunction onShowAllResouce(obj, event) {\r\n    var target = $(obj).parents(\"ul\").attr(\"target\");\r\n    if ($(obj).is(':checked')) {\r\n        addToInput(target, \"".toCharArray();
    _jsp_string48 = "\";\r\ndoCheckusb();\r\n</script>\r\n".toCharArray();
    _jsp_string170 = "</label>\r\n                            </div>\r\n                            <div class=\"left p-l-15 color666\">\r\n                                <input class=\" p-r-5\" type=\"checkbox\" name='timeSetting' id=\"timeSetting\" value=\"1\" onclick=\"showTimeSetting(this)\"><label> ".toCharArray();
    _jsp_string94 = "notBeauty=true ".toCharArray();
    _jsp_string222 = "';\r\nKindEditor.plugin('sign', function(K) {\r\n    var self = this, name = 'sign';\r\n    self.clickToolbar(name, function() {\r\n        var menu = self.createMenu({\r\n                name : 'sign',\r\n                width : 150\r\n            });\r\n        ".toCharArray();
    _jsp_string293 = "</div>\");\r\n                    }\r\n            });\r\n            /* $(obj).parent().next().load(\"/email/new/MailAddContactsTree.jsp\"+t_str,function(data){\r\n                   $('.contactsItem').hover(\r\n                        function () {\r\n                          $(this).addClass(\"contactsItemOver\");\r\n                        }, \r\n                        function () {\r\n                            $(this).removeClass(\"contactsItemOver\");\r\n                        }\r\n                );\r\n            }); */\r\n            \r\n            if (event.stopPropagation) { \r\n                event.stopPropagation(); \r\n            } \r\n            else { \r\n                window.event.cancelBubble = true; \r\n            }\r\n        return false;\r\n}\r\n//\u663e\u793a\u6216\u7740\u9690\u85cf\u8054\u7cfb\u4eba\u5217\u8868\r\nfunction showOrHideContactList(himself,_pagenum) {\r\n    if($(himself).parent().find(\".contactsGroupContent\").children().length<1){\r\n        //$(himself).find(\".contactsGroupContent\").load()\r\n        var keyword =encodeURI($(\"#fromSearch\").val())\r\n        var groupid=$(himself).attr(\"groupid\");\r\n        $(himself).parent().find(\".contactsGroupContent\").load(\"/email/new/MailAddContactsTree.jsp?groupid=\"+groupid+\"&onlyNum=\"+_pagenum+\"&keyword=\"+keyword,function(data){\r\n            $('.contactsItem').hover(\r\n                function () {\r\n                  $(this).addClass(\"contactsItemOver\");\r\n                }, \r\n                function () {\r\n                    $(this).removeClass(\"contactsItemOver\");\r\n                }\r\n            );\r\n        });\r\n    }\r\n    $(himself).next(\"#customGroup\").toggle();\r\n    $(himself).find(\"b\").each(function(){\r\n        if($(this).hasClass(\"hide\")) {\r\n            $(this).removeClass(\"hide\");\r\n        } else {\r\n            $(this).addClass(\"hide\");\r\n        }\r\n    });\r\n}\r\n\r\n//\u90ae\u4ef6\u7c7b\u578b\u5207\u6362\r\n$(\"#isInternal\").click(function(){\r\n})\r\n\r\nfunction changeMailType(mailType) {\r\n    removeEditor(\"mouldtext\");\r\n    switch (mailType) {\r\n        case 0:\r\n            //\u5916\u90e8\u90ae\u4ef6\r\n            //$(\"#contatctsTab\").trigger(\"select\");\r\n            $(\"#internalContacter\").hide();\r\n            $(\"#outerContacter\").show().find(\".tab:first\").click();\r\n            $(\"#InternalMail\").hide();\r\n            $(\"#ExternalMail\").show();\r\n            //$(\"#miniToolBar\").show();\r\n            $(\"#sendFromDiv\").show();\r\n            $(\"#sendInternalFromDiv\").hide();\r\n            $(\"#addsrz\").hide();\r\n            highEditor(\"mouldtext\", editorHeight, 0);\r\n            currentInputId = \"to\";\r\n            break;\r\n        case 1:\r\n            //\u5185\u90e8\u90ae\u4ef6\r\n            //$(\"#hrmOrgTab\").trigger(\"select\");\r\n            $(\"#internalContacter\").show();\r\n            $(\"#internalContacter\").show().find(\".tab:first\").click();\r\n            $(\"#outerContacter\").hide();\r\n            $(\"#InternalMail\").show();\r\n            $(\"#ExternalMail\").hide();\r\n            //$(\"#miniToolBar\").hide();\r\n            $(\"#sendFromDiv\").hide();\r\n            $(\"#sendInternalFromDiv\").show();\r\n            $(\"#addsrz\").show();\r\n            highEditor(\"mouldtext\", editorHeight, 1)\r\n            currentInputId = \"internalto\";\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n    initToolBarStatus();\r\n}\r\n\r\nfunction checkinput(elementname, spanid) {\r\n    var tmpvalue = $GetEle(elementname).value;\r\n    // \u5904\u7406$GetEle\u53ef\u80fd\u627e\u4e0d\u5230\u5bf9\u8c61\u65f6\u7684\u60c5\u51b5\uff0c\u901a\u8fc7id\u67e5\u627e\u5bf9\u8c61\r\n    if (tmpvalue == undefined) {\r\n        tmpvalue = document.getElementById(elementname).value;\r\n    }\r\n    while (tmpvalue.indexOf(\" \") >= 0) {\r\n        tmpvalue = tmpvalue.replace(\" \", \"\");\r\n    }\r\n    if (tmpvalue != \"\") {\r\n        while (tmpvalue.indexOf(\"\\r\\n\") >= 0) {\r\n            tmpvalue = tmpvalue.replace(\"\\r\\n\", \"\");\r\n        }\r\n        if (tmpvalue != \"\") {\r\n            $GetEle(spanid).innerHTML = \"\";\r\n        } else {\r\n            $GetEle(spanid).innerHTML = \"<IMG src='/images/BacoError_wev8.gif' align=absMiddle>\";\r\n            //$GetEle(elementname).value = \"\";\r\n        }\r\n    } else {\r\n        $GetEle(spanid).innerHTML = \"<IMG src='/images/BacoError_wev8.gif' align=absMiddle>\";\r\n        //$GetEle(elementname).value = \"\";\r\n    }\r\n}\r\n\r\nfunction doDelAccFile(fileid) {\r\n    for (var i = 0; i < fileIdArr.length; i++) {\r\n        var comId = fileIdArr[i];\r\n        if (comId.indexOf(fileid) == -1) {\r\n            continue;\r\n        }\r\n        var id = jQuery.trim(comId.substring(comId.lastIndexOf(\"-\") + 1));\r\n        doDelAcc(id);\r\n        break;\r\n    }\r\n}\r\n\r\nfunction doDelAcc(id) {\r\n    var fileid = jQuery(\"#fileid\").val();\r\n    if (-1 != fileid.indexOf(id)) {\r\n        fileid = fileid.replace(\",\" + id + \",\", \",\");\r\n        jQuery(\"#fileid\").val(fileid);\r\n        jQuery(\"#\" + id).remove();\r\n        return;\r\n    }\r\n    var ids = jQuery(\"#accids\").val() + \",\";\r\n    ids = ids.replace(\",\" + id + \",\", \",\")\r\n    jQuery(\"#accids\").val(ids);\r\n    jQuery(\"#\" + id).remove();\r\n    var delids = jQuery(\"#delaccids\").val();\r\n    if (delids != \"\") {\r\n        delids = delids + \",\" + id;\r\n    } else {\r\n        delids = id;\r\n    }\r\n    jQuery(\"#delaccids\").val(delids);\r\n    getFileSize(); //\u83b7\u53d6\u603b\u7684\u9644\u4ef6\u5927\u5c0f\r\n    setUploadInfo();\r\n}\r\n\r\n$.fn.enable_changed_form_confirm = function() {\r\n    var _f = this;\r\n    $(':text, :password, textarea', this).each(function() {\r\n        $(this).attr('_value', $(this).val());\r\n    });\r\n    $(':checkbox, :radio', this).each(function() {\r\n        var _v = this.checked ? 'on' : 'off';\r\n        $(this).attr('_value', _v);\r\n    });\r\n    $('select', this).each(function() {\r\n        if (this.options.length > 0) {\r\n            $(this).attr('_value', this.options[this.selectedIndex].value);\r\n        }\r\n    });\r\n    $(this).submit(function() {\r\n        window.onbeforeunload = null;\r\n    });\r\n    window.onbeforeunload = function() {\r\n        //doSave($('#savebtn'));\r\n        //\u63d0\u9192\u4fdd\u5b58\r\n        if (is_form_changed(_f)) {\r\n            return \"".toCharArray();
    _jsp_string38 = "\");\r\n						}else{\r\n							window.top.Dialog.alert(\"".toCharArray();
    _jsp_string108 = "</option>\r\n                                                    ".toCharArray();
    _jsp_string212 = "' != '') {\r\n            $(\"#addCc\").trigger(\"click\");\r\n        } else {\r\n            if ('".toCharArray();
    _jsp_string157 = "</span>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <div style=\"float: none;\" class=\"color666 p-t-10\">\r\n                                    <span id=\"uploadInfo\"></span>\r\n                                </div>\r\n                                \r\n                                <div class=\"color666  w-500 p-t-5 left \">\r\n                                        ".toCharArray();
    _jsp_string309 = "\");  \r\n    }\r\n});\r\n</script>\r\n\r\n".toCharArray();
    _jsp_string43 = "\";\r\n\r\n  if(companyname.length >0 ){\r\n  	window.status = str1+companyname;\r\n  }\r\n</script>\r\n<!-- \u5220\u9664 -->\r\n</head></html>\r\n\r\n<!--USB \u9a8c\u8bc1 -->\r\n".toCharArray();
    _jsp_string177 = "</div>\r\n                                <div class=\"clear\"></div>   \r\n                            </div>\r\n                            <div id=\"outerContacter\" style=\"display:none;\">\r\n                                <div id=\"innerContacterTab\" style=\"\" class=\"left tab tabSelected tabitem2\" target=\"innerHrmContent\">".toCharArray();
    _jsp_string114 = ">\r\n                                <div id=\"inputTo\" class=''>\r\n                                    <div class=\" importInternalBtn hand w-60 p-t-5 left\" target=\"internaltoDiv\">\r\n                                        <div class=\"left \">".toCharArray();
    _jsp_string54 = "\r\n<!--For wui-->\r\n<link type='text/css' rel='stylesheet'  href='/wui/theme/".toCharArray();
    _jsp_string287 = "\"); //\u90ae\u4ef6\u5730\u5740\u683c\u5f0f\u9519\u8bef\r\n        return false;\r\n    }\r\n}\r\n\r\nfunction validateMailAddress(str) {\r\n    var valid = true;\r\n    var arr = str.split(\",\");\r\n    for (var i = 0; i < arr.length; i++) {\r\n        var a = arr[i];\r\n        var pos1 = a.indexOf(\"<\");\r\n        var pos2 = a.lastIndexOf(\">\");\r\n        if (pos1 != -1 && pos2 != -1) {\r\n            if (!checkEmail($.trim(a.substring(pos1 + 1, pos2)))) {\r\n                valid = false;\r\n                break;\r\n            }\r\n        } else {\r\n            if (!checkEmail($.trim(a))) {\r\n                valid = false;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return valid;\r\n}\r\n\r\nfunction checkEmail(emailStr) {\r\n    if (emailStr.length == 0) {\r\n        return true;\r\n    }\r\n    var emailPat = /^(.+)@(.+)$/;\r\n    var specialChars = \"\\\\(\\\\)<>@,;:\\\\\\\\\\\\\\\"\\\\.\\\\[\\\\]\";\r\n    var validChars = \"\\[^\\\\s\" + specialChars + \"\\]\";\r\n    var quotedUser = \"(\\\"[^\\\"]*\\\")\";\r\n    var ipDomainPat = /^(\\d{1,3})[.](\\d{1,3})[.](\\d{1,3})[.](\\d{1,3})$/;\r\n    var atom = validChars + '+';\r\n    var word = \"(\" + atom + \"|\" + quotedUser + \")\";\r\n    var userPat = new RegExp(\"^\" + word + \"(\\\\.\" + word + \")*$\");\r\n    var domainPat = new RegExp(\"^\" + atom + \"(\\\\.\" + atom + \")*$\");\r\n    var matchArray = emailStr.match(emailPat);\r\n    if (matchArray == null) {\r\n        return false;\r\n    }\r\n    var user = matchArray[1];\r\n    var domain = matchArray[2];\r\n    if (user.match(userPat) == null) {\r\n        return false;\r\n    }\r\n    var IPArray = domain.match(ipDomainPat);\r\n    if (IPArray != null) {\r\n        for (var i = 1; i <= 4; i++) {\r\n            if (IPArray[i] > 255) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    var domainArray = domain.match(domainPat);\r\n    if (domainArray == null) {\r\n        return false;\r\n    }\r\n    var atomPat = new RegExp(atom, \"g\");\r\n    var domArr = domain.match(atomPat);\r\n    var len = domArr.length;\r\n    if ((domArr[domArr.length - 1].length < 0) || (domArr[domArr.length - 1].length > 50)) {\r\n        return false;\r\n    }\r\n    if (len < 2) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\n/**\r\n * \u6dfb\u52a0\u90ae\u4ef6\u7b7e\u540d\r\n */\r\nfunction setMailSign(signid) {\r\n    if (signid == \"\") {\r\n        return false;\r\n    }\r\n    var htmlstr = jQuery(\"#signContent_\" + signid).html();\r\n    if(KE.g[\"mouldtext\"].designMode) {\r\n        KE.insertHtml(\"mouldtext\", htmlstr);\r\n    } else {\r\n        window.top.Dialog.alert(\"".toCharArray();
    _jsp_string107 = "\" ".toCharArray();
    _jsp_string84 = ">\r\n                                        <p class=\"field switch\">\r\n                                        ".toCharArray();
    _jsp_string248 = "\",\r\n        file_queue_limit : \"0\",\r\n        // Button Settings\r\n        button_placeholder_id : \"spanButtonPlaceholder\",\r\n        button_width: 70,\r\n        button_height: 20,\r\n        button_text:\"<div class='theFont' style='cursor:pointer;color:#666'>".toCharArray();
    _jsp_string290 = "\")) {\r\n            if (mailTemplateId == 0) { //\u6e05\u7a7a\u6a21\u677f\u5185\u5bb9\r\n                KE.insertHtml(\"mouldtext\", \"\"); //\u6e05\u7a7a\u7f16\u8f91\u5668\u5185\u5bb9\r\n                return false;\r\n            }\r\n            $.ajax({\r\n                url: '/email/MailTemplateTemp.jsp?id=' + mailTemplateId + '&templateType=' + mailTemplateType + '&userId=".toCharArray();
    _jsp_string308 = "\" + temptitle;\r\n                window.top.Dialog.alert(msg);\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction keyDownDelete(obj, event) {\r\n    try {\r\n        if (event.keyCode != 8) {\r\n            return;\r\n        }\r\n        if ($(obj).val() == '') {\r\n            if ($(obj).parent().prev().length > 0) {\r\n                if ($(obj).parent().prev().parent()[0].clientWidth < $(obj).parent().prev().parent()[0].offsetWidth - 4) {\r\n                    //\u6267\u884c\u76f8\u5173\u811a\u672c\u3002   \r\n                } else {\r\n                    $(obj).parent().prev().parent().removeClass(\"mailInputOverDisplay\");\r\n                }\r\n            }\r\n            $(obj).parent().prev().remove();\r\n        }\r\n        if (event.stopPropagation) {\r\n            // this code is for Mozilla and Opera \r\n            event.stopPropagation();\r\n        } else if (window.event) {\r\n            // this code is for IE \r\n            window.event.cancelBubble = true;\r\n        }\r\n    } catch (e) {\r\n    }\r\n}\r\n\r\nfunction reflashHrmTree(obj) {\r\n    var isaccount = 0;\r\n    if($('#showaccounthrm').is(':hidden')){\r\n        $('#showaccounthrm').show();\r\n        $('#hideaccounthrm').hide();\r\n        isaccount = 0;\r\n    }else{\r\n        $('#showaccounthrm').hide();\r\n        $('#hideaccounthrm').show();\r\n        isaccount = 1; \r\n    }\r\n    \r\n    $(\"#innerHrmTree\").remove();\r\n        $(\"#innerHrmContent\").append(\"<ul id='innerHrmTree' style='width: 100%'></ul>\");\r\n        \r\n        $(\"#innerHrmTree\").addClass(\"hrmOrg\"); \r\n        $(\"#innerHrmTree\").treeview({\r\n           url:\"/email/new/hrmOrgTree.jsp?operation=innerHrm&isaccount=\"+isaccount\r\n     });\r\n}\r\n\r\njQuery(function(){\r\n    if(".toCharArray();
    _jsp_string193 = "\r\n    .cb-enable, .cb-disable, .cb-enable span, .cb-disable span { /*background: url(/email/images/switch_wev8.gif) repeat-x;*/ display: block; float: left; }\r\n    .cb-enable span, .cb-disable span { line-height: 25px; display: block; background-repeat: no-repeat; font-weight: bold; }\r\n    .cb-enable span { background-position: left -75px; padding: 0 10px; }\r\n    .cb-disable span { background-position: right -150px;padding: 0 10px; }\r\n    .cb-disable.selected { background-position: 0 -25px; }\r\n    .cb-disable.selected span { background-position: right -175px; color: #fff; }\r\n    .cb-enable.selected { background-position: 0 -50px; }\r\n    .cb-enable.selected span { background-position: left -125px; color: #fff; }\r\n    .switch label { cursor: pointer; }\r\n    ".toCharArray();
    _jsp_string104 = " w-150 left\">\r\n                                        ".toCharArray();
    _jsp_string218 = "' != '') {\r\n            $(\"#addBcc\").trigger(\"click\")\r\n        } else {\r\n            $(\"#delBcc\").trigger(\"click\")\r\n        }\r\n    }\r\n}\r\n\r\nfunction openBlog(type,id,name,obj){\r\n    isdb=false;\r\n    var div = $(\".mailInput[target='\"+currentInputId+\"']\");\r\n    var tabType=$(\"#tabTitle .tabSelected\").attr(\"id\");\r\n    if(tabType==\"privateTab\"){  \r\n        if(type==0){\r\n            //\u6dfb\u52a0\u7ec4\r\n             $.post(\"/email/new/hrmOrgTree.jsp?root=\"+id,\"\",function(data){\r\n              });\r\n              stopEvent();\r\n        }else{\r\n             addToInput(div.attr(\"id\"),name+\"|\"+id)\r\n        }\r\n    }else{\r\n        var hrmtype=id;\r\n        var objid=type;\r\n        addHrmOrgMail(hrmtype,objid);\r\n    }   \r\n}\r\n\r\nfunction dblclickTree(type, id, name, obj) {\r\n    isdb = true;\r\n    var div = $(\".mailInput[target='\" + currentInputId + \"']\");\r\n    var tabType = $(\"#tabTitle .tabSelected\").attr(\"id\");\r\n    if (tabType == \"privateTab\") {\r\n        if (type == 0) {\r\n            //\u6dfb\u52a0\u7ec4\r\n            $.post(\"/email/new/hrmOrgTree.jsp?root=\" + id, \"\", function(data) {\r\n                $.each(data, function(idx, item) {\r\n                    addToInput(div.attr(\"id\"), item.text + \"|\" + item.id + \"|\" + item.dpid)\r\n                });\r\n            });\r\n        } else {\r\n            addToInput(div.attr(\"id\"), name + \"|\" + id)\r\n        }\r\n    } else {\r\n        var hrmtype = id;\r\n        var objid = type;\r\n        dblclickHrmTree(hrmtype, objid);\r\n    }\r\n}\r\n\r\nfunction addResourceMail(obj){\r\n    var hrmtype=$(obj).attr(\"_orgType\");\r\n    var objid=$(obj).attr(\"_objid\");\r\n    addHrmOrgMail(hrmtype,objid);\r\n}\r\n\r\nfunction addHrmOrgMail(hrmtype,objid){\r\n    var div = $(\".mailInput[target='\"+currentInputId+\"']\");\r\n    var tabType=$(\"#tabTitle .tabSelected\").attr(\"id\");\r\n    //\u4eba\u529b\u8d44\u6e90\u6811 type\u8868\u793aid id\u8868\u793a\u7c7b\u578b\r\n    stopEvent();\r\n}\r\n\r\nfunction dblclickHrmTree(hrmtype,objid) { \r\n    var div = $(\".mailInput[target='\"+currentInputId+\"']\");\r\n    var tabType=$(\"#tabTitle .tabSelected\").attr(\"id\");\r\n    \r\n    $.post(\"/email/new/hrmOrgTree.jsp?operation=getHrm&hrmtype=\"+hrmtype+\"&objid=\"+objid,\"\",function(data){\r\n        if(tabType==\"innerHrmTab\"){\r\n            if(data.length>500){\r\n                alert(\"".toCharArray();
    _jsp_string165 = "\r\n                                        <input type=\"checkbox\"  name=\"priority\" id=\"priority\" value=\"1\">\r\n                                    ".toCharArray();
    _jsp_string179 = "</div> \r\n                                <div class=\"clear\"></div>\r\n                            </div>\r\n                            <div class=\"clear\"></div>\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                        <div class=\"tabContent  h-all\" id=\"contactsContent\">\r\n                            <div class=\"p-l-10 p-t-10 relative\" id=\"searchBar\">\r\n                                <input class=\"w-150 \" type=\"text\" id=\"fromSearch\" > \r\n                                <div id=\"searchBtn\" class=\"searchFrom\"></div>\r\n                                \r\n                                <div id=\"addFrom\" href=\"#contactAdd\" style=\"font-size:20px;top:5px;\" class=\"addFrom\"  title=\"".toCharArray();
    _jsp_string87 = "</span></label>\r\n                                        <label class=\"cb-disable ".toCharArray();
    _jsp_string19 = "&time=\"+new Date()+\"&f_weaver_belongto_userid=".toCharArray();
    _jsp_string99 = "\">".toCharArray();
    _jsp_string227 = "\";\r\n            dialog.Width = 800;\r\n            dialog.Height = 495;\r\n            dialog.Drag = true;\r\n            dialog.URL = url;\r\n            dialog.show();\r\n        }\r\n    });\r\n});\r\n\r\n/**\u5c01\u88c5\u6a21\u677f\u63d2\u4ef6**/\r\nKindEditor.zh_cn_lang.doc = '".toCharArray();
    _jsp_string129 = "\">\r\n                                        <input class=\"mailInputHide\" width=\"20\" style=\"width: 20\" type=\"hidden\" relid=\"internalcc\" name=\"internalccdpid\" id=\"internalccdpid\" value=\"".toCharArray();
    _jsp_string168 = "</label>\r\n                            </div>\r\n                            \r\n                            <div class=\"left p-l-15 color666\">\r\n                                <input class=\" p-r-5\" type=\"checkbox\" name='texttype' id=\"texttype\" value=\"1\" onclick=\"changeHTMLEditor(this)\"><label>".toCharArray();
    _jsp_string16 = "');\r\n}\r\n\r\nfunction _onViewLog(operateitem,sqlwhere,id){\r\n	if(!sqlwhere)sqlwhere = \"\";\r\n	var dialog = new window.top.Dialog();\r\n	dialog.currentWindow = window;\r\n	dialog.Title = \"".toCharArray();
    _jsp_string305 = "\"){\r\n        changeCheckboxStatus_1_8_3(jQuery(\"#needReceipt\")[0],true);\r\n    }\r\n    if(\"\"!=\"".toCharArray();
    _jsp_string68 = "\r\n<html>\r\n<body  style=\"overflow: auto;\">\r\n<form name=\"mailAddForm\" id=\"mailAddForm\" method=\"post\" action=\"/email/MailOperationSend.jsp\" enctype=\"multipart/form-data\">\r\n<input type=\"hidden\" name=\"accids\" id=\"accids\" value=\"".toCharArray();
    _jsp_string18 = "\";\r\n		}\r\n	}\r\n	dialog.Width = jQuery(window).width();\r\n	dialog.Height = 610;\r\n	dialog.Drag = true;\r\n	dialog.checkDataChange = false;\r\n	dialog.maxiumnable = true;\r\n	dialog.URL = url;\r\n	dialog.show();\r\n}\r\n\r\n\r\nfunction check_form(thiswins,items)\r\n{\r\n	/* added by cyril on 2008-08-14 for td:8521 */\r\n	var isconn = false;\r\n	try {\r\n		var xmlhttp;\r\n	    if (window.XMLHttpRequest) {\r\n	    	xmlhttp = new XMLHttpRequest();\r\n	    }  \r\n	    else if (window.ActiveXObject) {\r\n	    	xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\");  \r\n	    }\r\n	    var URL = \"/systeminfo/CheckConn.jsp?userid=".toCharArray();
    _jsp_string150 = "\r\n                                    <div class=\"color666  w-500 p-t-5 left\">\r\n                                    <input class=\"mailInputHide \" style=\"width: 90%\" type=\"hidden\" name=\"cc\" id=\"cc\" value=\"".toCharArray();
    _jsp_string117 = "\r\n                                        <input class=\"mailInputHide\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internalto\" id=\"internalto\" value=\"".toCharArray();
    _jsp_string285 = "\")\r\n            return false;\r\n        }\r\n        var swfu = $.swfupload.getInstance('.swfupload-control');\r\n        if (swfu.getStats().files_queued > 0) {\r\n            swfu.setButtonDisabled(true);\r\n            swfu.startUpload();\r\n        } else {\r\n            showLoading('saveing');\r\n            obj.disabled=true;\r\n            jQuery(\"#mailAddForm\").submit();\r\n        }\r\n    }\r\n}\r\n\r\nfunction autoSave(obj){\r\n    if($(\"#subject\").val() == \"\" && $(\"#mouldtext\").val() == \"\")\r\n        return;\r\n    setinputdatetime();\r\n    obj.disable=true;\r\n    \r\n    $(\"#savedraft\").val(\"1\");\r\n    $(\"#folderid\").val(\"-2\");\r\n    $(\"#autoSave\").val(\"1\");\r\n    \r\n    getRealMailAddress();\r\n    \r\n    if($(\"#isInternal\").is(':checked')){\r\n            var swfu = $.swfupload.getInstance('.swfupload-control');\r\n            if(swfu.getStats().files_queued >0){\r\n                swfu.setButtonDisabled(true);\r\n                swfu.startUpload();\r\n            }else{\r\n                jQuery.ajax({\r\n                    url: '/email/MailOperationSend.jsp',\r\n                    data: $('#mailAddForm').serialize(),\r\n                    type: \"POST\",\r\n                    success: function(data) {\r\n                        var mailid = $.trim(data);\r\n                        $(\"#mailid\").val(mailid);   \r\n                        $(\"#flag\").val('4');\r\n                    }\r\n                });\r\n            }\r\n    }else{\r\n        if($(\".mailAdError\").length>0){\r\n            window.top.Dialog.alert(\"".toCharArray();
    _jsp_string12 = "\r\n<!-- js \u6574\u5408\u5230 init_wev8.js -->\r\n<script type=\"text/javascript\" src=\"/js/jquery.table_wev8.js\"></script>\r\n<script language=\"javascript\" type=\"text/javascript\" src=\"/js/init_wev8.js\"></script>\r\n<script language=\"javascript\"  src=\"/js/wbusb_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/jquery/plugins/client/jquery.client_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/ecology8/jNice/jNice/jquery.jNice_wev8.js\"></script>\r\n<script type='text/javascript' src='/js/jquery-autocomplete/jquery.autocomplete_wev8.js'></script>\r\n<script type='text/javascript' src='/js/jquery-autocomplete/browser_wev8.js'></script>\r\n<script language=javascript src=\"/wui/theme/ecology8/jquery/js/zDialog_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/ecology8/request/hoverBtn_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/ecology8/lang/weaver_lang_".toCharArray();
    _jsp_string132 = "\">\r\n                                        <input class=\"\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internalcchrmdpid\" id=\"internalcchrmdpid\" value=\"".toCharArray();
    _jsp_string154 = "</div>\r\n                                <div class=\"color666  w-500 p-t-5 left\">\r\n                                    <input class=\"w-500 inputdiv mailInput\" type=\"text\" style=\"height:28px; line-height:28px; width:502px; padding: 0px;\" id=\"subject\" name=\"subject\" maxlength=\"600\" value=\"".toCharArray();
    _jsp_string74 = "\r\n    <input type=\"hidden\" name=\"mailid\" id=\"mailid\" value=\"".toCharArray();
    _jsp_string266 = "\"); //\u9644\u4ef6\u4e0a\u4f20\u5931\u8d25\uff0c\u4ec5\u652f\u6301IE\u548cchrome\u6d4f\u89c8\u5668\uff0c\u540c\u65f6\u8bf7\u66f4\u65b0flash\u63d2\u4ef6!\r\n            }else {\r\n                html += \"<a style='margin-left: 15px; !important' href=\\\"javascript:openfile('\"+fileSid+\"',0)\\\" >".toCharArray();
    _jsp_string56 = "/wui_wev8.css'/>\r\n".toCharArray();
    _jsp_string152 = "</div>\r\n                                        <div class=\" left  relative   \" id=\"addMailsBtn\" style=\"width: 20px;;\">\r\n                                            <img class=\"absolute\" style=\"top:7px;left:5px\" src=\"/email/images/iconDArr_wev8.png\"/>\r\n                                        </div>\r\n                                        \r\n                                        <div class=\"clear\"></div>\r\n                                    </div>\r\n                                    <div class=\"color666  w-500 p-t-5 left\">\r\n                                    <input class=\"mailInputHide\" style=\"width: 90%\" type=\"hidden\"  name=\"bcc\" id=\"bcc\" value=\"".toCharArray();
    _jsp_string171 = "</label>\r\n                                <span class=\" p-l-15\" id=\"timeSettingSpan\">\r\n                                    <button class=\"calendar\" id=\"SelectDate\" onclick=\"getDate('datespan','date')\" type=\"button\"></button>\r\n                                    <SPAN id=\"datespan\">".toCharArray();
    _jsp_string91 = " p-l-10".toCharArray();
    _jsp_string140 = "\">\r\n                                        <input class=\"\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internalbcchrmdpid\" id=\"internalbcchrmdpid\" value=\"".toCharArray();
    _jsp_string78 = "</div>\r\n                                            <div id=\"delCc\" class=\"left\" style=\"text-align:center;width:100%\">".toCharArray();
    _jsp_string178 = "</div>\r\n                                <div id=\"customTab\" class=\"left tab  tabUnSelected tabitem2\" target=\"contactsContent\">".toCharArray();
    _jsp_string121 = "\">\r\n                                        <input class=\"\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internaltohrmname\" id=\"internaltohrmname\" value=\"".toCharArray();
    _jsp_string100 = "\r\n                                                                    <option value=\"".toCharArray();
    _jsp_string118 = "\" temptitle=\"".toCharArray();
    _jsp_string268 = "\";\r\n    dialogfile.Width = 800;\r\n    dialogfile.Height = 600;\r\n    dialogfile.maxiumnable=true;\r\n    dialogfile.Drag = true;\r\n    dialogfile.URL = \"/email/MailPreView.jsp?fileid=\"+fileid+\"&mailid=\"+mailid;\r\n    dialogfile.show();\r\n*/\r\n    window.open(\"/docs/view/imageFileView.jsp?fileid=\"+fileid);\r\n}\r\n\r\nvar autoChangeSubject = ".toCharArray();
    _jsp_string246 = "\"+(totalSize/(1024*1024)).toFixed(2)+\"MB\uff09\");\r\n    } \r\n}\r\n\r\n$(function(){\r\n\r\n    $('.swfupload-control').swfupload({\r\n        // Backend Settings\r\n        upload_url: \"/email/new/uploader.jsp\",    // Relative to the SWF file (or you can use absolute paths)\r\n        // File Upload Settings\r\n        // file_size_limit : \"".toCharArray();
    _jsp_string203 = "!\")\r\n    //return false;\r\n    //}\r\n    //\u5224\u65ad\u8f93\u5165\u6846\u7c7b\u578b\uff0c\u4eba\u529b\u8d44\u6e90\u6216\u90ae\u4ef6\u5730\u5740\r\n    if (div.attr(\"type\") == \"hrm\") {\r\n        if (input == undefined) { // \u7531\u6d4f\u89c8\u6846\u6279\u91cf\u5bfc\u5165\r\n            if (name != \"\") {\r\n                var list = name.split(\"|\");\r\n                if ($(div).find(\".mailAdItem[dpid='\" + list[2] + \"'][value='\" + list[1] + \"']\").length > 0) { // \u8fc7\u6ee4\u91cd\u590d\u7684\u4eba\u5458\uff0c\u90e8\u95e8\u6570\u636e\r\n                    return;\r\n                }\r\n                if (parseInt(list[1]) > 0 && $(div).find(\".mailAdItem[value='\" + list[1] + \"']\").length > 0) {\r\n                    return;\r\n                }\r\n\r\n                var html;\r\n                if (list[1] == '0') { // \u4eba\u5458ID\u4e3a0,\u5373\u4e3a\u90e8\u95e8\u4fe1\u606f\r\n                    html = $(\"<div class='mailAdItem mailAdOK' unselectable='on' dpid='\" + list[2] + \"'  value='\" + list[1] + \"' title='\" + list[0] + \"'><span onmouseover='mailOver(this)'  onmouseleave='mailLeave(this)' onblur='mailUnselect(this)' onclick='selectMail(this,event)'>\" + list[0] + \"<em class='hand closeLb'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em></span></div>\");\r\n                } else {\r\n                    html = $(\"<div class='mailAdItem mailAdOK' unselectable='on' dpid='\" + list[2] + \"' value='\" + list[1] + \"' title='\" + list[0] + \"'><span onmouseover='mailOver(this)'  onmouseleave='mailLeave(this)' onblur='mailUnselect(this)' onclick='selectMail(this,event)'>\" + list[0] + \"<em class='hand closeLb'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em></span></div>\");\r\n                }\r\n                //\u6e05\u9664\u6d6e\u52a8\u5c42clear\u6837\u5f0f\r\n                div.find(\".clear\").remove();\r\n                div.append(html);\r\n            }\r\n            autoDivHeight(div)\r\n        } else { // \u81ea\u52a8\u8054\u60f3\u8f93\u5165\r\n            if (name != \"\") {\r\n                if ($(input).attr(\"selected\") == \"true\" || $(input).attr(\"selected\") == \"selected\") {\r\n                    var list = name.split(\"|\")\r\n                    if ($(div).find(\".mailAdItem[dpid='\" + list[2] + \"'][value='\" + list[1] + \"']\").length > 0) { // \u8fc7\u6ee4\u91cd\u590d\u7684\u4eba\u5458\uff0c\u90e8\u95e8\u6570\u636e\r\n                        return;\r\n                    }\r\n                    if (parseInt(list[1]) > 0 && $(div).find(\".mailAdItem[value='\" + list[1] + \"']\").length > 0) {\r\n                        return;\r\n                    }\r\n\r\n                    if (list[1] == '0') { // \u4eba\u5458ID\u4e3a0,\u5373\u4e3a\u90e8\u95e8\u4fe1\u606f\r\n                        html = $(\"<div class='mailAdItem mailAdOK' unselectable='on' dpid='\" + list[2] + \"'  value='\" + list[1] + \"' title='\" + list[0] + \"'><span onmouseover='mailOver(this)'  onmouseleave='mailLeave(this)' onblur='mailUnselect(this)' onclick='selectMail(this,event)'>\" + list[0] + \"<em class='hand closeLb'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em></span></div>\");\r\n                    } else {\r\n                        html = $(\"<div class='mailAdItem mailAdOK' unselectable='on' dpid='\" + list[2] + \"'  value='\" + list[1] + \"' title='\" + list[0] + \"'><span onmouseover='mailOver(this)'  onmouseleave='mailLeave(this)' onblur='mailUnselect(this)' onclick='selectMail(this,event)'>\" + list[0] + \"<em class='hand closeLb'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em></span></div>\");\r\n                    }\r\n                    //\u6e05\u9664\u6d6e\u52a8\u5c42clear\u6837\u5f0f\r\n                    div.find(\".clear\").remove();\r\n                    if ($(input).parent().prev().length > 0) {\r\n                        html.insertAfter($(input).parent().prev());\r\n                    } else if ($(input).parent().next().length > 0) {\r\n                        html.insertBefore($(input).parent().prev());\r\n                    } else {\r\n                        div.append(html);\r\n                    }\r\n                }\r\n            }\r\n            autoDivHeight(div)\r\n            input.value = \"\";\r\n            div.focus();\r\n            try { $(input).parent().remove(); } catch(e) {}\r\n            div.click();\r\n        }\r\n\r\n    } else {\r\n        if (input == undefined) { // \u7531\u6d4f\u89c8\u6846\u6279\u91cf\u5bfc\u5165\r\n            //name \u683c\u5f0f\u4e3a xxxx<yyyyy@yyy.com>\uff0c\u9700\u8981\u5904\u7406\uff0c\u83b7\u53d6\u5730\u5740\u548c\u540d\u79f0\r\n            //var re = /([0-9A-Za-z\\-_\\.]+)@([\\s\\S]+\\.[a-z]{2,3}(\\.[a-z]{2})?)/gi;  // \u8fd9\u79cd\u5339\u914d\u65b9\u5f0f\u5bf9xx@xx<xx@xx>\u5f62\u5f0f\u7684\u5730\u5740\u4e0d\u884c\r\n            var re = /([\\w\\-\\.]+@[\\w\\-\\.]+(\\.\\w+)+?)/gi;\r\n            var tmpemail = name.match(re); // \u90ae\u4ef6\u5730\u5740\r\n            if (tmpemail.length - 1 > 0) {\r\n                tmpemail = tmpemail[tmpemail.length - 1]\r\n            }\r\n\r\n            if ($(div).find(\".mailAdItem[title='\" + tmpemail + \"']\").length > 0) { // \u8fc7\u6ee4\u91cd\u590d\u7684\u90ae\u7bb1\u6570\u636e\r\n                return;\r\n            }\r\n            var tmpname = name.replace(\"<\" + tmpemail + \">\", \"\") // \u540d\u79f0\r\n\r\n            var classname = '';\r\n            var validate = /^[\\w\\-\\.]+@[\\w\\-\\.]+(\\.\\w+)+$/;\r\n            if (!validate.test(tmpemail)) {\r\n                classname = 'mailAdError'\r\n            } else {\r\n                classname = 'mailAdOK'\r\n            }\r\n            if (tmpemail != \"\") {\r\n                var html = $(\"<div class='mailAdItem \" + classname + \"' unselectable='on' title='\" + tmpemail + \"'><span onmouseover='mailOver(this)'  onmouseleave='mailLeave(this)' onblur='mailUnselect(this)' onclick='selectMail(this,event)'>\" + tmpname + \"&lt;\" + tmpemail + \"&gt;<em class='hand closeLb'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em></span></div>\");\r\n                //\u6e05\u9664\u6d6e\u52a8\u5c42clear\u6837\u5f0f\r\n                div.find(\".clear\").remove();\r\n                div.append(html);\r\n            } else {\r\n                window.top.Dialog.alert(\"".toCharArray();
    _jsp_string204 = "\"); // \u90ae\u4ef6\u5730\u5740\u4e0d\u5b58\u5728\r\n            }\r\n            autoDivHeight(div)\r\n\r\n        } else {\r\n            //name \u683c\u5f0f\u4e3a xxxx|yyyyy@yyy.com \uff0c\u9700\u8981\u5904\u7406\uff0c\u83b7\u53d6\u5730\u5740\u548c\u540d\u79f0\r\n            //jQuery(\"#test\").val(name+\"==\");\r\n            if(name) {\r\n            	name = name.replace(/</ig, '&lt;').replace(/>/ig, '&gt;');\r\n            }\r\n            if(name.length == 0){\r\n				return;\r\n            }\r\n            var list = name.split(\"|\")\r\n            if (list.length == 1) {\r\n                name = name + \"|\" + name;\r\n                list = name.split(\"|\")\r\n            }\r\n            var tmpemail = list[1]; // \u90ae\u4ef6\u5730\u5740\r\n            var tmpname = list[0] // \u540d\u79f0\r\n\r\n            var classname = '';\r\n            var validate = /^[\\w\\-\\.]+@[\\w\\-\\.]+(\\.\\w+)+$/;\r\n            if (!validate.test(tmpemail)) {\r\n                classname = 'mailAdError'\r\n            } else {\r\n                classname = 'mailAdOK'\r\n            }\r\n            if ($(div).find(\".mailAdItem[title='\" + tmpemail + \"']\").length > 0) { // \u8fc7\u6ee4\u91cd\u590d\u7684\u90ae\u7bb1\u6570\u636e\r\n                return;\r\n            }\r\n            if (tmpemail != \"\") {\r\n                var html = $(\"<div class='mailAdItem \" + classname + \"' unselectable='on' title='\" + tmpemail + \"'><span onmouseover='mailOver(this)'  onmouseleave='mailLeave(this)' onblur='mailUnselect(this)' onclick='selectMail(this,event)'>\" + tmpname + \"&lt;\" + tmpemail + \"&gt;<em class='hand closeLb'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em></span></div>\");\r\n                //\u6e05\u9664\u6d6e\u52a8\u5c42clear\u6837\u5f0f\r\n                div.find(\".clear\").remove();\r\n                if ($(input).parent().prev().length > 0) {\r\n                    html.insertAfter($(input).parent().prev());\r\n                } else if ($(input).parent().next().length > 0) {\r\n                    html.insertBefore($(input).parent().prev());\r\n                } else {\r\n                    div.append(html);\r\n                }\r\n            } else {\r\n                window.top.Dialog.alert(\"".toCharArray();
    _jsp_string134 = "\">\r\n                                        \r\n                                        <div class=\"inputdiv mailInput  w-500\" type=\"hrm\" id=\"internalccDiv\" target=\"internalcc\" style=\"min-height:28px; cursor: text;padding: 0px\">\r\n                                                                    \r\n                                        </div>\r\n                                    </div>\r\n                                    <div class=\"clear\"></div>\r\n                                </div>\r\n                                \r\n                                <div class='inputBcc'>\r\n                                    <div class=\" importInternalBtn hand w-60 p-t-5 left\" target=\"internalbccDiv\">\r\n                                        <div class=\"left \">".toCharArray();
    _jsp_string249 = "</div>\",\r\n        button_text_left_padding: 0,\r\n        button_text_top_padding: 3,\r\n        button_window_mode:'transparent',\r\n        button_text_style: \".theFont {font-size:12px;color:#666666;cursor:pointer;font-family:Microsoft YaHei;height:24px;}\",\r\n        button_image_url:\"/email/images/acc_wev8.png\",\r\n        button_cursor: SWFUpload.CURSOR.HAND,\r\n        // Flash Settings\r\n        flash_url : \"/email/js/swfupload/vendor/swfupload/swfupload.swf\"\r\n        \r\n    });\r\n    \r\n    // assign our event handlers\r\n    $('.swfupload-control')\r\n        .bind('fileQueued', function(event, file){\r\n            \r\n            //\u9644\u4ef6\u6570\u91cf\u9650\u5236\r\n            if(jQuery(\"input[name='fileSize']\").length >=".toCharArray();
    _jsp_string231 = "\";\r\nKindEditor.plugin('workflow', function(K) {\r\n    var self = this, name = 'workflow';\r\n    self.clickToolbar(name, function() {\r\n        openApp('workflow');\r\n    });\r\n});\r\n\r\nKindEditor.zh_cn_lang.crm = \"".toCharArray();
    _jsp_string210 = "==1) {\r\n        changeMailType(1);\r\n    } else{\r\n        changeMailType(0);\r\n    }\r\n    \r\n    \r\n    jQuery(\"#contacterTab\").css(\"height\",(document.body.offsetHeight-jQuery(\"#contacterTab\")[0].offsetTop-5)+\"px\");\r\n    jQuery(\"#hrmOrgContent\").css(\"height\",(document.body.offsetHeight-jQuery(\"#contacterTab\")[0].offsetTop-45)+\"px\");\r\n    jQuery(\"#contactsTree\").css(\"height\",(document.body.offsetHeight-jQuery(\"#contacterTab\")[0].offsetTop-90)+\"px\");\r\n    \r\n    jQuery(\"#contacterTab .tabContent\").height(jQuery(\"#contacterTab\").height()-$(\"#tabTitle\").height()-5);\r\n    \r\n    // \u521d\u59cb\u5316\u7ec4\u7ec7\u7ed3\u6784\u6811\r\n    setTimeout(function(){\r\n        $(\"#hrmOrgTree\").addClass(\"hrmOrg\"); \r\n        $(\"#hrmOrgTree\").treeview({\r\n           url:\"/email/new/hrmOrgTree.jsp?operation=private\"\r\n        });\r\n        \r\n        $(\"#innerHrmTree\").addClass(\"hrmOrg\"); \r\n        $(\"#innerHrmTree\").treeview({\r\n           url:\"/email/new/hrmOrgTree.jsp?operation=innerHrm&isaccount=0\"\r\n        });\r\n    }, 500);\r\n    \r\n    //\u6bcf\u96941\u5206\u949f\u4fdd\u5b58\u4e3a\u8349\u7a3f\r\n    /*\r\n     saveIntervalfn = setInterval(function(){\r\n        autoSave($('#savebtn'));\r\n     },20000);\r\n    */\r\n});\r\n\r\nfunction refreshTree(type) {\r\n    if(\"inner\" == type){\r\n        $(\"#hrmOrgTree\").html(\"\");\r\n        $(\"#hrmOrgTree\").treeview({\r\n           url:\"/email/new/hrmOrgTree.jsp\"\r\n        });\r\n    }else{\r\n        loadContactsTree();\r\n    }\r\n    if(diag){\r\n        diag.close();\r\n    }\r\n}\r\n\r\n//\u52a0\u8f7d\u8054\u7cfb\u4eba\u5217\u8868\r\nfunction loadContactsTree() {\r\n    var keyword = encodeURI($(\"#fromSearch\").val())\r\n    $(\"div#contactsContent div#contactsTree\").html(\"\");\r\n    $(\"div#contactsContent div#contactsTree\").load(\"/email/new/MailAddContactsGroupTree.jsp?keyword=\" + keyword, function(data) {\r\n        $(\".contactsTree-item\").hover(\r\n            function() {\r\n                $(this).find(\"span[name=SH]\").show();\r\n            }, function() {\r\n                $(this).find(\"span[name=SH]\").hide();\r\n            }\r\n        );\r\n        $('.contactsItem').hover(\r\n            function() {\r\n                $(this).addClass(\"contactsItemOver\");\r\n            }, function() {\r\n                $(this).removeClass(\"contactsItemOver\");\r\n            }\r\n        );\r\n    });\r\n}\r\n\r\n//\u521d\u59cb\u5316\u8f93\u5165\u6846\u72b6\u6001\r\nfunction initToolBarStatus() {\r\n    if ($(\"#isInternal\").is(':checked')) {\r\n        //\u8bbe\u7f6e\u63a5\u6536\u4eba\u4e3a\u4e86\u6240\u6709\u4eba\r\n        if ('".toCharArray();
    _jsp_string17 = "\";\r\n	var url = \"/docs/tabs/DocCommonTab.jsp?_fromURL=3&operateitem=\"+operateitem+\"&sqlwhere=\"+sqlwhere;\r\n	if(id){\r\n		url = \"/docs/tabs/DocCommonTab.jsp?_fromURL=3&relatedid=\"+id+\"&operateitem=\"+operateitem+\"&sqlwhere=\"+sqlwhere;\r\n		if(operateitem==418||operateitem==419||operateitem==420){\r\n			dialog.Title = \"".toCharArray();
    _jsp_string276 = "'}];\r\n    }else {\r\n        return true;\r\n    }\r\n    for(var i=0; i<attrs.length; i++) {\r\n        if(!check_receiveStr_length($('#' + attrs[i].id).val()+'')) {\r\n            window.top.Dialog.alert(attrs[i].name + '".toCharArray();
    _jsp_string93 = "\r\n                                        <select name=\"mailAccountId\" id=\"mailAccountId\" ".toCharArray();
    _jsp_string245 = "\"+(totalSize/(1024*1024)).toFixed(2)+\"MB\uff0c".toCharArray();
    _jsp_string160 = "\u2026</div></div>\r\n                                        <div class=\"left p-l-15\" ><a class=\"del\" href=\"javascript:void(0)\">".toCharArray();
    _jsp_string81 = "</div>\r\n                                            <div class=\"left\"></div>\r\n                                        </div>\r\n                                        <div class=\"left\"></div>\r\n                                        \r\n                                    </div>\r\n                                    <div class=\"clear\"></div>\r\n                            </div>\r\n                            <div class=\"relative h-30 \">\r\n                                <div class=\"left\">\r\n                                    <div class=\"color666 w-60 p-t-5 left\">".toCharArray();
    _jsp_string158 = "\r\n                                        ".toCharArray();
    _jsp_string259 = "\uff01\")\r\n                }else{\r\n                    window.top.Dialog.alert(\"".toCharArray();
    _jsp_string190 = "</span>\r\n            </td>\r\n            <td>\r\n                <input type=\"text\" class=\"w-300 styled input\"  name=\"srzname\" id=\"srzname\" onchange='checkinput(\"srzname\",\"srznamespan\")'  maxlength=\"50\">\r\n                <span name=\"srznamespan\" id=\"srznamespan\" class=\"hide\"><img src='/images/BacoError_wev8.gif' align=\"absMiddle\"></span>\r\n            </td>\r\n            <td>\r\n            </td>\r\n        </tr>\r\n        <tr class=\"h-35\">\r\n            <td class=\"p-l-30 p-r-15\" valign=\"top\">\r\n                <span class=\"color333 font12 w-100\">".toCharArray();
    _jsp_string61 = ")\">\r\n".toCharArray();
    _jsp_string130 = "\">\r\n                                        <input class=\"mailInputHide\" width=\"20\" style=\"width: 20\" type=\"hidden\" relid=\"internalcc\" name=\"internalccall\" id=\"internalccall\" value=\"".toCharArray();
    _jsp_string79 = "</div>\r\n                                            <div class=\"left\"></div>\r\n                                        </div>\r\n                                        <div class=\"btnPage left\" style=\"width:60px;background:#fff;line-height:22px;text-align:center;\">\r\n                                            <div id=\"addBcc\" class=\"left\" style=\"text-align:center;width:100%\">".toCharArray();
    _jsp_string297 = "\\n\\n".toCharArray();
    _jsp_string295 = "\r\n        $(\"#needReceiptDiv\").hide();\r\n        $(\"#needReceipt\").attr('checked', false);\r\n    ".toCharArray();
    _jsp_string44 = "\r\n<script language=javascript>\r\nubsfirmcode0 = ".toCharArray();
    _jsp_string6 = "\r\n\r\n\r\n<script language=javascript>;\r\ntop.Dialog.alert(\"".toCharArray();
    _jsp_string238 = ";\r\n                    var flag = ".toCharArray();
    _jsp_string252 = " !=\"0\" && file.size > ".toCharArray();
    _jsp_string209 = "\";\r\n        diag.URL = \"/email/new/ContactsGroupInner.jsp?ids=\"+ids;\r\n        diag.show();\r\n    });\r\n    \r\n    \r\n    //zzl\u5173\u95ed\u79c1\u4eba\u7ec4\r\nfunction closedsrz(){\r\n    $(\"#srzname\").val(\"\");\r\n    $(\"#hidediv\").hide();\r\n    $(\"#hidedivmsg\").hide();\r\n}\r\n\r\n    /*\r\n    //\u521d\u59cb\u5316\u7f16\u8f91\u5668\r\n    if($(\"#isInternal\").is(':checked')){\r\n        highEditor(\"mouldtext\",editorHeight,1)\r\n    }else{\r\n        highEditor(\"mouldtext\",editorHeight,0)\r\n    }\r\n    */\r\n    \r\n    $(\"#fromSearch\").bind(\"change\",function(){\r\n        if($(this).val()!=\"\"){\r\n            $(\".searchFrom\").hide();\r\n            $(\".clearFrom\").show();\r\n        }else{\r\n            $(\".searchFrom\").show();\r\n            $(\".clearFrom\").hide();\r\n        }\r\n    })\r\n    \r\n    $(\"#tabTitle\").find(\".tab\").bind(\"click\",function(){\r\n        var parentdiv=$(this).parent();\r\n        $(\".tabSelected\").removeClass(\"tabSelected\").addClass(\"tabUnSelected\");\r\n        $(this).addClass(\"tabSelected\").removeClass(\"tabUnSelected\");\r\n        \r\n        $(\".tabContent\").hide();\r\n        $(\"#\"+$(this).attr(\"target\")).show();\r\n    })\r\n    $(\"#tabTitle\").find(\".tab\").css(\"z-index\",\"-1\")\r\n    \r\n    $('.contactsItem').hover(\r\n        function () {\r\n          $(this).addClass(\"contactsItemOver\");\r\n        }, \r\n        function () {\r\n            $(this).removeClass(\"contactsItemOver\");\r\n        }\r\n    );\r\n   \r\n    if(".toCharArray();
    _jsp_string185 = "</li>\r\n    ".toCharArray();
    _jsp_string46 = ";\r\nusbserial0 = \"".toCharArray();
    _jsp_string278 = "!important; \">'+$('#mouldtext').val()+'</div>';\r\n    $('#mouldtext').val(content);\r\n}\r\n\r\n// \u53d1\u9001\u90ae\u4ef6\r\nfunction doSubmit(obj){\r\n    if(".toCharArray();
    _jsp_string199 = "',\r\n        arguments: '',\r\n        _callback: resourceBrowserCallback\r\n    });\r\n}\r\n\r\n// \u4eba\u529b\u8d44\u6e90\u9009\u62e9\u6846\u56de\u8c03\r\nfunction resourceBrowserCallback(event, data, name, oldid) {\r\n    if (data != null) {\r\n        if (data.id != \"\") {\r\n            var _ids = data.id.split(\",\");\r\n            var _names = data.name.split(\",\");\r\n            var div = $(\"#\" + target);\r\n            for (var i = 0; i < _names.length; i++) {\r\n                if (_ids[i] != \"\") {\r\n                    addToInput(target, _names[i] + \"|\" + _ids[i] + \"|0\")\r\n                }\r\n            }\r\n        } else {\r\n            //var div = $(\"#\" + target);\r\n        }\r\n    }\r\n}\r\n\r\n// \u6253\u5f00\u90e8\u95e8\u9009\u62e9\u6846\r\nfunction onShowDepartment(obj) {\r\n    $(\".btnGrayDropContent\").hide();\r\n    target = $(obj).parent().attr(\"target\");\r\n    getRealMailAddress();\r\n    var resourceid = $(\"#\" + target).attr(\"target\") + \"dpid\";\r\n    var selectedids = $(\"#\" + resourceid).val();\r\n    showModalDialogForBrowser(event, '/systeminfo/BrowserMain.jsp?url=/hrm/company/MutiDepartmentBrowser.jsp?selectedids=' + selectedids, '#', resourceid, false, 1, '', {\r\n        name: 'resourceBrowser',\r\n        hasInput: false,\r\n        zDialog: true,\r\n        needHidden: true,\r\n        dialogTitle: '".toCharArray();
    _jsp_string92 = " left\">\r\n                                    \r\n                                    ".toCharArray();
    _jsp_string198 = "\";\r\n    }\r\n    showModalDialogForBrowser(event, url, '#', resourceid, false, 1, '', {\r\n        name: 'resourceBrowser',\r\n        hasInput: false,\r\n        zDialog: true,\r\n        needHidden: true,\r\n        dialogTitle: tabTitle,\r\n        arguments: '',\r\n        _callback: resourceMailCallback\r\n    });\r\n}\r\n\r\nfunction resourceMailCallback(event, data, name, oldid) {\r\n    if (data != null) {\r\n        if (data.id != \"\") {\r\n            var _ids = data.id.split(\",\");\r\n            var _names = data.name.split(\",\");\r\n            var _emails = data.email.split(\",\");\r\n            for (var i = 0; i < _names.length; i++) {\r\n                if (_emails[i].indexOf(\"@\") == -1) continue;\r\n                addToInput(target, _names[i] + \"<\" + _emails[i] + \">\")\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nvar target;  //\u8bb0\u5f55\u6253\u5f00\u4eba\u529b\u8d44\u6e90\u6846\u6216\u8005\u90e8\u95e8\u9009\u62e9\u6846\u65f6\u7684\u8f93\u5165\u5bf9\u8c61\r\n\r\n// \u6253\u5f00\u4eba\u529b\u8d44\u6e90\u9009\u62e9\u6846\r\nfunction onShowResource(obj) {\r\n    $(\".btnGrayDropContent\").hide();\r\n    target = $(obj).parent().attr(\"target\");\r\n    getRealMailAddress();\r\n    var resourceid = $(\"#\" + target).attr(\"target\");\r\n    var selectedids = $(\"#\" + resourceid).val();\r\n    if (selectedids == 0) selectedids = '';\r\n    showModalDialogForBrowser(event, '/systeminfo/BrowserMain.jsp?url=/hrm/resource/MutiResourceBrowser.jsp?selectedids=' + selectedids, '#', resourceid, false, 1, '', {\r\n        name: 'resourceBrowser',\r\n        hasInput: false,\r\n        zDialog: true,\r\n        needHidden: true,\r\n        dialogTitle: '".toCharArray();
    _jsp_string5 = "\";\r\n		});		\r\n	</script>\r\n	".toCharArray();
    _jsp_string244 = "\"+(totalSize/1024).toFixed(2)+\"KB\uff09\");\r\n    } else {\r\n        jQuery(\"#uploadInfo\").html(\"\uff08100%\uff0c".toCharArray();
    _jsp_string51 = "\r\n}\r\n\r\nfunction doScannerEscape(ev, obj){\r\n	IMCarousel.doScannerEscape(ev, obj);\r\n}\r\n\r\nfunction scaleImg(obj, tag){\r\n	IMCarousel.scaleImg(obj, tag);\r\n}\r\n\r\nfunction rotateImg(obj){\r\n	IMCarousel.rotateImg(obj);\r\n}\r\n\r\nfunction downloadImg(obj){\r\n	IMCarousel.downloadImg(obj);\r\n}\r\n\r\nfunction slideImg(obj, direction){\r\n	IMCarousel.slideImg(obj, direction);\r\n}\r\n\r\nfunction showImgScanner(ev, isShow, id){\r\n	IMCarousel.showImgScanner(ev, isShow, id);\r\n}\r\n\r\nfunction downloads(id){\r\n	document.location.href=\"/weaver/weaver.file.FileDownload?fileid=\"+id+\"&download=1\";\r\n}\r\n</script>\r\n".toCharArray();
    _jsp_string115 = "</div>\r\n                                        <div class=\" left  relative   \" id=\"addMailsBtn\" style=\"width: 10px;\">\r\n                                            <img class=\"absolute\" style=\"top:7px;left:5px;\" src=\"/email/images/iconDArr_wev8.png\"/>\r\n                                        </div>\r\n                                        \r\n                                        <div class=\"clear\"></div>\r\n                                    </div>\r\n                                    <div class=\"color666  p-t-5 left\">\r\n                                        <!--  <input class=\"w-500\" type=\"hidden\" name=\"to\" id=\"to\" value=\"".toCharArray();
    _jsp_string173 = "\">&nbsp;\uff0d&nbsp;\r\n                                    <button class=\"Clock\" style=\"height:16px\" onclick=\"onShowTime(timespan,time)\" type=\"button\"></button>\r\n                                    <span id=\"timespan\">".toCharArray();
    _jsp_string14 = "\";\r\nfunction check_conn() {\r\n	return confirm('".toCharArray();
    _jsp_string301 = "\");\r\n            return;\r\n        }\r\n        if ($(\".mailAdError\").length > 0) {\r\n            window.top.Dialog.alert(\"".toCharArray();
    _jsp_string155 = "\" >\r\n                                    <span id=\"subjectSpan1\" class='hide'>".toCharArray();
    _jsp_string86 = "\"><span>".toCharArray();
    _jsp_string97 = "\" selected=\"selected\">".toCharArray();
    _jsp_string27 = "\r\n	    try {\r\n		    var lenck = true;\r\n		    var tempfieldvlaue = document.getElementById(\"htmlfieldids\").value;\r\n		    while(true) {\r\n			    var tempfield = tempfieldvlaue.substring(0, tempfieldvlaue.indexOf(\",\"));\r\n			    tempfieldvlaue = tempfieldvlaue.substring(tempfieldvlaue.indexOf(\",\")+1);\r\n			    var fieldid = tempfield.substring(0, tempfield.indexOf(\";\"));\r\n			    var fieldname = tempfield.substring(tempfield.indexOf(\";\")+1);\r\n			    if(fieldname=='') break;\r\n			    if(!checkLengthOnly(fieldid,'4000',fieldname,'".toCharArray();
    _jsp_string258 = ")+\"MB\uff0c".toCharArray();
    _jsp_string57 = "\r\n\r\n\r\n<!-- \u5b57\u4f53\u8bbe\u7f6e\uff0cwin7\u3001vista\u7cfb\u7edf\u4f7f\u7528\u96c5\u9ed1\u5b57\u4f53,\u5176\u4ed6\u7cfb\u7edf\u4f7f\u7528\u5b8b\u4f53 Start -->\r\n<!--\r\n\u6dfb\u52a0\u81f3init_wev8.css \r\n<link type='text/css' rel='stylesheet'  href='/wui/common/css/w7OVFont_wev8.css' id=\"FONT2SYSTEMF\">\r\n -->\r\n<script language=\"javascript\"> \r\n/*\r\nif (jQuery.client.version< 6) {\r\n	document.getElementById('FONT2SYSTEMF').href = \"/wui/common/css/notW7AVFont_wev8.css\";\r\n}\r\n*/\r\n</script> \r\n<!-- \u5b57\u4f53\u8bbe\u7f6e\uff0cwin7\u3001vista\u7cfb\u7edf\u4f7f\u7528\u96c5\u9ed1\u5b57\u4f53,\u5176\u4ed6\u7cfb\u7edf\u4f7f\u7528\u5b8b\u4f53 End -->\r\n\r\n<!-- \u9875\u9762\u5207\u6362\u6548\u679cStart -->\r\n".toCharArray();
    _jsp_string64 = "\";\r\n</script>\r\n\r\n<!--For wuiForm-->\r\n<script type=\"text/javascript\" src=\"/wui/common/jquery/plugin/wuiform/jquery.wuiform_wev8.js\"></script>\r\n<script language=\"javascript\">\r\njQuery(document).ready(function(){\r\n	wuiform.init();\r\n});\r\n</script>\r\n".toCharArray();
    _jsp_string116 = "\">-->\r\n                                        ".toCharArray();
    _jsp_string299 = "\");\r\n        else if (ids.length > 0) {\r\n            var tempids = ids.split(\",\");\r\n            var tempnames = names.split(\",\");\r\n            var description = (true && desc) ? desc.split(\"\\7\") : \"\";\r\n            var sHtml = \"\";\r\n            for (var i = 0; i < tempids.length; i++) {\r\n                var tempid = tempids[i];\r\n                var tempname = tempnames[i];\r\n                if (tempid != '') {\r\n                    if (type == \"workplan\") {\r\n                        var desc_i = description[i];\r\n                        var URIComponent = \"\";\r\n                        if (URIComponent != \"\") URIComponent = decodeURIComponent(desc_i)\r\n                        sHtml = sHtml + \"<br/><a style=''   linkid=\" + tempid + \" target='_blank' linkType='\" + type + \"' href='\" + url + tempid + \"' ondblclick='return false;'  unselectable='off' contenteditable='false' style='cursor:pointer;text-decoration:underline !important;margin-right:8px'>\" + tempname + \"</a>&nbsp<br/>\" + \"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\" + URIComponent;\r\n                    } else {\r\n                        sHtml = sHtml + \"<a  linkid=\" + tempid + \" linkType='\" + type + \"' href='\" + url + tempid + \"' target='_blank' ondblclick='return false;'  unselectable='off' contenteditable='false' style='cursor:pointer;text-decoration:underline !important;margin-right:8px'>\" + tempname + \"</a>&nbsp\";\r\n                    }\r\n                }\r\n            }\r\n            var editorId = \"mouldtext\";\r\n            if (sHtml != null && sHtml != \"\" || typeof(sHtml) != 'undefined') {\r\n                if (KE.g[editorId].designMode) {\r\n                    KE.insertHtml(editorId, sHtml);\r\n                } else {\r\n                    window.top.Dialog.alert(\"".toCharArray();
    _jsp_string196 = "';\r\n        for (var i = 0; i < list.length; i++) {\r\n            var dpid = list[i];\r\n            var name = listname;\r\n            if (dpid == '1') {\r\n                addToInput($obj.attr(\"relid\") + \"Div\", name + \"|0|0\");\r\n            }\r\n        }\r\n        $(\"#\" + $obj.attr(\"relid\") + \"Div\").find(\".clear\").remove();\r\n        \r\n    } else {\r\n        for (var i = 0; i < list.length; i++) {\r\n            var mail = list[i];\r\n            if (mail != '') {\r\n                addToInput(div.attr(\"id\"), mail)\r\n            }\r\n        }\r\n    }\r\n    //div.append(\"<div class='clear'></div>\")\r\n}\r\n\r\n// \u4eba\u529b\u8d44\u6e90\u6d4f\u89c8\u6846\uff08\u4eba\u5458\uff09\r\nfunction onShowResourcemail(obj, mailtype) {\r\n    $(\".btnGrayDropContent\").hide();\r\n    target = $(obj).parent().attr(\"target\");\r\n    var resourceid = $(\"#\" + target).attr(\"target\");\r\n    var url = \"/systeminfo/BrowserMain.jsp?url=/email/MutiResourceMailBrowser.jsp?selectedids=\";\r\n    var tabTitle = \"".toCharArray();
    _jsp_string34 = "\");\r\n							}\r\n						}else{\r\n							try{\r\n								window.top.Dialog.alert(\"".toCharArray();
    _jsp_string272 = "'}, {id:'internalbcc', name:'".toCharArray();
    _jsp_string67 = ";</script>\r\n\r\n<script type=\"text/javascript\" src=\"/js/select/script/jquery-1.8.3.min_wev8.js\"></script>\r\n\r\n<script type=\"text/javascript\" src=\"/email/js/kindeditor/kindeditor-all.js\"></script>\r\n\r\n<link href=\"/email/js/autocomplete/jquery.autocomplete_wev8.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<script type=\"text/javascript\" src=\"/email/js/autocomplete/jquery.autocomplete_wev8.js\"></script>\r\n\r\n<script type=\"text/javascript\" src=\"/email/js/swfupload/vendor/swfupload/swfupload_wev8.js\"/></script>\r\n<script type=\"text/javascript\" src=\"/email/js/swfupload/vendor/swfupload/swfupload.queue_wev8.js\"/></script>\r\n<script type=\"text/javascript\" src=\"/email/js/swfupload/vendor/swfupload/fileprogress_wev8.js\"/></script>\r\n<script type=\"text/javascript\" src=\"/email/js/swfupload/vendor/swfupload/handlers_wev8.js\"/></script>\r\n<script type=\"text/javascript\" src=\"/email/js/swfupload/src/jquery.swfupload_wev8.js\"/></script>\r\n\r\n<script type=\"text/javascript\" src=\"/js/weaver_wev8.js\"></script> \r\n<script type=\"text/javascript\" src=\"/email/js/progressbar/jquery.progressbar_wev8.js\"/></script>\r\n<link type='text/css' rel='stylesheet'  href='/blog/js/treeviewAsync/eui.tree_wev8.css'/>\r\n<script language='javascript' type='text/javascript' src='/blog/js/treeviewAsync/jquery.treeview_wev8.js'></script>\r\n<script language='javascript' type='text/javascript' src='/blog/js/treeviewAsync/jquery.treeview.async_wev8.js'></script>\r\n<link href=\"/email/css/base_wev8.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<script type=\"text/javascript\" src=\"/email/js/autosizetext/jquery.autosizetext_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/email/js/leanModal/jquery.leanModal.min_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/email/js/hotkeys/jquery.hotkeys_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/email/js/easyui/jquery.easyui.min_wev8.js\"></script>  \r\n<link rel=\"stylesheet\" type=\"text/css\" href=\"/css/Weaver_wev8.css\" />\r\n<link rel=\"stylesheet\" type=\"text/css\" href=\"/wui/theme/ecology8/skins/default/wui_wev8.css\" />\r\n<script type=\"text/javascript\" src=\"/js/ecology8/browserCommon_wev8.js\"></script>\r\n<script type='text/javascript' src='/js/jquery-autocomplete/browser_wev8.js'></script>\r\n\r\n<link rel=\"stylesheet\" href=\"/js/ecology8/selectbox/css/jquery.selectbox_wev8.css\" type=\"text/css\" />\r\n<script type=\"text/javascript\" src=\" /js/ecology8/selectbox/js/jquery.selectbox-0.2_wev8.js\"></script>\r\n<link rel=\"stylesheet\" href=\"/js/ecology8/jNice/jNice/jNice_wev8.css\" type=\"text/css\" />\r\n<script type=\"text/javascript\" src=\"/js/ecology8/jNice/jNice/jquery.jNice_wev8.js\"></script>\r\n<script language=\"javascript\" src=\"/js/datetime_wev8.js\"></script>\r\n<script language=\"javascript\" src=\"/js/selectDateTime_wev8.js\"></script>\r\n<script language=\"javascript\" src=\"/js/JSDateTime/WdatePicker_wev8.js\"></script>\r\n\r\n".toCharArray();
    _jsp_string149 = "</div>\r\n                                        <div class=\" left  relative   \" id=\"addMailsBtn\" style=\"width: 20px;;\">\r\n                                            <img class=\"absolute\" style=\"top:7px;left:5px\" src=\"/email/images/iconDArr_wev8.png\"/>\r\n                                        </div>\r\n                                        \r\n                                        <div class=\"clear\"></div>\r\n                                    </div>\r\n                                    \r\n                                    ".toCharArray();
    _jsp_string131 = "\">\r\n                                        <input class=\"\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internalcchrmname\" id=\"internalcchrmname\" value=\"".toCharArray();
    _jsp_string237 = ";\r\n                    var isInternal = ".toCharArray();
    _jsp_string267 = "</a>\";             \r\n            }\r\n\r\n            $('#' + file.id).find('.fileProgress').html(html);\r\n            if( swfu.getStats().files_queued ===0){\r\n                //nextStep();\r\n                // showLoading();\r\n                //jQuery(\"#mailAddForm\").submit();\r\n                //\u63d0\u4ea4\u8868\u5355\r\n                \r\n                setUploadInfo();\r\n            }\r\n        });\r\n        \r\n});\r\n\r\nfunction checkFileType(filename) {\r\n    var isavailable = false;\r\n    var filePostfixs = ['.pdf','.txt', '.png', '.doc', '.docx','.jpg', '.bmp', '.gif'];\r\n    if(filename == \"\" || filename == null || typeof(filename)==\"undefined\")\r\n        return isavailable;\r\n        \r\n    for(var i in filePostfixs) {\r\n        var index = filename.toLowerCase().lastIndexOf(filePostfixs[i]);\r\n        if((index+(filePostfixs[i].length)) == filename.length) { //\u5224\u65ad\u6587\u4ef6\u540d\u540e\u7f00\u662f\u5426\u4ee5\u6570\u7ec4\u4e2d\u7684\u4efb\u610f\u503c\u7ed3\u5c3e\r\n            isavailable = true;\r\n            break;      \r\n        }  \r\n    }\r\n    \r\n    return  isavailable;\r\n}\r\nvar dialogfile = null;\r\n//\u6253\u5f00\u9644\u4ef6\u9884\u89c8\r\nfunction openfile(fileid,mailid) {\r\n/*\r\n    if(mailid == '' || mailid == null){\r\n        mailid = $(\"#mailid\").val();\r\n    }\r\n    if(mailid == ''||mailid == null) {\r\n        mailid = '0';\r\n    }\r\n    dialogfile = new window.top.Dialog();\r\n    dialogfile.currentWindow = window;\r\n    dialogfile.Title = \"".toCharArray();
    _jsp_string182 = "</li>\r\n    <!--\r\n    <li class=\"\"  style=\"font-weight: normal;line-height: 20px;\" onclick=\"onShowResourcemail(this,'contacter')\" ><button type=\"button\" class=\"Browser\"  title=\"".toCharArray();
    _jsp_string161 = "</a></div>\r\n                                        <div class=\"clear\"></div>\r\n                                    </div>\r\n                                    <div id=\"fsUploadProgress\"></div>\r\n                                <input class=\"w-500\" type=\"hidden\" id=\"acc\" value=\"\"></div>\r\n                                <div class=\"clear\"></div>\r\n                            </div>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td height=\"*\" class=\"\">\r\n                        <div id=\"editor\" class=\"w-all\">\r\n                            <textarea class=\"w-all\" style=\"height:300px;width:100%\" id=\"mouldtext\" name=\"mouldtext\"></textarea>\r\n                        </div>\r\n                        \r\n                        <!-- jquery_1.8.3\u4e0b,lable for\u4e0d\u8d77\u4f5c\u7528\uff0cjnice\u4e0d\u80fd\u81ea\u52a8\u52fe\u9009 -->\r\n                        <div id=\"toolBar\" class=\"m-t-20\">\r\n                            <div class=\"left m-r-20\">\r\n                                <button class=\"btnGreen\" type=\"button\" onclick=\"doSubmit(this)\">".toCharArray();
    _jsp_string296 = "\r\n});  \r\n\r\nfunction getFormIsChange(){\r\n     clearInterval(saveIntervalfn);\r\n/*\r\n     if(is_form_changed($(\"form\"))){\r\n         return  !confirm(\"".toCharArray();
    _jsp_string225 = "';\r\nKindEditor.plugin('mailTemplate', function(K) {\r\n    var self = this, name = 'mailTemplate';\r\n    self.clickToolbar(name, function() {\r\n        var menu = self.createMenu({\r\n                name : 'mailTemplate',\r\n                width : 150\r\n            });\r\n        var mailTemplateObjs = [];\r\n        jQuery.ajax({\r\n            async: false,\r\n            url : '/email/new/MailOperation.jsp?opt=getTemplList',\r\n            success : function(data){\r\n                data = jQuery.parseJSON(jQuery.trim(data));\r\n                mailTemplateObjs = data;\r\n            },\r\n            error : function(XMLHttpRequest, textStatus, errorThrown){\r\n                console && console.error(errorThrown);\r\n            }\r\n        });\r\n        // \u6a21\u7248\u7ef4\u62a4\r\n        mailTemplateObjs.push({ \r\n            templId: '-1', \r\n            templName: '".toCharArray();
    _jsp_string83 = " style=\"border: 1px solid #e9e9e2\"".toCharArray();
    _jsp_string11 = "\r\n<!-- IE\u4e0b\u4e13\u7528vbs\uff08\u4e34\u65f6\uff09 -->\r\n<script language=\"vbs\" src=\"/js/string2VbArray.vbs\"></script>        \r\n        ".toCharArray();
    _jsp_string136 = "\r\n                                        <input class=\"mailInputHide\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internalbcc\" id=\"internalbcc\" value=\"".toCharArray();
    _jsp_string90 = " name=\"isInternal\" id=\"isInternal\">\r\n                                        </p>\r\n                                    </div>\r\n                                    \r\n                                    <div id=\"sendFromDiv\" class=\"color666 m-t-5 ".toCharArray();
    _jsp_string65 = "\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string138 = "\">\r\n                                        <input class=\"mailInputHide\" width=\"20\" style=\"width: 20\" type=\"hidden\" relid=\"internalbcc\" name=\"internalbccall\" id=\"internalbccall\" value=\"".toCharArray();
    _jsp_string123 = "\">\r\n                                        <input class=\"\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internaltodpidname\" id=\"internaltodpidname\" value=\"".toCharArray();
    _jsp_string254 = "){\r\n            if(total/1024 > ".toCharArray();
    _jsp_string224 = ", function(i, val) {\r\n            menu.addItem({\r\n                title : '<span unselectable=\"on\" title=\"' + val.name + '&#10;' + val.desc + '\">' + val.descName + '</span>',\r\n                click : function() {\r\n                    self.insertHtml(val.signContent);\r\n                    self.hideMenu();\r\n                }\r\n            });\r\n        });\r\n    });\r\n});\r\n\r\n/**\u5c01\u88c5\u6a21\u677f\u63d2\u4ef6**/\r\nKindEditor.zh_cn_lang.mailTemplate = '".toCharArray();
    _jsp_string69 = "\">\r\n<input type=\"hidden\" name=\"fileid\" id=\"fileid\" value=\"".toCharArray();
    _jsp_string257 = "\"+(".toCharArray();
    _jsp_string219 = "\");\r\n                return ;\r\n            }\r\n                $.each(data,function(idx,item){                                     \r\n                addToInput(div.attr(\"id\"),item.text+\"|\"+item.id+\"|\"+item.dpid)\r\n            }); \r\n        }else if(tabType==\"innerContacterTab\"){\r\n            if(data.length>500){\r\n                alert(\"".toCharArray();
    _jsp_string294 = "\";\r\n        }\r\n    }\r\n}\r\n  \r\nfunction is_form_changed(f) {    \r\n    var changed = false;    \r\n    try{\r\n        $(':text, :password, textarea', f).each(function() {    \r\n            var _v = $(this).attr('_value');    \r\n            if(typeof(_v) == 'undefined')   _v = '';    \r\n            if(_v != $(this).val()) changed = true;    \r\n        });    \r\n      \r\n        $(':checkbox, :radio', f).each(function() {    \r\n            var _v = this.checked ? 'on' : 'off';  \r\n            if(_v != $(this).attr('_value')) changed = true;    \r\n        });    \r\n       \r\n        $('select', f).each(function() {    \r\n            var _v = $(this).attr('_value');    \r\n            if(typeof(_v) == 'undefined')   _v = '';    \r\n            if(_v != this.options[this.selectedIndex].value) changed = true;  \r\n        });   \r\n    }catch(e){\r\n        \r\n    }\r\n    return changed;    \r\n}  \r\n\r\n$(function() {    \r\n    $('form').enable_changed_form_confirm();  \r\n    $(\".cb-enable\").click(function(){\r\n        var parent = $(this).parents('.switch');\r\n        $('.cb-disable',parent).removeClass('selected');\r\n        $(this).addClass('selected');\r\n        $(\"#isInternal\").attr('checked', true);\r\n        $(\"#needReceiptDiv\").hide();\r\n        $(\"#needReceipt\").attr('checked', false);\r\n        changeMailType(1);\r\n        //$(\"#isInternal\").trigger(\"click\")\r\n    });\r\n    $(\".cb-disable\").click(function(){\r\n        var parent = $(this).parents('.switch');\r\n        $('.cb-enable',parent).removeClass('selected');\r\n        $(this).addClass('selected');\r\n        $(\"#isInternal\").attr('checked', false);\r\n        $(\"#needReceiptDiv\").show();\r\n        \r\n        changeMailType(0);\r\n    });\r\n    \r\n    //\u5982\u679c\u521d\u59cb\u5316\u7684\u4e0d\u662f\u5185\u90e8\u90ae\u4ef6\uff0c\u5219\u5c06\u5185\u90e8\u56de\u6267\u529f\u80fd\u5f71\u85cf\r\n    ".toCharArray();
    _jsp_string25 = "';\r\n	   \r\n	    			return false;\r\n	    		}\r\n	    		flag_msg += '\\r\\n\\r\\n".toCharArray();
    _jsp_string144 = "</div>\r\n                                        <div class=\" left relative\" target=\"toDiv\" id=\"addMailsBtn\" style=\"width: 20px;;\">\r\n                                            <img class=\"absolute\" style=\"top:7px;left:5px\" src=\"/email/images/iconDArr_wev8.png\"/>\r\n                                        </div>\r\n                                        \r\n                                        <div class=\"clear\"></div>\r\n                                    </div>\r\n                                    <div class=\"color666  w-500 p-t-5 left\">\r\n                                        ".toCharArray();
    _jsp_string77 = "\r\n\r\n\r\n<table class=\"w-all h-all \"  style=\"border-spacing: 0px\">\r\n    <tr>\r\n        <td width=\"*\" class=\"p-r-5 p-l-5 p-t-3\">\r\n            <table class=\"w-all h-all\">\r\n                <tr height=\"90px;\">\r\n                    <td>\r\n                        <div class=\"w-all  relative\" style=\"background:#f8f8f8 \">\r\n                            <div class=\"absolute w-250\" style=\"top: 5px; right: 10px;z-index:1000 \">\r\n                                    \r\n                                    <div class=\"right\" id=\"miniToolBar\" style=\"border:1px solid #dadada;\">\r\n                                        \r\n                                        <div class=\"btnPage left\" style=\"border-left:0px solid #dadada;width:60px;background:#fff;line-height:22px;\">\r\n                                            <div id=\"addCc\" class=\"left\" style=\"text-align:center;width:100%\">".toCharArray();
    _jsp_string9 = "\r\n<script type=\"text/javascript\" src=\"/wui/common/jquery/jquery.min_wev8.js\"></script>\r\n".toCharArray();
    _jsp_string239 = ";\r\n                    \r\n                    if(defaultTemplateId != -1 && flag == -1) {\r\n                        //console && console.log('\u52a0\u8f7d\u9ed8\u8ba4\u90ae\u4ef6\u6a21\u677f');\r\n                        loadMailTemplate(defaultTemplateId, templateType, 1); //\u52a0\u8f7d\u9ed8\u8ba4\u90ae\u4ef6\u6a21\u677f\r\n                    } else {\r\n                        //console && console.log('\u52a0\u8f7d\u90ae\u4ef6\u5185\u5bb9');\r\n                        loadMailContent(); // \u52a0\u8f7d\u90ae\u4ef6\u5185\u5bb9\r\n                    }\r\n                    \r\n                    setTimeout(function(){\r\n                        //KE.util.setFontname(remarkid, 'SimHei');  // \u8981\u5148\u6267\u884c\u8fd9\u53e5\u8bdd\uff0c\u5426\u5219\u83b7\u53d6\u7126\u70b9\u6709\u95ee\u9898\r\n                        if(flag == 1 || flag == 2) { \r\n                            KE.util.focus(remarkid);\r\n                        } else {\r\n                            var idname = isInternal == 1 ? 'internaltoDiv' : 'toDiv';\r\n                            $('#' + idname).click();  //\u6536\u4ef6\u4eba\u83b7\u5f97\u7126\u70b9\r\n                        }\r\n                    }, 500);\r\n                }\r\n            }\r\n        };\r\n        //KindEditor.ready(function(K) {\r\n            KindEditor.createEditor(default_config);\r\n        //});\r\n    }\r\n}\r\n\r\n//\u5207\u6362\u5230\u7eaf\u6587\u672c\u6a21\u5f0f\r\nfunction removeEditor(remarkid) {\r\n    K.remove('#' + remarkid);\r\n}\r\n\r\n//\u5207\u6362\u7f16\u8f91\u5668\u6a21\u5f0f--\u7eaf\u6587\u672c\u683c\u5f0f\u548chtml\u683c\u5f0f\u5207\u6362\r\nfunction changeHTMLEditor(obj) {\r\n    if (obj.checked) {\r\n        window.top.Dialog.confirm(\"".toCharArray();
    _jsp_string106 = "\r\n                                                        <option value=\"".toCharArray();
    _jsp_string232 = "\";\r\nKindEditor.plugin('crm', function(K) {\r\n    var self = this, name = 'crm';\r\n    self.clickToolbar(name, function() {\r\n        openApp('crm');\r\n    });\r\n});\r\n\r\nKindEditor.zh_cn_lang.task = \"".toCharArray();
    _jsp_string300 = "\"); //\u8bf7\u5c06\u7f16\u8f91\u5668\u5207\u6362\u5230\u53ef\u89c6\u5316\u6a21\u5f0f\uff01\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n//\u5b9a\u65f6\u53d1\u9001\r\nfunction timingsubmit(obj) {\r\n    $(\"#savedraft\").val(\"1\");\r\n    $(\"#folderid\").val(\"-2\");\r\n    getRealMailAddress();\r\n    if ($(\"#isInternal\").is(':checked')) {\r\n        if ((check_form($G(\"mailAddForm\"), 'internalto,subject'))) {\r\n            settimingdate(obj);\r\n        }\r\n    } else {\r\n        if ($(\"#mailAccountId\").length == 0) {\r\n            window.top.Dialog.alert(\"".toCharArray();
    _jsp_string42 = "\";\r\n  var str1 = \"".toCharArray();
    _jsp_string7 = "\",function(){\r\n	window.top.location=\"/login/Login.jsp\";\r\n});\r\n</script>\r\n".toCharArray();
    _jsp_string33 = "\");\r\n							}catch(e){\r\n								Dialog.alert(\"".toCharArray();
    _jsp_string275 = "'},{id:'internalbccdpid', name:'".toCharArray();
    _jsp_string73 = "\" />\r\n<input type=\"hidden\" name=\"autoSave\" id=\"autoSave\" value=\"0\" />\r\n\r\n".toCharArray();
    _jsp_string206 = "'=='true'){\r\n         //$(\".mailInput\").css(\"height\",\"28px\");\r\n     // }\r\n    $(\".importBtn\").bind(\"click\",function(event){\r\n        var id = $(this).attr(\"target\");\r\n        \r\n        var x=$(this).offset().left\r\n        var y=$(this).offset().top\r\n        \r\n        $(\".importBtnDown\").attr(\"target\",id);\r\n        \r\n        $(\".importBtnDown\").css(\"left\",x+25);\r\n        $(\".importBtnDown\").css(\"top\",y+20);\r\n        $(\".importBtnDown\").toggle();\r\n        event.stopPropagation(); \r\n        \r\n    })\r\n    \r\n    $(\".importInternalBtn\").bind(\"click\",function(event){\r\n        var id = $(this).attr(\"target\");\r\n        getRealMailAddress();\r\n        var input = $(\"#\"+id).attr(\"target\")\r\n        if($(\"#\"+input+\"all\").val()!='1'){\r\n            $(\".importInternalBtnDown\").find(\"input:checkbox\").attr(\"checked\",false);\r\n        }\r\n        var x=$(this).offset().left\r\n        var y=$(this).offset().top\r\n        $(\".importInternalBtnDown\").attr(\"target\",id);\r\n        $(\".importInternalBtnDown\").css(\"left\",x+25);\r\n        $(\".importInternalBtnDown\").css(\"top\",y+20);\r\n        $(\".importInternalBtnDown\").toggle();\r\n        event.stopPropagation(); \r\n    });\r\n    \r\n    \r\n    $(document).bind(\"click\",function(event){\r\n        if(jQuery(event.target).parents(\".btnGrayDropContent\").length !=0){\r\n            return;\r\n        }\r\n        $(\".btnGrayDropContent\").hide();\r\n    });\r\n    \r\n    \r\n    loadContactsTree();\r\n    \r\n    \r\n    //$('.mailInput').autogrow();\r\n    \r\n    $(\".mailInputHide\").each(function (index) {\r\n        showMailAddDiv($(this));\r\n    });\r\n    \r\n    // \u6536\u4ef6\u4eba\u7b49\u5355\u51fb\u4e8b\u4ef6\r\n    $('.mailInput').click(function (event) {\r\n        if (event.target.tagName != 'DIV') {\r\n            return;\r\n        }\r\n        var $this = $(this);\r\n        var isDisabled = $this.attr(\"disabled\");\r\n        // jquery1.8.3\u662fdisabled\uff0c\u4e4b\u524d\u7248\u672c\u662ftrue\r\n        if (isDisabled && (isDisabled == 'disabled' || isDisabled == 'true')) {\r\n            return;\r\n        }\r\n        \r\n        $(\".mailAdOver\").removeClass(\"mailAdOver\");\r\n        $(\".mailAdSelect\").removeClass(\"mailAdSelect\");\r\n        var obj = \"\";\r\n        if ($this.attr(\"type\") == \"hrm\") {\r\n            obj = $('<span class=\"mailinputdiv editableAddr\"><input size=1 style=\"*width:1px;border-width: 0px;overflow-x:visible;overflow-y:visible;\" class=\"editableAddr-ipt\" onblur=\"doRemove(this)\" oninput=\"doInput(this)\" onpropertychange=\"doInput(this)\" onkeydown=\"keyDownDelete(this,event)\" onchange=\"addMailAddress(this)\"><span class=\"editableAddr-txt\"></span></span>')\r\n        } else {\r\n            obj = $('<span class=\"mailinputdiv editableAddr\"><input size=1 style=\"*width:1px;border-width: 0px;overflow-x:visible;overflow-y:visible;\" class=\"editableAddr-ipt\" onkeydown=\"mail_keypress(this),keyDownDelete(this,event)\" oninput=\"doInput(this)\" onpropertychange=\"doInput(this)\" onchange=\"addMailAddress(this)\"><span class=\"editableAddr-txt\"></span></span>')\r\n        }\r\n        var $mailinputdiv = $this.find(\".mailinputdiv\");\r\n        if ($mailinputdiv.length == 0) {\r\n            var $clear = $this.find('.clear');\r\n            if ($clear.length > 0) {\r\n                obj.insertBefore($clear);\r\n            } else {\r\n                $this.append(obj);\r\n            }\r\n        }\r\n        $this.find('.editableAddr-ipt').focus();\r\n     \r\n        if ($this.attr(\"type\") == \"hrm\") {\r\n            //var tt = $mailinputdiv.find('.editableAddr-ipt').val();\r\n            obj.find('.editableAddr-ipt').autocomplete(\"/email/new/GetData.jsp?searchtype=hrm\", {\r\n                minChars: 1,\r\n                scroll: true,\r\n                //max: 30,\r\n                width: 400,\r\n                multiple: \"\",\r\n                matchSubset: false,\r\n                scrollHeight: 240,\r\n                matchContains: \"word\",\r\n                autoFill: false,\r\n                formatItem: function (row, i, max) {\r\n                    return row.name + \"&lt;\" + row.department + \"&gt;\";\r\n                },\r\n                formatMatch: function (row, i, max) {\r\n                    return row.name + \" \" + row.pinyin + \" \" + row.loginid;\r\n                },\r\n                formatResult: function (row) {\r\n                    return row.name + \"|\" + row.id + \"|0\";\r\n                }\r\n            });\r\n        } else {\r\n            obj.find('.editableAddr-ipt').autocomplete(\"/email/new/EmailData.jsp\", {\r\n                minChars: 1,\r\n                scroll: true,\r\n                max: 50,\r\n                width: 400,\r\n                multiple: \"\",\r\n                scrollHeight: 240,\r\n                matchContains: \"word\",\r\n                autoFill: false,\r\n                formatItem: function (row, i, max) {\r\n                    return row.name + \"<\" + row.to + \">\";\r\n                },\r\n                formatMatch: function (row, i, max) {\r\n                    return row.name + \" \" + row.to;\r\n                },\r\n                formatResult: function (row) {\r\n                    return row.name + \"|\" + row.to;\r\n                }\r\n            });\r\n        }\r\n        \r\n        //\u8bb0\u5f55\u5f53\u524d\u8f93\u5165\u6846ID\r\n        currentInputId = $(this).attr(\"target\");\r\n        // \u8f93\u5165\u6846\u9009\u4e2d\u9ad8\u4eae\r\n        $(\".inputSelected\").removeClass(\"inputSelected\");\r\n        if(!$(this).hasClass(\"inputSelected\")){\r\n            $(this).addClass(\"inputSelected\");\r\n        }\r\n        \r\n        stopEvent(event);\r\n    });\r\n    \r\n    $(\".mailInput\").live(\"blur\",function(){\r\n        $(this).removeClass(\"inputSelected\");\r\n    });\r\n    \r\n    editorHeight = $(\"#editor\").outerHeight();\r\n    editorHeight = editorHeight;\r\n    \r\n    // \u90ae\u4ef6\u81ea\u52a8\u63d0\u793a\r\n    $(\".clearFrom\").click(function(){\r\n        $(\"#fromSearch\").val(\"\");\r\n        $(\".searchFrom\").show();\r\n        $(\".clearFrom\").hide();\r\n    });\r\n    \r\n    $(\"#fromSearch\").bind(\"propertychange\",function(){\r\n        //\u53ea\u6709\u5f53\u5149\u6807\u4f4d\u4e8e\u6587\u672c\u6846\u5185\u65f6\uff0c\u624d\u89e6\u53d1\u8fd9\u4e2a\u4e8b\u4ef6\r\n        //\u4e0d\u7136\u7684\u7684\uff0c\u5728\u5149\u6807\u79fb\u51fa\u7684\u65f6\u5019\u4e5f\u4f1a\u89e6\u53d1\u8be5\u4e8b\u4ef6\u3010\u5982\u679c\u6b64\u65f6\u6211\u53bb\u70b9\u5c55\u5f00\u5217\u8868\uff0c\u5c55\u4e0d\u5f00\u3011\r\n        if(document.activeElement.id == this.id){\r\n            loadContactsTree();\r\n        }\r\n    })\r\n    \r\n    $(\"#fromSearch\").bind(\"input\",function(){\r\n        loadContactsTree();\r\n    });\r\n    \r\n    /*$(\"div#InternalMiniToolBar\").find(\"span#addsrz\").hover(\r\n        function(){$(this).removeClass(\"spanBtn\").addClass(\"spanBtnOver\")},\r\n        function(){$(this).removeClass(\"spanBtnOver\").addClass(\"spanBtn\")}\r\n    );*/\r\n    \r\n    $(\"#miniToolBar\").find(\"span\").hover(\r\n        function(){$(this).css(\"background-color\",\"#0083ff\")},\r\n        function(){$(this).css(\"background-color\",\"#fff\")}\r\n    );\r\n    \r\n    //\u8f93\u5165\u6846\u6dfb\u52a0\u5220\u9664\u4e8b\u4ef6\u6ce8\u518c\r\n    $(\"#addCc\").bind(\"click\",function(){\r\n        $(\"#addCc\").hide();\r\n        $(\"#delCc\").show();\r\n        if($(\"#isInternal\").is(':checked')){\r\n            $(\"#InternalMail\").find(\".inputCc\").show();\r\n        }else{\r\n            $(\"#ExternalMail\").find(\".inputCc\").show();\r\n        }\r\n    })\r\n    $(\"#delCc\").bind(\"click\",function(){\r\n        $(\"#delCc\").hide();\r\n        $(\"#addCc\").show();\r\n        if($(\"#isInternal\").is(':checked')){\r\n            $(\"#InternalMail\").find(\".inputCc\").hide();\r\n            $(\"#InternalMail\").find(\".inputCc\").find(\"#internalcc\").val(\"\");\r\n            $(\"#internalccDiv\").html(\"\");\r\n        }else{\r\n            $(\"#ExternalMail\").find(\".inputCc\").hide();\r\n            $(\"#ExternalMail\").find(\".inputCc\").find(\"#cc\").val(\"\");\r\n            $(\"#ccDiv\").html(\"\");\r\n        }\r\n    });\r\n    \r\n    $(\"#addBcc\").bind(\"click\",function(){\r\n        $(\"#addBcc\").hide();\r\n        $(\"#delBcc\").show();\r\n        if($(\"#isInternal\").is(':checked')){\r\n            $(\"#InternalMail\").find(\".inputBcc\").show();\r\n        }else{\r\n            $(\"#ExternalMail\").find(\".inputBcc\").show();\r\n        }\r\n    });\r\n    \r\n    $(\"#delBcc\").bind(\"click\",function(){\r\n        $(\"#delBcc\").hide();\r\n        $(\"#addBcc\").show();\r\n        if($(\"#isInternal\").is(':checked')){\r\n            $(\"#InternalMail\").find(\".inputBcc\").hide();\r\n            $(\"#InternalMail\").find(\".inputBcc\").find(\"#internalbcc\").val(\"\");\r\n            $(\"#internalbccDiv\").html(\"\");\r\n        }else{\r\n            $(\"#ExternalMail\").find(\".inputBcc\").hide();\r\n            $(\"#ExternalMail\").find(\".inputBcc\").find(\"#bcc\").val(\"\");\r\n            $(\"#bccDiv\").html(\"\");\r\n        }\r\n    });\r\n    \r\n    $(\"#addContactGroup\").click(function(){\r\n        $(\"#srzulid\").html(\"\"); //\u9632\u6b62\u5185\u5bb9\u91cd\u590d\r\n        diag = new window.top.Dialog();\r\n        diag.currentWindow = window;\r\n        diag.Width = 450;\r\n        diag.Height = 300;\r\n        diag.Title = \"".toCharArray();
    _jsp_string45 = ";\r\nusbusercode0 = ".toCharArray();
    _jsp_string30 = "\r\n	}\r\n	catch(e) {\r\n		return check_conn();\r\n	}\r\n	if(!isconn)\r\n		return check_conn();\r\n    /* end by cyril on 2008-08-14 for td:8521 */\r\n	\r\n	thiswin = thiswins\r\n	items = \",\"+items + \",\";\r\n	\r\n	var tempfieldvlaue1 = \"\";\r\n	try{\r\n		tempfieldvlaue1 = document.getElementById(\"htmlfieldids\").value;\r\n	}catch (e) {\r\n	}\r\n\r\n	for(i=1;i<=thiswin.length;i++){\r\n		tmpname = thiswin.elements[i-1].name;\r\n		tmpvalue = thiswin.elements[i-1].value;\r\n	    if(tmpvalue==null){\r\n	        continue;\r\n	    }\r\n\r\n		if(tmpname!=\"\" && items.indexOf(\",\"+tmpname+\",\")!=-1){		\r\n			var __fieldhtmltype = jQuery(\"input[name=\" + tmpname + \"]\").attr(\"__fieldhtmltype\");\r\n		    if (__fieldhtmltype == '9') {\r\n		        continue;\r\n		    }\r\n		\r\n			var href = location.href;\r\n			if(href && href.indexOf(\"Ext.jsp\")!=-1){\r\n				window.__oriAlert__ = true;\r\n			}\r\n			if(tempfieldvlaue1.indexOf(tmpname+\";\") == -1){\r\n				while(tmpvalue.indexOf(\" \") >= 0){\r\n					tmpvalue = tmpvalue.replace(\" \", \"\");\r\n				}\r\n				while(tmpvalue.indexOf(\"\\r\\n\") >= 0){\r\n					tmpvalue = tmpvalue.replace(\"\\r\\n\", \"\");\r\n				}\r\n\r\n				if(tmpvalue == \"\"){\r\n					if(thiswin.elements[i-1].getAttribute(\"temptitle\")!=null && thiswin.elements[i-1].getAttribute(\"temptitle\")!=\"\"){\r\n						if(window.__oriAlert__){\r\n							window.top.Dialog.alert(\"\\\"\"+thiswin.elements[i-1].getAttribute(\"temptitle\")+\"\\\"\"+\"".toCharArray();
    _jsp_string271 = "'}, {id:'internalcc', name:'".toCharArray();
    _jsp_string145 = "\r\n                                        <input class=\"mailInputHide\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"to\" id=\"to\" value=\"".toCharArray();
    _jsp_string3 = "\r\n	<script language=\"javascript\">\r\n		window.top.Dialog.alert(\"".toCharArray();
    _jsp_string124 = "\">\r\n            \r\n                                        <div class=\"inputdiv mailInput  w-500\" type=\"hrm\" id=\"internaltoDiv\" target=\"internalto\">\r\n                                                            \r\n                                        </div>\r\n                                        \r\n                                    </div>\r\n                                    <div id=\"addsrz\" href=\"#contactAdd\" style=\"position: static;\" class=\"m-l-10 addFrom left\" title=\"".toCharArray();
    _jsp_string167 = "</label>\r\n                            </div>\r\n                            <div class=\"left m-l-15 color666   p-l-15  \">\r\n                                <input class=\" \" type=\"checkbox\" name=\"savesend\" id=\"savesend\" value=\"1\" checked=\"checked\"> <label>".toCharArray();
    _jsp_string306 = "\"){\r\n        jQuery(\"#timeSettingSpan\").show();\r\n        changeCheckboxStatus_1_8_3(jQuery(\"#timeSetting\")[0], true);\r\n        return;\r\n    }\r\n    jQuery(\"#timeSettingSpan\").hide();\r\n});\r\n\r\nfunction showTimeSetting(obj){\r\n    if(obj.checked){\r\n        jQuery(\"#timeSettingSpan\").show();\r\n    }else{\r\n        jQuery(\"#timeSettingSpan\").hide();\r\n        jQuery(\"#timingdate\").val(\"\");\r\n        jQuery(\"#date\").val(\"\");\r\n        jQuery(\"#datespan\").html(\"\");\r\n        jQuery(\"#time\").val(\"\");\r\n        jQuery(\"#timespan\").html(\"\");\r\n    }\r\n}\r\n\r\nfunction check_form(mainForm, element) {\r\n    var element = element.split(\",\");\r\n    for (var i = 0; i < element.length; i++) {\r\n        if (element[i] != \"\") {\r\n            var input = $(mainForm).find(\"input[name='\" + element[i] + \"']\");\r\n            if (input.val() == \"\") {\r\n                var temptitle = input.attr(\"temptitle\");\r\n                var msg = \"".toCharArray();
    _jsp_string31 = "\");\r\n						}else{\r\n							var tempElement = thiswin.elements[i-1];\r\n							//ueditor\u5fc5\u586b\u9a8c\u8bc1\r\n							if (checkueditorContent(tempElement)) {\r\n								continue;\r\n							}\r\n							\r\n							window.top.Dialog.alert(\"&quot;\"+thiswin.elements[i-1].getAttribute(\"temptitle\")+\"&quot;\"+\"".toCharArray();
    _jsp_string189 = "\r\n</ul>\r\n</form>\r\n\r\n<!-- \u6dfb\u52a0\u8054\u7cfb\u4eba -->\r\n<div id=\"contactAdd\" class=\" popWindow hide \"></div>\r\n\r\n<div  id=\"hidedivmsg\" class=\"hide\">\r\n    <div class=\"h-30\"></div>\r\n    <table style=\"width: 100%\">\r\n        <tr class=\"h-35\">\r\n            <td class=\"p-l-30 p-r-15\">\r\n                <span class=\"color333 font12 w-100\">".toCharArray();
    _jsp_string260 = "\"+(parseFloat(total/1024) - parseFloat(".toCharArray();
    _jsp_string187 = "\"><label>".toCharArray();
    _jsp_string169 = "</label>\r\n                            </div>\r\n\r\n                            <div class=\"left p-l-15 color666\" id=\"needReceiptDiv\">\r\n                                <input class=\" p-r-5\" type=\"checkbox\" name='needReceipt' id=\"needReceipt\" value=\"1\"><label>".toCharArray();
    _jsp_string163 = "</button>\r\n                            </div>\r\n                            <div class=\"color666    left m-l-15  p-l-15\"\" id=\"prioritydiv\">\r\n                                ".toCharArray();
    _jsp_string36 = "\");\r\n						}else{\r\n							var tempElement = thiswin.elements[i-1];\r\n							\r\n							//ueditor\u5fc5\u586b\u9a8c\u8bc1\r\n							if (checkueditorContent(tempElement)) {\r\n								continue;\r\n							}\r\n							\r\n							window.top.Dialog.alert(\"&quot;\"+thiswin.elements[i-1].getAttribute(\"temptitle\")+\"&quot;\"+\"".toCharArray();
    _jsp_string89 = "\r\n                                        <input type=\"checkbox\" value=\"1\" class=\"hide\" ".toCharArray();
    _jsp_string303 = "\");\r\n        return;\r\n    }\r\n    var timingdate = date + \" \" + time + \":00\";\r\n    if (new Date(timingdate.replace(/-/g, \"/\")) < new Date()) {\r\n        window.top.Dialog.alert(\"".toCharArray();
    _jsp_string229 = "\";\r\nKindEditor.plugin('project', function(K) {\r\n    var self = this, name = 'project';\r\n    self.clickToolbar(name, function() {\r\n        openApp('project');\r\n    });\r\n});\r\n\r\nKindEditor.zh_cn_lang.workplan = \"".toCharArray();
    _jsp_string186 = "\r\n        <li class=\"\"  style=\"font-weight: normal;line-height: 20px;\" onclick=\"onShowAllResouceLi(this,event)\" ><input type=\"checkbox\" class=\"\" onclick=\"onShowAllResouce(this,event)\" title=\"".toCharArray();
    _jsp_string162 = "</button>\r\n                                <button id=\"savebtn\" class=\"btnGray\" type=\"button\" onclick=\"doSave(this)\">".toCharArray();
    _jsp_string98 = "</option>\r\n                                                            ".toCharArray();
    _jsp_string228 = "';\r\nKindEditor.plugin('doc', function(K) {\r\n    var self = this, name = 'doc';\r\n    self.clickToolbar(name, function() {\r\n        openApp('doc');\r\n    });\r\n});\r\n\r\nKindEditor.zh_cn_lang.project = \"".toCharArray();
    _jsp_string26 = "';\r\n	        	//alert(xmlhttp.responseText);\r\n	        	return confirm(flag_msg);\r\n	        }\r\n	    }\r\n	    xmlhttp = null;\r\n\r\n	  	//\u68c0\u67e5\u591a\u884c\u6587\u672c\u6846 oracle\u4e0b\u68c0\u67e5HTML\u4e0d\u80fd\u8d85\u8fc74000\u4e2a\u5b57\u7b26\r\n	    ".toCharArray();
    _jsp_string236 = ";\r\n                    var templateType = ".toCharArray();
    _jsp_string151 = "\">\r\n                                    <div class=\"inputdiv mailInput w-500\" id=\"ccDiv\" target=\"cc\" style=\"min-height: 28px;cursor: text;padding: 0px\"></div>\r\n                                    \r\n                                    </div>\r\n                                    <div class=\"clear\"></div>\r\n                                </div>\r\n                                    \r\n                                    \r\n                                <div class=\"inputBcc\">\r\n                                    <div class=\" importBtn hand w-60 p-t-5 left\" target=\"bccDiv\">\r\n                                        <div class=\"left \">".toCharArray();
    _jsp_string52 = "\r\n\r\n\r\n<!--For wui-->\r\n".toCharArray();
    _jsp_string111 = "\r\n                                                <input type=\"hidden\" name=\"hrmAccountid\" id=\"hrmAccountid\" value=\"".toCharArray();
    _jsp_string47 = "\";\r\nusblanguage = \"".toCharArray();
    _jsp_string55 = "/skins/".toCharArray();
    _jsp_string243 = "\"+(totalSize/1024).toFixed(2)+\"KB\uff0c".toCharArray();
    _jsp_string226 = "',\r\n            templType: '-1'\r\n        });\r\n        K.each(mailTemplateObjs, function(i, val) {\r\n            menu.addItem({\r\n                title : '<span unselectable=\"on\" title=\"' + val.templName + '\">' + val.templName + '</span>',\r\n                click : function() {\r\n                    if(val.templId != '-1') {\r\n                        loadMailTemplate(val.templId, val.templType);\r\n                    } else {\r\n                        openTemplDialog();\r\n                    }\r\n                    self.hideMenu();\r\n                }\r\n            });\r\n        });\r\n        \r\n        function openTemplDialog() {\r\n            var dialog = new window.top.Dialog();\r\n            dialog.currentWindow = window;\r\n            var url = \"/email/MailTemplate.jsp\";\r\n            dialog.Title = \"".toCharArray();
    _jsp_string71 = "\" />\r\n<input type=\"hidden\" name=\"timingdate\" id=\"timingdate\" value=\"".toCharArray();
    _jsp_string82 = "</div>\r\n                                    <div class=\"left\"  ".toCharArray();
    _jsp_string37 = "\", function () {\r\n								formElementFocus(tempElement);\r\n							});\r\n							\r\n						}\r\n						return false;\r\n					}else{\r\n						if(window.__oriAlert__){\r\n							window.top.Dialog.alert(\"".toCharArray();
    _jsp_string175 = "\"/>\r\n                                </span>\r\n                            </div>\r\n                            <div class=\"clear\"></div>\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n                \r\n                <tr style=\"height:20px;\">\r\n                    <td style=\"height:20px;\"></td>\r\n                </tr>\r\n                \r\n            </table>\r\n        </td>\r\n        <td width=\"208px\" class=\"p-r-5 p-b-5 p-t-5 \">\r\n            \r\n            <table class=\"w-all\" id=\"contacterTab\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\r\n                <tr>\r\n                    <td height=\"31px\">\r\n                        <div id=\"tabTitle\" >\r\n                            \r\n                            <div id=\"internalContacter\">\r\n                                <div id=\"innerHrmTab\" style=\"cursor:pointer;\" class=\"left tab tabSelected tabitem1\" target=\"innerHrmContent\">".toCharArray();
    _jsp_string127 = "</div>\r\n                                        <div class=\" left  relative   \" id=\"addMailsBtn\" style=\"width: 20px;;\">\r\n                                            <img class=\"absolute\" style=\"top:7px;left:5px\" src=\"/email/images/iconDArr_wev8.png\"/>\r\n                                        </div>                                      \r\n                                        <div class=\"clear\"></div>\r\n                                    </div>\r\n                                    <div class=\"color666  w-500 p-t-5 left\">\r\n                                        <!--  <input class=\"w-500\" type=\"hidden\" name=\"to\" id=\"to\" value=\"".toCharArray();
    _jsp_string15 = "\\r\\n\\r\\n".toCharArray();
    _jsp_string214 = "\" == \"1\" || \"".toCharArray();
    _jsp_string211 = "' == '1' || '".toCharArray();
    _jsp_string284 = "...\");   \r\n      break;   \r\n   }\r\n   $(\"#loading\").show();\r\n}\r\n\r\n//\u4fdd\u5b58\u8349\u7a3f\r\nfunction doSave(obj) {\r\n    setinputdatetime();\r\n\r\n    $(\"#savedraft\").val(\"1\");\r\n    $(\"#folderid\").val(\"-2\");\r\n    $(\"#autoSave\").val(\"0\");\r\n    syncMailContent();\r\n\r\n    getRealMailAddress();\r\n    \r\n    if ($(\"#isInternal\").is(':checked')) {\r\n        var swfu = $.swfupload.getInstance('.swfupload-control');\r\n        if (swfu.getStats().files_queued > 0) {\r\n            swfu.setButtonDisabled(true);\r\n            swfu.startUpload();\r\n        } else {\r\n            showLoading('saveing');\r\n            obj.disabled=true;\r\n            jQuery(\"#mailAddForm\").submit();\r\n        }\r\n    } else {\r\n        if ($(\".mailAdError\").length > 0) {\r\n            window.top.Dialog.alert(\"".toCharArray();
    _jsp_string242 = "\"+totalSize+\"B\uff09\");\r\n    }else if(totalSize < 1024*1024){\r\n        jQuery(\"#uploadInfo\").html(\"\uff08100%\uff0c".toCharArray();
    _jsp_string142 = "\">\r\n                                    \r\n                                        <div class=\"inputdiv mailInput  w-500\" type=\"hrm\" id=\"internalbccDiv\" target=\"internalbcc\" style=\"min-height:28px; cursor: text;padding: 0px\">\r\n                                                                    \r\n                                        </div>\r\n                                    </div>\r\n                                    <div class=\"clear\"></div>\r\n                                </div>\r\n                                \r\n                            </div>  \r\n                            <div id=\"ExternalMail\" ".toCharArray();
    _jsp_string135 = "</div>\r\n                                        <div class=\" left  relative   \" id=\"addMailsBtn\" style=\"width: 20px;;\">\r\n                                            <img class=\"absolute\" style=\"top:7px;left:5px\" src=\"/email/images/iconDArr_wev8.png\"/>\r\n                                        </div>\r\n                                        \r\n                                        <div class=\"clear\"></div>\r\n                                    </div>\r\n                                    <div class=\"color666  w-500 p-t-5 left\">\r\n                                        <!--  <input class=\"w-500\" type=\"hidden\" name=\"to\" id=\"to\" value=\"".toCharArray();
    _jsp_string58 = "\r\n    <meta http-equiv=\"".toCharArray();
    _jsp_string62 = "\r\n<!-- \u9875\u9762\u5207\u6362\u6548\u679cEnd -->\r\n\r\n\r\n<script language=\"javascript\">\r\n\r\n//------------------------------\r\n// the folder of current skins \r\n//------------------------------\r\n//\u5f53\u524d\u4f7f\u7528\u7684\u4e3b\u9898\r\nvar GLOBAL_CURRENT_THEME = \"".toCharArray();
    _jsp_string221 = "\");// \u90ae\u4ef6\u5730\u5740\u4e0d\u5b58\u5728\r\n            }\r\n        }           \r\n    });\r\n    stopEvent();\r\n}\r\n\r\nfunction dblclickGroupTree(himself,_pagenum) {\r\n    var mailacounts = $(himself).parent().find(\".contactsGroupContent\").children();\r\n    if(mailacounts.length>0){\r\n        for(var key in mailacounts) {\r\n            var mailaddress = $(mailacounts[key]).attr('_mailaddress');\r\n            if(mailaddress) { \r\n                addAddress(mailaddress);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n//\u963b\u6b62\u4e8b\u4ef6\u5192\u6ce1\r\nfunction stopEvent(event) {\r\n    if (event && event.stopPropagation) { \r\n        event.stopPropagation();\r\n    } else if (window.event) { \r\n        window.event.cancelBubble = true; \r\n    }\r\n}\r\n\r\n\r\n/**\u5c01\u88c5\u7b7e\u540d\u63d2\u4ef6**/\r\nKindEditor.zh_cn_lang.sign = '".toCharArray();
    _jsp_string41 = "\";\r\n   if(!confirm(str)){\r\n       return false;\r\n   }\r\n       return true;\r\n   } \r\n\r\n///*\u6d41\u7a0b\u91cc\u9762\u4f7f\u7528\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u6d41\u7a0b\u5185\u5bb9\u653e\u5230iframe\u91cc\u9762\uff0c\u901a\u8fc7response\u8fd4\u56de\u7684\u65f6\u5019\uff0c\u8981\u8fd4\u56de\u7684\u5230\u5176\u7236\u7a97\u53e3*/\r\nfunction wfforward(wfurl){\r\n	parent.location.href = wfurl;\r\n}\r\n\r\nfunction myescapecode(str)\r\n{\r\n	return encodeURIComponent(str);\r\n}\r\n</script>\r\n\r\n\r\n\r\n<meta http-equiv=Content-Type content=\"text/html; charset=UTF-8\">\r\n<script language=JavaScript> \r\n  var companyname = \"".toCharArray();
    _jsp_string213 = "' != '') {\r\n                $(\"#addCc\").trigger(\"click\");\r\n            } else {\r\n                $(\"#delCc\").trigger(\"click\");\r\n            }\r\n        }\r\n        //\u8bbe\u7f6e\u7c73\u9001\u4eba\u4e3a\u6240\u6709\u4eba\r\n        if (\"".toCharArray();
    _jsp_string113 = "\r\n                                    </div>\r\n                                    \r\n                                    <div class=\"clear\"></div>\r\n                                </div>\r\n                                \r\n                                <div class=\"clear\"></div>\r\n                            </div>\r\n                            \r\n                            <div id=\"InternalMail\"  ".toCharArray();
    _jsp_string194 = "\r\n</style>\r\n\r\n<!-- \u906e\u7f69\u5c42 -->\r\n<DIV id=bgAlpha></DIV>\r\n<div id=\"loading\">  \r\n    <span><img src=\"/images/loading2_wev8.gif\" align=\"absmiddle\"></span>\r\n    <span  id=\"loading-msg\" style=\"font-size:12\">".toCharArray();
    _jsp_string247 = "\", //\r\n        file_types : \"*.*\",\r\n        file_types_description : \"All Files\",\r\n        // file_upload_limit : \"".toCharArray();
    _jsp_string302 = "\")\r\n            return false;\r\n        }\r\n        if ((check_form($G(\"mailAddForm\"), 'to,subject'))) {\r\n            settimingdate(obj);\r\n        }\r\n    }\r\n}\r\n\r\n//\u9a8c\u8bc1\u65f6\u95f4\r\nfunction settimingdate(obj) {\r\n    var date = document.getElementById('date').value;\r\n    var time = document.getElementById('time').value;\r\n    if (\"\" == date || \"\" == time) {\r\n        window.top.Dialog.alert(\"".toCharArray();
    _jsp_string141 = "\">\r\n                                        <input class=\"\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internalbccdpidname\" id=\"internalbccdpidname\" value=\"".toCharArray();
    _jsp_string137 = "\">\r\n                                        <input class=\"mailInputHide\" width=\"20\" style=\"width: 20\" type=\"hidden\" relid=\"internalbcc\" name=\"internalbccdpid\" id=\"internalbccdpid\" value=\"".toCharArray();
    _jsp_string256 = " < 0){\r\n                    window.top.Dialog.alert(\"".toCharArray();
    _jsp_string133 = "\">\r\n                                        <input class=\"\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internalccdpidname\" id=\"internalccdpidname\" value=\"".toCharArray();
    _jsp_string119 = "\">\r\n                                        <input class=\"mailInputHide\" width=\"20\" style=\"width: 20\" type=\"hidden\" relid=\"internalto\" name=\"internaltodpid\" id=\"internaltodpid\" value=\"".toCharArray();
    _jsp_string1 = "\r\n<!DOCTYPE HTML>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<html>\r\n<head>\r\n<!-- \r\n\u6dfb\u52a0\u81f3init.css\r\n<style type=\"text/css\">\r\n	html{height:100%;}\r\n</style>\r\n -->\r\n".toCharArray();
    _jsp_string183 = "</li>\r\n    -->                                             \r\n</ul>\r\n\r\n<ul class=\"btnGrayDropContent importInternalBtnDown hide \" style=\"width: 100px;left: 0px;top:28px;\" >\r\n                                                \r\n    <li class=\"\"  style=\"font-weight: normal;line-height: 20px;\" onclick=\"onShowResource(this)\" >\r\n        <button type=\"button\" class=\"Browser\"  title=\"".toCharArray();
    _jsp_string13 = "_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/messagejs/highslide/highslide-full_wev8.js\"></script>\r\n<script type=\"text/javascript\">\r\n    hs.graphicsDir = '/js/messagejs/highslide/graphics/';\r\n    hs.align = 'center';\r\n    hs.transitions = ['expand', 'crossfade'];\r\n    hs.outlineType = 'rounded-white';\r\n    hs.fadeInOut = true;\r\n</script>\r\n<!-- init.css, \u6240\u6709css\u6587\u4ef6\u90fd\u5728\u6b64\u6587\u4ef6\u4e2d\u5f15\u5165 -->\r\n<link rel=\"stylesheet\" href=\"/css/init_wev8.css\" type=\"text/css\" />\r\n\r\n\r\n<script language=javascript>\r\nwindow[\"_jsessionid\"] = \"".toCharArray();
    _jsp_string230 = "\";\r\nKindEditor.plugin('workplan', function(K) {\r\n    var self = this, name = 'workplan';\r\n    self.clickToolbar(name, function() {\r\n        openApp('workplan');\r\n    });\r\n});\r\n\r\nKindEditor.zh_cn_lang.workflow = \"".toCharArray();
    _jsp_string147 = "</div>\r\n                                    <div name=\"clearAddressee\" _isInternal=0 style=\"position: static;\" class=\"m-l-10 addFrom left\" title=\"".toCharArray();
    _jsp_string202 = "|0|0\")\r\n        jQuery(\"#\" + target).attr(\"disabled\", \"true\");\r\n    } else {\r\n        jQuery(\"#\" + target).html(\"\");\r\n        jQuery(\"#\" + target).attr(\"disabled\", \"\");\r\n    }\r\n    $(\".btnGrayDropContent\").hide();\r\n    stopEvent(event);\r\n}\r\n\r\n//\u6dfb\u52a0email\u5730\u5740\r\nfunction addToInput(targetid, name, input) {\r\n    var div = $(\"#\" + targetid);\r\n    // \u5224\u65ad\u5f53\u524d\u5730\u5740\u662f\u5426\u5df2\u5b58\u5728,\u5b58\u5728\u5219\u4e0d\u80fd\u91cd\u590d\u6dfb\u52a0\r\n    //if(mailIsExist(div,name)){\r\n    //alert(\"".toCharArray();
    _jsp_string176 = "</div>\r\n                                <div id=\"privateTab\" style=\"cursor:pointer;\" class=\"left tab  tabUnSelected tabitem1\" target=\"privateContent\">".toCharArray();
    _jsp_string216 = "' != '') {\r\n                $(\"#addBcc\").trigger(\"click\");\r\n            } else {\r\n                $(\"#delBcc\").trigger(\"click\");\r\n            }\r\n        }\r\n    } else {\r\n        if ('".toCharArray();
    _jsp_string72 = "\"/>\r\n<input type=\"hidden\" name=\"tagetmailid\" id=\"tagetmailid\" value=\"".toCharArray();
    _jsp_string35 = "\");\r\n							}\r\n						}\r\n						return false;\r\n					}\r\n				}\r\n			} else {\r\n				var divttt=document.createElement(\"div\");\r\n				divttt.innerHTML = tmpvalue;\r\n				var tmpvaluettt = jQuery.trim(jQuery(divttt).text());\r\n				if(tmpvaluettt == \"\"){\r\n					if(thiswin.elements[i-1].getAttribute(\"temptitle\")!=null && thiswin.elements[i-1].getAttribute(\"temptitle\")!=\"\"){\r\n						if(window.__oriAlert__){\r\n							window.top.Dialog.alert(\"\\\";\"+thiswin.elements[i-1].getAttribute(\"temptitle\")+\"\\\"\"+\"".toCharArray();
    _jsp_string4 = "\",function(){\r\n			window.top.location=\"".toCharArray();
    _jsp_string263 = "M\");\r\n            }\r\n        })\r\n        .bind('fileDialogComplete', function (event, numFilesSelected, numFilesQueued) {\r\n            $('#queuestatus').text('Files Selected: ' + numFilesSelected + ' / Queued Files: ' + numFilesQueued);\r\n            //setButton();\r\n        })\r\n        .bind('uploadStart', function (event, file) {\r\n            $(\"#\"+file.id).find(\".btnred\").hide();\r\n            $(\"#cur_patch\").text(file.name);\r\n        })\r\n        .bind('uploadProgress', function (event, file, bytesLoaded,bytesTotal) {\r\n            var percentage = Math.round((bytesLoaded / bytesTotal) * 100);\r\n       //   $('#' + file.id).find('.fileProgress').text(percentage + '%');\r\n            $('#' + file.id).find('.fileProgress').progressBar(percentage);\r\n        })\r\n        .bind('uploadSuccess', function (event, file, serverData) {\r\n            //\u5904\u7406\u8fd4\u56de\u503c serverData\r\n            //alert(serverData)\r\n            fileSid = jQuery.trim(serverData);\r\n            $(\"#accids\").val($(\"#accids\").val()+\",\"+jQuery.trim(serverData))\r\n            var swfu = $.swfupload.getInstance('.swfupload-control');\r\n            //\u5224\u65ad\u6240\u6709\u6587\u4ef6\u4e0a\u4f20\u6210\u529f\u540e\uff0c\u8fdb\u884c\u5904\u7406\r\n            fileIdArr[fileIdArr.length] = file.id+\"-\"+serverData;\r\n            \r\n            if( swfu.getStats().files_queued ===0){\r\n                //nextStep();\r\n                //\u63d0\u4ea4\u8868\u5355\r\n            }\r\n        })\r\n        .bind('uploadComplete', function (event, file) {\r\n            var fnamediv = $('#' + file.id).find('.fileName');\r\n            var fvalue = fnamediv.html();\r\n  //        if(checkFileType(fvalue))\r\n  //                fnamediv.html(\"<a href=\\\"javascript:openfile('/email/MailPreView.jsp?fileid=\"+fileSid+\"')\\\" >\"+ fvalue +\" </a>\");           \r\n            // upload has completed, try the next one in the queue\r\n            var swfu = $.swfupload.getInstance('.swfupload-control');\r\n            var html = \"<span style='color:green !important'>".toCharArray();
    _jsp_string286 = "\")\r\n            return false;\r\n        }\r\n        var swfu = $.swfupload.getInstance('.swfupload-control');\r\n        if(swfu.getStats().files_queued >0){\r\n            swfu.setButtonDisabled(true);\r\n            swfu.startUpload();\r\n        }else{\r\n            jQuery.ajax({\r\n                url: '/email/MailOperationSend.jsp',\r\n                data: $('#mailAddForm').serialize(),\r\n                type: \"POST\",\r\n                success: function(data) {\r\n                    var mailid = $.trim(data);\r\n                    $(\"#mailid\").val(mailid);\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * \u9a8c\u8bc1\u90ae\u4ef6\u5730\u5740\u662f\u5426\u5408\u6cd5\r\n */\r\nfunction validateForm() {\r\n    if (validateMailAddress($G(\"to\").value) && validateMailAddress($G(\"cc\").value) && validateMailAddress($G(\"bcc\").value)) {\r\n        return true;\r\n    } else {\r\n        window.top.Dialog.alert(\"".toCharArray();
    _jsp_string50 = "\r\n<LINK href=\"/js/jquery/jquery_dialog_wev8.css\" type=text/css rel=STYLESHEET>\r\n<script type=\"text/javascript\" src=\"/wui/common/jquery/jquery.min_wev8.js\"></script>\r\n<script type=\"text/javascript\" language=\"javascript\" src=\"/js/jquery/jquery_dialog_wev8.js\"></script>\r\n\r\n<script src=\"/social/js/drageasy/drageasy.js\"></script>\r\n<script type=\"text/javascript\" src=\"/social/js/bootstrap/js/bootstrap.js\"></script>\r\n<script type=\"text/javascript\" src=\"/social/im/js/IMUtil_wev8.js\"></script>\r\n\r\n<script type=\"text/javascript\" src=\"/social/js/imcarousel/imcarousel.js\"></script>\r\n<script type=\"text/javascript\" language=\"javascript\">\r\nfunction ReloadOpenerByDialogClose() {\r\n    ".toCharArray();
    _jsp_string277 = "');\r\n            return false;\r\n        }\r\n             \r\n    }\r\n    return true;\r\n}\r\n\r\nfunction check_receiveStr_length(value){\r\n    if(value.length != 0 && value.length > 3900) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\n// \u4fdd\u5b58\u90ae\u4ef6\u5185\u5bb9\r\nfunction syncMailContent() {\r\n    KE.sync('mouldtext'); // \u9700\u8981\u5148\u540c\u6b65\u4e00\u6b21\r\n    var content = '<div class=\"ke-content-new\" style=\"font-size: ".toCharArray();
    _jsp_string143 = ">\r\n                                <div id=\"inputTo\">\r\n                                    <div class=\" importBtn hand w-60 p-t-5 left\" target=\"toDiv\">\r\n                                        <div class=\"left color666\">".toCharArray();
    _jsp_string23 = "\";\r\n					diag.show();\r\n			        return false;\r\n	    		}\r\n	    		else if(response_flag=='2') {\r\n	    			flag_msg = '".toCharArray();
    _jsp_string188 = "</label></li>\r\n    ".toCharArray();
    _jsp_string0 = "\r\n\r\n\r\n\r\n \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string126 = "</div>\r\n                                    <div class=\"clear\"></div>\r\n                                </div>\r\n                                \r\n                                <div class='inputCc'>\r\n                                    <div class=\" importInternalBtn hand w-60 p-t-5 left\" target=\"internalccDiv\">\r\n                                        <div class=\"left \">".toCharArray();
    _jsp_string109 = "\r\n                                                </select>\r\n                                            ".toCharArray();
    _jsp_string102 = "\r\n                                        </select>\r\n                                    ".toCharArray();
    _jsp_string280 = "\");  \r\n        return;\r\n    }\r\n    syncMailContent();\r\n    \r\n    if(jQuery(\"#timeSetting\").is(':checked')){\r\n        $(\"#timingsubmitType\").val(\"submit\");\r\n        timingsubmit(obj);\r\n        return;\r\n    }\r\n\r\n \r\n    $(\"#savedraft\").val(\"0\");\r\n    $(\"#folderid\").val(\"-1\");\r\n    $(\"#autoSave\").val(\"0\");\r\n    \r\n    getRealMailAddress();\r\n    if($(\"#isInternal\").is(':checked')){\r\n        if((check_form($G(\"mailAddForm\"),'internalto,subject'))){\r\n            if(!check_receiveStr(true))\r\n                return;\r\n            var swfu = $.swfupload.getInstance('.swfupload-control');\r\n            if(swfu.getStats().files_queued >0){\r\n                swfu.setButtonDisabled(true);\r\n                swfu.startUpload();\r\n            }else{\r\n                showLoading();\r\n                obj.disabled=true;\r\n                jQuery(\"#mailAddForm\").submit();\r\n            }\r\n        }\r\n    }else{\r\n        if($(\"#mailAccountId\").length==0){\r\n               window.top.Dialog.alert(\"".toCharArray();
    _jsp_string217 = "' != '') {\r\n            $(\"#addCc\").trigger(\"click\")\r\n        } else {\r\n            $(\"#delCc\").trigger(\"click\")\r\n        }\r\n        if ('".toCharArray();
    _jsp_string174 = "</span><input type=\"hidden\" name=\"time\" id=\"time\"  value=\"".toCharArray();
    _jsp_string159 = "\r\n                                    <div id=\"progressDemo\" class=\"hide\">\r\n                                        <div class=\"left m-t-3\" style=\"background: url(/email/images/mailicon_wev8.png) -65px 0px  no-repeat ;width: 16px;height: 16px;\">&nbsp;</div>\r\n                                        <div class=\"left fileName p-b-3\"  ></div>\r\n                                        <div class=\"left fileSize p-l-5\" ></div>\r\n                                        <div class=\"left p-l-15 \" ><div class=\"fileProgress m-b-5\">".toCharArray();
    _jsp_string250 = "){\r\n                window.top.Dialog.alert(\"".toCharArray();
    _jsp_string181 = "\"></button>".toCharArray();
    _jsp_string110 = "\r\n                                                ".toCharArray();
    _jsp_string53 = "\r\n".toCharArray();
    _jsp_string10 = "\r\n<script language=\"javascript\" type=\"text/javascript\" src=\"/FCKEditor/swfobject_wev8.js\"></script>\r\n\r\n".toCharArray();
    _jsp_string146 = "\">\r\n                                        \r\n                                        <div class=\"inputdiv mailInput  w-500\" id=\"toDiv\" target=\"to\" style=\"min-height:28px; cursor: text;padding: 0px\">\r\n                                            \r\n                                        </div>\r\n                                        \r\n                                    </div>\r\n                                    <div id=\"addContactGroup\" style=\"position: static;\" class=\"m-l-10 addFrom left\" title=\"".toCharArray();
    _jsp_string148 = "</div>\r\n                                    <div class=\"clear\"></div>\r\n                                </div>\r\n                                \r\n                                \r\n                                \r\n                                <div class=\"inputCc\">\r\n                                    <div class=\" importBtn hand w-60 p-t-5 left\" target=\"ccDiv\">\r\n                                        <div class=\"left \">".toCharArray();
    _jsp_string273 = "'},{id:'internaltodpid', name:'".toCharArray();
    _jsp_string223 = "\r\n        K.each(".toCharArray();
    _jsp_string49 = "\r\n\r\n<!--WUI -->\r\n".toCharArray();
    _jsp_string200 = "',\r\n        arguments: '',\r\n        _callback: departmentBrowserCallback\r\n    });\r\n}\r\n\r\n// \u90e8\u95e8\u9009\u62e9\u6846\u56de\u8c03\r\nfunction departmentBrowserCallback(event, data, name, oldid) {\r\n    if (data != null) {\r\n        if (data.id != \"\") {\r\n            var _ids = data.id.split(\",\");\r\n            var _names = data.name.split(\",\");\r\n            var div = $(\"#\" + target);\r\n            for (var i = 0; i < _names.length; i++) {\r\n                if (_ids[i] != \"\") {\r\n                    addToInput(target, _names[i] + \"|0|\" + _ids[i])\r\n                }\r\n            }\r\n        } else {\r\n            //var div = $(\"#\" + target);\r\n        }\r\n    }\r\n}\r\n\r\nfunction onShowAllResouceLi(obj, event) {\r\n    if (jQuery(event.srcElement).closest(\".jNiceCheckbox\").length != 0 || jQuery(event.srcElement).closest(\".jNiceHidden\").length != 0) {\r\n        return;\r\n    }\r\n    var target = $(obj).parent().attr(\"target\");\r\n    if ($(obj).find(\"input:checkbox\").is(':checked') == true) {\r\n        changeCheckboxStatus_1_8_3($(obj).find(\"input:checkbox\")[0], false);\r\n        $(\"#\" + target).html(\"\");\r\n        $(\"#\" + target).attr(\"disabled\", \"\");\r\n    } else {\r\n        changeCheckboxStatus_1_8_3($(obj).find(\"input:checkbox\")[0], true);\r\n        addToInput(target, \"".toCharArray();
    _jsp_string40 = "\";\r\n   if(!confirm(str)){\r\n       return false;\r\n   }\r\n       return true;\r\n } \r\n\r\nfunction issubmit(){\r\n	var str = \"".toCharArray();
    _jsp_string208 = "?', function(){\r\n            var isInternal = self.attr(\"_isInternal\");\r\n            if(isInternal == '1') {\r\n                $(\"#internaltoDiv\").html('');\r\n            } else if(isInternal == '0') {\r\n                $('#toDiv').html('');\r\n            }\r\n        });\r\n    });\r\n    \r\n    $(\"#addsrz\").bind(\"click\",function(){\r\n        var ids = \"\";\r\n        $(\"#internaltoDiv\").find(\".mailAdItem[value!=0]\").each(function(){\r\n            ids += \",\" + $(this).attr(\"value\");\r\n        });\r\n        \r\n        diag = new window.top.Dialog();\r\n        diag.currentWindow = window;\r\n        diag.Width = 500;\r\n        diag.Height = 300;\r\n        diag.Title = \"".toCharArray();
    _jsp_string220 = "\");\r\n                return ;\r\n            }\r\n            var dialogFlag=0;\r\n            $.each(data,function(idx,item){\r\n            if(item.email!=\"\")                                  \r\n                addAddress(item.text+\"<\"+item.email+\">\");\r\n            else\r\n                dialogFlag=1;\r\n            });\r\n            if(dialogFlag==1){\r\n                    window.top.Dialog.alert(\"".toCharArray();
    _jsp_string125 = "</div>\r\n                                    <div name=\"clearAddressee\" _isInternal=1 style=\"position: static;\" class=\"m-l-10 addFrom left\" title=\"".toCharArray();
    _jsp_string101 = "</option>\r\n                                                                ".toCharArray();
    _jsp_string207 = "\";\r\n        diag.URL = \"/email/new/ContactsGroupOutter.jsp\";\r\n        diag.show();\r\n        //$(\"#hidedivmsg\").show();\r\n    });\r\n    \r\n    // \u6e05\u7a7a\u6536\u4ef6\u4eba \u6309\u94ae\u4e8b\u4ef6\r\n    $('div[name=\"clearAddressee\"]').click(function(){\r\n        var self = $(this);\r\n        window.top.Dialog.confirm('".toCharArray();
    _jsp_string172 = "</SPAN><input type=\"hidden\" name=\"date\" id=\"date\" value=\"".toCharArray();
    _jsp_string22 = "\";\r\n					//diag.InvokeElementId=\"pageOverlay\"\r\n					diag.URL = \"/wui/theme/ecology7/page/loginSmall.jsp?username=".toCharArray();
    _jsp_string215 = "\" != \"\") {\r\n            $(\"#addBcc\").trigger(\"click\");\r\n        } else {\r\n            if ('".toCharArray();
    _jsp_string156 = "</span>\r\n                                </div>\r\n                                <div class=\"clear\"></div>\r\n                            </div>\r\n                            \r\n                            \r\n                            <div style=\"padding-left: 60px;\" class=\"p-b-10\">\r\n                                <div class=\"color666 w-60 p-t-5 left m-r-20\">\r\n                                    <div class=\"swfupload-control left hand\">\r\n                                        <span id=\"spanButtonPlaceholder\" >".toCharArray();
    _jsp_string139 = "\">\r\n                                        <input class=\"\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internalbcchrmname\" id=\"internalbcchrmname\" value=\"".toCharArray();
    _jsp_string95 = " >\r\n                                            ".toCharArray();
    _jsp_string88 = "</span></label>\r\n                                        ".toCharArray();
    _jsp_string66 = "\r\n\r\n<link href=\"/email/css/base_wev8.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<script type=\"text/javascript\">var languageid=".toCharArray();
    _jsp_string298 = "\")\r\n     }else{\r\n         return false;\r\n     } */\r\n}\r\n\r\n//\u6253\u5f00\u5e94\u7528\u7a0b\u5e8f\r\nfunction openApp(type) {\r\n    var editorId = \"mouldtext\";\r\n    onShowApp(type);\r\n}\r\n\r\nfunction onShowApp(type) {\r\n    var id1;\r\n    var url;\r\n    if (type == 'doc') {\r\n        id1 = window.showModalDialog(\"/docs/DocBrowserMain.jsp?url=/docs/docs/MutiDocBrowser.jsp?documentids=\");\r\n        url = \"/docs/docs/DocDsp.jsp?id=\";\r\n    } else if (type == 'project') {\r\n        id1 = window.showModalDialog(\"/systeminfo/BrowserMain.jsp?url=/proj/data/MultiProjectBrowser.jsp?projectids=\");\r\n        url = \"/proj/data/ViewProject.jsp?ProjID=\";\r\n    } else if (type == 'task') {\r\n        id1 = window.showModalDialog(\"/systeminfo/BrowserMain.jsp?url=/proj/data/MultiTaskBrowser.jsp?resourceids=\");\r\n        url = \"/proj/process/ViewTask.jsp?taskrecordid=\";\r\n    } else if (type == 'crm') {\r\n        id1 = window.showModalDialog(\"/systeminfo/BrowserMain.jsp?url=/CRM/data/MutiCustomerBrowser.jsp?resourceids=\");\r\n        url = \"/CRM/data/ViewCustomer.jsp?CustomerID=\";\r\n    } else if (type == 'workflow') {\r\n        id1 = window.showModalDialog(\"/systeminfo/BrowserMain.jsp?url=/workflow/request/MultiRequestBrowser.jsp?resourceids=\");\r\n        url = \"/workflow/request/ViewRequest.jsp?requestid=\"\r\n    } else if (type == \"workplan\") {\r\n        id1 = window.showModalDialog(\"/systeminfo/BrowserMain.jsp?url=/workplan/data/WorkplanEventsBrowser.jsp\");\r\n        url = \"/workplan/data/WorkPlanDetail.jsp?workid=\"\r\n    }\r\n\r\n    if (id1) {\r\n        var ids = id1.id;\r\n        var names = id1.name;\r\n        var desc = id1.resourcedesc\r\n        if (ids.length > 500) window.top.Dialog.alert(\"".toCharArray();
    _jsp_string233 = "\";\r\nKindEditor.plugin('task', function(K) {\r\n    var self = this, name = 'task';\r\n    self.clickToolbar(name, function() {\r\n        openApp('task');\r\n    });\r\n});\r\n// \u91cd\u65b0\u6267\u884c\u4e00\u6b21\u8bed\u8a00\u521d\u59cb\u5316\r\nKindEditor.lang(KindEditor.zh_cn_lang, 'zh-CN');\r\n\r\nvar isEdtiorFirstReady = false;\r\n// \u521d\u59cb\u5316html\u7f16\u8f91\u5668\r\nfunction highEditor(remarkid, height, type) {\r\n\r\n    if(!isEdtiorFirstReady) {\r\n        height = $(document).height() - 270;\r\n    } else {\r\n        height = KE.util.getHeight(remarkid);\r\n    }\r\n\r\n    height = !height || height < 150 ? 150 : height;\r\n    if (jQuery(\"#\" + remarkid).is(\":visible\")) {\r\n        var items;\r\n        if(type == 1){\r\n            items = [\r\n                'source', '|', \r\n                //'undo', 'redo', '|',\r\n                'bold', 'italic', 'underline', 'strikethrough', '|',\r\n                'formatblock', 'fontname', 'fontsize', 'forecolor', 'hilitecolor', '|', \r\n                'justifyleft', 'justifycenter', 'justifyright', 'indent', 'outdent', '|', \r\n                'insertorderedlist', 'insertunorderedlist', '|',\r\n                'image', 'link', 'unlink', '|',\r\n                'table', 'hr', '|',\r\n                'sign', 'mailTemplate', 'doc', 'workplan','workflow','crm','project','task', '|',\r\n                'fullscreen'\r\n            ];\r\n        } else {\r\n            items = [\r\n                'source', '|', \r\n                //'undo', 'redo', '|',\r\n                'bold', 'italic', 'underline', 'strikethrough', '|',\r\n                'formatblock', 'fontname', 'fontsize', 'forecolor', 'hilitecolor', '|', \r\n                'justifyleft', 'justifycenter', 'justifyright', 'indent', 'outdent', '|', \r\n                'insertorderedlist', 'insertunorderedlist', '|',\r\n                'image', 'link', 'unlink', '|',\r\n                'table', 'hr', '|',\r\n                'sign', 'mailTemplate', '|',\r\n                'fullscreen'\r\n            ];\r\n        }\r\n        var default_config = {\r\n            id : remarkid,\r\n            filterMode: false,\r\n            items: items,\r\n            height: height,\r\n            width: '100%',\r\n            resizeType: 1,\r\n            uploadJson: '/email/new/upload_json.jsp',\r\n            allowFileManager: false,\r\n            cssData: 'body, td {font-size: ".toCharArray();
    _jsp_string29 = "')) {\r\n				    lenck = false;\r\n				    break;\r\n			    }\r\n		    }\r\n		    if(lenck==false) return false;\r\n	    }\r\n	    catch(e) {}\r\n	    ".toCharArray();
    _jsp_string234 = ";} table.ke-zeroborder td{border: 0;}',\r\n            mofontsize: '".toCharArray();
    _jsp_string153 = "\">\r\n                                    \r\n                                    <div class=\"inputdiv mailInput w-500\" id=\"bccDiv\"  target=\"bcc\" style=\"min-height:28px;cursor: text;padding: 0px\">\r\n                                                \r\n                                    </div>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>\r\n                                    <div class=\"clear\"></div>\r\n                                </div>\r\n                            </div>  \r\n                            \r\n                            <div>\r\n                                <div class=\"color666 w-60 p-t-5 left\">".toCharArray();
    _jsp_string304 = "\");\r\n        return;\r\n    }\r\n    jQuery(\"#timingdate\").val(timingdate);\r\n    var swfu = $.swfupload.getInstance('.swfupload-control');\r\n    if (swfu.getStats().files_queued > 0) {\r\n        swfu.setButtonDisabled(true);\r\n        swfu.startUpload();\r\n    } else {\r\n        showLoading();\r\n        obj.disabled=true;\r\n        jQuery(\"#mailAddForm\").submit();\r\n    }\r\n}\r\n\r\nfunction setinputdatetime() {\r\n    var date = document.getElementById('date').value;\r\n    var time = document.getElementById('time').value;\r\n    if (\"\" == date || \"\" == time) {\r\n        return;\r\n    }\r\n    var timingdate = date + \" \" + time + \":00\";\r\n    if (new Date(timingdate.replace(/-/g, \"/\")) < new Date()) {\r\n        return;\r\n    }\r\n    $(\"#timingsubmitType\").val(\"save\");\r\n    jQuery(\"#timingdate\").val(timingdate);\r\n}\r\n\r\n$(function(){\r\n    if(\"1\" == \"".toCharArray();
    _jsp_string279 = " <= 0){\r\n        window.top.Dialog.alert(\"".toCharArray();
    _jsp_string166 = "\r\n                                        <label>".toCharArray();
    _jsp_string164 = "\r\n                                        <input type=\"checkbox\"  name=\"priority\" id=\"priority\" value=\"1\" checked=\"checked\">\r\n                                    ".toCharArray();
    _jsp_string80 = "</div>\r\n                                            <div id=\"delBcc\" class=\"left\" style=\"text-align:center;width:100%\">".toCharArray();
    _jsp_string269 = ";//\u662f\u5426\u624b\u52a8\u4fee\u6539\u8fc7\u90ae\u4ef6\u4e3b\u9898\r\nfunction setSubject(){\r\n    var subject = $(\"#subject\").val();\r\n\r\n    if(\"".toCharArray();
    _jsp_string191 = "</span>\r\n            </td>\r\n            <td>\r\n                <div class=\"w-300\">\r\n                    <ul style=\"overflow: auto;;height: 100px;\" id=\"srzulid\">\r\n                    </ul>\r\n                </div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n</div>\r\n<style>\r\n    .closeLb{\r\n        background: url(\"/email/images/closeNew_wev8.png\") left center;\r\n        background-repeat: no-repeat;\r\n        width: 18px;\r\n        height: 20px;\r\n        margin-right: 5px;\r\n        z-index: 10000;\r\n    }\r\n\r\n".toCharArray();
    _jsp_string264 = "</span>\";\r\n            if(fileSid == '0' || typeof(fileSid) == 'undefined' || fileSid == '') {\r\n                html = \"<span style='color:red !important'>".toCharArray();
    _jsp_string128 = "\r\n                                        <input class=\"mailInputHide\" width=\"20\" style=\"width: 20\" type=\"hidden\" name=\"internalcc\" id=\"internalcc\" value=\"".toCharArray();
    _jsp_string103 = "\r\n                                    </div>\r\n                                    \r\n                                    \r\n                                    \r\n                                    <div id=\"sendInternalFromDiv\" class=\"m-t-5 ".toCharArray();
    _jsp_string60 = ",transition=".toCharArray();
    _jsp_string59 = "\" content=\"revealTrans(duration=".toCharArray();
    _jsp_string241 = "\"+totalSize+\"B\uff0c".toCharArray();
    _jsp_string288 = "\"); //\u8bf7\u5c06\u7f16\u8f91\u5668\u5207\u6362\u5230\u53ef\u89c6\u5316\u6a21\u5f0f\uff01\r\n    }\r\n}\r\n\r\n// \u6dfb\u52a0\u64cd\u4f5c\u8005\r\nfunction addAddress(address){\r\n    var div = $(\".mailInput[target='\"+currentInputId+\"']\");\r\n    if(div.hasClass(\"inputSelected\")!='true'){\r\n        div.addClass(\"inputSelected\");\r\n    }\r\n    addToInput(div.attr(\"id\"),address)\r\n}\r\n\r\n// \u52a0\u8f7d\u90ae\u4ef6\u5185\u5bb9\r\nfunction loadMailContent() {\r\n    $.post(\"/email/new/MailManageOperation.jsp?operation=getMailcontent\",\"\",function(data){\r\n        var d = jQuery.trim(data)\r\n        var obj = eval('('+d+')')\r\n        //KE.insertHtml(\"mouldtext\", obj.mailcontent);\r\n        KE.html(\"mouldtext\", obj.mailcontent);\r\n        //KE.util.focus(\"mouldtext\");\r\n        /*\r\n        setTimeout(function(){\r\n            var g = KE.g[\"mouldtext\"];\r\n            var obj=g.iframeDoc.body;\r\n            obj.focus(); \r\n            var len = obj.innerHTML.length; \r\n            //IE\r\n            if (g.iframeDoc.selection) { \r\n                var sel = g.iframeDoc.selection.createRange(); \r\n                sel.moveStart('character',-len); \r\n                sel.collapse(true); \r\n                sel.select(); \r\n            } \r\n            else{                                                 \r\n                var sel = g.iframeWin.getSelection();\r\n                var range = g.iframeDoc.createRange();\r\n                range.setStart(obj, 0);\r\n                range.collapse(false);\r\n                sel.removeAllRanges();\r\n                sel.addRange(range);\r\n            }\r\n        },500);\r\n         */\r\n    });\r\n}\r\n\r\n//\u52a0\u8f7d\u90ae\u4ef6\u6a21\u7248\r\nfunction loadMailTemplate(mailTemplateId, mailTemplateType, isdefault) {\r\n    if (isdefault == 1) {\r\n        if (mailTemplateId == 0) { //\u6e05\u7a7a\u6a21\u677f\u5185\u5bb9\r\n            KE.insertHtml(\"mouldtext\", \"\"); //\u6e05\u7a7a\u7f16\u8f91\u5668\u5185\u5bb9\r\n            return false;\r\n        }\r\n        $.ajax({\r\n            url: '/email/MailTemplateTemp.jsp?id=' + mailTemplateId + '&templateType=' + mailTemplateType + '&userId=".toCharArray();
    _jsp_string274 = "'},{id:'internalccdpid', name:'".toCharArray();
    _jsp_string28 = "','".toCharArray();
    _jsp_string24 = "';\r\n	    		}\r\n	    		//\u4e3b\u4ece\u5e10\u6237\u7279\u6b8a\u5904\u7406 by alan for TD10156\r\n	    		if(response_flag=='3') {\r\n	    			flag_msg = '".toCharArray();
    _jsp_string265 = "</span>\"; \r\n                window.top.Dialog.alert(\"".toCharArray();
    _jsp_string70 = "\">\r\n<input type=\"hidden\" name=\"delaccids\" id=\"delaccids\" value=\"\">\r\n<input type=\"hidden\" name=\"folderid\" id=\"folderid\" />\r\n<input type=\"hidden\" name=\"operation\" id=\"operation\" />\r\n<input type=\"hidden\" name=\"attachmentCount\" id=\"attachmentCount\" value=\"-1\" />\r\n<input type=\"hidden\" name=\"savedraft\" id=\"savedraft\" value=\"0\" />\r\n<input type=\"hidden\" name=\"timingsubmitType\" id=\"timingsubmitType\"/>\r\n<input type=\"hidden\" name=\"msgid\" id=\"msgid\" value=\"\" />\r\n<input type=\"hidden\" name=\"location\" id=\"location\" value=\"1\" />\r\n<input type=\"hidden\" name=\"flag\" id=\"flag\" value=\"".toCharArray();
    _jsp_string255 = "){\r\n                var swfu = $.swfupload.getInstance('.swfupload-control');\r\n                swfu.cancelUpload(file.id);\r\n                \r\n                if(".toCharArray();
    _jsp_string192 = "\r\n/* Used for the Switch effect: */\r\n    .cb-enable {  display: block; float: left; }\r\n\r\n    .cb-enable span {  background-position-x: left;background-position-y: -25px;padding: 0 10px;  }\r\n\r\n    .cb-disable {  display: block; float: left; }\r\n\r\n    .cb-disable span {  background-position-x: right;background-position-y: -25px;padding: 0 10px;  }\r\n\r\n    .cb-enable span, .cb-disable span { line-height: 25px; display: block; background-repeat: no-repeat; font-weight: bold; }\r\n\r\n    .selected { background-repeat: repeat-x; background-position: left -50px; }\r\n\r\n    .selected span { background-repeat: no-repeat; background-position-y: -75px; color: #fff; }\r\n    \r\n    .switch label { cursor: pointer; }\r\n    ".toCharArray();
    _jsp_string39 = "\");\r\n						}\r\n						return false;\r\n					}\r\n				}\r\n			}\r\n		}\r\n	}\r\n	return true;\r\n}\r\n\r\nfunction isdel(){\r\n	var str = \"".toCharArray();
    _jsp_string281 = "\");\r\n               return;\r\n        }\r\n        if($(\".mailAdError\").length>0){\r\n            window.top.Dialog.alert(\"".toCharArray();
    _jsp_string205 = "\"); // \u90ae\u4ef6\u5730\u5740\u4e0d\u5b58\u5728\r\n            }\r\n            autoDivHeight(div)\r\n            input.value = \"\";\r\n            $(input).parent().remove();\r\n            div.click();\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction autoDivHeight(div) {\r\n    div.find(\".clear\").remove();\r\n    div.append(\"<div class='clear'></div>\")\r\n    if (div.height() > 100) {\r\n        if (!div.hasClass(\"mailInputOverDisplay\")) {\r\n            div.addClass(\"mailInputOverDisplay\")\r\n        }\r\n    } else if (div.height() < 90) {\r\n        if (div.hasClass(\"mailInputOverDisplay\")) {\r\n            div.removeClass(\"mailInputOverDisplay\")\r\n        }\r\n    }\r\n}\r\n\r\n// \u5224\u65ad\u90ae\u7bb1\u5730\u5740\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u5b58\u5728\u5c31\u4e0d\u7ee7\u7eed\u6dfb\u52a0\u4e86\r\nfunction mailIsExist(div, name) {\r\n    var isExist = false;\r\n    if (div.attr(\"type\") == \"hrm\") {\r\n        var list = name.split(\"|\");\r\n        //\u6240\u6709\u4eba\r\n        if (div.find(\".mailAdItem[value='0'][dpid='0']\").length > 0) {\r\n            isExist = true;\r\n        }\r\n\r\n        //\u4eba\u5458\r\n        if (div.find(\".mailAdItem[dpid='\" + list[2] + \"'][value='\" + list[1] + \"']\").length > 0) { // \u5224\u65ad\u662f\u5426\u6709\u76f8\u540c\u4eba\u5458\r\n            isExist = true;\r\n        }\r\n\r\n        //\u90e8\u95e8\r\n        if (list[1] != 0) { // \u5224\u65ad\u662f\u8be5\u4eba\u5458\u90e8\u95e8\u5df2\u5b58\u5728\r\n            if (div.find(\".mailAdItem[dpid='\" + list[2] + \"'][value='0']\").length > 0) {\r\n                isExist = true;\r\n            }\r\n        } else {\r\n            if (list[2] == 0) {\r\n                //div.find(\".mailAdItem\").remove();\r\n            } else {\r\n                //div.find(\".mailAdItem[dpid=\"+list[2]+\"][value!='0']\").remove();\r\n            }\r\n        }\r\n    } else {\r\n        //var re = /([0-9A-Za-z\\-_\\.]+)@([0-9a-z]+\\.[a-z]{2,3}(\\.[a-z]{2})?)/gi;\r\n        var re = /([\\w\\-\\.]+@[\\w\\-\\.]+(\\.\\w+)+?)/gi;\r\n        var tmpemail = name.match(re);\r\n        if (div.find(\".mailAdItem[title='\" + tmpemail + \"']\").length > 0) {\r\n            isExist = true;\r\n        }\r\n    }\r\n    return isExist;\r\n}\r\n\r\n\r\nvar saveIntervalfn;\r\n// \u9875\u9762\u52a0\u8f7d\u5b8c\u6210\u4e8b\u4ef6\r\njQuery(document).ready(function(){\r\n    jQuery('body').jNice();\r\n    \r\n    $(\".closeLb\").live(\"click\",function(event){\r\n        var div = $(this).parent().parent().parent();   \r\n        if (div[0].clientWidth < div[0].offsetWidth-4){   \r\n            //\u6267\u884c\u76f8\u5173\u811a\u672c\u3002   \r\n        } else{\r\n            div.removeClass(\"mailInputOverDisplay\");    \r\n        }\r\n        //\u6e05\u9664\u6240\u6709\u4eba\u9009\u9879\r\n        var target=jQuery(this).parent().parent().parent().attr(\"id\");\r\n        var targetCheckbox =  $(\"ul[target='\"+target+\"']\").find(\"input:checkbox\");\r\n        if(targetCheckbox.is(':checked')==true){\r\n            changeCheckboxStatus_1_8_3(targetCheckbox[0],false);\r\n        }\r\n        jQuery(this).parent().parent().parent().removeAttr(\"disabled\");\r\n        $(this).parent().parent().remove(); \r\n        \r\n        //alert(div.html())\r\n        \r\n        if (event.stopPropagation) { \r\n            // this code is for Mozilla and Opera \r\n            event.stopPropagation(); \r\n        } \r\n        else if (window.event) { \r\n            // this code is for IE \r\n            window.event.cancelBubble = true; \r\n        }\r\n    })\r\n    \r\n      //\u8bbe\u7f6e\u90ae\u4ef6\u7c7b\u578b\r\n     // if('".toCharArray();
    _jsp_string112 = "\"/>\r\n                                            ".toCharArray();
    _jsp_string283 = "...\");\r\n      break;\r\n      default:\r\n         $(\"#loading-msg\").html(\"".toCharArray();
    _jsp_string270 = "\" == 5){//\u8349\u7a3f\u7bb1\u91cd\u65b0\u7f16\u8f91\r\n        return;\r\n    }\r\n    if(autoChangeSubject && \"\"!= subject){//\u4eba\u4e3a\u4fee\u6539\u8fc7\u90ae\u4ef6\u4e3b\u9898\uff0c\u4e14\u4e3b\u9898\u4e0d\u4e3a\u7a7a\uff0c\u5219\u4e0d\u91cd\u65b0\u8bbe\u7f6e\r\n        return; \r\n    }\r\n\r\n    if(arr.length > 0 ){//\u6709\u9644\u4ef6\uff0c\u5219\u5c06\u7b2c\u4e00\u4e2a\u9644\u4ef6\u540d\u79f0\u8d4b\u7ed9\u6807\u9898\r\n        var title = arr[0];\r\n        title = title.substring(title.indexOf(\":\")+1);\r\n        $(\"#subject\").val(title);\r\n        return;\r\n    }\r\n    \r\n    \r\n    if(!autoChangeSubject && arr.length == 0){//\u6ca1\u6709\u9644\u4ef6\uff0c\u4e14\u5ba2\u6237\u4e5f\u6ca1\u6709\u4fee\u6539\u8fc7\u6807\u9898\uff0c\u5219\u6807\u9898\u8bbe\u4e3a\u7a7a\r\n        $(\"#subject\").val(\"\");\r\n    }\r\n    \r\n}\r\n\r\n$(function(){\r\n    $(\"#subject\").change(function(){\r\n        autoChangeSubject = true;\r\n    });\r\n});\r\n\r\n//\u5728\u63d0\u4ea4\u8868\u5355\u7684\u65f6\u5019\u5c06div\u4e2d\u7684\u6536\u4ef6\u4eba\u90ae\u7bb1\u5730\u5740\u7ec4\u88c5\u597d\uff0c\u5199\u5165\u5bf9\u5e94\u7684input\u6846\u4e2d\r\nfunction getRealMailAddress(){\r\n    $(\".mailInputHide\").val(\"\");\r\n    $(\".mailAdOK\").each(function(index) {\r\n        if($(this).parent().attr(\"type\")==\"hrm\"){\r\n            var value = $(\"#\"+$(this).parent().attr(\"target\")).val()\r\n            var dpvalue =  $(\"#\"+$(this).parent().attr(\"target\")+\"dpid\").val()\r\n            if($(this).attr(\"dpid\")*1==0&&$(this).attr(\"value\")*1==0){\r\n                $(\"#\"+$(this).parent().attr(\"target\")+\"all\").val(1);\r\n                $(\"#\"+$(this).parent().attr(\"target\")).val('0')\r\n                $(\"#\"+$(this).parent().attr(\"target\")+\"dpid\").val('0')\r\n            }else if($(this).attr(\"dpid\")*1!=0&&$(this).attr(\"value\")*1==0){\r\n                dpvalue = dpvalue+$(this).attr(\"dpid\")+\",\"\r\n                $(\"#\"+$(this).parent().attr(\"target\")+\"dpid\").val(dpvalue)\r\n            }else{\r\n                value =value+ $(this).attr(\"value\")+\",\"\r\n                $(\"#\"+$(this).parent().attr(\"target\")).val(value)\r\n            }\r\n        }else{ \r\n            var value = $(\"#\"+$(this).parent().attr(\"target\")).val()\r\n            value =value+ $(this).attr(\"title\")+\",\"\r\n            $(\"#\"+$(this).parent().attr(\"target\")).val(value)\r\n        }\r\n     });\r\n    if($(\"#internalto\").val()==''&&($(\"#internaltodpid\").val()!=''||$(\"#internaltoall\").val()!='')){\r\n        $(\"#internalto\").val(\"0\")\r\n    }\r\n}\r\n\r\nfunction check_receiveStr(isInternal){\r\n    var attrs = [];\r\n    if(isInternal){\r\n        attrs = [{id:'internalto', name:'".toCharArray();
    _jsp_string262 = "\");\r\n                this.startUpload()\r\n            }\r\n            if(errorCode==-110){\r\n                window.top.Dialog.alert(\"".toCharArray();
    _jsp_string76 = "\r\n    <input type=\"hidden\" name=\"mailid\" id=\"mailid\" value=\"\" />\r\n".toCharArray();
    _jsp_string105 = "\r\n                                                <select name=\"hrmAccountid\" id=\"hrmAccountid\">\r\n                                                    ".toCharArray();
    _jsp_string2 = "\r\n\r\n".toCharArray();
  }
}
