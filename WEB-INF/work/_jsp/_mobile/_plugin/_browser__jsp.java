/*
 * JSP generated by Resin-3.1.8 (built Mon, 17 Nov 2008 12:15:21 PST)
 */

package _jsp._mobile._plugin;
import javax.servlet.*;
import javax.servlet.jsp.*;
import javax.servlet.http.*;
import weaver.general.Util;
import weaver.hrm.HrmUserVarify;
import weaver.hrm.User;
import weaver.mobile.webservices.common.BrowserAction;

public class _browser__jsp extends com.caucho.jsp.JavaPage
{
  private static final java.util.HashMap<String,java.lang.reflect.Method> _jsp_functionMap = new java.util.HashMap<String,java.lang.reflect.Method>();
  private boolean _caucho_isDead;
  
  public void
  _jspService(javax.servlet.http.HttpServletRequest request,
              javax.servlet.http.HttpServletResponse response)
    throws java.io.IOException, javax.servlet.ServletException
  {
    javax.servlet.http.HttpSession session = request.getSession(true);
    com.caucho.server.webapp.WebApp _jsp_application = _caucho_getApplication();
    javax.servlet.ServletContext application = _jsp_application;
    com.caucho.jsp.PageContextImpl pageContext = _jsp_application.getJspApplicationContext().allocatePageContext(this, _jsp_application, request, response, null, session, 8192, true, false);
    javax.servlet.jsp.PageContext _jsp_parentContext = pageContext;
    javax.servlet.jsp.JspWriter out = pageContext.getOut();
    final javax.el.ELContext _jsp_env = pageContext.getELContext();
    javax.servlet.ServletConfig config = getServletConfig();
    javax.servlet.Servlet page = this;
    response.setContentType("text/html; charset=UTF-8");
    request.setCharacterEncoding("UTF-8");
    try {
      out.write(_jsp_string0, 0, _jsp_string0.length);
      
String method = Util.null2String(request.getParameter("method"));
int browserTypeId = Util.getIntValue(request.getParameter("browserTypeId"), 0);
String customBrowType = Util.null2String(request.getParameter("customBrowType"));
int hrmOrder = Util.getIntValue(request.getParameter("_hrmorder_"), 0);
String linkhref =  Util.null2String(request.getParameter("linkhref"));
String joinFieldParams= Util.null2String(request.getParameter("joinFieldParams"));
int pageNo = Util.getIntValue(request.getParameter("pageno"), 1);
int pageSize = Util.getIntValue(request.getParameter("pageSize"), 10);
String keyword = Util.null2String(request.getParameter("keyword"));
//qc273075	[1703\u8865\u4e01\u5305\u6d4b\u8bd5]\u6d41\u7a0b\u5c55\u73b0\u96c6\u6210-\u89e3\u51b3\u624b\u673a\u7aef\u8f93\u5165+\u4f5c\u4e3a\u67e5\u8be2\u6761\u4ef6\u5931\u6548\u7684\u95ee\u9898 start
boolean replace=false;
if(keyword.indexOf("+")>=0){
	 replace=true;
	 }else{
		 replace=false;
	 }

keyword = java.net.URLDecoder.decode(keyword, "UTF-8");
if(replace){
	 keyword=keyword.replace(" ","+");
} 
//qc273075	[1703\u8865\u4e01\u5305\u6d4b\u8bd5]\u6d41\u7a0b\u5c55\u73b0\u96c6\u6210-\u89e3\u51b3\u624b\u673a\u7aef\u8f93\u5165+\u4f5c\u4e3a\u67e5\u8be2\u6761\u4ef6\u5931\u6548\u7684\u95ee\u9898 end
int fnaworkflowid = Util.getIntValue(request.getParameter("fnaworkflowid"), -1);
String fnafieldid = Util.null2String(request.getParameter("fnafieldid"));

boolean isDis = "1".equals(Util.null2String(request.getParameter("isDis"))) ? true : false;
if (!isDis) {
	request.getRequestDispatcher("/mobile/plugin/dialog.jsp").forward(request, response);
	return;
}

//User user = HrmUserVarify.getUser (request , response);
String f_weaver_belongto_userid=Util.null2String(request.getParameter("f_weaver_belongto_userid"));//\u9700\u8981\u589e\u52a0\u7684\u4ee3\u7801
String f_weaver_belongto_usertype=Util.null2String(request.getParameter("f_weaver_belongto_usertype"));//\u9700\u8981\u589e\u52a0\u7684\u4ee3\u7801
User user  = HrmUserVarify.getUser(request, response, f_weaver_belongto_userid, f_weaver_belongto_usertype) ;//\u9700\u8981\u589e\u52a0\u7684\u4ee3\u7801

BrowserAction braction = new BrowserAction(user, browserTypeId, pageNo, pageSize);
braction.setKeyword(keyword);
if("listFnaBudgetFeeType".equals(method)){//\u662f\u79d1\u76ee\u6d4f\u89c8\u6309\u94ae\uff1a\u8d22\u52a1 QC141205 \u79d1\u76ee\u5e94\u7528\u8303\u56f4\u8fc7\u6ee4
	boolean _flag = Util.getIntValue(request.getParameter("isFnaSubmitRequest4Mobile"), -1)==1;
	if(_flag){
		int orgtype = Util.getIntValue(request.getParameter("orgtype"), -1);
		int orgid = Util.getIntValue(request.getParameter("orgid"), -1);
		int orgtype2 = Util.getIntValue(request.getParameter("orgtype2"), -1);
		int orgid2 = Util.getIntValue(request.getParameter("orgid2"), -1);
		braction.setFnaSubmitRequest4Mobile(_flag);
		braction.setOrgtype(orgtype);
		braction.setOrgid(orgid);
		braction.setOrgtype2(orgtype2);
		braction.setOrgid2(orgid2);
	}
}else if("listWorkflowRequest".equals(method)){//\u5355\u8bf7\u6c42\u6d4f\u89c8\u6309\u94ae\uff1a\u8d22\u52a1 QC141220
	boolean _flag = false;
	if(!_flag){
		//\u8fd8\u6b3e\uff08\u62a5\u9500\uff09\u6d41\u7a0b\u7684\u660e\u7ec6\u8868\uff08\u51b2\u8d26\u660e\u7ec6\uff09\u7684\u5b57\u6bb5\uff1a\u501f\u6b3e\u6d41\u7a0b
		_flag = Util.getIntValue(request.getParameter("isFnaRepayRequest4Mobile"), -1)==1;
		if(_flag){
			int fnaWfRequestid = Util.getIntValue(request.getParameter("fnaWfRequestid"), 0);
			int main_fieldIdSqr_controlBorrowingWf = Util.getIntValue(request.getParameter("main_fieldIdSqr_controlBorrowingWf"), 0);
			int main_fieldIdSqr_val = Util.getIntValue(request.getParameter("main_fieldIdSqr_val"), 0);
			braction.setFnaRepayRequest4Mobile(true);
			braction.setFnaWfRequestid(fnaWfRequestid);
			braction.setMain_fieldIdSqr_controlBorrowingWf(main_fieldIdSqr_controlBorrowingWf);
			braction.setMain_fieldIdSqr_val(main_fieldIdSqr_val);
		}
	}
	if(!_flag){
		//\u662f\u62a5\u9500\u6d41\u7a0b\u7684\u4e3b\u8868\u7684\u5b57\u6bb5\uff1a\u8d39\u7528\u7533\u8bf7\u6d41\u7a0b
		_flag = Util.getIntValue(request.getParameter("isFnaRequestApplication4Mobile"), -1)==1;
		if(_flag){
			int fnaWfRequestid = Util.getIntValue(request.getParameter("fnaWfRequestid"), 0);
			braction.setFnaRequestApplication4Mobile(true);
			braction.setFnaWfRequestid(fnaWfRequestid);
		}
	}
}
braction.setMethod(method);
braction.setHrmOrder(hrmOrder);
//\u5206\u6743\u7528
braction.setCustomBrowType(customBrowType);
braction.setJoinFieldParams(joinFieldParams);
braction.setLinkhref(linkhref);
braction.setFnafieldid(fnafieldid);
braction.setFnaworkflowid(fnaworkflowid);
String result = braction.getBrowserData();
response.getOutputStream().write(result.getBytes("UTF-8"));
response.getOutputStream().flush();

      out.write(_jsp_string1, 0, _jsp_string1.length);
    } catch (java.lang.Throwable _jsp_e) {
      pageContext.handlePageException(_jsp_e);
    } finally {
      _jsp_application.getJspApplicationContext().freePageContext(pageContext);
    }
  }

  private java.util.ArrayList _caucho_depends = new java.util.ArrayList();

  public java.util.ArrayList _caucho_getDependList()
  {
    return _caucho_depends;
  }

  public void _caucho_addDepend(com.caucho.vfs.PersistentDependency depend)
  {
    super._caucho_addDepend(depend);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  public boolean _caucho_isModified()
  {
    if (_caucho_isDead)
      return true;
    if (com.caucho.server.util.CauchoSystem.getVersionId() != 1886798272571451039L)
      return true;
    for (int i = _caucho_depends.size() - 1; i >= 0; i--) {
      com.caucho.vfs.Dependency depend;
      depend = (com.caucho.vfs.Dependency) _caucho_depends.get(i);
      if (depend.isModified())
        return true;
    }
    return false;
  }

  public long _caucho_lastModified()
  {
    return 0;
  }

  public java.util.HashMap<String,java.lang.reflect.Method> _caucho_getFunctionMap()
  {
    return _jsp_functionMap;
  }

  public void init(ServletConfig config)
    throws ServletException
  {
    com.caucho.server.webapp.WebApp webApp
      = (com.caucho.server.webapp.WebApp) config.getServletContext();
    super.init(config);
    com.caucho.jsp.TaglibManager manager = webApp.getJspApplicationContext().getTaglibManager();
    com.caucho.jsp.PageContextImpl pageContext = new com.caucho.jsp.PageContextImpl(webApp, this);
  }

  public void destroy()
  {
      _caucho_isDead = true;
      super.destroy();
  }

  public void init(com.caucho.vfs.Path appDir)
    throws javax.servlet.ServletException
  {
    com.caucho.vfs.Path resinHome = com.caucho.server.util.CauchoSystem.getResinHome();
    com.caucho.vfs.MergePath mergePath = new com.caucho.vfs.MergePath();
    mergePath.addMergePath(appDir);
    mergePath.addMergePath(resinHome);
    com.caucho.loader.DynamicClassLoader loader;
    loader = (com.caucho.loader.DynamicClassLoader) getClass().getClassLoader();
    String resourcePath = loader.getResourcePathSpecificFirst();
    mergePath.addClassPath(resourcePath);
    com.caucho.vfs.Depend depend;
    depend = new com.caucho.vfs.Depend(appDir.lookup("mobile/plugin/browser.jsp"), -1419213946076291774L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  private final static char []_jsp_string0;
  private final static char []_jsp_string1;
  static {
    _jsp_string0 = "\r\n\r\n\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string1 = "\r\n".toCharArray();
  }
}
