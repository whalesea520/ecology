/*
 * JSP generated by Resin-3.1.8 (built Mon, 17 Nov 2008 12:15:21 PST)
 */

package _jsp._mobilemode;
import javax.servlet.*;
import javax.servlet.jsp.*;
import javax.servlet.http.*;
import weaver.general.*;
import java.util.*;
import com.weaver.formmodel.ui.manager.*;
import com.weaver.formmodel.ui.model.*;
import com.weaver.formmodel.ui.base.*;
import com.weaver.formmodel.ui.types.*;
import com.weaver.formmodel.util.NumberHelper;
import com.weaver.formmodel.ui.base.model.WebUIResouces;
import weaver.hrm.*;
import com.weaver.formmodel.util.StringHelper;
import weaver.formmode.virtualform.VirtualFormHandler;
import com.weaver.formmodel.data.model.EntityInfo;
import com.weaver.formmodel.data.manager.EntityInfoManager;
import com.weaver.formmodel.mobile.manager.MobileUserInit;
import com.weaver.formmodel.base.model.PageModel;
import com.weaver.formmodel.data.manager.ThreadLocalPageModel;
import com.weaver.formmodel.mobile.model.MobileAppModelInfo;
import com.weaver.formmodel.mobile.manager.MobileAppModelManager;
import com.weaver.formmodel.mobile.ui.manager.MobileAppUIManager;
import com.weaver.formmodel.mobile.ui.model.AppFormUI;
import com.weaver.formmodel.mobile.ui.manager.MobiledeviceManager;
import com.weaver.formmodel.mobile.ui.model.AppFieldUI;
import com.weaver.formmodel.mobile.ui.manager.MobileFieldUIManager;
import weaver.formmode.setup.ModeRightInfoExtend;
import com.weaver.formmodel.mobile.utils.MobileCommonUtil;
import com.weaver.formmodel.mobile.types.ClientType;
import com.weaver.formmodel.mobile.utils.UIParser;
import net.sf.json.JSONArray;
import java.net.URLEncoder;

public class _formbasebrowserview__jsp extends com.caucho.jsp.JavaPage
{
  private static final java.util.HashMap<String,java.lang.reflect.Method> _jsp_functionMap = new java.util.HashMap<String,java.lang.reflect.Method>();
  private boolean _caucho_isDead;
  
  public void
  _jspService(javax.servlet.http.HttpServletRequest request,
              javax.servlet.http.HttpServletResponse response)
    throws java.io.IOException, javax.servlet.ServletException
  {
    javax.servlet.http.HttpSession session = request.getSession(true);
    com.caucho.server.webapp.WebApp _jsp_application = _caucho_getApplication();
    javax.servlet.ServletContext application = _jsp_application;
    com.caucho.jsp.PageContextImpl pageContext = _jsp_application.getJspApplicationContext().allocatePageContext(this, _jsp_application, request, response, null, session, 8192, true, false);
    javax.servlet.jsp.PageContext _jsp_parentContext = pageContext;
    javax.servlet.jsp.JspWriter out = pageContext.getOut();
    final javax.el.ELContext _jsp_env = pageContext.getELContext();
    javax.servlet.ServletConfig config = getServletConfig();
    javax.servlet.Servlet page = this;
    response.setContentType("text/html; charset=UTF-8");
    request.setCharacterEncoding("UTF-8");
    try {
      out.write(_jsp_string0, 0, _jsp_string0.length);
      weaver.conn.RecordSet rs;
      rs = (weaver.conn.RecordSet) pageContext.getAttribute("rs");
      if (rs == null) {
        rs = new weaver.conn.RecordSet();
        pageContext.setAttribute("rs", rs);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.formmode.setup.ModeRightInfo ModeRightInfo;
      ModeRightInfo = (weaver.formmode.setup.ModeRightInfo) pageContext.getAttribute("ModeRightInfo");
      if (ModeRightInfo == null) {
        ModeRightInfo = new weaver.formmode.setup.ModeRightInfo();
        pageContext.setAttribute("ModeRightInfo", ModeRightInfo);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.formmode.service.FormInfoService FormInfoService;
      FormInfoService = (weaver.formmode.service.FormInfoService) pageContext.getAttribute("FormInfoService");
      if (FormInfoService == null) {
        FormInfoService = new weaver.formmode.service.FormInfoService();
        pageContext.setAttribute("FormInfoService", FormInfoService);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.formmode.view.ModeShareManager ModeShareManager;
      ModeShareManager = (weaver.formmode.view.ModeShareManager) pageContext.getAttribute("ModeShareManager");
      if (ModeShareManager == null) {
        ModeShareManager = new weaver.formmode.view.ModeShareManager();
        pageContext.setAttribute("ModeShareManager", ModeShareManager);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.formmode.search.FormModeRightInfo FormModeRightInfo;
      FormModeRightInfo = (weaver.formmode.search.FormModeRightInfo) pageContext.getAttribute("FormModeRightInfo");
      if (FormModeRightInfo == null) {
        FormModeRightInfo = new weaver.formmode.search.FormModeRightInfo();
        pageContext.setAttribute("FormModeRightInfo", FormModeRightInfo);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.filter.XssUtil xssUtil;
      xssUtil = (weaver.filter.XssUtil) pageContext.getAttribute("xssUtil");
      if (xssUtil == null) {
        xssUtil = new weaver.filter.XssUtil();
        pageContext.setAttribute("xssUtil", xssUtil);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      
String billid = StringHelper.null2String(request.getParameter("billid"));
int modelid = NumberHelper.string2Int(request.getParameter("modeId"),0);
int formid = NumberHelper.string2Int(request.getParameter("formId"),0);

String sqlwhere=StringHelper.null2String(request.getParameter("sqlwhere"));

int isdeleted = NumberHelper.string2Int(request.getParameter("isdeleted"),0);
if(isdeleted == 1){
	String script = "<script>" +
			"if(top && typeof(top.backPage) == \"function\"){" +
			"	top.backPage();" +
			"}"+
			"</script>";
	out.print(script);
	return;
}

MobileAppUIManager mobileAppUIManager = MobileAppUIManager.getInstance();

//String clienttype = StringHelper.null2String(request.getParameter("clienttype"));	//\u5f53\u524d\u8bbf\u95ee\u5ba2\u6237\u7aef\u7c7b\u578b \u53ef\u80fd\u7684\u503c\uff1aWebclient|iphone|ipad|Android
ClientType clienttype = MobileCommonUtil.getClientType(request);
int mobiledeviceid = MobiledeviceManager.getInstance().getDeviceByClienttype(clienttype);

//\u83b7\u53d6\u5e03\u5c40\u6a21\u677f\u5185\u5bb9
String uicontent=mobileAppUIManager.getDefaultTemplate(modelid,formid,1);
String uitemplate = UIParser.formatUIContent(uicontent);

//AppFormUI appFormUI = mobileAppUIManager.getByIdAndDeviceid(0, mobiledeviceid);
AppFormUI appFormUI = new AppFormUI();
appFormUI.setKeyfield("id");
appFormUI.setFormId(formid);
appFormUI.setUiContent(uicontent);
appFormUI.setUiTemplate(uitemplate);
appFormUI.setMobiledeviceid(mobiledeviceid);
appFormUI.setUiType(1);

int appid = 0;
int uitype = 1;//0\uff1a\u65b0\u5efa\u30011\uff1a\u67e5\u770b\u30012\uff1a\u7f16\u8f91\u30013\uff1a\u5217\u8868

User user = MobileUserInit.getUser(request,response);

if(billid.trim().equals("") && (uitype == 1 || uitype == 2)){
	request.getRequestDispatcher("/mobilemode/message.jsp?errorCode=1388").forward(request, response);
	return;
}

boolean isRight = false;
boolean isEdit = false;		//\u662f\u5426\u6709\u7f16\u8f91\u6743\u9650\uff0c\u4e3b\u8981\u9488\u5bf9\u53f3\u952e\u6309\u94ae\u662f\u5426\u663e\u793a
boolean isDel = false;		//\u662f\u5426\u6709\u5220\u9664\u6743\u9650\uff0c\u4e3b\u8981\u9488\u5bf9\u53f3\u952e\u6309\u94ae\u662f\u5426\u663e\u793a
boolean isVirtualForm=VirtualFormHandler.isVirtualForm(formid);

if(uitype==3){//\u5217\u8868
	isRight=true;
	if(!isVirtualForm){
		//\u81ea\u5b9a\u4e49\u67e5\u8be2\u5217\u8868\u67e5\u770b\u6743\u9650
		int customid=appFormUI.getSourceid();
		rs.executeSql("select * from mode_searchPageshareinfo where righttype=1 and pageid = " + customid);
		if(rs.next()){
			FormModeRightInfo.setUser(user);
			isRight = FormModeRightInfo.checkUserRight(customid,1);
		}else{
			//\u6ca1\u6709\u8bbe\u7f6e\u4efb\u4f55\u67e5\u770b\u6743\u9650\u6570\u636e\uff0c\u5219\u8ba4\u4e3a\u6709\u6743\u9650\u67e5\u770b
			isRight = true;
		}
	}
}else{
	//\u67d0\u6761\u6570\u636e\u67e5\u770b\u3001\u7f16\u8f91\u3001\u5220\u9664\u6743\u9650
	int type=0;
	if(uitype==0){
		type=1;
	}else if(uitype==1){
		type=0;
	}else if(uitype==2){
		type=2;
	}
	if(!isVirtualForm){
		int customid = 0;
		ModeRightInfo.setModeId(modelid);
		ModeRightInfo.setType(type);
		ModeRightInfo.setUser(user);
		if(type == 1 || type == 3){//\u65b0\u5efa\u3001\u76d1\u63a7\u6743\u9650\u5224\u65ad
			//isRight = ModeRightInfo.checkUserRight(type);
			FormModeRightInfo.setUser(user);
			isRight = FormModeRightInfo.checkUserRight(customid,4);
			if(!isRight){  //\u5982\u679c\u81ea\u5b9a\u4e49\u67e5\u8be2\u9875\u9762\u65e0\u76d1\u63a7\u6743\u9650\uff0c\u5219\u68c0\u67e5\u5168\u5c40\u76d1\u63a7\u6743\u9650
				ModeRightInfo.setModeId(modelid);
				ModeRightInfo.setType(type);
				ModeRightInfo.setUser(user);
				
				isRight = ModeRightInfo.checkUserRight(type);
			}
		}

		ModeShareManager.setModeId(modelid);
		int MaxShare = 0;
		if(type == 0 || type == 2){//\u67e5\u770b\u3001\u7f16\u8f91\u6743\u9650
			String rightStr = ModeShareManager.getShareDetailTableByUser("formmode",user);
			rs.executeSql("select * from "+rightStr+" t where sourceid="+billid);
			if(rs.next()){
				MaxShare = rs.getInt("sharelevel");
				isRight = true;
				if(MaxShare > 1) {
					isEdit = true;		//\u6709\u7f16\u8f91\u6216\u5b8c\u5168\u63a7\u5236\u6743\u9650\u7684\u51fa\u73b0\u7f16\u8f91\u6309\u94ae
					if(MaxShare == 3) isDel = true;		//\u6709\u7f16\u8f91\u6216\u8005\u5b8c\u5168\u63a7\u5236\u6743\u9650\u7684\u51fa\u73b0\u5220\u9664\u6309\u94ae
				}
			}
		}
	}else{
		ModeRightInfoExtend modeRightInfoExtend=new ModeRightInfoExtend();
		modeRightInfoExtend.setModeId(modelid);
		modeRightInfoExtend.setUser(user);
		modeRightInfoExtend.setFormid(formid);
		modeRightInfoExtend.setBillid(billid);
		if(type==1){//\u65b0\u5efa
			isRight = modeRightInfoExtend.checkUserRight(1);
		}else if(type==0||type==2){//\u67e5\u770b\u3001\u7f16\u8f91\u65f6\u5224\u65ad\u662f\u5426\u663e\u793a\u7f16\u8f91\u3001\u5220\u9664\u6309\u94ae
			isRight=true;//\u67e5\u770b\u6743\u9650
			isDel=modeRightInfoExtend.checkUserRightByRightType(3);//\u5b8c\u5168\u63a7\u5236\u6743\u9650
			if(isDel){
				isEdit=true;
			}else{
				isEdit=modeRightInfoExtend.checkUserRightByRightType(2);//\u7f16\u8f91\u6743\u9650
			}
		}
	}
}
if(!isRight){
	request.getRequestDispatcher("/mobilemode/message.jsp?errorCode=1389").forward(request, response);
	return;
}



int pageIndex = NumberHelper.string2Int(request.getParameter("pageIndex"), 1);
int pageSize = NumberHelper.string2Int(request.getParameter("pageSize"), 10);

WebUIContext uiContext = new WebUIContext();
uiContext.setClient(com.weaver.formmodel.ui.types.ClientType.CLIENT_TYPE_MOBILE);
uiContext.setBusinessid(billid);
uiContext.setModelid(modelid);
uiContext.setUIType(uitype);
uiContext.setAppid(appid);
uiContext.setCurrentUser(user);
uiContext.setPageNo(pageIndex);
uiContext.setPageSize(pageSize);
uiContext.setSqlwhere(sqlwhere);
uiContext.setAppFormUI(appFormUI);
uiContext.setRequest(request);
WebUIView uiview = WebUIManager.getInstance().getViewContentBroswer(uiContext);
int totalPageCount = 0;
int totalSize=0;
PageModel pageModel=null;
if(uitype==3){
	pageModel = ThreadLocalPageModel.getPageModel();
	ThreadLocalPageModel.destory();
}

if(pageModel!=null){
	totalPageCount = pageModel.getTotalPageCount();
	totalSize=pageModel.getTotalSize();
}

int isShowInTabV = NumberHelper.string2Int(request.getParameter("isShowInTab"), 0);
boolean isShowInTab = isShowInTabV == 1;

List<WebUIResouces> btnResoucesList = uiview.getButtonPageResources();
boolean isUseIScroll = (uitype == 3);
//boolean isUseIScroll = true;
boolean disableDownRefresh = ((uitype == 3) ? false : true);

      out.write(_jsp_string2, 0, _jsp_string2.length);
      out.print((uiview.getUiTitle() ));
      out.write(_jsp_string3, 0, _jsp_string3.length);
      if(isUseIScroll){ 
      out.write(_jsp_string4, 0, _jsp_string4.length);
      out.print((disableDownRefresh));
      out.write(_jsp_string5, 0, _jsp_string5.length);
      }else{
      out.write(_jsp_string6, 0, _jsp_string6.length);
      } 
      out.write(_jsp_string7, 0, _jsp_string7.length);
      out.print((uiview.getResLink() ));
      out.write(_jsp_string8, 0, _jsp_string8.length);
      out.print((pageIndex));
      out.write(_jsp_string9, 0, _jsp_string9.length);
      out.print((totalPageCount));
      out.write(_jsp_string10, 0, _jsp_string10.length);
      out.print((uiview.getResScript()));
      out.write(_jsp_string11, 0, _jsp_string11.length);
      if(isUseIScroll){ 
      out.write(_jsp_string12, 0, _jsp_string12.length);
      if(!disableDownRefresh){
      out.write(_jsp_string13, 0, _jsp_string13.length);
      } 
      out.write(_jsp_string14, 0, _jsp_string14.length);
      } 
      out.write(_jsp_string7, 0, _jsp_string7.length);
      if(uitype == 3 && !btnResoucesList.isEmpty()){ //\u5217\u8868\u6269\u5c55\u6309\u94ae
	WebUIResouces f_btnResouces = btnResoucesList.get(0);
	String className = btnResoucesList.size() > 1 ? " expandBtnDivHasMore" : "";

      out.write(_jsp_string15, 0, _jsp_string15.length);
      out.print((className));
      out.write(_jsp_string16, 0, _jsp_string16.length);
      out.print((f_btnResouces.getResourceContent()));
      out.write(_jsp_string17, 0, _jsp_string17.length);
      out.print((f_btnResouces.getResourceName() ));
      out.write(_jsp_string18, 0, _jsp_string18.length);
      if(btnResoucesList.size() > 1){
      out.write(_jsp_string19, 0, _jsp_string19.length);
      for(int i = 1; i < btnResoucesList.size(); i++){
					WebUIResouces btnResouces = btnResoucesList.get(i);
				
      out.write(_jsp_string20, 0, _jsp_string20.length);
      out.print((btnResouces.getResourceContent()));
      out.write(_jsp_string17, 0, _jsp_string17.length);
      out.print((btnResouces.getResourceName() ));
      out.write(_jsp_string21, 0, _jsp_string21.length);
      } 
      out.write(_jsp_string22, 0, _jsp_string22.length);
      } 
      out.write(_jsp_string1, 0, _jsp_string1.length);
      } 
      out.write(_jsp_string23, 0, _jsp_string23.length);
      out.print((uiview.getUiContent()));
      out.write(_jsp_string24, 0, _jsp_string24.length);
      out.print((modelid));
      out.write(_jsp_string25, 0, _jsp_string25.length);
      out.print((billid));
      out.write(_jsp_string26, 0, _jsp_string26.length);
      out.print((appid));
      out.write(_jsp_string27, 0, _jsp_string27.length);
      out.print((isShowInTabV));
      out.write(_jsp_string28, 0, _jsp_string28.length);
      out.print((uiview.getHiddenContent() ));
      out.write(_jsp_string29, 0, _jsp_string29.length);
      
if(uitype!=3) {}else{
      out.write(_jsp_string30, 0, _jsp_string30.length);
       if(totalSize==0){ 
      out.write(_jsp_string31, 0, _jsp_string31.length);
       }else if(totalPageCount>1){ 
      out.write(_jsp_string32, 0, _jsp_string32.length);
       } 
      out.write(_jsp_string1, 0, _jsp_string1.length);
      }
      out.write(_jsp_string33, 0, _jsp_string33.length);
      if(isUseIScroll){ 
      out.write(_jsp_string34, 0, _jsp_string34.length);
      } 
      out.write(_jsp_string35, 0, _jsp_string35.length);
    } catch (java.lang.Throwable _jsp_e) {
      pageContext.handlePageException(_jsp_e);
    } finally {
      _jsp_application.getJspApplicationContext().freePageContext(pageContext);
    }
  }

  private java.util.ArrayList _caucho_depends = new java.util.ArrayList();

  public java.util.ArrayList _caucho_getDependList()
  {
    return _caucho_depends;
  }

  public void _caucho_addDepend(com.caucho.vfs.PersistentDependency depend)
  {
    super._caucho_addDepend(depend);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  public boolean _caucho_isModified()
  {
    if (_caucho_isDead)
      return true;
    if (com.caucho.server.util.CauchoSystem.getVersionId() != 1886798272571451039L)
      return true;
    for (int i = _caucho_depends.size() - 1; i >= 0; i--) {
      com.caucho.vfs.Dependency depend;
      depend = (com.caucho.vfs.Dependency) _caucho_depends.get(i);
      if (depend.isModified())
        return true;
    }
    return false;
  }

  public long _caucho_lastModified()
  {
    return 0;
  }

  public java.util.HashMap<String,java.lang.reflect.Method> _caucho_getFunctionMap()
  {
    return _jsp_functionMap;
  }

  public void init(ServletConfig config)
    throws ServletException
  {
    com.caucho.server.webapp.WebApp webApp
      = (com.caucho.server.webapp.WebApp) config.getServletContext();
    super.init(config);
    com.caucho.jsp.TaglibManager manager = webApp.getJspApplicationContext().getTaglibManager();
    com.caucho.jsp.PageContextImpl pageContext = new com.caucho.jsp.PageContextImpl(webApp, this);
  }

  public void destroy()
  {
      _caucho_isDead = true;
      super.destroy();
  }

  public void init(com.caucho.vfs.Path appDir)
    throws javax.servlet.ServletException
  {
    com.caucho.vfs.Path resinHome = com.caucho.server.util.CauchoSystem.getResinHome();
    com.caucho.vfs.MergePath mergePath = new com.caucho.vfs.MergePath();
    mergePath.addMergePath(appDir);
    mergePath.addMergePath(resinHome);
    com.caucho.loader.DynamicClassLoader loader;
    loader = (com.caucho.loader.DynamicClassLoader) getClass().getClassLoader();
    String resourcePath = loader.getResourcePathSpecificFirst();
    mergePath.addClassPath(resourcePath);
    com.caucho.vfs.Depend depend;
    depend = new com.caucho.vfs.Depend(appDir.lookup("mobilemode/formbasebrowserview.jsp"), 5848591059205647598L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  private final static char []_jsp_string23;
  private final static char []_jsp_string30;
  private final static char []_jsp_string28;
  private final static char []_jsp_string25;
  private final static char []_jsp_string35;
  private final static char []_jsp_string9;
  private final static char []_jsp_string26;
  private final static char []_jsp_string8;
  private final static char []_jsp_string0;
  private final static char []_jsp_string2;
  private final static char []_jsp_string12;
  private final static char []_jsp_string14;
  private final static char []_jsp_string13;
  private final static char []_jsp_string22;
  private final static char []_jsp_string21;
  private final static char []_jsp_string6;
  private final static char []_jsp_string33;
  private final static char []_jsp_string19;
  private final static char []_jsp_string20;
  private final static char []_jsp_string34;
  private final static char []_jsp_string11;
  private final static char []_jsp_string16;
  private final static char []_jsp_string4;
  private final static char []_jsp_string32;
  private final static char []_jsp_string3;
  private final static char []_jsp_string31;
  private final static char []_jsp_string15;
  private final static char []_jsp_string27;
  private final static char []_jsp_string1;
  private final static char []_jsp_string10;
  private final static char []_jsp_string24;
  private final static char []_jsp_string17;
  private final static char []_jsp_string5;
  private final static char []_jsp_string18;
  private final static char []_jsp_string29;
  private final static char []_jsp_string7;
  static {
    _jsp_string23 = "\r\n\r\n<form  name=frmmain id=frmmain method=\"post\" enctype=\"multipart/form-data\">\r\n<div id=\"uploaddiv\"></div>\r\n\r\n".toCharArray();
    _jsp_string30 = "\r\n	".toCharArray();
    _jsp_string28 = "\">\r\n	".toCharArray();
    _jsp_string25 = "\">\r\n	<input type=hidden name=billid id=\"billid\" value=\"".toCharArray();
    _jsp_string35 = "\r\n\r\n</div>\r\n</body>\r\n</html>".toCharArray();
    _jsp_string9 = ";\r\n	var totalPageCount=".toCharArray();
    _jsp_string26 = "\">\r\n	<input type=hidden name=\"client\" id=\"client\" value=\"mobile\">\r\n	<input type=hidden name=appid id=\"appid\" value=\"".toCharArray();
    _jsp_string8 = "\r\n<script type=\"text/javascript\">\r\n	function downloadattach(fileid,filename){\r\n		location.href = \"/download.do?fileid=\"+fileid+\"&module=3&scope=11&filename=\"+encodeURI(filename)+\"\";\r\n		top.hideLoading();\r\n	}\r\n	\r\n	//\u663e\u793a\u52a0\u8f7d\u5668\r\n	function showLoader() {\r\n	    //\u663e\u793a\u52a0\u8f7d\u5668.for jQuery Mobile 1.2.0\r\n	    $.mobile.loading('show', {\r\n	        text: '\u52a0\u8f7d\u4e2d...', //\u52a0\u8f7d\u5668\u4e2d\u663e\u793a\u7684\u6587\u5b57\r\n	        textVisible: true, //\u662f\u5426\u663e\u793a\u6587\u5b57\r\n	        theme: 'a',        //\u52a0\u8f7d\u5668\u4e3b\u9898\u6837\u5f0fa-e\r\n	        textonly: false,   //\u662f\u5426\u53ea\u663e\u793a\u6587\u5b57\r\n	        html: \"\"           //\u8981\u663e\u793a\u7684html\u5185\u5bb9\uff0c\u5982\u56fe\u7247\u7b49\r\n	    });\r\n	}\r\n	\r\n	//\u9690\u85cf\u52a0\u8f7d\u5668.for jQuery Mobile 1.2.0\r\n	function hideLoader()\r\n	{\r\n	    //\u9690\u85cf\u52a0\u8f7d\u5668\r\n	    $.mobile.loading('hide');\r\n	}\r\n	\r\n	function callbackUpload(name,data,fieldid) {\r\n		if(fieldid){\r\n			var $uploadname = $('#uploadname'+fieldid);\r\n			$uploadname.val('');\r\n			var $uploaddata = $('#uploaddata'+fieldid);\r\n			$uploaddata.val('');\r\n			if(name){ \r\n				$uploadname.val(name);\r\n			}\r\n			if(data){\r\n				$uploaddata.val(data);\r\n			}\r\n		\r\n			var uploadKey = data.substring(\"emobile:upload:\".length);\r\n			var url = \"/client.do?method=getupload&uploadID=\"+uploadKey;\r\n			var $entryImg = $(\"<div class=\\\"field_upload_entryImg\\\"><img src=\\\"\"+url+\"\\\"></img></div>\");\r\n			var $entryDelete = $(\"<div class=\\\"field_upload_deleteBtn\\\"></div>\");\r\n			var $entry = $(\"<div class=\\\"field_upload_entry\\\"></div>\");\r\n			$entry.append($entryImg).append($entryDelete);\r\n			var $entryBtn = $(\"#entryBtn\"+fieldid);\r\n			var $entryWrap = $(\"#entryWrap\" + fieldid);\r\n			$entryWrap.children().remove();\r\n			$entryWrap.append($entry).append($entryBtn);\r\n			\r\n			$entryDelete.click(function(){\r\n				delUpload(this, fieldid); \r\n			});\r\n		}\r\n	}\r\n	\r\n	function delUpload(obj,fieldid,docid){\r\n		var str=\"\";\r\n		var strAry=$(\"#field\" + fieldid).val().split(\",\");\r\n		for(i=0;i<strAry.length;i++){\r\n			if(strAry[i]!=docid){\r\n				str = str+strAry[i]+\",\"\r\n			}			\r\n		}\r\n		str = str.substring(0,str.length-1);\r\n		$(\"#field\" + fieldid).val(str);\r\n		$(obj).parent().remove();\r\n	}\r\n	\r\n	function clearUpload(fieldid) {\r\n		$(\"#field\" + fieldid).val(\"\");\r\n		var $entryBtn = $(\"#entryBtn\"+fieldid);\r\n		var $entryWrap = $(\"#entryWrap\" + fieldid);\r\n		$entryWrap.children().remove();\r\n		$entryWrap.append($entryBtn);\r\n	}\r\n	\r\n	function addUpload(e, fieldid) {\r\n		if(top && typeof(top.registUploadWindow) == \"function\"){\r\n			top.registUploadWindow(window);\r\n		}\r\n		location = \"emobile:upload:callbackUpload:\"+fieldid+\":\"+e.clientY+\":clearUpload\";\r\n	}\r\n	\r\n	function addUpload1(fieidid){\r\n	if(fieidid){\r\n	var file = document.getElementById(\"file\"+fieidid);\r\n		if(file.files && file.files[0]){\r\n			var reader = new FileReader();\r\n		   	reader.onload = function(evt){\r\n				\r\n				var $field = $(\"#photoField\"+fieidid);\r\n				var fieldArray = $field.val().split(\",\");\r\n				var fieldNum = parseInt(fieldArray[0]);\r\n				fieldNum += 1;\r\n				var fieldStr = fieldNum+\",\"+ fieidid;\r\n				$field.val(fieldStr);\r\n				\r\n				var temp = 0;\r\n				$(\"input[type='file']\", \"#entryWrap\"+fieidid).each(function(){\r\n					if($(this).attr(\"fileNum\") > temp){\r\n						temp = $(this).attr(\"fileNum\");\r\n					}\r\n				});\r\n				\r\n				++temp;\r\n				var $file = $(\"#file\"+fieidid);\r\n				$file.attr(\"name\",\"file\"+fieidid+(temp));\r\n				$file.attr(\"id\",\"file\"+fieidid+(temp));\r\n				$file.attr(\"fileNum\",(temp));\r\n				$file.css(\"display\",\"none\");\r\n				var $entryImg = $(\"<div class=\\\"field_upload_entry\\\"><img src=\\\"\"+evt.target.result+\"\\\"></img></div>\");\r\n				var $entryDelete = $(\"<div class=\\\"field_upload_DeleteBtn\\\"></div>\");\r\n				var $entryBorder = $(\"<div class=\\\"field_upload_entryBorder\\\"></div>\");\r\n				$entryBorder.append($entryImg).append($entryDelete).append($file);\r\n				$(\"#photoBorder\"+fieidid).before($entryBorder);\r\n				\r\n				$entryDelete.click(function(){\r\n					$(this).parent().remove();\r\n				});\r\n				\r\n				var $originalFile = $(\"<input id=\\\"file\"+fieidid+\"\\\" type=\\\"file\\\" name=\\\"file\\\" fileNum=\\\"0\\\" class=\\\"upLoadFile\\\" accept=\\\"image/jpg,image/jpeg,image/png,image/gif\\\" single=\\\"single\\\"  onchange=\\\"addUpload1('\"+fieidid+\"');\\\" data-role=\\\"none\\\"/>\");\r\n				$(\"#entryBtn\"+fieidid).append($originalFile);\r\n				refreshIScroll();\r\n				$originalFile.focus();\r\n		   	}\r\n		   	reader.readAsDataURL(file.files[0]);\r\n		}\r\n	}\r\n}\r\n	\r\n	function addUploadattach(fieidid){\r\n		if(fieidid){\r\n		var file = document.getElementById(\"file\"+fieidid);\r\n			if(file.files && file.files[0]){\r\n				var filefullname = file.files[0].name;\r\n				var splitpoint = filefullname.lastIndexOf(\".\");\r\n				var filename = filefullname.substring(0, splitpoint);\r\n				var filetype = filefullname.substring(splitpoint + 1);\r\n				\r\n				var imagesrc = \"\";\r\n				if(filetype == \"jpg\" || filetype == \"jpeg\" || filetype == \"png\" || filetype == \"gif\" || filetype == \"bmp\") {\r\n					imagesrc = \"/mobilemode/images/icon/jpg_wev8.png\";\r\n				}else if(filetype == \"doc\" || filetype == \"docx\") {\r\n					imagesrc = \"/mobilemode/images/icon/doc_wev8.png\";\r\n				}else if(filetype == \"xls\" || filetype == \"xlsx\") {\r\n					imagesrc = \"/mobilemode/images/icon/xls_wev8.png\";\r\n				}else if(filetype == \"pdf\") {\r\n					imagesrc = \"/mobilemode/images/icon/pdf_wev8.png\";\r\n				}else if(filetype == \"htm\" || filetype == \"html\") {\r\n					imagesrc = \"/mobilemode/images/icon/html_wev8.png\";\r\n				}else if(filetype == \"ppt\") {\r\n					imagesrc = \"/mobilemode/images/icon/ppt_wev8.png\";\r\n				}else {\r\n					imagesrc = \"/mobilemode/images/icon/txt_wev8.png\";\r\n				}\r\n				\r\n				var filesize = file.files[0].size;\r\n            	var showfilesize = \"\";\r\n            	if(filesize>=(1024 * 1024)){\r\n            		showfilesize = (filesize / 1024 / 1024).toFixed(2) + \"M\";\r\n            	} else if(filesize>=1024){\r\n            		showfilesize = Math.floor(filesize / 1024) + \"K\";\r\n            	} else{\r\n            		showfilesize = filesize+ \"B\";\r\n            	}\r\n				\r\n				var reader = new FileReader();\r\n			   	reader.onload = function(evt){\r\n					\r\n					var $field = $(\"#photoField\"+fieidid);\r\n					var fieldArray = $field.val().split(\",\");\r\n					var fieldNum = parseInt(fieldArray[0]);\r\n					fieldNum += 1;\r\n					var fieldStr = fieldNum+\",\"+ fieidid;\r\n					$field.val(fieldStr);\r\n					\r\n					var temp = 0;\r\n					$(\"input[type='file']\", \"#entryWrap\"+fieidid).each(function(){\r\n						if($(this).attr(\"fileNum\") > temp){\r\n							temp = $(this).attr(\"fileNum\");\r\n						}\r\n					});\r\n					\r\n					++temp;\r\n					var $file = $(\"#file\"+fieidid);\r\n					$file.attr(\"name\",\"file\"+fieidid+(temp));\r\n					$file.attr(\"id\",\"file\"+fieidid+(temp));\r\n					$file.attr(\"fileNum\",(temp));\r\n					$file.css(\"display\",\"none\");\r\n					var $attach_upload_entry = \r\n						$(\"<div class=\\\"attach_upload_entry\\\">\" +\r\n								\"<table style=\\\"width: 100%; table-layout: fixed;\\\">\" +\r\n									\"<tr>\" +\r\n										\"<td class=\\\"icon\\\"><img width=\\\"20\\\" height=\\\"20\\\" src=\\\"\" + imagesrc + \"\\\"></td>\" +\r\n										\"<td class=\\\"name\\\">\" + filefullname + \"</td>\" +\r\n										\"<td class=\\\"size\\\">\" + showfilesize + \"</td>\" +\r\n										\"<td class=\\\"flag\\\"><img width=\\\"20\\\" height=\\\"20\\\" src=\\\"/mobilemode/images/mec/arrow_right_wev8.png\\\"></td>\" +\r\n									\"</tr>\" +\r\n								\"</table>\" +\r\n							\"</div>\");\r\n					var $attach_upload_DeleteBtn = $(\"<div class=\\\"attach_upload_DeleteBtn\\\"></div>\");\r\n					var $attach_upload_entryborder = $(\"<div class=\\\"attach_upload_entryborder\\\" style=\\\"padding-right: 30px;\\\"></div>\");\r\n					$attach_upload_entryborder.append($attach_upload_entry).append($attach_upload_DeleteBtn).append($file);\r\n					\r\n					$(\"#attachBorder\"+fieidid).before($attach_upload_entryborder);\r\n					\r\n					$attach_upload_DeleteBtn.click(function(){\r\n						$(this).parent().remove();\r\n					});\r\n					\r\n					var $originalFile = $(\"<input id=\\\"file\"+fieidid+\"\\\" type=\\\"file\\\" name=\\\"file\\\" fileNum=\\\"0\\\" class=\\\"upLoadFile\\\" single=\\\"single\\\"  onchange=\\\"addUploadattach('\"+fieidid+\"');\\\" data-role=\\\"none\\\"/>\");\r\n					$(\"#entryBtn\"+fieidid).append($originalFile);\r\n					//refreshIScroll();\r\n					$originalFile.focus();\r\n			   	}\r\n			   	reader.readAsDataURL(file.files[0]);\r\n			}\r\n		}\r\n	}\r\n	\r\n	var isBeScrolling = false;\r\n	function openDetail(url){\r\n		if(isBeScrolling){\r\n			return;\r\n		}\r\n		if(top && typeof(top.openUrl) == \"function\"){\r\n			top.openUrl(url);\r\n		}else{\r\n			location.href = url;\r\n		}\r\n	}\r\n	\r\n	function onBack(){\r\n		if(top && typeof(top.backPage) == \"function\"){\r\n			top.backPage();\r\n		}\r\n	}\r\n	\r\n	var pageIndex=".toCharArray();
    _jsp_string0 = "\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string2 = "\r\n\r\n<HTML><HEAD>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\r\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0\">\r\n	<title>".toCharArray();
    _jsp_string12 = "\r\n<div id=\"scroll_wrapper\">\r\n	<div id=\"scroll_scroller\">\r\n		".toCharArray();
    _jsp_string14 = "\r\n<!-- \u6eda\u52a8\u6761\u5305\u88f9\u533a\u57df (start)-->		\r\n".toCharArray();
    _jsp_string13 = "\r\n			<div id=\"pullDown\">\r\n				<span class=\"pullDownIcon\"></span><span class=\"pullDownLabel\">\u4e0b\u62c9\u5237\u65b0</span>\r\n			</div>\r\n		".toCharArray();
    _jsp_string22 = "\r\n			</ul>\r\n		</div>\r\n	".toCharArray();
    _jsp_string21 = "</li>\r\n				".toCharArray();
    _jsp_string6 = "\r\n	<style>\r\n	html, body {\r\n	    overflow: hidden;\r\n	    margin: 0;\r\n	}\r\n	#myPage{\r\n		position: absolute;\r\n		top: 0px;\r\n		left: 0px;\r\n		bottom: 0px;\r\n		width: 100%;\r\n		overflow-y: auto;\r\n		overflow-x: hidden;\r\n		-webkit-overflow-scrolling:touch;\r\n		min-height: 382px !important;\r\n	}\r\n	</style>\r\n".toCharArray();
    _jsp_string33 = "\r\n</form>\r\n\r\n".toCharArray();
    _jsp_string19 = "\r\n		<div class=\"expandBtnDivMore\">\r\n			<ul>\r\n				".toCharArray();
    _jsp_string20 = "\r\n					<li onclick=\"javascript:openDetail('".toCharArray();
    _jsp_string34 = "\r\n<!-- \u6eda\u52a8\u6761\u5305\u88f9\u533a\u57df (end)-->	\r\n	</div>\r\n</div>\r\n".toCharArray();
    _jsp_string11 = "\r\n</script>\r\n<style>\r\n	\r\n</style>\r\n</HEAD>\r\n<body>\r\n<div data-role=\"page\" id=\"myPage\" data-dom-cache=\"true\">\r\n\r\n".toCharArray();
    _jsp_string16 = "\">\r\n		<div class=\"text\" onclick=\"javascript:openDetail('".toCharArray();
    _jsp_string4 = "\r\n	<script type=\"text/javascript\">\r\n		var disableDownRefresh = ".toCharArray();
    _jsp_string32 = "\r\n		<a href=\"javascript:void(0);\" data-role=\"button\" data-corners=\"true\" id=\"moreListData\" >\u52a0\u8f7d\u66f4\u591a</a>\r\n	".toCharArray();
    _jsp_string3 = "</title>\r\n	<link rel=\"stylesheet\" href=\"/mobilemode/jqmobile4/css/themes/default/jquery.mobile-1.4.0.min_wev8.css\">\r\n	<link rel=\"stylesheet\" href=\"/mobilemode/css/formbase_wev8.css?v=2015102201\">\r\n<style>\r\nhtml, body{\r\n	background-color: #fff;\r\n}\r\n*{\r\n	font-family: 'Microsoft Yahei', Arial;\r\n	font-size: 12px;\r\n}\r\n.ui-mini .ui-input-text input, .ui-mini .ui-input-search input, .ui-input-text.ui-mini input, .ui-input-search.ui-mini input, .ui-mini textarea.ui-input-text, textarea.ui-mini{\r\n	font-size: 12px;\r\n}\r\n.ui-shadow-inset{\r\n	box-shadow: none;\r\n}\r\n.ui-corner-all{\r\n	border-radius: 0;\r\n	-webkit-border-radius: 0;\r\n}\r\n.ui-btn-corner-all, .ui-btn.ui-corner-all, .ui-slider-track.ui-corner-all, .ui-flipswitch.ui-corner-all, .ui-li-count{\r\n	border-radius: 0;\r\n	-webkit-border-radius: 0;\r\n}\r\n.ui-shadow{\r\n	box-shadow: none;\r\n}\r\n.ui-input-search{\r\n	margin-left: 10px;\r\n	margin-right: 10px;\r\n}\r\n.ui-input-text input, .ui-input-search input, textarea.ui-input-text{\r\n\r\n}\r\n.ui-input-text{\r\n	margin: 2px 0;\r\n}\r\n.ui-slider-track{\r\n	border: 0;\r\n}\r\n.ui-slider-track.ui-body-a .ui-btn-active {\r\n	text-shadow: 0;\r\n}\r\n.ui-btn-uploadBtn{\r\n	width: 70px;\r\n	font-size: 12px;\r\n}\r\n.ui-loader{\r\n	top:auto;bottom:200px;background:none;\r\n}\r\n#browserSearchContainer div.ui-input-search{\r\n	display: inline-block;\r\n}\r\n		\r\n.ui-filterable{\r\n	position: relative;\r\n}\r\n.expandBtnDiv{\r\n	border: 1px solid rgb(221, 221, 221);\r\n	display: inline-block;\r\n	position: absolute;\r\n	top: 0px;\r\n	right: 10px;\r\n	height: 26px;\r\n	line-height: 26px;\r\n	background-color: #fff;\r\n}\r\n.expandBtnDivHasMore{\r\n	padding-right: 25px;\r\n}\r\n.expandBtnDiv .text{\r\n	padding: 0px 8px 0px 8px;\r\n	display: inline-block;\r\n	cursor: pointer;\r\n}\r\n.expandBtnDiv .moreFlag{\r\n	position: absolute;\r\n	top: 0px;\r\n	right: 0px;\r\n	width: 25px;\r\n	height: 26px;\r\n	display: none;\r\n	background-image: url(\"/mobilemode/images/homepage/homepage_bottom_wev8.jpg\");\r\n	background-repeat: no-repeat;\r\n	background-position: center center;\r\n	cursor: pointer;\r\n}\r\n.expandBtnDivHasMore .moreFlag{ \r\n	display: block;\r\n}\r\n.expandBtnDivMore{\r\n	background-color: #fff;\r\n	border: 1px solid rgb(221, 221, 221);\r\n	position: absolute;\r\n	z-index: 1000;\r\n	top:35px;\r\n	right: 10px;\r\n	display: none;\r\n}\r\n.expandBtnDivMore ul{\r\n	list-style: none;\r\n	margin: 0px;\r\n	padding: 0px;\r\n}\r\n.expandBtnDivMore ul li{\r\n	height: 32px;\r\n	padding: 0px 33px 0px 8px;\r\n	line-height: 32px;\r\n	border-bottom: 1px solid rgb(221, 221, 221);\r\n	cursor: pointer;\r\n}\r\n.expandBtnDivMore ul li:HOVER {\r\n	background-color: rgb(93, 156, 236);\r\n	color: #fff;\r\n}\r\n.nodata_border{\r\n	background: #f6f6f6;\r\n	padding-top: 10px;\r\n	padding-bottom: 10px;\r\n	margin: 8px 0;\r\n	text-shadow: 0 1px 0 #f3f3f3;\r\n	font-family: sans-serif;\r\n	color: #333;\r\n	font-weight: 700;\r\n	overflow: hidden;\r\n	cursor: pointer;\r\n	border-width: 1px;\r\n	border-style: solid;\r\n	border-radius: 4.96px;\r\n	border-color: #ddd;\r\n	box-shadow: none;\r\n}\r\n.nodata_content{\r\n	position: relative;\r\n	height: 22px;\r\n	line-height: 22px;\r\n	padding-left: 26px;\r\n	white-space: nowrap;\r\n	text-align: center;\r\n	width:150px;\r\n	margin:0 auto;\r\n	font-size: 16px;\r\n}\r\n.nodata_img{\r\n	position: absolute;\r\n	left: 0;\r\n	width: 22px;\r\n	height:22px;\r\n	background-color: rgba(0,0,0,.3);\r\n	border-radius: 1em;\r\n	background-image: url('data:image/svg+xml;charset=US-ASCII,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22iso-8859-1%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20%20width%3D%2214px%22%20height%3D%2214px%22%20viewBox%3D%220%200%2014%2014%22%20style%3D%22enable-background%3Anew%200%200%2014%2014%3B%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23FFF%22%20d%3D%22M7%2C0C3.134%2C0%2C0%2C3.134%2C0%2C7s3.134%2C7%2C7%2C7s7-3.134%2C7-7S10.866%2C0%2C7%2C0z%20M7%2C2c0.552%2C0%2C1%2C0.447%2C1%2C1S7.552%2C4%2C7%2C4S6%2C3.553%2C6%2C3%20S6.448%2C2%2C7%2C2z%20M9%2C11H5v-1h1V6H5V5h3v5h1V11z%22%2F%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3Cg%3E%3C%2Fg%3E%3C%2Fsvg%3E');\r\n	background-repeat: no-repeat;\r\n	background-position: 4px;\r\n}\r\ntd.promptValidateFail{\r\n	background-color: yellow !important;\r\n}\r\n.isManPrompt{\r\n	background-image: url(/mobilemode/images/isman_wev8.png);\r\n	background-repeat: no-repeat;\r\n	background-size: 7px 6px;\r\n	background-position: 5px center;\r\n}\r\n.addtable{\r\n	display: none;\r\n	position: fixed;\r\n	top: 0px;\r\n	left: 0px;\r\n	bottom: 0px;\r\n	right:0px;\r\n	z-index: 999;\r\n}\r\n.addtableInner{\r\n	max-height:80%;\r\n	overflow-y:auto ;\r\n	position: absolute;\r\n	left: 0px;\r\n	bottom: 35px;\r\n	right:0px;\r\n	background-color: #fff;\r\n	-webkit-transition: -webkit-transform 0.3s;\r\n	transition: transform 0.3s;\r\n}\r\n.addtableInner.hide{\r\n	-webkit-transform: translate3d(0, 100%, 0);\r\n	transform: translate3d(0, 100%, 0);\r\n}\r\n.form_detail_back{\r\n	position: absolute;\r\n    overflow: hidden;\r\n    left: 0px;\r\n    bottom: 0px;\r\n    width: 100%;\r\n    background: #fff;\r\n}\r\n.form_detailbuttonStyle{\r\n	float:right;\r\n	width: 25px;\r\n	height: 15px;\r\n	line-height: normal;\r\n	text-align:center;\r\n	font-size: 12px;\r\n	cursor:pointer;\r\n	padding: 5px 10px;\r\n	text-shadow: none;\r\n	margin-right: 5px;\r\n	margin-bottom: 5px;\r\n	margin-top: 5px;\r\n}\r\n.addtableMask{\r\n 	width:100%;height:100%;\r\n 	background-color: #000;\r\n	opacity: 0;\r\n	-webkit-transition: opacity .282s ease-in-out;\r\n	transition: opacity .282s ease-in-out;\r\n}\r\n.addtableMask.show{\r\n	opacity: 0.4;\r\n}\r\n.divoverflow{\r\n	width:100%;\r\n	 margin-top:10px;\r\n	overflow-x:auto;\r\n	-webkit-overflow-scrolling:touch;\r\n}\r\n.entrydel{\r\n	display: none;\r\n}\r\n</style>\r\n<script src=\"/mobilemode/jqmobile4/js/jquery_wev8.js\"></script>\r\n<script src=\"/mobilemode/jqmobile4/js/jquery.mobile-1.4.0.min_wev8.js\"></script>\r\n<script src=\"/mobilemode/js/lazyload/jquery.lazyload.min_wev8.js\"></script>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/mobilemode/js/mobiscroll/css/mobiscroll-2.5.2-min.css\"/>\r\n<script type=\"text/javascript\" src=\"/mobilemode/js/mobiscroll/mobiscroll-2.5.2-min.js\"></script>\r\n\r\n<script type=\"text/javascript\">\r\n//\u5b57\u6bb5\u8054\u52a8-\u5355\u884c\u6587\u672c\u6846\u3001\u591a\u884c\u6587\u672c\u6846\u3001Check\u6846\r\nfunction textLinkage(fieldid){\r\n	var textValue = $(\"#field\" + fieldid).val();\r\n	var result = {\"name\" : textValue, \"value\" : textValue};\r\n	\r\n	//\u89e6\u53d1\u8054\u52a8\r\n	readyToTrigger(fieldid, result);\r\n}\r\n\r\nfunction getValueByKey(jsonObj, key){\r\n	var value = \"\";\r\n	for(var k in jsonObj){\r\n		if(k.toLowerCase() == key.toLowerCase()){\r\n			value = jsonObj[k];\r\n		}\r\n	}\r\n	\r\n	return value;\r\n}\r\n//\u6267\u884cSQL\r\nfunction SQL(sqlstr, datasource, callbackFn){\r\n	sqlstr = encodeURIComponent(sqlstr);\r\n	if(!datasource){\r\n		datasource = \"\";\r\n	}\r\n	var asyncFlag = false;\r\n	/* if(typeof(callbackFn) == \"function\"){\r\n		asyncFlag = true;\r\n	} */\r\n	var result = \"\";\r\n	 $.ajax({\r\n	 	type: \"GET\",\r\n	 	contentType: \"application/json\",\r\n	 	url: jionActionUrl(\"com.weaver.formmodel.mobile.security.EDAction\", \"action=runSQL\"),\r\n	 	data: \"&content=\"+sqlstr+\"&datasource=\"+datasource,\r\n	 	async: asyncFlag,\r\n	 	success: function(responseText, textStatus) \r\n	 	{\r\n	 		var data = $.parseJSON(responseText);\r\n	 		var status = data[\"status\"];\r\n	 		if(status != \"-1\"){	//server\u7aef\u6ca1\u6709\u51fa\u73b0\u672a\u77e5\u5f02\u5e38\r\n	 			result = data[\"result\"];\r\n	 		}\r\n	 		if(typeof(callbackFn) == \"function\"){\r\n	 			callbackFn.call(this, result);\r\n	 		}\r\n	 	},\r\n	    error: function(){\r\n	    	//alert(\"error\");\r\n	    }\r\n	});\r\n	return result;\r\n}\r\n</script>\r\n\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/mobilemode/css/browser_wev8.css\"/>\r\n<script type=\"text/javascript\" src=\"/mobilemode/js/browser_wev8.js?v=201510181815\"></script>\r\n<script type=\"text/javascript\" src=\"/mobilemode/js/fieldsLinkage_wev8.js?v=201510181815\"></script>\r\n<script type=\"text/javascript\" language=\"javascript\" src=\"/formmode/js/jquery/aop/jquery.aop.min_wev8.js\"></script>\r\n<script type=\"text/javascript\" language=\"javascript\" src=\"/formmode/js/json2_wev8.js\"></script>\r\n<script type=\"text/javascript\" language=\"javascript\" src=\"/mobilemode/js/FieldPrompt_wev8.js\"></script>\r\n\r\n".toCharArray();
    _jsp_string31 = "\r\n		<div  class=\"nodata_border\"><div class=\"nodata_content\"><div class=\"nodata_img\"></div>\u6ca1\u6709\u53ef\u663e\u793a\u7684\u6570\u636e</div></div>\r\n	".toCharArray();
    _jsp_string15 = "\r\n	<div class=\"expandBtnDiv".toCharArray();
    _jsp_string27 = "\">\r\n	<input type=hidden name=\"isShowInTab\" id=\"isShowInTab\" value=\"".toCharArray();
    _jsp_string1 = "\r\n".toCharArray();
    _jsp_string10 = ";\r\n	var fieldsJsonArray = [];\r\n	$(document).ready(function(){\r\n		  \r\n		\r\n		Mobile_NS.groupViewImg();\r\n		\r\n		$(\"img.lazy\").each(function(){\r\n			$(this).attr(\"src\",$(this).attr(\"data-original\"));\r\n		});\r\n		\r\n		var currYear = (new Date()).getFullYear();	\r\n		var opt={};\r\n		opt.date = {preset : 'date'};\r\n		opt.datetime = {preset : 'datetime'};\r\n		opt.time = {preset : 'time'};\r\n		opt.default = {\r\n			theme: 'android-ics light', //\u76ae\u80a4\u6837\u5f0f\r\n	        display: 'modal', //\u663e\u793a\u65b9\u5f0f \r\n	        mode: 'scroller', //\u65e5\u671f\u9009\u62e9\u6a21\u5f0f\r\n	        dateFormat : \"yy-mm-dd\",\r\n			lang:'zh',\r\n	        startYear:currYear - 10, //\u5f00\u59cb\u5e74\u4efd\r\n	        endYear:currYear + 10 //\u7ed3\u675f\u5e74\u4efd\r\n		};\r\n		var optCurrDate = $.extend(opt['date'], opt['default']);\r\n		$(\".dateStyle\").mobiscroll(optCurrDate).date(optCurrDate);\r\n		var optCurrTime = $.extend(opt['time'], opt['default']);\r\n		$(\".timeStyle\").mobiscroll(optCurrTime).time(optCurrTime);\r\n		\r\n		$(\".field_inputTime\").each(function(){\r\n			if($(this).val() != \"\"){\r\n				var fieldid = $(this).attr(\"fieldid\");\r\n				$(\"#fieldSub\"+fieldid).click(function(e){\r\n					e.stopPropagation();\r\n					var fieldval = $(\"#field\"+fieldid).val();\r\n					if(fieldval && fieldval != \"\"){\r\n						$(\"#field\"+fieldid).val(\"\");\r\n						$(this).hide();\r\n						$(this).unbind();\r\n					}\r\n				}).show();\r\n			}\r\n		});\r\n		\r\n	});\r\n	\r\n	// \u5b57\u6bb5\u8054\u52a8-\u9009\u62e9\u6846\r\n	function fieldLinkfn(obj){\r\n		var $this = $(obj);\r\n		var value = $this.val();\r\n		if(value != \"\"){\r\n			var fieldid = $this.attr(\"id\");\r\n			var text = $this.find(\"option:selected\").text();\r\n			var result = {\"name\" : text, \"value\" : value};\r\n			readyToTrigger(fieldid, result);//\u89e6\u53d1\u8054\u52a8\r\n		}\r\n	}\r\n	\r\n	function jionActionUrl(invoker, queryStr){\r\n		if(!queryStr){\r\n			queryStr = \"\";\r\n		}\r\n		if(queryStr.indexOf(\"&\") != 0){\r\n			queryStr = \"&\" + queryStr;\r\n		}\r\n		return \"/mobilemode/Action.jsp?invoker=\" + invoker + queryStr;\r\n	}\r\n	\r\n	// \u5e03\u5c40\u9875\u9762\u65e5\u671f\u5b57\u6bb5\u6e05\u7a7a\u65b9\u6cd5\r\n	function showClearBtn(fieldid){\r\n		var $clearBtn = $(\"#fieldSub\"+fieldid);\r\n		$clearBtn.show();\r\n		$clearBtn.click(function(e){\r\n			e.stopPropagation();\r\n			var fieldval = $(\"#field\"+fieldid).val();\r\n			if(fieldval && fieldval != \"\"){\r\n				$(\"#field\"+fieldid).val(\"\");\r\n				$clearBtn.hide();\r\n				$clearBtn.unbind();\r\n			}\r\n		});\r\n	}\r\n	\r\n	// \u5224\u65adinput\u6846\u4e2d\u662f\u5426\u8f93\u5165\u7684\u662f\u5c0f\u6570,\u5305\u62ec\u5c0f\u6570\u70b9\r\n	/*\r\n	 * p\uff08\u7cbe\u5ea6\uff09 \u6307\u5b9a\u5c0f\u6570\u70b9\u5de6\u8fb9\u548c\u53f3\u8fb9\u53ef\u4ee5\u5b58\u50a8\u7684\u5341\u8fdb\u5236\u6570\u5b57\u7684\u6700\u5927\u4e2a\u6570\u3002\u7cbe\u5ea6\u5fc5\u987b\u662f\u4ece 1 \u5230\u6700\u5927\u7cbe\u5ea6\u4e4b\u95f4\u7684\u503c\u3002\u6700\u5927\u7cbe\u5ea6\u4e3a 38\u3002\r\n	 * \r\n	 * s\uff08\u5c0f\u6570\u4f4d\u6570\uff09 \u6307\u5b9a\u5c0f\u6570\u70b9\u53f3\u8fb9\u53ef\u4ee5\u5b58\u50a8\u7684\u5341\u8fdb\u5236\u6570\u5b57\u7684\u6700\u5927\u4e2a\u6570\u3002\u5c0f\u6570\u4f4d\u6570\u5fc5\u987b\u662f\u4ece 0 \u5230 p \u4e4b\u95f4\u7684\u503c\u3002\u9ed8\u8ba4\u5c0f\u6570\u4f4d\u6570\u662f 0\uff0c\u56e0\u800c 0 <= s <=\r\n	 * p\u3002\u6700\u5927\u5b58\u50a8\u5927\u5c0f\u57fa\u4e8e\u7cbe\u5ea6\u800c\u53d8\u5316\u3002\r\n	 */\r\n	function ItemDecimal_KeyPress(elementname,p,s)\r\n	{\r\n		var evt = getEvent();\r\n		var keyCode = evt.which ? evt.which : evt.keyCode;\r\n		tmpvalue = $GetEle(elementname).value;\r\n	\r\n	    var dotCount = 0;\r\n		var integerCount=0;\r\n		var afterDotCount=0;\r\n		var hasDot=false;\r\n	\r\n	    var len = -1;\r\n	    if(elementname){\r\n			len = tmpvalue.length;\r\n	    }\r\n	\r\n	    for(i = 0; i < len; i++){\r\n			if(tmpvalue.charAt(i) == \".\"){ \r\n				dotCount++;\r\n				hasDot=false;\r\n			}else{\r\n				if(hasDot==false){\r\n					integerCount++;\r\n				}else{\r\n					afterDotCount++;\r\n				}\r\n			}		\r\n	    }\r\n	\r\n	    if(!(((keyCode>=48) && (keyCode<=57)) || keyCode==46 || keyCode==45) || (keyCode==46 && dotCount == 1)){  \r\n			if (evt.keyCode) {\r\n		     	evt.keyCode = 0;evt.returnValue=false;     \r\n		     } else {\r\n		     	evt.which = 0;evt.preventDefault();\r\n		     }\r\n	    }\r\n		if(integerCount>=p-s && hasDot==false && (keyCode>=48) && (keyCode<=57)){\r\n			if (evt.keyCode) {\r\n		     	evt.keyCode = 0;evt.returnValue=false;     \r\n		     } else {\r\n		     	evt.which = 0;evt.preventDefault();\r\n		     }\r\n		}\r\n		if(afterDotCount>=s&&integerCount>=p-s){\r\n			 if (evt.keyCode) {\r\n		     	evt.keyCode = 0;evt.returnValue=false;     \r\n		     } else {\r\n		     	evt.which = 0;evt.preventDefault();\r\n		     }\r\n		}\r\n		/* \u65b0\u589e */\r\n		var rtnflg = false;\r\n		\r\n		var cursorPosition = getCursortPosition($GetEle(elementname));\r\n		var vidValue = $GetEle(elementname).value;\r\n		var dotIndex = vidValue.indexOf(\".\");\r\n		if (hasDot) {\r\n			if (cursorPosition <= dotIndex) {\r\n				if (integerCount >= (p - s)) {\r\n					rtnflg = true;\r\n				}\r\n			} else {\r\n				if(afterDotCount >= s) {\r\n					rtnflg = true;\r\n				}\r\n			}\r\n		}\r\n		\r\n		if (rtnflg) {\r\n			if (evt.keyCode != undefined) {\r\n				evt.keyCode = 0;\r\n				evt.returnValue=false;     \r\n			} else {\r\n				evt.which = 0;\r\n				evt.preventDefault();\r\n			}\r\n		}\r\n	}\r\n	\r\n	function getEvent() {\r\n		if (window.ActiveXObject) {\r\n			return window.event;// \u5982\u679c\u662fie\r\n		}\r\n		var func = getEvent.caller;\r\n		while (func != null) {\r\n			var arg0 = func.arguments[0];\r\n			if (arg0) {\r\n				if ((arg0.constructor == Event || arg0.constructor == MouseEvent)\r\n						|| (typeof (arg0) == \"object\" && arg0.preventDefault && arg0.stopPropagation)) {\r\n					return arg0;\r\n				}\r\n			}\r\n			func = func.caller;\r\n		}\r\n		return null;\r\n	}\r\n	\r\n	/**\r\n	 * \u6839\u636e\u6807\u8bc6\uff08name\u6216\u8005id\uff09\u83b7\u53d6\u5143\u7d20\uff0c\u4e3b\u8981\u7528\u4e8e\u89e3\u51b3\u7cfb\u7edf\u4e2d\u5f88\u591a\u5143\u7d20\u6ca1\u6709id\u5c5e\u6027\uff0c\r\n	 * \u5374\u5728js\u4e2d\u4f7f\u7528document.getElementById(name)\u6765\u83b7\u53d6\u5143\u7d20\u7684\u95ee\u9898\u3002\r\n	 * @param identity name\u6216\u8005id\r\n	 * @return \u5143\u7d20\r\n	 */\r\n	function $GetEle(identity, _document) {\r\n		var rtnEle = null;\r\n		if (_document == undefined || _document == null) _document = document;\r\n		\r\n		rtnEle = _document.getElementById(identity);\r\n		if (rtnEle == undefined || rtnEle == null) {\r\n			rtnEle = _document.getElementsByName(identity);\r\n			if (rtnEle.length > 0) rtnEle = rtnEle[0];\r\n			else rtnEle = null;\r\n		}\r\n		return rtnEle;\r\n	}\r\n	\r\n	/**\r\n	 * \u83b7\u53d6\u5149\u6807\u6240\u5728\u4f4d\u7f6e\r\n	 */\r\n	function getCursortPosition(inputElement) {\r\n		var CaretPos = 0; \r\n		if (document.selection) {\r\n			inputElement.focus();\r\n			var Sel = document.selection.createRange();\r\n			Sel.moveStart('character', -inputElement.value.length);\r\n			CaretPos = Sel.text.length;\r\n		} else if (inputElement.selectionStart || inputElement.selectionStart == '0') { //ff\r\n			CaretPos = inputElement.selectionStart;\r\n		}\r\n		return (CaretPos);\r\n	}\r\n	\r\n	function changeToNormalFormat(inputfieldname){\r\n	    var sourcevalue = $GetEle(inputfieldname).value;\r\n	    sourcevalue = sourcevalue.replace(/,/g,\"\");\r\n	    $GetEle(inputfieldname).value = sourcevalue;\r\n	}\r\n	\r\n	function changeToThousands(inputfieldname,qfws){\r\n	    var sourcevalue = $GetEle(inputfieldname).value;\r\n		var dlength =$GetEle(inputfieldname).getAttribute(\"datalength\")\r\n		if(0 < dlength && $GetEle(inputfieldname).getAttribute(\"datavaluetype\") != \"5\"){\r\n			sourcevalue = addZero(sourcevalue,dlength);\r\n		}else if($GetEle(inputfieldname).getAttribute(\"datavaluetype\") == \"5\"){\r\n			sourcevalue = addZero(sourcevalue,qfws);\r\n			sourcevalue=sourcevalue.replace(/\\s+/g,\"\"); \r\n			if(sourcevalue != ''){\r\n				sourcevalue =commafy(sourcevalue);\r\n			}\r\n		}\r\n	    $GetEle(inputfieldname).value = sourcevalue;\r\n	}\r\n	\r\n	function addZero(aNumber,precision){\r\n		if(aNumber==null || aNumber.trim()==\"\" || isNaN(aNumber))return \"\";\r\n		var valInt = (aNumber.toString().split(\".\")[1]+\"\").length;\r\n		if(valInt != precision){\r\n		    var lengInt = precision-valInt;\r\n			//\u5224\u65ad\u6dfb\u52a0\u5c0f\u6570\u4f4d0\u7684\u4e2a\u6570\r\n			if(lengInt == 1){\r\n				aNumber += \"0\";\r\n			}else if(lengInt == 2){\r\n				aNumber += \"00\";\r\n			}else if(lengInt == 3){\r\n				aNumber += \"000\";\r\n			}else if(lengInt < 0){\r\n				if(precision == 1){\r\n					aNumber += \".0\";\r\n				}else if(precision == 2){\r\n					aNumber += \".00\";\r\n				}else if(precision == 3){\r\n					aNumber += \".000\";\r\n				}else if(precision == 4){\r\n					aNumber += \".0000\";\r\n				}\r\n				var ins = aNumber.toString().split(\".\");\r\n				if(ins.length>2){\r\n					aNumber = parseFloat(ins[0]+\".\"+ins[1]).toFixed(precision);\r\n				}\r\n			}		\r\n		}\r\n		return  aNumber;			\r\n	}\r\n	\r\n	/**  \r\n	 * \u6570\u5b57\u683c\u5f0f\u8f6c\u6362\u6210\u5343\u5206\u4f4d  \r\n	 * @param{Object}num  \r\n	 */  \r\n	function commafy(num) { \r\n	 \r\n		num = num + \"\";   \r\n		num = num.replace(/[ ]/g, \"\"); //\u53bb\u9664\u7a7a\u683c  \r\n	 \r\n	   if (num == \"\") {   \r\n	       return;   \r\n	    }   \r\n	 \r\n	    if (isNaN(num)){  \r\n	    return;   \r\n	   }   \r\n	 \r\n	   //2.\u9488\u5bf9\u662f\u5426\u6709\u5c0f\u6570\u70b9\uff0c\u5206\u60c5\u51b5\u5904\u7406   \r\n	   var index = num.indexOf(\".\");   \r\n	    if (index==-1) {//\u65e0\u5c0f\u6570\u70b9   \r\n	      var reg = /(-?\\d+)(\\d{3})/;   \r\n	       while (reg.test(num)) {   \r\n	        num = num.replace(reg, \"$1,$2\");   \r\n	        }   \r\n	    } else {   \r\n	        var intPart = num.substring(0, index);   \r\n	       var pointPart = num.substring(index + 1, num.length);   \r\n	       var reg = /(-?\\d+)(\\d{3})/;   \r\n	      while (reg.test(intPart)) {   \r\n	       intPart = intPart.replace(reg, \"$1,$2\");   \r\n	       }   \r\n	      num = intPart +\".\"+ pointPart;   \r\n	   }   \r\n	   \r\n	   return num;  \r\n	}\r\n	\r\n	if(typeof(Mobile_NS) == 'undefined'){\r\n		Mobile_NS = {};\r\n	}\r\n\r\n	Mobile_NS.groupViewImg = function(source){\r\n		$(\"img[data-groupid]\").each(function(){\r\n			var that = this;\r\n			var hasEvent = $(that).attr(\"data-groupev\") == \"true\";\r\n			if(!hasEvent){\r\n				$(that).attr(\"data-groupev\", \"true\");\r\n				$(that).click(function(e){\r\n					var groupid = $(this).attr(\"data-groupid\");\r\n					var currSrc = $(this).attr(\"src\");\r\n					\r\n					var imgSrcs = \"\";\r\n					$(\"img[data-groupid='\"+groupid+\"']\").each(function(){\r\n						var src = $(this).attr(\"src\");\r\n						imgSrcs += src + \"|\";\r\n					});\r\n					if(imgSrcs != \"\"){\r\n						imgSrcs = imgSrcs.substring(0, imgSrcs.length - 1);\r\n					}\r\n					\r\n					imgSrcs = encodeURIComponent(imgSrcs);\r\n					currSrc = encodeURIComponent(currSrc);\r\n					var url = \"/mobilemode/displayPicOnMobile.jsp?imgSrc=\"+imgSrcs+\"&imgSrcActive=\"+currSrc+\"&1=1\";\r\n					openDetail(url);\r\n					\r\n					e.stopPropagation();\r\n				});\r\n			}\r\n		});\r\n	};\r\n</script>\r\n<script>\r\n".toCharArray();
    _jsp_string24 = "\r\n\r\n<div style=\"display: none;\">\r\n	<input type=hidden name=formmodeid id=\"formmodeid\" value=\"".toCharArray();
    _jsp_string17 = "');\">".toCharArray();
    _jsp_string5 = ";\r\n	</script>\r\n	<script type=\"text/javascript\" src=\"/mobilemode/js/iscroll/iscroll5_wev8.js\"></script>\r\n	<script type=\"text/javascript\" src=\"/mobilemode/js/iscroll/iScrollHandler_wev8.js\"></script>\r\n	<link type=\"text/css\" rel=\"stylesheet\" media=\"all\" href=\"/mobilemode/css/iScroll_wev8.css\" />\r\n".toCharArray();
    _jsp_string18 = "</div>\r\n		<div class=\"moreFlag\"></div>\r\n	</div>\r\n	\r\n	".toCharArray();
    _jsp_string29 = "\r\n</div>\r\n".toCharArray();
    _jsp_string7 = "\r\n\r\n".toCharArray();
  }
}
