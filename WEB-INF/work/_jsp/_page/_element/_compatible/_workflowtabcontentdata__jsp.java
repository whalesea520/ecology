/*
 * JSP generated by Resin-3.1.8 (built Mon, 17 Nov 2008 12:15:21 PST)
 */

package _jsp._page._element._compatible;
import javax.servlet.*;
import javax.servlet.jsp.*;
import javax.servlet.http.*;
import java.util.ArrayList;
import weaver.conn.*;
import weaver.general.*;
import weaver.homepage.style.HomepageStyleBean;
import java.util.*;
import weaver.hrm.*;
import weaver.systeminfo.*;
import weaver.general.StaticObj;
import weaver.general.Util;
import weaver.hrm.settings.RemindSettings;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import oracle.sql.CLOB;
import java.io.BufferedReader;
import weaver.workflow.request.*;
import weaver.workflow.request.todo.RequestUtil;
import weaver.page.HPTypeEnum;
import weaver.conn.RecordSet;

public class _workflowtabcontentdata__jsp extends com.caucho.jsp.JavaPage
{
  private static final java.util.HashMap<String,java.lang.reflect.Method> _jsp_functionMap = new java.util.HashMap<String,java.lang.reflect.Method>();
  private boolean _caucho_isDead;

  
  public String getExistsSql(String eid,String tabid,String field,String type,boolean isExclude){
      return getExistsSql(eid,tabid,field,type,isExclude,"and");
  }
  public String getExistsSql(String eid,String tabid,String field,String type,boolean isExclude,String expression){
      RecordSet recordSet = new RecordSet();
      String sql="";
      recordSet.execute("select count(*) from workflowcentersettingdetail where eid="+eid+" and tabid='"+tabid+"' and type='"+type+"'");
      recordSet.next();
      if(recordSet.getInt(1)>0){
          if(isExclude){
              sql = " "+expression+" "+field+" not in (select content from workflowcentersettingdetail where type='"+type+"' and eid="+eid+" and tabId ='"+tabid+"') ";
          }else{
              sql = " "+expression+" "+field+" in (select content from workflowcentersettingdetail where type='"+type+"' and eid="+eid+" and tabId ='"+tabid+"') ";
          }
      }
          
      
      return sql;
  
  }
  
  public ArrayList getContentList(String eid,String tabid,String type){
      ArrayList list  = new ArrayList();
      RecordSet recordSet = new RecordSet();
      recordSet.execute("select content from workflowcentersettingdetail where eid='"+eid+"' and tabid='"+tabid+"' and type='"+type+"'");
      while(recordSet.next()){
          list.add(recordSet.getString("content"));
      }
      return list;
  }
  public int getCount(String eid,String tabid,String type){
      int count  = 0;
      RecordSet recordSet = new RecordSet();
      recordSet.execute("select count(id) from workflowcentersettingdetail where eid="+eid+" and tabid='"+tabid+"' and type='"+type+"'");
      while(recordSet.next()){
          count = recordSet.getInt(1);
      }
      return count;
  }
  public String getFreeNodeSql(String eid,String tabid,String key,boolean isExclude ){
      String plusStr = " or ",isIn = " in ";
      String retStr = " and (";
      if(isExclude) {
          isIn = " not in ";
          plusStr = " and ";
      }
      retStr+=  key + isIn+  " (select content from workflowcentersettingdetail where type='nodeid' and eid="+eid+" and tabid='"+tabid+"') " 
          +plusStr + " t2.nodeid " + isIn+ " (select n.id from workflow_nodebase n, workflow_flownode f where n.id=f.nodeid and n.isfreenode='1' and f.workflowid in (select content from workflowcentersettingdetail where type='flowid' and eid="+eid+" and tabid='"+tabid+"') )) ";
      return retStr;
  }
  
  public String getQuerySql(String eid, String tabid, String backFields, String sqlFrom, String sqlWhere, int perpage, String viewType, String ofsSql) {
  	String returnSql = "";
  	RecordSet rs = new RecordSet();
  	String dbType = rs.getDBType();
  	
  	if ("oracle".equals(dbType)) {
  		String oracleRow = "oracle_rownum";
  		returnSql = "select r.* from (  " +
  			" select my_table.*, rownum as my_rownum from (" + 
  				" select tableA.*, rownum as "+ oracleRow +" from (" +  
  					" select ";
  				
  		if (Util.getIntValue(viewType) == 6) { // \u7763\u529e
  			returnSql += backFields;
  		} else {
  			returnSql += " distinct " + backFields;
  		}
  		
  		// \u6dfb\u52a0from\u8bed\u53e5
  		String _sqlFrom = sqlFrom.trim();
  		if (_sqlFrom.length() > 4 && _sqlFrom.substring(0, 4).equalsIgnoreCase("from")) {
  			returnSql += " " + sqlFrom;
  		} else {
  			returnSql += " from " + sqlFrom;
  		}
  
  		//\u6dfb\u56dewhere\u8bed\u53e5
  		String _sqlWhere = sqlWhere.trim();
  		if (!"".equalsIgnoreCase(_sqlWhere)) { 
  			if (_sqlWhere.length() > 5 && _sqlWhere.substring(0, 5).equalsIgnoreCase("where")) {
  				returnSql += " " + sqlWhere;
  			} else {
  				returnSql += " where " + sqlWhere;
  			}
  		}
  		
  		//\u7edf\u4e00\u5f85\u529e\u5f02\u6784\u7cfb\u7edf\u6d41\u7a0b
  		if (!"".equals(ofsSql)) {
  			returnSql += " union all " + ofsSql;
  		}
  		
  		returnSql += ") tableA ";
  		
  		returnSql += " order by ";
  		int ivt = Util.getIntValue(viewType);
  	    if (ivt == 2 || ivt == 3) { // \u5df2\u529e\u3001\u529e\u7ed3\u6309\u7167\u5904\u7406\u65f6\u95f4\u6392\u5e8f
  	        returnSql += " tableA.operatedate desc, tableA.operatetime desc";
  	    } else if (ivt == 4) { // \u6211\u7684\u8bf7\u6c42\u6309\u7167\u521b\u5efa\u65f6\u95f4\u6392\u5e8f
  	        returnSql += " tableA.createdate desc , tableA.createtime desc";
  	    } else if (Util.getIntValue(viewType)==6) { // \u7763\u529e
  			returnSql += " tableA.receivedate desc";
  		} else { // \u5176\u4ed6\u6309\u7167\u63a5\u53d7\u65f6\u95f4\u6392\u5e8f
  			returnSql += " tableA.receivedate desc, tableA.receivetime desc";
  	    }
  		
  		returnSql += " ) my_table ) r where my_rownum <= " + perpage + " and my_rownum > 0 ";
  	} else if ("sqlserver".equals(dbType)) {
  		returnSql = "select "; 
  		
  		if (Util.getIntValue(viewType) == 6) { // \u7763\u529e
  			returnSql += backFields;
  		} else {
  			returnSql += " distinct " + backFields;
  		}
  		
  		// \u6dfb\u52a0from\u8bed\u53e5
  		String _sqlFrom = sqlFrom.trim();
  		if (_sqlFrom.length() > 4 && _sqlFrom.substring(0, 4).equalsIgnoreCase("from")) {
  			returnSql += " " + sqlFrom;
  		} else {
  			returnSql += " from " + sqlFrom;
  		}
  
  		//\u6dfb\u56dewhere\u8bed\u53e5
  		String _sqlWhere = sqlWhere.trim();
  		if (!"".equalsIgnoreCase(_sqlWhere)) { 
  			if (_sqlWhere.length() > 5 && _sqlWhere.substring(0, 5).equalsIgnoreCase("where")) {
  				returnSql += " " + sqlWhere;
  			} else {
  				returnSql += " where " + sqlWhere;
  			}
  		}
  		
  		//\u7edf\u4e00\u5f85\u529e\u5f02\u6784\u7cfb\u7edf\u6d41\u7a0b
  		if (!"".equals(ofsSql)) {
  			returnSql += " union all " + ofsSql;
  		}
  		
  		returnSql = "select top "+ perpage +" a.* from (" + returnSql + ") a";
  		
  		returnSql += " order by ";
  	    int ivt = Util.getIntValue(viewType);
  	    if (ivt == 2 || ivt == 3) { // \u5df2\u529e\u3001\u529e\u7ed3\u6309\u7167\u5904\u7406\u65f6\u95f4\u6392\u5e8f
  	        returnSql += " a.operatedate desc, a.operatetime desc";
  	    } else if (ivt == 4) { // \u6211\u7684\u8bf7\u6c42\u6309\u7167\u521b\u5efa\u65f6\u95f4\u6392\u5e8f
  	        returnSql += " a.createdate desc, a.createtime desc";
  	    } else if (Util.getIntValue(viewType)==6) { // \u7763\u529e
  			returnSql += " a.receivedate desc";
  		} else { // \u5176\u4ed6\u6309\u7167\u63a5\u53d7\u65f6\u95f4\u6392\u5e8f
  			returnSql += " a.receivedate desc, a.receivetime desc";
  	    }
  	}
  	
  	return returnSql;
  }

  
  public void
  _jspService(javax.servlet.http.HttpServletRequest request,
              javax.servlet.http.HttpServletResponse response)
    throws java.io.IOException, javax.servlet.ServletException
  {
    javax.servlet.http.HttpSession session = request.getSession(true);
    com.caucho.server.webapp.WebApp _jsp_application = _caucho_getApplication();
    javax.servlet.ServletContext application = _jsp_application;
    com.caucho.jsp.PageContextImpl pageContext = _jsp_application.getJspApplicationContext().allocatePageContext(this, _jsp_application, request, response, null, session, 8192, true, false);
    javax.servlet.jsp.PageContext _jsp_parentContext = pageContext;
    javax.servlet.jsp.JspWriter out = pageContext.getOut();
    final javax.el.ELContext _jsp_env = pageContext.getELContext();
    javax.servlet.ServletConfig config = getServletConfig();
    javax.servlet.Servlet page = this;
    response.setContentType("text/html; charset=UTF-8");
    request.setCharacterEncoding("UTF-8");
    try {
      out.write(_jsp_string0, 0, _jsp_string0.length);
      weaver.page.PageCominfo hpc;
      hpc = (weaver.page.PageCominfo) pageContext.getAttribute("hpc");
      if (hpc == null) {
        hpc = new weaver.page.PageCominfo();
        pageContext.setAttribute("hpc", hpc);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.page.PageUtil hpu;
      hpu = (weaver.page.PageUtil) pageContext.getAttribute("hpu");
      if (hpu == null) {
        hpu = new weaver.page.PageUtil();
        pageContext.setAttribute("hpu", hpu);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.homepage.cominfo.HomepageElementCominfo hpec;
      hpec = (weaver.homepage.cominfo.HomepageElementCominfo) pageContext.getAttribute("hpec");
      if (hpec == null) {
        hpec = new weaver.homepage.cominfo.HomepageElementCominfo();
        pageContext.setAttribute("hpec", hpec);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.homepage.cominfo.HomepageElementFieldCominfo hpefc;
      hpefc = (weaver.homepage.cominfo.HomepageElementFieldCominfo) pageContext.getAttribute("hpefc");
      if (hpefc == null) {
        hpefc = new weaver.homepage.cominfo.HomepageElementFieldCominfo();
        pageContext.setAttribute("hpefc", hpefc);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.homepage.HomepageExtShow hpes;
      hpes = (weaver.homepage.HomepageExtShow) pageContext.getAttribute("hpes");
      if (hpes == null) {
        hpes = new weaver.homepage.HomepageExtShow();
        pageContext.setAttribute("hpes", hpes);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.homepage.style.HomepageStyleUtil hpsu;
      hpsu = (weaver.homepage.style.HomepageStyleUtil) pageContext.getAttribute("hpsu");
      if (hpsu == null) {
        hpsu = new weaver.homepage.style.HomepageStyleUtil();
        pageContext.setAttribute("hpsu", hpsu);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.page.PageCominfo pc;
      pc = (weaver.page.PageCominfo) pageContext.getAttribute("pc");
      if (pc == null) {
        pc = new weaver.page.PageCominfo();
        pageContext.setAttribute("pc", pc);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.page.style.ElementStyleCominfo esc;
      esc = (weaver.page.style.ElementStyleCominfo) pageContext.getAttribute("esc");
      if (esc == null) {
        esc = new weaver.page.style.ElementStyleCominfo();
        pageContext.setAttribute("esc", esc);
      }
      out.write(_jsp_string2, 0, _jsp_string2.length);
      weaver.conn.RecordSet rsCommon;
      rsCommon = (weaver.conn.RecordSet) pageContext.getAttribute("rsCommon");
      if (rsCommon == null) {
        rsCommon = new weaver.conn.RecordSet();
        pageContext.setAttribute("rsCommon", rsCommon);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.page.element.ElementUtil ec;
      ec = (weaver.page.element.ElementUtil) pageContext.getAttribute("ec");
      if (ec == null) {
        ec = new weaver.page.element.ElementUtil();
        pageContext.setAttribute("ec", ec);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.page.PageUtil pu;
      pu = (weaver.page.PageUtil) pageContext.getAttribute("pu");
      if (pu == null) {
        pu = new weaver.page.PageUtil();
        pageContext.setAttribute("pu", pu);
      }
      out.write(_jsp_string3, 0, _jsp_string3.length);
      
	
	response.setHeader("cache-control", "no-cache");
	response.setHeader("pragma", "no-cache");
	response.setHeader("expires", "Mon 1 Jan 1990 00:00:00 GMT");
	

	User user = HrmUserVarify.getUser (request , response) ;
	if(user == null)  return ;
	Log logger= LogFactory.getLog(this.getClass());
	String isIE = (String)session.getAttribute("browser_isie");

      out.write(_jsp_string1, 0, _jsp_string1.length);
      
	 /*
	 \u57fa\u672c\u4fe1\u606f
	 --------------------------------------
	 hpid:\u8868\u9996\u9875ID
	 subCompanyId:\u9996\u9875\u6240\u5c5e\u5206\u90e8\u7684\u5206\u90e8ID
	 eid:\u5143\u7d20ID
	 ebaseid:\u57fa\u672c\u5143\u7d20ID
	 styleid:\u6837\u5f0fID
	 
	 \u6761\u4ef6\u4fe1\u606f
	 --------------------------------------
	 String strsqlwhere \u683c\u5f0f\u4e3a \u6761\u4ef61^,^\u6761\u4ef62...
	 int perpage  \u663e\u793a\u9875\u6570
	 String linkmode \u67e5\u770b\u65b9\u5f0f  1:\u5f53\u524d\u9875 2:\u5f39\u51fa\u9875

	 
	 \u5b57\u6bb5\u4fe1\u606f
	 --------------------------------------
	 fieldIdList
	 fieldColumnList
	 fieldIsDate
	 fieldTransMethodList
	 fieldWidthList
	 linkurlList
	 valuecolumnList
	 isLimitLengthList

	 \u6837\u5f0f\u4fe1\u606f
	 ----------------------------------------
	 String hpsb.getEsymbol() \u5217\u9996\u56fe\u6807
	 String hpsb.getEsparatorimg()   \u884c\u5206\u9694\u7ebf 
	 */

      out.write(_jsp_string1, 0, _jsp_string1.length);
      
	String hpid = Util.null2String(request.getParameter("hpid"));
	int subCompanyId = Util.getIntValue(request
			.getParameter("subCompanyId"), -1);
	String eid = Util.null2String(request.getParameter("eid"));
	String ebaseid = Util.null2String(request.getParameter("ebaseid"));
	String styleid = Util.null2String(request.getParameter("styleid"));
	int perpage = 0;
	int userid = pu.getHpUserId(hpid, "" + subCompanyId, user);
	int usertype = pu.getHpUserType(hpid, "" + subCompanyId, user);
	if(Util.getIntValue(hpid)<0) {//\u534f\u540c\u7684 userid  \u548c usertype \u4e3a 1  \u548c 0
		userid = 1;
		usertype = 0;
	}
	//\u5224\u65ad\u5f53\u524d\u7528\u6237\u662f\u5426\u6709\u6743\u9650\u67e5\u770b\u8be5\u5143\u7d20
	
	boolean hasRight =true;
	User loginuser = (User)request.getSession(true).getAttribute("weaver_user@bean") ;
	// \u5148\u53d6\u6d88\u6743\u9650\u5224\u65ad
	if(loginuser != null)  {
		hasRight =  ec.isHasRight(eid,loginuser.getUID()+"",0,1);
	}
	if(!hasRight){
		response.sendRedirect("/page/element/noright.jsp");
	}
	//HomepageStyleBean hpsb = hpsu.getHpsb(styleid);

	//\u5f97\u5230\u9700\u8981\u663e\u793a\u7684\u5b57\u6bb5
	ArrayList fieldIdList = new ArrayList();
	ArrayList fieldColumnList = new ArrayList();
	ArrayList fieldIsDate = new ArrayList();
	ArrayList fieldTransMethodList = new ArrayList();
	ArrayList fieldWidthList = new ArrayList();
	ArrayList linkurlList = new ArrayList();
	ArrayList valuecolumnList = new ArrayList();
	ArrayList isLimitLengthList = new ArrayList();

	
	rsCommon.executeSql("select 1 from hpinfo where id="+hpid+" and isLocked=1");
	if (rsCommon.next()) {
		rsCommon.executeSql("select creatorid,creatortype from hpinfo where id="+hpid);
		if(rsCommon.next())
		{
			userid =Util.getIntValue(rsCommon.getString("creatorid"));
			usertype = Util.getIntValue(rsCommon.getString("creatortype"));
		}
	}

	String fields = "";
	String linkmode = "";
	String currenttab="";
	String isremind = "";

	String strsqlwhere = hpec.getStrsqlwhere(eid);
	
	String strSql = "select perpage,linkmode,showfield,isremind from hpElementSettingDetail where eid="
			+ eid
			+ " and usertype="
			+ usertype;
	//\u6392\u9664\u975e\u534f\u540c
	//if(Util.getIntValue(hpid)>0)
		strSql+= " and userid="+ userid;
	rsCommon.executeSql(strSql);
	//System.out.println("Common.jsp strSql====>"+strSql);
	if (rsCommon.next()) {
		fields = Util.null2String(rsCommon.getString("showfield"));
		perpage = Util.getIntValue(rsCommon.getString("perpage"));
		linkmode = Util.null2String(rsCommon.getString("linkmode"));
		isremind= Util.null2String(rsCommon.getString("isremind"));
	} else {
		//\u7528\u4e8e\u5143\u7d20\u72ec\u7acb\u663e\u793a\u5224\u65ad\uff0c\u82e5\u4e2a\u4eba\u914d\u7f6e\u4e0d\u5b58\u5728\uff0c\u8bfb\u53d6\u7ba1\u7406\u5458\u6570\u636e\u3002
		if ("true".equals(Util.null2String(request.getParameter("indie"), "false"))) {
			strSql = "select perpage,linkmode,showfield,isremind from hpElementSettingDetail where eid="
				+ eid
				+ " and usertype=3";
		}
		rsCommon.executeSql(strSql);
		if (rsCommon.next()) {
			fields = Util.null2String(rsCommon.getString("showfield"));
			perpage = Util.getIntValue(rsCommon.getString("perpage"));
			linkmode = Util.null2String(rsCommon.getString("linkmode"));
			isremind= Util.null2String(rsCommon.getString("isremind"));
		}
	}
	boolean needRecordTab = true;
	strSql="select isremembertab  from PageUserDefault where userid="+user.getUID();
	rsCommon.executeSql(strSql);
	if(rsCommon.next()){
		needRecordTab = !"0".equals(rsCommon.getString("isremembertab"));
	}
	String strsql2 = null;
	if(needRecordTab){//\u53ea\u6709\u5f00\u542f\u4e86\u8bb0\u5f55\u6700\u540e\u9009\u4e2d\u53f6\u7b7e\uff0c\u624d\u9700\u8981\u67e5\u8be5\u6570\u636e
		strsql2 = "select currenttab from hpcurrenttab where eid="+eid
		+ " and usertype="
		+ user.getType();
		//\u6392\u9664\u975e\u534f\u540c
		//if(Util.getIntValue(hpid)>0)
			strsql2+= " and userid="+ user.getUID();
		rsCommon.execute(strsql2);
		
		if(rsCommon.next()){
			currenttab = Util.null2String(rsCommon.getString("currenttab"));
		}else{
			rsCommon.execute("insert into hpcurrenttab (currenttab,eid,userid,usertype) values ( null,"+eid+","+user.getUID()+","+user.getType()+")");
		}
	}
	
	
	if (!"".equals(fields)) {
		ArrayList tempFieldList = Util.TokenizerString(fields, ",");
		for (int i = 0; i < tempFieldList.size(); i++) {
			String tempId = (String) tempFieldList.get(i);
			fieldIdList.add(tempId);
			fieldColumnList.add(hpefc.getFieldcolumn(tempId));
			fieldIsDate.add(hpefc.getIsdate(tempId));
			fieldTransMethodList.add(hpefc.getTransmethod(tempId));
			fieldWidthList.add(hpefc.getFieldWidth(tempId));
			linkurlList.add(hpefc.getLinkurl(tempId));
			valuecolumnList.add(hpefc.getValuecolumn(tempId));
			isLimitLengthList.add(hpefc.getIsLimitLength(tempId));
		}
	}
	String isFixationRowHeight="0";
	String background="";
	strSql = "select isFixationRowHeight,background from hpelement where id="+ eid;
	rsCommon.executeSql(strSql);
	if (rsCommon.next()) {
		isFixationRowHeight = Util.null2String(rsCommon.getString("isFixationRowHeight"));
		background = Util.null2String(rsCommon.getString("background"));
	}
	
	String eStyleid=hpec.getStyleid(eid);
	
	String pagetype = Util.null2String(request.getParameter("pagetype"), "");
	String fieldids = Util.null2String(request.getParameter("fieldids"), "");
	String fieldvalues = Util.null2String(request.getParameter("fieldvalues"), "");

      out.write(_jsp_string0, 0, _jsp_string0.length);
      weaver.page.element.WorkflowCount WorkflowCount;
      WorkflowCount = (weaver.page.element.WorkflowCount) pageContext.getAttribute("WorkflowCount");
      if (WorkflowCount == null) {
        WorkflowCount = new weaver.page.element.WorkflowCount();
        pageContext.setAttribute("WorkflowCount", WorkflowCount);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.docs.news.DocNewsManager dnm;
      dnm = (weaver.docs.news.DocNewsManager) pageContext.getAttribute("dnm");
      if (dnm == null) {
        dnm = new weaver.docs.news.DocNewsManager();
        pageContext.setAttribute("dnm", dnm);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.docs.docs.DocManager dm;
      dm = (weaver.docs.docs.DocManager) pageContext.getAttribute("dm");
      if (dm == null) {
        dm = new weaver.docs.docs.DocManager();
        pageContext.setAttribute("dm", dm);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.conn.RecordSet rs;
      rs = (weaver.conn.RecordSet) pageContext.getAttribute("rs");
      if (rs == null) {
        rs = new weaver.conn.RecordSet();
        pageContext.setAttribute("rs", rs);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.conn.RecordSet rs1;
      rs1 = (weaver.conn.RecordSet) pageContext.getAttribute("rs1");
      if (rs1 == null) {
        rs1 = new weaver.conn.RecordSet();
        pageContext.setAttribute("rs1", rs1);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.conn.RecordSet rsIn;
      rsIn = (weaver.conn.RecordSet) pageContext.getAttribute("rsIn");
      if (rsIn == null) {
        rsIn = new weaver.conn.RecordSet();
        pageContext.setAttribute("rsIn", rsIn);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.general.SplitPageParaBean sppb;
      sppb = (weaver.general.SplitPageParaBean) pageContext.getAttribute("sppb");
      if (sppb == null) {
        sppb = new weaver.general.SplitPageParaBean();
        pageContext.setAttribute("sppb", sppb);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.general.SplitPageUtil spu;
      spu = (weaver.general.SplitPageUtil) pageContext.getAttribute("spu");
      if (spu == null) {
        spu = new weaver.general.SplitPageUtil();
        pageContext.setAttribute("spu", spu);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.homepage.HomepageFiled HomepageFiled;
      HomepageFiled = (weaver.homepage.HomepageFiled) pageContext.getAttribute("HomepageFiled");
      if (HomepageFiled == null) {
        HomepageFiled = new weaver.homepage.HomepageFiled();
        pageContext.setAttribute("HomepageFiled", HomepageFiled);
      }
      out.write(_jsp_string2, 0, _jsp_string2.length);
      weaver.hrm.company.DepartmentComInfo DepartmentComInfo;
      DepartmentComInfo = (weaver.hrm.company.DepartmentComInfo) pageContext.getAttribute("DepartmentComInfo");
      if (DepartmentComInfo == null) {
        DepartmentComInfo = new weaver.hrm.company.DepartmentComInfo();
        pageContext.setAttribute("DepartmentComInfo", DepartmentComInfo);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.hrm.resource.ResourceComInfo ResourceComInfo;
      ResourceComInfo = (weaver.hrm.resource.ResourceComInfo) pageContext.getAttribute("ResourceComInfo");
      if (ResourceComInfo == null) {
        ResourceComInfo = new weaver.hrm.resource.ResourceComInfo();
        pageContext.setAttribute("ResourceComInfo", ResourceComInfo);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.workflow.workflow.WorkTypeComInfo WorkTypeComInfo;
      WorkTypeComInfo = (weaver.workflow.workflow.WorkTypeComInfo) pageContext.getAttribute("WorkTypeComInfo");
      if (WorkTypeComInfo == null) {
        WorkTypeComInfo = new weaver.workflow.workflow.WorkTypeComInfo();
        pageContext.setAttribute("WorkTypeComInfo", WorkTypeComInfo);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.general.WorkFlowTransMethod WorkFlowTransMethod;
      WorkFlowTransMethod = (weaver.general.WorkFlowTransMethod) pageContext.getAttribute("WorkFlowTransMethod");
      if (WorkFlowTransMethod == null) {
        WorkFlowTransMethod = new weaver.general.WorkFlowTransMethod();
        pageContext.setAttribute("WorkFlowTransMethod", WorkFlowTransMethod);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.homepage.HomepageSetting HomepageSetting;
      HomepageSetting = (weaver.homepage.HomepageSetting) pageContext.getAttribute("HomepageSetting");
      if (HomepageSetting == null) {
        HomepageSetting = new weaver.homepage.HomepageSetting();
        pageContext.setAttribute("HomepageSetting", HomepageSetting);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.workflow.request.WFUrgerManager WFUrgerManager;
      WFUrgerManager = (weaver.workflow.request.WFUrgerManager) pageContext.getAttribute("WFUrgerManager");
      if (WFUrgerManager == null) {
        WFUrgerManager = new weaver.workflow.request.WFUrgerManager();
        pageContext.setAttribute("WFUrgerManager", WFUrgerManager);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.workflow.workflow.WorkflowComInfo WorkflowComInfo;
      WorkflowComInfo = (weaver.workflow.workflow.WorkflowComInfo) pageContext.getAttribute("WorkflowComInfo");
      if (WorkflowComInfo == null) {
        WorkflowComInfo = new weaver.workflow.workflow.WorkflowComInfo();
        pageContext.setAttribute("WorkflowComInfo", WorkflowComInfo);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.synergy.SynergyOperatWorkflow sowf;
      sowf = (weaver.synergy.SynergyOperatWorkflow) pageContext.getAttribute("sowf");
      if (sowf == null) {
        sowf = new weaver.synergy.SynergyOperatWorkflow();
        pageContext.setAttribute("sowf", sowf);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.systeminfo.setting.HrmUserSettingComInfo userSetting;
      userSetting = (weaver.systeminfo.setting.HrmUserSettingComInfo) pageContext.getAttribute("userSetting");
      if (userSetting == null) {
        userSetting = new weaver.systeminfo.setting.HrmUserSettingComInfo();
        pageContext.setAttribute("userSetting", userSetting);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.general.BaseBean baseBean;
      baseBean = (weaver.general.BaseBean) pageContext.getAttribute("baseBean");
      if (baseBean == null) {
        baseBean = new weaver.general.BaseBean();
        pageContext.setAttribute("baseBean", baseBean);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.workflow.request.WFShareAuthorization wfShareAuthorization;
      wfShareAuthorization = (weaver.workflow.request.WFShareAuthorization) pageContext.getAttribute("wfShareAuthorization");
      if (wfShareAuthorization == null) {
        wfShareAuthorization = new weaver.workflow.request.WFShareAuthorization();
        pageContext.setAttribute("wfShareAuthorization", wfShareAuthorization);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      
    /*
        \u57fa\u672c\u4fe1\u606f
        --------------------------------------
        hpid:\u8868\u9996\u9875ID
        subCompanyId:\u9996\u9875\u6240\u5c5e\u5206\u90e8\u7684\u5206\u90e8ID
        eid:\u5143\u7d20ID
        ebaseid:\u57fa\u672c\u5143\u7d20ID
        styleid:\u6837\u5f0fID
        
        \u6761\u4ef6\u4fe1\u606f
        --------------------------------------
        String strsqlwhere \u683c\u5f0f\u4e3a \u6761\u4ef61^,^\u6761\u4ef62...
        int perpage  \u663e\u793a\u9875\u6570
        String linkmode \u67e5\u770b\u65b9\u5f0f  1:\u5f53\u524d\u9875 2:\u5f39\u51fa\u9875
 
        
        \u5b57\u6bb5\u4fe1\u606f
        --------------------------------------
        fieldIdList
        fieldColumnList
        fieldIsDate
        fieldTransMethodList
        fieldWidthList
        linkurlList
        strsqlwherecolumnList
        isLimitLengthList

        \u6837\u5f0f\u4fe1\u606f
        ----------------------------------------
        String hpsb.getEsymbol() \u5217\u9996\u56fe\u6807
        String hpsb.getEsparatorimg()   \u884c\u5206\u9694\u7ebf 
    */


      out.write(_jsp_string1, 0, _jsp_string1.length);
        

    int wfTypeCount=0;
    int wfFlowCount = 0;
    int wfNodeCount = 0;
    String viewType="\uff11";
    String strSqlWf="";
    String showCopy="1";
    String completeflag="0";
    boolean isExclude=false;
    
    //\u66f4\u65b0\u5f53\u524dtab\u4fe1\u606f
    String tabid = Util.null2String(request.getParameter("tabId"));
    String updateSql = "update  hpcurrenttab set currenttab ='"+tabid+"' where eid="
        + eid
        + " and userid="
        + user.getUID()
        + " and usertype="
        + user.getType();
    rs.execute(updateSql);
    
  if (!"".equals(strsqlwhere))  { //\u8868\u793a\u4e3a\u8001\u7248\u672c\u6d41\u7a0b\u4e2d\u5fc3
        HomepageSetting.wfCenterUpgrade(strsqlwhere,Util.getIntValue(eid));
   } 

   String scolltype = "";
   rs.execute("select scrolltype,isRemind from hpelement where id="+eid ); 
   if(rs.next()){
       scolltype = rs.getString("scrolltype");
    }

   String imgType="";
   String imgSrc ="";
  // String scolltype="";
   rs.execute("select imgtype,imgsrc from hpFieldLength where eid="+eid+" and usertype=3 order by id desc");
   if(rs.next()){
        imgType = rs.getString("imgtype");
        imgSrc = rs.getString("imgsrc");

   }
   String tabId = Util.null2String(request.getParameter("tabId"));
   
  ConnStatement statement = null;
    try{
        statement=new ConnStatement();
       String sSql="select * from hpsetting_wfcenter where eid="+eid+" and tabId ='"+tabId+"'";
       statement.setStatementSql(sSql) ;    
       statement.executeQuery();     
       if(statement.next()){
            viewType=Util.null2String(statement.getString("viewType"));     
            completeflag=Util.null2String(statement.getString("completeflag"));         
            
            showCopy = Util.null2String(statement.getString("showCopy"));
             
            isExclude=Util.getIntValue(statement.getString("isExclude"),0)==0?false:true;
            
        }       
        statement.close();
    }catch(Exception e){
    }finally {
        statement.close();
    }
    int tabs = 1;
    String tabsql="select count(1) from hpsetting_wfcenter where eid="+eid;
    rs.execute(tabsql);
    if(rs.next()) tabs = rs.getInt(1);
    HashMap map;
    if (HPTypeEnum.HP_WORKFLOW_FORM.getName().equals(pagetype)) {
        map = (HashMap)WorkflowCount.getWorkflowCountByWorkflowForm(Util.getIntValue(request.getParameter("requestid"),-1), Util.getIntValue(hpid), fieldids, fieldvalues, eid, user);
    } else {
        map = (HashMap)WorkflowCount.getWorkflowCount(eid,user);
    }
    String showCount = (String)map.get(tabId);
    int count = Util.getIntValue(showCount.split(",")[0],0);
    if(count>=100) count = 99;
    String flag = Util.null2o(showCount.split(",")[1]);
    
    //\u7edf\u4e00\u5f85\u529e\u5f02\u6784\u7cfb\u7edf\u96c6\u6210\u53c2\u6570
  	int isUse = 0; // 0\u672a\u542f\u7528, 1\u542f\u7528
  	String oaShortName = ""; // \u7cfb\u7edf\u7b80\u79f0
  	String oaFullName = ""; // \u7cfb\u7edf\u5168\u79f0
  	String showSysName = "0"; // 0\u4e0d\u663e\u793a\u7cfb\u7edf\u540d\u79f0, 1\u663e\u793a\u7cfb\u7edf\u7b80\u79f0, 2\u663e\u793a\u7cfb\u7edf\u5168\u79f0
  	int showDone = 0; // 0\u4e0d\u663e\u793a\u5df2\u529e(\u5df2\u529e\u3001\u529e\u7ed3), 1\u663e\u793a\u5df2\u529e(\u5df2\u529e\u3001\u529e\u7ed3)
  	RecordSet ofsSettingRs =  new RecordSet();
  	ofsSettingRs.execute("select IsUse,OAShortName,OAFullName,ShowSysName,ShowDone from ofs_setting");
  	if(ofsSettingRs.next()) {
  		isUse = ofsSettingRs.getInt("IsUse");
  		oaShortName = ofsSettingRs.getString("OAShortName");
  		oaFullName = ofsSettingRs.getString("OAFullName");
  		showSysName = ofsSettingRs.getString("ShowSysName");
  		showDone = ofsSettingRs.getInt("ShowDone");
  	}
  	//\u5b9a\u4e49\u5217\u8868\u662f\u5426\u663e\u793a"\u7cfb\u7edf\u540d\u79f0"\u680f, \u53ea\u6709\u5f85\u529e(1)\u3001\u5df2\u529e(2)\u3001\u529e\u7ed3(3)\u548c\u6211\u7684\u8bf7\u6c42(4)\u624d\u4f1a\u663e\u793a\u7cfb\u7edf\u540d
  	boolean isShowSysname = false;
  	if (1 == isUse) {
  		if (1 == showDone && ("1".equals(viewType) || "2".equals(viewType) || "3".equals(viewType) || "4".equals(viewType)) && ("1".equals(showSysName) || "2".equals(showSysName))) {
  			isShowSysname = true;
  		} else if (("1".equals(viewType) || "4".equals(viewType)) && ("1".equals(showSysName) || "2".equals(showSysName))) {
  	    	isShowSysname = true;
  	 	}
  	}
    
    String extSql = "";
    
    String backFields="";
    String sqlFrom="";
    String sqlWhere="";
    String ofsBackFields="";  // \u7edf\u4e00\u5f85\u529e
	String ofsSqlFrom="";     // \u7edf\u4e00\u5f85\u529e
	String ofsSqlWhere="";    // \u7edf\u4e00\u5f85\u529e
	String ofsSql = "";       // \u7edf\u4e00\u5f85\u529e
    String hasexists = " and exists ";
    String belongtoshow = userSetting.getBelongtoshowByUserId(user.getUID()+"");
    String resourceids =user.getUID()+"";
    if(belongtoshow.equals("1")&&"0".equals(user.getAccount_type())){
        String belongtoids = user.getBelongtoids();
        resourceids=resourceids+","+belongtoids;
    }
    
    //baseBean.writeLog("=============>type="+Util.getIntValue(viewType));
    if(Util.getIntValue(viewType)==1){ //1:\u5f85\u529e\u4e8b\u5b9c
        //backFields="t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark ";
        backFields="0 as sysid, '' as pcurl, t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname,t2.userid, t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark,t2.isprocessed,t2.agentorbyagentid,t2.agenttype ";
        sqlFrom=" from workflow_requestbase t1,workflow_currentoperator t2,workflow_base t3 ";
        if("1".equals(showCopy)){//\u663e\u793a\u6284\u9001\u4e8b\u5b9c
            sqlWhere="where t1.requestid = t2.requestid and (t2.isremark='0' and (takisremark is null or takisremark=0) or  t2.isremark='1' or  t2.isremark='5' or  t2.isremark='8' or  t2.isremark='9' or  t2.isremark='7') and t2.islasttimes=1 " +
                " and t2.userid in ("+resourceids+") and t2.usertype="+(Util.getIntValue(user.getLogintype())-1);
        }else{//\u4e0d\u663e\u793a\u6284\u9001\u4e8b\u5b9c
            sqlWhere="where t1.requestid = t2.requestid and (t2.isremark='0' and (takisremark is null or takisremark=0) or  t2.isremark='1' or  t2.isremark='5' or  t2.isremark='7') and t2.islasttimes=1 " +
                " and t2.userid in ("+resourceids+") and t2.usertype="+(Util.getIntValue(user.getLogintype())-1);
        }
        sqlWhere += " and (t1.deleted=0 or t1.deleted is null) ";
        
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowtype","typeid",isExclude);
        
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowid","flowid",isExclude);
                        
        if(getCount(eid,tabId,"nodeid")>0){
            sqlWhere+= getFreeNodeSql(eid,tabid,"t2.nodeid",isExclude );
        //  if(isExclude) hasexists = " and t2.nodeid not in ";
        //  else hasexists = " and t2.nodeid in ";
    /*      String plusStr = " or ";
            if(isExclude) {
                hasexists = " t2.nodeid not in ";
                plusStr = " and ";
            }
            else hasexists = " t2.nodeid in ";
            sqlWhere+= " and ("+hasexists + " (select content from workflowcentersettingdetail where type='nodeid' and eid="+eid+" and tabid='"+tabid+"') " + plusStr + hasexists + "(select n.id from workflow_nodebase n, workflow_flownode f where n.id=f.nodeid and n.isfreenode='1' and f.workflowid in (select content from workflowcentersettingdetail where type='flowid' and eid="+eid+" and tabid='"+tabid+"') )) ";
*/
        }else{
            sqlWhere+=getExistsSql(eid,tabId,"t2.nodeid","nodeid",isExclude);   
        }
        //\u5224\u65ad\u6d41\u7a0b\u662f\u5426\u6709\u6548
        //sqlWhere +=" and t2.workflowid in (select id from workflow_base where (isvalid='1' or isvalid='3') )";
        sqlWhere +=" and t3.id=t2.workflowid and (t3.isvalid='1' or t3.isvalid='3') ";

        //\u534f\u540c\u6a21\u5757\u6dfb\u52a0\u53c2\u6570
        if(Util.getIntValue(hpid) < 0 )
        {
            if (HPTypeEnum.HP_WORKFLOW_FORM.getName().equals(pagetype)) {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
                String appendparam=sowf.getWFRelationitemsByWorkflowForm(eid,"",requestid,Util.getIntValue(hpid),user,sqlWhere,fieldids,fieldvalues);
                sqlWhere += appendparam;
            } else {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                baseBean.writeLog("syparaSqlwhere==>"+syparaSqlwhere);
                sqlWhere += syparaSqlwhere;
               //\u6dfb\u52a0\u76f8\u5173\u6d41\u7a0b\u53cd\u5411\u89c4\u5219\u8bbe\u7f6e
                String appendparam=sowf.getWFRelationitems(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += appendparam;
            }
        }
        
		//\u7edf\u4e00\u5f85\u529e\u5f02\u6784\u7cfb\u7edf\u6d41\u7a0b\u6570\u636e
		if (1 == isUse) {
			ofsBackFields = " sysid, pcurl, requestid, creatorid as creater, 0 as creatertype, workflowid, requestname, " +
			" userid, receivedate, receivetime, viewtype, '' as isreminded, sysid as workflowtype, 0 as nodeid  , 0 as requestlevel, isremark, " +
			" '' as isprocessed, 0 as agentorbyagentid, '' as agenttype ";
			ofsSqlFrom = " from Ofs_todo_data";
			ofsSqlWhere = " where 1=1 " + RequestUtil.getSqlWhere("0", ""+user.getUID(), "");
			ofsSqlWhere += getExistsSql(eid,tabId,"sysid","typeid",isExclude);
			ofsSqlWhere += getExistsSql(eid,tabId,"workflowid","flowid",isExclude);
			
			ofsSql = "select distinct " + ofsBackFields + ofsSqlFrom + ofsSqlWhere;
		}
    } else if (Util.getIntValue(viewType)==2){//2:\u5df2\u529e\u4e8b\u5b9c
        //backFields="t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark ";
        backFields="0 as sysid, '' as pcurl, t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.userid,t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark,t2.isprocessed,t2.agentorbyagentid,t2.agenttype "
            + " , (case  WHEN t2.operatedate IS NULL  THEN t2.receivedate ELSE t2.operatedate END) operatedate "
            + " , (case  WHEN t2.operatetime IS NULL  THEN t2.receivetime ELSE t2.operatetime END) operatetime ";
        sqlFrom=" from workflow_requestbase t1,workflow_currentoperator t2,workflow_base t3  ";
    
        sqlWhere="where t1.requestid = t2.requestid and (t2.isremark=2 or (t2.isremark='0' and takisremark=-2)) and  t2.iscomplete=0  and t2.islasttimes=1 " +
                " and t2.userid in ("+resourceids+") and t2.usertype="+(Util.getIntValue(user.getLogintype())-1);
        /*if (isExclude==1){
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype not in("+wftypeSetting+")";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid not in("+wflowSetting+")";
            if(!"".equals(wfNodeSetting)) sqlWhere+=" and t1.currentnodeid not in("+wfNodeSetting+") and EXISTS(select 1 from workflow_nownode where nownodeid not in("+wfNodeSetting+") and requestid=t1.requestid)";
        } else {
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype in("+wftypeSetting+")";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid in("+wflowSetting+")";
            if(!"".equals(wfNodeSetting)) sqlWhere+=" and (t1.currentnodeid in("+wfNodeSetting+") or EXISTS(select 1 from workflow_nownode where nownodeid in("+wfNodeSetting+") and requestid=t1.requestid) or t1.currentnodeid in (select n.id from workflow_nodebase n, workflow_flownode f where n.id=f.nodeid and n.isfreenode='1' "+extSql+" ))";
        }*/
        sqlWhere += " and (t1.deleted=0 or t1.deleted is null) ";
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowtype","typeid",isExclude);
        
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowid","flowid",isExclude);
        
        if(getCount(eid,tabId,"nodeid")>0){
            sqlWhere+= getFreeNodeSql(eid,tabid,"t1.currentnodeid",isExclude );
    //      if(isExclude) hasexists = " and t1.currentnodeid not in ";
    //      else hasexists = " and t1.currentnodeid in ";
    //      sqlWhere+= hasexists + " (select content from workflowcentersettingdetail where type='nodeid' and eid="+eid+" and tabid='"+tabid+"' or t2.nodeid in (select n.id from workflow_nodebase n, workflow_flownode f where n.id=f.nodeid and n.isfreenode='1' and f.workflowid in (select content from workflowcentersettingdetail where type='flowid' and eid="+eid+" and tabid='"+tabid+"') )) ";
        }else{  
            sqlWhere+=getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude);
        }
        
        sqlWhere += WorkflowComInfo.getDateDuringSql(WorkflowComInfo.getDateDuringForFirst());
        //\u5224\u65ad\u6d41\u7a0b\u662f\u5426\u6709\u6548
        //sqlWhere +=" and t2.workflowid in (select id from workflow_base where (isvalid='1' or isvalid='3') )";
        sqlWhere +=" and t3.id=t2.workflowid and (t3.isvalid='1' or t3.isvalid='3') ";

        //\u534f\u540c\u6a21\u5757\u6dfb\u52a0\u53c2\u6570
        if(Util.getIntValue(hpid) < 0 )
        {
            if (HPTypeEnum.HP_WORKFLOW_FORM.getName().equals(pagetype)) {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
                String appendparam=sowf.getWFRelationitemsByWorkflowForm(eid,"",requestid,Util.getIntValue(hpid),user,sqlWhere,fieldids,fieldvalues);
                sqlWhere += appendparam;
            } else {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                    String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
               //\u6dfb\u52a0\u76f8\u5173\u6d41\u7a0b\u53cd\u5411\u89c4\u5219\u8bbe\u7f6e
                String appendparam=sowf.getWFRelationitems(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += appendparam;
            }
        }

		//\u7edf\u4e00\u5f85\u529e\u5f02\u6784\u7cfb\u7edf\u6d41\u7a0b\u6570\u636e
		if (1 == isUse && 1 == showDone) {
			ofsBackFields = " sysid, pcurl, requestid, creatorid as creater, 0 as creatertype, workflowid, requestname, " +
			" userid, receivedate, receivetime, viewtype, '' as isreminded, sysid as workflowtype, 0 as nodeid  , 0 as requestlevel, isremark, " +
			" '' as isprocessed, 0 as agentorbyagentid, '' as agenttype, operatedate, operatetime ";
			ofsSqlFrom = " from Ofs_todo_data";
			ofsSqlWhere = " where 1=1 " + RequestUtil.getSqlWhere("1", ""+user.getUID(), "");
			ofsSqlWhere += getExistsSql(eid,tabId,"sysid","typeid",isExclude);
			ofsSqlWhere += getExistsSql(eid,tabId,"workflowid","flowid",isExclude);
			
			ofsSql = "select distinct " + ofsBackFields + ofsSqlFrom + ofsSqlWhere;
		}
    } else if (Util.getIntValue(viewType)==3){// 3:\u529e\u7ed3\u4e8b\u5b9c
        backFields="0 as sysid, '' as pcurl, t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.userid,t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark,t2.isprocessed,t2.agentorbyagentid,t2.agenttype "
            + " , (case  WHEN t2.operatedate IS NULL  THEN t2.receivedate ELSE t2.operatedate END) operatedate "
            + " , (case  WHEN t2.operatetime IS NULL  THEN t2.receivetime ELSE t2.operatetime END) operatetime ";
        //backFields="t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark ";
        sqlFrom=" from workflow_requestbase t1,workflow_currentoperator t2,workflow_base t3  ";
    
        sqlWhere="where t1.requestid = t2.requestid and (t2.isremark in('2','4') or (t2.isremark='0' and takisremark=-2)) and iscomplete=1 and t1.currentnodetype = '3'  and t2.islasttimes=1 " +
                " and t2.userid in ("+resourceids+") and t2.usertype="+(Util.getIntValue(user.getLogintype())-1);
        
        /*if (isExclude==1){
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype not in("+wftypeSetting+")";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid not in("+wflowSetting+")";
        } else {
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype in("+wftypeSetting+")";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid in("+wflowSetting+")";
        }*/
        sqlWhere += " and (t1.deleted=0 or t1.deleted is null) ";
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowtype","typeid",isExclude);
        
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowid","flowid",isExclude);
        
        //sqlWhere+=getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude);
        
        
        sqlWhere += WorkflowComInfo.getDateDuringSql(WorkflowComInfo.getDateDuringForFirst());
        //\u5224\u65ad\u6d41\u7a0b\u662f\u5426\u6709\u6548
        //sqlWhere +=" and t2.workflowid in (select id from workflow_base where (isvalid='1' or isvalid='3') )";
        sqlWhere +=" and t3.id=t2.workflowid and (t3.isvalid='1' or t3.isvalid='3') ";

        //\u534f\u540c\u6a21\u5757\u6dfb\u52a0\u53c2\u6570
        if(Util.getIntValue(hpid) < 0 )
        {
            if (HPTypeEnum.HP_WORKFLOW_FORM.getName().equals(pagetype)) {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
                String appendparam=sowf.getWFRelationitemsByWorkflowForm(eid,"",requestid,Util.getIntValue(hpid),user,sqlWhere,fieldids,fieldvalues);
                sqlWhere += appendparam;
            } else {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                    String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
               //\u6dfb\u52a0\u76f8\u5173\u6d41\u7a0b\u53cd\u5411\u89c4\u5219\u8bbe\u7f6e
                String appendparam=sowf.getWFRelationitems(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += appendparam;
            }
        }
        
		//\u7edf\u4e00\u5f85\u529e\u5f02\u6784\u7cfb\u7edf\u6d41\u7a0b\u6570\u636e
		if (1 == isUse && 1 == showDone) {
			ofsBackFields = " sysid, pcurl, requestid, creatorid as creater, 0 as creatertype, workflowid, requestname, " +
			" userid, receivedate, receivetime, viewtype, '' as isreminded, sysid as workflowtype, 0 as nodeid  , 0 as requestlevel, isremark, " +
			" '' as isprocessed, 0 as agentorbyagentid, '' as agenttype, operatedate, operatetime ";
			ofsSqlFrom = " from Ofs_todo_data";
			ofsSqlWhere = " where 1=1 " + RequestUtil.getSqlWhere("2", ""+user.getUID(), "");
			ofsSqlWhere += getExistsSql(eid,tabId,"sysid","typeid",isExclude);
			ofsSqlWhere += getExistsSql(eid,tabId,"workflowid","flowid",isExclude);
			
			ofsSql = "select distinct " + ofsBackFields + ofsSqlFrom + ofsSqlWhere;
		}
    } else if (Util.getIntValue(viewType)==4){//4:\u6211\u7684\u8bf7\u6c42
        
        //backFields="t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark ";
        backFields="0 as sysid, '' as pcurl, t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.userid,t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark,t2.isprocessed,t2.agentorbyagentid,t2.agenttype, t1.createdate, t1.createtime ";
        sqlFrom=" from workflow_requestbase t1,workflow_currentoperator t2,workflow_base t3  ";
    
        sqlWhere="where t1.requestid = t2.requestid and t1.creater=t2.userid and t1.creater in ( "+resourceids+") and t1.creatertype = "+(Util.getIntValue(user.getLogintype())-1)+" and t2.islasttimes=1 " ;
                //" and t2.userid in ("+resourceids+") and t2.usertype="+(Util.getIntValue(user.getLogintype())-1);
        /*if (isExclude==1){
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype not in("+wftypeSetting+")";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid not in("+wflowSetting+")";
            if(!"".equals(wfNodeSetting)) sqlWhere+=" and t1.currentnodeid not in("+wfNodeSetting+") and t1.requestid in(select requestid from workflow_nownode where nownodeid not in("+wfNodeSetting+"))";
        } else {
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype in("+wftypeSetting+")";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid in("+wflowSetting+")";
            if(!"".equals(wfNodeSetting)) sqlWhere+=" and (t1.currentnodeid in("+wfNodeSetting+") or t1.requestid in(select requestid from workflow_nownode where nownodeid in("+wfNodeSetting+")) or t1.currentnodeid in (select n.id from workflow_nodebase n, workflow_flownode f where n.id=f.nodeid and n.isfreenode='1' "+extSql+" ))";
        }*/
        sqlWhere += " and (t1.deleted=0 or t1.deleted is null) ";
        
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowtype","typeid",isExclude);
        
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowid","flowid",isExclude);
        
        if(isExclude){
            if(!getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude).equals("")){
                sqlWhere +=getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude)+" and t1.requestid in(select requestid from workflow_nownode where "+getExistsSql(eid,tabId," nownodeid","nodeid",isExclude,"")+" and requestid=t1.requestid)";
            }
        }else{
            if(!getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude).equals("")){
                sqlWhere +="and ("+getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude,"")+" or t1.requestid in(select requestid from workflow_nownode where "+getExistsSql(eid,tabId," nownodeid","nodeid",isExclude,"")+" ) or t1.currentnodeid in (select n.id from workflow_nodebase n, workflow_flownode f where n.id=f.nodeid and n.isfreenode='1' "+extSql+" ))";
            }
        }
                            
        if(completeflag.equals("1")){
            sqlWhere += " and t1.currentnodetype <> '3' ";
        }else if(completeflag.equals("2")){
            sqlWhere += " and t1.currentnodetype = '3' ";
        }
        sqlWhere += WorkflowComInfo.getDateDuringSql(WorkflowComInfo.getDateDuringForFirst());
        //\u5224\u65ad\u6d41\u7a0b\u662f\u5426\u6709\u6548
        //sqlWhere +=" and t2.workflowid in (select id from workflow_base where (isvalid='1' or isvalid='3') )";
        sqlWhere +=" and t3.id=t2.workflowid and (t3.isvalid='1' or t3.isvalid='3') ";

        //add by wshen \u5224\u65ad\u6d41\u7a0b\u975e\u64a4\u6d88
//      sqlWhere +=" and (t1.currentstatus<>1 or t1.currentstatus is null)and (t1.status<>'\u64a4\u9500' or t1.status is null or t1.status='' ) ";
        
        //\u534f\u540c\u6a21\u5757\u6dfb\u52a0\u53c2\u6570
        if(Util.getIntValue(hpid) < 0 )
        {
            if (HPTypeEnum.HP_WORKFLOW_FORM.getName().equals(pagetype)) {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
                String appendparam=sowf.getWFRelationitemsByWorkflowForm(eid,"",requestid,Util.getIntValue(hpid),user,sqlWhere,fieldids,fieldvalues);
                sqlWhere += appendparam;
            } else {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
               //\u6dfb\u52a0\u76f8\u5173\u6d41\u7a0b\u53cd\u5411\u89c4\u5219\u8bbe\u7f6e
                String appendparam=sowf.getWFRelationitems(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += appendparam;
            }
        }
        
		//\u7edf\u4e00\u5f85\u529e\u5f02\u6784\u7cfb\u7edf\u6d41\u7a0b\u6570\u636e
		if (1 == isUse) {
			ofsBackFields = " sysid, pcurl, requestid, creatorid as creater, 0 as creatertype, workflowid, requestname,  " +
			" userid, receivedate, receivetime, viewtype , '' as isreminded, sysid as workflowtype, 0 as nodeid  , 0 as requestlevel, isremark, " +
			" '' as isprocessed, 0 as agentorbyagentid, '' as agenttype,  createdate,  createtime";
			ofsSqlFrom = " from Ofs_todo_data";
			String ofsSw = "";
			if(completeflag.equals("1")){
				ofsSw += " and iscomplete=0 ";
			}else if(completeflag.equals("2")){
				ofsSw += " and iscomplete=1 ";
			}
			ofsSqlWhere = " where 1=1 " + RequestUtil.getSqlWhere("3", ""+user.getUID(), ofsSw);
			ofsSqlWhere += getExistsSql(eid,tabId,"sysid","typeid",isExclude);
			ofsSqlWhere += getExistsSql(eid,tabId,"workflowid","flowid",isExclude);
			
			ofsSql = "select distinct " + ofsBackFields + ofsSqlFrom + ofsSqlWhere;
		}
    }else if (Util.getIntValue(viewType)==5){//5:\u6284\u9001\u4e8b\u5b9c
        //backFields="t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark ";
        backFields="0 as sysid, '' as pcurl, t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname,t2.userid , t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark,t2.isprocessed,t2.agentorbyagentid,t2.agenttype ";
        sqlFrom=" from workflow_requestbase t1,workflow_currentoperator t2,workflow_base t3  ";
    
        sqlWhere="where t1.requestid = t2.requestid and ( t2.isremark='8' or  t2.isremark='9' or  t2.isremark='7') and t2.islasttimes=1 " +
                " and t2.userid in ("+resourceids+") and t2.usertype="+(Util.getIntValue(user.getLogintype())-1);

        /*if (isExclude==1){
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype not in("+wftypeSetting+")";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid not in("+wflowSetting+")";
        } else {
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype in("+wftypeSetting+")";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid in("+wflowSetting+")";
        }*/
        sqlWhere += " and (t1.deleted=0 or t1.deleted is null) ";
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowtype","typeid",isExclude);
        
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowid","flowid",isExclude);
        //\u5224\u65ad\u6d41\u7a0b\u662f\u5426\u6709\u6548
        //sqlWhere +=" and t2.workflowid in (select id from workflow_base where (isvalid='1' or isvalid='3') )";
        sqlWhere +=" and t3.id=t2.workflowid and (t3.isvalid='1' or t3.isvalid='3') ";

        //sqlWhere+=getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude);
        
        //\u534f\u540c\u6a21\u5757\u6dfb\u52a0\u53c2\u6570
        if(Util.getIntValue(hpid) < 0 )
        {
            if (HPTypeEnum.HP_WORKFLOW_FORM.getName().equals(pagetype)) {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
                String appendparam=sowf.getWFRelationitemsByWorkflowForm(eid,"",requestid,Util.getIntValue(hpid),user,sqlWhere,fieldids,fieldvalues);
                sqlWhere += appendparam;
            } else {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
               //\u6dfb\u52a0\u76f8\u5173\u6d41\u7a0b\u53cd\u5411\u89c4\u5219\u8bbe\u7f6e
                String appendparam=sowf.getWFRelationitems(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += appendparam;
            }
        }
    }else if (Util.getIntValue(viewType)==6){//6:\u7763\u529e\u4e8b\u5b9c 

        //ArrayList  flowList= getContentList(eid,tabId,"flowid");  
        ArrayList  flowList= getContentList(eid,tabId,"flowid");	
        int logintype = Util.getIntValue(user.getLogintype());
        int userID = user.getUID();
        
        WFUrgerManager.setLogintype(logintype);
        WFUrgerManager.setUserid(userID);

		String _workflowIDs = "";
	    int countme = 0;
        if(flowList.size()>0) {
            for(int k=0;k<flowList.size();k++){
                String tempworkflowid = (String)flowList.get(k);
                if(tempworkflowid!= null && tempworkflowid.length() > 0){
                    if(countme > 0) _workflowIDs += ",";
                    _workflowIDs += tempworkflowid;
                    countme++;
                }
            }
        }
        WFUrgerManager.setWorkflowIDs(_workflowIDs);

        //\u6027\u80fd\u4f18\u5316
        //ArrayList wftypes=WFUrgerManager.getWrokflowTree();
        String requestidGetSql = WFUrgerManager.getWfShareSqlWhere();
        

//      List requestlist = new ArrayList();
//      
//        StringBuffer requestidsb = new StringBuffer();
//        
//        StringBuffer requestidsql = new StringBuffer(" 1=2 ");
//        
//        
//      for(int i=0;i<wftypes.size();i++){
//          WFWorkflowTypes wftype=(WFWorkflowTypes)wftypes.get(i);
//          ArrayList workflows=wftype.getWorkflows();
//          
//          for (int j=0;j<workflows.size();j++){
//              WFWorkflows wfworkflow=(WFWorkflows)workflows.get(j);
//                String tempWorkflow=wfworkflow.getWorkflowid()+"";
//                if(flowList.size()==0||flowList.contains(tempWorkflow)) {
//                    ArrayList requests=wfworkflow.getReqeustids();
//                    requestlist.addAll(requests);
//                    /*
//                    for(int k=0;k<requests.size();k++){
//                        if(requestids.equals("")){
//                            requestids=(String)requests.get(k);
//                        }else{
//                            requestids+=","+requests.get(k);
//                        }
//                    }
//                    */
//                }
//          }
//      }
        
        //backFields="t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname,max(t2.receivedate) as receivedate,t1.receivetime,t1.requestlevel ";
        if (rs.getDBType().equals("oracle")) {
            backFields="0 as sysid, '' as pcurl, t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname,t1.createdate || t1.createtime  as receivedate,t1.requestlevel ";
            //sqlFrom = " from (select workflowtype,nodeid,workflowid,requestid,max(receivedate||' '||receivetime) as receivedate,'' as receivetime from workflow_currentoperator group by requestid,workflowid,nodeid,workflowtype) t2,workflow_requestbase t1 ";
        } else {
            backFields="0 as sysid, '' as pcurl, t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname,t1.createdate + t1.createtime as receivedate,t1.requestlevel ";
            //sqlFrom = " from (select workflowtype,nodeid,workflowid,requestid,max(receivedate+' '+receivetime) as receivedate,'' as receivetime from workflow_currentoperator group by requestid,workflowtype,nodeid,workflowid) t2,workflow_requestbase t1 ";
        }
        sqlFrom = " from workflow_requestbase t1,(" + requestidGetSql +  ") temp,workflow_base t3  ";
    
        sqlWhere="where temp.requestid=t1.requestid ";
        sqlWhere += " and (t1.currentnodetype is null or t1.currentnodetype <>3) ";
        sqlWhere += " and (t1.deleted=0 or t1.deleted is null) ";
        sqlWhere += " and exists (select 1 from workFlow_CurrentOperator where t1.workflowid=workflow_currentoperator.workflowid and t1.requestid=workflow_currentoperator.requestid) and NOT EXISTS (select 1 from workFlow_CurrentOperator t where t.isremark in('0','1','5','8','9','7') and t.userid=" + userID + " and t.usertype=" + (logintype - 1) + " and t.requestid=t1.requestid)";
        /*for(int i = 0;i<requestlist.size();i++)
        {
            if(requestlist.size()>100)
            {
                if((i%100==0)&&i>0)
                {
                    requestidsql.append(" or t1.requestid in(-1").append(requestidsb.toString()).append(") ");
                    requestidsb = new StringBuffer();
                }
            }
            requestidsb.append(",").append((String)requestlist.get(i));
        }
        if(!requestidsb.toString().equals(""))
        {
            requestidsql.append(" or t1.requestid in(-1").append(requestidsb.toString()).append(") ");
        }
        sqlWhere+=" and ("+requestidsql.toString()+")";
        */
        //\u5224\u65ad\u6d41\u7a0b\u662f\u5426\u6709\u6548
        //sqlWhere +=" and t1.workflowid in (select id from workflow_base where (isvalid='1' or isvalid='3') )";
        sqlWhere +=" and t3.id=t1.workflowid and (t3.isvalid='1' or t3.isvalid='3') ";

        //\u534f\u540c\u6a21\u5757\u6dfb\u52a0\u53c2\u6570
        if(Util.getIntValue(hpid) < 0 )
        {
            if (HPTypeEnum.HP_WORKFLOW_FORM.getName().equals(pagetype)) {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
                String appendparam=sowf.getWFRelationitemsByWorkflowForm(eid,"",requestid,Util.getIntValue(hpid),user,sqlWhere,fieldids,fieldvalues);
                sqlWhere += appendparam;
            } else {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
               //\u6dfb\u52a0\u76f8\u5173\u6d41\u7a0b\u53cd\u5411\u89c4\u5219\u8bbe\u7f6e
                String appendparam=sowf.getWFRelationitems(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += appendparam;
            }
        }

        //sqlWhere += " group by t1.requestid,t1.creater,t1.creatertype, t1.workflowid, t1.requestname,t2.receivetime,t1.requestlevel ";
    }else if (Util.getIntValue(viewType)==7){//7:\u8d85\u65f6\u4e8b\u5b9c
        //backFields="t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark ";
        backFields="0 as sysid, '' as pcurl, t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark,t2.isprocessed,t2.agentorbyagentid,t2.agenttype ";
        sqlFrom=" from workflow_requestbase t1,workflow_currentoperator t2,workflow_base t3  ";
    
        sqlWhere="where t1.requestid = t2.requestid and t2.userid in ("+resourceids+") and t2.usertype="+(Util.getIntValue(user.getLogintype())-1)+" and  ((t2.isremark='0' and (t2.isprocessed='2' or t2.isprocessed='3'))  or t2.isremark='5') "+
                " and t1.currentnodetype <> 3";
        sqlWhere += " and (t1.deleted=0 or t1.deleted is null) ";
        /*if (isExclude==1){
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype not in("+wftypeSetting+") ";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid not in("+wflowSetting+")";
            if(!"".equals(wfNodeSetting)) sqlWhere+=" and (t2.nodeid not in("+wfNodeSetting+"))";
        }else{
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype in("+wftypeSetting+") ";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid in("+wflowSetting+")";
            if(!"".equals(wfNodeSetting)) sqlWhere+=" and (t2.nodeid in("+wfNodeSetting+") or t2.nodeid in (select n.id from workflow_nodebase n, workflow_flownode f where n.id=f.nodeid and n.isfreenode='1' "+extSql+" ))";
        }*/
        
        
        
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowtype","typeid",isExclude);
        
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowid","flowid",isExclude);
        
        if(isExclude){
            if(!getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude).equals("")){
                sqlWhere +=getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude);
            }
        }else{
            if(!getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude).equals("")){
                sqlWhere +="and ("+getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude,"")+" or t2.nodeid in (select n.id from workflow_nodebase n, workflow_flownode f where n.id=f.nodeid and n.isfreenode='1' "+extSql+" ))";
            }
        }   
        
        //\u5224\u65ad\u6d41\u7a0b\u662f\u5426\u6709\u6548
        //sqlWhere +=" and t2.workflowid in (select id from workflow_base where (isvalid='1' or isvalid='3') )";
        sqlWhere +=" and t3.id=t2.workflowid and (t3.isvalid='1' or t3.isvalid='3') ";

        //\u534f\u540c\u6a21\u5757\u6dfb\u52a0\u53c2\u6570
        if(Util.getIntValue(hpid) < 0 )
        {
            if (HPTypeEnum.HP_WORKFLOW_FORM.getName().equals(pagetype)) {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
                String appendparam=sowf.getWFRelationitemsByWorkflowForm(eid,"",requestid,Util.getIntValue(hpid),user,sqlWhere,fieldids,fieldvalues);
                sqlWhere += appendparam;
            } else {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
               //\u6dfb\u52a0\u76f8\u5173\u6d41\u7a0b\u53cd\u5411\u89c4\u5219\u8bbe\u7f6e
                String appendparam=sowf.getWFRelationitems(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += appendparam;
            }
        }
        
    }else if (Util.getIntValue(viewType)==8){//8:\u53cd\u9988\u4e8b\u5b9c

        //backFields="t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark ";
        backFields="0 as sysid, '' as pcurl, t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname,t2.userid, t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark,t2.isprocessed,t2.agentorbyagentid,t2.agenttype ";
        //sqlFrom=" from workflow_requestbase t1, ( select  receivedate,receivetime,requestid,viewtype,isreminded,nodeid,isremark,workflowtype,workflowid from workflow_currentoperator where "+
        //          " id in( select max(id) from workflow_currentoperator where needwfback=1 and viewtype=-1 and isremark in('2','4') and userid ="+user.getUID()+" and usertype="+(Util.getIntValue(user.getLogintype())-1)+"  group by requestid) "+
        //          ") t2 ";

        sqlFrom=" from workflow_requestbase t1, ( select  receivedate,receivetime,requestid,viewtype,isreminded,nodeid,isremark,workflowtype,workflowid,isprocessed,userid,agentorbyagentid,agenttype from workflow_currentoperator where "+
                    " id in( select max(id) from workflow_currentoperator where needwfback=1 and viewtype=-1 and isremark in('2','4') and userid in ("+resourceids+") and usertype="+(Util.getIntValue(user.getLogintype())-1)+"  group by requestid) "+
                    ") t2,workflow_base t3  ";
        sqlWhere=" where t1.requestid = t2.requestid ";
        sqlWhere += " and (t1.deleted=0 or t1.deleted is null) ";
        /*if (isExclude==1){
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype not in("+wftypeSetting+") ";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid  not in("+wflowSetting+")";
            if(!"".equals(wfNodeSetting)) sqlWhere+=" and ( t2.nodeid not in("+wfNodeSetting+"))";
        }else{
            if(!"".equals(wftypeSetting)) sqlWhere+=" and t2.workflowtype in("+wftypeSetting+") ";
            if(!"".equals(wflowSetting)) sqlWhere+=" and t2.workflowid in("+wflowSetting+")";
            if(!"".equals(wfNodeSetting)) sqlWhere+=" and ( t2.nodeid in("+wfNodeSetting+")  or t2.nodeid in (select n.id from workflow_nodebase n, workflow_flownode f where n.id=f.nodeid and n.isfreenode='1' "+extSql+" ) )";
        }*/
        
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowtype","typeid",isExclude);
        
        sqlWhere+=getExistsSql(eid,tabId,"t2.workflowid","flowid",isExclude);
        
        if(isExclude){
            if(!getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude).equals("")){
                sqlWhere +=getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude);
            }
        }else{
            if(!getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude).equals("")){
                sqlWhere +="and ("+getExistsSql(eid,tabId," t1.currentnodeid","nodeid",isExclude,"")+" or t2.nodeid in (select n.id from workflow_nodebase n, workflow_flownode f where n.id=f.nodeid and n.isfreenode='1' "+extSql+" ))";
            }
        }
        
        sqlWhere += WorkflowComInfo.getDateDuringSql(WorkflowComInfo.getDateDuringForFirst());
        //\u5224\u65ad\u6d41\u7a0b\u662f\u5426\u6709\u6548
        //sqlWhere +=" and t2.workflowid in (select id from workflow_base where (isvalid='1' or isvalid='3') )";
        sqlWhere +=" and t3.id=t2.workflowid and (t3.isvalid='1' or t3.isvalid='3') ";

        //\u534f\u540c\u6a21\u5757\u6dfb\u52a0\u53c2\u6570
        if(Util.getIntValue(hpid) < 0 )
        {
            if (HPTypeEnum.HP_WORKFLOW_FORM.getName().equals(pagetype)) {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
                String appendparam=sowf.getWFRelationitemsByWorkflowForm(eid,"",requestid,Util.getIntValue(hpid),user,sqlWhere,fieldids,fieldvalues);
                sqlWhere += appendparam;
            } else {
                int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += syparaSqlwhere;
               //\u6dfb\u52a0\u76f8\u5173\u6d41\u7a0b\u53cd\u5411\u89c4\u5219\u8bbe\u7f6e
                String appendparam=sowf.getWFRelationitems(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                sqlWhere += appendparam;
            }
        }

    //\u6240\u6709\u6d41\u7a0b\uff08\u7528\u6237\u53c2\u4e0e\u8fc7\u7684\u6240\u6709\u6d41\u7a0b\uff09
    }else if (Util.getIntValue(viewType)==10){
        
            backFields="0 as sysid, '' as pcurl, t1.requestid, t1.creater,t1.creatertype, t1.workflowid, t1.requestname, t2.userid,t2.receivedate,t2.receivetime,t2.viewtype,t2.isreminded,t2.workflowtype,t2.nodeid,t1.requestlevel,t2.isremark,t2.isprocessed,t2.agentorbyagentid,t2.agenttype ";
            sqlFrom=" from workflow_requestbase t1,workflow_currentoperator t2,workflow_base t3  ";
            
            //\u83b7\u53d6\u6d41\u7a0b\u5171\u4eab\u4fe1\u606f
            String currentid = "";
            currentid = wfShareAuthorization.getCurrentoperatorIDByUser(user);
            if(!"".equals(currentid)){
                sqlWhere = "where t1.requestid = t2.requestid  and t2.islasttimes=1 ";
                sqlWhere += "and  ((t2.userid in ("+resourceids+") and t2.usertype="+(Util.getIntValue(user.getLogintype())-1);
            }else{
                sqlWhere="where t1.requestid = t2.requestid  and t2.islasttimes=1 and  t2.userid in ("+resourceids+") and t2.usertype="+(Util.getIntValue(user.getLogintype())-1);
            }
            //\u662f\u5426\u6709\u5171\u4eab\u7684\u6d41\u7a0b
            if(!"".equals(currentid)){
                sqlWhere += " ) or ("+Util.getSubINClause(currentid, "t2.id", "in")+" )) ";
            }
            
            //\u8be5\u7528\u6237\u53c2\u4e0e\u8fc7
            //sqlWhere="where t1.requestid = t2.requestid  and t2.islasttimes=1 and  t2.userid in ("+resourceids+") and t2.usertype="+(Util.getIntValue(user.getLogintype())-1);
            //\u6d41\u7a0b\u672a\u88ab\u5220\u9664
            sqlWhere += " and (t1.deleted=0 or t1.deleted is null) ";
            
            sqlWhere+=getExistsSql(eid,tabId,"t2.workflowtype","typeid",isExclude);
            
            sqlWhere+=getExistsSql(eid,tabId,"t2.workflowid","flowid",isExclude);
            
            sqlWhere+=getExistsSql(eid,tabId,"t2.nodeid","nodeid",isExclude);               
            //\u5224\u65ad\u6d41\u7a0b\u662f\u5426\u6709\u6548
            //sqlWhere +=" and t2.workflowid in (select id from workflow_base where (isvalid='1' or isvalid='3') )";
        sqlWhere +=" and t3.id=t2.workflowid and (t3.isvalid='1' or t3.isvalid='3') ";

            //\u534f\u540c\u6a21\u5757\u6dfb\u52a0\u53c2\u6570
            if(Util.getIntValue(hpid) < 0 )
            {
                if (HPTypeEnum.HP_WORKFLOW_FORM.getName().equals(pagetype)) {
                    int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                    String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                    sqlWhere += syparaSqlwhere;
                    String appendparam=sowf.getWFRelationitemsByWorkflowForm(eid,"",requestid,Util.getIntValue(hpid),user,sqlWhere,fieldids,fieldvalues);
                    sqlWhere += appendparam;
                } else {
                    int requestid = Util.getIntValue(request.getParameter("requestid"),-1);
                    String syparaSqlwhere = sowf.getWFAndSql4Base(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                    sqlWhere += syparaSqlwhere;
                   //\u6dfb\u52a0\u76f8\u5173\u6d41\u7a0b\u53cd\u5411\u89c4\u5219\u8bbe\u7f6e
                    String appendparam=sowf.getWFRelationitems(eid,requestid,Util.getIntValue(hpid),user,sqlWhere);
                    sqlWhere += appendparam;
                }
            }
            
    }
    sqlWhere +="  and (t1.currentstatus<>1 or t1.currentstatus is null)";//\u6240\u6709\u6d41\u7a0b\u90fd\u6392\u9664\u64a4\u9500\u6d41\u7a0b\uff1f
    //baseBean.writeLog(sqlFrom+sqlWhere);
    
    //out.println("viewType:"+viewType);
    //out.println("backFields:"+backFields);
    
    
    /*
    sppb.setBackFields(backFields);
    sppb.setPrimaryKey("t1.requestid");
    sppb.setDistinct(true);
    //sppb.setIsPrintExecuteSql(true);
    sppb.setSqlFrom(sqlFrom);
    sppb.setSqlWhere(sqlWhere); 
    if (Util.getIntValue(viewType)==6) {
        //sppb.setSqlOrderBy("receivedate ,t2.receivetime");
        sppb.setSqlOrderBy("receivedate");
        sppb.setDistinct(false);
    }else {
        int ivt = Util.getIntValue(viewType);
      //--------------------------------------------
      // \u5df2\u529e\u3001\u529e\u7ed3\u6309\u7167\u5904\u7406\u65f6\u95f4\u6392\u5e8f
      // \u6211\u7684\u8bf7\u6c42\u6309\u7167\u521b\u5efa\u65f6\u95f4\u6392\u5e8f
      // \u5176\u4ed6\u6309\u7167\u63a5\u53d7\u65f6\u95f4\u6392\u5e8f
      //--------------------------------------------
        if (ivt == 2 || ivt == 3) {
            sppb.setSqlOrderBy(" operatedate , operatetime");
        } else if (ivt == 4) {
            sppb.setSqlOrderBy("t1.createdate, t1.createtime");
        } else {
            sppb.setSqlOrderBy("t2.receivedate ,t2.receivetime");
        }
    }
    sppb.setSortWay(sppb.DESC);
    
    spu.setRecordCount(perpage);
    spu.setSpp(sppb);
	*/
    
    String imgSymbol="";
    if (!"".equals(esc.getIconEsymbol(hpec.getStyleid(eid)))) imgSymbol="<img name='esymbol' src='"+esc.getIconEsymbol(hpec.getStyleid(eid))+"'>";
    
    
    String  strStyle="";
    if("1".equals(isFixationRowHeight)) strStyle+="height:"+(perpage*23)+"px;";
    if(!"".equals(background)) strStyle+="background:url('/weaver/weaver.file.FileDownload?fileid="+background+"');";
        int rowcount=0;
                
        //rs=spu.getCurrentPageRs(1,perpage);
        String querySql = getQuerySql(eid, tabId, backFields, sqlFrom, sqlWhere, perpage, viewType, ofsSql);
        //baseBean.writeLog("querySql:"+querySql);
        rs.execute(querySql);
        int height = rs.getCounts()*23;
        int tabsize = Util.getIntValue(request.getParameter("tabsize"),1);
        int eHeight=Util.getIntValue(hpec.getHeight(eid),0);

        if(eHeight>0&&height<eHeight){
            if(tabsize>1){
                height = eHeight-32;
            }else{
                height = eHeight;
            }
        }
    //baseBean.writeLog(strStyle);

      out.write(_jsp_string4, 0, _jsp_string4.length);
      
        if("Up".equals(scolltype)||"Down".equals(scolltype)) {
            out.println("<MARQUEE DIRECTION="+scolltype.toLowerCase()+"  id=\"webjx_"+eid+"\" onmouseover=\"webjx_"+eid+".stop()\" onmouseout=\"webjx_"+eid+".start()\"  SCROLLDELAY=200 height="+height+">");
        }else if("Left".equals(scolltype)||"Right".equals(scolltype)) {
            out.println("<MARQUEE DIRECTION="+scolltype.toLowerCase()+"  id=\"webjx_"+eid+"\" onmouseover=\"webjx_"+eid+".stop()\" onmouseout=\"webjx_"+eid+".start()\"  SCROLLDELAY=200>");
        }
     
      out.write(_jsp_string5, 0, _jsp_string5.length);
      out.print((strStyle));
      out.write(_jsp_string6, 0, _jsp_string6.length);
      out.print((eid));
      out.write(_jsp_string7, 0, _jsp_string7.length);
      if(imgType.equals("1")){ 
      out.write(_jsp_string8, 0, _jsp_string8.length);
      out.print((imgSrc));
      out.write(_jsp_string9, 0, _jsp_string9.length);
      } 
      out.write(_jsp_string10, 0, _jsp_string10.length);
      
        String receivetime = "";
        while (rs.next()){
        	int sysid = rs.getInt("sysid");
			String pcurl = Util.null2String(rs.getString("pcurl"));
            String requestid=Util.null2String(rs.getString("requestid"));           
            String workflowid=Util.null2String(rs.getString("workflowid"));
            String nodeid=Util.null2String(rs.getString("nodeid"));
            String workflowtype=Util.null2String(rs.getString("workflowtype"));
            String requestlevel=Util.null2String(rs.getString("requestlevel"));
            String creater=Util.null2String(rs.getString("creater"));
            String isremark=Util.null2String(rs.getString("isremark"));
            String rquserid = Util.null2String(rs.getString("userid"));
            
        
      out.write(_jsp_string11, 0, _jsp_string11.length);
      out.print((imgSymbol));
      out.write(_jsp_string12, 0, _jsp_string12.length);
                        
                    int size=fieldIdList.size();
                    for(int i=0;i<size;i++){
                        String fieldId=(String)fieldIdList.get(i);
                        String columnName=(String)fieldColumnList.get(i);
                        String strIsDate=(String)fieldIsDate.get(i);
                        String fieldTransMethod=(String)fieldTransMethodList.get(i);
                        String fieldwidth=(String)fieldWidthList.get(i);
                        String linkurl=(String)linkurlList.get(i);
                        String valuecolumn=(String)valuecolumnList.get(i);  

                        String isLimitLength=(String)isLimitLengthList.get(i);
                        String showValue="";                    
                        String cloumnValue=Util.null2String(rs.getString(columnName)); 
                        String titleValue = cloumnValue;
                        //cloumnValue = "<font >"+cloumnValue+"</font>";
                        
                        String nameTdTitle="";
                        if("requestname".equals(columnName)){   
							cloumnValue = cloumnValue.replaceAll("<br>"," ");
							cloumnValue = cloumnValue.replaceAll("&dt;&at;"," ");
							//cloumnValue = Util.delHtml(cloumnValue);
                            //\u6539\u4e3a\u6309\u8981\u6c42\u663e\u793a\u81ea\u5b9a\u4e49\u6d41\u7a0b\u6807\u9898\u7684\u524d\u7f00\u4fe1\u606f
                            String nodetitle="";
                            if(Util.getIntValue(viewType)!=6){ //\u975e\u7763\u529e
                                if("0".equals(isremark)){
                                    rsIn.executeSql("select nodetitle from workflow_flownode where workflowid="+workflowid+" and nodeid="+nodeid);
                                }else{
                                    if(rsIn.getDBType().equals("oracle")){
                                        rsIn.executeSql("select nodetitle from workflow_flownode f, (select nodeid from workflow_currentoperator t2 where rownum = 1 and t2.isremark=0 and t2.userid = "+user.getUID()+" and t2.usertype="+(Util.getIntValue(user.getLogintype())-1)+" and t2.requestid="+requestid+" order by  t2.receivedate desc, t2.receivetime desc ) n where f.workflowid="+workflowid+" and f.nodeid = n.nodeid ");
                                    }else{
                                        rsIn.executeSql("select nodetitle from workflow_flownode where workflowid="+workflowid+" and nodeid = (select top 1 nodeid from workflow_currentoperator t2 where t2.isremark=0 and t2.userid = "+user.getUID()+" and t2.usertype="+(Util.getIntValue(user.getLogintype())-1)+" and t2.requestid="+requestid+" order by  t2.receivedate desc, t2.receivetime desc ) ");
                                    }
                                }
                                if(rsIn.next()){
                                    nodetitle = Util.null2String(rsIn.getString("nodetitle"));
                                }
                            }  
                            nameTdTitle=titleValue;
							cloumnValue = cloumnValue.replace("<br>"," ");
                            if("".equals(nodetitle)) cloumnValue=cloumnValue;   
                            else    cloumnValue="\uff08"+nodetitle+"\uff09"+cloumnValue;  
                                             
                        }                                      
                        //if("1".equals(isLimitLength))   cloumnValue=hpu.getLimitStr(eid,fieldId,cloumnValue,user,hpid,subCompanyId);
                       

                            //cloumnValue=Util.StringReplace(cloumnValue,"&lt;","<"); 
                            //cloumnValue=Util.StringReplace(cloumnValue,"&gt;",">"); 
                            cloumnValue=Util.StringReplace(cloumnValue,"&quot;","\"");
                            cloumnValue=Util.StringReplace(cloumnValue,"&nbsp;"," ");

                            //cloumnValue=hpu.getLimitStr(eid,fieldId,cloumnValue,user,hpid,subCompanyId);
                      
                        
              
      out.write(_jsp_string13, 0, _jsp_string13.length);
      
			  //\u7edf\u4e00\u5f85\u529e\u96c6\u6210\u53c2\u6570\u9009\u62e9\u663e\u793a\u7cfb\u7edf\u540d\u79f0\u4e14\u5143\u7d20\u663e\u793a\u5b57\u6bb5\u9009\u4e2d"\u7cfb\u7edf\u540d\u79f0"\u5b57\u6bb5\u624d\u663e\u793a\u7cfb\u7edf\u540d\u79f0
			  if("sysname".equals(columnName)){
				  String sysname = "";
				  if (isShowSysname) {
					  if (sysid == 0) { // OA
						  sysname = "1".equals(showSysName) ? oaShortName : oaFullName;
					  } else if (sysid < 0) { // \u5f02\u6784\u7cfb\u7edf
						  RecordSet ofsSysinfoRs = new RecordSet();
						  ofsSysinfoRs.execute("select SysShortName, SysFullName from Ofs_sysinfo where sysid = " + sysid);
				    	  if (ofsSysinfoRs.next()) {
				    		  sysname = "1".equals(showSysName) ? ofsSysinfoRs.getString("SysShortName") : ofsSysinfoRs.getString("SysFullName");
				          }
				      }
				  } else {
					  fieldwidth = "1";
				  }
			  
      out.write(_jsp_string14, 0, _jsp_string14.length);
      out.print((fieldwidth));
      out.write(_jsp_string15, 0, _jsp_string15.length);
      out.print(sysname);
      out.write(_jsp_string16, 0, _jsp_string16.length);
      }
      out.write(_jsp_string13, 0, _jsp_string13.length);
      if("requestname".equals(columnName)){
            	  if (sysid < 0) {
  					
      out.write(_jsp_string17, 0, _jsp_string17.length);
      out.print((fieldwidth));
      out.write(_jsp_string18, 0, _jsp_string18.length);
      out.print((nameTdTitle));
      out.write(_jsp_string19, 0, _jsp_string19.length);
      out.print((rquserid));
      out.write(_jsp_string20, 0, _jsp_string20.length);
      out.print((requestid ));
      out.write(_jsp_string21, 0, _jsp_string21.length);
      
					    cloumnValue = cloumnValue.replaceAll("<br>"," ");
						cloumnValue = cloumnValue.replaceAll("&dt;&at;"," ");
  						String pcprefixurl = "";
  						RecordSet ofsSysinfoRs = new RecordSet();
  						ofsSysinfoRs.execute("select Pcprefixurl from Ofs_sysinfo where sysid = " + sysid);
  				    	if (ofsSysinfoRs.next()) {
  				    		pcprefixurl = ofsSysinfoRs.getString("Pcprefixurl");
  				        }
  				    	//String url = pcprefixurl + pcurl;
  				    	String url = "/workflow/request/ViewRequest.jsp?requestid="+requestid+"&_workflowid="+workflowid+"&_workflowtype="+workflowtype+"&isovertime=0";
  				    	if ("0".equals(rs.getString("viewtype"))) {
  				    		out.print("<a class=\"ellipsis notRead\" href=\"javaScript:openFullWindowHaveBarForWF('"+url+"','"+requestid+"')\"><font class=\"font\"><span class=\"reqname\" onclick=\"javaScript:setWorkFlowRefresh("+eid+","+ebaseid+")\"><font class=\"font\">"+cloumnValue+"</font></span></font></font></a><IMG id=\'wflist_"+requestid+"img\' title=\'"+SystemEnv.getHtmlLabelName(19154,user.getLanguage())+"\' class=\'wfremindimg\' src=\'/images/ecology8/statusicon/BDNew_wev8.png\' align=absbottom>");
  				    	} else {
  				    		out.print("<a class=\"ellipsis\" href=\"javaScript:openFullWindowHaveBarForWF('"+url+"','"+requestid+"')\"><font class=\"font\"><span class=\"reqname\" onclick=\"javaScript:setWorkFlowRefresh("+eid+","+ebaseid+")\"><font class=\"font\">"+cloumnValue+"</font></span></font></font></a>");
  				    	}
  			    	 
      out.write(_jsp_string22, 0, _jsp_string22.length);
      
  					} else {
                        //cloumnValue = Util.delHtml(cloumnValue);
						cloumnValue = cloumnValue.replace("<br>"," ");
                        cloumnValue = "<font class=font><span class='reqname'  onclick='javaScript:setWorkFlowRefresh("+eid+","+ebaseid+")' > <font class='font'>"+cloumnValue;
                        String strName="";  
                        if(Util.getIntValue(viewType)==6){
                            String para2 = requestid+"+"+workflowid+"+"+user.getUID()+"+"+(Util.getIntValue(user.getLogintype())-1)+"+"+ user.getLanguage()+"+"+rquserid;
                            cloumnValue += "</font></span></font>";
                            strName=WorkFlowTransMethod.getWfNewLinkByUrger(cloumnValue,para2);
							strName =  strName.replace("<br>"," ");
                        } else {
                            
                            //if(Util.getIntValue(viewType)==1)
                            //{
                                int isbill=0;
                                int formid=0;
                                ////\u6839\u636e\u540e\u53f0\u8bbe\u7f6e\u5728MAIL\u6807\u9898\u540e\u52a0\u4e0a\u6d41\u7a0b\u4e2d\u91cd\u8981\u7684\u5b57\u6bb5
                                rsIn.execute("select formid,isbill from workflow_base where id="+workflowid);
                                if (rsIn.next()){
                                    formid=rsIn.getInt(1);
                                    isbill=rsIn.getInt(2);
                                    
                                }
                                if(!belongtoshow.equals("1")||!"0".equals(user.getAccount_type())){
                                    MailAndMessage mailTitle=new MailAndMessage();
                                    
                                    String titles=mailTitle.getTitle(Util.getIntValue(requestid,-1),Util.getIntValue(workflowid,-1),formid,user.getLanguage(),isbill);
                                    if(!titles.equals("")) {
                                        cloumnValue+="<b>\uff08"+titles+"\uff09</b>";
                                        //out.println("<b>\uff08"+titles+"\uff09</b>");
                                        nameTdTitle =nameTdTitle+"\uff08"+titles+"\uff09";
                                    }
                                }
                            //}
                            //nameTdTitle= Util.delHtml(nameTdTitle);
							nameTdTitle = nameTdTitle.replaceAll("&dt;&at;"," ");
                            nameTdTitle = nameTdTitle.replaceAll("%nbsp;"," ");
                            cloumnValue += "</font></span></font>";
                            strName=HomepageFiled.getRequestNewLink(rs,user,cloumnValue,linkmode,belongtoshow);
                        }   
                        
      out.write(_jsp_string23, 0, _jsp_string23.length);
      out.print((fieldwidth));
      out.write(_jsp_string18, 0, _jsp_string18.length);
      out.print((nameTdTitle));
      out.write(_jsp_string19, 0, _jsp_string19.length);
      out.print((rquserid));
      out.write(_jsp_string20, 0, _jsp_string20.length);
      out.print((requestid ));
      out.write(_jsp_string24, 0, _jsp_string24.length);
            
                         //strName = "<font class=font>"+strName+"</font>";
                       if("0".equals(rs.getString("viewtype"))){
                          strName = strName.replace("href"," class='ellipsis notRead' href");
                        }else{
                         strName = strName.replace("href"," class='ellipsis' href");
                        }
						 strName =  strName.replaceAll("<br>"," ");
						 strName = strName.replaceAll("&dt;&at;"," ");
                        out.println(strName);
                    
      out.write(_jsp_string25, 0, _jsp_string25.length);
      }}
      out.write(_jsp_string26, 0, _jsp_string26.length);
      if("importantleve".equals(columnName)){
      out.write(_jsp_string27, 0, _jsp_string27.length);
      out.print((fieldwidth));
      out.write(_jsp_string28, 0, _jsp_string28.length);
      out.print(("<font class=font>"+WorkFlowTransMethod.getWFSearchResultUrgencyDegree(requestlevel,""+user.getLanguage())+"</font>"));
      out.write(_jsp_string29, 0, _jsp_string29.length);
      }
      out.write(_jsp_string30, 0, _jsp_string30.length);
      if("creater".equals(columnName)){
              
               String tmpValue = HomepageFiled.getHrmStr(rs,user,cloumnValue,linkmode);
               tmpValue = tmpValue.substring(0,tmpValue.indexOf(">")+1)+"<font class=font>"+tmpValue.substring(tmpValue.indexOf(">")+1,tmpValue.indexOf("</a>"))+"</font>"+tmpValue.substring(tmpValue.indexOf("</a>"),tmpValue.length());
               
      out.write(_jsp_string27, 0, _jsp_string27.length);
      out.print((fieldwidth));
      out.write(_jsp_string28, 0, _jsp_string28.length);
      out.print((tmpValue));
      out.write(_jsp_string29, 0, _jsp_string29.length);
      }
      out.write(_jsp_string31, 0, _jsp_string31.length);
      if("createrDept".equals(columnName)){
      out.write(_jsp_string27, 0, _jsp_string27.length);
      out.print((fieldwidth));
      out.write(_jsp_string32, 0, _jsp_string32.length);
      out.print(("<font class=font>"+DepartmentComInfo.getDepartmentname(ResourceComInfo.getDepartmentID(creater))+"</font>"));
      out.write(_jsp_string33, 0, _jsp_string33.length);
      }
      out.write(_jsp_string31, 0, _jsp_string31.length);
      if("workflowtype".equals(columnName)){
			   		String workflowname = "";
			   		if (sysid < 0) {
			   		 	RecordSet ofsWfRs = new RecordSet();
			   			ofsWfRs.execute("select workflowname from ofs_workflow where sysid = " + sysid + " and workflowid = " + workflowid);
			   			if (ofsWfRs.next()) {
				   			workflowname = ofsWfRs.getString("workflowname");
			   			}
			   		} else {
			   			workflowname = WorkflowComInfo.getWorkflowname(workflowid);
			   		}
			   
      out.write(_jsp_string34, 0, _jsp_string34.length);
      out.print((fieldwidth));
      out.write(_jsp_string35, 0, _jsp_string35.length);
      out.print(("<font class=font>"+workflowname+"</font>"));
      out.write(_jsp_string36, 0, _jsp_string36.length);
      }
      out.write(_jsp_string37, 0, _jsp_string37.length);
      
                if(Util.getIntValue(viewType)==6){//TD:39434
                    cloumnValue = Util.null2String(rs.getString("receivedate"));
                    receivetime = cloumnValue.substring(10);
                    cloumnValue = cloumnValue.substring(0,10);
                }       
                if("receivedate".equals(columnName)){
      out.write(_jsp_string27, 0, _jsp_string27.length);
      out.print((fieldwidth));
      out.write(_jsp_string28, 0, _jsp_string28.length);
      out.print(("<font class=font>"+cloumnValue+"</font>"));
      out.write(_jsp_string29, 0, _jsp_string29.length);
      }
      out.write(_jsp_string38, 0, _jsp_string38.length);
      if("receivetime".equals(columnName)){
                  if(Util.getIntValue(viewType)==6){
                    cloumnValue = receivetime;
                  }
                  
      out.write(_jsp_string27, 0, _jsp_string27.length);
      out.print((fieldwidth));
      out.write(_jsp_string28, 0, _jsp_string28.length);
      out.print(("<font class=font>"+cloumnValue+"</font>"));
      out.write(_jsp_string29, 0, _jsp_string29.length);
      }
      out.write(_jsp_string39, 0, _jsp_string39.length);
      }
      out.write(_jsp_string40, 0, _jsp_string40.length);
      
        rowcount++;
        if(perpage!=1&&rowcount<perpage){
        
      out.write(_jsp_string41, 0, _jsp_string41.length);
      out.print((size+2));
      out.write(_jsp_string42, 0, _jsp_string42.length);
      }
      out.write(_jsp_string43, 0, _jsp_string43.length);
      }
      out.write(_jsp_string44, 0, _jsp_string44.length);
      if("Left".equals(scolltype)||"Right".equals(scolltype)||"Up".equals(scolltype)||"Down".equals(scolltype)) 
    out.println("</MARQUEE>");

      out.write(_jsp_string45, 0, _jsp_string45.length);
      out.print((eid ));
      out.write(_jsp_string46, 0, _jsp_string46.length);
      out.print((SystemEnv.getHtmlLabelName(82720,user.getLanguage()) ));
      out.write(_jsp_string47, 0, _jsp_string47.length);
      out.print((eid));
      out.write(_jsp_string48, 0, _jsp_string48.length);
      out.print((eid));
      out.write(_jsp_string49, 0, _jsp_string49.length);
      out.print((eid));
      out.write(_jsp_string50, 0, _jsp_string50.length);
      out.print((eid));
      out.write(_jsp_string51, 0, _jsp_string51.length);
      out.print((eid));
      out.write(_jsp_string52, 0, _jsp_string52.length);
      out.print((eid ));
      out.write(_jsp_string53, 0, _jsp_string53.length);
      out.print((eid));
      out.write(_jsp_string54, 0, _jsp_string54.length);
      out.print((eid));
      out.write(_jsp_string55, 0, _jsp_string55.length);
      out.print((eid));
      out.write(_jsp_string56, 0, _jsp_string56.length);
      out.print((eid));
      out.write(_jsp_string57, 0, _jsp_string57.length);
      out.print((eid));
      out.write(_jsp_string58, 0, _jsp_string58.length);
      out.print((eid ));
      out.write(_jsp_string59, 0, _jsp_string59.length);
      out.print((eid));
      out.write(_jsp_string60, 0, _jsp_string60.length);
      out.print((eid ));
      out.write(_jsp_string61, 0, _jsp_string61.length);
      out.print((eid));
      out.write(_jsp_string62, 0, _jsp_string62.length);
      out.print((eid));
      out.write(_jsp_string63, 0, _jsp_string63.length);
      out.print((eid));
      out.write(_jsp_string64, 0, _jsp_string64.length);
      out.print((eid));
      out.write(_jsp_string65, 0, _jsp_string65.length);
      out.print((flag));
      out.write(_jsp_string66, 0, _jsp_string66.length);
      out.print((tabs));
      out.write(_jsp_string67, 0, _jsp_string67.length);
      out.print((eid));
      out.write('_');
      out.print((tabId));
      out.write(_jsp_string68, 0, _jsp_string68.length);
      out.print((count));
      out.write(_jsp_string69, 0, _jsp_string69.length);
      out.print((eid));
      out.write(_jsp_string70, 0, _jsp_string70.length);
      out.print((count));
      out.write(_jsp_string71, 0, _jsp_string71.length);
      out.print((isremind));
      out.write(_jsp_string72, 0, _jsp_string72.length);
      out.print((eid));
      out.write(_jsp_string73, 0, _jsp_string73.length);
    } catch (java.lang.Throwable _jsp_e) {
      pageContext.handlePageException(_jsp_e);
    } finally {
      _jsp_application.getJspApplicationContext().freePageContext(pageContext);
    }
  }

  private java.util.ArrayList _caucho_depends = new java.util.ArrayList();

  public java.util.ArrayList _caucho_getDependList()
  {
    return _caucho_depends;
  }

  public void _caucho_addDepend(com.caucho.vfs.PersistentDependency depend)
  {
    super._caucho_addDepend(depend);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  public boolean _caucho_isModified()
  {
    if (_caucho_isDead)
      return true;
    if (com.caucho.server.util.CauchoSystem.getVersionId() != 1886798272571451039L)
      return true;
    for (int i = _caucho_depends.size() - 1; i >= 0; i--) {
      com.caucho.vfs.Dependency depend;
      depend = (com.caucho.vfs.Dependency) _caucho_depends.get(i);
      if (depend.isModified())
        return true;
    }
    return false;
  }

  public long _caucho_lastModified()
  {
    return 0;
  }

  public java.util.HashMap<String,java.lang.reflect.Method> _caucho_getFunctionMap()
  {
    return _jsp_functionMap;
  }

  public void init(ServletConfig config)
    throws ServletException
  {
    com.caucho.server.webapp.WebApp webApp
      = (com.caucho.server.webapp.WebApp) config.getServletContext();
    super.init(config);
    com.caucho.jsp.TaglibManager manager = webApp.getJspApplicationContext().getTaglibManager();
    com.caucho.jsp.PageContextImpl pageContext = new com.caucho.jsp.PageContextImpl(webApp, this);
  }

  public void destroy()
  {
      _caucho_isDead = true;
      super.destroy();
  }

  public void init(com.caucho.vfs.Path appDir)
    throws javax.servlet.ServletException
  {
    com.caucho.vfs.Path resinHome = com.caucho.server.util.CauchoSystem.getResinHome();
    com.caucho.vfs.MergePath mergePath = new com.caucho.vfs.MergePath();
    mergePath.addMergePath(appDir);
    mergePath.addMergePath(resinHome);
    com.caucho.loader.DynamicClassLoader loader;
    loader = (com.caucho.loader.DynamicClassLoader) getClass().getClassLoader();
    String resourcePath = loader.getResourcePathSpecificFirst();
    mergePath.addClassPath(resourcePath);
    com.caucho.vfs.Depend depend;
    depend = new com.caucho.vfs.Depend(appDir.lookup("page/element/compatible/WorkflowTabContentData.jsp"), -4218255120494693097L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("homepage/element/content/Common.jsp"), 5648407096738041053L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("page/maint/common/initNoCache.jsp"), 3270256153856711871L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  private final static char []_jsp_string51;
  private final static char []_jsp_string53;
  private final static char []_jsp_string69;
  private final static char []_jsp_string40;
  private final static char []_jsp_string73;
  private final static char []_jsp_string19;
  private final static char []_jsp_string30;
  private final static char []_jsp_string65;
  private final static char []_jsp_string7;
  private final static char []_jsp_string68;
  private final static char []_jsp_string29;
  private final static char []_jsp_string12;
  private final static char []_jsp_string28;
  private final static char []_jsp_string67;
  private final static char []_jsp_string44;
  private final static char []_jsp_string26;
  private final static char []_jsp_string16;
  private final static char []_jsp_string35;
  private final static char []_jsp_string70;
  private final static char []_jsp_string32;
  private final static char []_jsp_string38;
  private final static char []_jsp_string4;
  private final static char []_jsp_string63;
  private final static char []_jsp_string45;
  private final static char []_jsp_string22;
  private final static char []_jsp_string11;
  private final static char []_jsp_string43;
  private final static char []_jsp_string15;
  private final static char []_jsp_string6;
  private final static char []_jsp_string21;
  private final static char []_jsp_string64;
  private final static char []_jsp_string57;
  private final static char []_jsp_string23;
  private final static char []_jsp_string36;
  private final static char []_jsp_string13;
  private final static char []_jsp_string37;
  private final static char []_jsp_string31;
  private final static char []_jsp_string39;
  private final static char []_jsp_string5;
  private final static char []_jsp_string9;
  private final static char []_jsp_string60;
  private final static char []_jsp_string55;
  private final static char []_jsp_string48;
  private final static char []_jsp_string58;
  private final static char []_jsp_string66;
  private final static char []_jsp_string59;
  private final static char []_jsp_string33;
  private final static char []_jsp_string49;
  private final static char []_jsp_string41;
  private final static char []_jsp_string8;
  private final static char []_jsp_string54;
  private final static char []_jsp_string17;
  private final static char []_jsp_string56;
  private final static char []_jsp_string24;
  private final static char []_jsp_string34;
  private final static char []_jsp_string3;
  private final static char []_jsp_string72;
  private final static char []_jsp_string27;
  private final static char []_jsp_string50;
  private final static char []_jsp_string1;
  private final static char []_jsp_string47;
  private final static char []_jsp_string61;
  private final static char []_jsp_string71;
  private final static char []_jsp_string42;
  private final static char []_jsp_string52;
  private final static char []_jsp_string14;
  private final static char []_jsp_string18;
  private final static char []_jsp_string25;
  private final static char []_jsp_string10;
  private final static char []_jsp_string0;
  private final static char []_jsp_string62;
  private final static char []_jsp_string46;
  private final static char []_jsp_string20;
  private final static char []_jsp_string2;
  static {
    _jsp_string51 = "\").find(\".reqdetail\").parent().hover(function(){\r\n            $(this).find(\".imgdetail\").show();\r\n        },\r\n        function(){\r\n            $(this).find(\".imgdetail\").hide();\r\n        });\r\n        \r\n    jQuery(\"#tabContant_".toCharArray();
    _jsp_string53 = "\");\r\n         $this = jQuery(this).parents(\"tr:first\").find(\".reqdetail\");\r\n         contentDiv_".toCharArray();
    _jsp_string69 = ")\");\r\n        else jQuery(\"#count_".toCharArray();
    _jsp_string40 = "\r\n            <td style=\"position:relative;width:10px;\">\r\n                <img class=\"imgdetail\" style=\"cursor:pointer; display:none;position: absolute;right:5px;top:8px;\" src=\"/images/ecology8/homepage/req_wev8.png\" width=\"12px\" height=\"12px;\">\r\n            </td>\r\n        </TR>\r\n        ".toCharArray();
    _jsp_string73 = "\",isremind,\"reqdetail\",\"reqname\");\r\n    }\r\n    \r\n</script>\r\n\r\n\r\n".toCharArray();
    _jsp_string19 = "\" rquserid=\"".toCharArray();
    _jsp_string30 = "  \r\n                \r\n                \r\n               ".toCharArray();
    _jsp_string65 = ".perfectScrollbar(\"update\");\r\n        }\r\n    })\r\n        \r\n    if(".toCharArray();
    _jsp_string7 = "\" class=Econtent  width=100%>\r\n   <TR valign='middle'>\r\n     <TD width=1px valign='middle'>\r\n     ".toCharArray();
    _jsp_string68 = "\").html(\"(".toCharArray();
    _jsp_string29 = "</td>\r\n              ".toCharArray();
    _jsp_string12 = "</TD>\r\n                ".toCharArray();
    _jsp_string28 = "\">".toCharArray();
    _jsp_string67 = ">1) jQuery(\"#".toCharArray();
    _jsp_string44 = "\r\n         </TABLE>\r\n    </TD>\r\n    <TD width=\"1px\"></TD>\r\n</TR>\r\n</TABLE>\r\n".toCharArray();
    _jsp_string26 = "  \r\n                \r\n             ".toCharArray();
    _jsp_string16 = "</font>\r\n				</td>\r\n			  ".toCharArray();
    _jsp_string35 = "\">\r\n					".toCharArray();
    _jsp_string70 = "\").html(\" (".toCharArray();
    _jsp_string32 = "\">\r\n                    ".toCharArray();
    _jsp_string38 = "\r\n\r\n              ".toCharArray();
    _jsp_string4 = "\r\n\r\n      ".toCharArray();
    _jsp_string63 = ".height(ulheight)\r\n            //alert(ulheight)\r\n            //contentDiv_".toCharArray();
    _jsp_string45 = "\r\n\r\n<div id=\"signPreview_".toCharArray();
    _jsp_string22 = "\r\n  			    	 	</td>\r\n  				    ".toCharArray();
    _jsp_string11 = "\r\n        <TR>\r\n                <TD width=\"8\">".toCharArray();
    _jsp_string43 = "\r\n        ".toCharArray();
    _jsp_string15 = "\">\r\n					<font class=font>".toCharArray();
    _jsp_string6 = "\" id=\"_contenttable_".toCharArray();
    _jsp_string21 = "\">\r\n  					".toCharArray();
    _jsp_string64 = ".height(ulheight);\r\n            contentDiv_".toCharArray();
    _jsp_string57 = ".perfectScrollbar();\r\n                \r\n                if(curPage==parseInt(totalPage)){\r\n                    signPreview.find(\".signMore\").hide();\r\n                    signPreview.find(\".signMore\").prev().css(\"border-bottom-width\",\"1px\");\r\n                }else{\r\n                    signPreview.find(\".signMore\").show();\r\n                    signPreview.find(\".signMore\").prev().css(\"border-bottom-width\",\"0px\");\r\n                }\r\n                signPreview.show();\r\n                })\r\n    })\r\n    \r\n    \r\n    jQuery(\"#signPreview_".toCharArray();
    _jsp_string23 = "\r\n                        <td class='reqdetail' width=\"".toCharArray();
    _jsp_string36 = "\r\n                </td>\r\n              ".toCharArray();
    _jsp_string13 = "\r\n              ".toCharArray();
    _jsp_string37 = "\r\n               ".toCharArray();
    _jsp_string31 = "\r\n\r\n               ".toCharArray();
    _jsp_string39 = "\r\n\r\n            ".toCharArray();
    _jsp_string5 = "\r\n<TABLE  style=\"".toCharArray();
    _jsp_string9 = "' />\r\n     ".toCharArray();
    _jsp_string60 = "\").find(\".signMore\").bind(\"click\",function(){\r\n        //var ifm = jQuery(\"#signPreview_".toCharArray();
    _jsp_string55 = ".find(\".content\").height();\r\n                //alert(ulheight)\r\n                if(ulheight>350){\r\n                    \r\n                    ulheight = 350;\r\n                    contentDiv_".toCharArray();
    _jsp_string48 = ";  \r\n    var contentDiv_".toCharArray();
    _jsp_string58 = "\").find(\".close\").bind(\"click\",function(){\r\n        jQuery(\"#signPreview_".toCharArray();
    _jsp_string66 = "==\"1\") {\r\n        if(".toCharArray();
    _jsp_string59 = "\").hide();\r\n    })\r\n        \r\n    jQuery(\"#signPreview_".toCharArray();
    _jsp_string33 = "\r\n               </td>\r\n              ".toCharArray();
    _jsp_string49 = " = jQuery(\"#signPreview_".toCharArray();
    _jsp_string41 = "      \r\n         <TR class='sparator' style='height:1px' height=1px><td style='padding:0px' colspan=".toCharArray();
    _jsp_string8 = "\r\n        <img src='".toCharArray();
    _jsp_string54 = ".css(\"height\",\"350px\");\r\n        \r\n            $(\".signPreview\").hide();   \r\n            $(\".signPreview\").find(\".content\").html(\"\");\r\n            var requestid = $this.attr(\"requestid\")\r\n            var rquserid =  $this.attr(\"rquserid\")\r\n            var title = $this.attr(\"title\")\r\n            signPreview.find(\".signTitle\").html(title);\r\n            signPreview.find(\".content\").load(\"/workflow/request/WorkflowSignPreView.jsp?requestid=\"+requestid+\"&f_weaver_belongto_userid=\"+rquserid+\"&firstLoadNum=4&everyLoadNum=3\",function(data){\r\n                var etop = $this.parents(\".item:first\").offset().top;\r\n                var eleft = $this.parents(\".item:first\").offset().left;\r\n                //alert(eleft)\r\n                if($this.parents(\".item:first\").css(\"position\")==\"static\"){\r\n                    etop = 0\r\n                    eleft= 0\r\n                    \r\n                }\r\n                var left = $this.offset().left\r\n                left = left - eleft\r\n                var top = $this.offset().top\r\n                var rtop = top-etop;\r\n                \r\n                if(top <signPreview.height() || top - $(document).scrollTop()+350 < $(window).height()){\r\n                    $(\".arrowsblockup\").hide();\r\n                    $(\".arrowsblock\").show();\r\n                    $(\".signContainer\").removeClass(\"signContainerup\")\r\n                    $(\".signMore\").removeClass(\"signMoreup\")\r\n                    \r\n                }else{\r\n                    $(\".arrowsblockup\").show();\r\n                    $(\".arrowsblock\").hide();\r\n                    $(\".signContainer\").addClass(\"signContainerup\")\r\n                    $(\".signMore\").addClass(\"signMoreup\")\r\n                    rtop = rtop-350-20\r\n                    if(curPage!=parseInt(totalPage)){\r\n                        rtop = rtop-60;\r\n                    }else{\r\n                        rtop = rtop-20;\r\n                    }\r\n                }\r\n                //alert(top+rtop-$(document).scrollTop())\r\n                if(top+rtop-$(document).scrollTop()<0){\r\n                    rtop = top-etop;\r\n                    $(\".arrowsblockup\").hide();\r\n                    $(\".arrowsblock\").show();\r\n                    $(\".signContainer\").removeClass(\"signContainerup\")\r\n                    $(\".signMore\").removeClass(\"signMoreup\")\r\n                }\r\n                \r\n                signPreview.css(\"top\",rtop);\r\n                signPreview.css(\"left\",left);\r\n                signPreview.attr(\"top\",rtop);\r\n                \r\n                var ulheight = contentDiv_".toCharArray();
    _jsp_string17 = "\r\n  						<td class='reqdetail' width=\"".toCharArray();
    _jsp_string56 = ".height(ulheight);\r\n                }\r\n                //alert(ulheight);\r\n                //\r\n                contentDiv_".toCharArray();
    _jsp_string24 = "\">\r\n                            ".toCharArray();
    _jsp_string34 = "\r\n				<td  width=\"".toCharArray();
    _jsp_string3 = "\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string72 = "';\r\n    if(isremind!==''){\r\n        setRemindInfo(\"".toCharArray();
    _jsp_string27 = "\r\n                <td width=\"".toCharArray();
    _jsp_string50 = "\").find(\".signContent\");\r\n    jQuery(\"#tabContant_".toCharArray();
    _jsp_string1 = "\r\n".toCharArray();
    _jsp_string47 = "</div>\r\n    </div>\r\n    \r\n    \r\n</div>\r\n\r\n<style>\r\n    \r\n</style>\r\n\r\n<script type=\"text/javascript\">\r\n\r\n    var hoverTimer_".toCharArray();
    _jsp_string61 = "\").find(\".signContent\").find(\"iframe\")[0];\r\n        // ifm.contentWindow.loadSign();\r\n        if(!loadSign()){\r\n        \r\n            \r\n            \r\n            //alert(ulheight);\r\n            ulheight = 350;\r\n            //contentDiv_".toCharArray();
    _jsp_string71 = ")\");\r\n    }\r\n    //\u5904\u7406\r\n    var isremind='".toCharArray();
    _jsp_string42 = "></td></TR>\r\n         ".toCharArray();
    _jsp_string52 = "\").find(\".imgdetail\").bind(\"click\",function(){\r\n        \r\n         var signPreview = jQuery(\"#signPreview_".toCharArray();
    _jsp_string14 = "\r\n				<td width=\"".toCharArray();
    _jsp_string18 = "\" title=\"".toCharArray();
    _jsp_string25 = "\r\n                </td>\r\n             ".toCharArray();
    _jsp_string10 = "\r\n     </TD>\r\n     <TD width='*' valign=\"top\">\r\n        <TABLE width=\"100%\" class=\"elementdatatable\">    \r\n        ".toCharArray();
    _jsp_string0 = "\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string62 = ".scrollTo(ulheight);\r\n            \r\n            if(curPage==parseInt(totalPage)){\r\n                ulheight=ulheight+40;\r\n                jQuery(this).hide();\r\n                \r\n                \r\n            }\r\n            contentDiv_".toCharArray();
    _jsp_string46 = "\" class=\"signPreview\" style=\"z-index:9999;\">\r\n    <div class=\"arrowsblock\" style=\"display: none\"><img src=\"/images/ecology8/homepage/arrows_wev8.png\" width=\"13px\" height=\"8px\"></div>\r\n    <div class=\"arrowsblockup\" style=\"display: none\"><img src=\"/images/ecology8/homepage/arrows_up_wev8.png\" width=\"13px\" height=\"8px\"></div>\r\n    \r\n    <div class=\"signContainer\" style=\"position: relative\">\r\n        <img style=\"position: absolute;top:10px;right: 8px;cursor: pointer;z-index:1;\" class=\"close\" src=\"/images/ecology8/homepage/close_wev8.png\" width=\"20px\" height=\"20px\">\r\n        <div style=\"margin-top:-10px;background:#e5f5ff;height:40px;line-height:40px;font-size: 16px;color: #242424;z-index:1;padding-left:20px;\">\r\n			<div class=\"signTitle\" style=\"line-height: 40px;height: 40px;overflow: hidden;margin-right:38px;\"></div>\r\n        </div>\r\n\r\n\r\n\r\n        <div class=\"signContent\" style=\"overflow:hidden;position: relative;\">\r\n            <div class=\"content\" style=\"border: 0px; \"></div>\r\n        </div>\r\n        <!-- <iframe height='450px' width=\"100%\" border=\"0px\" style=\"border: 0px\"></iframe> -->\r\n        <div class=\"signMore\">".toCharArray();
    _jsp_string20 = "\" requestid=\"".toCharArray();
    _jsp_string2 = "\r\n\r\n".toCharArray();
  }
}
