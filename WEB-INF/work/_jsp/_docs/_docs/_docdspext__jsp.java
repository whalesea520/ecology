/*
 * JSP generated by Resin-3.1.8 (built Mon, 17 Nov 2008 12:15:21 PST)
 */

package _jsp._docs._docs;
import javax.servlet.*;
import javax.servlet.jsp.*;
import javax.servlet.http.*;
import java.net.*;
import weaver.general.TimeUtil;
import weaver.cowork.CoworkShareManager;
import weaver.formmode.setup.ModeRightInfo;
import java.util.*;
import weaver.hrm.*;
import weaver.systeminfo.*;
import weaver.general.*;
import ln.LN;
import weaver.hrm.settings.ChgPasswdReminder;
import weaver.hrm.settings.HrmSettingsComInfo;
import weaver.hrm.settings.RemindSettings;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import weaver.workflow.workflow.TestWorkflowCheck;
import weaver.systeminfo.template.UserTemplate;
import weaver.systeminfo.setting.*;
import weaver.login.LicenseCheckLogin;
import weaver.hrm.online.IPUtil;
import java.util.Map;
import weaver.conn.RecordSet;
import weaver.general.BaseBean;
import java.sql.Timestamp;
import weaver.file.Prop;
import weaver.systeminfo.setting.HrmUserSettingComInfo;
import net.sf.json.JSONArray;
import weaver.docs.docs.reply.PraiseInfo;
import weaver.docs.docs.reply.UserInfo;
import weaver.docs.docs.reply.DocReplyUtil;
import weaver.general.DesUtil;
import weaver.general.Util;
import weaver.systeminfo.RightClickMenu;
import weaver.general.KtreeHelp;
import weaver.general.GCONST;
import weaver.license.PluginUserCheck;
import weaver.hrm.resource.HrmListValidate;
import weaver.hrm.tools.HrmValidate;

public class _docdspext__jsp extends com.caucho.jsp.JavaPage
{
  private static final java.util.HashMap<String,java.lang.reflect.Method> _jsp_functionMap = new java.util.HashMap<String,java.lang.reflect.Method>();
  private boolean _caucho_isDead;

  
  private String getCurrWuiConfig(HttpSession session, User user, String keyword) throws Exception {
  	
  	if (keyword == null || "".equals(keyword)) {
  		return "";
  	}
  	
  	String curTheme = "";
  	String curskin = "";
  
  	
  		String[] rtnValue = getHrmUserSetting(user);
  		
  		curTheme = rtnValue[0];
  		curskin = rtnValue[1];
  		if(curTheme.equals("")||curskin.equals("")){
  			String templatetype = getCurrE8TemplateType(user);
  			if("".equals(templatetype)){
  				curTheme = "ecologyBasic";
  				curskin = "default";
  			}else if("ecology7".equals(templatetype)){
  				curTheme ="ecology7";
  				curskin = getCurrE8SkinInfo(user);
  			}else{
  				curTheme ="ecology8";
  				curskin = "default";
  			}
  			
  			
  			
  			
  		}else{
  			curTheme = rtnValue[0];
  			curskin = rtnValue[1];
  		}
  		
  		if(curTheme.equals("custom")){
  			curTheme ="ecology8";
  		}
  		
  		session.setAttribute("SESSION_CURRENT_THEME", curTheme);
  		session.setAttribute("SESSION_CURRENT_SKIN", curskin);
  	
  	if ("THEME".equals(keyword.toUpperCase())) {
  		return curTheme;
  	}
  	
  	if ("SKIN".equals(keyword.toUpperCase())) {
  		return curskin;
  	}
  	return "";
  }
  
  
  
  private String getCurrSkinFolder(User user) throws Exception {
  	String pslSkinfolder = "";
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  
  	int userid = user.getUID();
  
  	rs.executeSql("select skin from HrmUserSetting where resourceId=" + userid);
  	
  	if (rs.next()) {
  		pslSkinfolder = rs.getString("skin");
  	}
  
  	if (pslSkinfolder == null || "".equals(pslSkinfolder)) {
  	    pslSkinfolder = "default";
  	}
  	return pslSkinfolder;
  }
  
  private String getCurrE8TemplateType(User user){
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  	weaver.systeminfo.template.UserTemplate  userTemplate = new weaver.systeminfo.template.UserTemplate();
  	userTemplate.getTemplateByUID(user.getUID(),user.getUserSubCompany1());
  	
  	
  	String skin =  userTemplate.getTemplatetype();
  	
  	
  	return skin;
  	
  }
  
  private String getCurrE8SkinInfo(User user){
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  	weaver.systeminfo.template.UserTemplate  userTemplate = new weaver.systeminfo.template.UserTemplate();
  	userTemplate.getTemplateByUID(user.getUID(),user.getUserSubCompany1());
  	
  	
  	String skin =  userTemplate.getSkin();
  	
  	
  	return skin;
  	
  }
  
  private int getCurrTemplateId(User user){
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  	weaver.systeminfo.template.UserTemplate  userTemplate = new weaver.systeminfo.template.UserTemplate();
  	userTemplate.getTemplateByUID(user.getUID(),user.getUserSubCompany1());
  	
  	
  	int id =  userTemplate.getTemplateId();
  	
  	
  	return id;
  	
  }
  
  private String getCurrTemplateLogo(User user){
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  	weaver.systeminfo.template.UserTemplate  userTemplate = new weaver.systeminfo.template.UserTemplate();
  	userTemplate.getTemplateByUID(user.getUID(),user.getUserSubCompany1());
  	
  	
  	String logo =  userTemplate.getLogo();
  	
  	
  	return logo;
  	
  }
  
  private String[] getHrmUserSetting(User user) throws Exception {
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  
  	String[] result = new String[2];
  	String theme = "";
  	String skin = "";
  	
  	String sql="select templateid from SystemTemplateSubComp where subcompanyid="+user.getUserSubCompany1();
  	rs.executeSql(sql);
  	if(rs.next()){	
  	
  		String curUserCanUse = rs.getString("templateid");
  		sql = "SELECT a.* FROM HrmUserSetting a, SystemTemplate  b WHERE a.resourceId="+user.getUID()+" AND a.templateId=b.id  and  b.id="+curUserCanUse;
  		rs.execute(sql);
  		if(rs.next()){
  			theme = rs.getString("theme");
  			skin = rs.getString("skin");
  			if("ecology8".equals(theme)){
  				skin = "default";
  			}
  			result[0] = theme;
  			result[1] = skin;
  			return result;
  		}
  	}
  	
  	
  
  	
  	int userid = user.getUID();
  	rs.executeSql("select theme, skin from HrmUserSetting where resourceId=" + userid);
  	
  	if (rs.next()) {
  		theme = rs.getString("theme");
  		skin = rs.getString("skin");
  	}
  	
  	//rs.executeSql("select * from extandHpThemeItem where extandHpThemeId=" + sqltemplateid1 + " and isopen=1 and theme='" + theme + "' and skin='" + skin + "'");
  	result[0] = theme;
  	result[1] = skin;
  	
  	
  	
  	//System.out.println("result"+result[0]+result[1]);
  	return result;
  }
  
  
  private java.util.Map getPageConfigInfo(HttpSession session, User user) throws Exception{
  	
  	weaver.conn.RecordSet rs = new weaver.conn.RecordSet();
  	java.util.Map pageConfigkv = new java.util.HashMap();
  	
  	weaver.systeminfo.template.UserTemplate  userTemplate = new weaver.systeminfo.template.UserTemplate();
  	userTemplate.getTemplateByUID(user.getUID(),user.getUserSubCompany1());
  	
  	pageConfigkv.put("logoTop",userTemplate.getLogo());
  	pageConfigkv.put("logoBottom", userTemplate.getLogo());
  	pageConfigkv.put("isopen", userTemplate.getIsopen());
  	//pageConfigkv.put("islock", rs.getString("islock"));
  	
  	int extendtempletvalueid = userTemplate.getExtendtempletvalueid();
  	rs.executeSql("select * from extandHpThemeItem where extandHpThemeId=" + extendtempletvalueid + " and isopen=1 and theme='" + getCurrWuiConfig(session, user, "THEME") + "' and skin='" + getCurrWuiConfig(session, user, "SKIN") + "'");
  	
  	if (rs.next()) {
  	
  		
  		/**
  		 * ecologybasic\u4e3b\u9898\u7528\u8bbe\u7f6e\u9879
  		 */
  		pageConfigkv.put("bodyBg", rs.getString("bodyBg"));
  		pageConfigkv.put("topBgImage", rs.getString("topBgImage"));
  		pageConfigkv.put("toolbarBgColor", rs.getString("toolbarBgColor"));
  		pageConfigkv.put("menuborderColor", rs.getString("menuborderColor"));
  
  		pageConfigkv.put("leftbarBgImage", rs.getString("leftbarBgImage"));
  		pageConfigkv.put("leftbarBgImageH", rs.getString("leftbarBgImageH"));
  
  		pageConfigkv.put("leftbarborderColor", rs.getString("leftbarborderColor"));
  		pageConfigkv.put("leftbarFontColor", rs.getString("leftbarFontColor"));
  
  		pageConfigkv.put("topleftbarBgImage_left", rs.getString("topleftbarBgImage_left"));
  		pageConfigkv.put("topleftbarBgImage_center", rs.getString("topleftbarBgImage_center"));
  		pageConfigkv.put("topleftbarBgImage_right", rs.getString("topleftbarBgImage_right"));
  
  		pageConfigkv.put("bottomleftbarBgImage_left", rs.getString("bottomleftbarBgImage_left"));
  		pageConfigkv.put("bottomleftbarBgImage_center", rs.getString("bottomleftbarBgImage_center"));
  		pageConfigkv.put("bottomleftbarBgImage_right", rs.getString("bottomleftbarBgImage_right"));
  
  	}
  	
  	return pageConfigkv;
  	
  }


  
  private Map<String,Object> getMenuBars(
  		boolean onlyview,String fromFlowDoc,boolean isPersonalDoc,String isrequest,boolean canEditHis,String docstatus,
  		int hasright,int languageId,boolean canEdit,boolean canReader,boolean canShare,boolean canDel,String docreplyable,
  		weaver.docs.senddoc.OpenSendDoc OpenSendDoc,int docid,boolean cannewworkflow,boolean canPublish,boolean canInvalidate,
  		boolean canArchive,boolean canCancel,boolean canReopen,boolean canCheckOut,boolean canCheckIn,boolean canCheckInCompellably,
  		User user,int docdepartmentid,boolean canPrintApply,boolean canPrint,String isPrintControl,int isbill,int formid,
  		String docapprovable,int isremark,weaver.docs.category.SecCategoryComInfo secCategoryComInfo,int seccategory,boolean canViewLog,
  		String logintype,boolean hasRightOfViewHisVersion,boolean isCurrentNode,int defaultDocLocked,String filetype,boolean canDownload,
  		String nodetype,String isreply,boolean istoManagePage,boolean isUseTempletNode,int wordmouldid,int mouldSecCategoryId,
  		boolean isSignatureNodes,boolean cantop,int istop,int accessorycount,int countNum,String hasUsedTemplet,String RCMenu,int RCMenuHeight,int RCMenuHeightStep,boolean  iframeLoad,boolean  isFromAccessory,boolean openFirstAss,String isIE,String fileExtendName,boolean isToDocDspExt,boolean islastversion,boolean hasOpenEdition,boolean isCustomer,String imagefileName,String docsubject,int isUseEMessager) {
  
  		boolean isNotOffice=false;
  		if(!(imagefileName.toLowerCase().endsWith(".doc") || 
  			imagefileName.toLowerCase().endsWith(".docx") || 
  			imagefileName.toLowerCase().endsWith(".ppt") || 
  			imagefileName.toLowerCase().endsWith(".pptx") || 
  			imagefileName.toLowerCase().endsWith(".wps") || 
  			imagefileName.toLowerCase().endsWith(".xls") || 
  			imagefileName.toLowerCase().endsWith(".xlsx"))){
  			isNotOffice = true;//\u975eoffice\u6587\u6863
  		}
  		Map<String,Object> menus = new HashMap<String,Object>();
  
  		if(!isFromAccessory){//\u5982\u679c\u4e0d\u662f\u67e5\u770b\u9644\u4ef6\u9875\u9762\uff0c\u83dc\u5355\u6309\u4e4b\u524d\u7684\u903b\u8f91\uff0c\u5426\u5219\u5355\u72ec\u4e3a\u67e5\u770b\u9644\u4ef6\u9875\u9762\u5217\u51fa\u9644\u4ef6\u7684\u83dc\u5355
  		if (!onlyview) {
  			if (!fromFlowDoc.equals("1")) {
  				if (!isPersonalDoc) {
  					if (isrequest.equals("1")) { //\u4ece\u5de5\u4f5c\u6d41\u8fdb\u5165\u7684\u6587\u6863
  						//// \u5982\u679c\u4ece\u5de5\u4f5c\u6d41\u8fdb\u5165\uff0c\u6587\u6863\u5ba1\u6279\u6d41\u7a0b\u7684\u5f53\u524d\u64cd\u4f5c\u8005\u5728\u6587\u6863\u4e0d\u4e3a\u6b63\u5e38\u548c\u5f52\u6863\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4fee\u6539\uff0c\u5176\u5b83\u6d41\u7a0b\u7684\u5728\u6587\u6863\u4e3a\u975e\u5ba1\u6279\u6b63\u5e38\u6216\u8005\u9000\u56de\u72b6\u6001\u4e0b\u53ef\u4ee5\u4fee\u6539
  						//\u5982\u679c\u4ece\u5de5\u4f5c\u6d41\u8fdb\u5165\uff0c\u6587\u6863\u5ba1\u6279\u6d41\u7a0b\u7684\u5f53\u524d\u64cd\u4f5c\u8005\u5728\u6587\u6863\u4e0d\u4e3a\u5f52\u6863\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4fee\u6539\uff0c\u5176\u4ed6\u64cd\u4f5c\u8005\u5728\u6587\u6863\u4e3a\u8349\u7a3f\u3001\u6b63\u5e38\u6216\u8005\u9000\u56de\u72b6\u6001\u4e0b\u53ef\u4ee5\u4fee\u6539\u3002
  						if(canEditHis && ((!docstatus.equals("5") && hasright == 1) ||  ((docstatus.equals("0") || docstatus.equals("2") || docstatus.equals("1") || docstatus.equals("4")||Util.getIntValue(docstatus,0)<0) && hasright == 0)) ) {
  							RCMenu += "{"+SystemEnv.getHtmlLabelName(93,user.getLanguage())+",javascript:webOfficeMenuClickNew(1),_top} " ;
     	 						RCMenuHeight += RCMenuHeightStep ;
  						}
  						// \u5982\u679c\u662f\u8f6c\u53d1\uff0c\u6709\u6279\u6ce8\u6309\u94ae
  
  					}
  					// \u4ece\u975e\u5de5\u4f5c\u6d41\u8fdb\u5165\u7684\u6587\u6863
  					else if (canEdit&&islastversion) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(93,user.getLanguage())+",javascript:webOfficeMenuClickNew(7),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  						if (docstatus.equals("0") || Util.getIntValue(docstatus, 0) <= 0) {							
  							RCMenu += "{"+SystemEnv.getHtmlLabelName(615,user.getLanguage())+",javascript:onSave(),_top} " ;
     	 						RCMenuHeight += RCMenuHeightStep ;
  						}
  					}
  					// \u8349\u7a3f\u65f6\u7f16\u8f91\u63d0\u4ea4
  					else if (canReader) {
  						if (docstatus.equals("0") || Util.getIntValue(docstatus, 0) <= 0) {
  							RCMenu += "{"+SystemEnv.getHtmlLabelName(615,user.getLanguage())+",javascript:onSave(),_top} " ;
     	 						RCMenuHeight += RCMenuHeightStep ;
  						}
  					}
  					// \u5177\u6709\u4e0b\u8f7d\u6743\u9650\u7684\u4eba,\u6709\u4e0b\u8f7d\u6309\u94ae
  					if(canDownload&&!openFirstAss){//\u5355\u9644\u4ef6\u6253\u5f00\u7684\u65f6\u5019\u628a\u4e0b\u8f7d\u79fb\u5230\u9644\u4ef6\u83dc\u5355\u7ec4\u7684\u4f4d\u7f6e(\u56e0\u4e3a\u662f\u5bf9\u9644\u4ef6\u7684\u64cd\u4f5c)
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(31156,user.getLanguage())+",javascript:onDownload(),_top} " ;
  						RCMenuHeight += RCMenuHeightStep ;
  					}
  					// \u5177\u6709\u7f16\u8f91\u6743\u9650\u7684\u4eba,\u5bf9\u6587\u6863\u53ef\u4ee5\u4fee\u6539\u5171\u4eab\u7684, \u6709\u5171\u4eab\u6309\u94ae
  					if (canShare) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(119,user.getLanguage())+",javascript:webOfficeMenuClickNew(8),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  
  					// \u6587\u6863\u672c\u4eba\u5728\u6587\u6863\u975e\u5f52\u6863,\u975e\u5ba1\u6279\u540e\u6b63\u5e38,\u975e\u6253\u5f00\u72b6\u6001\u7684\u65f6\u5019\u53ef\u4ee5\u5220\u9664\u6587\u6863
  					if (canDel) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(91,user.getLanguage())+",javascript:webOfficeMenuClickNew(9),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  
  					// \u5177\u6709\u7f16\u8f91\u6743\u9650\u7684\u4eba\u5bf9\u5ba1\u6279\u540e\u6b63\u5e38\u7684\u6587\u6863\u53ef\u4ee5\u91cd\u65b0\u6253\u5f00
  					if (canEdit && docstatus.equals("10")) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(244,user.getLanguage())+",javascript:webOfficeMenuClickNew(10),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  
  					//\u6587\u6863\u56de\u590d\uff0c \u5982\u679c\u662f\u53ef\u4ee5\u56de\u590d\u7684\u6587\u6863\u4e14\u662f\u6b63\u5e38\u7684\u6587\u6863\uff0c \u53ef\u4ee5\u56de\u590d
  					if (docreplyable.equals("1") && (docstatus.equals("2") || docstatus.equals("1"))) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(18540,user.getLanguage())+",javascript:webOfficeMenuClickNew(11),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  
  					// \u5982\u679c\u53ef\u4ee5\u5bf9\u5176\u5b83\u7cfb\u7edf\u53d1\u9001\u8be5\u6587\u6863,\u53ef\u4ee5\u53d1\u9001\u8fd9\u4e2a\u6587\u6863
  					if (OpenSendDoc.inSendDoc("" + docid)) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(18540,user.getLanguage())+",javascript:webOfficeMenuClickNew(12),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  
  					}
  					//\u5206\u79bb\u6539\u9020	 \u6807\u7b7e1239\u66ff\u6362\u4e3a16392  	15295\u66ff\u6362\u4e3a1044  
  					// \u5982\u679c\u6587\u6863\u4e0d\u5728\u6253\u5f00\u72b6\u6001,\u53ef\u4ee5\u65b0\u5efa\u5de5\u4f5c\u6d41
  					if (!docstatus.equals("3") &&!docstatus.equals("7") && cannewworkflow) {
  						
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(16392,user.getLanguage())+",javascript:webOfficeMenuClickNew(13),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  					//\u65b0\u5efa\u8ba1\u5212
  					if(!isCustomer&&!docstatus.equals("7")){
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(18481,user.getLanguage())+",javascript:doAddWorkPlan_ext(),_top} " ;
  						RCMenuHeight += RCMenuHeightStep ;
  					}
  					/** \u5206\u79bb\u6539\u9020
  					RCMenu += "{"+SystemEnv.getHtmlLabelName(19759,user.getLanguage())+",javascript:webOfficeMenuClickNew(45),_top} " ;
     	 				RCMenuHeight += RCMenuHeightStep ;
  					**/
  					RCMenu += "{"+SystemEnv.getHtmlLabelName(1044,user.getLanguage())+",javascript:webOfficeMenuClickNew(14),_top} " ;
     	 				RCMenuHeight += RCMenuHeightStep ;
  
  					// \u5177\u6709\u6587\u6863\u7ba1\u7406\u5458\u6743\u9650\u7684\u4eba\u53ef\u4ee5\u5bf9\u5f85\u53d1\u5e03\u6587\u6863\u8fdb\u884c\u53d1\u5e03
  					if (canPublish) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(114,user.getLanguage())+",javascript:webOfficeMenuClickNew(15),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  					if (canInvalidate) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(15750,user.getLanguage())+",javascript:webOfficeMenuClickNew(16),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  
  					// \u5177\u6709\u6587\u6863\u7ba1\u7406\u5458\u6743\u9650\u7684\u4eba\u53ef\u4ee5\u5bf9\u5f52\u6863\u6587\u6863\u8fdb\u884c\u91cd\u65b0\u6253\u5f00\u64cd\u4f5c
  					// \u5177\u6709\u6587\u6863\u7ba1\u7406\u5458\u6743\u9650\u7684\u4eba\u53ef\u4ee5\u5bf9\u4f5c\u5e9f\u6587\u6863\u8fdb\u884c\u91cd\u65b0\u6253\u5f00\u64cd\u4f5c
  					if (canReopen) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(244,user.getLanguage())+",javascript:webOfficeMenuClickNew(19),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  
  					//\u6587\u6863\u7b7e\u51fa\uff0c\u4e14\u7b7e\u51fa\u4eba\u4e3a\u5f53\u524d\u7528\u6237\uff0c\u5219\u53ef\u8fdb\u884c\u6587\u6863\u7b7e\u5165\u64cd\u4f5c
  					if (canCheckIn) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(19693,user.getLanguage())+",javascript:webOfficeMenuClickNew(26),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  
  					//\u6587\u6863\u7b7e\u51fa\uff0c\u4e14\u7b7e\u51fa\u4eba\u4e0d\u4e3a\u5f53\u524d\u7528\u6237\uff0c\u5f53\u524d\u7528\u6237\u5177\u6709\u6587\u6863\u7ba1\u7406\u5458\u6216\u76ee\u5f55\u7ba1\u7406\u5458\u6743\u9650\uff0c\u5219\u53ef\u8fdb\u884c\u5f3a\u5236\u7b7e\u5165\u64cd\u4f5c
  					if (canCheckInCompellably) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(19688,user.getLanguage())+",javascript:webOfficeMenuClickNew(27),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  
  					// \u5177\u6709\u6587\u6863\u7ba1\u7406\u5458\u6743\u9650\u7684\u4eba\u53ef\u4ee5\u5bf9\u6b63\u5e38\u6587\u6863\u8fdb\u884c\u5f52\u6863
  					if (HrmUserVarify.checkUserRight("DocEdit:Reload", user, docdepartmentid) && docstatus.equals("5")) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(256,user.getLanguage())+",javascript:webOfficeMenuClickNew(30),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  					if (canPrintApply) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(21530,user.getLanguage())+",javascript:webOfficeMenuClickNew(48),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  					if (canPrint&&!iframeLoad) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(257,user.getLanguage())+",javascript:webOfficeMenuClickNew(47),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  					if (isPrintControl.equals("1")) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(21533,user.getLanguage())+",javascript:webOfficeMenuClickNew(49),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  					// \u4ece\u5ba1\u6279\u5de5\u4f5c\u6d41\u8fdb\u5165\u7684, \u6216\u8005\u5177\u6709\u7f16\u8f91\u6743\u9650\u5e76\u4e14\u6587\u6863\u6709\u5ba1\u6279\u7684\uff0c\u90fd\u6709\u5ba1\u6279\u610f\u89c1\u6309\u94ae
  					if (isbill == 1 && formid == 28) {
  						if ((canEdit && docapprovable.equals("1")) || isremark == 1 || hasright == 1) {
  							RCMenu += "{"+SystemEnv.getHtmlLabelName(1008,user.getLanguage())+",javascript:webOfficeMenuClickNew(31),_top} " ;
     	 						RCMenuHeight += RCMenuHeightStep ;
  						}
  					}
  					//\u5f53\u6587\u6863\u76ee\u5f55\u8bbe\u5b9a\u4e3a"\u6309\u6587\u6863\u65e5\u5fd7\u6743\u9650\u67e5\u770b"\u65f6\uff0c\u5bf9\u4e8e\u6709\u6587\u6863\u67e5\u770b\u6743\u9650\u7684\u4eba\u4e5f\u80fd\u67e5\u770b\u65e5\u5fd7(TD12005)
  						if ((secCategoryComInfo.getLogviewtype(seccategory) == 1 && HrmUserVarify.checkUserRight("FileLogView:View", user)||canEdit) || (secCategoryComInfo.getLogviewtype(seccategory) == 0)) {
  						// \u5177\u6709\u7f16\u8f91\u6743\u9650\u7684\u4eba\u90fd\u53ef\u4ee5\u67e5\u770b\u6587\u6863\u7684\u67e5\u770b\u65e5\u5fd7
  						if (canViewLog && logintype.equals("1")) {
  							RCMenu += "{"+SystemEnv.getHtmlLabelName(83,user.getLanguage())+",javascript:webOfficeMenuClickNew(32),_top} " ;
     	 						RCMenuHeight += RCMenuHeightStep ;
  						} else if (canEdit && logintype.equals("2")) {
  							RCMenu += "{"+SystemEnv.getHtmlLabelName(83,user.getLanguage())+",javascript:webOfficeMenuClickNew(33),_top} " ;
     	 						RCMenuHeight += RCMenuHeightStep ;
  						}
  					}
  						/**\u5206\u79bb\u6539\u9020\uff0c\u628a\u7f6e\u9876/\u53d6\u6d88\u7f6e\u9876\u79fb\u5230 \u6587\u6863\u83dc\u5355\u7ec4**/
  						if (HrmUserVarify.checkUserRight("Document:Top", user)) {
  							if (cantop) {
  								RCMenu += "{"+SystemEnv.getHtmlLabelName(23784,user.getLanguage())+",javascript:DocToTop(" + docid + ",1),_top} " ;
  								RCMenuHeight += RCMenuHeightStep ;
  							}
  							if (istop == 1) {
  								RCMenu += "{"+SystemEnv.getHtmlLabelName(24675,user.getLanguage())+",javascript:DocToTop(" + docid + ",2),_top} " ;
  								RCMenuHeight += RCMenuHeightStep ;
  							}
  						}
  					/*\u5206\u79bb\u6539\u9020 \u5355\u9644\u4ef6\u6253\u5f00\u7684\u65f6\u5019\u6709\u6253\u5f00\u7248\u672c\u83dc\u5355  \u52a0\u5165\u5206\u7ec4\u5206\u5272\u7ebf*/
  					if(openFirstAss){
  						RCMenu	 += "{__splitHR__,__hr__,_self} " ;
  						RCMenuHeight += 1;
  					}
  					if(canEdit&&openFirstAss&&"true".equalsIgnoreCase(isIE)&&fileExtendName.isEmpty()&&!imagefileName.toLowerCase().endsWith(".pdf")){
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(129740,user.getLanguage())+",javascript:onEditAcc(),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					} 
  					if(canDownload&&openFirstAss){//\u5355\u9644\u4ef6\u6253\u5f00\u7684\u65f6\u5019\u628a\u4e0b\u8f7d\u79fb\u5230\u9644\u4ef6\u83dc\u5355\u7ec4\u7684\u4f4d\u7f6e(\u56e0\u4e3a\u662f\u5bf9\u9644\u4ef6\u7684\u64cd\u4f5c)
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(31156,user.getLanguage())+",javascript:onDownload(),_top} " ;
  						RCMenuHeight += RCMenuHeightStep ;
  					}
  					if ((hasRightOfViewHisVersion || canEditHis)&&hasOpenEdition) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(16384,user.getLanguage())+",javascript:webOfficeMenuClickNew(35),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  					if (canEdit || (defaultDocLocked != 1 && !docstatus.equals("5")) || hasRightOfViewHisVersion) {
  						if ((filetype.equals(".doc")||filetype.equals(".docx")|| filetype.equals(".wps"))&&!iframeLoad) {
  							RCMenu += "{"+SystemEnv.getHtmlLabelName(16385,user.getLanguage())+",javascript:webOfficeMenuClickNew(36),_top} " ;
     	 						RCMenuHeight += RCMenuHeightStep ;
  						}
  					}
  				} else {
  					RCMenu += "{"+SystemEnv.getHtmlLabelName(93,user.getLanguage())+",javascript:webOfficeMenuClickNew(39),_top} " ;
     	 				RCMenuHeight += RCMenuHeightStep ;
  				}
  			} else {
  				if (istoManagePage) {
  					if (isUseTempletNode) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(21659,user.getLanguage())+",javascript:saveTHTemplate(" + wordmouldid + "),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  						if(countNum > 1 && isUseTempletNode && isremark==0){
  							RCMenu += "{"+SystemEnv.getHtmlLabelName(21660,user.getLanguage())+",javascript:selectTemplate(" + mouldSecCategoryId + "," + wordmouldid + "),_top} " ;
  							RCMenuHeight += RCMenuHeightStep ;
  						}
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(22983,user.getLanguage())+",javascript:useTempletCancel(),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(86,user.getLanguage())+",javascript:saveTHTemplateNoConfirm(" + wordmouldid + "),_top} " ;
     	 					RCMenuHeight += RCMenuHeightStep ;
  					}
  					if (isSignatureNodes) {/*\u662f\u5426\u663e\u793a\u76d6\u7ae0*/
  					    RCMenu += "{"+SystemEnv.getHtmlLabelName(21650,user.getLanguage())+",javascript:CreateSignature(0),_top} " ;
  					    RCMenuHeight += RCMenuHeightStep ;
  					    RCMenu += "{"+SystemEnv.getHtmlLabelName(21656,user.getLanguage())+",javascript:saveIsignatureFun(),_top} " ;
  					    RCMenuHeight += RCMenuHeightStep ;
  					}	
  				}
  				if(canDownload){
  					RCMenu += "{"+SystemEnv.getHtmlLabelName(31156,user.getLanguage())+",javascript:onDownload(),_top} " ;
  					RCMenuHeight += RCMenuHeightStep ;
  				}
  				if ((hasRightOfViewHisVersion|| canEditHis)&&hasOpenEdition) {
  					RCMenu += "{"+SystemEnv.getHtmlLabelName(16384,user.getLanguage())+",javascript:webOfficeMenuClickNew(35),_top} " ;
  					RCMenuHeight += RCMenuHeightStep ;
  			    }				
  				if (canPrint&&!iframeLoad) {
  					RCMenu += "{"+SystemEnv.getHtmlLabelName(257,user.getLanguage())+",javascript:webOfficeMenuClickNew(47),_top} " ;
     	 				RCMenuHeight += RCMenuHeightStep ;
  				}
  				if (canEdit || (defaultDocLocked != 1 && !docstatus.equals("5")) || hasRightOfViewHisVersion) {
  					if ((filetype.equals(".doc") ||filetype.equals(".docx")|| filetype.equals(".wps"))&&!iframeLoad) {
  						RCMenu += "{"+SystemEnv.getHtmlLabelName(16385,user.getLanguage())+",javascript:webOfficeMenuClickNew(36),_top} " ;
  						RCMenuHeight += RCMenuHeightStep ;
  					}
  				}
  				RecordSet rs = new RecordSet();
  				rs.executeProc("DocImageFile_SelectByDocid", "" + docid);
  				if (rs.next()) {
  					RCMenu += "{"+SystemEnv.getHtmlLabelName(31208,user.getLanguage())+",javascript:doImgAcc(),_top} " ;
  					RCMenuHeight += RCMenuHeightStep ;
  				}
  			}
  		}
  		}else{//\u5206\u79bb\u6539\u9020  \u67e5\u770b\u9644\u4ef6\u7684\u65f6\u5019\u4e3a\u9644\u4ef6\u5355\u72ec\u8bbe\u7f6e\u83dc\u5355
  			if (canEdit&&"true".equalsIgnoreCase(isIE)&&!isNotOffice&&islastversion) {
  				RCMenu += "{"+SystemEnv.getHtmlLabelName(93,user.getLanguage())+",javascript:webOfficeMenuClickNew(7),_top} " ;
  				RCMenuHeight += RCMenuHeightStep ;
  			}
  			if(canDownload){
  				RCMenu += "{"+SystemEnv.getHtmlLabelName(31156,user.getLanguage())+",javascript:onDownload(),_top} " ;
     	 			RCMenuHeight += RCMenuHeightStep ;
  			}
  			if ((hasRightOfViewHisVersion || canEditHis)&&hasOpenEdition) {
  				RCMenu += "{"+SystemEnv.getHtmlLabelName(16384,user.getLanguage())+",javascript:webOfficeMenuClickNew(35),_top} " ;
  				RCMenuHeight += RCMenuHeightStep ;
  			}
  			if (canEdit || (defaultDocLocked != 1 && !docstatus.equals("5")) || hasRightOfViewHisVersion) {
  				if ((filetype.equals(".doc")||filetype.equals(".docx")|| filetype.equals(".wps"))&&!iframeLoad) {
  					RCMenu += "{"+SystemEnv.getHtmlLabelName(16385,user.getLanguage())+",javascript:webOfficeMenuClickNew(36),_top} " ;
  					RCMenuHeight += RCMenuHeightStep ;
  				}
  			}
  			if (canPrint&&!isNotOffice) {
  				RCMenu += "{"+SystemEnv.getHtmlLabelName(257,user.getLanguage())+",javascript:webOfficeMenuClickNew(47),_top} " ;
  				RCMenuHeight += RCMenuHeightStep ;
  			}
  		}
  		if((docstatus.equals("1")||docstatus.equals("2")||docstatus.equals("5")) && "1".equals(user.getLogintype()) && ( !isFromAccessory || "1".equals(isrequest)) && isUseEMessager==1){
  			RCMenu += "{"+SystemEnv.getHtmlLabelName(126091,user.getLanguage())+",javascript:onDocShare("+docid+",\\\""+docsubject+"\\\"),_top} " ;
  			RCMenuHeight += RCMenuHeightStep ;				
  		}
  		menus.put("RCMenu",RCMenu);
  		menus.put("RCMenuHeight",RCMenuHeight);
  		return menus;
  	}

  
  public void
  _jspService(javax.servlet.http.HttpServletRequest request,
              javax.servlet.http.HttpServletResponse response)
    throws java.io.IOException, javax.servlet.ServletException
  {
    javax.servlet.http.HttpSession session = request.getSession(true);
    com.caucho.server.webapp.WebApp _jsp_application = _caucho_getApplication();
    javax.servlet.ServletContext application = _jsp_application;
    com.caucho.jsp.PageContextImpl pageContext = _jsp_application.getJspApplicationContext().allocatePageContext(this, _jsp_application, request, response, null, session, 8192, true, false);
    javax.servlet.jsp.PageContext _jsp_parentContext = pageContext;
    javax.servlet.jsp.JspWriter out = pageContext.getOut();
    final javax.el.ELContext _jsp_env = pageContext.getELContext();
    javax.servlet.ServletConfig config = getServletConfig();
    javax.servlet.Servlet page = this;
    response.setContentType("text/html; charset=UTF-8");
    request.setCharacterEncoding("UTF-8");
    weaver.common.util.taglib.BrowserTag _jsp_BrowserTag_0 = null;
    weaver.common.util.taglib.BrowserTag _jsp_BrowserTag_1 = null;
    try {
      out.write(_jsp_string0, 0, _jsp_string0.length);
      
	try{
		response.setBufferSize(1*1024*1024);
	}catch(Exception e){}

      out.write(_jsp_string1, 0, _jsp_string1.length);
      
// \u589e\u52a0\u53c2\u6570\u5224\u65ad\u7f13\u5b58
int isIncludeToptitle = 0;
response.setHeader("cache-control", "no-cache");
response.setHeader("pragma", "no-cache");
response.setHeader("expires", "Mon 1 Jan 1990 00:00:00 GMT");

      out.write(_jsp_string2, 0, _jsp_string2.length);
      
//
User user = HrmUserVarify.getUser (request , response) ;
LicenseCheckLogin licenseCheckLogin = new LicenseCheckLogin();
licenseCheckLogin.setOutLineDate(user.getUID(),IPUtil.getIp(request));

//\u95ee\u98981
TestWorkflowCheck twc=new TestWorkflowCheck();
if(twc.checkURI(session,request.getRequestURI(),request.getQueryString())){
    /*
    response.sendRedirect("/login/Logout.jsp");
    */
    String forwardurl = twc.reLoginMrg(request, response, request.getRequestURI());
    if (!"".equals(forwardurl)) { 
        response.sendRedirect(forwardurl);
        return;
    }
}
String userOffline = Util.null2String((String)session.getAttribute("userOffline"));	
if(userOffline.equals("1")){
	//\u5f3a\u5236\u4e0b\u7ebf
	String loginfile = Util.getCookie(request , "loginfileweaver") ;
	Map userSessions = (Map) application.getAttribute("userSessions");
	if (userSessions != null) {
		Map logmessages = (Map) application.getAttribute("logmessages");
		if (logmessages != null)logmessages.remove("" + user.getUID());
		session.removeValue("moniter");
		session.removeValue("WeaverMailSet");
		userSessions.remove(user.getUID());
		//session.invalidate();
	}
      out.write(_jsp_string3, 0, _jsp_string3.length);
      out.print((SystemEnv.getErrorMsgName(175,user.getLanguage())));
      out.write(_jsp_string4, 0, _jsp_string4.length);
      out.print(("/Refresh.jsp?loginfile="+loginfile+"&message=175"));
      out.write(_jsp_string5, 0, _jsp_string5.length);
      
  return;
}
if(user == null)  return ;
String isIE = (String)session.getAttribute("browser_isie");
if (isIE == null || "".equals(isIE)) {
	isIE = "true";
	session.setAttribute("browser_isie", "true");
}
String agentT = request.getHeader("user-agent");
//if(!"true".equals(isIE)){
//if((agentT.contains("Firefox")||agentT.contains(" Chrome")||agentT.contains("Safari") )&& !agentT.contains("Edge")){
if(agentT.contains("Firefox")||agentT.contains(" Chrome")||agentT.contains("Safari") || agentT.contains("Edge")){	
    isIE = "false";	
}
else{
    isIE = "true";	
}
//}

Log logger= LogFactory.getLog(this.getClass());



//************************************************
//\u8d85\u65f6\u6216\u8005\u91cd\u542fresin\u670d\u52a1\u65f6\uff0c\u5f39\u51fa\u767b\u9646\u5c0f\u7a97\u53e3(TD 2227)
//hubo,050707

//************************************************

String pagepath = request.getServletPath();
if(pagepath.indexOf("HrmResourceOperation.jsp")<0&&pagepath.indexOf("RemindLogin.jsp")<0&&pagepath.indexOf("HrmResourcePassword.jsp")<0){
	String changepwd = (String)request.getSession().getAttribute("changepwd");
	if("n".equals(changepwd)){
		request.getSession().removeAttribute("changepwd");
		response.sendRedirect("/login/Login.jsp");
		return;
	}else if("y".equals(changepwd)){
		request.getSession().removeAttribute("changepwd");
	}
}



//licence\u4fe1\u606f
String companyNametools="";
LN Licenseinit_1 = new LN();
try{
	Licenseinit_1.CkHrmnum();
}catch(Exception e){
	e.printStackTrace();
	out.println("<script type='text/javascript'> top.location.href='/system/InLicense.jsp?message=6&code=';</script>");
	return;
}
companyNametools = Licenseinit_1.getCompanyname();

//\u7248\u672c\u4fe1\u606f
StaticObj staticobj = null;
staticobj = StaticObj.getInstance();
String software = (String)staticobj.getObject("software") ;
if(software == null) software="ALL";
String portal = (String)staticobj.getObject("portal") ;
if(portal == null) portal="n";
boolean isPortalOK = false;
if(portal.equals("y")) isPortalOK = true;
String multilanguage = (String)staticobj.getObject("multilanguage") ;
if(multilanguage == null) multilanguage="n";
boolean isMultilanguageOK = false;
if(multilanguage.equals("y")) isMultilanguageOK = true;


      out.write(_jsp_string2, 0, _jsp_string2.length);
      
  String fromlogin=(String)session.getAttribute("fromlogin");
  session.removeAttribute("fromlogin");
  if(fromlogin==null) fromlogin="no";

  ChgPasswdReminder reminder0 = new ChgPasswdReminder();
  RemindSettings settings0=reminder0.getRemindSettings();
  String firmcode0=settings0.getFirmcode();
  String usercode0=settings0.getUsercode();

  int needusb0=user.getNeedusb();
  String usbtype0 = settings0.getUsbType();
  String serial0=user.getSerial();

//\u9650\u5236\u6bcf\u4e2a\u7528\u6237\u53ea\u80fd\u6709\u4e00\u4e2a\u767b\u5165\u7684\u7a97\u53e3
String frommain = Util.null2String(request.getParameter("frommain")) ;

Map logmessages=(Map)application.getAttribute("logmessages");
String a_logmessage="";
if(logmessages!=null)
	a_logmessage=Util.null2String((String)logmessages.get(""+user.getUID()));

String s_logmessage=Util.null2String((String)session.getAttribute("logmessage"));


//TD2125 by mackjoe \u89e3\u51b3\u6570\u636e\u4e2d\u5fc3\u767b\u9646\u4e0d\u4e86\u95ee\u9898
if(s_logmessage==null)  s_logmessage="";

String relogin0=Util.null2String(settings0.getRelogin());

String changepwd = (String)session.getAttribute("changepwd");

if(!relogin0.equals("1")&&"yes".equals(changepwd)){
logmessages=(Map)application.getAttribute("logmessages");
logmessages.put(""+user.getUID(),s_logmessage);
if(logmessages!=null)
	a_logmessage=Util.null2String((String)logmessages.get(""+user.getUID()));
}

String layoutStyle = (String)request.getSession(true).getAttribute("layoutStyle");
if(layoutStyle==null) layoutStyle ="";

String rtxFromLogintmp = (String)session.getAttribute("RtxFromLogin");


if("1".equals(user.getLogintype())&&!relogin0.equals("1")&&!fromlogin.equals("yes")&&!frommain.equals("yes")&&!s_logmessage.equals(a_logmessage) && !"true".equals(rtxFromLogintmp)){
	if(layoutStyle.equals("") || !layoutStyle.equals("1")){	//\u5982\u679c\u662f\u5c0f\u7a97\u53e3\u767b\u5f55\uff0c\u5219\u4e0d\u5224\u65ad\u662f\u5426\u4e3a\u5f53\u524d\u5de5\u4f5c\u7a97\u53e3


      out.write(_jsp_string6, 0, _jsp_string6.length);
      out.print((SystemEnv.getHtmlLabelName(23274,user.getLanguage())));
      out.write(_jsp_string7, 0, _jsp_string7.length);
      return;}}
      out.write(_jsp_string2, 0, _jsp_string2.length);
      
//\u6d41\u7a0b\u7684\u4e09\u4e2a\u9875\u9762\u9700\u8981\u4f7f\u7528\u9ad8\u7248\u672c\u7684jQuery
if (request.getRequestURI().indexOf("/workflow/request/") != -1 &&
        (request.getRequestURI().indexOf("/workflow/request/ManageRequestNoForm") != -1 
                || request.getRequestURI().indexOf("/workflow/request/ViewRequestIframe.jsp") != -1
                || request.getRequestURI().indexOf("/workflow/request/RemarkFrame.jsp") != -1)) {

      out.write(_jsp_string8, 0, _jsp_string8.length);
      
} else {

      out.write(_jsp_string9, 0, _jsp_string9.length);
      
}

      out.write(_jsp_string10, 0, _jsp_string10.length);
      
//\u6a21\u677f\u6a21\u5f0f\u5bfc\u5165
if ((request.getRequestURI().indexOf("/workflow/") != -1 && request.getRequestURI().indexOf("mode") != -1)
        || request.getRequestURI().indexOf("/workflow/request/AddRequest") != -1) {
        
      out.write(_jsp_string11, 0, _jsp_string11.length);
      
}

      out.write(_jsp_string12, 0, _jsp_string12.length);
      out.print((user.getLanguage()));
      out.write(_jsp_string13, 0, _jsp_string13.length);
      out.print((request.getSession().getId()));
      out.write(_jsp_string14, 0, _jsp_string14.length);
      out.print((SystemEnv.getHtmlLabelName(21403,user.getLanguage())));
      out.write(_jsp_string15, 0, _jsp_string15.length);
      out.print((SystemEnv.getHtmlLabelName(21791,user.getLanguage())));
      out.write(_jsp_string16, 0, _jsp_string16.length);
      out.print((SystemEnv.getHtmlLabelNames("17480",user.getLanguage())));
      out.write(_jsp_string17, 0, _jsp_string17.length);
      out.print((SystemEnv.getHtmlLabelNames("25484,83",user.getLanguage())));
      out.write(_jsp_string18, 0, _jsp_string18.length);
      out.print((user.getUID()));
      out.write(_jsp_string19, 0, _jsp_string19.length);
      out.print((user.getUID()));
      out.write(_jsp_string20, 0, _jsp_string20.length);
      out.print((user.getType()));
      out.write(_jsp_string21, 0, _jsp_string21.length);
      out.print((SystemEnv.getHtmlLabelName(26263,user.getLanguage())));
      out.write(_jsp_string22, 0, _jsp_string22.length);
      out.print((URLEncoder.encode(user.getLoginid())));
      out.write(_jsp_string23, 0, _jsp_string23.length);
      out.print((SystemEnv.getHtmlLabelName(21403,user.getLanguage())));
      out.write(_jsp_string24, 0, _jsp_string24.length);
      out.print((SystemEnv.getHtmlLabelName(23670,user.getLanguage())));
      out.write(_jsp_string25, 0, _jsp_string25.length);
      out.print((SystemEnv.getHtmlLabelName(21791,user.getLanguage())));
      out.write(_jsp_string26, 0, _jsp_string26.length);
      if(new weaver.conn.RecordSet().getDBType().equals("oracle")){
      out.write(_jsp_string27, 0, _jsp_string27.length);
      out.print((SystemEnv.getHtmlLabelName(524,user.getLanguage())));
      out.print((SystemEnv.getHtmlLabelName(698,user.getLanguage())));
      out.write(_jsp_string28, 0, _jsp_string28.length);
      out.print((SystemEnv.getHtmlLabelName(20246,user.getLanguage())));
      out.write(_jsp_string28, 0, _jsp_string28.length);
      out.print((SystemEnv.getHtmlLabelName(124962,user.getLanguage())));
      out.write(_jsp_string29, 0, _jsp_string29.length);
      }
      out.write(_jsp_string30, 0, _jsp_string30.length);
      out.print((SystemEnv.getHtmlLabelName(21423,user.getLanguage())));
      out.write(_jsp_string31, 0, _jsp_string31.length);
      out.print((SystemEnv.getHtmlLabelName(21423,user.getLanguage())));
      out.write(_jsp_string32, 0, _jsp_string32.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string33, 0, _jsp_string33.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string34, 0, _jsp_string34.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string33, 0, _jsp_string33.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string35, 0, _jsp_string35.length);
      out.print((SystemEnv.getHtmlLabelName(21423,user.getLanguage())));
      out.write(_jsp_string36, 0, _jsp_string36.length);
      out.print((SystemEnv.getHtmlLabelName(21423,user.getLanguage())));
      out.write(_jsp_string37, 0, _jsp_string37.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string38, 0, _jsp_string38.length);
      out.print((SystemEnv.getHtmlNoteName(14,user.getLanguage())));
      out.write(_jsp_string39, 0, _jsp_string39.length);
      out.print((SystemEnv.getHtmlLabelName(15097,user.getLanguage())));
      out.write(_jsp_string40, 0, _jsp_string40.length);
      out.print((SystemEnv.getHtmlLabelName(22161,user.getLanguage())));
      out.write(_jsp_string41, 0, _jsp_string41.length);
      out.print((companyNametools));
      out.write(_jsp_string42, 0, _jsp_string42.length);
      out.print((SystemEnv.getHtmlLabelName(23714,user.getLanguage())));
      out.write(_jsp_string43, 0, _jsp_string43.length);
      
  if(!fromlogin.equals("yes")&&needusb0==1&&"1".equals(usbtype0)){

      out.write(_jsp_string44, 0, _jsp_string44.length);
      out.print((firmcode0));
      out.write(_jsp_string45, 0, _jsp_string45.length);
      out.print((usercode0));
      out.write(_jsp_string46, 0, _jsp_string46.length);
      out.print((serial0));
      out.write(_jsp_string47, 0, _jsp_string47.length);
      out.print((user.getLanguage()));
      out.write(_jsp_string48, 0, _jsp_string48.length);
      }
      out.write(_jsp_string49, 0, _jsp_string49.length);
      weaver.workflow.workflow.TestWorkflowCheck TestWorkflowCheckInitWui;
      TestWorkflowCheckInitWui = (weaver.workflow.workflow.TestWorkflowCheck) pageContext.getAttribute("TestWorkflowCheckInitWui");
      if (TestWorkflowCheckInitWui == null) {
        TestWorkflowCheckInitWui = new weaver.workflow.workflow.TestWorkflowCheck();
        pageContext.setAttribute("TestWorkflowCheckInitWui", TestWorkflowCheckInitWui);
      }
      out.write(_jsp_string50, 0, _jsp_string50.length);
      out.println(TestWorkflowCheckInitWui.ReloadByDialogClose(request));
      out.write(_jsp_string51, 0, _jsp_string51.length);
      
    if(TestWorkflowCheckInitWui.checkURI(session,request.getRequestURI(),request.getQueryString())){
        response.sendRedirect("/login/Login.jsp");
        return;
    }

      out.write(_jsp_string52, 0, _jsp_string52.length);
      

String curTheme = "ecology7";
//\u5f53\u524d\u76ae\u80a4
String curskin = "";
String cutoverWay = "";
String transitionTime = "";
String transitionWay = "";

HrmUserSettingComInfo instance = new HrmUserSettingComInfo();

String huscifId = String.valueOf(instance.getId(String.valueOf(user.getUID())));

curTheme = getCurrWuiConfig(session, user, "theme");
curskin = getCurrWuiConfig(session, user, "skin");

cutoverWay = instance.getCutoverWay(huscifId);
transitionTime = instance.getTransitionTime(huscifId);
transitionWay = instance.getTransitionWays(huscifId);

      out.write(_jsp_string53, 0, _jsp_string53.length);
      
String ely6flg = "";
if ("ecology6".equals(curTheme.toLowerCase())) {
	curTheme = "ecology7";
	ely6flg = "ecology6";
}

      out.write(_jsp_string54, 0, _jsp_string54.length);
      out.print((curTheme ));
      out.write(_jsp_string55, 0, _jsp_string55.length);
      out.print((curskin ));
      out.write(_jsp_string56, 0, _jsp_string56.length);
      
curTheme = "ecology8";//\u540e\u53f0\u914d\u7f6e\u9875\u9762\u5747\u4e3aE8\u4e3b\u9898\uff0c\u5982\u4f7f\u7528\u5176\u4ed6\u4e3b\u9898\u65f6\uff0c\u4f1a\u5bfc\u81f4\u6837\u5f0f\u6df7\u4e71\u3002\u6240\u4ee5\u6b64\u5904\u4e3b\u9898\u5f3a\u5236\u8d4b\u503cecology8
if("ecology8".equals(curTheme)) curskin="default";
session.setAttribute("SESSION_TEMP_CURRENT_THEME", curTheme);
session.setAttribute("SESSION_TEMP_CURRENT_SKIN", curskin);

      out.write(_jsp_string57, 0, _jsp_string57.length);
      
    if (transitionTime != null && !transitionTime.equals("") && !transitionTime.equals("0")) {

      out.write(_jsp_string58, 0, _jsp_string58.length);
      out.print((cutoverWay ));
      out.write(_jsp_string59, 0, _jsp_string59.length);
      out.print((transitionTime ));
      out.write(_jsp_string60, 0, _jsp_string60.length);
      out.print((transitionWay ));
      out.write(_jsp_string61, 0, _jsp_string61.length);
      
    }

      out.write(_jsp_string62, 0, _jsp_string62.length);
      out.print((curTheme ));
      out.write(_jsp_string63, 0, _jsp_string63.length);
      out.print((curskin ));
      out.write(_jsp_string64, 0, _jsp_string64.length);
      if(!"1".equals(session.getAttribute("istest"))){//\u6d41\u7a0b\u6d4b\u8bd5
      out.write(_jsp_string53, 0, _jsp_string53.length);
      pageContext.include("/synergy/showSynergy.jsp", "requestid=" + com.caucho.el.Expr.toString(Util.getIntValue(request.getParameter("requestid"),-1), null), false);
      out.write(_jsp_string53, 0, _jsp_string53.length);
      }
      out.write(_jsp_string65, 0, _jsp_string65.length);
      weaver.general.BaseBean BaseBean;
      BaseBean = (weaver.general.BaseBean) pageContext.getAttribute("BaseBean");
      if (BaseBean == null) {
        BaseBean = new weaver.general.BaseBean();
        pageContext.setAttribute("BaseBean", BaseBean);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      
	String mServerName="OfficeServer.jsp";
	String mClientName=BaseBean.getPropValue("weaver_obj","iWebOfficeClientName");
    if(mClientName==null||mClientName.trim().equals("")){
		mClientName="iWebOffice2003.ocx#version=6,6,0,0";
	}
	String mClassId=BaseBean.getPropValue("weaver_obj","iWebOfficeClassId");
    if(mClassId==null||mClassId.trim().equals("")){
		mClassId="clsid:23739A7E-5741-4D1C-88D5-D50B18F7C347";
	}
	boolean isIWebOffice2006 = (mClientName.indexOf("iWebOffice2006")>-1||mClientName.indexOf("iWebOffice2009")>-1)?true:false;
	boolean isIWebOffice2003 = (mClientName.indexOf("iWebOffice2003")>-1)?true:false;
	boolean isIWebOffice2009 = (mClientName.indexOf("iWebOffice2009")>-1)?true:false;
    String isHandWriteForIWebOffice2009=BaseBean.getPropValue("weaver_obj","isHandWriteForIWebOffice2009");
	String isNoComment="";
	if(isIWebOffice2006){
		isNoComment="1".equals(isHandWriteForIWebOffice2009)?"false":"true";
	}
    String isUseET=BaseBean.getPropValue("weaver_obj","isUseET");
	boolean  RMMode=("true".equals(BaseBean.getPropValue("weaver_obj","RMMode")))?true:false;

      out.write(_jsp_string2, 0, _jsp_string2.length);
      weaver.general.BaseBean BaseBeanOfPDF417ManagerConf;
      BaseBeanOfPDF417ManagerConf = (weaver.general.BaseBean) pageContext.getAttribute("BaseBeanOfPDF417ManagerConf");
      if (BaseBeanOfPDF417ManagerConf == null) {
        BaseBeanOfPDF417ManagerConf = new weaver.general.BaseBean();
        pageContext.setAttribute("BaseBeanOfPDF417ManagerConf", BaseBeanOfPDF417ManagerConf);
      }
      out.write(_jsp_string2, 0, _jsp_string2.length);
      
//	String PDF417ManagerClientName="PDF417Manager.dll#version=6.0.0.28";
//	String PDF417ManagerClassId="CLSID:8AA64ECD-DFCB-4B88-A2B0-6A5C465D3F15";
//	String PDF417ManagerCopyRight="\u91d1\u683c\u79d1\u6280PDF417\u516c\u6587\u4e8c\u7ef4\u6761\u7801\u4e2d\u95f4\u4ef6[\u6f14\u793a\u7248]www.goldgrid.com";

	String PDF417ManagerClientName=Util.null2String(BaseBeanOfPDF417ManagerConf.getPropValue("weaver_barcode","PDF417ManagerClientName"));
    if(PDF417ManagerClientName==null||PDF417ManagerClientName.trim().equals("")){
		PDF417ManagerClientName="PDF417Manager.dll#version=6,0,0,30";
	}

	String PDF417ManagerClassId=Util.null2String(BaseBeanOfPDF417ManagerConf.getPropValue("weaver_barcode","PDF417ManagerClassId"));
    if(PDF417ManagerClassId==null||PDF417ManagerClassId.trim().equals("")){
		PDF417ManagerClassId="CLSID:8AA64ECD-DFCB-4B88-A2B0-6A5C465D3F15";
	}

	String PDF417ManagerCopyRight=Util.null2String(BaseBeanOfPDF417ManagerConf.getPropValue("weaver_barcode","PDF417ManagerCopyRight"));
	if(!PDF417ManagerCopyRight.trim().equals("")){
		PDF417ManagerCopyRight = (new String(PDF417ManagerCopyRight.getBytes("ISO8859_1"),"UTF-8")) ;
	}
    if(PDF417ManagerCopyRight.trim().equals("")){
		PDF417ManagerCopyRight=SystemEnv.getHtmlLabelName(83415,user.getLanguage());
	}

      out.write(_jsp_string0, 0, _jsp_string0.length);
      	
int isSysadmin=0;
RecordSet rssysadminmenu=new RecordSet();
rssysadminmenu.executeSql("select count(*) from hrmresourcemanager where id="+user.getUID());
if(rssysadminmenu.next()){
 isSysadmin=rssysadminmenu.getInt(1);
}
int RCMenuWidth = 160 ;
int RCMenuHeightStep = 24 ;
int RCMenuHeight = 0 ;
String RCMenu="" ;
String systemAdminMenu = ""; 
int hiddenmenu=1;

String RCFromPage="";    //\u9700\u8981\u5c4f\u853d\u53f3\u952e\u7684\u9875\u9762\u540d\u79f0\uff0c\u7528\u4e8e\u4f7f\u7528RightClickMenu1.jsp\u9700\u8981\u5c4f\u853d\u53f3\u952e\u7684\u9875\u9762
int loadTopMenu = 1;    //\u5173\u95ed\u53f3\u952e\u83dc\u5355\u540e\uff0c\u662f\u5426\u52a0\u8f7d\u5934\u90e8\u64cd\u4f5c\u6309\u94ae\uff1b1-\u52a0\u8f7d\uff0c0-\u4e0d\u52a0\u8f7d\uff0c\u73b0\u5728\u7528\u4e8e\u591a\u90e8\u95e8\u9009\u62e9\u6846\u3002
int defaultMenuCount = 0;

int showColMenuIndex = 0;

systemAdminMenu += "{"+SystemEnv.getHtmlLabelName(32535,user.getLanguage())+",javascript:showColDialog(),_self} " ;
RCMenuHeight += RCMenuHeightStep ;
defaultMenuCount++;

/**
	\u68c0\u6d4b\u7cfb\u7edf\u914d\u7f6e\uff0c\u67e5\u770b\u662f\u5426\u4f7f\u7528\u53f3\u952e\u83dc\u5355\uff0c\u5982\u679c\u4f7f\u7528\u53f3\u952e\u83dc\u5355\uff0c\u662f\u5426\u663e\u793a\u590d\u5236\u548c\u9ecf\u8d34\u7684\u6309\u94ae
*/
BaseBean baseBeanRigthMenu = new BaseBean();
int userightmenu = 1;
int showCopyAndPaste=0;
boolean closeRightMenu = false;
try{
	userightmenu = Util.getIntValue(baseBeanRigthMenu.getPropValue("systemmenu", "userightmenu"), 1);
	if(userightmenu!=1){
		userightmenu = 1;
		closeRightMenu = true;
		
		String reqstrUrl = request.getRequestURL().toString();
		//-------\u8868\u5355\u5efa\u6a21\u90e8\u5206\u53f3\u952e\u83dc\u5355\u7279\u6b8a\u5904\u7406---start-------
		if (reqstrUrl.toLowerCase().indexOf("/formmode/")!=-1||reqstrUrl.toLowerCase().indexOf("/mobilemode/")!=-1) {
			closeRightMenu = false;
			List<String> formmodeViewPageList = new ArrayList<String>();
			formmodeViewPageList.add("/formmode/view/AddFormMode.jsp");
			formmodeViewPageList.add("/formmode/view/AddFormModeIframe.jsp");
			formmodeViewPageList.add("/formmode/interfaces/ModeDataBatchImport.jsp");
			formmodeViewPageList.add("/formmode/search/CustomSearchBySimple.jsp");
			formmodeViewPageList.add("/formmode/search/CustomSearchBySimpleIframe.jsp");
			formmodeViewPageList.add("/formmode/report/ReportConditionIframe.jsp");
			formmodeViewPageList.add("/formmode/report/ReportResult.jsp");
			formmodeViewPageList.add("/formmode/view/ModeShareAddMore.jsp");
			formmodeViewPageList.add("/formmode/view/ModeShareIframe.jsp");
			formmodeViewPageList.add("/formmode/browser/CommonMultiBrowser.jsp");
			formmodeViewPageList.add("/formmode/browser/CommonSingleBrowser.jsp");
			formmodeViewPageList.add("/formmode/tree/treebrowser/CustomTreeBrowser.jsp");
			formmodeViewPageList.add("/formmode/tree/treebrowser/CustomTreeBrowserIframe.jsp");
			formmodeViewPageList.add("/formmode/view/ModeLogView.jsp");
			formmodeViewPageList.add("/formmode/view/ModeLogViewIframe.jsp");
			for(int formmodeListIndexn=0;formmodeListIndexn<formmodeViewPageList.size();formmodeListIndexn++){
				if(reqstrUrl.indexOf(formmodeViewPageList.get(formmodeListIndexn))!=-1){
					closeRightMenu = true;
					break;
				}
			}
		}
		//-------\u8868\u5355\u5efa\u6a21\u90e8\u5206\u53f3\u952e\u83dc\u5355\u7279\u6b8a\u5904\u7406----end--------
	}
    showCopyAndPaste = Util.getIntValue(baseBeanRigthMenu.getPropValue("systemmenucopy", "showCopyAndPaste"), 0);
}catch(Exception e){
	
}

String isIEBrowser = (String)session.getAttribute("browser_isie"); //\u662f\u5426\u4e3aIE\u6d4f\u89c8\u5668
boolean hasSystemAdminMenu = false;
if(userightmenu == 1){
       
    String reqstrUrl = request.getRequestURL().toString();

    if(reqstrUrl.indexOf("/workflow/request/AddRequestIframe.jsp")!=-1
    		||reqstrUrl.indexOf("/workflow/request/ManageRequestNoFormIframe.jsp")!=-1
    		||reqstrUrl.indexOf("/workflow/request/ManageRequestNoFormModeIframe.jsp")!=-1
    		||reqstrUrl.indexOf("/workflow/request/ManageRequestNoFormBillIframe.jsp")!=-1
    		||reqstrUrl.indexOf("/workflow/request/ViewRequestIframe.jsp")!=-1){
		
        systemAdminMenu += "{"+SystemEnv.getHtmlLabelName(28111,user.getLanguage())+",javascript:__openFavouriteBrowser(-9),_self} " ;
    	RCMenuHeight += RCMenuHeightStep ;
    	systemAdminMenu += "{"+SystemEnv.getHtmlLabelName(275,user.getLanguage())+",javascript:parent.showHelp(),_self} " ;
    	RCMenuHeight += RCMenuHeightStep ;
    } else if (reqstrUrl.indexOf("/workflow/")!=-1) {
	    systemAdminMenu += "{"+SystemEnv.getHtmlLabelName(28111,user.getLanguage())+",javascript:__openFavouriteBrowser(),_self} " ;
		RCMenuHeight += RCMenuHeightStep ;
		systemAdminMenu += "{"+SystemEnv.getHtmlLabelName(275,user.getLanguage())+",javascript:__showHelp(),_self} " ;
		RCMenuHeight += RCMenuHeightStep ;
    } else {
		if(reqstrUrl.indexOf("/favourite/FavouriteBrowser.jsp") == -1) {    //\u6dfb\u52a0\u6536\u85cf\u5f39\u51fa\u7684\u9875\u9762\uff0c\u4e0d\u663e\u793a\u6536\u85cf\u7684\u6309\u94ae
			systemAdminMenu += "{" + SystemEnv.getHtmlLabelName(28111, user.getLanguage()) + ",javascript:openFavouriteBrowser(),_self} ";
			RCMenuHeight += RCMenuHeightStep;
		}
		systemAdminMenu += "{"+SystemEnv.getHtmlLabelName(275,user.getLanguage())+",javascript:showHelp(),_self} " ;
		RCMenuHeight += RCMenuHeightStep ;
		
    }

	 if(showCopyAndPaste==1&&"true".equals(isIEBrowser)){ //\u975eIE\u6682\u4e0d\u652f\u6301\u7c98\u8d34\u590d\u5236
		hasSystemAdminMenu = true;
		systemAdminMenu	 += "{__splitHR__,__hr__,_self} " ;
		RCMenuHeight += 1;
	    systemAdminMenu += "{"+SystemEnv.getHtmlLabelName(77,user.getLanguage())+"(Ctrl+C),javascript:onRCMenu_copy(),_self} " ;
	    RCMenuHeight += RCMenuHeightStep ;
	    systemAdminMenu += "{"+SystemEnv.getHtmlLabelName(16180,user.getLanguage())+"(Ctrl+V),javascript:onRCMenu_plaster(),_self} " ;
	    RCMenuHeight += RCMenuHeightStep ;
	    defaultMenuCount=defaultMenuCount+2;
		
    }
}


if(isSysadmin>0) {  //\u7528\u7cfb\u7edf\u7ba1\u7406\u5458sysadmin\u767b\u9646\u7cfb\u7edf\u53ef\u67e5\u770b\u9875\u9762\u5730\u5740
	if(!hasSystemAdminMenu){
		systemAdminMenu	 += "{__splitHR__,__hr__,_self} " ;
		RCMenuHeight += 1;
	}
	systemAdminMenu	 += "{"+SystemEnv.getHtmlLabelName(21682,user.getLanguage())+",javascript:viewSourceUrl(),_self} " ;
	RCMenuHeight += RCMenuHeightStep ;
	defaultMenuCount++;
}


      out.write(_jsp_string66, 0, _jsp_string66.length);
      weaver.workflow.request.TexttoPDFManager TexttoPDFManager;
      TexttoPDFManager = (weaver.workflow.request.TexttoPDFManager) pageContext.getAttribute("TexttoPDFManager");
      if (TexttoPDFManager == null) {
        TexttoPDFManager = new weaver.workflow.request.TexttoPDFManager();
        pageContext.setAttribute("TexttoPDFManager", TexttoPDFManager);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.category.MainCategoryComInfo MainCategoryComInfo;
      MainCategoryComInfo = (weaver.docs.category.MainCategoryComInfo) pageContext.getAttribute("MainCategoryComInfo");
      if (MainCategoryComInfo == null) {
        MainCategoryComInfo = new weaver.docs.category.MainCategoryComInfo();
        pageContext.setAttribute("MainCategoryComInfo", MainCategoryComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.category.SecCategoryComInfo SecCategoryComInfo;
      SecCategoryComInfo = (weaver.docs.category.SecCategoryComInfo) pageContext.getAttribute("SecCategoryComInfo");
      if (SecCategoryComInfo == null) {
        SecCategoryComInfo = new weaver.docs.category.SecCategoryComInfo();
        pageContext.setAttribute("SecCategoryComInfo", SecCategoryComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.category.SecCategoryManager SecCategoryManager;
      SecCategoryManager = (weaver.docs.category.SecCategoryManager) pageContext.getAttribute("SecCategoryManager");
      if (SecCategoryManager == null) {
        SecCategoryManager = new weaver.docs.category.SecCategoryManager();
        pageContext.setAttribute("SecCategoryManager", SecCategoryManager);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.category.SubCategoryComInfo SubCategoryComInfo;
      SubCategoryComInfo = (weaver.docs.category.SubCategoryComInfo) pageContext.getAttribute("SubCategoryComInfo");
      if (SubCategoryComInfo == null) {
        SubCategoryComInfo = new weaver.docs.category.SubCategoryComInfo();
        pageContext.setAttribute("SubCategoryComInfo", SubCategoryComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.systeminfo.language.LanguageComInfo LanguageComInfo;
      LanguageComInfo = (weaver.systeminfo.language.LanguageComInfo) pageContext.getAttribute("LanguageComInfo");
      if (LanguageComInfo == null) {
        LanguageComInfo = new weaver.systeminfo.language.LanguageComInfo();
        pageContext.setAttribute("LanguageComInfo", LanguageComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.docs.DocManager DocManager;
      DocManager = (weaver.docs.docs.DocManager) pageContext.getAttribute("DocManager");
      if (DocManager == null) {
        DocManager = new weaver.docs.docs.DocManager();
        pageContext.setAttribute("DocManager", DocManager);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.DocDetailLog DocDetailLog;
      DocDetailLog = (weaver.docs.DocDetailLog) pageContext.getAttribute("DocDetailLog");
      if (DocDetailLog == null) {
        DocDetailLog = new weaver.docs.DocDetailLog();
        pageContext.setAttribute("DocDetailLog", DocDetailLog);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.hrm.company.DepartmentComInfo DepartmentComInfo;
      DepartmentComInfo = (weaver.hrm.company.DepartmentComInfo) pageContext.getAttribute("DepartmentComInfo");
      if (DepartmentComInfo == null) {
        DepartmentComInfo = new weaver.hrm.company.DepartmentComInfo();
        pageContext.setAttribute("DepartmentComInfo", DepartmentComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.hrm.resource.ResourceComInfo ResourceComInfo;
      ResourceComInfo = (weaver.hrm.resource.ResourceComInfo) pageContext.getAttribute("ResourceComInfo");
      if (ResourceComInfo == null) {
        ResourceComInfo = new weaver.hrm.resource.ResourceComInfo();
        pageContext.setAttribute("ResourceComInfo", ResourceComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.crm.Maint.CustomerInfoComInfo CustomerInfoComInfo;
      CustomerInfoComInfo = (weaver.crm.Maint.CustomerInfoComInfo) pageContext.getAttribute("CustomerInfoComInfo");
      if (CustomerInfoComInfo == null) {
        CustomerInfoComInfo = new weaver.crm.Maint.CustomerInfoComInfo();
        pageContext.setAttribute("CustomerInfoComInfo", CustomerInfoComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.proj.Maint.ProjectInfoComInfo ProjectInfoComInfo;
      ProjectInfoComInfo = (weaver.proj.Maint.ProjectInfoComInfo) pageContext.getAttribute("ProjectInfoComInfo");
      if (ProjectInfoComInfo == null) {
        ProjectInfoComInfo = new weaver.proj.Maint.ProjectInfoComInfo();
        pageContext.setAttribute("ProjectInfoComInfo", ProjectInfoComInfo);
      }
      out.write(_jsp_string67, 0, _jsp_string67.length);
      weaver.systeminfo.systemright.CheckUserRight CheckUserRight;
      CheckUserRight = (weaver.systeminfo.systemright.CheckUserRight) pageContext.getAttribute("CheckUserRight");
      if (CheckUserRight == null) {
        CheckUserRight = new weaver.systeminfo.systemright.CheckUserRight();
        pageContext.setAttribute("CheckUserRight", CheckUserRight);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.lgc.asset.AssetComInfo AssetComInfo;
      AssetComInfo = (weaver.lgc.asset.AssetComInfo) pageContext.getAttribute("AssetComInfo");
      if (AssetComInfo == null) {
        AssetComInfo = new weaver.lgc.asset.AssetComInfo();
        pageContext.setAttribute("AssetComInfo", AssetComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.conn.RecordSet RecordSet;
      RecordSet = (weaver.conn.RecordSet) pageContext.getAttribute("RecordSet");
      if (RecordSet == null) {
        RecordSet = new weaver.conn.RecordSet();
        pageContext.setAttribute("RecordSet", RecordSet);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.cpt.capital.CapitalComInfo CapitalComInfo;
      CapitalComInfo = (weaver.cpt.capital.CapitalComInfo) pageContext.getAttribute("CapitalComInfo");
      if (CapitalComInfo == null) {
        CapitalComInfo = new weaver.cpt.capital.CapitalComInfo();
        pageContext.setAttribute("CapitalComInfo", CapitalComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.conn.RecordSet rs;
      rs = (weaver.conn.RecordSet) pageContext.getAttribute("rs");
      if (rs == null) {
        rs = new weaver.conn.RecordSet();
        pageContext.setAttribute("rs", rs);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.senddoc.OpenSendDoc OpenSendDoc;
      OpenSendDoc = (weaver.docs.senddoc.OpenSendDoc) pageContext.getAttribute("OpenSendDoc");
      if (OpenSendDoc == null) {
        OpenSendDoc = new weaver.docs.senddoc.OpenSendDoc();
        pageContext.setAttribute("OpenSendDoc", OpenSendDoc);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.workflow.field.BrowserComInfo BrowserComInfo;
      BrowserComInfo = (weaver.workflow.field.BrowserComInfo) pageContext.getAttribute("BrowserComInfo");
      if (BrowserComInfo == null) {
        BrowserComInfo = new weaver.workflow.field.BrowserComInfo();
        pageContext.setAttribute("BrowserComInfo", BrowserComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.docs.DocUserSelfUtil DocUserSelfUtil;
      DocUserSelfUtil = (weaver.docs.docs.DocUserSelfUtil) pageContext.getAttribute("DocUserSelfUtil");
      if (DocUserSelfUtil == null) {
        DocUserSelfUtil = new weaver.docs.docs.DocUserSelfUtil();
        pageContext.setAttribute("DocUserSelfUtil", DocUserSelfUtil);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.cowork.CoworkDAO CoworkDAO;
      CoworkDAO = (weaver.cowork.CoworkDAO) pageContext.getAttribute("CoworkDAO");
      if (CoworkDAO == null) {
        CoworkDAO = new weaver.cowork.CoworkDAO();
        pageContext.setAttribute("CoworkDAO", CoworkDAO);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.voting.VotingManager VotingManager;
      VotingManager = (weaver.voting.VotingManager) pageContext.getAttribute("VotingManager");
      if (VotingManager == null) {
        VotingManager = new weaver.voting.VotingManager();
        pageContext.setAttribute("VotingManager", VotingManager);
      }
      out.write(_jsp_string68, 0, _jsp_string68.length);
      weaver.docs.docs.DocUtil DocUtil;
      DocUtil = (weaver.docs.docs.DocUtil) pageContext.getAttribute("DocUtil");
      if (DocUtil == null) {
        DocUtil = new weaver.docs.docs.DocUtil();
        pageContext.setAttribute("DocUtil", DocUtil);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.splitepage.operate.SpopForDoc SpopForDoc;
      SpopForDoc = (weaver.splitepage.operate.SpopForDoc) pageContext.getAttribute("SpopForDoc");
      if (SpopForDoc == null) {
        SpopForDoc = new weaver.splitepage.operate.SpopForDoc();
        pageContext.setAttribute("SpopForDoc", SpopForDoc);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.mould.MouldManager MouldManager;
      MouldManager = (weaver.docs.mould.MouldManager) pageContext.getAttribute("MouldManager");
      if (MouldManager == null) {
        MouldManager = new weaver.docs.mould.MouldManager();
        pageContext.setAttribute("MouldManager", MouldManager);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.category.SecCategoryDocPropertiesComInfo SecCategoryDocPropertiesComInfo;
      SecCategoryDocPropertiesComInfo = (weaver.docs.category.SecCategoryDocPropertiesComInfo) pageContext.getAttribute("SecCategoryDocPropertiesComInfo");
      if (SecCategoryDocPropertiesComInfo == null) {
        SecCategoryDocPropertiesComInfo = new weaver.docs.category.SecCategoryDocPropertiesComInfo();
        pageContext.setAttribute("SecCategoryDocPropertiesComInfo", SecCategoryDocPropertiesComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.docs.DocComInfo DocComInfo;
      DocComInfo = (weaver.docs.docs.DocComInfo) pageContext.getAttribute("DocComInfo");
      if (DocComInfo == null) {
        DocComInfo = new weaver.docs.docs.DocComInfo();
        pageContext.setAttribute("DocComInfo", DocComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.mould.DocMouldComInfo DocMouldComInfo;
      DocMouldComInfo = (weaver.docs.mould.DocMouldComInfo) pageContext.getAttribute("DocMouldComInfo");
      if (DocMouldComInfo == null) {
        DocMouldComInfo = new weaver.docs.mould.DocMouldComInfo();
        pageContext.setAttribute("DocMouldComInfo", DocMouldComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.workflow.request.RequestDoc RequestDoc;
      RequestDoc = (weaver.workflow.request.RequestDoc) pageContext.getAttribute("RequestDoc");
      if (RequestDoc == null) {
        RequestDoc = new weaver.workflow.request.RequestDoc();
        pageContext.setAttribute("RequestDoc", RequestDoc);
      }
      out.write(_jsp_string2, 0, _jsp_string2.length);
      weaver.docs.category.DocTreeDocFieldComInfo DocTreeDocFieldComInfo;
      DocTreeDocFieldComInfo = (weaver.docs.category.DocTreeDocFieldComInfo) pageContext.getAttribute("DocTreeDocFieldComInfo");
      if (DocTreeDocFieldComInfo == null) {
        DocTreeDocFieldComInfo = new weaver.docs.category.DocTreeDocFieldComInfo();
        pageContext.setAttribute("DocTreeDocFieldComInfo", DocTreeDocFieldComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.conn.RecordSet rsDummyDoc;
      rsDummyDoc = (weaver.conn.RecordSet) pageContext.getAttribute("rsDummyDoc");
      if (rsDummyDoc == null) {
        rsDummyDoc = new weaver.conn.RecordSet();
        pageContext.setAttribute("rsDummyDoc", rsDummyDoc);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.workflow.request.WFUrgerManager WFUrgerManager;
      WFUrgerManager = (weaver.workflow.request.WFUrgerManager) pageContext.getAttribute("WFUrgerManager");
      if (WFUrgerManager == null) {
        WFUrgerManager = new weaver.workflow.request.WFUrgerManager();
        pageContext.setAttribute("WFUrgerManager", WFUrgerManager);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.workflow.request.RequestAnnexUpload RequestAnnexUpload;
      RequestAnnexUpload = (weaver.workflow.request.RequestAnnexUpload) pageContext.getAttribute("RequestAnnexUpload");
      if (RequestAnnexUpload == null) {
        RequestAnnexUpload = new weaver.workflow.request.RequestAnnexUpload();
        pageContext.setAttribute("RequestAnnexUpload", RequestAnnexUpload);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.workflow.workflow.WorkflowBarCodeSetManager WorkflowBarCodeSetManager;
      WorkflowBarCodeSetManager = (weaver.workflow.workflow.WorkflowBarCodeSetManager) pageContext.getAttribute("WorkflowBarCodeSetManager");
      if (WorkflowBarCodeSetManager == null) {
        WorkflowBarCodeSetManager = new weaver.workflow.workflow.WorkflowBarCodeSetManager();
        pageContext.setAttribute("WorkflowBarCodeSetManager", WorkflowBarCodeSetManager);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.workflow.request.WFLinkInfo WFLinkInfo;
      WFLinkInfo = (weaver.workflow.request.WFLinkInfo) pageContext.getAttribute("WFLinkInfo");
      if (WFLinkInfo == null) {
        WFLinkInfo = new weaver.workflow.request.WFLinkInfo();
        pageContext.setAttribute("WFLinkInfo", WFLinkInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.docmark.DocMark DocMark;
      DocMark = (weaver.docs.docmark.DocMark) pageContext.getAttribute("DocMark");
      if (DocMark == null) {
        DocMark = new weaver.docs.docmark.DocMark();
        pageContext.setAttribute("DocMark", DocMark);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.general.BaseBean BaseBeanOfDocDspExt;
      BaseBeanOfDocDspExt = (weaver.general.BaseBean) pageContext.getAttribute("BaseBeanOfDocDspExt");
      if (BaseBeanOfDocDspExt == null) {
        BaseBeanOfDocDspExt = new weaver.general.BaseBean();
        pageContext.setAttribute("BaseBeanOfDocDspExt", BaseBeanOfDocDspExt);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.meeting.MeetingUtil MeetingUtil;
      MeetingUtil = (weaver.meeting.MeetingUtil) pageContext.getAttribute("MeetingUtil");
      if (MeetingUtil == null) {
        MeetingUtil = new weaver.meeting.MeetingUtil();
        pageContext.setAttribute("MeetingUtil", MeetingUtil);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.docs.DocDsp DocDsp;
      DocDsp = (weaver.docs.docs.DocDsp) pageContext.getAttribute("DocDsp");
      if (DocDsp == null) {
        DocDsp = new weaver.docs.docs.DocDsp();
        pageContext.setAttribute("DocDsp", DocDsp);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.hrm.company.SubCompanyComInfo SubCompanyComInfo;
      SubCompanyComInfo = (weaver.hrm.company.SubCompanyComInfo) pageContext.getAttribute("SubCompanyComInfo");
      if (SubCompanyComInfo == null) {
        SubCompanyComInfo = new weaver.hrm.company.SubCompanyComInfo();
        pageContext.setAttribute("SubCompanyComInfo", SubCompanyComInfo);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.docs.DocImageManager DocImageManager;
      DocImageManager = (weaver.docs.docs.DocImageManager) pageContext.getAttribute("DocImageManager");
      if (DocImageManager == null) {
        DocImageManager = new weaver.docs.docs.DocImageManager();
        pageContext.setAttribute("DocImageManager", DocImageManager);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.worktask.worktask.WTRequestUtil WTRequestUtil;
      WTRequestUtil = (weaver.worktask.worktask.WTRequestUtil) pageContext.getAttribute("WTRequestUtil");
      if (WTRequestUtil == null) {
        WTRequestUtil = new weaver.worktask.worktask.WTRequestUtil();
        pageContext.setAttribute("WTRequestUtil", WTRequestUtil);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.share.ShareManager shareManager;
      shareManager = (weaver.share.ShareManager) pageContext.getAttribute("shareManager");
      if (shareManager == null) {
        shareManager = new weaver.share.ShareManager();
        pageContext.setAttribute("shareManager", shareManager);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.filter.XssUtil xssUtil;
      xssUtil = (weaver.filter.XssUtil) pageContext.getAttribute("xssUtil");
      if (xssUtil == null) {
        xssUtil = new weaver.filter.XssUtil();
        pageContext.setAttribute("xssUtil", xssUtil);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.blog.BlogDao BlogDao;
      BlogDao = (weaver.blog.BlogDao) pageContext.getAttribute("BlogDao");
      if (BlogDao == null) {
        BlogDao = new weaver.blog.BlogDao();
        pageContext.setAttribute("BlogDao", BlogDao);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.WorkPlan.WorkPlanService workplanService;
      workplanService = (weaver.WorkPlan.WorkPlanService) pageContext.getAttribute("workplanService");
      if (workplanService == null) {
        workplanService = new weaver.WorkPlan.WorkPlanService();
        pageContext.setAttribute("workplanService", workplanService);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      weaver.docs.docs.reply.DocReplyManager docReply;
      docReply = (weaver.docs.docs.reply.DocReplyManager) pageContext.getAttribute("docReply");
      if (docReply == null) {
        docReply = new weaver.docs.docs.reply.DocReplyManager();
        pageContext.setAttribute("docReply", docReply);
      }
      out.write(_jsp_string69, 0, _jsp_string69.length);
      //\u5224\u65ad\u91d1\u683c\u63a7\u4ef6\u7684\u7248\u672c	 2003\u8fd8\u662f2006
String canPostil = "";
if(isIWebOffice2006 == true){
	canPostil = ",0";
}
String f_weaver_belongto_userid=request.getParameter("f_weaver_belongto_userid");
String f_weaver_belongto_usertype=request.getParameter("f_weaver_belongto_usertype");
HrmUserSettingComInfo userSetting=new HrmUserSettingComInfo();
String belongtoshow = userSetting.getBelongtoshowByUserId(user.getUID()+""); 
String belongtoids = user.getBelongtoids();
String account_type = user.getAccount_type();
int languageId=user.getLanguage();

int docid = Util.getIntValue(request.getParameter("id"),0);
int meetingid = Util.getIntValue(request.getParameter("meetingid"),0);
int workplanid = Util.getIntValue(request.getParameter("workplanid"),0);
int olddocid=Util.getIntValue(request.getParameter("olddocid"),0);
if(olddocid<1) olddocid=docid;    
//\u8463\u5e73\u6dfb\u52a0 \u4fee\u6539BUG1483 \u539f\u56e0:\u67e5\u770bID=0\u7684\u6587\u6863\uff0c\u7cfb\u7edf\u4f1a\u5c06\u6587\u6863\u5168\u90e8\u5217\u51fa\u6765
if (docid==0){
	out.println(SystemEnv.getHtmlLabelName(19711,languageId));
	return ;
}
//TD.5091\u5224\u65ad\u662f\u5426\u5ba2\u6237
boolean isCustomer = false;
if(user.getLogintype().equals("2")){
    isCustomer = true ;
}
String  formmodeparamsStr = "";
String formmodeflag = Util.null2String(request.getParameter("formmode_authorize"));
Map<String,String> formmodeAuthorizeInfo = new HashMap<String,String>();
if(formmodeflag.equals("formmode_authorize")){
	int modeId = 0;
	int formmodebillId = 0;
	int fieldid = 0;
	int formModeReplyid = 0;
	modeId = Util.getIntValue(request.getParameter("authorizemodeId"),0);
	formmodebillId = Util.getIntValue(request.getParameter("authorizeformmodebillId"),0);
	fieldid = Util.getIntValue(request.getParameter("authorizefieldid"),0);
	formModeReplyid = Util.getIntValue(request.getParameter("authorizeformModeReplyid"),0);
	String fMReplyFName = Util.null2String(request.getParameter("authorizefMReplyFName"));
			
	formmodeparamsStr = "&formmode_authorize="+formmodeflag+"&authorizemodeId="+modeId+"&authorizeformmodebillId="+
        	formmodebillId+"&authorizefieldid="+fieldid+"&authorizeformModeReplyid="+formModeReplyid+"&authorizefMReplyFName="+fMReplyFName;
	ModeRightInfo modeRightInfo = new ModeRightInfo();
	modeRightInfo.setUser(user);
	if(formModeReplyid!=0){
		formmodeAuthorizeInfo = modeRightInfo.isFormModeAuthorize(formmodeflag, modeId, formmodebillId, fieldid, docid, formModeReplyid,fMReplyFName);
	}else{
		formmodeAuthorizeInfo = modeRightInfo.isFormModeAuthorize(formmodeflag, modeId, formmodebillId, fieldid, docid);
	}
}

String fromFlowDoc=Util.null2String(request.getParameter("fromFlowDoc"));  //\u6765\u6e90\u4e8e\u6d41\u7a0b\u5efa\u6587\u6321
boolean isNoTurnWhenHasToPage=Util.null2String(request.getParameter("isNoTurnWhenHasToPage")).equals("true")?true:false;//\u662f\u5426\u6709\u8f6c\u5411\u9875\u9762\u65f6\u4e0d\u8f6c\u5411  \u9ed8\u8ba4\u4e3afalse\uff1a\u5426   \u4e3a\u201ctrue\u201d\u8868\u793a\u4e0d\u8f6c\u5411
boolean  blnOsp = "true".equals(request.getParameter("blnOsp")) ;

String selectedpubmould = Util.null2String(request.getParameter("selectedpubmould")); //\u9009\u62e9\u663e\u793a\u6a21\u7248\u7684ID

//user info
int userid=user.getUID();
String logintype = user.getLogintype();
String username=ResourceComInfo.getResourcename(""+userid);
String userSeclevel = user.getSeclevel();
String userType = ""+user.getType();
String userdepartment = ""+user.getUserDepartment();
String usersubcomany = ""+user.getUserSubCompany1();
int desrequestid = Util.getIntValue(request.getParameter("desrequestid"),0);
int votingId=Util.getIntValue(request.getParameter("votingId"),0);
//\u5224\u65ad\u65b0\u5efa\u7684\u662f\u4e0d\u662f\u4e2a\u4eba\u6587\u6863
boolean isPersonalDoc = false ;
String from =  Util.null2String(request.getParameter("from"));
String fileExtendName =  Util.null2String(request.getParameter("fileExtendName"));
int userCategory= Util.getIntValue(request.getParameter("userCategory"),0);
//\u7b7e\u7ae0\u7c7b\u578b\uff08signatureType\uff091\uff1aWPS\u6df7\u5408\u7b7e\u7ae0\uff1b2\uff1a360\u7b7e\u7ae0\uff1b\u5176\u4ed6\uff0cOffice\u7b7e\u7ae0
String signatureType = Util.null2String(Prop.getPropValue("wps_office_signature","wps_office_signature"));
boolean wps_office_signature=Prop.getPropValue("wps_office_signature","wps_office_signature").equalsIgnoreCase("1");
String wps_version=Util.null2String(Prop.getPropValue("wps_office_signature","wps_version"));
boolean isFromAccessory="true".equals(request.getParameter("isFromAccessory"))?true:false;
boolean openFirstAss="true".equals(request.getParameter("openFirstAss"))?true:false;
boolean hasviewlog="true".equals(request.getParameter("hasviewlog"))?true:false;
if(openFirstAss) isFromAccessory=false;//\u5206\u79bb\u6539\u9020\uff0c\u5982\u679c\u662f\u5355\u9644\u4ef6\u6253\u5f00\uff0c\u5c31\u5c06\u6765\u81ea\u9644\u4ef6\u7f6e\u4e3afalse\uff0c\u907f\u514d\u4e0d\u663e\u793a\u6587\u6863\u7684tab\u9875\u7b49\u4fe1\u606f
int shareparentid= Util.getIntValue(request.getParameter("shareparentid"),0);

if ("personalDoc".equals(from)){
    isPersonalDoc = true ;
}
String temStr = request.getRequestURI();
temStr=temStr.substring(0,temStr.lastIndexOf("/")+1);

String mServerUrl=temStr+mServerName;
String mClientUrl=temStr+mClientName;

int versionId = Util.getIntValue(request.getParameter("versionId"),0);
//\u53d6\u5f97\u6587\u6863\u6570\u636e
String sql1 = "";
if(versionId==0){
    sql1 = "select * from DocImageFile where docid="+docid+" and (isextfile <> '1' or isextfile is null) order by versionId desc";
}else{
    sql1 = "select * from DocImageFile where docid="+docid+" and versionId="+versionId;
}
RecordSet.executeSql(sql1) ;
RecordSet.next();
versionId = Util.getIntValue(RecordSet.getString("versionId"),0);
if(versionId==0){
	RecordSet.executeSql("select * from DocImageFile where docid="+docid+" order by versionId desc") ;
	if(RecordSet.next()){
		versionId = Util.getIntValue(RecordSet.getString("versionId"),0);
	}
}

String filetype=Util.null2String(""+RecordSet.getString("docfiletype"));
String imagefileName=Util.null2String(""+RecordSet.getString("imagefilename"));
String fileExtendName_fl = (imagefileName.isEmpty()||imagefileName.lastIndexOf(".")==-1)?"":imagefileName.substring(imagefileName.lastIndexOf("."));
int requestid=Util.getIntValue(request.getParameter("requestid"),0);
int imagefileId = Util.getIntValue(request.getParameter("imagefileId"),0);
//\u8de8\u6d4f\u89c8\u5668\u76f4\u63a5\u4e0b\u8f7d\u6587\u4ef6\u7528imagefileIdNotIE
int imagefileIdNotIE = imagefileId;
if(imagefileIdNotIE==0){
	imagefileIdNotIE = Util.getIntValue(""+RecordSet.getString("imagefileId"),0);
}
RecordSet.executeSql("select versionid  from DocImageFile where id = (select id from DocImageFile where docid=" + docid + " and versionId=" + versionId + ") order by versionid desc ") ;
RecordSet.next();
boolean islastversion=true;
if(Util.getIntValue(RecordSet.getString("versionId"),0)!= versionId) islastversion=false; //\u53ea\u6709\u6700\u65b0\u7248\u672c\u7684\u9644\u4ef6\u624d\u6709\u7f16\u8f91\u6309\u94ae
int versionCounts2=DocDsp.getVersionCounts(docid,versionId);
boolean  hasOpenEdition=false;
if (versionCounts2>1){
	hasOpenEdition=true;
}
//\u6807\u8bc6\u5f53\u524d\u5b57\u6bb5\u7c7b\u578b\u4e3a\u9644\u4ef6\u4e0a\u4f20\u7c7b\u578b
String isAppendTypeField = Util.null2String(request.getParameter("isAppendTypeField"));
//\u6587\u6863\u4e2d\u5fc3\u7684\u662f\u5426\u6253\u5f00\u9644\u4ef6\u63a7\u5236*/
String isOpenFirstAss = Util.null2String(request.getParameter("isOpenFirstAss"));
//\u5224\u65ad\u662f\u5426\u662fPDF\u6587\u6863/
boolean isPDF = DocDsp.isPDF(docid,imagefileId,Util.getIntValue(isOpenFirstAss,1));
if(imagefileId==0&&Util.getIntValue(filetype,0) != 2) isPDF = false;
int isUseEMessager = 0;
try {
	isUseEMessager = Util.getIntValue(RecordSet.getPropValue("Messager2", "IsUseEMessager"), 0);	
} catch(Exception e){}
int isUseiWebPDF = 0;
try {
	isUseiWebPDF = Util.getIntValue(RecordSet.getPropValue("weaver_iWebPDF", "isUseiWebPDF"), 0);
} catch(Exception e){}
int isUsePDFViewerForIE8 = 0;
try {
	isUsePDFViewerForIE8 = Util.getIntValue(RecordSet.getPropValue("docpreview", "isUsePDFViewerForIE8"), 0);
} catch(Exception e){}
String agent = request.getHeader("user-agent");
boolean isIE8 = (agent.indexOf("MSIE 8.0;") > 0||agent.indexOf("MSIE 7.0") > 0);
if(isPDF&&isUseiWebPDF==1&&"true".equalsIgnoreCase(isIE)){

      out.write(_jsp_string70, 0, _jsp_string70.length);
      out.print((docid));
      out.write(_jsp_string71, 0, _jsp_string71.length);
      out.print((imagefileId));
      out.write(_jsp_string72, 0, _jsp_string72.length);
      out.print((requestid));
      out.write(_jsp_string73, 0, _jsp_string73.length);
      out.print((desrequestid));
      out.write(_jsp_string74, 0, _jsp_string74.length);
      out.print((f_weaver_belongto_userid));
      out.write(_jsp_string20, 0, _jsp_string20.length);
      out.print((f_weaver_belongto_usertype+formmodeparamsStr));
      out.write(_jsp_string75, 0, _jsp_string75.length);
      out.print((meetingid));
      out.write(_jsp_string76, 0, _jsp_string76.length);
      out.print((fromFlowDoc));
      out.write(_jsp_string77, 0, _jsp_string77.length);
      
    return ;
}
else if(isPDF&&isUseiWebPDF==0&&isIE8&&isUsePDFViewerForIE8==1){

      out.write(_jsp_string78, 0, _jsp_string78.length);
      
    return ;
}
if(filetype.equals("3")){
    filetype=".doc";
}else if(filetype.equals("4")){
    filetype=".xls";
}else if(filetype.equals("5")){
    filetype=".ppt";
}else if(filetype.equals("6")){
    filetype=".wps";
}else if(filetype.equals("7")){
    filetype=".docx";
}else if(filetype.equals("8")){
    filetype=".xlsx";
}else if(filetype.equals("9")){
    filetype=".pptx";
}else if(filetype.equals("10")){
    filetype=".et";
}else{
    filetype=fileExtendName_fl;
}

int messageid=Util.getIntValue(request.getParameter("messageid"),0);
String isrequest = Util.null2String(request.getParameter("isrequest"));

char flag=Util.getSeparator() ;
Date newdate = new Date() ;
long datetime = newdate.getTime() ;
Timestamp timestamp = new Timestamp(datetime) ;
String CurrentDate = (timestamp.toString()).substring(0,4) + "-" + (timestamp.toString()).substring(5,7) + "-" +(timestamp.toString()).substring(8,10);
String CurrentTime = (timestamp.toString()).substring(11,13) + ":" + (timestamp.toString()).substring(14,16) + ":" +(timestamp.toString()).substring(17,19);
//int requestid=Util.getIntValue(request.getParameter("requestid"),0);

String requestname="";
int workflowid=0;
int formid=0;
int isbill = -1;
int billid=0;
int nodeid=0;
int currentnodeid=0;
String nodetype="";
String nodeName="";
String ifVersion="0";
boolean hasRightOfViewHisVersion=HrmUserVarify.checkUserRight("DocExt:ViewHisVersion", user);

int hasright=0;
String status="";
int creater=0;
int isremark=0;
int operatortype = 0;
String workflowtype="";
String messageType="";

String docIds="";
String crmIds="";
String hrmIds="";
String prjIds="";
String cptIds="";

String user_fieldid="";
String isreopen="";
String isreject="";
String isend="";

DocManager.resetParameter();
DocManager.setId(docid);
DocManager.getDocInfoById();

String checkOutMessage=Util.null2String(request.getParameter("checkOutMessage"));  //\u5df2\u88ab\u68c0\u51fa\u63d0\u793a\u4fe1\u606f
checkOutMessage=java.net.URLDecoder.decode(checkOutMessage,"UTF-8");
String checkOutMessage_jspinclude=URLEncoder.encode(URLEncoder.encode(checkOutMessage,"UTF-8"),"UTF-8");

//\u6587\u6863\u4fe1\u606f
int maincategory=DocManager.getMaincategory();
int subcategory=DocManager.getSubcategory();
int seccategory=DocManager.getSeccategory();
int doclangurage=DocManager.getDoclangurage();
String docapprovable=DocManager.getDocapprovable();
String docreplyable=SecCategoryComInfo.getSecReplyAbles(""+seccategory);
String isreply=DocManager.getIsreply();
int replydocid=DocManager.getReplydocid();
String docsubject=DocManager.getDocsubject();
docsubject=Util.StringReplace(docsubject,"\"", "&quot;");
String doccontent=DocManager.getDoccontent();
String docpublishtype=DocManager.getDocpublishtype();
int itemid=DocManager.getItemid();
int itemmaincategoryid=DocManager.getItemmaincategoryid();
int hrmresid=DocManager.getHrmresid();
int crmid=DocManager.getCrmid();
int projectid=DocManager.getProjectid();
int financeid=DocManager.getFinanceid();
int doccreaterid=DocManager.getDoccreaterid();
int docdepartmentid=DocManager.getDocdepartmentid();
String doccreatedate=DocManager.getDoccreatedate();
String doccreatetime=DocManager.getDoccreatetime();
int doclastmoduserid=DocManager.getDoclastmoduserid();
String doclastmoddate=DocManager.getDoclastmoddate();
String doclastmodtime=DocManager.getDoclastmodtime();
int docapproveuserid=DocManager.getDocapproveuserid();
String docapprovedate=DocManager.getDocapprovedate();
String docapprovetime=DocManager.getDocapprovetime();
int docarchiveuserid=DocManager.getDocarchiveuserid();
String docarchivedate=DocManager.getDocarchivedate();
String docarchivetime=DocManager.getDocarchivetime();
String docstatus=DocManager.getDocstatus();
String parentids=DocManager.getParentids();
int assetid=DocManager.getAssetid();
int ownerid=DocManager.getOwnerid();
String keyword=DocManager.getKeyword();
int accessorycount=DocManager.getAccessorycount();
int replaydoccount=DocManager.getReplaydoccount();
String usertype=DocManager.getUsertype();
String canCopy=DocManager.getCanCopy();
String docno = DocManager.getDocno();
int replyid = 0 ;

int docvaliduserid = DocManager.getDocValidUserId();
String docvaliddate = DocManager.getDocValidDate();
String docvalidtime = DocManager.getDocValidTime();
int docpubuserid = DocManager.getDocPubUserId();
String docpubdate = DocManager.getDocPubDate();
String docpubtime = DocManager.getDocPubTime();
int docreopenuserid = DocManager.getDocReOpenUserId();
String docreopendate = DocManager.getDocReOpenDate();
String docreopentime = DocManager.getDocReOpenTime();
int docinvaluserid = DocManager.getDocInvalUserId();
String docinvaldate = DocManager.getDocInvalDate();
String docinvaltime = DocManager.getDocInvalTime();
int doccanceluserid = DocManager.getDocCancelUserId();
String doccanceldate = DocManager.getDocCancelDate();
String doccanceltime = DocManager.getDocCancelTime();

String docCode = DocManager.getDocCode();
int docedition = DocManager.getDocEdition();
int doceditionid = DocManager.getDocEditionId();
int ishistory = DocManager.getIsHistory();
int selectedpubmouldid = DocManager.getSelectedPubMouldId();

int maindoc = DocManager.getMainDoc();
int docreadoptercanprint = DocManager.getReadOpterCanPrint();

boolean isTemporaryDoc = false;
String invalidationdate = DocManager.getInvalidationDate();
if(invalidationdate!=null&&!"".equals(invalidationdate))
    isTemporaryDoc = true;

//\u662f\u5426\u56de\u590d\u63d0\u9192
String canRemind=DocManager.getCanRemind();

String checkOutStatus=DocManager.getCheckOutStatus();
int checkOutUserId=DocManager.getCheckOutUserId();
String checkOutUserType=DocManager.getCheckOutUserType();

String docCreaterType = DocManager.getDocCreaterType();//\u6587\u6863\u521b\u5efa\u8005\u7c7b\u578b\uff081:\u5185\u90e8\u7528\u6237  2\uff1a\u5916\u90e8\u7528\u6237\uff09
String docLastModUserType = DocManager.getDocLastModUserType();//\u6587\u6863\u6700\u540e\u4fee\u6539\u8005\u7c7b\u578b\uff081:\u5185\u90e8\u7528\u6237  2\uff1a\u5916\u90e8\u7528\u6237\uff09
String docApproveUserType = DocManager.getDocApproveUserType();//\u6587\u6863\u5ba1\u6279\u8005\u7c7b\u578b\uff081:\u5185\u90e8\u7528\u6237  2\uff1a\u5916\u90e8\u7528\u6237\uff09
String docInvalUserType = DocManager.getDocInvalUserType();//\u5931\u6548\u64cd\u4f5c\u4eba\u7c7b\u578b\uff081:\u5185\u90e8\u7528\u6237  2\uff1a\u5916\u90e8\u7528\u6237\uff09
String docArchiveUserType = DocManager.getDocArchiveUserType();//\u6587\u6863\u5f52\u6863\u8005\u7c7b\u578b\uff081:\u5185\u90e8\u7528\u6237  2\uff1a\u5916\u90e8\u7528\u6237\uff09
String docCancelUserType = DocManager.getDocCancelUserType();//\u4f5c\u5e9f\u64cd\u4f5c\u4eba\u7c7b\u578b\uff081:\u5185\u90e8\u7528\u6237  2\uff1a\u5916\u90e8\u7528\u6237\uff09
String ownerType = DocManager.getOwnerType();//\u6587\u6863\u62e5\u6709\u8005\u7c7b\u578b\uff081:\u5185\u90e8\u7528\u6237  2\uff1a\u5916\u90e8\u7528\u6237\uff09




String hasUsedTemplet=DocManager.getHasUsedTemplet();//\u662f\u5426\u5df2\u7ecf\u5957\u7ea2
int canPrintedNum=DocManager.getCanPrintedNum();//\u53ef\u6253\u5370\u4efd\u6570
int editMouldId=DocManager.getEditMouldId();//\u7f16\u8f91\u6a21\u677fid

String docmain = "";
if(docpublishtype.equals("2")){
    int tmppos = doccontent.indexOf("!@#$%^&*");
	if(tmppos!=-1){
		docmain = doccontent.substring(0,tmppos);
		doccontent = doccontent.substring(tmppos+8,doccontent.length());
	}
}

String docstatusname = DocComInfo.getStatusView(docid,user);

String tmppublishtype="";
if(docpublishtype.equals("2")) tmppublishtype=SystemEnv.getHtmlLabelName(227,user.getLanguage());
else if(docpublishtype.equals("3")) tmppublishtype=SystemEnv.getHtmlLabelName(229,user.getLanguage());
else tmppublishtype=SystemEnv.getHtmlLabelName(58,user.getLanguage());

//\u5b50\u76ee\u5f55\u4fe1\u606f
RecordSet.executeProc("Doc_SecCategory_SelectByID",seccategory+"");
RecordSet.next();
String categoryname=Util.toScreenToEdit(RecordSet.getString("categoryname"),languageId);
String subcategoryid=Util.null2String(""+RecordSet.getString("subcategoryid"));
//String docmouldid=Util.null2String(""+RecordSet.getString("docmouldid"));
String publishable=Util.null2String(""+RecordSet.getString("publishable"));
String replyable=Util.null2String(""+RecordSet.getString("replyable"));
String shareable=Util.null2String(""+RecordSet.getString("shareable"));
String cusertype=Util.null2String(""+RecordSet.getString("cusertype"));
cusertype = cusertype.trim();
String cuserseclevel=Util.null2String(""+RecordSet.getString("cuserseclevel"));
if(cuserseclevel.equals("255")) cuserseclevel="0";
String cdepartmentid1=Util.null2String(""+RecordSet.getString("cdepartmentid1"));
String cdepseclevel1=Util.null2String(""+RecordSet.getString("cdepseclevel1"));
if(cdepseclevel1.equals("255")) cdepseclevel1="0";
String cdepartmentid2=Util.null2String(""+RecordSet.getString("cdepartmentid2"));
String cdepseclevel2=Util.null2String(""+RecordSet.getString("cdepseclevel2"));
if(cdepseclevel2.equals("255")) cdepseclevel2="0";
String croleid1=Util.null2String(""+RecordSet.getString("croleid1"));
String crolelevel1=Util.null2String(""+RecordSet.getString("crolelevel1"));
String croleid2=Util.null2String(""+RecordSet.getString("croleid2"));
String crolelevel2=Util.null2String(""+RecordSet.getString("crolelevel2"));
String croleid3=Util.null2String(""+RecordSet.getString("croleid3"));
String crolelevel3=Util.null2String(""+RecordSet.getString("crolelevel3"));
String approvewfid=RecordSet.getString("approveworkflowid");
String iscopycontrol=Util.null2String(""+RecordSet.getString("defaultLockedDoc"));
String needapprovecheck="";
if(approvewfid.equals(""))  approvewfid="0";
if(approvewfid.equals("0")) needapprovecheck="0";
else needapprovecheck="1";

String hasaccessory =Util.toScreen(RecordSet.getString("hasaccessory"),languageId);
int accessorynum = Util.getIntValue(RecordSet.getString("accessorynum"),languageId);
String approvercanedit=Util.toScreen(RecordSet.getString("approvercanedit"),languageId);
int defaultDocLocked = Util.getIntValue(RecordSet.getString("defaultLockedDoc"),0);
String isSetShare=Util.null2String(""+RecordSet.getString("isSetShare"));
int relationable=Util.getIntValue(""+RecordSet.getString("relationable"),0);
String readCount = " ";

String topage= URLEncoder.encode("/docs/docs/DocDsp.jsp?id="+docid + "&fromFlowDoc="+fromFlowDoc);
if(workplanid>0){
	topage= URLEncoder.encode("/docs/docs/DocDsp.jsp?id="+docid+"&workplanid="+workplanid);
}
if(meetingid>0){
	topage= URLEncoder.encode("/docs/docs/DocDsp.jsp?id="+docid+"&meetingid="+meetingid);
}
boolean canDownload = (Util.getIntValue(RecordSet.getString("nodownload"),0)==0)?true:false;
int categoryreadoptercanprint = Util.getIntValue(RecordSet.getString("readoptercanprint"),0);

String isOpenApproveWf=Util.null2String(RecordSet.getString("isOpenApproveWf"));

String readerCanViewHistoryEdition=Util.null2String(RecordSet.getString("readerCanViewHistoryEdition"));

int appointedWorkflowId = Util.getIntValue(RecordSet.getString("appointedWorkflowId"),0);

int maxOfficeDocFileSize = Util.getIntValue(RecordSet.getString("maxOfficeDocFileSize"),8);

int isAutoExtendInfo = Util.getIntValue(RecordSet.getString("isAutoExtendInfo"),0);

boolean isEditionOpen = SecCategoryComInfo.isEditionOpen(seccategory);
String isTextInForm = Util.null2String(request.getParameter("isTextInForm"));

//\u6253\u5370\u7533\u8bf7
boolean canPrintApply=false;
String isagentOfprintApply="0";
String isPrintControl=Util.null2String(RecordSet.getString("isPrintControl"));
int printApplyWorkflowId = Util.getIntValue(RecordSet.getString("printApplyWorkflowId"),0);
		if(printApplyWorkflowId>0){

		    //\u5224\u65ad\u662f\u5426\u6709\u6d41\u7a0b\u521b\u5efa\u6743\u9650
			canPrintApply = shareManager.hasWfCreatePermission(user, printApplyWorkflowId);

            if(!canPrintApply){
				String begindate="";
				String begintime="";
				String enddate="";
				String endtime="";
				int beagenterid=0;
				RecordSet.executeSql("select distinct workflowid,bagentuid,begindate,begintime,enddate,endtime from workflow_agentConditionSet where workflowid="+printApplyWorkflowId+" and agenttype>'0' and iscreateagenter=1 and agentuid="+userid);
				while(RecordSet.next()&&!canPrintApply){
					begindate=Util.null2String(RecordSet.getString("begindate"));
					begintime=Util.null2String(RecordSet.getString("begintime"));
					enddate=Util.null2String(RecordSet.getString("enddate"));
					endtime=Util.null2String(RecordSet.getString("endtime"));
					beagenterid=Util.getIntValue(RecordSet.getString("bagentuid"),0);

					if(!begindate.equals("")){
						if((begindate+" "+begintime).compareTo(CurrentDate+" "+CurrentTime)>0)
							continue;
					}
					if(!enddate.equals("")){
					    if((enddate+" "+endtime).compareTo(CurrentDate+" "+CurrentTime)<0)
					        continue;
					}

					canPrintApply = shareManager.hasWfCreatePermission(beagenterid, printApplyWorkflowId);
					
					if(canPrintApply){
						isagentOfprintApply="1";
					}
				}
			}
		}

boolean canDoPrintByApply=false;
boolean canDoPrintByDocDetail=false;
boolean hasPrintNode=false;
boolean isPrintNode=false;

String printNodes="";
if(isPrintControl.equals("1")){
	//\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u6709\u7533\u8bf7\u6210\u529f\u7684\u6253\u5370\u4efd\u6570
	String canDoPrintByApplySb = " select 1   from workflow_requestbase a,Bill_DocPrintApply b  where a.requestId=b.requestid    and a.currentNodeType='3'    and b.resourceId="+userid+"   and b.relatedDocId="+docid+"   and printNum>hasPrintNum ";
	RecordSet.executeSql(canDoPrintByApplySb);
	if(RecordSet.next()){
		canDoPrintByApply=true;
	}

	//\u5224\u65ad\u662f\u5426\u6709\u9ed8\u8ba4\u7684\u6253\u5370\u4efd\u6570
	RecordSet.executeSql("select 1 from DocDetail where id="+docid+" and canPrintedNum>hasPrintedNum");
	if(RecordSet.next()){
		canDoPrintByDocDetail=true;
	}
}

boolean isUseTempletNode=false;//\u6765\u81ea\u4e8e\u6d41\u7a0b\u521b\u5efa\u6587\u6863\u65f6,\u5f53\u524d\u8282\u70b9\u662f\u5426\u4e3a\u5957\u7ea2\u8282\u70b9
boolean isSignatureNodes=false;//\u6765\u81ea\u4e8e\u6d41\u7a0b\u521b\u5efa\u6587\u6863\u65f6,\u5f53\u524d\u8282\u70b9\u662f\u5426\u4e3a\u7b7e\u7ae0\u8282\u70b9
boolean isCleanCopyNodes=false;//\u662f\u5426\u6e05\u7a3f\u8282\u70b9
boolean showSignatureAPI=false;//\u9420\u5b2a\u5570\u93c1\ue5f9ignature\u95bb\u3125\u5688PI
boolean isSavePDF=false;//\u95b8\u6b19\u7b91\u9421\u3126\u7a09\u7ee1\u6dd2F
boolean isSaveDecryptPDF=false;//\u95b8\u6b19\u7b91\u9421\u3126\u7a09\u6966\u57ae\u59ce\u940e\u975b\u6449DF
int operationtype=0;
List attachmentList=new ArrayList();
int useTempletNode=0;
String isCompellentMark = "0";//\u662f\u5426\u5fc5\u987b\u663e\u793a\u75d5\u8ff9
String isCancelCheck = "0";//\u662f\u5426\u53d6\u6d88\u5ba1\u9605
String signatureNodes = ""; 
String cleanCopyNodes = "";//\u6e05\u7a3f\u8282\u70b9
boolean isCurrentNode = false;
boolean isCurrentOperator = false;

if(fromFlowDoc.equals("1")){
	nodeid=WFLinkInfo.getCurrentNodeid(requestid,userid,Util.getIntValue(logintype,1));               //\u8282\u70b9id

	RecordSet.executeSql("select id from workflow_currentoperator where  requestid="+requestid+" and nodeid="+nodeid+" and userid="+userid);
	if(RecordSet.next()){
		isCurrentOperator=true;
	}

	RecordSet.executeSql("select workflowId,currentNodeId from workflow_requestbase where requestid="+requestid);
	if(RecordSet.next()){
		workflowid=RecordSet.getInt("workflowid");
		//nodeid=RecordSet.getInt("currentnodeid");
		currentnodeid=RecordSet.getInt("currentnodeid");
	}
	RecordSet.executeSql("select ifVersion from workflow_base where id="+workflowid);
	if(RecordSet.next()){
		ifVersion = Util.null2String(RecordSet.getString("ifVersion"));
	}
	RecordSet.executeSql("select nodeName from workflow_nodebase where id="+nodeid);
	if(RecordSet.next()){
		nodeName = URLEncoder.encode(Util.null2String(RecordSet.getString("nodeName")),"UTF-8");
	}
	//RecordSet.executeSql("select useTempletNode from workflow_createdoc  where workflowId="+workflowid);
	RecordSet.executeSql("select * from workflow_createdoc  where workflowId="+workflowid);
	if(RecordSet.next()){
		useTempletNode=RecordSet.getInt("useTempletNode");
		printNodes=Util.null2String(RecordSet.getString("printNodes"));
		isCompellentMark = Util.null2String(RecordSet.getString("iscompellentmark"));
		isCancelCheck = Util.null2String(RecordSet.getString("iscancelcheck"));
		signatureNodes = Util.null2String(RecordSet.getString("signatureNodes"));
		cleanCopyNodes = Util.null2String(RecordSet.getString("cleanCopyNodes"));

	}
	if("".equals(isCompellentMark)){
		isCompellentMark = "0";
	}
	if("".equals(isCancelCheck)){
		isCancelCheck = "0";
	}
	if(nodeid==useTempletNode&&nodeid>0&&nodeid==currentnodeid&&isCurrentOperator){
		isUseTempletNode=true;
	}

	if(!printNodes.equals("")){
		hasPrintNode=true;
	}
	if((","+printNodes+",").indexOf(","+nodeid+",")>=0&&nodeid>0&&nodeid==currentnodeid&&isCurrentOperator){
		isPrintNode=true;
	}else{
		RecordSet.executeSql("select nodeid from workflow_currentoperator where preisremark in('0','4') and userid="+userid+" and requestid="+requestid);
		while(RecordSet.next()){
			int nodeidTemp = RecordSet.getInt("nodeid");
			if((","+printNodes+",").indexOf(","+nodeidTemp+",")>=0&&nodeidTemp>0){
				isPrintNode=true;
			}
		}
	}
	if((","+signatureNodes+",").indexOf(","+nodeid+",")>=0&&nodeid>0&&nodeid==currentnodeid&&isCurrentOperator){
		isSignatureNodes=true;
	}
	if((","+cleanCopyNodes+",").indexOf(","+nodeid+",")>=0&&nodeid>0&&nodeid==currentnodeid){
		isCleanCopyNodes=true;
	}	
	if(nodeid==currentnodeid&&isCurrentOperator){
		isCurrentNode=true;
	}
		
	if("1".equals(isTextInForm)){
		isUseTempletNode=false;
		isSignatureNodes=false;
	}
	String imagefileIdpdf="";
	rs.executeSql("select imagefileid from docimagefile where docid="+docid+" and  ( isextfile is null or isextfile<>1) and docfiletype=12 order by    imagefileid desc ");
    if(rs.next()&&imagefileId==0){
      imagefileIdpdf=Util.null2String(rs.getString("imagefileid"));
    }
    if(!imagefileIdpdf.equals("")){
        response.sendRedirect("/docs/docs/DocDsp.jsp?id="+docid+"&requestid="+requestid+"&nodeId="+currentnodeid+"&isPrintNode="+isPrintNode+"&isSignatureNodes="+isSignatureNodes+"&from=pdfText&fromFlowDoc=" +fromFlowDoc);
		return ;
    }

	Map  texttoPDFMap=TexttoPDFManager.getTexttoPDFMap(requestid, workflowid, currentnodeid,docid);
	showSignatureAPI="1".equals((String)texttoPDFMap.get("showSignatureAPI"))?true:false;
 	isSavePDF="1".equals((String)texttoPDFMap.get("isSavePDF"))?true:false;
	isSaveDecryptPDF="1".equals((String)texttoPDFMap.get("isSaveDecryptPDF"))?true:false;

}

/***************************\u53d6\u51fa\u6587\u7ae0\u88ab\u9605\u8bfb\u7684\u6b21\u6570*********************************************************/
int readCount_int = 0 ;
String sql_readCount ="select count(id)  from DocDetailLog where operatetype = 0 and docid =" + docid ;
if(!isFromAccessory){
    /**********************\u5411\u9605\u8bfb\u6807\u8bb0\u8868\u4e2d\u63d2\u5165\u9605\u8bfb\u8bb0\u5f55\uff0c\u4fee\u6539\u9605\u8bfb\u6b21\u6570(\u53ea\u6709\u5f53\u6d4f\u89c8\u8005\u4e0d\u662f\u521b\u5efa\u8005\u65f6)********************/
    	if( userid != doccreaterid || !usertype.equals(logintype) ){
    	    sql_readCount ="select count(id)+1  from DocDetailLog where operatetype = 0 and docid =" + docid ;
    	}
    }
rs.execute(sql_readCount);
if(rs.next()) readCount_int = Util.getIntValue(rs.getString(1),0);


//end by mackjoe
String imagefilename = "/images/hdMaintenance_wev8.gif";
String titlename = SystemEnv.getHtmlLabelName(58,user.getLanguage())+":"+docsubject;
String needfav ="1";
String needhelp ="";
String doctitlename=docsubject + "("+SystemEnv.getHtmlLabelName(260,user.getLanguage())+" "+readCount_int +" "+SystemEnv.getHtmlLabelName(18929,user.getLanguage())+ ")";
String webOfficeFileName=docsubject;
if (isFromAccessory){
    doctitlename=imagefileName;
    webOfficeFileName=imagefileName;
}

boolean showReplaceFile=true;
if(isFromAccessory){
	rs.executeSql("select 1 from DocImageFile where docid="+docid+" and id in(select id from DocImageFile where docid="+docid+" and versionId="+versionId+" and isextfile=1) ");
	int versionCounts=rs.getCounts();
	
	int versionnum=0;
	if(versionCounts>1){
		rs.executeSql("select 1 from DocImageFile where docid="+docid+" and id in(select id from DocImageFile where docid="+docid+" and versionId="+versionId+" and isextfile=1) and versionId<="+versionId);
		versionnum=rs.getCounts();
	}
	
	webOfficeFileName="<span style=\"color:gray;\">"+SystemEnv.getHtmlLabelName(156,user.getLanguage())+"</span>"+webOfficeFileName;

	if(versionCounts>1){
		webOfficeFileName +=" (<a href=\"#\" style=\"color:#30B5FF;\" onclick=\"javascript:used4SelectAccVersion("+versionId+")\">V"+versionnum+"</a>)";
	}	
	if(versionCounts!=versionnum&&versionCounts!=1) showReplaceFile=false;
}

doctitlename=Util.stringReplace4DocDspExt(doctitlename);
if(isFromAccessory)
webOfficeFileName=Util.stringReplace4DocDspExt(webOfficeFileName);

if(!isFromAccessory){
	
	String imageFileNameNoPostfix=webOfficeFileName;
	List postfixList=new ArrayList();
	postfixList.add(".doc");
	postfixList.add(".dot");
	postfixList.add(".docx");
	postfixList.add(".xls");	
	postfixList.add(".xlt");
	postfixList.add(".xlw");
	postfixList.add(".xla");
	postfixList.add(".xlsx");
	postfixList.add(".ppt");
	postfixList.add(".pptx");
	postfixList.add(".wps");
	postfixList.add(".pgf");		

	String tempPostfix=null;
	String postfix="";
	for(int i=0;i<postfixList.size();i++){
		tempPostfix=(String)postfixList.get(i)==null?"":(String)postfixList.get(i);			
	    if(imageFileNameNoPostfix.endsWith(tempPostfix)){
		    imageFileNameNoPostfix=imageFileNameNoPostfix.substring(0,imageFileNameNoPostfix.indexOf(tempPostfix));
			postfix=tempPostfix;
	    }
	}

	imageFileNameNoPostfix=Util.StringReplace(imageFileNameNoPostfix,".","\uff0e");
	webOfficeFileName=imageFileNameNoPostfix+postfix;
}

String doc_topage=Util.null2String((String)session.getAttribute("doc_topage"));
String topageFromOther=Util.null2String(request.getParameter("topage"));
if(!"".equals(checkOutMessage)){
	doc_topage="";
	session.removeAttribute("doc_topage");  
}

//\u4ece\u6d41\u7a0b\u8fc7\u6765\u6587\u6863\u76f4\u63a5\u8df3\u8f6c
if(fromFlowDoc.equals("1")){
	//\u6d41\u7a0b\u521b\u5efa\u6587\u6863\u7edf\u4e00\u4e3a\u4e0d\u901a\u8fc7session\u91cc\u7684doc_topage\u4f20\u503c\u3002
	session.removeAttribute("doc_topage");
	doc_topage="";
    if(!topageFromOther.equals("")&&!isNoTurnWhenHasToPage){

	    response.sendRedirect(topageFromOther+"&docfileid=1&docid="+docid); 
	    return ;
    }
}

//TD8562
//\u901a\u8fc7\u9879\u76ee\u5361\u7247\u6216\u4efb\u52a1\u4fe1\u606f\u9875\u9762\u65b0\u5efa\u6587\u6863\uff0c\u63d0\u4ea4\u65f6\u8981\u5f39\u51fa\u5171\u4eab\u8bbe\u7f6e\u9875\u9762\u3002
if (!"".equals(doc_topage)&&doc_topage.indexOf("ViewCoWork.jsp")==-1&&doc_topage.indexOf("coworkview.jsp")==-1&&doc_topage.indexOf("ViewProject.jsp")==-1&&doc_topage.indexOf("/proj/process/DocOperation.jsp")==-1){
    if(!topageFromOther.equals("")){
	    session.removeAttribute("doc_topage");  
	    response.sendRedirect(doc_topage+"&docfileid=1&docid="+docid); 
	    return ;
    }
}else{
	//\u4ece\u534f\u4f5c\u533a\u8fc7\u6765\u6587\u6863\u76f4\u63a5\u8df3\u8f6c
	if(!"".equals(doc_topage)&&(doc_topage.indexOf("coworkview.jsp")>=0||doc_topage.indexOf("ViewCoWork.jsp")>=0)){
		session.removeAttribute("doc_topage");  
		
      out.write(_jsp_string79, 0, _jsp_string79.length);
      out.print((doc_topage));
      out.write(_jsp_string80, 0, _jsp_string80.length);
      out.print((docid));
      out.write(_jsp_string81, 0, _jsp_string81.length);
      
		return ;
	}
}
/***************************\u6743\u9650\u5224\u65ad**************************************************/
//0:\u67e5\u770b  
boolean canReader = false;
//1:\u7f16\u8f91
boolean canEdit = false;
//2:\u5220\u9664
boolean canDel = false;
//3:\u5171\u4eab
boolean canShare = false ;
//4:\u65e5\u5fd7
boolean canViewLog = false;
//5:\u53ef\u4ee5\u56de\u590d
boolean canReplay = false;
//6:\u6253\u5370
boolean canPrint = false;
//7:\u53d1\u5e03
boolean canPublish = false;
//8:\u5931\u6548
boolean canInvalidate = false;
//9:\u5f52\u6863
boolean canArchive = false;
//10:\u4f5c\u5e9f
boolean canCancel = false;
//11:\u91cd\u65b0\u6253\u5f00
boolean canReopen = false;
//\u7b7e\u51fa
boolean canCheckOut = false;
//\u7b7e\u5165
boolean canCheckIn = false;
//\u5f3a\u5236\u7b7e\u5165
boolean canCheckInCompellably =false ;
//\u65b0\u5efa\u5de5\u4f5c\u6d41
boolean cannewworkflow = true;
//TD12005\u4e0d\u53ef\u4e0b\u8f7d
boolean canDownloadFromShare = false;

String sharelevel="";
String userSeclevelCheck = userSeclevel;//TD22220
if("2".equals(logintype)){
	userdepartment="0";
	usersubcomany="0";
	userSeclevel="0";
}

//String userInfo=logintype+"_"+userid+"_"+userSeclevel+"_"+userType+"_"+userdepartment+"_"+usersubcomany;
String userInfo=logintype+"_"+userid+"_"+userSeclevelCheck+"_"+userType+"_"+userdepartment+"_"+usersubcomany;
SpopForDoc.setIscloseMoreSql(true);
ArrayList PdocList = SpopForDoc.getDocOpratePopedom(""+docid,userInfo);

if (((String)PdocList.get(0)).equals("true")) canReader = true ;
if (((String)PdocList.get(1)).equals("true")) canEdit = true ;
if (((String)PdocList.get(2)).equals("true")) canDel = true ;
if (((String)PdocList.get(3)).equals("true")) canShare = true ;
if (((String)PdocList.get(4)).equals("true")) canViewLog = true ;
if (((String)PdocList.get(5)).equals("true")) canDownloadFromShare = true ;//TD12005

if(belongtoshow.equals("1")&&account_type.equals("0")&&!belongtoids.equals("")&&!canReader){//\u6fe1\u509b\u7049\u6d93\u660f\u5904\u9359\u8702\u7b09\u9473\u501f\u5158\u93cc\u30e7\u6e45\u95c5\u5fd4\u6e80\u93b5\u70ac\ue0bc\u7490\ufe40\u5f7f\u9428\u52ec\u6f48\u95c4?
String[] votingshareids=Util.TokenizerString2(belongtoids,",");
	for(int i=0;i<votingshareids.length;i++){
		User user1=new User(Integer.parseInt(votingshareids[i]));			
		String logintype1 = user1.getLogintype();
 		String userSeclevel1 = user1.getSeclevel();
 		String userType1 = ""+user1.getType();
		String userdepartment1 = ""+user1.getUserDepartment();
		String usersubcomany1 = ""+user1.getUserSubCompany1();
		if("2".equals(logintype1)){
			userdepartment1="0";
			usersubcomany1="0";
			userSeclevel1="0";
		}
		String userInfo1=logintype1+"_"+votingshareids[i]+"_"+userSeclevel1+"_"+userType1+"_"+userdepartment1+"_"+usersubcomany1;
		//userInfo=logintype+"_"+votingshareids[i]+"_"+userSeclevelCheck+"_"+userType+"_"+userdepartment+"_"+usersubcomany;	
		PdocList = SpopForDoc.getDocOpratePopedom(""+docid,userInfo1);
		if (((String)PdocList.get(0)).equals("true")&&!canReader) {
			canReader = true ;
            f_weaver_belongto_userid=votingshareids[i];
			user=HrmUserVarify.getUser(request,response,f_weaver_belongto_userid,userType) ;
			userid=Util.getIntValue(votingshareids[i],0);
		}
		if (((String)PdocList.get(1)).equals("true")&&!canEdit) {
			canEdit = true ;
		    f_weaver_belongto_userid=votingshareids[i];
			user=HrmUserVarify.getUser(request,response,f_weaver_belongto_userid,userType) ;
			userid=Util.getIntValue(votingshareids[i],0);
		}
        if (((String)PdocList.get(2)).equals("true")) canDel = true ;
        if (((String)PdocList.get(3)).equals("true")) canShare = true ;
        if (((String)PdocList.get(4)).equals("true")) canViewLog = true ;
        if (((String)PdocList.get(5)).equals("true")) canDownloadFromShare = true ;//TD12005
		
	}
	
}

//\u5bf9\u4e8e\u6b63\u5e38\u72b6\u6001\u7684\u6587\u6863\uff0c\u662f\u5426\u5177\u6709\u67e5\u770b\u6743\u9650
boolean canReaderHis = canReader;
//\u5bf9\u4e8e\u6b63\u5e38\u72b6\u6001\u7684\u6587\u6863\uff0c\u662f\u5426\u5177\u6709\u7f16\u8f91\u6743\u9650
boolean canEditHis = canEdit;

if(canReader && ((!docstatus.equals("7")&&!docstatus.equals("8")) 
                  ||(docstatus.equals("7")&&ishistory==1&&readerCanViewHistoryEdition.equals("1"))
				  )){
    canReader = true;
}else{
    canReader = false;
}
//\u662f\u5426\u53ef\u4ee5\u67e5\u770b\u5386\u53f2\u7248\u672c
//\u5177\u6709\u7f16\u8f91\u6743\u9650\u7684\u7528\u6237\uff0c\u59cb\u7ec8\u53ef\u89c1\u6587\u6863\u7684\u5386\u53f2\u7248\u672c\uff1b
//\u53ef\u4ee5\u8bbe\u7f6e\u5177\u6709\u53ea\u8bfb\u6743\u9650\u7684\u64cd\u4f5c\u4eba\u662f\u5426\u53ef\u89c1\u5386\u53f2\u7248\u672c\uff1b
if(ishistory==1) {
	if(readerCanViewHistoryEdition.equals("1")){
  	    if(canReader && !canEdit) canReader = true;
	} else {
	    if(canReader && !canEdit) canReader = false;
	}
}	
//\u7f16\u8f91\u6743\u9650\u64cd\u4f5c\u8005\u53ef\u67e5\u770b\u6587\u6863\u72b6\u6001\u4e3a\uff1a\u201c\u5ba1\u6279\u201d\u3001\u201c\u5f52\u6863\u201d\u3001\u201c\u5f85\u53d1\u5e03\u201d\u6216\u5386\u53f2\u6587\u6863
if(canEdit && ((docstatus.equals("3") || docstatus.equals("5") || docstatus.equals("6") || docstatus.equals("7")) || ishistory==1)) {
    canReader = true;
}
//\u7f16\u8f91\u6743\u9650\u64cd\u4f5c\u8005\u53ef\u7f16\u8f91\u7684\u6587\u6863\u72b6\u6001\u4e3a\uff1a\u201c\u8349\u7a3f\u201d\u3001\u201c\u751f\u6548\u3001\u6b63\u5e38\u201d\u3001\u201c\u5931\u6548\u201d\u3001\u201c\u6d41\u7a0b\u8349\u7a3f\u201d,\u975e\u5386\u53f2\u6587\u6863
if(canEdit && (docstatus.equals("-1")||docstatus.equals("0") || docstatus.equals("4") || docstatus.equals("1") || docstatus.equals("2") || docstatus.equals("7")|| docstatus.equals("9")) && (ishistory!=1))
  canEdit = true;
else
  canEdit = false;
// \u53ef\u56de\u590d
//liyx \u589e\u52a0\u5f52\u6863\u6587\u6863\u53ef\u56de\u590d\u53ca\u53ef\u67e5\u770b\u56de\u590d\u5217\u8868
if(docreplyable.equals("1") && (docstatus.equals("5") || docstatus.equals("2") || docstatus.equals("1")))
    canReplay = true;
//\u53ef\u6253\u5370
if(canEdit||(categoryreadoptercanprint==1)||(categoryreadoptercanprint==2&&docreadoptercanprint==1))
    canPrint = true;
//\u542f\u7528\u6253\u5370\u63a7\u5236\uff0c\u800c\u6587\u6863\u5df2\u7ecf\u6ca1\u6709\u53ef\u6253\u5370\u4efd\u6570\u65f6\u4e0d\u53ef\u6253\u5370
if(isPrintControl.equals("1")&&(!canDoPrintByDocDetail)){
	canPrint = false;
}

//\u542f\u7528\u6253\u5370\u63a7\u5236\uff0c\u6d41\u7a0b\u521b\u5efa\u6587\u6863\u65f6\u5f53\u524d\u8282\u70b9\u4e0d\u4e3a\u6253\u5370\u8282\u70b9  \u5219\u4e0d\u53ef\u6253\u5370
if(isPrintControl.equals("1")&&fromFlowDoc.equals("1")&&hasPrintNode&&!isPrintNode){
	canPrint = false;
}

if(canDoPrintByApply){
    canPrint = true;
}

//\u542f\u7528\u6253\u5370\u63a7\u5236\u6216\u4e0d\u542f\u7528\u6253\u5370\u63a7\u5236\uff0c\u6d41\u7a0b\u521b\u5efa\u6587\u6863\u65f6\u5f53\u524d\u8282\u70b9\u4e3a\u6253\u5370\u8282\u70b9  \u5219\u53ef\u6253\u5370
if(fromFlowDoc.equals("1")&&isPrintNode){
	canPrint = true;
}

//\u53ef\u53d1\u5e03
if(HrmUserVarify.checkUserRight("DocEdit:Publish",user,docdepartmentid) && docstatus.equals("6") && (ishistory!=1))
  canPublish = true ;
//\u53ef\u5931\u6548
if(HrmUserVarify.checkUserRight("DocEdit:Invalidate",user,docdepartmentid) && (docstatus.equals("1") || docstatus.equals("2")) && (ishistory!=1))
  canInvalidate = true ;
//\u53ef\u5931\u6548  \u6587\u6863\u7f16\u8f91\u6743\u9650\u8005\u53ef\u5bf9\u6587\u6863\u8fdb\u884c\u5931\u6548
if(canEdit && (docstatus.equals("1") || docstatus.equals("2")) && (ishistory!=1)){
	    canInvalidate = true ;
}
//\u53ef\u5f52\u6863
if(HrmUserVarify.checkUserRight("DocEdit:Archive",user,docdepartmentid) && (docstatus.equals("1") || docstatus.equals("2")) && (ishistory!=1))
	canArchive = true ;
//\u53ef\u4f5c\u5e9f
if(HrmUserVarify.checkUserRight("DocEdit:Cancel",user,docdepartmentid) && (docstatus.equals("1") || docstatus.equals("2") || docstatus.equals("5") || docstatus.equals("7")) && (ishistory!=1))
	canCancel = true ;
//\u53ef\u91cd\u65b0\u6253\u5f00
if(HrmUserVarify.checkUserRight("DocEdit:Reopen",user,docdepartmentid) && (docstatus.equals("5") || docstatus.equals("8")) && (ishistory!=1))
  canReopen = true ;

if(canEdit){
  canShare = true;
  canViewLog = true;
}

//\u5bf9\u4efb\u4f55\u72b6\u6001\u7684\u6587\u6863\uff0c\u62e5\u6709\u5b8c\u5168\u63a7\u5236\u6743\u9650\u7684\u64cd\u4f5c\u4eba\u53ef\u5728\u6587\u6863\u9875\u9762\u4e0a\u4ee5\u53f3\u952e\u6309\u94ae\u7684\u5f62\u5f0f\u4f5c\u201c\u5220\u9664\u201d\u64cd\u4f5c\u3002
//\u5bf9\u4efb\u4f55\u72b6\u6001\u7684\u6587\u6863\uff0c\u5982\u6587\u6863\u7ba1\u7406\u5458\u548c\u76ee\u5f55\u7ba1\u7406\u5458\u62e5\u6709\u6587\u6863\u8bfb\u6743\u9650\uff0c\u53ef\u5728\u6587\u6863\u9875\u9762\u4e0a\u4ee5\u53f3\u952e\u6309\u94ae\u7684\u5f62\u5f0f\u4f5c\u201c\u5220\u9664\u201d\u64cd\u4f5c
if(canDel   || HrmUserVarify.checkUserRight("DocEdit:Delete",user,docdepartmentid) ){
	if(docstatus.equals("5")||docstatus.equals("3")||ishistory==1){
        canDel = false;
	}else{
		canDel = true;
	}
}else{
    canDel = false;
}

//\u4ece\u6d41\u7a0b\u8fc7\u6765\u7684\u6587\u6863\uff0c\u5e76\u4e14\u5f53\u524d\u7528\u6237\u5904\u4e8e\u6d41\u7a0b\u5f53\u524d\u64cd\u4f5c\u8005\u4e2d\u3002//\u53ef\u4ee5\u67e5\u770b
if(!canReader&&(isrequest.equals("1")||requestid>0)){
    canReader=WFUrgerManager.OperHaveDocViewRight(requestid,userid,Util.getIntValue(logintype,1),""+docid);
}
//\u4ece\u8ba1\u5212\u4efb\u52a1\u5904\u8fc7\u6765
String fromworktask = Util.getFileidIn(Util.null2String(request.getParameter("fromworktask")));
String operatorid = Util.getFileidIn(Util.null2String(request.getParameter("operatorid")));
if(!canReader&&"1".equals(fromworktask)) {
	canReader=WTRequestUtil.UrgerHaveWorktaskDocViewRight(requestid,userid, docid ,Util.getIntValue(operatorid,0));
}

boolean onlyview=false;

if(!canReader){
	if(
		  ((""+userid).equals(""+doccreaterid)&&logintype.equals(docCreaterType))
	    ||((""+userid).equals(""+ownerid)&&logintype.equals(ownerType))
	  ){
		canReader=true;
	}
}
int isfrommeeting = 0;
boolean noMeetingDocRight = true;
boolean noWorkplangDocRight = true;
if(meetingid>0&&!canReader)
{
	noMeetingDocRight = !MeetingUtil.UrgerHaveMeetingDocViewRight(""+meetingid,user,Util.getIntValue(logintype),""+docid);
	if(!noMeetingDocRight)
	{
		isfrommeeting=1;
	}
}
if(workplanid>0&&!canReader)
{
	noWorkplangDocRight = !workplanService.UrgerHaveWorkplanDocViewRight(""+workplanid,user,Util.getIntValue(logintype),""+docid);
	if(!noWorkplangDocRight)
	{
		isfrommeeting=1;
	}
}

//\u5de5\u4f5c\u5fae\u535a\u70b9\u51fb\u67e5\u770b\u6587\u6863
int blogDiscussid=Util.getIntValue(request.getParameter("blogDiscussid"),0);
if(!canReader&&blogDiscussid!=0){
	//\u5de5\u4f5c\u5fae\u535a\u8bb0\u5f55id
	if(BlogDao.appViewRight("doc",""+userid,docid,blogDiscussid)){	
	      CoworkDAO.shareCoworkRelateddoc(Util.getIntValue(logintype),docid,userid);
	      canReader=true;
	}      
}


//\u8c03\u67e5\u70b9\u51fb\u67e5\u770b\u6587\u6863
if(!canReader&&votingId>0){
	Map parameterMap=new HashMap();
	parameterMap.put("docId",docid);
	parameterMap.put("votingId",votingId);
	parameterMap.put("userId",user.getUID());
	canReader=VotingManager.haveViewVotingDocRight(parameterMap);
	if(canReader) canDownloadFromShare=true;
}

//\u534f\u4f5c\u533a\u70b9\u51fb\u67e5\u770b\u6587\u6863
int isfromcowork=0;
int coworkid=Util.getIntValue(request.getParameter("coworkid"),0);
if(!canReader&&coworkid!=0){
	if(CoworkDAO.haveViewCoworkDocRight(""+userid,""+coworkid,""+docid)) {
	   CoworkDAO.shareCoworkRelateddoc(Util.getIntValue(logintype),docid,userid);
	   isfromcowork=1;
	   canReader=true;
	}
}
//\u8868\u5355\u5efa\u6a21\u5224\u65ad\u5173\u8054\u6388\u6743
if(!canReader){
	if("1".equals(formmodeAuthorizeInfo.get("AuthorizeFlag"))){//\u5982\u679c\u662f\u8868\u5355\u5efa\u6a21\u7684\u5173\u8054\u6388\u6743\uff0c\u90a3\u4e48\u76f4\u63a5\u6709\u67e5\u770b\u6743\u9650
		canReader=true;
	}
}
if(!canReader)  {
	if (!CoworkDAO.haveRightToViewDoc(Integer.toString(userid),Integer.toString(docid))&&noMeetingDocRight){
        if(!WFUrgerManager.OperHaveDocViewRight(requestid,desrequestid,userid,Util.getIntValue(logintype),""+docid) && !WFUrgerManager.getWFShareDesRight(requestid,desrequestid,user,Util.getIntValue(logintype),""+docid) && !WFUrgerManager.getWFChatShareRight(requestid,userid,Util.getIntValue(logintype),""+docid) && !WFUrgerManager.UrgerHaveDocViewRight(requestid,userid,Util.getIntValue(logintype),""+docid) && !WFUrgerManager.getMonitorViewObjRight(requestid,userid,""+docid,"0") && !WFUrgerManager.getWFShareViewObjRight(requestid,user,""+docid,"0") && isfrommeeting==0 && !RequestAnnexUpload.HaveAnnexDocViewRight(requestid,userid,Util.getIntValue(logintype),docid)){
        if(doceditionid>-1&&ishistory==1){
			RecordSet.executeSql(" select id from DocDetail where doceditionid = " + doceditionid + " and ishistory=0 and id<>"+docid+"  order by docedition desc ");
			int newDocId=0;
			if(RecordSet.next()){
				newDocId = Util.getIntValue(RecordSet.getString("id"));
			}
	        if(newDocId!=docid&&newDocId>0){
	
      out.write(_jsp_string82, 0, _jsp_string82.length);
      out.print((SystemEnv.getHtmlLabelName(20300,user.getLanguage())));
      out.print((SystemEnv.getHtmlLabelName(19986,user.getLanguage())));
      out.write(_jsp_string83, 0, _jsp_string83.length);
      out.print((fromFlowDoc));
      out.write(_jsp_string84, 0, _jsp_string84.length);
      out.print((from));
      out.write(_jsp_string85, 0, _jsp_string85.length);
      out.print((userCategory));
      out.write(_jsp_string86, 0, _jsp_string86.length);
      out.print((newDocId));
      out.write(_jsp_string87, 0, _jsp_string87.length);
      out.print((olddocid));
      out.write(_jsp_string88, 0, _jsp_string88.length);
      out.print((isrequest));
      out.write(_jsp_string89, 0, _jsp_string89.length);
      out.print((requestid));
      out.write(_jsp_string90, 0, _jsp_string90.length);
      out.print((blnOsp));
      out.write(_jsp_string91, 0, _jsp_string91.length);
      out.print((URLEncoder.encode(topageFromOther)));
      out.write(_jsp_string75, 0, _jsp_string75.length);
      out.print((meetingid));
      out.write(_jsp_string92, 0, _jsp_string92.length);
      out.print((workplanid+formmodeparamsStr));
      out.write(_jsp_string93, 0, _jsp_string93.length);
      
			return;//TD10386 JS\u8df3\u8f6c\u9700\u8981\u52a0\u5165return\uff0c\u4e0b\u9762\u7684JAVA\u4ee3\u7801\u624d\u4e0d\u4f1a\u6267\u884c
	        }else{
				//response.sendRedirect("/notice/noright.jsp") ;

      out.write(_jsp_string94, 0, _jsp_string94.length);
      
	            return ;
			}
		}else{
	        //response.sendRedirect("/notice/noright.jsp") ;
			

      out.write(_jsp_string94, 0, _jsp_string94.length);
      
	        return ;
		  
		}
        }else{
            onlyview=true;
        }
    } else {
	    canViewLog = true ;
	    cannewworkflow = false;
	}
}
//TD10368 \u628a\u65e5\u5fd7\u8bb0\u5f55\u79fb\u52a8\u5230\u6743\u9650\u5224\u65ad\u7684\u8df3\u8f6c\u4e4b\u540e Start
//TD.5544 \u5224\u65ad\u662f\u5426\u7528\u9644\u4ef6\u6253\u5f00\uff0c\u5982\u679c\u662f\uff0c\u4e0d\u8ba1\u6b21\u6570\u548c\u4e0d\u8bb0\u65e5\u5fd7
if(!isFromAccessory&&!hasviewlog){
/**********************\u5411\u9605\u8bfb\u6807\u8bb0\u8868\u4e2d\u63d2\u5165\u9605\u8bfb\u8bb0\u5f55\uff0c\u4fee\u6539\u9605\u8bfb\u6b21\u6570(\u53ea\u6709\u5f53\u6d4f\u89c8\u8005\u4e0d\u662f\u521b\u5efa\u8005\u65f6)********************/
	if( userid != doccreaterid || !usertype.equals(logintype) ){
		rs.executeProc("docReadTag_AddByUser",""+docid+flag+userid+flag+logintype);  // \u4ed6\u4eba

		DocDetailLog.resetParameter();
		DocDetailLog.setDocId(docid);
		DocDetailLog.setDocSubject(docsubject);
		DocDetailLog.setOperateType("0");
		DocDetailLog.setOperateUserid(user.getUID());
		DocDetailLog.setUsertype(user.getLogintype());
		DocDetailLog.setClientAddress(request.getRemoteAddr());
		DocDetailLog.setDocCreater(doccreaterid);
		DocDetailLog.setDocLogInfo();
	}
}
//TD.5544 end
//TD 10368 End
	//\u6587\u6863\u672a\u7b7e\u51fa\u65f6,\u7f16\u8f91\u6743\u9650\u7684\u7528\u6237\u53ef\u624b\u52a8\u8fdb\u884c\u6587\u6863\u7b7e\u51fa\u64cd\u4f5c
	if(canEdit&&(checkOutStatus==null||(!checkOutStatus.equals("1")&&!checkOutStatus.equals("2")))){
		canCheckOut=true;
        canCheckIn=false;
        canCheckInCompellably=false;
	}
    //\u6587\u6863\u7b7e\u51fa\uff0c\u4e14\u7b7e\u51fa\u4eba\u4e3a\u5f53\u524d\u7528\u6237\uff0c\u5219\u53ef\u8fdb\u884c\u6587\u6863\u7b7e\u5165\u64cd\u4f5c
	if(checkOutStatus!=null&&(checkOutStatus.equals("1")||checkOutStatus.equals("2"))&&checkOutUserId==userid&&checkOutUserType!=	null&&checkOutUserType.equals(logintype)){
		canCheckOut=false;
        canCheckIn=true;
        canCheckInCompellably=false;
	}

	//\u6587\u6863\u7b7e\u51fa\uff0c\u4e14\u7b7e\u51fa\u4eba\u4e0d\u4e3a\u5f53\u524d\u7528\u6237\uff0c\u5f53\u524d\u7528\u6237\u5177\u6709\u6587\u6863\u7ba1\u7406\u5458\u6216\u76ee\u5f55\u7ba1\u7406\u5458\u6743\u9650\uff0c\u5219\u53ef\u8fdb\u884c\u5f3a\u5236\u7b7e\u5165\u64cd\u4f5c
	if(!canCheckIn&&checkOutStatus!=null&&(checkOutStatus.equals("1")||checkOutStatus.equals("2"))&&!(checkOutUserId==userid&&checkOutUserType!=	null&&checkOutUserType.equals(logintype))){

		//\u5224\u65ad\u5f53\u524d\u7528\u6237\u662f\u5426\u662f\u6587\u6863\u7ba1\u7406\u5458\u6216\u76ee\u5f55\u7ba1\u7406\u5458
		boolean isDocAdminOrDirAdmin=false;
		
		if(HrmUserVarify.checkUserRight("DocEdit:Delete",user,docdepartmentid)){
			isDocAdminOrDirAdmin=true;
		}else{
			String userTypeForDirAccess=usertype.equals("1")?"0":"1";//userTypeForDirAccess\uff0c0\uff1a\u5185\u90e8\u7528\u6237\uff0c1\uff1a\u5916\u90e8\u7528\u6237
            RecordSet.executeSql("select 1 from DirAccessControlDetail where  sourcetype=0 and sourceid="+maincategory+" and sharelevel=1  and ((type=0 and content="+user.getUserDepartment()+" and seclevel<="+user.getSeclevel()+") or (type=1 and content in ("+shareManager.getUserAllRoleAndRoleLevel(user.getUID())+") and seclevel<="+user.getSeclevel()+") or (type=3 and seclevel<="+user.getSeclevel()+") or (type=4 and content="+user.getType()+" and seclevel<="+user.getSeclevel()+") or (type=5 and content="+user.getUID()+") or (type=6 and content="+user.getUserSubCompany1()+" and seclevel<="+user.getSeclevel()+"))" );

			if(RecordSet.next()){
				isDocAdminOrDirAdmin=true;
			}else{
				rs.executeSql("select 1 from DirAccessControlDetail where  sourcetype=1 and sourceid="+subcategory+" and sharelevel=1 and ((type=0 and content="+user.getUserDepartment()+" and seclevel<="+user.getSeclevel()+") or (type=1 and content in ("+shareManager.getUserAllRoleAndRoleLevel(user.getUID())+") and seclevel<="+user.getSeclevel()+") or (type=3 and seclevel<="+user.getSeclevel()+") or (type=4 and content="+user.getType()+" and seclevel<="+user.getSeclevel()+") or (type=5 and content="+user.getUID()+") or (type=6 and content="+user.getUserSubCompany1()+" and seclevel<="+user.getSeclevel()+"))" );
				if(rs.next()){
					isDocAdminOrDirAdmin=true;
				}
			}
		}

		if(isDocAdminOrDirAdmin){
			canCheckOut=false;
            canCheckIn=false;
            canCheckInCompellably=true;
		}

	}

	if(canEdit) canDownload = true;
	
    //\u4e0b\u8f7d\u6743\u9650=\u76ee\u5f55\u7684\u4e0b\u8f7d\u6743\u9650&&\u5171\u4eab\u8bbe\u5b9a\u7684\u4e0b\u8f7d\u6743\u9650
    canDownload = canDownloadFromShare && canDownload;//TD12005
    String sysremindurl="/wui/common/page/sysRemind.jsp?labelid=129755";
	if(canDownload){
		sysremindurl="/wui/common/page/sysRemind.jsp?labelid=129755";
	}else{
		sysremindurl="/wui/common/page/sysRemind.jsp?labelid=129757";
	}
/* added by wdl 2006.7.5 TD.4617 \u5957\u7528\u663e\u793a\u6a21\u677f */
boolean isApplyMould = false;
boolean blnRealViewLog=false;
//\u53d6\u5f97\u6a21\u7248\u8bbe\u7f6e
int wordmouldid = 0;
String mouldtext = "";
List selectMouldList = new ArrayList();
int selectMouldType = 0;
int selectDefaultMould = 0;

if(SecCategoryDocPropertiesComInfo.getDocProperties(""+seccategory,"10")&&SecCategoryDocPropertiesComInfo.getVisible().equals("1")&&(!"1".equals(hasUsedTemplet))&&(!fromFlowDoc.equals("1"))){
	
	if(filetype.equals(".doc")||filetype.equals(".wps")){
		String mouldType=".doc".equals(filetype)?"3":"7";
		RecordSet.executeSql("select * from DocSecCategoryMould where secCategoryId = "+seccategory+" and mouldType="+mouldType+" order by id ");
		while(RecordSet.next()){
			String moduleid=RecordSet.getString("mouldId");
			String mType = DocMouldComInfo.getDocMouldType(moduleid);
			String modulebind = RecordSet.getString("mouldBind");
			int isDefault = Util.getIntValue(RecordSet.getString("isDefault"),0);
	
			if(isTemporaryDoc){
			    
				if(Util.getIntValue(modulebind,1)==3){
				    selectMouldType = 3;
				    selectDefaultMould = Util.getIntValue(moduleid);
				    selectMouldList.add(moduleid);
			    } else if(Util.getIntValue(modulebind,1)==1&&isDefault==1){
			        if(selectMouldType==0){
				        selectMouldType = 1;
					    selectDefaultMould = Util.getIntValue(moduleid);
			        }
					selectMouldList.add(moduleid);
			    } else {
			        if(Util.getIntValue(modulebind,1)!=2)
						selectMouldList.add(moduleid);
			    }
				
			} else {
			    
				if(Util.getIntValue(modulebind,1)==2){
				    selectMouldType = 2;
				    selectDefaultMould = Util.getIntValue(moduleid);
				    selectMouldList.add(moduleid);
			    } else if(Util.getIntValue(modulebind,1)==1&&isDefault==1){
			        selectMouldType = 1;
				    selectDefaultMould = Util.getIntValue(moduleid);
					selectMouldList.add(moduleid);
			    } else {
			        if(Util.getIntValue(modulebind,1)!=3)
						selectMouldList.add(moduleid);
			    }
			}
			
		}
		
		if(canPublish && docstatus.equals("6")){
		    if(Util.getIntValue(Util.null2String(selectedpubmould),0)<=0){
				if(selectMouldType>0){
				    wordmouldid = selectDefaultMould;
				}
		    } else {
		        wordmouldid = Util.getIntValue(selectedpubmould);
		    }
		} else {
		    if(Util.getIntValue(Util.null2String(selectedpubmould),0)<=0){
		    	if(selectedpubmouldid<=0){
		    	    if(selectMouldType>0)
		    	        wordmouldid = selectDefaultMould;
		    	} else {
		    	    wordmouldid = selectedpubmouldid;
		    	}
		    } else {
		        wordmouldid = Util.getIntValue(selectedpubmould);
		    }
		}
		
	}
}
if((wordmouldid<=0)&&(!fromFlowDoc.equals("1"))){
    wordmouldid = MouldManager.getDefaultWordMouldId();
}

String viewMouldIdAndSecCategoryId="";
int mouldSecCategoryId=0;

//\u4ee5\u4e0b\u60c5\u51b5\u540c\u65f6\u6ee1\u8db3\uff0c\u5219\u663e\u793a\u6a21\u677f\u53d6\u8def\u5f84\u8bbe\u7f6e\u4e2d\u7684\u663e\u793a\u6a21\u677f
//1\u3001\u6765\u6e90\u4e8e\u6d41\u7a0b\u5efa\u6587\u6321
//2\u3001\u6587\u6863\u6ca1\u6709\u5957\u7ea2\u8fc7
//if(fromFlowDoc.equals("1")&&(!"1".equals(hasUsedTemplet))){
if(fromFlowDoc.equals("1") && isUseTempletNode){
	//wordmouldid=RequestDoc.getViewMouldIdForDocDspExt(requestid,docid);
	viewMouldIdAndSecCategoryId=RequestDoc.getViewMouldIdAndSecCategoryIdForDocDspExt(requestid,docid);
	int indexId=viewMouldIdAndSecCategoryId.indexOf("_");
	wordmouldid=Util.getIntValue(viewMouldIdAndSecCategoryId.substring(0,indexId),0);
	mouldSecCategoryId=Util.getIntValue(viewMouldIdAndSecCategoryId.substring(indexId+1),0);

}

if(wordmouldid!=0&&(filetype.equals(".doc")||filetype.equals(".wps"))&&(!"1".equals(hasUsedTemplet))){
	isApplyMould = true;
}

String owneridname=ResourceComInfo.getResourcename(ownerid+"");
int countNum = 0;
String docMouldName = "";
List countMouldList = new ArrayList();
if(fromFlowDoc.equals("1")){

	RecordSet.executeSql("SELECT distinct docMould.ID,docMould.mouldName FROM DocSecCategoryMould docSecCategoryMould, DocMould docMould,workflow_mould  WHERE docSecCategoryMould.mouldID = docMould.ID AND docSecCategoryMould.mouldType in(3,7) AND docSecCategoryMould.mouldBind = 1 AND docSecCategoryMould.secCategoryID = " + mouldSecCategoryId+" and docSecCategoryMould.mouldID=workflow_mould.mouldid and workflow_mould.seccategory="+mouldSecCategoryId+" and workflow_mould.workflowid="+workflowid+" and workflow_mould.mouldType in(0,1) and workflow_mould.visible=1 and workflow_mould.mouldid in ( select docMouldId from workflow_docshow where flowId="+workflowid+" and fieldid!=-1 and secCategoryId="+mouldSecCategoryId+")  ");//\u83b7\u53d6\u6a21\u677f\u7684\u6570\u91cf


	String wordmID = String.valueOf(wordmouldid);
	while(RecordSet.next()){
        String docMouldID = RecordSet.getString("ID");
		String mode_name = RecordSet.getString("mouldName");
        countMouldList.add(docMouldID);

		if(docMouldID.equals(wordmID)){
		   docMouldName = mode_name;
		}
	}
    countNum = countMouldList.size();
 }
String strSql="select catelogid from DocDummyDetail where docid="+docid;
rsDummyDoc.executeSql(strSql);
String dummyIds="";
while(rsDummyDoc.next()){
	dummyIds+=Util.null2String(rsDummyDoc.getString(1))+",";
}


boolean istoManagePage=false;
if(!onlyview){
    if (!fromFlowDoc.equals("1")) {
	if (!isPersonalDoc){
       if(isrequest.equals("1")){ //\u4ece\u5de5\u4f5c\u6d41\u8fdb\u5165\u7684\u6587\u6863
           hasright = 0 ;        
           if(logintype.equals("1")) operatortype = 0;
           if(logintype.equals("2")) operatortype = 1;
           if(requestid != 0 ) {
               RecordSet.executeProc("workflow_Requestbase_SByID",requestid+"");
               if(RecordSet.next()){
                   workflowid=RecordSet.getInt("workflowid");
                   nodeid=RecordSet.getInt("currentnodeid");
                   nodetype=RecordSet.getString("currentnodetype");
                   requestname=RecordSet.getString("requestname");
                   status=RecordSet.getString("status");
                   creater=RecordSet.getInt("creater");

                   docIds = Util.null2String(RecordSet.getString("docIds"));
                   crmIds = Util.null2String(RecordSet.getString("crmIds"));
                   hrmIds = Util.null2String(RecordSet.getString("hrmIds"));
                   prjIds = Util.null2String(RecordSet.getString("prjIds"));
                   cptIds = Util.null2String(RecordSet.getString("cptIds"));
               }
               RecordSet.executeSql("select isremark from workflow_currentoperator where requestid="+requestid+" and userid="+userid+" and usertype = "+operatortype + " and isremark in ('1','0') " );
               if(RecordSet.next())	{
                   if((RecordSet.getString(1)).equals("0")) hasright=1;
                   else if((RecordSet.getString(1)).equals("1")) isremark=1;
               }
               RecordSet.executeProc("workflow_Nodebase_SelectByID",nodeid+"");
               if(RecordSet.next()){
                   user_fieldid=RecordSet.getString("userids");
                   isreopen=RecordSet.getString("isreopen");
                   isreject=RecordSet.getString("isreject");
                   isend=RecordSet.getString("isend");
               }
               RecordSet.executeSql("select billId from workflow_form where requestid="+requestid);
               if(RecordSet.next()){
					billid = RecordSet.getInt("billId");
               }
               //~~~~~~~~~~~~~~get workflowtype & formid & isbill & messageType~~~~~~~~~~~~~~~~~~~~~
               RecordSet.executeSql("select workflowtype,formid,isbill,messageType from workflow_base where id="+workflowid);
               if(RecordSet.next()){
					workflowtype = RecordSet.getString("workflowtype");
					formid = RecordSet.getInt("formid");
					isbill = RecordSet.getInt("isbill");
					messageType = RecordSet.getString("messageType");
               }
           }
       }
       if(docreplyable.equals("1")&&(docstatus.equals("2")||docstatus.equals("1"))) { 
           replyid = docid; //replyid\u521d\u59cb\u8bbe\u4e3a\u6587\u6863id
           if(isreply.equals("1")) replyid = replydocid; //\u5982\u679c\u662f\u56de\u590d\u7684\u6587\u6863
       }
       if((SecCategoryComInfo.getLogviewtype(seccategory)==1&&HrmUserVarify.checkUserRight("FileLogView:View", user))||(SecCategoryComInfo.getLogviewtype(seccategory)==0)){
           // \u5177\u6709\u7f16\u8f91\u6743\u9650\u7684\u4eba\u90fd\u53ef\u4ee5\u67e5\u770b\u6587\u6863\u7684\u67e5\u770b\u65e5\u5fd7
           if(canViewLog&&logintype.equals("1")){
          	 blnRealViewLog=true;
           }else if(canEdit&&logintype.equals("2")){}
          	 blnRealViewLog=true;
		    }
   }
   } else {
	   //boolean istoManagePage=false;
	   RecordSet.executeProc("workflow_Requestbase_SByID",requestid+"");
	   if(RecordSet.next()){
	   	nodetype=Util.null2String(RecordSet.getString("currentnodetype"));
	   }
	   if(logintype.equals("1")) operatortype = 0;
	   if(logintype.equals("2")) operatortype = 1;

	   RecordSet.executeSql("select isremark from workflow_currentoperator where requestid="+requestid+" and userid="+userid+" and usertype="+operatortype+" order by isremark");
	   while(RecordSet.next())	{
	       isremark = Util.getIntValue(RecordSet.getString("isremark"),-1) ;
	       if( isremark==1||isremark==5 || (isremark==0  && !nodetype.equals("3")) ) {
	         istoManagePage=true;
	         break;
	       }
	   }
   }
}

boolean cantop = false;
int istop = 0;
if(HrmUserVarify.checkUserRight("Document:Top", user)) {
	int detachable=Util.getIntValue(String.valueOf(session.getAttribute("detachable")),0);
	String createidsubcomid = ResourceComInfo.getSubCompanyID(""+doccreaterid);
	if(detachable==1) {
		ArrayList subcompanylist=SubCompanyComInfo.getRightSubCompany(user.getUID(),"Document:Top");
		if(subcompanylist.indexOf(createidsubcomid)!=-1) {
			cantop = true;	
		}
	} else {
		cantop = true;
	}
	if(docstatus.equals("3"))
	{
		cantop = false;
	}
	if(cantop) { }
	String sql = "select istop from docdetail d where d.id="+docid;
	rs.executeSql(sql);
	rs.next();
	//int 
	istop = rs.getInt(1);
	if(istop==1) { }
}

boolean isLocked=false;
if(!isUseTempletNode&&!isSignatureNodes&&(!canEdit&&defaultDocLocked==1)){
	isLocked=true;
}
String isUseBarCodeThisJsp="0";
if(fromFlowDoc.equals("1")){
    String isUseBarCode = Util.null2String(BaseBeanOfDocDspExt.getPropValue("weaver_barcode","ISUSEBARCODE"));
    if(isUseBarCode.equals("1")){
	    //\u5224\u65ad\u662f\u5426\u542f\u7528\u4e8c\u7ef4\u6761\u7801
	    RecordSet.executeSql("select 1 from Workflow_BarCodeSet where workflowId="+workflowid+" and isUse='1'");

	    if(RecordSet.next()){
		    isUseBarCodeThisJsp="1";
	    }
    }
}


if((isUseTempletNode||isSignatureNodes)&&("false".equalsIgnoreCase(isIE))){
			request.setAttribute("labelid","27969");
			request.getRequestDispatcher("/wui/common/page/sysRemind.jsp").forward(request,response);
			return ;
}

String NotIERemind =Util.null2String(BaseBeanOfDocDspExt.getPropValue("docpreview","NotIERemind"));
//String agent = request.getHeader("user-agent");

	if((agent.contains("Firefox")||agent.contains(" Chrome")||agent.contains("Safari") )|| agent.contains("Edge")){
		isIE = "false";
	}
	else{
		isIE = "true";
	}	


//if("false".equals(isIE)){
boolean iframeLoad = false;
if(canEdit){
	iscopycontrol="0";
}
String previewUrl = "/docs/docpreview/main.jsp?iscopycontrol="+iscopycontrol+"&canPrint="+canPrint+"&canDownload="+canDownload+"&imageFileId="+imagefileId+"&docId="+docid+"&versionId="+versionId+"&f_weaver_belongto_userid="+f_weaver_belongto_userid+"&f_weaver_belongto_usertype="+f_weaver_belongto_usertype+"&workplanid="+workplanid+"&requestid="+requestid+"&desrequestid="+desrequestid+""+formmodeparamsStr;
String  loadDspSwfPara=""+user.getUID()+"_"+Util.getIntValue(user.getLogintype(),1)+"_"+docid+"_"+versionId+"_"+imagefileIdNotIE;
session.setAttribute("hasRight_"+loadDspSwfPara,"1");

	String IsUseDocPreview=Util.null2String(RecordSet.getPropValue("docpreview","IsUseDocPreview"));
	String docPreviewType_prop=Util.null2String(RecordSet.getPropValue("docpreview","DocPreviewType"));//\u6587\u6863\u9884\u89c8\u65b9\u5f0f    1\uff1aOpenOffice    2:html

	if(isUseTempletNode||isSignatureNodes){
		IsUseDocPreview="0";
	}
	

	boolean isToDocDspExt = false;
                if(imagefileName.toLowerCase().endsWith("png") || 
                    imagefileName.toLowerCase().endsWith("gif") || 
                    imagefileName.toLowerCase().endsWith("jpg") || 
                    imagefileName.toLowerCase().endsWith("jpeg") || 
                    imagefileName.toLowerCase().endsWith("bmp") ||
					imagefileName.toLowerCase().endsWith("pdf") ||
					imagefileName.toLowerCase().endsWith("html") ||
					imagefileName.toLowerCase().endsWith("htm")) {
		    			isToDocDspExt = true;
				}else if((imagefileName.toLowerCase().endsWith("sql") || 
                    imagefileName.toLowerCase().endsWith("json") || 
                    imagefileName.toLowerCase().endsWith("js") || 
                    imagefileName.toLowerCase().endsWith("css") || 
                    imagefileName.toLowerCase().endsWith("txt") ||
					imagefileName.toLowerCase().endsWith("pdf") ||
					imagefileName.toLowerCase().endsWith("swf") ||
					imagefileName.toLowerCase().endsWith("log"))&&IsUseDocPreview.equals("1")){
		    			isToDocDspExt = true;
				}   
	
boolean isNotOffice=false;
if(!(imagefileName.toLowerCase().endsWith(".doc") || 
	imagefileName.toLowerCase().endsWith(".docx") || 
	imagefileName.toLowerCase().endsWith(".ppt") || 
	imagefileName.toLowerCase().endsWith(".pptx") || 
	imagefileName.toLowerCase().endsWith(".wps") || 
	imagefileName.toLowerCase().endsWith(".xls") || 
	imagefileName.toLowerCase().endsWith(".xlsx"))){
	isNotOffice = true;//\u975eoffice\u6587\u6863\u4e00\u5b9a\u8981\u5f80pdf\u9884\u89c8\u7684\u754c\u9762\u8df3\u8f6c
}	
	
	//\u5f00\u542f\u5728\u7ebf\u9884\u89c8\u7684\u65f6\u5019   
	boolean  sysremindflag=false;
	if(IsUseDocPreview.equals("1")){ 	//\u5982\u679c\u5f00\u542f\u5728\u7ebf\u9884\u89c8
		//response.sendRedirect("/docs/docpreview/main.jsp?docId="+docid+"&versionId="+versionId);
		String IsUseDocPreviewForIE=Util.null2String(RecordSet.getPropValue("docpreview","IsUseDocPreviewForIE"));
		if("false".equals(isIE)||"1".equals(IsUseDocPreviewForIE) || isPDF){//\u6d4f\u89c8\u5668\u975eIE\u6216\u8005IE\u4e0b\u4f7f\u7528\u5728\u7ebf\u9884\u89c8\u6216\u8005\u662fPDF\u6587\u4ef6\u90fd\u8df3\u8f6c\u5230pdf\u9884\u89c8\u754c\u9762
			iframeLoad = true;	//
		}
	}else if((!"false".equalsIgnoreCase(isIE)) && !isNotOffice){//\u6ca1\u5f00\u542f\u5728\u7ebf\u9884\u89c8\u5e76\u4e14\u6d4f\u89c8\u5668\u662fIE\u5e76\u4e14\u662foffice\u6587\u6863\u7684\u65f6\u5019\uff0c\u4e0d\u8df3\u8f6c\u5230pdf\u9884\u89c8\u754c\u9762\uff0c\u76f4\u63a5\u4f7f\u7528\u91d1\u683c\u63d2\u4ef6\u6253\u5f00
		iframeLoad = false;
	}
	else if(!isToDocDspExt ){							//\u975e\u56fe\u7247\u3001html\u3001pdf\u6587\u4ef6\u5728\u6ca1\u5f00\u542f\u5728\u7ebf\u9884\u89c8\u5e76\u4e14\u6d4f\u89c8\u5668\u4e0d\u662fIE\u6216\u8005(\u6d4f\u89c8\u5668\u662fIE\u4f46\u6587\u4ef6\u4e0d\u662foffice\u6587\u4ef6)\u7684\u60c5\u51b5\u90fd\u76f4\u63a5\u6839\u636e\u4e0b\u8f7d\u6743\u9650\u8fdb\u884c\u63d0\u793a
		//response.sendRedirect(sysremindurl);
		sysremindflag = true;
	}

	if(isToDocDspExt){
		iframeLoad = true;
	}

	

      out.write(_jsp_string2, 0, _jsp_string2.length);
      
	int praiseCount_int = 0;
	int isPraise = 0;
	
	PraiseInfo praiseInfo = docReply.getPraiseInfoByDocid(DocManager.getDocid()+"",user.getUID());
	if(praiseInfo.getUsers() != null)
	{
	    praiseCount_int = praiseInfo.getUsers().size();
	    isPraise = praiseInfo.getIsPraise();
	}
	
	List<UserInfo> userInfos = praiseInfo.getUsers();

      out.write(_jsp_string95, 0, _jsp_string95.length);
      if(iframeLoad||defaultDocLocked!=1||isNotOffice){
      out.write(_jsp_string96, 0, _jsp_string96.length);
      out.print((imagefileIdNotIE));
      out.write(_jsp_string97, 0, _jsp_string97.length);
      out.print((requestid));
      out.write(_jsp_string73, 0, _jsp_string73.length);
      out.print((desrequestid));
      out.write(_jsp_string98, 0, _jsp_string98.length);
      out.print((votingId));
      out.write(_jsp_string74, 0, _jsp_string74.length);
      out.print((f_weaver_belongto_userid));
      out.write(_jsp_string20, 0, _jsp_string20.length);
      out.print((f_weaver_belongto_usertype+formmodeparamsStr));
      out.write(_jsp_string99, 0, _jsp_string99.length);
      }else{
      out.write(_jsp_string100, 0, _jsp_string100.length);
      }
      out.write(_jsp_string101, 0, _jsp_string101.length);
      out.print((docid));
      out.write(_jsp_string102, 0, _jsp_string102.length);
      out.print((versionId));
      out.write(_jsp_string103, 0, _jsp_string103.length);
      out.print((webOfficeFileName));
      out.write(_jsp_string104, 0, _jsp_string104.length);
      out.print((  MouldIDConst.getID("doc")));
      out.write(_jsp_string105, 0, _jsp_string105.length);
      out.print(( canReplay ));
      out.write(_jsp_string106, 0, _jsp_string106.length);
      out.print(( DocReplyUtil.isUseNewReply() ));
      out.write(_jsp_string107, 0, _jsp_string107.length);
      out.print(( isPraise ));
      out.write(_jsp_string108, 0, _jsp_string108.length);
      out.print((docid));
      out.write(_jsp_string109, 0, _jsp_string109.length);
      out.print((docid));
      out.write(_jsp_string110, 0, _jsp_string110.length);
      out.print((docid));
      out.write(_jsp_string111, 0, _jsp_string111.length);
      out.print((user.getUID() ));
      out.write(_jsp_string112, 0, _jsp_string112.length);
      out.print((SystemEnv.getHtmlLabelName(32944,user.getLanguage())));
      out.write(_jsp_string113, 0, _jsp_string113.length);
      out.print((SystemEnv.getHtmlLabelName(32944,user.getLanguage())));
      out.write(_jsp_string114, 0, _jsp_string114.length);
      out.print(( user.getUID() ));
      out.write(_jsp_string115, 0, _jsp_string115.length);
      out.print(( user.getUsername() ));
      out.write(_jsp_string116, 0, _jsp_string116.length);
      out.print((user.getUID() ));
      out.write(_jsp_string117, 0, _jsp_string117.length);
      out.print(( user.getUsername() ));
      out.write(_jsp_string118, 0, _jsp_string118.length);
      out.print((user.getUID() ));
      out.write(_jsp_string119, 0, _jsp_string119.length);
      out.print(( user.getUID() ));
      out.write(_jsp_string120, 0, _jsp_string120.length);
      out.print((SystemEnv.getHtmlLabelName(32942,user.getLanguage())));
      out.write(_jsp_string121, 0, _jsp_string121.length);
      out.print((SystemEnv.getHtmlLabelName(32942,user.getLanguage())));
      out.write(_jsp_string122, 0, _jsp_string122.length);
      out.print(( user.getUID() ));
      out.write(_jsp_string123, 0, _jsp_string123.length);
      pageContext.include("/systeminfo/WeaverLangJS.jsp", "languageId=" + com.caucho.el.Expr.toString(user.getLanguage(), null), false);
      out.write(_jsp_string2, 0, _jsp_string2.length);
      

Map<String,Object> menus = null;

Map menuBarMap = new HashMap();
Map[] menuBarToolsMap = new HashMap[]{};
menus = getMenuBars(onlyview, fromFlowDoc, isPersonalDoc, isrequest, canEditHis, docstatus,
		 hasright, languageId, canEdit, canReader, canShare, canDel, docreplyable,
		OpenSendDoc, docid, cannewworkflow, canPublish, canInvalidate,
		 canArchive, canCancel, canReopen, canCheckOut, canCheckIn, canCheckInCompellably,
		 user, docdepartmentid, canPrintApply, canPrint, isPrintControl, isbill, formid,
		 docapprovable, isremark,SecCategoryComInfo, seccategory, canViewLog,
		 logintype, hasRightOfViewHisVersion, isCurrentNode, defaultDocLocked, filetype, canDownload,
		 nodetype, isreply, istoManagePage, isUseTempletNode, wordmouldid, mouldSecCategoryId,
		 isSignatureNodes, cantop, istop, accessorycount,countNum,hasUsedTemplet,RCMenu,RCMenuHeight,RCMenuHeightStep,iframeLoad,isFromAccessory,openFirstAss,isIE,fileExtendName,isToDocDspExt,islastversion,hasOpenEdition,isCustomer,imagefileName,docsubject,isUseEMessager);

RCMenu += (String)menus.get("RCMenu");

RCMenuHeight += (Integer)menus.get("RCMenuHeight");

session.setAttribute("PDF417ManagerCopyRight",PDF417ManagerCopyRight);
session.setAttribute("docMouldName_"+wordmouldid,docMouldName);

      out.write(_jsp_string124, 0, _jsp_string124.length);
      pageContext.include("/docs/docs/DocDspExtLoad.jsp", "f_weaver_belongto_userid=" + com.caucho.el.Expr.toString(f_weaver_belongto_userid, null)+ "&" + "f_weaver_belongto_usertype=" + com.caucho.el.Expr.toString(f_weaver_belongto_usertype, null)+ "&" + "docid=" + com.caucho.el.Expr.toString(docid, null)+ "&" + "isToDocDspExt=" + com.caucho.el.Expr.toString(isToDocDspExt ? 1 : 0, null)+ "&" + "fromFlowDoc=" + com.caucho.el.Expr.toString(fromFlowDoc, null)+ "&" + "iframeLoad=" + com.caucho.el.Expr.toString(iframeLoad, null)+ "&" + "isIWebOffice2006=" + com.caucho.el.Expr.toString((isIWebOffice2006?1:0), null)+ "&" + "requestid=" + com.caucho.el.Expr.toString(requestid, null)+ "&" + "ifVersion=" + com.caucho.el.Expr.toString(ifVersion, null)+ "&" + "isCompellentMark=" + com.caucho.el.Expr.toString(isCompellentMark, null)+ "&" + "canPostil=" + com.caucho.el.Expr.toString(canPostil, null)+ "&" + "isFromAccessory=" + com.caucho.el.Expr.toString(isFromAccessory, null)+ "&" + "isrequest=" + com.caucho.el.Expr.toString(isrequest, null)+ "&" + "hasUsedTemplet=" + com.caucho.el.Expr.toString(hasUsedTemplet, null)+ "&" + "isPrintControl=" + com.caucho.el.Expr.toString(isPrintControl, null)+ "&" + "doccreaterid=" + com.caucho.el.Expr.toString(doccreaterid, null)+ "&" + "userid=" + com.caucho.el.Expr.toString(userid, null)+ "&" + "countNum=" + com.caucho.el.Expr.toString(countNum, null)+ "&" + "isremark=" + com.caucho.el.Expr.toString(isremark, null)+ "&" + "isUseTempletNode=" + com.caucho.el.Expr.toString((isUseTempletNode?1:0), null)+ "&" + "wordmouldid=" + com.caucho.el.Expr.toString(wordmouldid, null)+ "&" + "currentnodeid=" + com.caucho.el.Expr.toString(currentnodeid, null)+ "&" + "versionId=" + com.caucho.el.Expr.toString(versionId, null)+ "&" + "isSignatureNodes=" + com.caucho.el.Expr.toString((isSignatureNodes?1:0), null)+ "&" + "CurrentDate=" + com.caucho.el.Expr.toString(CurrentDate, null)+ "&" + "CurrentTime=" + com.caucho.el.Expr.toString(CurrentTime, null)+ "&" + "workflowid=" + com.caucho.el.Expr.toString(workflowid, null)+ "&" + "PDF417ManagerCopyRight=" + com.caucho.el.Expr.toString(PDF417ManagerCopyRight, null)+ "&" + "appointedWorkflowId=" + com.caucho.el.Expr.toString(appointedWorkflowId, null)+ "&" + "logintype=" + com.caucho.el.Expr.toString(logintype, null)+ "&" + "userSeclevel=" + com.caucho.el.Expr.toString(userSeclevel, null)+ "&" + "userCategory=" + com.caucho.el.Expr.toString(userCategory, null)+ "&" + "from=" + com.caucho.el.Expr.toString(from, null)+ "&" + "topage=" + com.caucho.el.Expr.toString(topage, null)+ "&" + "maxOfficeDocFileSize=" + com.caucho.el.Expr.toString(maxOfficeDocFileSize, null)+ "&" + "isPersonalDoc=" + com.caucho.el.Expr.toString((isPersonalDoc?1:0), null)+ "&" + "onlyview=" + com.caucho.el.Expr.toString((onlyview?1:0), null)+ "&" + "canEdit=" + com.caucho.el.Expr.toString((canEdit?1:0), null)+ "&" + "nodeName=" + com.caucho.el.Expr.toString(nodeName, null)+ "&" + "istoManagePage=" + com.caucho.el.Expr.toString((istoManagePage?1:0), null)+ "&" + "mouldSecCategoryId=" + com.caucho.el.Expr.toString(mouldSecCategoryId, null)+ "&" + "cantop=" + com.caucho.el.Expr.toString((cantop?1:0), null)+ "&" + "istop=" + com.caucho.el.Expr.toString(istop, null)+ "&" + "canEditHis=" + com.caucho.el.Expr.toString((canEditHis?1:0), null)+ "&" + "docstatus=" + com.caucho.el.Expr.toString(docstatus, null)+ "&" + "hasright=" + com.caucho.el.Expr.toString(hasright, null)+ "&" + "languageId=" + com.caucho.el.Expr.toString(languageId, null)+ "&" + "canReader=" + com.caucho.el.Expr.toString((canReader?1:0), null)+ "&" + "canShare=" + com.caucho.el.Expr.toString((canShare?1:0), null)+ "&" + "canDel=" + com.caucho.el.Expr.toString((canDel?1:0), null)+ "&" + "hasOpenEdition=" + com.caucho.el.Expr.toString((hasOpenEdition?1:0), null)+ "&" + "docreplyable=" + com.caucho.el.Expr.toString(docreplyable, null)+ "&" + "cannewworkflow=" + com.caucho.el.Expr.toString((cannewworkflow?1:0), null)+ "&" + "canPublish=" + com.caucho.el.Expr.toString((canPublish?1:0), null)+ "&" + "canInvalidate=" + com.caucho.el.Expr.toString((canInvalidate?1:0), null)+ "&" + "canArchive=" + com.caucho.el.Expr.toString((canArchive?1:0), null)+ "&" + "canCancel=" + com.caucho.el.Expr.toString((canCancel?1:0), null)+ "&" + "canReopen=" + com.caucho.el.Expr.toString((canReopen?1:0), null)+ "&" + "canCheckOut=" + com.caucho.el.Expr.toString((canCheckOut?1:0), null)+ "&" + "canCheckIn=" + com.caucho.el.Expr.toString((canCheckIn?1:0), null)+ "&" + "canCheckInCompellably=" + com.caucho.el.Expr.toString((canCheckInCompellably?1:0), null)+ "&" + "docdepartmentid=" + com.caucho.el.Expr.toString(docdepartmentid, null)+ "&" + "canPrintApply=" + com.caucho.el.Expr.toString((canPrintApply?1:0), null)+ "&" + "canPrint=" + com.caucho.el.Expr.toString((canPrint?1:0), null)+ "&" + "isbill=" + com.caucho.el.Expr.toString(isbill, null)+ "&" + "formid=" + com.caucho.el.Expr.toString(formid, null)+ "&" + "docapprovable=" + com.caucho.el.Expr.toString(docapprovable, null)+ "&" + "seccategory=" + com.caucho.el.Expr.toString(seccategory, null)+ "&" + "canViewLog=" + com.caucho.el.Expr.toString((canViewLog?1:0), null)+ "&" + "hasRightOfViewHisVersion=" + com.caucho.el.Expr.toString((hasRightOfViewHisVersion?1:0), null)+ "&" + "isCurrentNode=" + com.caucho.el.Expr.toString((isCurrentNode?1:0), null)+ "&" + "defaultDocLocked=" + com.caucho.el.Expr.toString(defaultDocLocked, null)+ "&" + "filetype=" + com.caucho.el.Expr.toString(filetype, null)+ "&" + "canDownload=" + com.caucho.el.Expr.toString((canDownload?1:0), null)+ "&" + "nodetype=" + com.caucho.el.Expr.toString(nodetype, null)+ "&" + "isreply=" + com.caucho.el.Expr.toString(isreply, null)+ "&" + "accessorycount=" + com.caucho.el.Expr.toString(accessorycount, null)+ "&" + "mServerUrl=" + com.caucho.el.Expr.toString(mServerUrl, null)+ "&" + "isLocked=" + com.caucho.el.Expr.toString((isLocked?1:0), null)+ "&" + "isCancelCheck=" + com.caucho.el.Expr.toString(isCancelCheck, null)+ "&" + "isApplyMould=" + com.caucho.el.Expr.toString((isApplyMould?1:0), null)+ "&" + "isUseBarCodeThisJsp=" + com.caucho.el.Expr.toString(isUseBarCodeThisJsp, null)+ "&" + "readCountint=" + com.caucho.el.Expr.toString(readCount_int, null)+ "&" + "checkOutMessage=" + com.caucho.el.Expr.toString(checkOutMessage_jspinclude , null)+ "&" + "signatureType=" + com.caucho.el.Expr.toString(signatureType, null)+ "&" + "wps_office_signature=" + com.caucho.el.Expr.toString(wps_office_signature?1:0, null)+ "&" + "openFirstAss=" + com.caucho.el.Expr.toString(openFirstAss , null)+ "&" + "ishistory=" + com.caucho.el.Expr.toString(ishistory , null)+ "&" + "islastversion=" + com.caucho.el.Expr.toString(islastversion?1:0 , null)+ "&" + "showReplaceFile=" + com.caucho.el.Expr.toString(showReplaceFile , null)+ "&" + "fileExtendName=" + com.caucho.el.Expr.toString(fileExtendName , null)+ "&" + "isNotOffice=" + com.caucho.el.Expr.toString(isNotOffice , null)+ "&" + "isTextInForm=" + com.caucho.el.Expr.toString(isTextInForm , null), true);
      out.write(_jsp_string125, 0, _jsp_string125.length);
      _jsp_BrowserTag_0 = new weaver.common.util.taglib.BrowserTag();
      _jsp_BrowserTag_0.setJspContext(pageContext);
      _jsp_BrowserTag_0.setName("_selectAccVersionBtn");
      _jsp_BrowserTag_0.setViewType("0");
      _jsp_BrowserTag_0.setDisplay("none");
      _jsp_BrowserTag_0.setBrowserBtnID("selectAccVersionBtn");
      _jsp_BrowserTag_0.setGetBrowserUrlFn("getBrowserUrl4selectAccVersion");
      _jsp_BrowserTag_0.setIsMustInput("1");
      _jsp_BrowserTag_0.set_callback("afterSelectAccVersion");
      _jsp_BrowserTag_0.doTag();
      out.write(_jsp_string126, 0, _jsp_string126.length);
      out.print((topage));
      out.write(_jsp_string127, 0, _jsp_string127.length);
      out.print((docid));
      out.write(_jsp_string128, 0, _jsp_string128.length);
      out.print((docid));
      out.write(_jsp_string129, 0, _jsp_string129.length);
      out.print((docsubject));
      out.write(_jsp_string130, 0, _jsp_string130.length);
      out.print((doccreaterid));
      out.write(_jsp_string131, 0, _jsp_string131.length);
      out.print((xssUtil.put("where docid="+docid)));
      out.write(_jsp_string132, 0, _jsp_string132.length);
      out.print((fromFlowDoc));
      out.write(_jsp_string133, 0, _jsp_string133.length);
      out.print((workflowid));
      out.write(_jsp_string134, 0, _jsp_string134.length);
      
  DesUtil desUtil=new DesUtil();

      out.write(_jsp_string135, 0, _jsp_string135.length);
      out.print((docid));
      out.write(_jsp_string136, 0, _jsp_string136.length);
      out.print((filetype));
      out.write(_jsp_string137, 0, _jsp_string137.length);
      out.print((filetype));
      out.write(_jsp_string138, 0, _jsp_string138.length);
      out.print((filetype));
      out.write(_jsp_string139, 0, _jsp_string139.length);
      out.print((filetype));
      out.write(_jsp_string140, 0, _jsp_string140.length);
      out.print((filetype));
      out.write(_jsp_string141, 0, _jsp_string141.length);
      out.print((filetype));
      out.write(_jsp_string142, 0, _jsp_string142.length);
      out.print((filetype));
      out.write(_jsp_string143, 0, _jsp_string143.length);
      out.print((filetype.isEmpty()?".*":filetype));
      out.write(_jsp_string144, 0, _jsp_string144.length);
      out.print((desUtil.encrypt(user.getUID()+"")));
      out.write(_jsp_string145, 0, _jsp_string145.length);
      out.print((user.getLogintype()));
      out.write(_jsp_string146, 0, _jsp_string146.length);
      out.print((versionId));
      out.write(_jsp_string147, 0, _jsp_string147.length);
      out.print((filetype));
      out.write(_jsp_string148, 0, _jsp_string148.length);
      out.print((SystemEnv.getHtmlLabelName(82775,user.getLanguage())));
      out.write(_jsp_string149, 0, _jsp_string149.length);
      out.print((openFirstAss));
      out.write(_jsp_string150, 0, _jsp_string150.length);
      out.print((isrequest));
      out.write(_jsp_string89, 0, _jsp_string89.length);
      out.print((requestid));
      out.write(_jsp_string73, 0, _jsp_string73.length);
      out.print((desrequestid));
      out.write(_jsp_string74, 0, _jsp_string74.length);
      out.print((f_weaver_belongto_userid));
      out.write(_jsp_string20, 0, _jsp_string20.length);
      out.print((f_weaver_belongto_usertype));
      out.write(_jsp_string151, 0, _jsp_string151.length);
      out.print((openFirstAss));
      out.write(_jsp_string152, 0, _jsp_string152.length);
      out.print((isrequest));
      out.write(_jsp_string89, 0, _jsp_string89.length);
      out.print((requestid));
      out.write(_jsp_string73, 0, _jsp_string73.length);
      out.print((desrequestid));
      out.write(_jsp_string74, 0, _jsp_string74.length);
      out.print((f_weaver_belongto_userid));
      out.write(_jsp_string20, 0, _jsp_string20.length);
      out.print((f_weaver_belongto_usertype));
      out.write(_jsp_string153, 0, _jsp_string153.length);
      
String isIE_uploader = (String)session.getAttribute("browser_isie");
if (isIE_uploader == null || "".equals(isIE_uploader)) {
	isIE_uploader = "true";
}

      out.write(_jsp_string154, 0, _jsp_string154.length);
      out.print((isIE_uploader));
      out.write(_jsp_string155, 0, _jsp_string155.length);
      out.print((SystemEnv.getHtmlLabelName(24495,user.getLanguage())));
      out.write(_jsp_string156, 0, _jsp_string156.length);
      out.print((SystemEnv.getHtmlLabelName(83072,user.getLanguage())));
      out.write(_jsp_string157, 0, _jsp_string157.length);
      
	isIncludeToptitle = 1;
	String gopage = "";
	String hostname = request.getServerName();
	String uri = request.getRequestURI();
	String querystring = "";
	titlename = Util.null2String(titlename);
	String ajaxs = "";
	for (Enumeration En = request.getParameterNames(); En.hasMoreElements();)
	{
		String tmpname = (String) En.nextElement();

		if (tmpname.equals("ajax"))
		{
			ajaxs = tmpname;
			continue;
		}
		String tmpvalue = Util.toScreen(request.getParameter(tmpname), user.getLanguage(), "0");
		querystring += "^" + tmpname + "=" + tmpvalue;
	}
	if (!querystring.equals(""))
		querystring = querystring.substring(1);

    querystring=Util.StringReplace(querystring,"\"", "&quot;");
	
	session.setAttribute("fav_pagename", titlename);
	session.setAttribute("fav_uri", uri);
	session.setAttribute("fav_querystring", querystring);
	int addFavSuccess = Util.getIntValue(session.getAttribute("fav_addfavsuccess") + "");
	session.setAttribute("fav_addfavsuccess", "");

      out.write(_jsp_string158, 0, _jsp_string158.length);
      out.print((titlename));
      out.write(_jsp_string159, 0, _jsp_string159.length);
      out.print((uri ));
      out.write(_jsp_string160, 0, _jsp_string160.length);
      out.print((querystring ));
      out.write(_jsp_string161, 0, _jsp_string161.length);
      
/**
 * \u83b7\u53d6\u5f53\u524d\u4e3b\u9898\u53ca\u5bf9\u5e94\u76ae\u80a4\uff08init.jsp\u4e2dsetting\uff09
 */
String tmpCurTheme = "ecology8";//(String)session.getAttribute("SESSION_TEMP_CURRENT_THEME");
String tmpCurskin = "default";//(String)session.getAttribute("SESSION_CURRENT_SKIN");

String iframeShtml = "" ;
//iframeShtml += "<table border=0 cellspacing=0 cellpadding=0 id=menuTable name=menuTable"+menuTableClassStr+">";

if(userightmenu == 1){
	iframeShtml += "<div id='menuTable' name='menuTable' unselectable='on' class='b-m-mpanel' style='background-color:rgb(249,249,249);'>";
}else{
	iframeShtml += "<div id='menuTable' name='menuTable'  style='padding-left:5px;padding-right:5px;background-color:rgb(249,249,249);'>";
}
RCMenu=Util.StringReplace(RCMenu,"javaScript","javascript");    
boolean loadRcMenu = true;
if(hiddenmenu==1 && userightmenu ==1) loadRcMenu = false;

ArrayList RCMENUArray = new ArrayList();
String[] rcm = RCMenu.split("}");
for(int __i=0;__i<rcm.length;__i++){
	showColMenuIndex++;
	if(__i==rcm.length-1 && !Util.null2String(rcm[__i]).trim().equals("")){
		showColMenuIndex++;
	}
}
showColMenuIndex--;
if(showColMenuIndex==-1)showColMenuIndex = 0;
RCMenu += systemAdminMenu;
RCMenu=RCMenu.trim();
int imgIndex=0;
if (!RCMenu.equals("")) {

				//\u7531\u539f\u6765\u7684apXPDropDown.class\u8f6c\u4e3a\u76f4\u63a5\u7528Button\uff0c2003-11-18\u6768\u56fd\u751f\u3002 				
				RCMENUArray = Util.TokenizerString(RCMenu,"}") ;
				if(RCMENUArray == null || RCMENUArray.size() <= defaultMenuCount || loadTopMenu == 0){
					loadRcMenu = false;
				}
				
				int itemNumTemp =0 ;
				String btnNameTemp = "";
				String urlTemp = "";
				String targetTemp = "";
				String btnPageName="";
				
				for (int itemNum=0;itemNum<RCMENUArray.size();itemNum++)
				{	
					String RCMENUTemp = Util.null2String((String)RCMENUArray.get(itemNum));
					RCMENUTemp=RCMENUTemp.trim();
					if (!RCMENUTemp.equals("")){
						RCMENUTemp += "}" ;
						if (RCMENUTemp.indexOf("{-}")==-1)//\u5982\u679c\u662f\u539f\u6765\u90a3\u63d2\u4ef6\u7684\u7684\u9694\u7ebf\u5373\u5b57\u7b26\u4e32\u6709{-}\u5c31\u4e0d\u518d\u751f\u6210\u4e86
						{
							itemNumTemp++;
							RCMENUTemp = RCMENUTemp.substring(1,RCMENUTemp.length()-1); //\u53bb\u6389\u5de6\u53f3\u7684{}
							RCMENUTemp = RCMENUTemp.trim();
							//ArrayList RCMenuItemArray = Util.TokenizerString(RCMENUTemp,",") ;//\u628a\u6bcf\u4e00\u9879\u91cc\u7684\u53c2\u6570\u5206\u89e3\u51fa\u6765
							//2004-04-22\u6768\u56fd\u751f\uff0c\u66f4\u6539\u6bcf\u4e2a\u83dc\u5355\u9879\u7684\u5206\u89e3\u65b9\u5f0f\uff0c\u628aUtil.TokenizerString\u65b9\u5f0f\u6362\u6210substring\u8fd9\u6837\u5c31\u80fd\u56fa\u5b9a\u4e3a3\u9879\u5373\u83dc\u5355\u540d\u3001\u5730\u5740\u3001\u76ee\u6807\uff0c\u4f7f\u5f97javascript\u65b9\u6cd5\u80fd\u591f\u4f7f\u7528\u591a\u4e2a\u53c2\u6570
							btnNameTemp = RCMENUTemp.substring(0,RCMENUTemp.indexOf(","));
							//(String)RCMenuItemArray.get(0);//\u540d\u79f0
							btnNameTemp=btnNameTemp.trim();
							urlTemp = RCMENUTemp.substring((RCMENUTemp.indexOf(",")+1),RCMENUTemp.lastIndexOf(","));	//(String)RCMenuItemArray.get(1);//\u5730\u5740\u6216javascript function
							urlTemp=urlTemp.trim();
							targetTemp = RCMENUTemp.substring((RCMENUTemp.lastIndexOf(",")+1),RCMENUTemp.length());	//(String)RCMenuItemArray.get(2);//target
							targetTemp=targetTemp.trim();
							btnPageName=RCMENUTemp.substring(RCMENUTemp.lastIndexOf(":")+1,RCMENUTemp.lastIndexOf(",")-2);
							boolean isSplitLine = false;
							if(urlTemp.equals("__hr__")){
								isSplitLine = true;
							}else if (urlTemp.indexOf("javascript:")==-1)//\u5982\u679c\u76f4\u63a5\u7ed9url\u65f6\u5904\u7406
								{
									if (targetTemp.equals("_blank"))
										urlTemp ="javascript:window.open('"+urlTemp+"','')";
									else if (targetTemp.equals("_parent"))
										urlTemp ="javascript:parent.parent.location.href=\\\""+urlTemp+"\\\"";
									else if ((targetTemp.equals("_self"))||(targetTemp.equals("_top")))
										urlTemp ="javascript:parent.location.href=\\\""+urlTemp+"\\\"";
									else 
										urlTemp ="javascript:parent."+targetTemp+".location.href=\\\""+urlTemp+"\\\"";
								}
							else 
								{
									if (urlTemp.indexOf("javascript:location=")!=-1)
										urlTemp = "javascript:parent.location.href=\\\"" + urlTemp.substring(21,urlTemp.length()-1)+"\\\"";
									else if (urlTemp.indexOf("javascript:location.href=")!=-1)
										urlTemp = "javascript:parent.location.href=\\\"" + urlTemp.substring(26,urlTemp.length()-1)+"\\\"";
									else
										urlTemp = "javascript:parent." + urlTemp.substring(11);
								}
							String imgPath=RightClickMenu.getIconPath(itemNumTemp,btnNameTemp);
							if("".equals(imgPath)){
								imgIndex++;
								if(imgIndex>9) imgIndex=0;
							}
							if(isSplitLine){
								iframeShtml+="<div style='height:1px;background-color:#d8d8d8;margin-right:8px;margin-left:8px;'></div>";
							}else{
								if(userightmenu == 1){
									if(btnPageName.equals("_table.firstPage")||btnPageName.equals("_table.prePage")||btnPageName.equals("_table.nextPage")||btnPageName.equals("_table.lastPage")){
										/*iframeShtml+="<div id='menuItemDivId"+ itemNum +"' unselectable='on' class='b-m-item'  onmouseover=\\\"this.className=\\\'"+"b-m-ifocus"+"\\\'\\\" onmouseout=\\\"this.className=\\\'"+"b-m-item"+"\\\'\\\"   ><div class='b-m-ibody' unselectable='on'><nobr unselectable='on'>";
										iframeShtml+="<img width=16  src='/wui/theme/" + tmpCurTheme + "/skins/" + tmpCurskin + "/contextmenu/"+("".equals(imgPath)?("default/"+imgIndex+"_wev8.png"):("CM_"+imgPath+"_wev8.png"))+"' align='absmiddle'>";
										iframeShtml+="<button  tyle='button' onclick='"+urlTemp+"'  style='width:"+(RCMenuWidth-40)+"px;' title='"+btnNameTemp+"'>"+btnNameTemp+"</button>";
										iframeShtml+="</nobr></div></div>";*/
									}
									else{
										
										iframeShtml+="<div id='menuItemDivId"+ itemNum +"' unselectable='on' class='b-m-item'  onmouseover=\\\"this.className=\\\'"+"b-m-ifocus"+"\\\'\\\" onmouseout=\\\"this.className=\\\'"+"b-m-item"+"\\\'\\\"   ><div class='b-m-ibody' unselectable='on'><nobr unselectable='on'>";
										if(btnNameTemp.equals("\u5bfc\u51fa\u5e94\u7528")){
											iframeShtml+="<img width=16   src='/wui/theme/" + tmpCurTheme + "/skins/" + tmpCurskin + "/contextmenu/"+("".equals(imgPath)?("CM_icon25_wev8.png"):("default/"+imgIndex+"_wev8.png"))+"' align='absmiddle'>";
										}else if(btnNameTemp.equals("\u5bfc\u5165\u5e94\u7528")){
											iframeShtml+="<img width=16   src='/wui/theme/" + tmpCurTheme + "/skins/" + tmpCurskin + "/contextmenu/"+("".equals(imgPath)?("CM_icon20_wev8.png"):("default/"+imgIndex+"_wev8.png"))+"' align='absmiddle'>";
										}else if(btnNameTemp.equals("\u5206\u4eab")){
											iframeShtml+="<img width=16   src='/wui/theme/" + tmpCurTheme + "/skins/" + tmpCurskin + "/contextmenu/"+("".equals(imgPath)?("default/12_wev8.png"):("default/"+imgIndex+"_wev8.png"))+"' align='absmiddle'>";
										}else{
											iframeShtml+="<img width=16   src='/wui/theme/" + tmpCurTheme + "/skins/" + tmpCurskin + "/contextmenu/"+("".equals(imgPath)?("default/"+imgIndex+"_wev8.png"):("CM_"+imgPath+"_wev8.png"))+"' align='absmiddle'>";
										}
										iframeShtml+="<button  onclick='"+urlTemp+";parent.hideRightClickMenu();'   style='width:"+(RCMenuWidth-40)+"px;' title='"+btnNameTemp+"'>"+btnNameTemp+"</button>";
										iframeShtml+="</nobr></div></div>";
										
									}
								}else{ 
									
									if(btnPageName.equals("_table.firstPage")||btnPageName.equals("_table.prePage")){
										iframeShtml += "<button id='menuItemDivId"+ itemNum +"' disabled='disabled' UNSELECTABLE='on' class='topClickMenuOut' onmouseover='this.className=\\\"topClickMenuOver\\\"' onmouseout='this.className=\\\"topClickMenuOut\\\"' onclick='"+urlTemp+"' style='width:"+RCMenuWidth+";height:"+RCMenuHeightStep+"' >&nbsp;<img width='16' src='/wui/theme/" + tmpCurTheme + "/skins/" + tmpCurskin + "/contextmenu/"+("".equals(imgPath)?("default/"+imgIndex+"_wev8.png"):("CM_"+imgPath+"_wev8.png"))+"' border=0 align='absmiddle'>&nbsp;"+btnNameTemp+"&nbsp;</button>" ;
									}else{
										iframeShtml += "<button id='menuItemDivId"+ itemNum +"' UNSELECTABLE='on' class='topClickMenuOut' onmouseover='this.className=\\\"topClickMenuOver\\\"' onmouseout='this.className=\\\"topClickMenuOut\\\"' onclick='"+urlTemp+"' style='height:"+RCMenuHeightStep+"' style='padding-top:2px;'>&nbsp;<img  style='margin-top:-2px;'  width='16'  src='/wui/theme/" + tmpCurTheme + "/skins/" + tmpCurskin + "/contextmenu/"+("".equals(imgPath)?("default/"+imgIndex+"_wev8.png"):("CM_"+imgPath+"_wev8.png"))+"' border=0  style='' align='absmiddle'><span style='padding-top:4px;'>&nbsp;"+btnNameTemp+"&nbsp;</span></button>" ;
									}
								}
							}
			  			}						
					}
				}	
}else{
	loadRcMenu = false;
	iframeShtml="";
}
int menuCount = (int)(RCMenuHeight / RCMenuHeightStep);
int RCMenuWidthAll = (int)(menuCount * RCMenuWidth);
if(userightmenu == 1){
	iframeShtml +="</div>";
}else{
	iframeShtml +="</div>";
}
int needShow = 0;
if(loadRcMenu == true){
	needShow = 1;
}
String isEnExtranetHelp = KtreeHelp.getInstance().isEnableExtranetHelp;

      out.write(_jsp_string162, 0, _jsp_string162.length);
      out.print((needShow));
      out.write(_jsp_string163, 0, _jsp_string163.length);
      out.print((menuCount));
      out.write(_jsp_string164, 0, _jsp_string164.length);
      out.print((RCMenuWidth));
      out.write(_jsp_string165, 0, _jsp_string165.length);
      out.print((RCMenuWidth));
      out.write(_jsp_string166, 0, _jsp_string166.length);
      out.print((RCMenuWidth));
      out.write(_jsp_string167, 0, _jsp_string167.length);
      out.print((RCMenuHeightStep));
      out.write(_jsp_string168, 0, _jsp_string168.length);
      if(loadRcMenu==true){
      out.write(_jsp_string169, 0, _jsp_string169.length);
      }else{
      out.write(_jsp_string170, 0, _jsp_string170.length);
      }
      out.write(_jsp_string171, 0, _jsp_string171.length);
      out.print((iframeShtml));
      out.write(_jsp_string172, 0, _jsp_string172.length);
      if(!closeRightMenu){
      out.write(_jsp_string173, 0, _jsp_string173.length);
      }
      out.write(_jsp_string174, 0, _jsp_string174.length);
      out.print((showColMenuIndex));
      out.write(_jsp_string175, 0, _jsp_string175.length);
      if(userightmenu==0 && loadRcMenu==true) {
      out.write(_jsp_string176, 0, _jsp_string176.length);
      }
      out.write(_jsp_string177, 0, _jsp_string177.length);
      
//System.out.println(request.getRequestURI());
//System.out.println("RCMenuHeight = " + RCMenuHeight);
//System.out.println("loadRcMenu = " + loadRcMenu);
if(userightmenu==1){
      out.write(_jsp_string178, 0, _jsp_string178.length);
      out.print((RCMenuWidth-12));
      out.write(_jsp_string179, 0, _jsp_string179.length);
      out.print((RCMenuHeight));
      out.write(_jsp_string180, 0, _jsp_string180.length);
      }else{	
      out.write(_jsp_string181, 0, _jsp_string181.length);
      if(loadRcMenu==false){
      out.write(_jsp_string182, 0, _jsp_string182.length);
      }else{
      out.write(_jsp_string183, 0, _jsp_string183.length);
      }
      out.write(_jsp_string184, 0, _jsp_string184.length);
      out.print((RCMenuWidth-12));
      out.write(_jsp_string179, 0, _jsp_string179.length);
      out.print((RCMenuHeightStep));
      out.write(_jsp_string185, 0, _jsp_string185.length);
      }
      out.write(_jsp_string186, 0, _jsp_string186.length);
      if(userightmenu==0 && loadRcMenu==true){
      out.write(_jsp_string187, 0, _jsp_string187.length);
      out.print((RCMenuHeightStep+2));
      out.write(_jsp_string188, 0, _jsp_string188.length);
      }
      out.write(_jsp_string189, 0, _jsp_string189.length);
      
			if(RCMenuHeight==0){	
		
      out.write(_jsp_string190, 0, _jsp_string190.length);
      }
      out.write(_jsp_string191, 0, _jsp_string191.length);
      if(userightmenu==1){
      out.write(_jsp_string192, 0, _jsp_string192.length);
      }
      out.write(_jsp_string193, 0, _jsp_string193.length);
      out.print((isIEBrowser));
      out.write(_jsp_string194, 0, _jsp_string194.length);
      out.print((closeRightMenu));
      out.write(_jsp_string195, 0, _jsp_string195.length);
      if(userightmenu==1){
      out.write(_jsp_string196, 0, _jsp_string196.length);
      if(!closeRightMenu){
      out.write(_jsp_string197, 0, _jsp_string197.length);
      }
      out.write(_jsp_string198, 0, _jsp_string198.length);
      if(loadRcMenu == true){
      out.write(_jsp_string199, 0, _jsp_string199.length);
      }else{
      out.write(_jsp_string200, 0, _jsp_string200.length);
      }
      out.write(_jsp_string53, 0, _jsp_string53.length);
      }else{
      out.write(_jsp_string2, 0, _jsp_string2.length);
      }
      out.write(_jsp_string201, 0, _jsp_string201.length);
      out.print((SystemEnv.getHtmlLabelName(2081,user.getLanguage())));
      out.write(_jsp_string202, 0, _jsp_string202.length);
      out.print((isEnExtranetHelp));
      out.write(_jsp_string203, 0, _jsp_string203.length);
      out.print((KtreeHelp.getInstance().extranetUrl));
      out.write(_jsp_string204, 0, _jsp_string204.length);
      
//
if(userightmenu!=1){
	String  realPath  =  "http://"  +  request.getServerName()  +  ":"  +  request.getServerPort()  +  request.getContextPath()+request.getServletPath();
	
	if(realPath.indexOf("/workflow/request/AddRequest")!=-1||realPath.indexOf("/workflow/request/ManageRequest")!=-1||realPath.indexOf("/workflow/request/ViewRequest")!=-1){
		
      out.write(_jsp_string205, 0, _jsp_string205.length);
      
	}
}

      out.write(_jsp_string206, 0, _jsp_string206.length);
      out.print((user.getLanguage()));
      out.write(_jsp_string207, 0, _jsp_string207.length);
      HrmListValidate HrmListValidateObj = new HrmListValidate(); 
      out.write(_jsp_string208, 0, _jsp_string208.length);
      if(HrmValidate.hasEmessage(user)){ 
      out.write(_jsp_string209, 0, _jsp_string209.length);
      out.print((SystemEnv.getHtmlLabelName(127379,user.getLanguage())));
      out.write(_jsp_string210, 0, _jsp_string210.length);
      } 
      out.write(_jsp_string208, 0, _jsp_string208.length);
      if(HrmListValidateObj.isValidate(31)){ 
      out.write(_jsp_string211, 0, _jsp_string211.length);
      out.print((SystemEnv.getHtmlLabelName(16635,user.getLanguage())));
      out.write(_jsp_string210, 0, _jsp_string210.length);
      }if(HrmListValidateObj.isValidate(19)){ 
      out.write(_jsp_string212, 0, _jsp_string212.length);
      out.print((SystemEnv.getHtmlLabelName(2051,user.getLanguage())));
      out.write(_jsp_string210, 0, _jsp_string210.length);
      }if(HrmListValidateObj.isValidate(32)){ 
      out.write(_jsp_string213, 0, _jsp_string213.length);
      out.print((SystemEnv.getHtmlLabelName(18481,user.getLanguage())));
      out.write(_jsp_string210, 0, _jsp_string210.length);
      }
      out.write(_jsp_string214, 0, _jsp_string214.length);
      out.print((SystemEnv.getHtmlLabelName(18939,user.getLanguage())));
      out.write(_jsp_string215, 0, _jsp_string215.length);
      out.print((SystemEnv.getHtmlLabelName(141,user.getLanguage())));
      out.write(_jsp_string216, 0, _jsp_string216.length);
      out.print((SystemEnv.getHtmlLabelName(6086,user.getLanguage())));
      out.write(_jsp_string217, 0, _jsp_string217.length);
      out.print((SystemEnv.getHtmlLabelName(596,user.getLanguage())));
      out.write(_jsp_string218, 0, _jsp_string218.length);
      out.print((SystemEnv.getHtmlLabelName(602,user.getLanguage())));
      out.write(_jsp_string219, 0, _jsp_string219.length);
      out.print((SystemEnv.getHtmlLabelName(422,user.getLanguage())));
      out.write(_jsp_string220, 0, _jsp_string220.length);
      out.print((SystemEnv.getHtmlLabelName(421,user.getLanguage())));
      out.write(_jsp_string221, 0, _jsp_string221.length);
      out.print((SystemEnv.getHtmlLabelName(71,user.getLanguage())));
      out.write(_jsp_string222, 0, _jsp_string222.length);
      out.print((versionId));
      out.write(_jsp_string223, 0, _jsp_string223.length);
      out.print((docid));
      out.write(_jsp_string224, 0, _jsp_string224.length);
      out.print((docid));
      out.write(_jsp_string225, 0, _jsp_string225.length);
      out.print((imagefileId));
      out.write(_jsp_string226, 0, _jsp_string226.length);
      out.print((docno));
      out.write(_jsp_string227, 0, _jsp_string227.length);
      out.print((docsubject));
      out.write(_jsp_string228, 0, _jsp_string228.length);
      out.print((needapprovecheck));
      out.write(_jsp_string229, 0, _jsp_string229.length);
      out.print((ownerid));
      out.write(_jsp_string230, 0, _jsp_string230.length);
      out.print((ownerid));
      out.write(_jsp_string231, 0, _jsp_string231.length);
      out.print((ownerType));
      out.write(_jsp_string232, 0, _jsp_string232.length);
      out.print((doccreatedate));
      out.write(_jsp_string233, 0, _jsp_string233.length);
      out.print((doccreatetime));
      out.write(_jsp_string234, 0, _jsp_string234.length);
      out.print((docstatus));
      out.write(_jsp_string235, 0, _jsp_string235.length);
      out.print((docedition));
      out.write(_jsp_string236, 0, _jsp_string236.length);
      out.print((doceditionid));
      out.write(_jsp_string237, 0, _jsp_string237.length);
      out.print(((maincategory==-1?"":Integer.toString(maincategory))));
      out.write(_jsp_string238, 0, _jsp_string238.length);
      out.print(((subcategory==-1?"":Integer.toString(subcategory))));
      out.write(_jsp_string239, 0, _jsp_string239.length);
      out.print(((seccategory==-1?"":Integer.toString(seccategory))));
      out.write(_jsp_string240, 0, _jsp_string240.length);
      out.print((docpublishtype));
      out.write(_jsp_string241, 0, _jsp_string241.length);
      out.print((docmain));
      out.write(_jsp_string242, 0, _jsp_string242.length);
      out.print((wordmouldid));
      out.write(_jsp_string243, 0, _jsp_string243.length);
      out.print((assetid));
      out.write(_jsp_string244, 0, _jsp_string244.length);
      out.print((crmid));
      out.write(_jsp_string245, 0, _jsp_string245.length);
      out.print((itemid));
      out.write(_jsp_string246, 0, _jsp_string246.length);
      out.print((projectid));
      out.write(_jsp_string247, 0, _jsp_string247.length);
      out.print((financeid));
      out.write(_jsp_string248, 0, _jsp_string248.length);
      out.print((doccreaterid));
      out.write(_jsp_string249, 0, _jsp_string249.length);
      out.print((docCreaterType));
      out.write(_jsp_string250, 0, _jsp_string250.length);
      out.print((dummyIds));
      out.write(_jsp_string251, 0, _jsp_string251.length);
      out.print((keyword));
      out.write(_jsp_string252, 0, _jsp_string252.length);
      out.print((docCode));
      out.write(_jsp_string253, 0, _jsp_string253.length);
      out.print((topageFromOther));
      out.write(_jsp_string254, 0, _jsp_string254.length);
      out.print((requestid));
      out.write(_jsp_string255, 0, _jsp_string255.length);
      out.print((workflowid));
      out.write(_jsp_string256, 0, _jsp_string256.length);
      out.print((hasUsedTemplet));
      out.write(_jsp_string257, 0, _jsp_string257.length);
      out.print((isFromAccessory?1:0));
      out.write(_jsp_string258, 0, _jsp_string258.length);
      out.print((editMouldId));
      out.write(_jsp_string259, 0, _jsp_string259.length);
      if(isrequest.equals("1")&&(hasright==1||isremark==1)){
      out.write(_jsp_string260, 0, _jsp_string260.length);
      out.print((nodeid));
      out.write(_jsp_string261, 0, _jsp_string261.length);
      out.print((nodetype));
      out.write(_jsp_string262, 0, _jsp_string262.length);
      out.print((formid));
      out.write(_jsp_string263, 0, _jsp_string263.length);
      out.print((isbill));
      out.write(_jsp_string264, 0, _jsp_string264.length);
      out.print((billid));
      out.write(_jsp_string265, 0, _jsp_string265.length);
      out.print((requestname));
      out.write(_jsp_string266, 0, _jsp_string266.length);
      out.print((ResourceComInfo.getManagerID(""+userid)));
      out.write(_jsp_string267, 0, _jsp_string267.length);
      out.print((workflowtype));
      out.write(_jsp_string268, 0, _jsp_string268.length);
      out.print((messageType));
      out.write(_jsp_string269, 0, _jsp_string269.length);
      out.print((docIds));
      out.write(_jsp_string270, 0, _jsp_string270.length);
      out.print((crmIds));
      out.write(_jsp_string271, 0, _jsp_string271.length);
      out.print((hrmIds));
      out.write(_jsp_string272, 0, _jsp_string272.length);
      out.print((prjIds));
      out.write(_jsp_string273, 0, _jsp_string273.length);
      out.print((cptIds));
      out.write(_jsp_string274, 0, _jsp_string274.length);
      }
      out.write(_jsp_string275, 0, _jsp_string275.length);
      out.print((hrmresid));
      out.write(_jsp_string276, 0, _jsp_string276.length);
      out.print((invalidationdate));
      out.write(_jsp_string277, 0, _jsp_string277.length);
      out.print((wordmouldid));
      out.write(_jsp_string278, 0, _jsp_string278.length);
      out.print((canPrintedNum));
      out.write(_jsp_string279, 0, _jsp_string279.length);
      out.print((doccontent));
      out.write(_jsp_string280, 0, _jsp_string280.length);
      if(!onlyview){
					if(!fromFlowDoc.equals("1")){
						if (!isPersonalDoc){ 
							if(isrequest.equals("1")){ //\u4ece\u5de5\u4f5c\u6d41\u8fdb\u5165\u7684\u6587\u6863
						
      out.write(_jsp_string208, 0, _jsp_string208.length);
      if(canEditHis && ((!docstatus.equals("5") && hasright == 1) ||  ((docstatus.equals("0") || docstatus.equals("2") || docstatus.equals("1") || docstatus.equals("4")||Util.getIntValue(docstatus,0)<0) && hasright == 0)) ) { 
      out.write(_jsp_string281, 0, _jsp_string281.length);
      out.print((SystemEnv.getHtmlLabelName(93, user.getLanguage())));
      out.write(_jsp_string282, 0, _jsp_string282.length);
      if(openFirstAss&&"true".equalsIgnoreCase(isIE)&&fileExtendName.isEmpty()&&!imagefileName.toLowerCase().endsWith(".pdf")){
      out.write(_jsp_string283, 0, _jsp_string283.length);
      out.print((SystemEnv.getHtmlLabelName(129740, user.getLanguage())));
      out.write(_jsp_string282, 0, _jsp_string282.length);
      } 
      out.write(_jsp_string208, 0, _jsp_string208.length);
      
							if((openFirstAss||isFromAccessory)&&ishistory!=1&&showReplaceFile){
      out.write(_jsp_string284, 0, _jsp_string284.length);
      out.print((SystemEnv.getHtmlLabelName(33029, user.getLanguage())));
      out.write(_jsp_string285, 0, _jsp_string285.length);
      } 
      out.write(_jsp_string208, 0, _jsp_string208.length);
      } 
      out.write(_jsp_string286, 0, _jsp_string286.length);
      }else if(canEdit) { 
      out.write(_jsp_string286, 0, _jsp_string286.length);
      if(islastversion&&!(isFromAccessory&&"false".equalsIgnoreCase(isIE))&&(openFirstAss||!isNotOffice)) { 
      out.write(_jsp_string287, 0, _jsp_string287.length);
      out.print((SystemEnv.getHtmlLabelName(93, user.getLanguage())));
      out.write(_jsp_string282, 0, _jsp_string282.length);
      
						}
							if((openFirstAss||isFromAccessory)&&ishistory!=1&&showReplaceFile){
      out.write(_jsp_string284, 0, _jsp_string284.length);
      out.print((SystemEnv.getHtmlLabelName(33029, user.getLanguage())));
      out.write(_jsp_string285, 0, _jsp_string285.length);
      } 
      out.write(_jsp_string208, 0, _jsp_string208.length);
      if(openFirstAss&&"true".equalsIgnoreCase(isIE)&&fileExtendName.isEmpty()&&!imagefileName.toLowerCase().endsWith(".pdf")){
      out.write(_jsp_string283, 0, _jsp_string283.length);
      out.print((SystemEnv.getHtmlLabelName(129740, user.getLanguage())));
      out.write(_jsp_string285, 0, _jsp_string285.length);
      } 
      out.write(_jsp_string208, 0, _jsp_string208.length);
      if(!isFromAccessory&&(docstatus.equals("0")||Util.getIntValue(docstatus,0)<=0)){ 
      out.write(_jsp_string288, 0, _jsp_string288.length);
      out.print((SystemEnv.getHtmlLabelName(615, user.getLanguage())));
      out.write(_jsp_string282, 0, _jsp_string282.length);
      } 
      out.write(_jsp_string286, 0, _jsp_string286.length);
      }else if(canReader){ 
      out.write(_jsp_string208, 0, _jsp_string208.length);
      if(!isFromAccessory&&(docstatus.equals("0")||Util.getIntValue(docstatus,0)<=0)){ 
      out.write(_jsp_string289, 0, _jsp_string289.length);
      out.print((SystemEnv.getHtmlLabelName(615, user.getLanguage())));
      out.write(_jsp_string282, 0, _jsp_string282.length);
      } 
      out.write(_jsp_string286, 0, _jsp_string286.length);
      } 
      out.write(_jsp_string286, 0, _jsp_string286.length);
       if(canDownload){ 
      out.write(_jsp_string290, 0, _jsp_string290.length);
      out.print((SystemEnv.getHtmlLabelName(31156, user.getLanguage())));
      out.write(_jsp_string291, 0, _jsp_string291.length);
      } 
      out.write(_jsp_string292, 0, _jsp_string292.length);
       if(canShare&&!isFromAccessory){ 
      out.write(_jsp_string293, 0, _jsp_string293.length);
      out.print((SystemEnv.getHtmlLabelName(119, user.getLanguage())));
      out.write(_jsp_string291, 0, _jsp_string291.length);
      } 
      out.write(_jsp_string292, 0, _jsp_string292.length);
      //\u6587\u6863\u56de\u590d\uff0c \u5982\u679c\u662f\u53ef\u4ee5\u56de\u590d\u7684\u6587\u6863\u4e14\u662f\u6b63\u5e38\u7684\u6587\u6863\uff0c \u53ef\u4ee5\u56de\u590d
			    		  if(canReplay&&!isFromAccessory) {
			    		      if(DocReplyUtil.isUseNewReply()){
			    		  	  
      out.write(_jsp_string294, 0, _jsp_string294.length);
      out.print((SystemEnv.getHtmlLabelName(117, user.getLanguage())));
      out.write(_jsp_string295, 0, _jsp_string295.length);
      	}
			    		  	else{
			    		  	  
      out.write(_jsp_string296, 0, _jsp_string296.length);
      out.print((SystemEnv.getHtmlLabelName(117, user.getLanguage())));
      out.write(_jsp_string297, 0, _jsp_string297.length);
       	}
			    		
      out.write(_jsp_string298, 0, _jsp_string298.length);
      } 
      out.write(_jsp_string286, 0, _jsp_string286.length);
      }else{
      out.write(_jsp_string299, 0, _jsp_string299.length);
      out.print((SystemEnv.getHtmlLabelName(93, user.getLanguage())));
      out.write(_jsp_string291, 0, _jsp_string291.length);
      } 
      out.write(_jsp_string300, 0, _jsp_string300.length);
      }else{ 
      out.write(_jsp_string286, 0, _jsp_string286.length);
      if (istoManagePage) { 
      out.write(_jsp_string208, 0, _jsp_string208.length);
      if (isUseTempletNode) { 
      out.write(_jsp_string301, 0, _jsp_string301.length);
      out.print((((!"1".equals(hasUsedTemplet))&&isUseTempletNode&&isremark==0)?"":"display:none" ));
      out.write(_jsp_string302, 0, _jsp_string302.length);
      out.print(( wordmouldid ));
      out.write(_jsp_string303, 0, _jsp_string303.length);
      out.print((SystemEnv.getHtmlLabelName(21659, user.getLanguage())));
      out.write(_jsp_string304, 0, _jsp_string304.length);
      if(countNum > 1 && isUseTempletNode && isremark==0){ 
      out.write(_jsp_string305, 0, _jsp_string305.length);
      out.print(((countNum > 1 && (!"1".equals(hasUsedTemplet))&&isUseTempletNode&&isremark==0)?"":"display:none" ));
      out.write(_jsp_string306, 0, _jsp_string306.length);
      out.print(( mouldSecCategoryId ));
      out.write(',');
      out.print((wordmouldid ));
      out.write(_jsp_string303, 0, _jsp_string303.length);
      out.print((SystemEnv.getHtmlLabelName(21660, user.getLanguage())));
      out.write(_jsp_string304, 0, _jsp_string304.length);
      } 
      out.write(_jsp_string307, 0, _jsp_string307.length);
      out.print(((("1".equals(hasUsedTemplet))&&isUseTempletNode&&isremark==0)?"":"display:none" ));
      out.write(_jsp_string308, 0, _jsp_string308.length);
      out.print((SystemEnv.getHtmlLabelName(22983, user.getLanguage())));
      out.write(_jsp_string309, 0, _jsp_string309.length);
      out.print(((("1".equals(hasUsedTemplet))&&isUseTempletNode&&isremark==0 && !isSignatureNodes)?"":"display:none" ));
      out.write(_jsp_string310, 0, _jsp_string310.length);
      out.print(( wordmouldid ));
      out.write(_jsp_string303, 0, _jsp_string303.length);
      out.print((SystemEnv.getHtmlLabelName(86, user.getLanguage())));
      out.write(_jsp_string311, 0, _jsp_string311.length);
      out.print((SystemEnv.getHtmlLabelName(129071, user.getLanguage())));
      out.write(_jsp_string282, 0, _jsp_string282.length);
      } 
      out.write(_jsp_string208, 0, _jsp_string208.length);
      if( isSignatureNodes){ 
      out.write(_jsp_string312, 0, _jsp_string312.length);
      out.print(((isremark==0)?"":"display:none" ));
      out.write(_jsp_string313, 0, _jsp_string313.length);
      out.print((SystemEnv.getHtmlLabelName(21650, user.getLanguage())));
      out.write(_jsp_string314, 0, _jsp_string314.length);
      out.print(((isremark==0)?"":"display:none" ));
      out.write(_jsp_string315, 0, _jsp_string315.length);
      out.print((SystemEnv.getHtmlLabelName(21656, user.getLanguage())));
      out.write(_jsp_string282, 0, _jsp_string282.length);
      }
      out.write(_jsp_string286, 0, _jsp_string286.length);
      } 
      out.write(_jsp_string286, 0, _jsp_string286.length);
      if (canPrint) { 
      out.write(_jsp_string316, 0, _jsp_string316.length);
      out.print((SystemEnv.getHtmlLabelName(257, user.getLanguage())));
      out.write(_jsp_string291, 0, _jsp_string291.length);
      } 
      out.write(_jsp_string317, 0, _jsp_string317.length);
      } 
      out.write(_jsp_string318, 0, _jsp_string318.length);
      }
      out.write(_jsp_string319, 0, _jsp_string319.length);
      if((docstatus.equals("1")||docstatus.equals("2")||docstatus.equals("5")) && "1".equals(user.getLogintype())  && ( !isFromAccessory || "1".equals(isrequest)) && isUseEMessager==1){ 
      out.write(_jsp_string320, 0, _jsp_string320.length);
      out.print((docid ));
      out.write(_jsp_string321, 0, _jsp_string321.length);
      out.print((docsubject));
      out.write(_jsp_string322, 0, _jsp_string322.length);
      out.print((SystemEnv.getHtmlLabelName(126091, user.getLanguage())));
      out.write(_jsp_string323, 0, _jsp_string323.length);
      } 
      out.write(_jsp_string324, 0, _jsp_string324.length);
      out.print((SystemEnv.getHtmlLabelName(23036,user.getLanguage())));
      out.write(_jsp_string325, 0, _jsp_string325.length);
      
	List<Map<String,String>> replyDocs = DocComInfo.getParentReplyDoc(""+docid); 
	
      out.write(_jsp_string326, 0, _jsp_string326.length);
      _jsp_BrowserTag_1 = new weaver.common.util.taglib.BrowserTag();
      _jsp_BrowserTag_1.setJspContext(pageContext);
      _jsp_BrowserTag_1.setName("__selectTaohongMould");
      _jsp_BrowserTag_1.setViewType("0");
      _jsp_BrowserTag_1.setGetBrowserUrlFn("getBrowserUrlFn");
      _jsp_BrowserTag_1.set_callback("afterSelectMould");
      _jsp_BrowserTag_1.setBrowserBtnID("selectTaohongMouldBtn");
      _jsp_BrowserTag_1.setIsMustInput("1");
      _jsp_BrowserTag_1.setGetBrowserUrlFnParams(""+ mouldSecCategoryId);
      _jsp_BrowserTag_1.doTag();
      out.write(_jsp_string327, 0, _jsp_string327.length);
      out.print(("1".equals(fromFlowDoc)?"display:none":"" ));
      out.write(_jsp_string328, 0, _jsp_string328.length);
      for(ListIterator<Map<String,String>> it = replyDocs.listIterator();it.hasNext();){ 
    			Map<String,String> replyDoc = it.next();
    		
      out.write(_jsp_string329, 0, _jsp_string329.length);
      out.print((replyDoc.get("id") ));
      out.write(_jsp_string330, 0, _jsp_string330.length);
      out.print((replyDoc.get("name")));
      out.write(_jsp_string331, 0, _jsp_string331.length);
      } 
      out.write(_jsp_string332, 0, _jsp_string332.length);
       if(DocReplyUtil.isUseNewReply()&&!isFromAccessory){ 
      out.write(_jsp_string333, 0, _jsp_string333.length);
      out.print((SystemEnv.getHtmlLabelName(126385,user.getLanguage())));
      out.write(_jsp_string334, 0, _jsp_string334.length);
      out.print(( " "+Util.null2String(Util.toScreen(ResourceComInfo.getResourcename(""+doclastmoduserid),user.getLanguage()))+" " ));
      out.write(_jsp_string334, 0, _jsp_string334.length);
      out.print((SystemEnv.getHtmlLabelName(126386,user.getLanguage())));
      out.write(_jsp_string334, 0, _jsp_string334.length);
      out.print(( doclastmoddate ));
      out.write(' ');
      out.print(( " "+doclastmodtime ));
      out.write(_jsp_string335, 0, _jsp_string335.length);
      out.print((SystemEnv.getHtmlLabelName(260,user.getLanguage())));
      out.write(_jsp_string336, 0, _jsp_string336.length);
      out.print(( readCount_int ));
      out.write(_jsp_string337, 0, _jsp_string337.length);
       if(canReplay) { 
      out.write(_jsp_string338, 0, _jsp_string338.length);
       if(isPraise == 0){ 
      out.write(_jsp_string339, 0, _jsp_string339.length);
      out.print((SystemEnv.getHtmlLabelName(32942,user.getLanguage())));
      out.write(_jsp_string340, 0, _jsp_string340.length);
      out.print((SystemEnv.getHtmlLabelName(32942,user.getLanguage())));
      out.write(_jsp_string341, 0, _jsp_string341.length);
      out.print(( praiseCount_int ));
      out.write(_jsp_string342, 0, _jsp_string342.length);
       } else { 
      out.write(_jsp_string343, 0, _jsp_string343.length);
      out.print((SystemEnv.getHtmlLabelName(32944,user.getLanguage())));
      out.write(_jsp_string344, 0, _jsp_string344.length);
      out.print((SystemEnv.getHtmlLabelName(32944,user.getLanguage())));
      out.write(_jsp_string345, 0, _jsp_string345.length);
      out.print(( praiseCount_int ));
      out.write(_jsp_string342, 0, _jsp_string342.length);
       } 
      out.write(_jsp_string346, 0, _jsp_string346.length);
      
						if(userInfos != null && userInfos.size() > 0)
						{
						    int length = userInfos.size() < 8 ? userInfos.size() : 8;
							for(int i = 0 ; i <  userInfos.size(); i ++)
							{
						    	UserInfo useri = userInfos.get(i);
						    	if(i < 13)
						    	{
					
      out.write(_jsp_string347, 0, _jsp_string347.length);
      out.print(( useri.getUserid() ));
      out.write(_jsp_string348, 0, _jsp_string348.length);
      out.print(( useri.getUserid()+"up" ));
      out.write(_jsp_string349, 0, _jsp_string349.length);
      out.print(( useri.getUserName() ));
      out.write(_jsp_string350, 0, _jsp_string350.length);
      out.print(( useri.getUserName() ));
      out.write(_jsp_string351, 0, _jsp_string351.length);
       } else { 
      out.write(_jsp_string347, 0, _jsp_string347.length);
      out.print(( useri.getUserid() ));
      out.write(_jsp_string348, 0, _jsp_string348.length);
      out.print(( useri.getUserid()+"up" ));
      out.write(_jsp_string349, 0, _jsp_string349.length);
      out.print(( useri.getUserName() ));
      out.write(_jsp_string352, 0, _jsp_string352.length);
      out.print(( useri.getUserName() ));
      out.write(_jsp_string353, 0, _jsp_string353.length);
       } 
      out.write(_jsp_string354, 0, _jsp_string354.length);
       } if(userInfos.size() > 13 ) {
      out.write(_jsp_string355, 0, _jsp_string355.length);
      out.print((SystemEnv.getHtmlLabelName(126387,user.getLanguage())));
      out.write(_jsp_string356, 0, _jsp_string356.length);
      out.print(( userInfos.size() ));
      out.write(_jsp_string357, 0, _jsp_string357.length);
      out.print((SystemEnv.getHtmlLabelName(126388,user.getLanguage())));
      out.write(_jsp_string358, 0, _jsp_string358.length);
       }
      out.write(_jsp_string359, 0, _jsp_string359.length);
      out.print((SystemEnv.getHtmlLabelName(126390,user.getLanguage())));
      out.write(_jsp_string360, 0, _jsp_string360.length);
       } else { 
      out.write(_jsp_string361, 0, _jsp_string361.length);
      out.print((SystemEnv.getHtmlLabelName(126390,user.getLanguage())));
      out.write(_jsp_string362, 0, _jsp_string362.length);
       } 
      out.write(_jsp_string363, 0, _jsp_string363.length);
       } 
      out.write(_jsp_string364, 0, _jsp_string364.length);
       } 
      out.write(_jsp_string365, 0, _jsp_string365.length);
      out.print((fromFlowDoc.equals("1")?"display:none;":"" ));
      out.write(_jsp_string366, 0, _jsp_string366.length);
      if ((fileExtendName.isEmpty()||(!fileExtendName.isEmpty()&&isToDocDspExt))&&!sysremindflag){
      out.write(_jsp_string208, 0, _jsp_string208.length);
      if(iframeLoad||isNotOffice){ 
      out.write(_jsp_string367, 0, _jsp_string367.length);
      out.print(( previewUrl));
      out.write(_jsp_string368, 0, _jsp_string368.length);
      }else{ 
      out.write(_jsp_string369, 0, _jsp_string369.length);
      out.print((iframeLoad?"none":""));
      out.write(_jsp_string370, 0, _jsp_string370.length);
      out.print((mClassId));
      out.write(_jsp_string371, 0, _jsp_string371.length);
      if("1".equals(isTextInForm)){
      out.write(_jsp_string372, 0, _jsp_string372.length);
      }else{
      out.write(_jsp_string373, 0, _jsp_string373.length);
      out.print((fromFlowDoc.equals("1")?"-23px":"-23px" ));
      }
      out.write(_jsp_string374, 0, _jsp_string374.length);
      out.print((mClientUrl));
      out.write(_jsp_string375, 0, _jsp_string375.length);
      } 
      out.write(_jsp_string376, 0, _jsp_string376.length);
      }else{
      out.write(_jsp_string377, 0, _jsp_string377.length);
      out.print((sysremindurl));
      out.write(_jsp_string378, 0, _jsp_string378.length);
      }
      out.write(_jsp_string379, 0, _jsp_string379.length);
      if(isUseBarCodeThisJsp.equals("1")){
      out.write(_jsp_string380, 0, _jsp_string380.length);
      out.print((PDF417ManagerClassId));
      out.write(_jsp_string381, 0, _jsp_string381.length);
      out.print((PDF417ManagerClientName));
      out.write(_jsp_string382, 0, _jsp_string382.length);
      }
      out.write(_jsp_string383, 0, _jsp_string383.length);
      if(isSignatureNodes||isSaveDecryptPDF){
					  if("1".equals(signatureType)){
      out.write(_jsp_string384, 0, _jsp_string384.length);
      out.print((wps_version));
      out.write(_jsp_string385, 0, _jsp_string385.length);
      }else if("2".equals(signatureType)){
      out.write(_jsp_string386, 0, _jsp_string386.length);
      }else{
      out.write(_jsp_string387, 0, _jsp_string387.length);
      }}
      out.write(_jsp_string388, 0, _jsp_string388.length);
      pageContext.include("/docs/docs/DocDspExtBaseInfo.jsp", "f_weaver_belongto_userid=" + com.caucho.el.Expr.toString(f_weaver_belongto_userid, null)+ "&" + "f_weaver_belongto_usertype=" + com.caucho.el.Expr.toString(f_weaver_belongto_usertype, null)+ "&" + "seccategory=" + com.caucho.el.Expr.toString(seccategory, null)+ "&" + "languageId=" + com.caucho.el.Expr.toString(languageId, null)+ "&" + "isPersonalDoc=" + com.caucho.el.Expr.toString(isPersonalDoc, null)+ "&" + "publishable=" + com.caucho.el.Expr.toString(publishable, null)+ "&" + "docid=" + com.caucho.el.Expr.toString(docid, null)+ "&" + "wordmouldid=" + com.caucho.el.Expr.toString(wordmouldid, null)+ "&" + "canPublish=" + com.caucho.el.Expr.toString(canPublish, null)+ "&" + "selectMouldType=" + com.caucho.el.Expr.toString(selectMouldType, null)+ "&" + "fromFlowDoc=" + com.caucho.el.Expr.toString(fromFlowDoc, null)+ "&" + "filetype=" + com.caucho.el.Expr.toString(filetype, null)+ "&" + "dummyIds=" + com.caucho.el.Expr.toString(dummyIds, null)+ "&" + "userCategory=" + com.caucho.el.Expr.toString(userCategory, null), false);
      out.write(_jsp_string389, 0, _jsp_string389.length);
      
			String sessionPara=""+docid+"_"+userid+"_"+logintype;
			session.setAttribute("right_view_"+sessionPara,"1");			

      out.write(_jsp_string390, 0, _jsp_string390.length);
       if(canReplay) { 
      out.write(_jsp_string391, 0, _jsp_string391.length);
      
					if(DocReplyUtil.isUseNewReply()){
						String replyviewsessionPara=""+docid+"_"+user.getUID()+"_"+user.getLogintype();
						session.setAttribute("view_reply_aboutfiles_"+replyviewsessionPara,"1");
					}
				
      out.write(_jsp_string392, 0, _jsp_string392.length);
       } 
      out.write(_jsp_string393, 0, _jsp_string393.length);
       if(isEditionOpen) { 
      out.write(_jsp_string394, 0, _jsp_string394.length);
       } 
      out.write(_jsp_string395, 0, _jsp_string395.length);
       if(canViewLog) { 
      out.write(_jsp_string396, 0, _jsp_string396.length);
       } 
      out.write(_jsp_string397, 0, _jsp_string397.length);
       if(DocMark.isAllowMark(""+seccategory)){ 
      out.write(_jsp_string398, 0, _jsp_string398.length);
       } 
      out.write(_jsp_string399, 0, _jsp_string399.length);
      if(isAutoExtendInfo>0&&accessorycount>0 && !isFromAccessory){ 
      out.write(_jsp_string400, 0, _jsp_string400.length);
      pageContext.include("/docs/docs/DocAccView.jsp", "f_weaver_belongto_userid=" + com.caucho.el.Expr.toString(f_weaver_belongto_userid, null)+ "&" + "f_weaver_belongto_usertype=" + com.caucho.el.Expr.toString(f_weaver_belongto_usertype, null)+ "&" + "seccategory=" + com.caucho.el.Expr.toString(seccategory, null)+ "&" + "docid=" + com.caucho.el.Expr.toString(docid, null)+ "&" + "canEdit=" + com.caucho.el.Expr.toString(canEdit, null)+ "&" + "canDownload=" + com.caucho.el.Expr.toString(canDownload, null)+ "&" + "language=" + com.caucho.el.Expr.toString(user.getLanguage(), null)+ "&" + "bacthDownloadFlag=" + com.caucho.el.Expr.toString(DocUtil.getBatchDownloadFlag(docid), null)+ "&" + "mode=" + ("view")+ "&" + "isFromWf=" + ("false")+ "&" + "maxUploadImageSize=" + com.caucho.el.Expr.toString(DocUtil.getBatchDownloadFlag(docid), null)+ "&" + "votingId=" + com.caucho.el.Expr.toString(votingId, null), false);
      out.write(_jsp_string401, 0, _jsp_string401.length);
      } 
      out.write(_jsp_string402, 0, _jsp_string402.length);
      if(!isFromAccessory){
      out.write(_jsp_string403, 0, _jsp_string403.length);
      out.print(( SystemEnv.getHtmlLabelName(18332,user.getLanguage())));
      out.write(_jsp_string404, 0, _jsp_string404.length);
      out.print(( SystemEnv.getHtmlLabelName(33197,user.getLanguage())));
      out.write(_jsp_string405, 0, _jsp_string405.length);
      out.print((accessorycount));
      out.write(_jsp_string406, 0, _jsp_string406.length);
       if(canReplay) { 
      out.write(_jsp_string407, 0, _jsp_string407.length);
      out.print((replaydoccount));
      out.write(_jsp_string408, 0, _jsp_string408.length);
       } 
      out.write(_jsp_string409, 0, _jsp_string409.length);
       if(isEditionOpen) { 
      out.write(_jsp_string410, 0, _jsp_string410.length);
       } 
      out.write(_jsp_string395, 0, _jsp_string395.length);
       if(canViewLog) { 
      out.write(_jsp_string411, 0, _jsp_string411.length);
      out.print((SystemEnv.getHtmlLabelName(21990,user.getLanguage())));
      out.write(_jsp_string412, 0, _jsp_string412.length);
       } 
      out.write(_jsp_string413, 0, _jsp_string413.length);
       if(DocMark.isAllowMark(""+seccategory)){ 
      out.write(_jsp_string414, 0, _jsp_string414.length);
       } 
      out.write(_jsp_string415, 0, _jsp_string415.length);
      }
      out.write(_jsp_string416, 0, _jsp_string416.length);
      pageContext.include("/docs/docs/DocUtil.jsp", "f_weaver_belongto_userid=" + com.caucho.el.Expr.toString(f_weaver_belongto_userid, null)+ "&" + "f_weaver_belongto_usertype=" + com.caucho.el.Expr.toString(f_weaver_belongto_usertype, null)+ "&" + "seccategory=" + com.caucho.el.Expr.toString(seccategory, null)+ "&" + "docid=" + com.caucho.el.Expr.toString(docid, null)+ "&" + "maindoc=" + com.caucho.el.Expr.toString(maindoc, null)+ "&" + "ishistory=" + com.caucho.el.Expr.toString(ishistory, null)+ "&" + "doceditionid=" + com.caucho.el.Expr.toString(doceditionid, null)+ "&" + "olddocid=" + com.caucho.el.Expr.toString(olddocid, null)+ "&" + "isrequest=" + com.caucho.el.Expr.toString(isrequest, null)+ "&" + "desrequestid=" + com.caucho.el.Expr.toString(desrequestid, null)+ "&" + "requestid=" + com.caucho.el.Expr.toString(requestid, null)+ "&" + "fromFlowDoc=" + com.caucho.el.Expr.toString(fromFlowDoc, null)+ "&" + "from=" + com.caucho.el.Expr.toString(from, null)+ "&" + "userCategory=" + com.caucho.el.Expr.toString(userCategory, null)+ "&" + "blnOsp=" + com.caucho.el.Expr.toString(blnOsp, null)+ "&" + "isfromcowork=" + com.caucho.el.Expr.toString(isfromcowork, null)+ "&" + "topageFromOther=" + com.caucho.el.Expr.toString(topageFromOther, null)+ "&" + "meetingid=" + com.caucho.el.Expr.toString(meetingid, null)+ "&" + "isSetShare=" + com.caucho.el.Expr.toString(isSetShare, null)+ "&" + "doc_topage=" + com.caucho.el.Expr.toString(doc_topage, null)+ "&" + "isfromext=" + ("0")+ "&" + "topage=" + com.caucho.el.Expr.toString(URLEncoder.encode(topageFromOther), null)+ "&" + "topage2=" + com.caucho.el.Expr.toString(URLEncoder.encode(topageFromOther), null)+ "&" + "isNoTurnWhenHasToPage=" + com.caucho.el.Expr.toString(isNoTurnWhenHasToPage, null)+ "&" + "isAppendTypeField=" + com.caucho.el.Expr.toString(isAppendTypeField, null), false);
      out.write(_jsp_string417, 0, _jsp_string417.length);
      pageContext.include("/docs/docs/DocComponents.jsp", "f_weaver_belongto_userid=" + com.caucho.el.Expr.toString(f_weaver_belongto_userid, null)+ "&" + "f_weaver_belongto_usertype=" + com.caucho.el.Expr.toString(f_weaver_belongto_usertype, null)+ "&" + "language=" + com.caucho.el.Expr.toString(user.getLanguage(), null)+ "&" + "operation=" + ("getBase"), false);
      out.write(_jsp_string418, 0, _jsp_string418.length);
      out.print((("1").equals(fromFlowDoc)));
      out.write(_jsp_string419, 0, _jsp_string419.length);
      out.print((isApplyMould&&isUseTempletNode&&isremark==0));
      out.write(_jsp_string420, 0, _jsp_string420.length);
      out.print((isSignatureNodes));
      out.write(_jsp_string421, 0, _jsp_string421.length);
      out.print((docid));
      out.write(_jsp_string422, 0, _jsp_string422.length);
      out.print((seccategory));
      out.write(_jsp_string423, 0, _jsp_string423.length);
      out.print((parentids));
      out.write(_jsp_string424, 0, _jsp_string424.length);
      out.print((Util.encodeJS(docsubject)));
      out.write(_jsp_string425, 0, _jsp_string425.length);
      out.print((isreply.equals("1")));
      out.write(_jsp_string426, 0, _jsp_string426.length);
      out.print((doceditionid));
      out.write(_jsp_string427, 0, _jsp_string427.length);
      out.print((readerCanViewHistoryEdition));
      out.write(_jsp_string428, 0, _jsp_string428.length);
      out.print((canEditHis));
      out.write(_jsp_string429, 0, _jsp_string429.length);
      out.print((coworkid));
      out.write(_jsp_string430, 0, _jsp_string430.length);
      out.print((meetingid));
      out.write(_jsp_string431, 0, _jsp_string431.length);
      out.print((canShare));
      out.write(_jsp_string432, 0, _jsp_string432.length);
      out.print((canEdit));
      out.write(_jsp_string433, 0, _jsp_string433.length);
      out.print((canDownload));
      out.write(_jsp_string434, 0, _jsp_string434.length);
      out.print((blnRealViewLog));
      out.write(_jsp_string435, 0, _jsp_string435.length);
      out.print((DocMark.isAllowMark(""+seccategory)));
      out.write(_jsp_string436, 0, _jsp_string436.length);
      out.print((canReplay));
      out.write(_jsp_string437, 0, _jsp_string437.length);
      out.print((readCount_int));
      out.write(_jsp_string438, 0, _jsp_string438.length);
      out.print((DocUtil.getMaxUploadImageSize(seccategory)));
      out.write(_jsp_string439, 0, _jsp_string439.length);
      out.print((requestid));
      out.write(_jsp_string440, 0, _jsp_string440.length);
      out.print(((user.getLanguage()==8)?"true":"false"));
      out.write(_jsp_string441, 0, _jsp_string441.length);
      if("1".equals(isTextInForm)){
      out.write(_jsp_string442, 0, _jsp_string442.length);
      }
      out.write(_jsp_string443, 0, _jsp_string443.length);
      if(isFromAccessory){
      out.write(_jsp_string444, 0, _jsp_string444.length);
      }
      out.write(_jsp_string445, 0, _jsp_string445.length);
      if("1".equals(isTextInForm)){
      out.write(_jsp_string446, 0, _jsp_string446.length);
      }else{
      out.write(_jsp_string447, 0, _jsp_string447.length);
      }
      out.write(_jsp_string448, 0, _jsp_string448.length);
      out.print((accessorycount));
      out.write(_jsp_string449, 0, _jsp_string449.length);
      out.print((isEditionOpen));
      out.write(_jsp_string450, 0, _jsp_string450.length);
      out.print((SystemEnv.getHtmlLabelName(21658,languageId)));
      out.write(_jsp_string451, 0, _jsp_string451.length);
      out.print((SystemEnv.getHtmlLabelName(21700,languageId)));
      out.write(_jsp_string452, 0, _jsp_string452.length);
      out.print((SystemEnv.getHtmlLabelName(21701,languageId)));
      out.write(_jsp_string453, 0, _jsp_string453.length);
      out.print((SystemEnv.getHtmlLabelName(24355,languageId)));
      out.write(_jsp_string454, 0, _jsp_string454.length);
      out.print((isAutoExtendInfo));
      out.write(_jsp_string455, 0, _jsp_string455.length);
      out.print((docid));
      out.write(_jsp_string456, 0, _jsp_string456.length);
      
	  String accUrl="/docs/docs/DocAcc.jsp?canEdit="+canEdit+"&canDownload="+canDownload+"&language="+user.getLanguage()+"&bacthDownloadFlag="+DocUtil.getBatchDownloadFlag(docid)+"&docid="+docid+"&mode=view&pagename=docdsp&isFromWf=false&operation=getDivAcc&maxUploadImageSize="+DocUtil.getBatchDownloadFlag(docid)+"&isrequest="+isrequest+"&requestid="+requestid+"&desrequestid="+desrequestid+"&meetingid="+meetingid+"&votingId="+votingId+"&f_weaver_belongto_userid="+f_weaver_belongto_userid+"&f_weaver_belongto_usertype="+f_weaver_belongto_usertype+formmodeparamsStr;
	  String replyInfoUrl=null;
	  if(DocReplyUtil.isUseNewReply()){
		  replyInfoUrl="/docs/reply/DocReplyGetNew.jsp?docid="+docid+"&secid="+seccategory;
	  }else{
		  replyInfoUrl="/docs/docs/DocReplyGetNew.jsp?docid="+docid+"&secid="+seccategory;
	  }
	  String shareUrl="/docs/docs/DocShareGetNew.jsp?language="+user.getLanguage()+"&id="+docid+"&mode=view&pagename=docdsp&canShare="+canShare+"&operation=getDivShare"; 
	  String verUrl="/docs/docs/DocVersionGetNew.jsp?language="+user.getLanguage()+"&docid="+docid+"&mode=view&pagename=docdsp&canShare="+canShare+"&operation=getDivVer&doceditionid="+doceditionid+"&readerCanViewHistoryEdition="+readerCanViewHistoryEdition+"&canEditHis="+canEditHis; 
	  String logUrl="/docs/DocDetailLogTab.jsp?height=all&_fromURL=0&language="+user.getLanguage()+"&id="+docid+"&mode=view&pagename=docdsp&canShare="+canShare+"&operation=getDivViewLog";
	  String logUrlReaded="/docs/DocDetailLogTab.jsp?height=all&_fromURL=5&language="+user.getLanguage()+"&id="+docid+"&mode=view&pagename=docdsp&canShare="+canShare+"&operation=getDivViewLog";
	  String docmarkUrl="/docs/docmark/DocMarkAdd.jsp?language="+user.getLanguage()+"&docId="+docid+"&mode=view&pagename=docdsp&secId="+seccategory+"&operation=getDivMark&f_weaver_belongto_userid="+f_weaver_belongto_userid+"&f_weaver_belongto_usertype="+f_weaver_belongto_usertype; 	  

      out.write(_jsp_string53, 0, _jsp_string53.length);
      
	RecordSet.executeSql("select d2.isLogControl from docdetail d1,DocSecCategory d2 where d1.seccategory=d2.id and d1.id=" + docid);
	int isLogControl = 0;
	if (RecordSet.next()) {
		isLogControl = Util.getIntValue(Util.null2String(RecordSet.getString("isLogControl")),0);
	}

      out.write(_jsp_string457, 0, _jsp_string457.length);
      out.print((accUrl));
      out.write(_jsp_string458, 0, _jsp_string458.length);
      out.print((replyInfoUrl));
      out.write(_jsp_string459, 0, _jsp_string459.length);
      out.print((shareUrl));
      out.write(_jsp_string460, 0, _jsp_string460.length);
      out.print((verUrl));
      out.write(_jsp_string461, 0, _jsp_string461.length);
      out.print((logUrl));
      out.write(_jsp_string462, 0, _jsp_string462.length);
      out.print((logUrlReaded));
      out.write(_jsp_string463, 0, _jsp_string463.length);
      out.print((docmarkUrl));
      out.write(_jsp_string464, 0, _jsp_string464.length);
       if(canReplay) { 
      out.write(_jsp_string465, 0, _jsp_string465.length);
       if(DocReplyUtil.isUseNewReply()){ 
      out.write(_jsp_string466, 0, _jsp_string466.length);
       } 
      out.write(_jsp_string467, 0, _jsp_string467.length);
       } 
      out.write(_jsp_string468, 0, _jsp_string468.length);
       if(isEditionOpen) { 
      out.write(_jsp_string469, 0, _jsp_string469.length);
       } 
      out.write(_jsp_string395, 0, _jsp_string395.length);
       if(canViewLog) { 
      out.write(_jsp_string470, 0, _jsp_string470.length);
       } 
      out.write(_jsp_string395, 0, _jsp_string395.length);
       if(DocMark.isAllowMark(""+seccategory)){ 
      out.write(_jsp_string471, 0, _jsp_string471.length);
       } 
      out.write(_jsp_string472, 0, _jsp_string472.length);
       if(canReplay) { 
      out.write(_jsp_string473, 0, _jsp_string473.length);
       } 
      out.write(_jsp_string474, 0, _jsp_string474.length);
       if(isEditionOpen) { 
      out.write(_jsp_string475, 0, _jsp_string475.length);
       } 
      out.write(_jsp_string395, 0, _jsp_string395.length);
       if(canViewLog) { 
      out.write(_jsp_string476, 0, _jsp_string476.length);
       } 
      out.write(_jsp_string395, 0, _jsp_string395.length);
       if(DocMark.isAllowMark(""+seccategory)){ 
      out.write(_jsp_string477, 0, _jsp_string477.length);
       } 
      out.write(_jsp_string478, 0, _jsp_string478.length);
       if(canReplay) { 
      out.write(_jsp_string479, 0, _jsp_string479.length);
       } 
      out.write(_jsp_string480, 0, _jsp_string480.length);
       if(isEditionOpen) { 
      out.write(_jsp_string481, 0, _jsp_string481.length);
       } 
      out.write(_jsp_string395, 0, _jsp_string395.length);
       if(canViewLog) { 
      out.write(_jsp_string482, 0, _jsp_string482.length);
       } 
      out.write(_jsp_string395, 0, _jsp_string395.length);
       if(DocMark.isAllowMark(""+seccategory)){ 
      out.write(_jsp_string483, 0, _jsp_string483.length);
       } 
      out.write(_jsp_string484, 0, _jsp_string484.length);
      out.print((docid));
      out.write(_jsp_string485, 0, _jsp_string485.length);
      out.print((canDownload));
      out.write(_jsp_string486, 0, _jsp_string486.length);
      out.print((docid));
      out.write(_jsp_string487, 0, _jsp_string487.length);
      out.print((fromFlowDoc));
      out.write(_jsp_string88, 0, _jsp_string88.length);
      out.print((isrequest));
      out.write(_jsp_string89, 0, _jsp_string89.length);
      out.print((requestid));
      out.write(_jsp_string488, 0, _jsp_string488.length);
      out.print((URLEncoder.encode(topageFromOther)));
      out.write(_jsp_string75, 0, _jsp_string75.length);
      out.print((meetingid));
      out.write(_jsp_string98, 0, _jsp_string98.length);
      out.print((votingId));
      out.write(_jsp_string92, 0, _jsp_string92.length);
      out.print((workplanid));
      out.write(_jsp_string489, 0, _jsp_string489.length);
      if(fromFlowDoc.equals("1") && (filetype.equals(".doc")||filetype.equals(".xls")||filetype.equals(".wps")||filetype.equals(".et"))){
      out.write(_jsp_string490, 0, _jsp_string490.length);
      }
      out.write(_jsp_string491, 0, _jsp_string491.length);
      pageContext.include("/docs/docs/DocDspExtScript.jsp", "f_weaver_belongto_userid=" + com.caucho.el.Expr.toString(f_weaver_belongto_userid, null)+ "&" + "f_weaver_belongto_usertype=" + com.caucho.el.Expr.toString(f_weaver_belongto_usertype, null)+ "&" + "docid=" + com.caucho.el.Expr.toString(docid, null)+ "&" + "fromFlowDoc=" + com.caucho.el.Expr.toString(fromFlowDoc, null)+ "&" + "isIWebOffice2006=" + com.caucho.el.Expr.toString(isIWebOffice2006, null)+ "&" + "requestid=" + com.caucho.el.Expr.toString(requestid, null)+ "&" + "ifVersion=" + com.caucho.el.Expr.toString(ifVersion, null)+ "&" + "isCompellentMark=" + com.caucho.el.Expr.toString(isCompellentMark, null)+ "&" + "canPostil=" + com.caucho.el.Expr.toString(canPostil, null)+ "&" + "nodeid=" + com.caucho.el.Expr.toString(nodeid, null)+ "&" + "isFromAccessory=" + com.caucho.el.Expr.toString(isFromAccessory, null)+ "&" + "topageFromOther=" + com.caucho.el.Expr.toString(topageFromOther, null)+ "&" + "isrequest=" + com.caucho.el.Expr.toString(isrequest, null)+ "&" + "meetingid=" + com.caucho.el.Expr.toString(meetingid, null)+ "&" + "hasUsedTemplet=" + com.caucho.el.Expr.toString(hasUsedTemplet, null)+ "&" + "isPrintControl=" + com.caucho.el.Expr.toString(isPrintControl, null)+ "&" + "doccreaterid=" + com.caucho.el.Expr.toString(doccreaterid, null)+ "&" + "userid=" + com.caucho.el.Expr.toString(userid, null)+ "&" + "hasPrintNode=" + com.caucho.el.Expr.toString(hasPrintNode, null)+ "&" + "isPrintNode=" + com.caucho.el.Expr.toString(isPrintNode, null)+ "&" + "printApplyWorkflowId=" + com.caucho.el.Expr.toString(printApplyWorkflowId, null)+ "&" + "isagentOfprintApply=" + com.caucho.el.Expr.toString(isagentOfprintApply, null)+ "&" + "username=" + com.caucho.el.Expr.toString(username, null)+ "&" + "countNum=" + com.caucho.el.Expr.toString(countNum, null)+ "&" + "isremark=" + com.caucho.el.Expr.toString(isremark, null)+ "&" + "isUseTempletNode=" + com.caucho.el.Expr.toString((isUseTempletNode?1:0), null)+ "&" + "wordmouldid=" + com.caucho.el.Expr.toString(wordmouldid, null)+ "&" + "versionId=" + com.caucho.el.Expr.toString(versionId, null)+ "&" + "isSignatureNodes=" + com.caucho.el.Expr.toString(isSignatureNodes, null)+ "&" + "CurrentDate=" + com.caucho.el.Expr.toString(CurrentDate, null)+ "&" + "CurrentTime=" + com.caucho.el.Expr.toString(CurrentTime, null)+ "&" + "replyid=" + com.caucho.el.Expr.toString(replyid, null)+ "&" + "parentids=" + com.caucho.el.Expr.toString(parentids, null)+ "&" + "workflowid=" + com.caucho.el.Expr.toString(workflowid, null)+ "&" + "PDF417ManagerCopyRight=" + com.caucho.el.Expr.toString(PDF417ManagerCopyRight, null)+ "&" + "canPrint=" + com.caucho.el.Expr.toString((canPrint?1:0), null)+ "&" + "isCleanCopyNodes=" + com.caucho.el.Expr.toString(isCleanCopyNodes, null)+ "&" + "currentnodeid=" + com.caucho.el.Expr.toString(currentnodeid, null), false);
      out.write(_jsp_string2, 0, _jsp_string2.length);
    } catch (java.lang.Throwable _jsp_e) {
      pageContext.handlePageException(_jsp_e);
    } finally {
      _jsp_application.getJspApplicationContext().freePageContext(pageContext);
    }
  }

  private java.util.ArrayList _caucho_depends = new java.util.ArrayList();

  public java.util.ArrayList _caucho_getDependList()
  {
    return _caucho_depends;
  }

  public void _caucho_addDepend(com.caucho.vfs.PersistentDependency depend)
  {
    super._caucho_addDepend(depend);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  public boolean _caucho_isModified()
  {
    if (_caucho_isDead)
      return true;
    if (com.caucho.server.util.CauchoSystem.getVersionId() != 1886798272571451039L)
      return true;
    for (int i = _caucho_depends.size() - 1; i >= 0; i--) {
      com.caucho.vfs.Dependency depend;
      depend = (com.caucho.vfs.Dependency) _caucho_depends.get(i);
      if (depend.isModified())
        return true;
    }
    return false;
  }

  public long _caucho_lastModified()
  {
    return 0;
  }

  public java.util.HashMap<String,java.lang.reflect.Method> _caucho_getFunctionMap()
  {
    return _jsp_functionMap;
  }

  public void init(ServletConfig config)
    throws ServletException
  {
    com.caucho.server.webapp.WebApp webApp
      = (com.caucho.server.webapp.WebApp) config.getServletContext();
    super.init(config);
    com.caucho.jsp.TaglibManager manager = webApp.getJspApplicationContext().getTaglibManager();
    manager.addTaglibFunctions(_jsp_functionMap, "brow", "/browserTag");
    com.caucho.jsp.PageContextImpl pageContext = new com.caucho.jsp.PageContextImpl(webApp, this);
  }

  public void destroy()
  {
      _caucho_isDead = true;
      super.destroy();
  }

  public void init(com.caucho.vfs.Path appDir)
    throws javax.servlet.ServletException
  {
    com.caucho.vfs.Path resinHome = com.caucho.server.util.CauchoSystem.getResinHome();
    com.caucho.vfs.MergePath mergePath = new com.caucho.vfs.MergePath();
    mergePath.addMergePath(appDir);
    mergePath.addMergePath(resinHome);
    com.caucho.loader.DynamicClassLoader loader;
    loader = (com.caucho.loader.DynamicClassLoader) getClass().getClassLoader();
    String resourcePath = loader.getResourcePathSpecificFirst();
    mergePath.addClassPath(resourcePath);
    com.caucho.vfs.Depend depend;
    depend = new com.caucho.vfs.Depend(appDir.lookup("docs/docs/DocDspExt.jsp"), 410897016549104882L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("systeminfo/init_wev8.jsp"), 2425449460466103212L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("wui/common/page/initWui.jsp"), 3390533274175540290L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("docs/docs/iWebOfficeConf.jsp"), -7320618434817471953L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("docs/docs/PDF417ManagerConf.jsp"), -3523863557619498216L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("systeminfo/RightClickMenuConent_wev8.jsp"), 5420623057173200515L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("docs/docs/uploader4replace.jsp"), 4066867161060777578L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("systeminfo/DocTopTitle.jsp"), -5484144349662991250L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("systeminfo/RightClickMenu_wev8.jsp"), 8771637837838951493L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("hrm/resource/simpleHrmResource_wev8.jsp"), -3980235049747804820L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("WEB-INF/tld/browser.tld"), 840991278995890201L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, new com.caucho.make.ClassDependency(weaver.common.util.taglib.BrowserTag.class, -2685375837665967596L));
  }

  static {
    try {
    } catch (Exception e) {
      e.printStackTrace();
      throw new RuntimeException(e);
    }
  }

  private final static char []_jsp_string369;
  private final static char []_jsp_string20;
  private final static char []_jsp_string353;
  private final static char []_jsp_string404;
  private final static char []_jsp_string402;
  private final static char []_jsp_string356;
  private final static char []_jsp_string271;
  private final static char []_jsp_string142;
  private final static char []_jsp_string190;
  private final static char []_jsp_string401;
  private final static char []_jsp_string436;
  private final static char []_jsp_string21;
  private final static char []_jsp_string246;
  private final static char []_jsp_string194;
  private final static char []_jsp_string174;
  private final static char []_jsp_string427;
  private final static char []_jsp_string350;
  private final static char []_jsp_string322;
  private final static char []_jsp_string297;
  private final static char []_jsp_string63;
  private final static char []_jsp_string8;
  private final static char []_jsp_string232;
  private final static char []_jsp_string32;
  private final static char []_jsp_string319;
  private final static char []_jsp_string250;
  private final static char []_jsp_string115;
  private final static char []_jsp_string214;
  private final static char []_jsp_string48;
  private final static char []_jsp_string422;
  private final static char []_jsp_string449;
  private final static char []_jsp_string428;
  private final static char []_jsp_string416;
  private final static char []_jsp_string200;
  private final static char []_jsp_string442;
  private final static char []_jsp_string150;
  private final static char []_jsp_string95;
  private final static char []_jsp_string372;
  private final static char []_jsp_string168;
  private final static char []_jsp_string38;
  private final static char []_jsp_string368;
  private final static char []_jsp_string393;
  private final static char []_jsp_string453;
  private final static char []_jsp_string211;
  private final static char []_jsp_string481;
  private final static char []_jsp_string293;
  private final static char []_jsp_string97;
  private final static char []_jsp_string43;
  private final static char []_jsp_string89;
  private final static char []_jsp_string233;
  private final static char []_jsp_string289;
  private final static char []_jsp_string202;
  private final static char []_jsp_string357;
  private final static char []_jsp_string296;
  private final static char []_jsp_string278;
  private final static char []_jsp_string54;
  private final static char []_jsp_string491;
  private final static char []_jsp_string360;
  private final static char []_jsp_string216;
  private final static char []_jsp_string110;
  private final static char []_jsp_string74;
  private final static char []_jsp_string294;
  private final static char []_jsp_string299;
  private final static char []_jsp_string300;
  private final static char []_jsp_string298;
  private final static char []_jsp_string352;
  private final static char []_jsp_string119;
  private final static char []_jsp_string201;
  private final static char []_jsp_string245;
  private final static char []_jsp_string83;
  private final static char []_jsp_string256;
  private final static char []_jsp_string473;
  private final static char []_jsp_string284;
  private final static char []_jsp_string238;
  private final static char []_jsp_string474;
  private final static char []_jsp_string132;
  private final static char []_jsp_string19;
  private final static char []_jsp_string414;
  private final static char []_jsp_string146;
  private final static char []_jsp_string212;
  private final static char []_jsp_string335;
  private final static char []_jsp_string323;
  private final static char []_jsp_string16;
  private final static char []_jsp_string18;
  private final static char []_jsp_string144;
  private final static char []_jsp_string478;
  private final static char []_jsp_string249;
  private final static char []_jsp_string105;
  private final static char []_jsp_string12;
  private final static char []_jsp_string219;
  private final static char []_jsp_string239;
  private final static char []_jsp_string312;
  private final static char []_jsp_string70;
  private final static char []_jsp_string241;
  private final static char []_jsp_string469;
  private final static char []_jsp_string227;
  private final static char []_jsp_string177;
  private final static char []_jsp_string56;
  private final static char []_jsp_string208;
  private final static char []_jsp_string127;
  private final static char []_jsp_string440;
  private final static char []_jsp_string472;
  private final static char []_jsp_string243;
  private final static char []_jsp_string183;
  private final static char []_jsp_string118;
  private final static char []_jsp_string441;
  private final static char []_jsp_string344;
  private final static char []_jsp_string198;
  private final static char []_jsp_string98;
  private final static char []_jsp_string355;
  private final static char []_jsp_string438;
  private final static char []_jsp_string341;
  private final static char []_jsp_string274;
  private final static char []_jsp_string465;
  private final static char []_jsp_string267;
  private final static char []_jsp_string445;
  private final static char []_jsp_string133;
  private final static char []_jsp_string103;
  private final static char []_jsp_string101;
  private final static char []_jsp_string317;
  private final static char []_jsp_string407;
  private final static char []_jsp_string471;
  private final static char []_jsp_string178;
  private final static char []_jsp_string282;
  private final static char []_jsp_string384;
  private final static char []_jsp_string362;
  private final static char []_jsp_string123;
  private final static char []_jsp_string386;
  private final static char []_jsp_string272;
  private final static char []_jsp_string421;
  private final static char []_jsp_string226;
  private final static char []_jsp_string389;
  private final static char []_jsp_string158;
  private final static char []_jsp_string17;
  private final static char []_jsp_string316;
  private final static char []_jsp_string302;
  private final static char []_jsp_string188;
  private final static char []_jsp_string487;
  private final static char []_jsp_string80;
  private final static char []_jsp_string342;
  private final static char []_jsp_string259;
  private final static char []_jsp_string413;
  private final static char []_jsp_string399;
  private final static char []_jsp_string269;
  private final static char []_jsp_string86;
  private final static char []_jsp_string304;
  private final static char []_jsp_string213;
  private final static char []_jsp_string290;
  private final static char []_jsp_string147;
  private final static char []_jsp_string92;
  private final static char []_jsp_string61;
  private final static char []_jsp_string169;
  private final static char []_jsp_string222;
  private final static char []_jsp_string44;
  private final static char []_jsp_string6;
  private final static char []_jsp_string306;
  private final static char []_jsp_string301;
  private final static char []_jsp_string488;
  private final static char []_jsp_string152;
  private final static char []_jsp_string145;
  private final static char []_jsp_string338;
  private final static char []_jsp_string376;
  private final static char []_jsp_string210;
  private final static char []_jsp_string303;
  private final static char []_jsp_string46;
  private final static char []_jsp_string454;
  private final static char []_jsp_string252;
  private final static char []_jsp_string72;
  private final static char []_jsp_string379;
  private final static char []_jsp_string251;
  private final static char []_jsp_string236;
  private final static char []_jsp_string149;
  private final static char []_jsp_string130;
  private final static char []_jsp_string339;
  private final static char []_jsp_string121;
  private final static char []_jsp_string437;
  private final static char []_jsp_string207;
  private final static char []_jsp_string443;
  private final static char []_jsp_string412;
  private final static char []_jsp_string374;
  private final static char []_jsp_string328;
  private final static char []_jsp_string215;
  private final static char []_jsp_string73;
  private final static char []_jsp_string5;
  private final static char []_jsp_string354;
  private final static char []_jsp_string166;
  private final static char []_jsp_string270;
  private final static char []_jsp_string315;
  private final static char []_jsp_string51;
  private final static char []_jsp_string14;
  private final static char []_jsp_string311;
  private final static char []_jsp_string143;
  private final static char []_jsp_string432;
  private final static char []_jsp_string326;
  private final static char []_jsp_string283;
  private final static char []_jsp_string447;
  private final static char []_jsp_string348;
  private final static char []_jsp_string254;
  private final static char []_jsp_string275;
  private final static char []_jsp_string268;
  private final static char []_jsp_string186;
  private final static char []_jsp_string71;
  private final static char []_jsp_string426;
  private final static char []_jsp_string340;
  private final static char []_jsp_string206;
  private final static char []_jsp_string263;
  private final static char []_jsp_string176;
  private final static char []_jsp_string366;
  private final static char []_jsp_string27;
  private final static char []_jsp_string57;
  private final static char []_jsp_string64;
  private final static char []_jsp_string324;
  private final static char []_jsp_string475;
  private final static char []_jsp_string460;
  private final static char []_jsp_string234;
  private final static char []_jsp_string199;
  private final static char []_jsp_string240;
  private final static char []_jsp_string112;
  private final static char []_jsp_string314;
  private final static char []_jsp_string34;
  private final static char []_jsp_string141;
  private final static char []_jsp_string468;
  private final static char []_jsp_string231;
  private final static char []_jsp_string295;
  private final static char []_jsp_string444;
  private final static char []_jsp_string116;
  private final static char []_jsp_string197;
  private final static char []_jsp_string172;
  private final static char []_jsp_string417;
  private final static char []_jsp_string96;
  private final static char []_jsp_string0;
  private final static char []_jsp_string281;
  private final static char []_jsp_string126;
  private final static char []_jsp_string11;
  private final static char []_jsp_string139;
  private final static char []_jsp_string394;
  private final static char []_jsp_string370;
  private final static char []_jsp_string65;
  private final static char []_jsp_string230;
  private final static char []_jsp_string255;
  private final static char []_jsp_string165;
  private final static char []_jsp_string223;
  private final static char []_jsp_string345;
  private final static char []_jsp_string171;
  private final static char []_jsp_string108;
  private final static char []_jsp_string392;
  private final static char []_jsp_string173;
  private final static char []_jsp_string94;
  private final static char []_jsp_string431;
  private final static char []_jsp_string332;
  private final static char []_jsp_string480;
  private final static char []_jsp_string383;
  private final static char []_jsp_string114;
  private final static char []_jsp_string25;
  private final static char []_jsp_string455;
  private final static char []_jsp_string106;
  private final static char []_jsp_string264;
  private final static char []_jsp_string9;
  private final static char []_jsp_string111;
  private final static char []_jsp_string279;
  private final static char []_jsp_string273;
  private final static char []_jsp_string325;
  private final static char []_jsp_string313;
  private final static char []_jsp_string91;
  private final static char []_jsp_string75;
  private final static char []_jsp_string85;
  private final static char []_jsp_string42;
  private final static char []_jsp_string433;
  private final static char []_jsp_string329;
  private final static char []_jsp_string309;
  private final static char []_jsp_string242;
  private final static char []_jsp_string7;
  private final static char []_jsp_string33;
  private final static char []_jsp_string181;
  private final static char []_jsp_string77;
  private final static char []_jsp_string459;
  private final static char []_jsp_string45;
  private final static char []_jsp_string30;
  private final static char []_jsp_string159;
  private final static char []_jsp_string122;
  private final static char []_jsp_string476;
  private final static char []_jsp_string380;
  private final static char []_jsp_string435;
  private final static char []_jsp_string467;
  private final static char []_jsp_string307;
  private final static char []_jsp_string3;
  private final static char []_jsp_string367;
  private final static char []_jsp_string167;
  private final static char []_jsp_string170;
  private final static char []_jsp_string185;
  private final static char []_jsp_string31;
  private final static char []_jsp_string157;
  private final static char []_jsp_string434;
  private final static char []_jsp_string109;
  private final static char []_jsp_string305;
  private final static char []_jsp_string411;
  private final static char []_jsp_string364;
  private final static char []_jsp_string36;
  private final static char []_jsp_string396;
  private final static char []_jsp_string375;
  private final static char []_jsp_string361;
  private final static char []_jsp_string102;
  private final static char []_jsp_string257;
  private final static char []_jsp_string179;
  private final static char []_jsp_string466;
  private final static char []_jsp_string258;
  private final static char []_jsp_string131;
  private final static char []_jsp_string336;
  private final static char []_jsp_string377;
  private final static char []_jsp_string117;
  private final static char []_jsp_string26;
  private final static char []_jsp_string228;
  private final static char []_jsp_string220;
  private final static char []_jsp_string204;
  private final static char []_jsp_string410;
  private final static char []_jsp_string358;
  private final static char []_jsp_string286;
  private final static char []_jsp_string482;
  private final static char []_jsp_string218;
  private final static char []_jsp_string310;
  private final static char []_jsp_string136;
  private final static char []_jsp_string76;
  private final static char []_jsp_string52;
  private final static char []_jsp_string387;
  private final static char []_jsp_string135;
  private final static char []_jsp_string47;
  private final static char []_jsp_string378;
  private final static char []_jsp_string448;
  private final static char []_jsp_string337;
  private final static char []_jsp_string55;
  private final static char []_jsp_string343;
  private final static char []_jsp_string93;
  private final static char []_jsp_string237;
  private final static char []_jsp_string462;
  private final static char []_jsp_string175;
  private final static char []_jsp_string37;
  private final static char []_jsp_string418;
  private final static char []_jsp_string124;
  private final static char []_jsp_string90;
  private final static char []_jsp_string15;
  private final static char []_jsp_string128;
  private final static char []_jsp_string262;
  private final static char []_jsp_string62;
  private final static char []_jsp_string138;
  private final static char []_jsp_string99;
  private final static char []_jsp_string244;
  private final static char []_jsp_string41;
  private final static char []_jsp_string334;
  private final static char []_jsp_string235;
  private final static char []_jsp_string385;
  private final static char []_jsp_string318;
  private final static char []_jsp_string88;
  private final static char []_jsp_string464;
  private final static char []_jsp_string261;
  private final static char []_jsp_string457;
  private final static char []_jsp_string79;
  private final static char []_jsp_string68;
  private final static char []_jsp_string400;
  private final static char []_jsp_string483;
  private final static char []_jsp_string479;
  private final static char []_jsp_string192;
  private final static char []_jsp_string84;
  private final static char []_jsp_string1;
  private final static char []_jsp_string13;
  private final static char []_jsp_string320;
  private final static char []_jsp_string100;
  private final static char []_jsp_string456;
  private final static char []_jsp_string287;
  private final static char []_jsp_string425;
  private final static char []_jsp_string484;
  private final static char []_jsp_string321;
  private final static char []_jsp_string163;
  private final static char []_jsp_string35;
  private final static char []_jsp_string452;
  private final static char []_jsp_string395;
  private final static char []_jsp_string4;
  private final static char []_jsp_string209;
  private final static char []_jsp_string184;
  private final static char []_jsp_string346;
  private final static char []_jsp_string291;
  private final static char []_jsp_string381;
  private final static char []_jsp_string363;
  private final static char []_jsp_string161;
  private final static char []_jsp_string120;
  private final static char []_jsp_string113;
  private final static char []_jsp_string154;
  private final static char []_jsp_string373;
  private final static char []_jsp_string50;
  private final static char []_jsp_string391;
  private final static char []_jsp_string229;
  private final static char []_jsp_string160;
  private final static char []_jsp_string486;
  private final static char []_jsp_string191;
  private final static char []_jsp_string265;
  private final static char []_jsp_string155;
  private final static char []_jsp_string23;
  private final static char []_jsp_string104;
  private final static char []_jsp_string347;
  private final static char []_jsp_string280;
  private final static char []_jsp_string69;
  private final static char []_jsp_string485;
  private final static char []_jsp_string461;
  private final static char []_jsp_string490;
  private final static char []_jsp_string327;
  private final static char []_jsp_string125;
  private final static char []_jsp_string405;
  private final static char []_jsp_string351;
  private final static char []_jsp_string266;
  private final static char []_jsp_string196;
  private final static char []_jsp_string53;
  private final static char []_jsp_string423;
  private final static char []_jsp_string10;
  private final static char []_jsp_string420;
  private final static char []_jsp_string260;
  private final static char []_jsp_string156;
  private final static char []_jsp_string419;
  private final static char []_jsp_string153;
  private final static char []_jsp_string470;
  private final static char []_jsp_string49;
  private final static char []_jsp_string397;
  private final static char []_jsp_string285;
  private final static char []_jsp_string205;
  private final static char []_jsp_string182;
  private final static char []_jsp_string140;
  private final static char []_jsp_string137;
  private final static char []_jsp_string253;
  private final static char []_jsp_string40;
  private final static char []_jsp_string277;
  private final static char []_jsp_string430;
  private final static char []_jsp_string78;
  private final static char []_jsp_string439;
  private final static char []_jsp_string371;
  private final static char []_jsp_string134;
  private final static char []_jsp_string22;
  private final static char []_jsp_string390;
  private final static char []_jsp_string365;
  private final static char []_jsp_string288;
  private final static char []_jsp_string415;
  private final static char []_jsp_string221;
  private final static char []_jsp_string450;
  private final static char []_jsp_string67;
  private final static char []_jsp_string29;
  private final static char []_jsp_string330;
  private final static char []_jsp_string87;
  private final static char []_jsp_string331;
  private final static char []_jsp_string82;
  private final static char []_jsp_string129;
  private final static char []_jsp_string58;
  private final static char []_jsp_string359;
  private final static char []_jsp_string81;
  private final static char []_jsp_string382;
  private final static char []_jsp_string148;
  private final static char []_jsp_string429;
  private final static char []_jsp_string292;
  private final static char []_jsp_string446;
  private final static char []_jsp_string60;
  private final static char []_jsp_string59;
  private final static char []_jsp_string203;
  private final static char []_jsp_string349;
  private final static char []_jsp_string489;
  private final static char []_jsp_string180;
  private final static char []_jsp_string225;
  private final static char []_jsp_string151;
  private final static char []_jsp_string28;
  private final static char []_jsp_string24;
  private final static char []_jsp_string224;
  private final static char []_jsp_string189;
  private final static char []_jsp_string187;
  private final static char []_jsp_string458;
  private final static char []_jsp_string217;
  private final static char []_jsp_string248;
  private final static char []_jsp_string406;
  private final static char []_jsp_string162;
  private final static char []_jsp_string66;
  private final static char []_jsp_string408;
  private final static char []_jsp_string39;
  private final static char []_jsp_string308;
  private final static char []_jsp_string333;
  private final static char []_jsp_string424;
  private final static char []_jsp_string409;
  private final static char []_jsp_string247;
  private final static char []_jsp_string195;
  private final static char []_jsp_string463;
  private final static char []_jsp_string388;
  private final static char []_jsp_string276;
  private final static char []_jsp_string107;
  private final static char []_jsp_string403;
  private final static char []_jsp_string193;
  private final static char []_jsp_string398;
  private final static char []_jsp_string2;
  private final static char []_jsp_string477;
  private final static char []_jsp_string164;
  private final static char []_jsp_string451;
  static {
    _jsp_string369 = "\r\n								<div style=\"display:".toCharArray();
    _jsp_string20 = "&f_weaver_belongto_usertype=".toCharArray();
    _jsp_string353 = "</a>\r\n					 ".toCharArray();
    _jsp_string404 = "</SPAN></SPAN>\r\n		</EM>\r\n		</A>\r\n		</LI>\r\n		\r\n		<LI id=divPropATab class=\"e8_weavertab_li \" onclick=\"onActiveTab('divProp');\">\r\n		<A class=x-tab-strip-close onclick=\"return false;\"></A>\r\n		<A class=x-tab-right onclick=\"return false;\" href=\"#\">\r\n		<EM class=x-tab-left>\r\n		<SPAN class=x-tab-strip-inner><SPAN class=\"x-tab-strip-text \">".toCharArray();
    _jsp_string402 = "\r\n		</div>\r\n	</div>\r\n</div>\r\n</div>\r\n\r\n	<!-- \u5e95\u90e8\u9009\u9879\u5361\u680f start -->\r\n	".toCharArray();
    _jsp_string356 = "<font id=\"fuserFont\">".toCharArray();
    _jsp_string271 = "\">\r\n		<input type=hidden name=\"hrmIds\" value=\"".toCharArray();
    _jsp_string142 = "\"==\".pptx\"){\r\n		file_types=\"*.ppt;*.pptx\";		\r\n	}  else if(\"".toCharArray();
    _jsp_string190 = "\r\n		return false;\r\n		".toCharArray();
    _jsp_string401 = "\r\n	".toCharArray();
    _jsp_string436 = ";\r\n	var canReplay=".toCharArray();
    _jsp_string21 = "\";\r\n	    xmlhttp.open(\"GET\",URL, false);\r\n	    xmlhttp.send(null);\r\n	    var result = xmlhttp.status;\r\n	    if(result==200) {\r\n		    isconn = true;\r\n	    	var response_flag = xmlhttp.responseText;\r\n	    	if(response_flag!='0') {\r\n	    		var flag_msg = '';\r\n	    		if(response_flag=='1') {\r\n	    			var diag = new Dialog();\r\n					diag.Width = 300;\r\n					diag.Height = 180;\r\n					diag.ShowCloseButton=false;\r\n					diag.Title = \"".toCharArray();
    _jsp_string246 = "\">\r\n	<input type=hidden id=projectid name=projectid value=\"".toCharArray();
    _jsp_string194 = "\";\r\nvar __closeRightMenu__ = ".toCharArray();
    _jsp_string174 = ">\";\r\n		shtml += shtmlTemp;	\r\n		shtml += \"</body></html>\";\r\n		if(_menuDocument.getElementById(\"rightMenuIframe\")&&_menuDocument.getElementById(\"rightMenuIframe\").contentWindow){\r\n			if(!!_contentWindow){\r\n				//_menuDocument.getElementById(\"rightMenuIframe\").contentWindow.__parent = _contentWindow;\r\n			}\r\n			_menuDocument.getElementById(\"rightMenuIframe\").contentWindow.document.writeln(shtml);\r\n			_menuDocument.getElementById(\"rightMenuIframe\").contentWindow.document.close(); \r\n			try{\r\n			 	if(_menuDocument.getElementById(\"rightMenuIframe\").contentWindow.document.getElementById(\"menuTable\").innerHTML == \"\"){\r\n					_menuDocument.getElementById(\"rightMenu\").style.display = \"none\";\r\n				}\r\n			}catch(e){}\r\n		}\r\n		\r\n		try{\r\n			var pageId = jQuery(\"#pageId\").val();\r\n			if(!pageId || (!!jQuery(\"#pageId\").attr(\"_showCol\") && jQuery(\"#pageId\").attr(\"_showCol\").toLowerCase()==\"false\")){\r\n				hiddenRCMenuItem(".toCharArray();
    _jsp_string427 = "\";\r\n	var readerCanViewHistoryEdition=\"".toCharArray();
    _jsp_string350 = "\" class=\"praiseuser_a\" onclick=\"pointerXY(event);\">".toCharArray();
    _jsp_string322 = "')\" value=\"".toCharArray();
    _jsp_string297 = "\"></input>\r\n			    		 ".toCharArray();
    _jsp_string63 = "\";\r\n//\u5f53\u524d\u4e3b\u9898\u4f7f\u7528\u7684\u76ae\u80a4\r\nvar GLOBAL_SKINS_FOLDER = \"".toCharArray();
    _jsp_string8 = "\r\n<script type=\"text/javascript\" src=\"/js/select/script/jquery-1.8.3.min_wev8.js\"></script>	    \r\n".toCharArray();
    _jsp_string232 = "\">    \r\n	<input type=hidden name=doccreatedate value=\"".toCharArray();
    _jsp_string32 = "\", function () {\r\n						    formElementFocus(tempElement);						\r\n							});\r\n						}\r\n						return false;\r\n					}else{\r\n						if(window.__oriAlert__){\r\n							try{\r\n								window.top.Dialog.alert(\"".toCharArray();
    _jsp_string319 = "\r\n				  ".toCharArray();
    _jsp_string250 = "\">\r\n	<input type=\"hidden\" id=\"dummycata\" name=\"dummycata\" value=\"".toCharArray();
    _jsp_string115 = "up\");\r\n						$name.attr(\"title\",\"".toCharArray();
    _jsp_string214 = "\r\n						</tr>\r\n					</table>\r\n				</div>\r\n			</td>\r\n			<td valign=\"top\">\r\n				<div style=\"position:absolute;top: -17px;left: 438px\">\r\n					<img id=\"closetext\" style=\"cursor: hand;\"src=\"/images/messageimages/temp/closeicno_wev8.png\" onclick=\"javascript:closediv();\"/>\r\n				</div>\r\n				<div id=\"showSQRCodeDiv\" style=\"text-align: left;position:absolute;top: -20px;left: 350px; \" onclick=\"createQCode()\"></div>	\r\n				<table width=\"257px\" height=\"293px\" border=\"0\" style=\"padding-left: 16px;padding-top: 0px\" bgcolor=\"#FFFFFF\" cellpadding=\"0\" cellspacing=\"0\">\r\n					<tr height=\"40px\">\r\n						<td>\r\n							<div>\r\n								<img id=\"isonline\" src=\"/images/messageimages/temp/online_wev8.png\" width=\"19\" height=\"19\" style=\"vertical-align:top;\">&nbsp;<span class=\"STYLE4\" id=\"result1\"></span>&nbsp;<span class=\"STYLE6\" id=\"result2\"></span> &nbsp;<span class=\"STYLE6\" id=\"result13\"></span>&nbsp;&nbsp;&nbsp;&nbsp;\r\n								<img src=\"/images/messageimages/temp/qcode_wev8.png\" width=\"19\" height=\"19\" style=\"vertical-align:middle;cursor: hand;\" onclick=\"createQCode()\">\r\n							</div>\r\n						</td>\r\n					</tr>\r\n					<tr style=\"height:1px!important;\" class=\"Spacing\">\r\n						<td><div class=\"intervalDivClass\"></div></td>\r\n					</tr>\r\n					<tr style=\"height:4px!important;\">\r\n						<td></td>\r\n					</tr>\r\n					<tr>\r\n						<td>\r\n							<table height=\"203px\">\r\n								<tr>\r\n									<td style=\"WORD-WRAP: break-word;TEXT-VALIGN: left;word-break:break-all;\">\r\n										<span class=\"STYLE6\">".toCharArray();
    _jsp_string48 = "\";\r\ndoCheckusb();\r\n</script>\r\n".toCharArray();
    _jsp_string422 = "\";\r\n	var seccategory=\"".toCharArray();
    _jsp_string449 = ";\r\n	var isEditionOpen=".toCharArray();
    _jsp_string428 = "\";\r\n	var canEditHis=\"".toCharArray();
    _jsp_string416 = "\r\n		<!-- \u5e95\u90e8\u9009\u9879\u5361\u680f end -->\r\n	<div id=\"divPropTab\" style=\"display:none;width: 100%\">\r\n</div>\r\n</div>\r\n</FORM>\r\n\r\n".toCharArray();
    _jsp_string200 = "\r\n	_menuDocument.getElementById(\"rightMenu\").style.visibility=\"hidden\";\r\n	if (!_menuWindow.ActiveXObject) {\r\n		_menuDocument.getElementById(\"rightMenu\").style.display=\"none\";\r\n	}\r\n	".toCharArray();
    _jsp_string442 = "\r\n			jQuery(\"div.e8AccListArea\").css(\"display\",\"none\");\r\n			jQuery(\"div.e8AccListBtn\").hide();\r\n			jQuery(\"#e8DocAccviewIframe\").hide();\r\n			".toCharArray();
    _jsp_string150 = "&id=\"+_docid+\"&versionId=\"+_versionid+\"&imagefileId=\"+_imagefileid+\"&isrequest=".toCharArray();
    _jsp_string95 = "\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n	function onDownload(){\r\n		//\u5982\u679c\u4e3a\u975eIE\u6d4f\u89c8\u5668\u6216\u8be5\u6587\u6863\u6240\u5728\u76ee\u5f55\u672a\u5f00\u542f\u9501\u5b9a\u67e5\u770b\u529f\u80fd\uff0c\u5219\u4f7f\u7528\u670d\u52a1\u5668\u4e0b\u8f7d\r\n		".toCharArray();
    _jsp_string372 = "top:-120px".toCharArray();
    _jsp_string168 = "*lineCount;\r\n	//_menuWindow.status = \"bodyWidth:\"+bodyWidth+\" | menuCountLine:\"+menuCountLine+\" | lineCount:\"+lineCount;\r\n	_menuDocument.getElementById(\"rightMenuIframe\").height = h + \"px\";\r\n\r\n	_menuWindow.frames[\"rightMenuIframe\"]._menuDocument.getElementById(\"menuTable\").style.height = h + \"px\";\r\n	".toCharArray();
    _jsp_string38 = "\");\r\n						}else{\r\n							window.top.Dialog.alert(\"".toCharArray();
    _jsp_string368 = "\" frameborder=\"0\" width=\"100%\" height=\"100%\"></iframe>\r\n								</div>\r\n							".toCharArray();
    _jsp_string393 = "\r\n		<!-- \u6587\u6863\u5171\u4eab\u680f start -->\r\n		<div id=\"divShare\" class=\"e8_propTab\" style=\"display:none;width:100%;height:100%;\">\r\n			<DIV style=\"width:100%; height:100%; overflow: visible;border:none;\" class=\"x-tab-panel-body x-tab-panel-body-noheader x-tab-panel-body-noborder x-tab-panel-body-bottom\">\r\n			<iframe  id=\"shareListIfrm\" style=\"border:none;\" frameborder=\"0\" width=\"100%\" height=\"100%\"></iframe>\r\n			</DIV>\r\n		</div>\r\n		<!-- \u6587\u6863\u5171\u4eab\u680f end -->\r\n		".toCharArray();
    _jsp_string453 = "\";\r\n	var message24355 = \"".toCharArray();
    _jsp_string211 = "\r\n							<td><img src=\"/images/messageimages/temp/msn_wev8.png\" onmouseover=\"javascript:this.src='/images/messageimages/temp/msnhot_wev8.png';\" onmouseout=\"javascript:this.src='/images/messageimages/temp/msn_wev8.png';\" onclick=\"javascript:openmessage();\" title=\"".toCharArray();
    _jsp_string481 = "\r\n		else if(document.getElementById(\"divVer\").style.display!='none')\r\n			resizedivVer();\r\n		".toCharArray();
    _jsp_string293 = "\r\n							<input type=button class=\"e8_btn_top\" onclick=\"javascript:webOfficeMenuClickNew(8)\" value=\"".toCharArray();
    _jsp_string97 = "&download=1&requestid=".toCharArray();
    _jsp_string43 = "\";\r\n\r\n  if(companyname.length >0 ){\r\n  	window.status = str1+companyname;\r\n  }\r\n</script>\r\n<!-- \u5220\u9664 -->\r\n</head></html>\r\n\r\n<!--USB \u9a8c\u8bc1 -->\r\n".toCharArray();
    _jsp_string89 = "&requestid=".toCharArray();
    _jsp_string233 = "\">\r\n	<input type=hidden name=doccreatetime value=\"".toCharArray();
    _jsp_string289 = "\r\n								<input type=button class=\"e8_btn_top\" onclick=\"javascript:onSave()\" value=\"".toCharArray();
    _jsp_string202 = "\";\r\n        dialog.Width = 550 ;\r\n        dialog.Height = 600;\r\n        dialog.Drag = true;\r\n        dialog.show();\r\n    });\r\n}\r\n\r\nfunction ___showHelp(flag){\r\n    /*var pathKey = this.location.pathname;\r\n    //alert(pathKey);\r\n    if(pathKey!=\"\"){\r\n        pathKey = pathKey.substr(1);\r\n    }*/\r\n    var pathKey = \"\";\r\n	var __url = this.location.href;\r\n	try {\r\n		var __regexp = new RegExp(\"http://[^/]+\", \"gmi\");\r\n		__url = __url.replace(__regexp, '');\r\n	} catch (e) {}\r\n	pathKey = encodeURIComponent(__url);\r\n    var operationPage = \"http://help.e-cology.com.cn/help/RemoteHelp.jsp\";\r\n    var screenWidth = window.screen.width*1;\r\n    var screenHeight = window.screen.height*1;\r\n    var isEnableExtranetHelp = ".toCharArray();
    _jsp_string357 = "</font>".toCharArray();
    _jsp_string296 = "\r\n			    		  	  <input type=button class=\"e8_btn_top\" onclick=\"javascript:doReply();\" value=\"".toCharArray();
    _jsp_string278 = "\">\r\n	<input type=\"hidden\" id=\"canPrintedNum\" name=\"canPrintedNum\" value=\"".toCharArray();
    _jsp_string54 = "\r\n<!--For wui-->\r\n<link type='text/css' rel='stylesheet'  href='/wui/theme/".toCharArray();
    _jsp_string491 = "\r\n			\r\n			try{\r\n				onLoad();\r\n			} catch(e){}\r\n			\r\n			try{\r\n				document.getElementById(\"divContentTab\").style.display='block';\r\n				document.getElementById(\"divPropTab\").style.display = \"none\";\r\n				//document.getElementById(\"divPropTabCollapsed\").style.display = \"block\";\r\n\r\n				//onActiveTab(\"divProp\",true);\r\n				setE8ShadowPosition(\"divContentInfo\");\r\n				\r\n				document.getElementById('rightMenu').style.visibility=\"hidden\";\r\n				document.getElementById(\"divMenu\").style.display='';	\r\n			} catch(e){}\r\n\r\n			adjustContentHeight(\"load\");\r\n			if(isFromWf) {			 \r\n				try{\r\n					if(isFromWfTH && isFromWfSN){\r\n					  //Ext.getCmp('signature_id1').hide();\r\n					  document.getElementById('signature_id1').style.display = \"none\";\r\n					  //Ext.getCmp('signature_id2').hide();\r\n					  document.getElementById('signature_id2').style.display = \"none\";\r\n					}\r\n			    	//Ext.getCmp('hide_id').hide();\r\n			    	document.getElementById('hide_id').style.display = \"none\";\r\n				} catch(e){}\r\n		    }\r\n				finalDo(\"view\");\r\n			try{	\r\n				onLoadEnd();\r\n			} catch(e){}\r\n		}   \r\n	);\r\n	\r\n	function webOfficeMenuClickNew(type){\r\n		webOfficeMenuClick(type,\"\");\r\n	}\r\n</SCRIPT>\r\n<script type=\"text/javascript\" src=\"/js/DocDspExt_wev8.js\"></script>\r\n".toCharArray();
    _jsp_string360 = "</span>\r\n				    ".toCharArray();
    _jsp_string216 = "&nbsp;:&nbsp;&nbsp;&nbsp;</span>\r\n										<span class=\"STYLE61\" id=\"result9\"></span>\r\n									</td>\r\n								</tr>\r\n								<tr>\r\n									<td style=\"WORD-WRAP: break-word;TEXT-VALIGN: left;word-break:break-all;\">\r\n										<span class=\"STYLE6\">".toCharArray();
    _jsp_string110 = ");\r\n						});\r\n					}\r\n					else\r\n					{\r\n						jQuery(\"#praiseInfo\").bind(\"click\",function (){\r\n							unPraise(".toCharArray();
    _jsp_string74 = "&f_weaver_belongto_userid=".toCharArray();
    _jsp_string294 = "    \r\n			    		  	   <input type=button class=\"e8_btn_top\" onclick=\"javascript:newDoReply();\" value=\"".toCharArray();
    _jsp_string299 = "\r\n							<input type=button class=\"e8_btn_top\" onclick=\"javascript:webOfficeMenuClickNew(39)\" value=\"".toCharArray();
    _jsp_string300 = "\r\n					".toCharArray();
    _jsp_string298 = "\r\n			    		".toCharArray();
    _jsp_string352 = "\" class=\"praiseuser_a_hidden\" onclick=\"pointerXY(event);\">".toCharArray();
    _jsp_string119 = "\r\n			},\r\n			cache: false,\r\n			async:false,\r\n			dataType: 'json',\r\n			success: function(msg){\r\n				jQuery(\"#praiseInfo\").unbind(\"click\");\r\n					jQuery(\"#praiseInfo\").bind('click',function(){\r\n						praise(replyid, replytype,docid);\r\n					});\r\n					var index = parseInt(jQuery(\"#praiseCount\").text());\r\n					if(index - 1 > 0)\r\n						{\r\n							jQuery(\"#praiseCount\").text(index-1);\r\n						}\r\n		  				else\r\n		  				{\r\n		  					jQuery(\"#praiseCount\").text(\"0\");\r\n		  					jQuery(\"#noPraise\").show();\r\n		  				}\r\n		  			if(index-1 > 12)\r\n		  			{\r\n						if(jQuery(\"#".toCharArray();
    _jsp_string201 = "\r\n//alert(rightMenu.style.visibility);\r\n//alert(rightMenu.innerHTML);\r\n\r\n function viewSourceUrl()\r\n{\r\n\r\n    prompt(\"\",location);\r\n\r\n}\r\nvar mouse_event;\r\nfunction onRCMenu_copy(){\r\n	var copy_text = _menuDocument.selection.createRange().text;\r\n	//alert(copy_text);\r\n	try{\r\n		if(copy_text==''){\r\n			copy_text = doccontentifm.document.selection.createRange().text;\r\n		}\r\n		if(copy_text===''){\r\n			copy_text = doccontentifm.spanContentFrame.document.selection.createRange().text;\r\n		}\r\n	}catch(e){\r\n		copy_text = ShowSelection();\r\n	}\r\n	_menuWindow.clipboardData.setData(\"Text\", copy_text);\r\n	_menuDocument.getElementById(\"rightMenu\").style.visibility=\"hidden\";\r\n	//rightMenu.style.display=\"none\";\r\n}\r\n\r\nfunction ShowSelection()    {\r\n	if(_menuDocument.getElementById('FCKiframefieldid')){\r\n		 return _menuDocument.getElementById(_menuDocument.getElementById('FCKiframefieldid').value).contentWindow.document.selection.createRange().text;       \r\n	}else{\r\n		return \"\";\r\n	}\r\n}\r\n\r\nfunction onRCMenu_plaster(){\r\n\r\n	if(_menuWindow.clipboardData.getData(\"Text\") != null){\r\n		try{\r\n			var plaster_text = _menuWindow.clipboardData.getData(\"Text\");\r\n			//e = _menuDocument.activeElement;\r\n			//e = body.focus;\r\n            //alert(focus_e.tagName);\r\n			if((focus_e && focus_e.tagName==\"INPUT\" && focus_e.type==\"text\")||(focus_e && focus_e.tagName==\"TEXTAREA\")){\r\n				var selectText = getSelectTxt();\r\n				var pos = getCursorPos(focus_e);\r\n				if(pos==0){\r\n					focus_e.value=focus_e.value.replace(selectText,\"\");\r\n					focus_e.value = plaster_text+focus_e.value;\r\n				}else if(pos==focus_e.value.length){\r\n					focus_e.value=focus_e.value.replace(selectText,\"\");\r\n					focus_e.value = focus_e.value+plaster_text;\r\n				}else if(pos>0&&pos<focus_e.value.length){\r\n					focus_e.value=focus_e.value.replace(selectText,\"\");\r\n					var tmp1 = focus_e.value.substring(0,pos);\r\n					var tmp2 = focus_e.value.substring(pos,focus_e.value.length);\r\n					focus_e.value = tmp1+plaster_text+tmp2;\r\n				}\r\n				focus_e.fireEvent('onchange');	\r\n			}\r\n			_menuDocument.getElementById(\"rightMenu\").style.visibility=\"hidden\";\r\n			_menuDocument.getElementById(\"rightMenu\").style.display=\"none\";\r\n		}catch(e){\r\n			alert(e)\r\n        }\r\n	}\r\n}\r\n\r\nfunction getSelectTxt(){\r\n	var selectTxt;\r\n	selectTxt=document.selection.createRange().text;    \r\n	return selectTxt;\r\n}\r\n\r\nfunction getCursorPos(obj)     \r\n{   \r\n	obj.focus();   \r\n	var currentRange=document.selection.createRange();   \r\n	var workRange=currentRange.duplicate();   \r\n	obj.select();   \r\n	var allRange=document.selection.createRange();   \r\n	var pos=0;   \r\n	while(workRange.compareEndPoints(\"StartToStart\",allRange)>0)   \r\n	{   \r\n	  workRange.moveStart(\"character\",-1);   \r\n	  pos++;   \r\n	}   \r\n	currentRange.select();   \r\n	return   pos;   \r\n}   \r\nfunction getCursorPos1(inpObj){\r\n    if(navigator.userAgent.indexOf(\"MSIE\") > -1) { // IE\r\n    		alert(\"ie\")\r\n            var range = document.selection.createRange();\r\n            range.text = '';\r\n            alert(inpObj.createTextRange())\r\n            range.setEndPoint('StartToStart',inpObj.createTextRange());\r\n            return range.text.length;\r\n        } else {\r\n            return inpObj.selectionStart;\r\n        }\r\n}\r\n\r\nfunction showTDTitle(o)\r\n{\r\n	o.title = o.innerText;\r\n}\r\n//\u663e\u793a\u6307\u5b9a\u5e8f\u53f7\u7684\u53f3\u952e\u83dc\u5355 luow TD30081 TD30084\r\nfunction showRCMenuItem(menuIntemIndex){\r\n	var rightMenuIframeDocument = _menuDocument.getElementById(\"rightMenuIframe\").contentWindow.document;\r\n	rightMenuIframeDocument.getElementById('menuItemDivId'+menuIntemIndex).style.display=\"\";\r\n	var menuCount = 0; \r\n	jQuery(\"#menuTable\", rightMenuIframeDocument).children().each(function () {\r\n		if (jQuery(this).css(\"display\") != null && jQuery(this).css(\"display\").toLowerCase() != \"none\") {\r\n			menuCount++;\r\n		}\r\n	});\r\n	\r\n	\r\n	jQuery(\"#rightMenuIframe\").css(\"height\", (menuCount * 22+6) + \"px\");\r\n}\r\n//\u9690\u85cf\u6307\u5b9a\u5e8f\u53f7\u7684\u53f3\u952e\u83dc\u5355 luow TD30081 TD30084\r\nfunction hiddenRCMenuItem(menuIntemIndex){	\r\n	var rightMenuIframeDocument = _menuDocument.getElementById(\"rightMenuIframe\").contentWindow.document;\r\n	\r\n	jQuery(\"#menuItemDivId\"+menuIntemIndex,rightMenuIframeDocument).hide();\r\n	\r\n	var menuCount = 0; \r\n	jQuery(\"#menuTable\", rightMenuIframeDocument).children().each(function () {\r\n		if (!jQuery(this).css(\"display\") || jQuery(this).css(\"display\").toLowerCase() != \"none\") {\r\n			menuCount++;\r\n		}\r\n	});\r\n	\r\n	jQuery(\"#rightMenuIframe\").css(\"height\", (menuCount * 22+6) + \"px\");\r\n}\r\n\r\n//writeIframe();\r\n    if (_menuWindow.addEventListener){\r\n	    _menuWindow.addEventListener(\"load\", writeIframe, false);\r\n	}else if (_menuWindow.attachEvent){\r\n	    _menuWindow.attachEvent(\"onload\", writeIframe);\r\n	}else{\r\n	    _menuWindow.onload=writeIframe;\r\n	}\r\nfunction __openFavouriteBrowser(flag) {\r\n	___openFavouriteBrowser(flag);\r\n}\r\n\r\nfunction __showHelp(flag) {\r\n	if (typeof(showHelp) == 'function') {\r\n		showHelp();\r\n	} else {\r\n		___showHelp(flag);\r\n	}\r\n}\r\n\r\nfunction ___openFavouriteBrowser(flag) {  \r\n	var BacoTitle = parent.jQuery(\"#objName\");\r\n	if (!!!BacoTitle[0]) {\r\n		BacoTitle = parent.jQuery(\"#e8_navtab\");\r\n	}\r\n	var pagename = \"\";\r\n	\r\n	var fav_uri = \"\";\r\n	var fav_querystring = \"\";\r\n	\r\n	var __url = parent.window.location.href;\r\n	try {\r\n		var __regexp = new RegExp(\"http://[^/]+\", \"gmi\");\r\n		__url = __url.replace(__regexp, '');\r\n	} catch (e) {\r\n	}\r\n	if (__url.indexOf(\"?\") == -1) {\r\n		fav_uri = __url;\r\n	} else {\r\n		fav_uri = escape(__url.substring(0, __url.indexOf(\"?\")));\r\n		fav_querystring = escape(escape(__url.substr(__url.indexOf(\"?\") + 1)));\r\n	}\r\n	try {\r\n		var e8tabcontainer = jQuery(\"div[_e8tabcontainer='true']\",parent.document);\r\n		if(e8tabcontainer.length > 0)  {\r\n		    fav_uri = escape(parent.window.location.pathname);\r\n			fav_querystring = (escape(jQuery.trim(parent.window.location.search)));\r\n		}\r\n	} catch(e) {}\r\n	if (BacoTitle) {\r\n		pagename = BacoTitle.text();\r\n	}\r\n	\r\n	if (flag == -9) {\r\n		var __reqname = jQuery(\"input[name=requestname]\").val();\r\n		if (!!__reqname && __reqname != \"\") {\r\n			pagename = __reqname;\r\n		}\r\n	}\r\n	pagename = jQuery.trim(pagename);\r\n\r\n    jQuery.post(\"/systeminfo/FavouriteSession.jsp\",{pagename:pagename},function (data) {\r\n        var sessionKey = data.sessionKey;\r\n        var dialogurl = '/systeminfo/BrowserMain.jsp?url=/favourite/FavouriteBrowser.jsp&fav_pagename='+sessionKey+'&fav_uri='+fav_uri+'&fav_querystring='+fav_querystring+'&mouldID=doc';\r\n        var dialog = new window.top.Dialog();\r\n        dialog.currentWindow = window;\r\n        dialog.URL = dialogurl;\r\n        dialog.Title = \"".toCharArray();
    _jsp_string245 = "\">\r\n	<input type=hidden id=itemid name=itemid value=\"".toCharArray();
    _jsp_string83 = "\")) {\r\n					location=\"DocDsp.jsp?fromFlowDoc=".toCharArray();
    _jsp_string256 = ">\r\n	<input type=hidden id=\"hasUsedTemplet\" name=hasUsedTemplet value=\"".toCharArray();
    _jsp_string473 = "\r\n		document.getElementById(\"divReplayATab\").className = \"\";\r\n		".toCharArray();
    _jsp_string284 = "\r\n							<input type=button class=\"e8_btn_top\" id=\"AccPlaceHolder\"   value=\"".toCharArray();
    _jsp_string238 = "\">\r\n	<INPUT type=hidden name=subcategory value=\"".toCharArray();
    _jsp_string474 = "\r\n		document.getElementById(\"divShareATab\").className = \"\";\r\n		".toCharArray();
    _jsp_string132 = "\">\r\n    </form>\r\n\r\n    <FORM id=weaver name=weaver action=\"UploadDoc.jsp?fromFlowDoc=".toCharArray();
    _jsp_string19 = "&time=\"+new Date()+\"&f_weaver_belongto_userid=".toCharArray();
    _jsp_string414 = "\r\n		<LI id=divMarkATab class=\" \"  onclick=\"onActiveTab('divMark');\">\r\n		<A class=x-tab-strip-close onclick=\"return false;\"></A>\r\n		<A class=x-tab-right onclick=\"return false;\" href=\"#\">\r\n		<EM class=x-tab-left>\r\n		<SPAN class=x-tab-strip-inner><SPAN class=\"x-tab-strip-text \"><script type=\"text/javascript\">document.write(wmsg.doc.mark);</script></SPAN></SPAN>\r\n		</EM>\r\n		</A>\r\n		</LI>\r\n		".toCharArray();
    _jsp_string146 = "',\r\n		        \"versionId\":'".toCharArray();
    _jsp_string212 = "\r\n							<td><img src=\"/images/messageimages/temp/email_wev8.png\" onmouseover=\"javascript:this.src='/images/messageimages/temp/emailhot_wev8.png';\" onmouseout=\"javascript:this.src='/images/messageimages/temp/email_wev8.png';\" onclick=\"javascript:openemail();\" title=\"".toCharArray();
    _jsp_string335 = "</span></div>\r\n		    	<div id=\"viewcountDiv\" class=\"viewInfo change-font-color\" style=\"height:auto;\">".toCharArray();
    _jsp_string323 = "\"></input>\r\n				  ".toCharArray();
    _jsp_string16 = "');\r\n}\r\n\r\nfunction _onViewLog(operateitem,sqlwhere,id){\r\n	if(!sqlwhere)sqlwhere = \"\";\r\n	var dialog = new window.top.Dialog();\r\n	dialog.currentWindow = window;\r\n	dialog.Title = \"".toCharArray();
    _jsp_string18 = "\";\r\n		}\r\n	}\r\n	dialog.Width = jQuery(window).width();\r\n	dialog.Height = 610;\r\n	dialog.Drag = true;\r\n	dialog.checkDataChange = false;\r\n	dialog.maxiumnable = true;\r\n	dialog.URL = url;\r\n	dialog.show();\r\n}\r\n\r\n\r\nfunction check_form(thiswins,items)\r\n{\r\n	/* added by cyril on 2008-08-14 for td:8521 */\r\n	var isconn = false;\r\n	try {\r\n		var xmlhttp;\r\n	    if (window.XMLHttpRequest) {\r\n	    	xmlhttp = new XMLHttpRequest();\r\n	    }  \r\n	    else if (window.ActiveXObject) {\r\n	    	xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\");  \r\n	    }\r\n	    var URL = \"/systeminfo/CheckConn.jsp?userid=".toCharArray();
    _jsp_string144 = "';		\r\n	}\r\n	\r\n	var filesSize = 0;	\r\n	try{\r\n		var settings = {\r\n			flash_url : \"/js/swfupload/swfupload.swf\",\r\n		    post_params: {\r\n				\"docid\": docid,\r\n		        \"userid\":'".toCharArray();
    _jsp_string478 = "\r\n\r\n		\r\n		if(!notOpen){\r\n			if(tab == \"divViewLogRead\")\r\n			{\r\n				document.getElementById(\"divViewLog\").style.display='block';\r\n				document.getElementById(\"divViewLogATab\").className='x-tab-strip-active';\r\n				setE8ShadowPosition(\"divViewLog\");\r\n			}\r\n			else\r\n			{\r\n				document.getElementById(tab).style.display='block';\r\n				document.getElementById(tab+\"ATab\").className='x-tab-strip-active';\r\n				setE8ShadowPosition(tab);\r\n			}\r\n		}else{\r\n			e8_shadow.hide();\r\n		}\r\n\r\n		try {\r\n			if(!notOpen){\r\n				onExpandOrCollapse(true,true);\r\n			}\r\n			loadExt();\r\n			eval(\"doGet\"+tab+\"();\");\r\n			onResizeDiv();\r\n		} catch(e){}\r\n	}\r\n	\r\n	function setE8ShadowPosition(tab){\r\n		var e8_shadow = jQuery(\"#e8_shadow\");\r\n		var _left = jQuery(document.getElementById(tab+\"ATab\")).offset().left-1;\r\n		if(tab==\"divContentInfo\")_left+=1;\r\n		var _top = jQuery(\"#divTab\").position().top;\r\n		e8_shadow.css({\r\n			\"left\":_left,\r\n			\"top\":_top\r\n		});\r\n		e8_shadow.show();\r\n	}\r\n\r\n	function onResizeDiv() {\r\n		if(document.getElementById(\"divAcc\").style.display!='none')\r\n			resizedivAcc();\r\n		".toCharArray();
    _jsp_string249 = "\">\r\n	<input type=hidden id=docCreaterType name=docCreaterType value=\"".toCharArray();
    _jsp_string105 = "\"\r\n		 });\r\n		 jQuery(\"div#divTab\").show();\r\n		 var canReply = ".toCharArray();
    _jsp_string12 = "\r\n<!-- js \u6574\u5408\u5230 init_wev8.js -->\r\n<script type=\"text/javascript\" src=\"/js/jquery.table_wev8.js\"></script>\r\n<script language=\"javascript\" type=\"text/javascript\" src=\"/js/init_wev8.js\"></script>\r\n<script language=\"javascript\"  src=\"/js/wbusb_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/jquery/plugins/client/jquery.client_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/ecology8/jNice/jNice/jquery.jNice_wev8.js\"></script>\r\n<script type='text/javascript' src='/js/jquery-autocomplete/jquery.autocomplete_wev8.js'></script>\r\n<script type='text/javascript' src='/js/jquery-autocomplete/browser_wev8.js'></script>\r\n<script language=javascript src=\"/wui/theme/ecology8/jquery/js/zDialog_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/ecology8/request/hoverBtn_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/ecology8/lang/weaver_lang_".toCharArray();
    _jsp_string219 = "&nbsp;:&nbsp;&nbsp;&nbsp;</span>\r\n										<span class=\"STYLE61\" id=\"result11\"></span>\r\n									</td>\r\n								</tr>\r\n								<tr>\r\n									<td style=\"WORD-WRAP: break-word;TEXT-VALIGN: left;word-break:break-all;\">\r\n										<span class=\"STYLE6\">".toCharArray();
    _jsp_string239 = "\">\r\n	<INPUT type=hidden name=seccategory value=\"".toCharArray();
    _jsp_string312 = "\r\n								<input type=button id=\"signature_id1\" style=\"".toCharArray();
    _jsp_string70 = "\r\n		    <script language=javascript>\r\n					location=\"DocDsp.jsp?id=".toCharArray();
    _jsp_string241 = "\">\r\n	<input type=hidden name=docmain value=\"".toCharArray();
    _jsp_string469 = "\r\n		document.getElementById(\"divVer\").style.display='none';\r\n		".toCharArray();
    _jsp_string227 = "'>\r\n    <input type=hidden name=docsubject value=\"".toCharArray();
    _jsp_string177 = "\r\n		_menuWindow.setTimeout(function(){\r\n			try{\r\n				var menuCount = 0;\r\n				jQuery(\"#menuTable\", _menuDocument.getElementById(\"rightMenuIframe\").contentWindow.document).children().each(function () {\r\n				if (!jQuery(this).css(\"display\") || jQuery(this).css(\"display\").toLowerCase() != \"none\") {\r\n					menuCount++;\r\n				}\r\n			});\r\n			jQuery(\"#rightMenuIframe\",_menuDocument).css(\"height\", (menuCount * 22+6) + \"px\");\r\n			}catch(e){\r\n			}\r\n		},2000);\r\n	}catch(e){\r\n		if(window.console)console.log(e,\"RightClickMenu.jsp#writeIframe\");\r\n	}\r\n}\r\n\r\n\r\n\r\n//\u7531\u539f\u6765\u7684apXPDropDown.class\u8f6c\u4e3a\u76f4\u63a5\u7528Button\uff0c2003-11-18\u6768\u56fd\u751f\u3002 end\r\n\r\n</script>\r\n".toCharArray();
    _jsp_string56 = "/wui_wev8.css'/>\r\n".toCharArray();
    _jsp_string208 = "\r\n							".toCharArray();
    _jsp_string127 = "'>\r\n        <input type=hidden name=docid value='".toCharArray();
    _jsp_string440 = "\";\r\n	function adjustContentHeight(type,deltaHeight){\r\n		var lang=".toCharArray();
    _jsp_string472 = "\r\n\r\n		\r\n		document.getElementById(\"divPropATab\").className = \"\";\r\n		document.getElementById(\"divAccATab\").className = \"\";\r\n		document.getElementById(\"divContentInfoATab\").className = \"\";\r\n		".toCharArray();
    _jsp_string243 = "\">\r\n	<input type=hidden id=assetid name=assetid value=\"".toCharArray();
    _jsp_string183 = "visible".toCharArray();
    _jsp_string118 = "\");\r\n						jQuery(\"#praiseUsers\").prepend($name);\r\n						jQuery(\"#noPraise\").hide();\r\n					\r\n			}\r\n		});\r\n	}\r\n	\r\n	\r\n	function unPraise(replyid,replytype)\r\n	{\r\n		jQuery.ajax({\r\n			type: \"POST\",\r\n			url: \"/docs/reply/OperDocReply.jsp\",\r\n			data: {\r\n			replyid: replyid,\r\n			operation: 'unpraise',\r\n			docid : docid,\r\n			replytype: replytype,\r\n			userid: ".toCharArray();
    _jsp_string441 = ";\r\n		try{\r\n			deltaHeight = jQuery(\"div.e8AccListArea\").height();\r\n			".toCharArray();
    _jsp_string344 = "\" id=\"praiseInfo\" >\r\n			    		".toCharArray();
    _jsp_string198 = "\r\n	if(isIEBrowser==\"true\"){\r\n		_menuDocument.getElementById(\"rightMenu\").style.left = _menuDocument.body.clientWidth-_menuDocument.getElementById(\"rightMenu\").offsetWidth-200;\r\n	}else{\r\n		_menuDocument.getElementById(\"rightMenu\").style.left = _menuDocument.body.clientWidth-_menuDocument.getElementById(\"rightMenu\").offsetWidth-180;\r\n	}\r\n	_menuDocument.getElementById(\"rightMenu\").style.top = 50;\r\n\r\n	".toCharArray();
    _jsp_string98 = "&votingId=".toCharArray();
    _jsp_string355 = "\r\n				  		<div id=\"pumes\" style=\"float: right; width: 130px; margin-top: 10px; margin-bottom: 10px; text-align: left;\">\r\n				  		<span style=\"padding-left: 10px;\">".toCharArray();
    _jsp_string438 = "	\r\n	var maxUploadImageSize=\"".toCharArray();
    _jsp_string341 = "\r\n		    	</div>\r\n		    		<span id=\"praiseCountSpan\" class=\"praiseSpan\">(<font id=\"praiseCount\">".toCharArray();
    _jsp_string274 = "\">\r\n    ".toCharArray();
    _jsp_string465 = "\r\n		\r\n		".toCharArray();
    _jsp_string267 = ">\r\n        <input type=hidden name=\"isfromdoc\" value=\"1\">\r\n        <input type=hidden name=\"workflowtype\" value=".toCharArray();
    _jsp_string445 = "\r\n			var pageHeight=document.body.clientHeight;\r\n			var pageWidth=document.body.clientWidth;\r\n			if(isFromWf) propTabHeight += 25;\r\n			jQuery(\"#divContentTab\").height(pageHeight - propTabHeight);\r\n			jQuery(\".e8_box\").height(pageHeight - propTabHeight);\r\n			if(isFromWf) propTabHeight -= 50;\r\n			jQuery(\".tab_box\").height(pageHeight - propTabHeight-jQuery(\".e8_boxhead\").height());\r\n			var divContentHeight=jQuery(\".tab_box\").height()-deltaHeight;\r\n			if(isFromWf) divContentHeight += 25;\r\n\r\n			var divContentWidth=pageWidth;\r\n			if(divContentHeight!=null && divContentHeight>0){\r\n				jQuery(\"#divContent\").height(divContentHeight);\r\n				jQuery(\"#divContent\").width(divContentWidth);\r\n				jQuery(\"#previewDoc\").height(divContentHeight);\r\n			".toCharArray();
    _jsp_string133 = "&workflowid=".toCharArray();
    _jsp_string103 = "&isFromAccessory=true';\r\n	}\r\n\r\n</SCRIPT>\r\n\r\n\r\n<HTML><HEAD>\r\n<LINK href=\"/css/Weaver_wev8.css\" type=text/css rel=STYLESHEET>\r\n<META http-equiv=Content-Type content=\"text/html; charset=UTF-8\">\r\n<script LANGUAGE=\"JavaScript\" SRC=\"/js/checkinput_wev8.js\"></script>\r\n<script type='text/javascript' src='/dwr/engine.js'></script>\r\n<script type='text/javascript' src='/dwr/util.js'></script>\r\n<script type='text/javascript' src='/dwr/interface/DocDetailLogWrite.js'></script>\r\n<LINK href=\"/js/extjs/resources/css/ext-all_wev8.css\" type=text/css rel=STYLESHEET>\r\n<LINK href=\"/js/extjs/resources/css/xtheme-gray_wev8.css\" type=text/css rel=STYLESHEET>\r\n<LINK href=\"/css/weaver-ext_wev8.css\" type=text/css rel=STYLESHEET>\r\n<script src=\"/js/tabs/jquery.tabs.extend_wev8.js\"></script>\r\n<link type=\"text/css\" href=\"/js/tabs/css/e8tabs1_wev8.css\" rel=\"stylesheet\"></link>\r\n<link type=\"text/css\" href=\"/css/ecology8/crudoc_wev8.css\" rel=\"stylesheet\"></link>\r\n<script language=javascript src=\"/js/ecology8/docs/docSearchInit_wev8.js\"></script>\r\n<!-- \u56fe\u7247\u8f6e\u64ad -->\r\n		<script src=\"/social/js/drageasy/drageasy.js\"></script>\r\n		<script type=\"text/javascript\" src=\"/social/js/bootstrap/js/bootstrap.js\"></script>\r\n		<script type=\"text/javascript\" src=\"/social/im/js/IMUtil_wev8.js\"></script>\r\n		<script type=\"text/javascript\" src=\"/social/js/imcarousel/imcarousel.js\"></script>\r\n<script type=\"text/javascript\">\r\n	function onBtnSearchClick(){}\r\n	jQuery(document).ready(function(){\r\n		jQuery('.e8_box').Tabs({\r\n		 	getLine:0,\r\n		 	image:false,\r\n		 	needLine:true,\r\n		 	lineSep: \">\",\r\n		 	needChange: false,\r\n		 	exceptHeight:true,\r\n		 	objNameNew:\"".toCharArray();
    _jsp_string101 = "\r\n	}\r\n	function onEditAcc(){\r\n		location.href='DocEditExt.jsp?id=".toCharArray();
    _jsp_string317 = "\r\n					\r\n					".toCharArray();
    _jsp_string407 = "\r\n		<LI id=divReplayATab class=\" \"  onclick=\"onActiveTab('divReplay');\">\r\n		<A class=x-tab-strip-close onclick=\"return false;\"></A>\r\n		<A class=x-tab-right onclick=\"return false;\" href=\"#\">\r\n		<EM class=x-tab-left>\r\n		<SPAN class=x-tab-strip-inner><SPAN class=\"x-tab-strip-text \" id=\"divReplayATabTitle\"><script type=\"text/javascript\">document.write(wmsg.doc.reply + '(".toCharArray();
    _jsp_string471 = "\r\n		document.getElementById(\"divMark\").style.display='none';\r\n		".toCharArray();
    _jsp_string178 = "\r\n<div id=\"rightMenu\" name=\"rightMenu\"  style=\"z-index:99999;position:absolute;\">\r\n<!--//\u7531\u539f\u6765\u7684apXPDropDown.class\u8f6c\u4e3a\u76f4\u63a5\u7528Button\uff0c2003-11-18\u6768\u56fd\u751f\u3002 -->\r\n<iframe id=\"rightMenuIframe\" name=\"rightMenuIframe\"  frameborder=0 marginheight=0 marginwidth=0 hspace=0 vspace=0 scrolling=no width=\"".toCharArray();
    _jsp_string282 = "\"></input>\r\n							".toCharArray();
    _jsp_string384 = "\r\n						<OBJECT id=SignatureAPI classid=\"clsid:A0689619-3E99-4012-A83F-E902CF3505BD\"  codebase=\"iSignatureWPS_APIP.ocx#version=".toCharArray();
    _jsp_string362 = "</span>\r\n					".toCharArray();
    _jsp_string123 = "up\").remove();\r\n			}\r\n		});\r\n	}\r\n</script>\r\n<style type=\"text/css\">\r\n	.e8_rightBox{\r\n		top:-2px;\r\n	}\r\n	#rightMenu{\r\n		visibility:hidden;\r\n	}\r\n.viewInfo {\r\n    width: 22px;\r\n    height: 22px;\r\n    float: left;\r\n    margin-left: 25px;\r\n}\r\n.viewInfo:hover {\r\n    color: #676767;\r\n}\r\n.praiseInfo {\r\n    width: 22px;\r\n    height: 22px;\r\n    float: left;\r\n    margin-left: 15px;\r\n}\r\n.praiseInfo:hover {\r\n	color: #676767;\r\n}\r\n.praiseInfo_hot {\r\n    width: 28px;\r\n    height: 22px;\r\n    float: left;\r\n    margin-left: 15px;\r\n    color: #ffa53b;\r\n}\r\n.praiseInfo_hot:hover {\r\n	color: #ff5b3b;\r\n}\r\n.praiseuser_a {\r\n 	margin-left: 5px;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    margin-top: 10px;\r\n    width: 36px;\r\n}\r\n\r\n.praiseuser_a_hidden {\r\n 	margin-left: 5px;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    margin-top: 10px;\r\n    width: 36px;\r\n    display: none!important;\r\n}\r\n\r\n.praiseuser_a_show {\r\n 	margin-left: 5px;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    width: 36px;\r\n    text-overflow: ellipsis;\r\n    margin-top: 10px;\r\n}\r\n\r\n.moreUsers_a {\r\n	 // margin-left: 5px;\r\n}\r\n\r\n.moreUserView {\r\n	background-image: url('/docs/reply/img/more.png');\r\n    width: 22px;\r\n    height: 22px;\r\n    float: right;\r\n    margin-right: 11px;\r\n}\r\n.lettelUserView {\r\n	background-image: url('/docs/reply/img/up.png');\r\n    width: 22px;\r\n    height: 22px;\r\n    float: right;\r\n    margin-right: 15px;\r\n    margin-top: 9px;\r\n    margin-bottom: 10px;\r\n}\r\n.moreUserView:hover {\r\n	background-image: url('/docs/reply/img/more_hot.png');\r\n}\r\n.vpSpan {\r\n	float: left;\r\n    padding-left: 10px;\r\n}\r\n\r\n.praiseSpan {\r\n	float: left;\r\n}\r\n.praiseSpan_hot {\r\n	float: left;\r\n	padding-left: 15px;\r\n}\r\n.magic-line1 {\r\n    position: absolute;\r\n    left: 0;\r\n    height: 19px!important;\r\n    line-height: 2px!important;\r\n    top: 32px;\r\n    background-image: url(\"/images/ecology8/angle_wev8.png\");\r\n    background-repeat: no-repeat;\r\n    background-position: 50% 50%;\r\n    width: 24px;\r\n    left: 460px;\r\n    top: 50px;\r\n    z-index: 9;\r\n    display:none;\r\n}\r\n.praiseUserDiv {\r\n  position: absolute;\r\n  white-space: normal;\r\n  margin-top: 36px;\r\n  margin-left: 375px;\r\n  border: 1px solid rgb(218, 218, 218);\r\n  max-width: 365px;\r\n  min-width: 80px;\r\n  line-height: 20px;\r\n  text-align: left;\r\n  top: 26px;\r\n  z-index: 8;\r\n  background-color: rgb(255, 255, 255);\r\n  -webkit-box-shadow: #666 0px 0px 10px;\r\n  -moz-box-shadow: #666 0px 0px 10px;\r\n  box-shadow: #969696 0px 0px 5px;\r\n  max-height: 500px;\r\n  min-height: 40px;\r\n  display:none;\r\n  padding-left: 5px;\r\n}\r\n</style>\r\n".toCharArray();
    _jsp_string386 = "\r\n						<object id=\"SignatureAPI\" width=\"0\" height=\"0\" classid=\"clsid:857F9703-BE32-4BD4-92A4-D8079C10BD41\"></object>\r\n					".toCharArray();
    _jsp_string272 = "\">\r\n		<input type=hidden name=\"prjIds\" value=\"".toCharArray();
    _jsp_string421 = ";\r\n	var docid=\"".toCharArray();
    _jsp_string226 = "\">\r\n    <input type=hidden name=docno value='".toCharArray();
    _jsp_string389 = "\r\n			</DIV>\r\n		</div>\r\n		<!-- \u6587\u6863\u5c5e\u6027\u680f end -->\r\n		<!-- \u6587\u6863\u9644\u4ef6\u680f start -->\r\n		<div id=\"divAcc\" class=\"e8_propTab\" style=\"display:none;width:100%;height:100%;\">\r\n			<DIV style=\"width:100%; height:100%; overflow: visible;border:none;\" class=\"x-tab-panel-body x-tab-panel-body-noheader x-tab-panel-body-noborder x-tab-panel-body-bottom\">\r\n".toCharArray();
    _jsp_string158 = "\r\n<SPAN id=BacoTitle style=\"display:none;\">".toCharArray();
    _jsp_string17 = "\";\r\n	var url = \"/docs/tabs/DocCommonTab.jsp?_fromURL=3&operateitem=\"+operateitem+\"&sqlwhere=\"+sqlwhere;\r\n	if(id){\r\n		url = \"/docs/tabs/DocCommonTab.jsp?_fromURL=3&relatedid=\"+id+\"&operateitem=\"+operateitem+\"&sqlwhere=\"+sqlwhere;\r\n		if(operateitem==418||operateitem==419||operateitem==420){\r\n			dialog.Title = \"".toCharArray();
    _jsp_string316 = "\r\n								<input type=button id=\"thprint_id1\" class=\"e8_btn_top\" onclick=\"webOfficeMenuClick(47,'');\" value=\"".toCharArray();
    _jsp_string302 = "\" class=\"e8_btn_top\" onclick=\"saveTHTemplate(".toCharArray();
    _jsp_string188 = "px\";\r\n	}\r\n	else\r\n	{\r\n		objRightMenuDiv.style.visibility = \"visible\";\r\n		//jQuery(objRightMenuDiv).show();\r\n		objRightMenuDiv.style.position = \"absolute\";\r\n	}\r\n}\r\n//\u89e3\u51b3\u65b0\u6d41\u7a0b\u754c\u9762\u5728\u52a0\u8f7d\u9875\u9762\u65f6\uff0c\u4f1a\u51fa\u73b0\u9876\u90e8\u83dc\u5355\u5148\u51fa\u73b0\u518d\u6d88\u5931\u7684\u95ee\u9898 End\r\n</script>\r\n<script language=\"JavaScript\">\r\ndoMenuInit();\r\nfunction doMenuInit(){\r\n	var objRightMenuDiv = _menuDocument.getElementById(\"rightMenu\");\r\n	var objhasTopTitleExtInput = _menuDocument.getElementById(\"hasTopTitleExtInput\");\r\n	if(objhasTopTitleExtInput!=null && objhasTopTitleExtInput.value==\"1\"){\r\n		try{\r\n			objRightMenuDiv.style.position = \"relative\";\r\n			objRightMenuDiv.style.height = \"0px\";\r\n			objRightMenuDiv.style.display = \"none\";\r\n		}catch(e){}\r\n	}else{\r\n		try{\r\n			var objMenuDiv = _menuDocument.getElementById(\"divTopMenu\");\r\n			var rightMenuIframe = _menuDocument.getElementById(\"rightMenuIframe\");\r\n			if(objMenuDiv!=null){\r\n				if(rightMenuIframe!=null){\r\n					objMenuDiv.appendChild(rightMenuIframe);\r\n				}\r\n				objRightMenuDiv.style.position = \"relative\";\r\n				objRightMenuDiv.style.height = \"0px\";\r\n				objRightMenuDiv.style.display = \"none\";\r\n			}else{\r\n				if(rightMenuIframe!=null){\r\n					objRightMenuDiv.appendChild(rightMenuIframe);\r\n					needShow = true;\r\n				}\r\n			}\r\n		}catch(e){}\r\n	}\r\n}\r\n".toCharArray();
    _jsp_string487 = "&versionId=\"+datas.id+\"&fromFlowDoc=".toCharArray();
    _jsp_string80 = "&docfileid=1&docid=".toCharArray();
    _jsp_string342 = "</font>)</span>\r\n		    	".toCharArray();
    _jsp_string259 = "\">\r\n	<input type=hidden id=\"versionDetail\" name=\"versionDetail\" value=\"\" />\r\n\r\n    ".toCharArray();
    _jsp_string413 = "\r\n\r\n		".toCharArray();
    _jsp_string399 = "\r\n		\r\n\r\n	</div>\r\n	".toCharArray();
    _jsp_string269 = ">\r\n\r\n		<input type=hidden name=\"docIds\" value=\"".toCharArray();
    _jsp_string86 = "&id=".toCharArray();
    _jsp_string304 = "\"></input>\r\n								".toCharArray();
    _jsp_string213 = "\r\n							<td><img src=\"/images/messageimages/temp/workplan_wev8.png\" onmouseover=\"javascript:this.src='/images/messageimages/temp/workplanhot_wev8.png';\" onmouseout=\"javascript:this.src='/images/messageimages/temp/workplan_wev8.png';\" onclick=\"javascript:doAddWorkPlan();\" title=\"".toCharArray();
    _jsp_string290 = "\r\n							<input type=button class=\"e8_btn_top\" onclick=\"javascript:onDownload()\" value=\"".toCharArray();
    _jsp_string147 = "',\r\n		        \"docfiletype\":'".toCharArray();
    _jsp_string92 = "&workplanid=".toCharArray();
    _jsp_string61 = ")\">\r\n".toCharArray();
    _jsp_string169 = "\r\n		var objMenuDiv = _menuDocument.getElementById(\"divTopMenu\");\r\n		if(objMenuDiv!=null){\r\n			objMenuDiv.style.height = h + \"px\";\r\n			//objMenuDiv.style.border = \"1px solid #979797\";\r\n			_menuDocument.getElementById(\"rightMenu\").style.border = \"0px\";\r\n			//_menuDocument.getElementById(\"divTopMenu\").style.weight = bodyWidth+\"px\";\r\n			//_menuWindow._menuDocument.body.style.marginTop = h + \"px\";\r\n		}else{\r\n			_menuDocument.getElementById(\"rightMenu\").style.height = h + \"px\";\r\n			//_menuDocument.getElementById(\"rightMenu\").style.weight = bodyWidth+\"px\";\r\n			_menuWindow._menuDocument.body.style.marginTop = h + \"px\";\r\n		}\r\n	".toCharArray();
    _jsp_string222 = "&nbsp;:&nbsp;&nbsp;&nbsp;</span>\r\n										<span class=\"STYLE61\" id=\"result5\"></span>\r\n									</td>\r\n								</tr>\r\n							</table>\r\n						</td>\r\n					</tr>\r\n					<tr height=\"42px\">\r\n						<td align=\"right\" valign=\"middle\" style=\"padding-right: 12px\">\r\n							<span class=\"STYLE6\" id=\"result0\"></span>\r\n						</td>\r\n					</tr>\r\n				</table>\r\n			</td>\r\n		</tr>\r\n	</table>\r\n</div>\r\n\r\n\r\n<iframe id=\"ClearDocAccessoriesTraceIframe\" frameborder=0 scrolling=no src=\"\"  style=\"display:none\"></iframe>\r\n\r\n    <input type=hidden name=operation>\r\n    <input type=hidden id=\"versionId\" name=versionId value=\"".toCharArray();
    _jsp_string44 = "\r\n<script language=javascript>\r\nubsfirmcode0 = ".toCharArray();
    _jsp_string6 = "\r\n\r\n\r\n<script language=javascript>;\r\ntop.Dialog.alert(\"".toCharArray();
    _jsp_string306 = "\" class=\"e8_btn_top\" onclick=\"selectTemplate(".toCharArray();
    _jsp_string301 = "\r\n								<input type=button id=\"thSure_id\" style=\"".toCharArray();
    _jsp_string488 = "&isFromAccessory=true&isNoTurnWhenHasToPage=true&topage=".toCharArray();
    _jsp_string152 = "&id=\"+_docid+\"&fileExtendName=notext&versionId=\"+_versionid+\"&imagefileId=\"+_imagefileid+\"&isrequest=".toCharArray();
    _jsp_string145 = "',\r\n		        \"usertype\":'".toCharArray();
    _jsp_string338 = "\r\n		    	".toCharArray();
    _jsp_string376 = "\r\n							<span id=StatusBar style=\"display:none\">&nbsp;</span>\r\n						 ".toCharArray();
    _jsp_string210 = "\"></td>\r\n							".toCharArray();
    _jsp_string303 = ")\" value=\"".toCharArray();
    _jsp_string46 = ";\r\nusbserial0 = \"".toCharArray();
    _jsp_string454 = "\";\r\n	var isAutoExtendInfo=".toCharArray();
    _jsp_string252 = "\">\r\n	<input type=hidden id=doccode name=doccode value=\"".toCharArray();
    _jsp_string72 = "&isFromAccessory=true&isrequest=1&requestid=".toCharArray();
    _jsp_string379 = "	\r\n						</div>\r\n					</td>\r\n				</tr>\r\n\r\n			".toCharArray();
    _jsp_string251 = "\">\r\n\r\n	<input type=hidden id=keyword name=keyword value=\"".toCharArray();
    _jsp_string236 = "\">\r\n	<input type=hidden name=doceditionid value=\"".toCharArray();
    _jsp_string149 = "\");\r\n					return;\r\n				}\r\n				\r\n				if(_isExt==\"true\"){\r\n					parent.location.href=\"/docs/docs/DocDspExt.jsp?isFromAccessory=true&openFirstAss=".toCharArray();
    _jsp_string130 = "\">\r\n    <input type=hidden name=doccreaterid value=\"".toCharArray();
    _jsp_string339 = "\r\n		    	<div class=\"praiseInfo\" title=\"".toCharArray();
    _jsp_string121 = "\");\r\n		  				jQuery(\"#praiseInfo\").removeClass('praiseInfo_hot');\r\n					jQuery(\"#praiseInfo\").addClass('praiseInfo');\r\n					jQuery(\"#praiseCountSpan\").removeClass('praiseSpan_hot');\r\n					jQuery(\"#praiseCountSpan\").addClass('praiseSpan');\r\n					jQuery(\"#praiseInfo\").text(\"".toCharArray();
    _jsp_string437 = "\r\n	var readCount_int=".toCharArray();
    _jsp_string207 = "'\r\n</script>\r\n<script type=\"text/javascript\" src=\"/js/messagejs/highslide/highslide-full_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/messagejs/simplehrm_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/messagejs/messagejs_wev8.js\"></script>\r\n<script language=\"javascript\" src=\"/qrcode/js/jquery.qrcode-0.7.0_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/weaver_wev8.js\"></script>\r\n<!--[if IE]> \r\n<script src=\"/qrcode/js/html5shiv_wev8.js\"></script>\r\n<script src=\"/qrcode/js/excanvas.compiled_wev8.js\"></script>\r\n<![endif]-->\r\n<script type=\"text/javascript\">\r\n	function getImageResult(o)\r\n	{\r\n		hs.graphicsDir = '/js/messagejs/highslide/graphics/';\r\n		hs.outlineType = 'rounded-white';\r\n		hs.fadeInOut = true;\r\n		hs.headingEval = 'this.a.title';\r\n		var hrefimg = document.getElementById(\"resourceimghref\").href;\r\n		if(hrefimg.indexOf(\"javascript\")!=-1)\r\n		{\r\n			void(0);\r\n			return false;\r\n		}\r\n		else\r\n		{\r\n			return hs.expand(o);\r\n		}\r\n	}\r\n\r\nfunction createQCode(){\r\n	if(jQuery(\"#showSQRCodeDiv\").is(\":hidden\"))\r\n		jQuery(\"#showSQRCodeDiv\").show();\r\n	else\r\n		jQuery(\"#showSQRCodeDiv\").hide();\r\n}\r\n\r\nfunction initSrc(){\r\n	if(jQuery(\"#result2\").html()==\"\uff08\u7537\uff09\"){\r\n		jQuery(\"#resourceimg\").attr(\"src\",\"/images/messageimages/temp/man_wev8.png\");	\r\n		jQuery(\"#resourceimg\").parent().attr(\"href\",\"/images/messageimages/temp/man_wev8.png\");\r\n	}else if(jQuery(\"#result2\").html()==\"\uff08\u5973\uff09\"){\r\n		jQuery(\"#resourceimg\").attr(\"src\",\"/images/messageimages/temp/women_wev8.png\");	\r\n		jQuery(\"#resourceimg\").parent().attr(\"href\",\"/images/messageimages/temp/women_wev8.png\");\r\n	}\r\n}\r\n</script>\r\n<style type=\"text/css\">\r\n<!--\r\n.STYLE4 {\r\n	FONT-FAMILY: Verdana;\r\n	font-size: 14px;\r\n	cursor: hand;\r\n}\r\n\r\n.STYLE6 {\r\n	FONT-FAMILY: Verdana;\r\n	FONT-SIZE: 12px;\r\n}\r\n\r\n.STYLE61 {\r\n	FONT-FAMILY: Verdana;\r\n	FONT-SIZE: 12px;\r\n	color: #000000;\r\n}\r\n\r\n.simplehrmhead {\r\n	vertical-align:baseline;\r\n}\r\n#mainsupports {\r\n	position: absolute;\r\n	font-size: 12px;\r\n	color: #929393;\r\n	display: none;\r\n	z-index: 1;\r\n}\r\n\r\n#closetext {\r\n	float: right;\r\n	margin-right: 20px;\r\n}\r\n\r\n#mainsupports li a:link {\r\n	color: #2a788e;\r\n	font-size: 12px;\r\n	text-decoration: none;\r\n}\r\n\r\n#mainsupports li a:visited {\r\n	color: #227086;\r\n	font-size: 12px;\r\n	text-decoration: none;\r\n}\r\n\r\n#mainsupports li a:hover {\r\n	color: #FFFFFF;\r\n	font-size: 12px;\r\n	text-decoration: none;\r\n}\r\n\r\n#resourceimg {\r\n	width: 198px;\r\n	height: 293px;\r\n	margin-top: 0px;\r\n}\r\n-->\r\n</style>\r\n<!-- \u8fd9\u91cc\u6539\u4e86z-index(+2),\u56e0\u4e3aUE\u7f16\u8f91\u5668\u4f1a\u906e\u4f4f\u5f39\u7a97 -->\r\n<div id=\"mainsupports\" style=\"z-index:1999;background-color:#e4e4e4;position: absolute;font-size: 12px;color: #929393;display: none;\">\r\n	<table width=\"455px\" height=\"293px\" border=\"0\" align=\"center\" style=\"vertical-align: middle;\" cellpadding=\"0\" cellspacing=\"0\">\r\n		<tr>\r\n			<td width=\"198px\" valign=\"top\">\r\n				<a id='resourceimghref' href=\"javascript:void(0);\" onclick=\"return getImageResult(this);\" onFocus=\"this.blur()\"><img id='resourceimg' src=\"/images/messageimages/temp/loading_wev8.gif\" border=0 width=\"100%\" height=\"100%\" onError=\"initSrc()\"></a>\r\n				<div style=\"position:absolute;top: 243px;background-image:url('/images/messageimages/temp/divbg_wev8.png');\">\r\n					<table style=\"width: 198px;height: 50px;text-align: center;vertical-align: middle;\">\r\n						<tr>\r\n						".toCharArray();
    _jsp_string443 = "\r\n			if(jQuery(\"div.e8AccListArea\").css(\"display\")==\"none\"){\r\n				deltaHeight = 0;\r\n			}\r\n			var propTabHeight = 34;\r\n			if(document.getElementById(\"divPropTab\")&&document.getElementById(\"divPropTab\").style.display==\"none\") propTabHeight = (isFromWf)?10:34;\r\n			".toCharArray();
    _jsp_string412 = "</SPAN></SPAN>\r\n		</EM>\r\n		</A>\r\n		</LI>\r\n		".toCharArray();
    _jsp_string374 = ";\" codebase=\"".toCharArray();
    _jsp_string328 = "\">\r\n		<div class=\"div_e8_xtree\" id=\"div_e8_xtree\"></div>\r\n		<div class=\"e8_tablogo\" id=\"e8_tablogo\"></div>\r\n		<div class=\"e8_ultab\">\r\n			<div class=\"e8_navtab\" id=\"e8_navtab\">\r\n				<span id=\"objName\" style=\"height:30px\"></span>\r\n			</div>\r\n			<div>\r\n    	<ul class=\"tab_menu\">\r\n    		".toCharArray();
    _jsp_string215 = "&nbsp;:&nbsp;&nbsp;&nbsp;</span>\r\n										<span class=\"STYLE61\" id=\"result6\"></span>\r\n									</td>\r\n								</tr>\r\n								<tr>\r\n									<td style=\"WORD-WRAP: break-word;TEXT-VALIGN: left;word-break:break-all;\">\r\n										<span class=\"STYLE6\">".toCharArray();
    _jsp_string73 = "&desrequestid=".toCharArray();
    _jsp_string5 = "\";\r\n		});		\r\n	</script>\r\n	".toCharArray();
    _jsp_string354 = "\r\n					\r\n				  	".toCharArray();
    _jsp_string166 = ")-1 : Math.ceil(bodyWidth/".toCharArray();
    _jsp_string270 = "\">\r\n		<input type=hidden name=\"crmIds\" value=\"".toCharArray();
    _jsp_string315 = "\" class=\"e8_btn_top\" onclick=\"saveIsignatureFun();\" value=\"".toCharArray();
    _jsp_string51 = "\r\n}\r\n\r\nfunction doScannerEscape(ev, obj){\r\n	IMCarousel.doScannerEscape(ev, obj);\r\n}\r\n\r\nfunction scaleImg(obj, tag){\r\n	IMCarousel.scaleImg(obj, tag);\r\n}\r\n\r\nfunction rotateImg(obj){\r\n	IMCarousel.rotateImg(obj);\r\n}\r\n\r\nfunction downloadImg(obj){\r\n	IMCarousel.downloadImg(obj);\r\n}\r\n\r\nfunction slideImg(obj, direction){\r\n	IMCarousel.slideImg(obj, direction);\r\n}\r\n\r\nfunction showImgScanner(ev, isShow, id){\r\n	IMCarousel.showImgScanner(ev, isShow, id);\r\n}\r\n\r\nfunction downloads(id){\r\n	document.location.href=\"/weaver/weaver.file.FileDownload?fileid=\"+id+\"&download=1\";\r\n}\r\n</script>\r\n".toCharArray();
    _jsp_string14 = "\";\r\nfunction check_conn() {\r\n	return confirm('".toCharArray();
    _jsp_string311 = "\"></input>	\r\n								<input type=button class=\"e8_btn_top\" onclick=\"backToForm();\" value=\"".toCharArray();
    _jsp_string143 = "\"==\".wps\"){\r\n		file_types=\"*.wps\";		\r\n	} else{\r\n		file_types='*".toCharArray();
    _jsp_string432 = ";\r\n	var canEdit=".toCharArray();
    _jsp_string326 = "\r\n	<div style=\"display:none;\">\r\n		".toCharArray();
    _jsp_string283 = "\r\n							<input type=button class=\"e8_btn_top\" onclick=\"javascript:onEditAcc()\" value=\"".toCharArray();
    _jsp_string447 = "\r\n				jQuery(\"#WebOffice\").height(divContentHeight);\r\n			".toCharArray();
    _jsp_string348 = ");\" id=\"".toCharArray();
    _jsp_string254 = "'>\r\n\r\n    <input type=hidden id=\"requestid\" name=\"requestid\" value=".toCharArray();
    _jsp_string275 = "\r\n    \r\n    <input type=\"hidden\" name=\"hrmresid\" value=\"".toCharArray();
    _jsp_string268 = ">\r\n        <input type=hidden name=\"messageType\" value=".toCharArray();
    _jsp_string186 = "\r\n<script language=\"JavaScript\">\r\n//\u89e3\u51b3\u65b0\u6d41\u7a0b\u754c\u9762\u5728\u52a0\u8f7d\u9875\u9762\u65f6\uff0c\u4f1a\u51fa\u73b0\u9876\u90e8\u83dc\u5355\u5148\u51fa\u73b0\u518d\u6d88\u5931\u7684\u95ee\u9898 Start\r\nvar needShow = false;\r\nvar rightMenuStr=\"#rightMenu\";\r\nvar rightMenu = _menuDocument.getElementById(\"rightMenu\");\r\n".toCharArray();
    _jsp_string71 = "&imagefileId=".toCharArray();
    _jsp_string426 = "\";\r\n	var doceditionid=\"".toCharArray();
    _jsp_string340 = "\" id=\"praiseInfo\" >\r\n		    	".toCharArray();
    _jsp_string206 = "\r\n\r\n\r\n\r\n\r\n\r\n\r\n<script type=\"text/javascript\">\r\n//\u7528\u6237\u8bed\u8a00\r\nvar languageid = '".toCharArray();
    _jsp_string263 = ">\r\n        <input type=hidden name=\"isbill\" value=".toCharArray();
    _jsp_string176 = "\r\n	    try{\r\n		setMenuBoxHeightSelf();\r\n	    }catch(e){}\r\n		".toCharArray();
    _jsp_string366 = "overflow:hidden;z-index:1;width:100%;height:23px;position:absolute;top:37px;visibility:hidden;left:0px;background-color:#fff;\" src=\"javascript:false\"></iframe>\r\n		<div id=\"divContentInfo\" class=\"e8_propTab \" style=\"width:100%;height:100%;\">\r\n			<table cellpadding=\"0\" cellspacing=\"0\" style=\"width:100%;height:100%;\">\r\n				<tr height='100%'>\r\n					<td bgcolor=menu style=\"vertical-align:top;position:relative;\">\r\n						<div id=\"objectDiv\" style=\"width:100%;height:100%;background-color:#fff;\">\r\n						 ".toCharArray();
    _jsp_string27 = "\r\n	    try {\r\n		    var lenck = true;\r\n		    var tempfieldvlaue = document.getElementById(\"htmlfieldids\").value;\r\n		    while(true) {\r\n			    var tempfield = tempfieldvlaue.substring(0, tempfieldvlaue.indexOf(\",\"));\r\n			    tempfieldvlaue = tempfieldvlaue.substring(tempfieldvlaue.indexOf(\",\")+1);\r\n			    var fieldid = tempfield.substring(0, tempfield.indexOf(\";\"));\r\n			    var fieldname = tempfield.substring(tempfield.indexOf(\";\")+1);\r\n			    if(fieldname=='') break;\r\n			    if(!checkLengthOnly(fieldid,'4000',fieldname,'".toCharArray();
    _jsp_string57 = "\r\n\r\n\r\n<!-- \u5b57\u4f53\u8bbe\u7f6e\uff0cwin7\u3001vista\u7cfb\u7edf\u4f7f\u7528\u96c5\u9ed1\u5b57\u4f53,\u5176\u4ed6\u7cfb\u7edf\u4f7f\u7528\u5b8b\u4f53 Start -->\r\n<!--\r\n\u6dfb\u52a0\u81f3init_wev8.css \r\n<link type='text/css' rel='stylesheet'  href='/wui/common/css/w7OVFont_wev8.css' id=\"FONT2SYSTEMF\">\r\n -->\r\n<script language=\"javascript\"> \r\n/*\r\nif (jQuery.client.version< 6) {\r\n	document.getElementById('FONT2SYSTEMF').href = \"/wui/common/css/notW7AVFont_wev8.css\";\r\n}\r\n*/\r\n</script> \r\n<!-- \u5b57\u4f53\u8bbe\u7f6e\uff0cwin7\u3001vista\u7cfb\u7edf\u4f7f\u7528\u96c5\u9ed1\u5b57\u4f53,\u5176\u4ed6\u7cfb\u7edf\u4f7f\u7528\u5b8b\u4f53 End -->\r\n\r\n<!-- \u9875\u9762\u5207\u6362\u6548\u679cStart -->\r\n".toCharArray();
    _jsp_string64 = "\";\r\n</script>\r\n\r\n<!--For wuiForm-->\r\n<script type=\"text/javascript\" src=\"/wui/common/jquery/plugin/wuiform/jquery.wuiform_wev8.js\"></script>\r\n<script language=\"javascript\">\r\njQuery(document).ready(function(){\r\n	wuiform.init();\r\n});\r\n</script>\r\n".toCharArray();
    _jsp_string324 = "\r\n\r\n				 <span title=\"".toCharArray();
    _jsp_string475 = "\r\n		document.getElementById(\"divVerATab\").className = \"\";\r\n		".toCharArray();
    _jsp_string460 = "\";\r\n		}\r\n		if(tab==\"divVer\"&&has_versionListIfrm==0){\r\n			has_versionListIfrm=1;\r\n			document.getElementById(\"versionListIfrm\").src=\"".toCharArray();
    _jsp_string234 = "\">\r\n	<input type=hidden name=docstatus value=\"".toCharArray();
    _jsp_string199 = "\r\n	_menuDocument.getElementById(\"rightMenu\").style.visibility=\"visible\";\r\n	if (!_menuWindow.ActiveXObject) {\r\n		_menuDocument.getElementById(\"rightMenu\").style.display=\"\";\r\n	}\r\n	".toCharArray();
    _jsp_string240 = "\">\r\n	<input type=hidden name=docpublishtype value=\"".toCharArray();
    _jsp_string112 = "\r\n			},\r\n			cache: false,\r\n			async:false,\r\n			dataType: 'json',\r\n			success: function(msg){\r\n				jQuery(\"#praiseInfo\").unbind(\"click\");\r\n					jQuery(\"#praiseInfo\").bind('click',function(){\r\n						unPraise(replyid, replytype);\r\n					});\r\n					if(jQuery(\"#praiseCount\").text() == \"\")\r\n					{\r\n						jQuery(\"#praiseCount\").text(\"1\");\r\n					}\r\n					else\r\n					{\r\n						var index = parseInt(jQuery(\"#praiseCount\").text());\r\n		  				jQuery(\"#praiseCount\").text(index+1);\r\n		  				if(index > 12)\r\n		  				{\r\n							jQuery(\".praiseuser_a:last\").addClass(\"praiseuser_a_hidden\");\r\n							jQuery(\".praiseuser_a:last\").removeClass(\"praiseuser_a\");\r\n							jQuery(\"#fuserFont\").text(index+1);\r\n		  				}\r\n					}\r\n					jQuery(\"#praiseInfo\").attr(\"title\",\"".toCharArray();
    _jsp_string314 = "\"></input>\r\n								<input type=button id=\"signature_id2\" style=\"".toCharArray();
    _jsp_string34 = "\");\r\n							}\r\n						}else{\r\n							try{\r\n								window.top.Dialog.alert(\"".toCharArray();
    _jsp_string141 = "\"==\".ppt\"||\"".toCharArray();
    _jsp_string468 = "\r\n		document.getElementById(\"divShare\").style.display='none';\r\n		".toCharArray();
    _jsp_string231 = "\">\r\n    <input type=hidden name=\"ownerType\" value=\"".toCharArray();
    _jsp_string295 = "\"></input>\r\n			    		  ".toCharArray();
    _jsp_string444 = "\r\n				if(propTabHeight==34){\r\n					propTabHeight=0\r\n				}\r\n			".toCharArray();
    _jsp_string116 = "\");\r\n					  	$name.attr(\"href\",\"javaScript:openhrm(".toCharArray();
    _jsp_string197 = "\r\n		_menuDocument.oncontextmenu=showRightClickMenu\r\n		\r\n		_menuDocument.body.onclick = hideRightClickMenu;\r\n	".toCharArray();
    _jsp_string172 = "\";\r\n		if(!!_contentWindow){\r\n			shtmlTemp = shtmlTemp.replace(/\\bparent\\./g,\"__parent.\");\r\n		}\r\n		var shtml = \"<!DOCTYPE HTML><html><head><script>__parent=parent.__parent;<\"+\"/script><link href='/wui/theme/\" + GLOBAL_CURRENT_THEME + \"/skins/\" + GLOBAL_SKINS_FOLDER + \"/contextmenu/contextmenu_wev8.css' rel='stylesheet' type='text/css' /><link rel='stylesheet' href='/css/Weaver_wev8.css'></head><body leftmargin=0 topmargin=0 bottommargin=0 ".toCharArray();
    _jsp_string417 = "\r\n\r\n</body>\r\n</html>\r\n\r\n".toCharArray();
    _jsp_string96 = "\r\n			top.location=\"/weaver/weaver.file.FileDownload?fileid=".toCharArray();
    _jsp_string0 = "\r\n\r\n\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string281 = "\r\n							<input type=button class=\"e8_btn_top\" onclick=\"javascript:webOfficeMenuClickNew(1)\" value=\"".toCharArray();
    _jsp_string126 = "\r\n<iframe id=\"DocCheckInOutUtilIframe\" frameborder=0 scrolling=no src=\"\"  style=\"display:none\"></iframe>\r\n\r\n	<form name=workflow method=post action=\"/workflow/request/RequestType.jsp\">\r\n        <input type=hidden name=topage value='".toCharArray();
    _jsp_string11 = "\r\n<!-- IE\u4e0b\u4e13\u7528vbs\uff08\u4e34\u65f6\uff09 -->\r\n<script language=\"vbs\" src=\"/js/string2VbArray.vbs\"></script>        \r\n        ".toCharArray();
    _jsp_string139 = "\"==\".xls\"||\"".toCharArray();
    _jsp_string394 = "\r\n		<!-- \u6587\u6863\u7248\u672c\u680f start -->\r\n		<div id=\"divVer\" class=\"e8_propTab\" style=\"display:none;width:100%;height:100%;\">\r\n			<DIV style=\"width:100%; height:100%; overflow: visible;border:none;\" class=\"x-tab-panel-body x-tab-panel-body-noheader x-tab-panel-body-noborder x-tab-panel-body-bottom\">\r\n			<iframe  id=\"versionListIfrm\" style=\"border:none;\"  frameborder=\"0\" width=\"100%\" height=\"100%\"></iframe>\r\n			</DIV>\r\n		</div>\r\n		<!-- \u6587\u6863\u7248\u672c\u680f end -->\r\n		".toCharArray();
    _jsp_string370 = "\">\r\n									<OBJECT id=\"WebOffice\" name=\"WebOffice\" classid=\"".toCharArray();
    _jsp_string65 = "\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string230 = "\">\r\n    <input type=hidden name=\"oldownerid\" value=\"".toCharArray();
    _jsp_string255 = ">\r\n    <input type=hidden id=\"workflowid\" name=\"workflowid\" value=".toCharArray();
    _jsp_string165 = ">1 ? Math.ceil(bodyWidth/".toCharArray();
    _jsp_string223 = "\">\r\n    <input type=hidden name=id value=\"".toCharArray();
    _jsp_string345 = "\r\n			    	</div>\r\n			    	<span id=\"praiseCountSpan\" class=\"praiseSpan_hot\">(<font id=\"praiseCount\">".toCharArray();
    _jsp_string171 = "\r\n}\r\nvar __parent = window;\r\n\r\nfunction writeIframe(evt,__document,_contentWindow)\r\n{	 try{\r\n		if(!!__document){\r\n			_menuDocument = __document;\r\n			_parentDocument = __document;\r\n			rightMenu = _menuDocument.getElementById(\"rightMenu\");\r\n		}\r\n		if(!!_contentWindow){\r\n			__parent = _contentWindow;\r\n			parent.__parent = _contentWindow;\r\n		}\r\n		var shtmlTemp = \"".toCharArray();
    _jsp_string108 = "\";\r\n					if(isPraise == 0)\r\n					{\r\n						jQuery(\"#praiseInfo\").bind(\"click\",function (){\r\n							praise(".toCharArray();
    _jsp_string392 = "\r\n					<iframe  id=\"replyInfoIfrm\" name=\"replyInfoIfrm\" style=\"border:none;\"  frameborder=\"0\" width=\"100%\" height=\"100%\"></iframe>				\r\n				\r\n			</DIV>\r\n		</div>\r\n		<!-- \u6587\u6863\u56de\u590d\u680f end -->\r\n	".toCharArray();
    _jsp_string173 = " oncontextmenu='return false'".toCharArray();
    _jsp_string94 = "\r\n		    <script language=javascript>\r\n					location=\"/notice/noright.jsp\";\r\n		    </script> \r\n".toCharArray();
    _jsp_string431 = "\";\r\n	\r\n	var canShare=".toCharArray();
    _jsp_string332 = "\r\n    		".toCharArray();
    _jsp_string480 = "\r\n		else if(document.getElementById(\"divShare\").style.display!='none')\r\n			resizedivShare();\r\n		".toCharArray();
    _jsp_string383 = "\r\n				<tr>\r\n					<td bgcolor=menu style=\"vertical-align:top;\" id=\"SignatureAPITd\">\r\n					".toCharArray();
    _jsp_string114 = "\");\r\n					\r\n						$name = jQuery(\"<a />\");\r\n						$name.addClass(\"praiseuser_a\");\r\n						$name.attr(\"id\",\"".toCharArray();
    _jsp_string25 = "';\r\n	   \r\n	    			return false;\r\n	    		}\r\n	    		flag_msg += '\\r\\n\\r\\n".toCharArray();
    _jsp_string455 = ";\r\n\r\n	var lastTab = \"divProp\";\r\n	var fromTab = '0';\r\n	function onExpandOrCollapse(show,from){\r\n		\r\n		var flag = false;\r\n		if(document.getElementById(\"divPropTab\")&&document.getElementById(\"divPropTab\").style.display==\"none\"||show) flag = true;\r\n		var e8_shadow = jQuery(\"#e8_shadow\");\r\n		if(flag){\r\n			e8_shadow.show();\r\n			if(document.getElementById(\"BUTTONbtn_ShowOrHidden\")) document.getElementById(\"BUTTONbtn_ShowOrHidden\").value=wmsg.base.hiddenProp;\r\n			jQuery(\"#divTab #divPropTileIcon\").removeClass(\"x-tool-expand-south\").addClass(\"x-tool-collapse-south-over \");\r\n			if(!from){\r\n				onActiveTab(lastTab);\r\n			}\r\n		}else{\r\n			e8_shadow.hide();\r\n			document.getElementById(\"divPropTab\").style.display = \"none\";\r\n			if(document.getElementById(\"BUTTONbtn_ShowOrHidden\")) document.getElementById(\"BUTTONbtn_ShowOrHidden\").value=wmsg.base.showProp;\r\n			jQuery(\"#divTab #divPropTileIcon\").removeClass(\"x-tool-collapse-south-over\").addClass(\"x-tool-expand-south\");\r\n			jQuery(\"#divTab li.x-tab-strip-active\").removeClass(\"x-tab-strip-active\");\r\n		}\r\n		adjustContentHeight();\r\n		try {\r\n			loadExt();\r\n		} catch(e){}\r\n	}\r\n	function doAddWorkPlan_ext() {\r\n		document.location.href = \"/workplan/data/WorkPlan.jsp?docid=".toCharArray();
    _jsp_string106 = ";\r\n		 var isUseNewReply = \"".toCharArray();
    _jsp_string264 = ">\r\n        <input type=hidden name=\"billid\" value=".toCharArray();
    _jsp_string9 = "\r\n<script type=\"text/javascript\" src=\"/wui/common/jquery/jquery.min_wev8.js\"></script>\r\n".toCharArray();
    _jsp_string111 = ",0);\r\n						});\r\n					}\r\n			  }\r\n		 }\r\n	});\r\n	\r\n	function praise(replyid,replytype,docid)\r\n	{\r\n		jQuery.ajax({\r\n			type: \"POST\",\r\n			url: \"/docs/reply/OperDocReply.jsp\",\r\n			data: {\r\n			replyid: replyid,\r\n			operation: 'praise',\r\n			docid : docid,\r\n			replytype: replytype,\r\n			userid: ".toCharArray();
    _jsp_string279 = "\">\r\n    <textarea name=doccontent style=\"display:none;width:100%;\">".toCharArray();
    _jsp_string273 = "\">\r\n		<input type=hidden name=\"cptIds\" value=\"".toCharArray();
    _jsp_string325 = "\" class=\"cornerMenu\"></span>\r\n				</td>\r\n			</tr>\r\n		</table>\r\n	\r\n	".toCharArray();
    _jsp_string313 = "\" class=\"e8_btn_top\" onclick=\"CreateSignature(0);\" value=\"".toCharArray();
    _jsp_string91 = "&topage=".toCharArray();
    _jsp_string75 = "&meetingid=".toCharArray();
    _jsp_string85 = "&userCategory=".toCharArray();
    _jsp_string42 = "\";\r\n  var str1 = \"".toCharArray();
    _jsp_string433 = ";\r\n	var canDownload=".toCharArray();
    _jsp_string329 = "\r\n    			<li>\r\n		    		<a href='javascript:openFullWindowForXtable(\"/docs/docs/DocDsp.jsp?id=".toCharArray();
    _jsp_string309 = "\"></input>\r\n								<input type=button id=\"thSaveAgain_id\" style=\"".toCharArray();
    _jsp_string242 = "\">\r\n<table style=\"display:none\" id=\"customerTable\">\r\n		<tr id=\"customerTR\">\r\n			<td id=\"customerTD\">\r\n			</td>\r\n		</tr>\r\n	</table>\r\n	<input type=hidden id=\"selectedpubmouldid\" name=selectedpubmouldid value=\"".toCharArray();
    _jsp_string7 = "\",function(){\r\n	window.top.location=\"/login/Login.jsp\";\r\n});\r\n</script>\r\n".toCharArray();
    _jsp_string33 = "\");\r\n							}catch(e){\r\n								Dialog.alert(\"".toCharArray();
    _jsp_string181 = "\r\n	<div id=\"rightMenu\" name=\"rightMenu\" class=\"topmenuTable\" style=\"position:absolute;padding:3px;left:0px;right:6px;top:0px;margin-top:0px;posTop:0px;position:absolute;visibility:".toCharArray();
    _jsp_string77 = "\";\r\n		    </script> \r\n".toCharArray();
    _jsp_string459 = "&fromTab=\"+fromTab;\r\n		}\r\n		if(tab==\"divShare\"&&has_shareListIfrm==0){\r\n			has_shareListIfrm=1;\r\n			document.getElementById(\"shareListIfrm\").src=\"".toCharArray();
    _jsp_string45 = ";\r\nusbusercode0 = ".toCharArray();
    _jsp_string30 = "\r\n	}\r\n	catch(e) {\r\n		return check_conn();\r\n	}\r\n	if(!isconn)\r\n		return check_conn();\r\n    /* end by cyril on 2008-08-14 for td:8521 */\r\n	\r\n	thiswin = thiswins\r\n	items = \",\"+items + \",\";\r\n	\r\n	var tempfieldvlaue1 = \"\";\r\n	try{\r\n		tempfieldvlaue1 = document.getElementById(\"htmlfieldids\").value;\r\n	}catch (e) {\r\n	}\r\n\r\n	for(i=1;i<=thiswin.length;i++){\r\n		tmpname = thiswin.elements[i-1].name;\r\n		tmpvalue = thiswin.elements[i-1].value;\r\n	    if(tmpvalue==null){\r\n	        continue;\r\n	    }\r\n\r\n		if(tmpname!=\"\" && items.indexOf(\",\"+tmpname+\",\")!=-1){		\r\n			var __fieldhtmltype = jQuery(\"input[name=\" + tmpname + \"]\").attr(\"__fieldhtmltype\");\r\n		    if (__fieldhtmltype == '9') {\r\n		        continue;\r\n		    }\r\n		\r\n			var href = location.href;\r\n			if(href && href.indexOf(\"Ext.jsp\")!=-1){\r\n				window.__oriAlert__ = true;\r\n			}\r\n			if(tempfieldvlaue1.indexOf(tmpname+\";\") == -1){\r\n				while(tmpvalue.indexOf(\" \") >= 0){\r\n					tmpvalue = tmpvalue.replace(\" \", \"\");\r\n				}\r\n				while(tmpvalue.indexOf(\"\\r\\n\") >= 0){\r\n					tmpvalue = tmpvalue.replace(\"\\r\\n\", \"\");\r\n				}\r\n\r\n				if(tmpvalue == \"\"){\r\n					if(thiswin.elements[i-1].getAttribute(\"temptitle\")!=null && thiswin.elements[i-1].getAttribute(\"temptitle\")!=\"\"){\r\n						if(window.__oriAlert__){\r\n							window.top.Dialog.alert(\"\\\"\"+thiswin.elements[i-1].getAttribute(\"temptitle\")+\"\\\"\"+\"".toCharArray();
    _jsp_string159 = "</SPAN>\r\n<!-- bpf start 2013-10-23  -->	\r\n<link rel=\"stylesheet\" href=\"/css/ecology8/request/searchInput_wev8.css\" type=\"text/css\" />\r\n<script type=\"text/javascript\" src=\"/js/ecology8/request/searchInput_wev8.js\"></script>\r\n\r\n<script type=\"text/javascript\" src=\"/js/ecology8/request/hoverBtn_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/ecology8/request/titleCommon_wev8.js\"></script>\r\n\r\n<script type=\"text/javascript\">\r\n	function setFavPageName()\r\n	{\r\n		var BacoTitle = document.getElementById(\"objName\");\r\n		var pagename = \"\";\r\n		if(BacoTitle)\r\n		{\r\n			pagename = BacoTitle.innerText;\r\n		}\r\n		var favpagename = pagename;\r\n		favpagename = jQuery.trim(favpagename);\r\n		return favpagename;\r\n	}\r\n	function setFavUri()\r\n	{\r\n		var favuri = \"".toCharArray();
    _jsp_string122 = "\");\r\n				jQuery(\"#".toCharArray();
    _jsp_string476 = "\r\n		document.getElementById(\"divViewLogATab\").className = \"\";\r\n		".toCharArray();
    _jsp_string380 = "\r\n				<tr>\r\n					<td bgcolor=menu style=\"vertical-align:top;\" id=\"PDF417ManagerTd\">\r\n						<div style=\"display: none;\">\r\n							<OBJECT id=\"PDF417Manager\"  classid=\"".toCharArray();
    _jsp_string435 = ";\r\n	var canDocMark=".toCharArray();
    _jsp_string467 = "\r\n		document.getElementById(\"divReplay\").style.display='none';	\r\n		\r\n		".toCharArray();
    _jsp_string307 = "\r\n								<input type=button id=\"thCancel_id\" class=\"e8_btn_top\" style=\"".toCharArray();
    _jsp_string3 = "\r\n	<script language=\"javascript\">\r\n		window.top.Dialog.alert(\"".toCharArray();
    _jsp_string367 = "\r\n								<div style=\"height:100%;\">\r\n								<iframe id=\"previewDoc\" style=\"border:none;background-color:#fff;\" src=\"".toCharArray();
    _jsp_string167 = ");\r\n	var lineCount = Math.ceil(menuCount/menuCountLine);\r\n	var h = ".toCharArray();
    _jsp_string170 = "\r\n	try{\r\n		_menuDocument.getElementById(\"divTopMenu\").style.border = \"0px\";\r\n	}catch(e){}\r\n	try{\r\n		_menuDocument.getElementById(\"rightMenu\").style.border = \"0px\";\r\n	}catch(e){}\r\n	".toCharArray();
    _jsp_string185 = "px\">\r\n		</iframe>\r\n	</div>\r\n".toCharArray();
    _jsp_string31 = "\");\r\n						}else{\r\n							var tempElement = thiswin.elements[i-1];\r\n							//ueditor\u5fc5\u586b\u9a8c\u8bc1\r\n							if (checkueditorContent(tempElement)) {\r\n								continue;\r\n							}\r\n							\r\n							window.top.Dialog.alert(\"&quot;\"+thiswin.elements[i-1].getAttribute(\"temptitle\")+\"&quot;\"+\"".toCharArray();
    _jsp_string157 = "</label></td></tr></table>\r\n</div>\r\n\r\n\r\n".toCharArray();
    _jsp_string434 = ";//canEdit\r\n	var canViewLog=".toCharArray();
    _jsp_string109 = ",0,".toCharArray();
    _jsp_string305 = "\r\n									<input type=button id=\"thModeS_id\" style=\"".toCharArray();
    _jsp_string411 = "\r\n		<LI id=divViewLogATab class=\" \"  onclick=\"onActiveTab('divViewLog');\">\r\n		<A class=x-tab-strip-close onclick=\"return false;\"></A>\r\n		<A class=x-tab-right onclick=\"return false;\" href=\"#\">\r\n		<EM class=x-tab-left>\r\n		<SPAN class=x-tab-strip-inner><SPAN class=\"x-tab-strip-text \">".toCharArray();
    _jsp_string364 = "\r\n	    	</li>\r\n	    	".toCharArray();
    _jsp_string36 = "\");\r\n						}else{\r\n							var tempElement = thiswin.elements[i-1];\r\n							\r\n							//ueditor\u5fc5\u586b\u9a8c\u8bc1\r\n							if (checkueditorContent(tempElement)) {\r\n								continue;\r\n							}\r\n							\r\n							window.top.Dialog.alert(\"&quot;\"+thiswin.elements[i-1].getAttribute(\"temptitle\")+\"&quot;\"+\"".toCharArray();
    _jsp_string396 = "\r\n		<!-- \u6587\u6863\u65e5\u5fd7\u680f start -->\r\n		<div id=\"divViewLog\" class=\"e8_propTab\" style=\"display:none;width:100%;height:100%;\">\r\n			<DIV style=\"width:100%; height:100%; overflow: visible;border:none;\" class=\"x-tab-panel-body x-tab-panel-body-noheader x-tab-panel-body-noborder x-tab-panel-body-bottom\">\r\n			<iframe  id=\"logListIfrm\" style=\"border:none;\"frameborder=\"0\" width=\"100%\" height=\"100%\"></iframe>\r\n			</DIV>\r\n		</div>\r\n		<!-- \u6587\u6863\u65e5\u5fd7\u680f end -->\r\n		".toCharArray();
    _jsp_string375 = "\" >\r\n									</OBJECT>\r\n								</div>\r\n							".toCharArray();
    _jsp_string361 = "\r\n						<span id=\"noPraise\" style=\"line-height: 40px;margin-left: 20px;margin-right: 20px;\">".toCharArray();
    _jsp_string102 = "&versionId=".toCharArray();
    _jsp_string257 = "\">\r\n	<input type=hidden id=\"noSavePDF\" name=\"noSavePDF\" value=\"\">\r\n	<input type=hidden  id=signatureCount name=signatureCount value=\"0\">\r\n    <input type=hidden id=isFromAccessory name=isFromAccessory value='".toCharArray();
    _jsp_string179 = "px\" height=\"".toCharArray();
    _jsp_string466 = "\r\n			if(fromTab == \"1\"){\r\n				window.setTimeout(function(){\r\n					try{\r\n						replyInfoIfrm.window.initRemark();\r\n						fromTab = \"0\";\r\n					}catch(e){}\r\n				},200);		\r\n			}else{\r\n				window.setTimeout(function(){\r\n					try{\r\n						replyInfoIfrm.window.hideRemark();\r\n					}catch(e){}\r\n				},200);	\r\n			}\r\n		".toCharArray();
    _jsp_string258 = "'>\r\n    <input type=hidden id=\"editMouldId\" name=\"editMouldId\" value=\"".toCharArray();
    _jsp_string131 = "\">\r\n    <input type=hidden name=sqlwhere value=\"".toCharArray();
    _jsp_string336 = "</div><span class=\"vpSpan change-font-color\">(<font>".toCharArray();
    _jsp_string377 = "	\r\n							<div style=\"height:100%;\">\r\n								<div style=\"height:100%;\">\r\n								<iframe id=\"previewDoc\" onload=\"finalDo('view')\" style=\"border:none;background-color:#fff;\" src=\"".toCharArray();
    _jsp_string117 = ")\");\r\n					  	$name.click(function() {\r\n								pointerXY(event);\r\n						});\r\n						$name.append(\"".toCharArray();
    _jsp_string26 = "';\r\n	        	//alert(xmlhttp.responseText);\r\n	        	return confirm(flag_msg);\r\n	        }\r\n	    }\r\n	    xmlhttp = null;\r\n\r\n	  	//\u68c0\u67e5\u591a\u884c\u6587\u672c\u6846 oracle\u4e0b\u68c0\u67e5HTML\u4e0d\u80fd\u8d85\u8fc74000\u4e2a\u5b57\u7b26\r\n	    ".toCharArray();
    _jsp_string228 = "\">\r\n    <input type=hidden name=docapprovable value=\"".toCharArray();
    _jsp_string220 = "&nbsp;:&nbsp;&nbsp;&nbsp;</span>\r\n										<span class=\"STYLE61\" id=\"result3\"></span>\r\n									</td>\r\n								</tr>\r\n								<tr>\r\n									<td style=\"WORD-WRAP: break-word;TEXT-VALIGN: left;word-break:break-all;\">\r\n										<span class=\"STYLE6\">".toCharArray();
    _jsp_string204 = "';\r\n    }\r\n    window.open(operationPage+\"?pathKey=\"+pathKey,\"_blank\",\"top=0,left=\"+(screenWidth-800)/2+\",height=\"+(screenHeight-90)+\",width=1000,status=no,scrollbars=yes,toolbar=yes,menubar=no,location=no\");\r\n}\r\n</script>\r\n".toCharArray();
    _jsp_string410 = "\r\n		<LI id=divVerATab class=\" \"  onclick=\"onActiveTab('divVer');\">\r\n		<A class=x-tab-strip-close onclick=\"return false;\"></A>\r\n		<A class=x-tab-right onclick=\"return false;\" href=\"#\">\r\n		<EM class=x-tab-left>\r\n		<SPAN class=x-tab-strip-inner><SPAN class=\"x-tab-strip-text \"><script type=\"text/javascript\">document.write(wmsg.doc.version);</script></SPAN></SPAN>\r\n		</EM>\r\n		</A>\r\n		</LI>\r\n		".toCharArray();
    _jsp_string358 = "</span><div onclick=\"moreUserView();\" class=\"moreUserView\"></div>\r\n				  	".toCharArray();
    _jsp_string286 = "\r\n						".toCharArray();
    _jsp_string482 = "\r\n		else if(document.getElementById(\"divViewLog\").style.display!='none')\r\n			resizedivViewLog();\r\n		".toCharArray();
    _jsp_string218 = "&nbsp;:&nbsp;&nbsp;&nbsp;</span>\r\n										<span class=\"STYLE61\" id=\"result7\"></span>\r\n									</td>\r\n								</tr>\r\n								<tr>\r\n									<td style=\"WORD-WRAP: break-word;TEXT-VALIGN: left;word-break:break-all;\">\r\n										<span class=\"STYLE6\">".toCharArray();
    _jsp_string310 = "\" class=\"e8_btn_top\" onclick=\"saveTHTemplateNoConfirm(".toCharArray();
    _jsp_string136 = "\";\r\n	var isEditionOpen = 0;\r\n	if(mode!=\"add\") {\r\n		if(e8isParentWin){\r\n			isEditionOpen=window.isEditionOpen?1:0;\r\n		}else{\r\n			isEditionOpen=parent.isEditionOpen?1:0;\r\n		}\r\n	}\r\n	\r\n	var d=new Date();\r\n	var indexid=\"index_\"+d.getSeconds()+d.getMilliseconds();\r\n	targetObj.attr(\"oUploaderIndex\",\"oUploader_\"+indexid);\r\n	//\"<input id='relateAccDocids_\"+indexid+\"' type='hidden' name='\"+relateaccName+\"'>\"+\r\n	targetObj.html(\r\n	   \"<div>\"+\r\n			\"<span>\"+ \r\n				 \"<span id='btnSelectedAcc_\"+indexid+\"'></span>\"+\r\n			\"</span>\"+		\r\n		\"</div>\"+\r\n		\"<div class='fieldset flash' style='display:none;width:240px;position:absolute;\"+(e8isParentWin?\"\":\"right:0;\")+\"' id='fsUploadProgress_\"+indexid+\"'></div>\"+\r\n		\"<div id='divStatus_\"+indexid+\"'></div>\");\r\n		\r\n	   window[\"oUploader_\"+indexid]=getUploader(indexid,maxsize,mode,docid,isEditionOpen,e8isParentWin);\r\n	   //alert( window[\"oUploader_\"+indexid]);\r\n}\r\n\r\nfunction getUploader(indexid,maxsize,mode,docid,isEditionOpen,e8isParentWin){\r\n    maxsize=(maxsize==0?5:maxsize);\r\n	var oUploader=null; \r\n	var upload_url = \"\";\r\n	var button_height = 24;\r\n	if(e8isParentWin){\r\n		button_height = 16;\r\n	}\r\n	upload_url=\"/docs/docs/DocImgUpload.jsp\";\r\n	\r\n	var file_types=\"*.*\";\r\n	if(\"".toCharArray();
    _jsp_string76 = "&fromFlowDoc=".toCharArray();
    _jsp_string52 = "\r\n\r\n\r\n<!--For wui-->\r\n".toCharArray();
    _jsp_string387 = "	\r\n						<OBJECT id=SignatureAPI classid=\"clsid:79F9A6F8-7DBE-4098-A040-E6E0C3CF2001\"  codebase=\"iSignatureAPI.ocx#version=5,0,2,0\" width=0 height=0 align=center hspace=0 vspace=0></OBJECT>\r\n					".toCharArray();
    _jsp_string135 = "\r\n<style type=\"text/css\">\r\n	#warn {\r\n		width: 260px;\r\n		height: 65px;\r\n		line-height: 65px;\r\n		background-color: gray;\r\n		position: absolute;\r\n		display: none;\r\n		text-align: center;\r\n		background: url(\"/images/ecology8/addWorkGround_wev8.png\");\r\n	}\r\n</style>\r\n<link href=\"/js/swfupload/default_wev8.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<script type=\"text/javascript\" src=\"/js/swfupload/swfupload_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/swfupload/swfupload.queue_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/swfupload/fileprogress_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/swfupload/handlers_wev8.js\"></script>\r\n	<script type=\"text/javascript\" src=\"/js/doc/upload_wev8.js\"></script>\r\n<script language=\"javascript\">\r\nvar parentWin = window;\r\nfunction bindUploaderDiv(targetObj,relateaccName,e8isParentWin){\r\n	if(e8isParentWin){\r\n		try{\r\n			parentWin = jQuery(\"#e8DocAccIfrm\").get(0).contentWindow;\r\n		}catch(e){} \r\n	}else{\r\n		parentWin = window;\r\n	}\r\n	var maxsize=\"1024\";\r\n	var mode=\"add\";\r\n	var docid=\"".toCharArray();
    _jsp_string47 = "\";\r\nusblanguage = \"".toCharArray();
    _jsp_string378 = "\" frameborder=\"0\" width=\"100%\" height=\"100%\"></iframe>\r\n							</div>\r\n							</div>\r\n						 ".toCharArray();
    _jsp_string448 = "\r\n				jQuery(\"#WebOffice\").width(divContentWidth);\r\n			}\r\n			try{\r\n				jQuery(\"#e8DocAccIfrm\").parent().height(jQuery(\".tab_box\").height());\r\n			}catch(e){\r\n			}\r\n	        try{\r\n				jQuery(\"#shareListIfrm\").parent().height(jQuery(\".tab_box\").height());\r\n			}catch(e){\r\n			}\r\n			try{\r\n				jQuery(\"#markListIfrm\").parent().height(jQuery(\".tab_box\").height());\r\n			}catch(e){\r\n			}\r\n	        try{\r\n				jQuery(\"#resourceListIfrm\").parent().height(jQuery(\".tab_box\").height());\r\n			}catch(e){\r\n			}\r\n			try{\r\n				jQuery(\"#logListIfrm\").parent().height(jQuery(\".tab_box\").height());\r\n			}catch(e){\r\n			}\r\n	        try{\r\n				jQuery(\"#versionListIfrm\").parent().height(jQuery(\".tab_box\").height());\r\n			}catch(e){\r\n			}\r\n			onResizeDiv();\r\n		} catch(e){	}\r\n	}\r\n	var isPDF=0;\r\n	var canEditPDF=0;\r\n	var accessorycount=".toCharArray();
    _jsp_string337 = "</font>)</span>\r\n		    	<script type=\"text/javascript\">\r\n		    		jQuery(function(){\r\n				        jQuery(\"#viewcountDiv\").bind(\"click\",function (){\r\n							onActiveTab('divViewLogRead');\r\n						});\r\n						\r\n						jQuery(\".change-font-color\").mouseover(function(){\r\n							$(\".change-font-color\").css(\"color\",\"#676767\");\r\n						}).mouseout(function(){\r\n							$(\".change-font-color\").css(\"color\",\"#B8B8B8\");\r\n						});\r\n						jQuery(\".vpSpan.change-font-color\").click(function(){\r\n							$(\"#viewcountDiv\").click();\r\n						});\r\n					 });\r\n		    	</script>\r\n		    	".toCharArray();
    _jsp_string55 = "/skins/".toCharArray();
    _jsp_string343 = "\r\n			    		<div class=\"praiseInfo_hot\" title=\"".toCharArray();
    _jsp_string93 = "\";\r\n		        }else{\r\n					location=\"/notice/noright.jsp\";\r\n				}\r\n		    </script> \r\n	".toCharArray();
    _jsp_string237 = "\">\r\n	<input type=hidden name=maincategory value=\"".toCharArray();
    _jsp_string462 = "\";\r\n		}\r\n		if(tab==\"divViewLogRead\"&&has_logListIfrm==0){\r\n			has_logListIfrm=1;\r\n			tab = \"divViewLog\";\r\n			document.getElementById(\"logListIfrm\").src=\"".toCharArray();
    _jsp_string175 = ");\r\n			}\r\n		}catch(e){}\r\n		".toCharArray();
    _jsp_string37 = "\", function () {\r\n								formElementFocus(tempElement);\r\n							});\r\n							\r\n						}\r\n						return false;\r\n					}else{\r\n						if(window.__oriAlert__){\r\n							window.top.Dialog.alert(\"".toCharArray();
    _jsp_string418 = "\r\n\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n	var isFromWf=".toCharArray();
    _jsp_string124 = "\r\n\r\n	".toCharArray();
    _jsp_string90 = "&blnOsp=".toCharArray();
    _jsp_string15 = "\\r\\n\\r\\n".toCharArray();
    _jsp_string128 = "'>\r\n    </form>\r\n \r\n    <FORM id=docsharelog name=docsharelog action=\"DocShare.jsp\" method=post  target=\"_blank\">\r\n    <input type=hidden name=docid value=\"".toCharArray();
    _jsp_string262 = ">\r\n        <input type=hidden name=\"src\">\r\n        <input type=hidden name=\"iscreate\" value=\"0\">\r\n        <input type=hidden name=\"formid\" value=".toCharArray();
    _jsp_string62 = "\r\n<!-- \u9875\u9762\u5207\u6362\u6548\u679cEnd -->\r\n\r\n\r\n<script language=\"javascript\">\r\n\r\n//------------------------------\r\n// the folder of current skins \r\n//------------------------------\r\n//\u5f53\u524d\u4f7f\u7528\u7684\u4e3b\u9898\r\nvar GLOBAL_CURRENT_THEME = \"".toCharArray();
    _jsp_string138 = "\"==\".docx\"){\r\n		file_types=\"*.doc;*.docx\";	\r\n	} else if(\"".toCharArray();
    _jsp_string99 = "\";\r\n		".toCharArray();
    _jsp_string244 = "\">\r\n	<input type=hidden id= crmid name=crmid value=\"".toCharArray();
    _jsp_string41 = "\";\r\n   if(!confirm(str)){\r\n       return false;\r\n   }\r\n       return true;\r\n   } \r\n\r\n///*\u6d41\u7a0b\u91cc\u9762\u4f7f\u7528\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u6d41\u7a0b\u5185\u5bb9\u653e\u5230iframe\u91cc\u9762\uff0c\u901a\u8fc7response\u8fd4\u56de\u7684\u65f6\u5019\uff0c\u8981\u8fd4\u56de\u7684\u5230\u5176\u7236\u7a97\u53e3*/\r\nfunction wfforward(wfurl){\r\n	parent.location.href = wfurl;\r\n}\r\n\r\nfunction myescapecode(str)\r\n{\r\n	return encodeURIComponent(str);\r\n}\r\n</script>\r\n\r\n\r\n\r\n<meta http-equiv=Content-Type content=\"text/html; charset=UTF-8\">\r\n<script language=JavaScript> \r\n  var companyname = \"".toCharArray();
    _jsp_string334 = "</span><span>".toCharArray();
    _jsp_string235 = "\">\r\n	<input type=hidden name=docedition value=\"".toCharArray();
    _jsp_string385 = "\" \r\n						width=0 height=0 align=center hspace=0 vspace=0></OBJECT>\r\n					".toCharArray();
    _jsp_string318 = "\r\n				".toCharArray();
    _jsp_string88 = "&isrequest=".toCharArray();
    _jsp_string464 = "\";\r\n		}\r\n\r\n		var e8_shadow = jQuery(\"#e8_shadow\");\r\n		".toCharArray();
    _jsp_string261 = ">\r\n        <input type=hidden name=\"nodetype\" value=".toCharArray();
    _jsp_string457 = "\r\nvar has_e8DocAccIfrm=0;\r\nvar has_replyInfoIfrm=0;\r\nvar has_shareListIfrm=0;\r\nvar has_versionListIfrm=0;\r\nvar has_logListIfrm=0;\r\nvar has_markListIfrm=0;\r\n\r\n	function onActiveTab(tab,notOpen){\r\n		lastTab = tab;\r\n		if(tab==\"divContentInfo\"){\r\n			var e8AccListArea = jQuery(\"div.e8AccListArea\");\r\n			if(e8AccListArea.length>0){\r\n				if(e8AccListArea.data(\"isClosed\")===true){\r\n					jQuery(\"div.e8AccListBtn\").show();\r\n					jQuery(\"#e8DocAccviewIframe\").show();\r\n				}else{\r\n					e8AccListArea.show();\r\n					jQuery(\"#e8DocAccviewIframe\").hide();\r\n				}\r\n			}\r\n		}else{\r\n			jQuery(\"div.e8AccListArea\").hide();\r\n	 		jQuery(\"div.e8AccListBtn\").hide();\r\n	 		jQuery(\"#e8DocAccviewIframe\").hide();\r\n		}\r\n		document.getElementById(\"divProp\").style.display='none';\r\n		document.getElementById(\"divAcc\").style.display='none';\r\n		document.getElementById(\"divContentInfo\").style.display='none';\r\n\r\n		if(tab==\"divAcc\"&&has_e8DocAccIfrm==0){\r\n			has_e8DocAccIfrm=1;\r\n			document.getElementById(\"e8DocAccIfrm\").src=\"".toCharArray();
    _jsp_string79 = "\r\n		<script>\r\n		window.opener.location=\"".toCharArray();
    _jsp_string68 = "	\r\n".toCharArray();
    _jsp_string400 = "\r\n		<iframe id=\"e8DocAccviewIframe\" style=\"position:absolute;bottom:60px;z-index:2;width:100%;width:44px;height:44px;right:15px;filter:alpha(opacity=0);opacity:0;\" frameborder=\"none\" src=\"\"></iframe>\r\n		".toCharArray();
    _jsp_string483 = "\r\n		else if(document.getElementById(\"divMark\").style.display!='none')\r\n			resizedivMark();\r\n		".toCharArray();
    _jsp_string479 = "\r\n		else if(document.getElementById(\"divReplay\").style.display!='none')\r\n			resizedivReplay();\r\n		".toCharArray();
    _jsp_string192 = "\r\n	try{\r\n		_menuDocument.getElementById(\"rightMenu\").style.visibility=\"hidden\";\r\n	}catch(e){}\r\n	//rightMenu.style.display=\"\"; //update by liaodong for qc62834 in 20130913\r\n	jQuery(rightMenuStr).hide();\r\n	".toCharArray();
    _jsp_string84 = "&from=".toCharArray();
    _jsp_string1 = "\r\n<!DOCTYPE HTML>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<html>\r\n<head>\r\n<!-- \r\n\u6dfb\u52a0\u81f3init.css\r\n<style type=\"text/css\">\r\n	html{height:100%;}\r\n</style>\r\n -->\r\n".toCharArray();
    _jsp_string13 = "_wev8.js\"></script>\r\n<script type=\"text/javascript\" src=\"/js/messagejs/highslide/highslide-full_wev8.js\"></script>\r\n<script type=\"text/javascript\">\r\n    hs.graphicsDir = '/js/messagejs/highslide/graphics/';\r\n    hs.align = 'center';\r\n    hs.transitions = ['expand', 'crossfade'];\r\n    hs.outlineType = 'rounded-white';\r\n    hs.fadeInOut = true;\r\n</script>\r\n<!-- init.css, \u6240\u6709css\u6587\u4ef6\u90fd\u5728\u6b64\u6587\u4ef6\u4e2d\u5f15\u5165 -->\r\n<link rel=\"stylesheet\" href=\"/css/init_wev8.css\" type=\"text/css\" />\r\n\r\n\r\n<script language=javascript>\r\nwindow[\"_jsessionid\"] = \"".toCharArray();
    _jsp_string320 = "\r\n					<input type=button class=\"e8_btn_top\" onclick=\"javascript:onDocShare(".toCharArray();
    _jsp_string100 = "\r\n			webOfficeMenuClick(37,'');\r\n		".toCharArray();
    _jsp_string456 = "&add=1\";\r\n	}\r\n".toCharArray();
    _jsp_string287 = "\r\n							<input type=button class=\"e8_btn_top\" onclick=\"javascript:webOfficeMenuClickNew(7)\" value=\"".toCharArray();
    _jsp_string425 = "\";\r\n	var isReply=\"".toCharArray();
    _jsp_string484 = "\r\n\r\n	}\r\n	\r\n	var replaceAcc = null;\r\n	jQuery(document).ready(function(){\r\n		replaceAcc = jQuery(\"#replaceAcc\");\r\n		bindAttach();\r\n\r\n	});\r\n\r\n	function bindAttach(){\r\n		if(jQuery(\"#AccPlaceHolder\").length==0)return;\r\n		resetReplaceAccPosition();\r\n		bindUploaderDiv(replaceAcc);\r\n		replaceAcc.hover(function(){\r\n			 jQuery(\"#rightBox\").find(\"#AccPlaceHolder\").addClass(\"e8_top_btnHover\");\r\n		},function(){\r\n			 jQuery(\"#rightBox\").find(\"#AccPlaceHolder\").removeClass(\"e8_top_btnHover\");\r\n		});\r\n	}\r\n	\r\n	function resetReplaceAccPosition(){\r\n		if(jQuery(\"#AccPlaceHolder\").length==0)return;\r\n		var placeHolder = jQuery(\"#rightBox\").find(\"#AccPlaceHolder\");\r\n		if(placeHolder.length>0){\r\n			var width = placeHolder.outerWidth();\r\n			var left = placeHolder.offset().left;\r\n			var top = placeHolder.offset().top;\r\n			replaceAcc.css({\r\n				\"width\":width+\"px\",\r\n				\"left\":left+\"px\",\r\n				\"top\":top+\"px\"\r\n			});\r\n		}else{\r\n			setTimeout(function(){\r\n				resetReplaceAccPosition();\r\n			},500);\r\n		}\r\n	}\r\n\r\n	jQuery(window).resize(function(){\r\n		resetReplaceAccPosition();\r\n	});\r\n	\r\n	function used4SelectAccVersion(versionId){\r\n		jQuery(\"#selectAccVersionBtn\").attr(\"data-versionid\",versionId);\r\n		jQuery(\"#selectAccVersionBtn\").trigger(\"click\");	\r\n	}\r\n	\r\n	function getBrowserUrl4selectAccVersion(){\r\n		return \"/systeminfo/BrowserMain.jsp?mouldID=doc&url=/docs/docs/listVersion.jsp?versionId=\"+jQuery(\"#selectAccVersionBtn\").attr(\"data-versionid\")+\"&docid=".toCharArray();
    _jsp_string321 = ",'".toCharArray();
    _jsp_string163 = "\">\r\n\r\n<script language=\"JavaScript\">\r\nvar _parentmenuDocument = document;\r\nvar _menuDocument = document;\r\nvar _menuWindow = window;\r\nvar __isReloadPage = true;\r\nvar __isParentPage = false;\r\n//\u5f53\u524d\u4f7f\u7528\u7684\u4e3b\u9898\r\nvar GLOBAL_CURRENT_THEME = \"ecology8\";\r\n//\u5f53\u524d\u4e3b\u9898\u4f7f\u7528\u7684\u76ae\u80a4\r\nvar GLOBAL_SKINS_FOLDER = \"default\";\r\nfunction setMenuBoxHeightSelf(){\r\n	try{\r\n		var objhasTopTitleExtInput = _menuDocument.getElementById(\"hasTopTitleExtInput\");\r\n		if(objhasTopTitleExtInput!=null && objhasTopTitleExtInput.value==\"1\"){\r\n			_menuDocument.getElementById(\"rightMenu\").style.visibility = \"hidden\";\r\n			_menuDocument.getElementById(\"rightMenu\").style.display=\"none\";\r\n		}\r\n	}catch(e){}\r\n	var menuCount = \"".toCharArray();
    _jsp_string35 = "\");\r\n							}\r\n						}\r\n						return false;\r\n					}\r\n				}\r\n			} else {\r\n				var divttt=document.createElement(\"div\");\r\n				divttt.innerHTML = tmpvalue;\r\n				var tmpvaluettt = jQuery.trim(jQuery(divttt).text());\r\n				if(tmpvaluettt == \"\"){\r\n					if(thiswin.elements[i-1].getAttribute(\"temptitle\")!=null && thiswin.elements[i-1].getAttribute(\"temptitle\")!=\"\"){\r\n						if(window.__oriAlert__){\r\n							window.top.Dialog.alert(\"\\\";\"+thiswin.elements[i-1].getAttribute(\"temptitle\")+\"\\\"\"+\"".toCharArray();
    _jsp_string452 = "\";\r\n	var message21701 = \"".toCharArray();
    _jsp_string395 = "\r\n		".toCharArray();
    _jsp_string4 = "\",function(){\r\n			window.top.location=\"".toCharArray();
    _jsp_string209 = "\r\n							<td><img src=\"/images/messageimages/temp/emessage_wev8.png\" onmouseover=\"javascript:this.src='/images/messageimages/temp/emessagehot_wev8.png';\" onmouseout=\"javascript:this.src='/images/messageimages/temp/emessage_wev8.png';\" onclick=\"javascript:sendSimpleEmessage();\" title=\"".toCharArray();
    _jsp_string184 = ";display:none;\" align=\"left\"  allowtransparency=\"true\" style=\"background-color:transparent\" >\r\n	</div>\r\n	<div id=\"divRightMenuIframe\" name=\"divRightMenuIframe\" style=\"display:none\">\r\n		<iframe id=\"rightMenuIframe\" name=\"rightMenuIframe\" frameborder=0 marginheight=0 marginwidth=0 hspace=0 vspace=0 scrolling=no width=\"".toCharArray();
    _jsp_string346 = "\r\n		    	\r\n		    	<div class=\"magic-line1\"></div>\r\n		    	<div id=\"praiseUsers\" class=\"praiseUserDiv\">\r\n					".toCharArray();
    _jsp_string291 = "\"></input>\r\n						".toCharArray();
    _jsp_string381 = "\"   codebase=\"".toCharArray();
    _jsp_string363 = "\r\n				</div>\r\n				<script type=\"text/javascript\">\r\n					 var iTime ;\r\n					 jQuery(function(){\r\n				        // \u5217\u8868\u7f8e\u5316\r\n						jQuery('#praiseUsers').perfectScrollbar();\r\n						jQuery(\"#praiseUsers\").live('mousedown', function(){\r\n							return false;\r\n						});\r\n						jQuery(\"#praiseInfo\").live('mousedown', function(){\r\n							return false;\r\n						});\r\n						jQuery(\"html\").live('mousedown', function(){\r\n							jQuery(\"#praiseUsers\").fadeOut();\r\n				          	jQuery(\".magic-line1\").fadeOut();\r\n						});\r\n						\r\n						jQuery(\"#praiseCountSpan\").hover(function() {\r\n								jQuery(\"#praiseUsers\").show();\r\n				          		jQuery(\".magic-line1\").show();\r\n				          		jQuery(\".magic-line1\").css('left',jQuery(\"#praiseCount\").position().left-9);\r\n				          		jQuery(\"#praiseUsers\").css('margin-left',jQuery(\"#praiseCount\").position().left-100);\r\n				          		return;\r\n				        }).mouseout(function(event){\r\n				          	var _left = Math.floor(jQuery(this).position().left);\r\n				          	var _right = Math.floor(_left + this.clientWidth);\r\n				          	var _top = Math.floor(jQuery(this).position().top);\r\n				          	var _eventX = event.clientX;\r\n				          	var _eventY = event.clientY;\r\n				          	if(_left >= _eventX || _right <= _eventX || _top >= _eventY){\r\n				          		jQuery(\"#praiseUsers\").fadeOut();\r\n				          		jQuery(\".magic-line1\").fadeOut();\r\n				          	}\r\n				          });\r\n					});\r\n					\r\n					\r\n					function moreUserView()\r\n					{\r\n						jQuery(\".praiseuser_a_hidden\").each(function(){\r\n							jQuery(this).removeClass(\"praiseuser_a_hidden\");\r\n							jQuery(this).addClass(\"praiseuser_a_show\");\r\n						})\r\n						$ldiv = jQuery(\"<div />\");\r\n						$ldiv.addClass(\"lettelUserView\");\r\n						$ldiv.click(function(){\r\n							 lettelUserView();\r\n						});\r\n						jQuery(\"#praiseUsers\").append($ldiv);\r\n						jQuery(\"#pumes\").hide();\r\n						jQuery('#praiseUsers').perfectScrollbar(\"resize\");\r\n					}\r\n					\r\n					function lettelUserView()\r\n					{\r\n						jQuery(\".praiseuser_a_show\").each(function(){\r\n							jQuery(this).removeClass(\"praiseuser_a_show\");\r\n							jQuery(this).addClass(\"praiseuser_a_hidden\");\r\n						})\r\n						jQuery(\"#pumes\").show();\r\n						jQuery(\".lettelUserView\").hide();\r\n						jQuery('#praiseUsers').perfectScrollbar(\"resize\");\r\n					}\r\n					\r\n					function downloads(fileid){\r\n						window.open(\"/weaver/weaver.file.FileDownload?fileid=\"+fileid+\"&download=1\");\r\n					}\r\n					\r\n				</script>\r\n				".toCharArray();
    _jsp_string161 = "\";\r\n		try\r\n		{\r\n			var e8tabcontainer = jQuery(\"div[_e8tabcontainer='true']\",parent.document);\r\n			if(e8tabcontainer.length > 0) \r\n			{\r\n				favquerystring = escape(parent.window.location.search);\r\n			}\r\n			//alert(fav_uri+\"  \"+fav_querystring)\r\n		}\r\n		catch(e)\r\n		{\r\n			\r\n		}\r\n		favquerystring = escape(favquerystring); \r\n		return favquerystring;\r\n	}\r\n</script>\r\n\r\n\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string120 = "up\").is('.praiseuser_a')){\r\n							jQuery(\".praiseuser_a_hidden:first\").addClass(\"praiseuser_a\");\r\n							jQuery(\".praiseuser_a_hidden:first\").removeClass(\"praiseuser_a_hidden\");\r\n						}\r\n							jQuery(\"#fuserFont\").text(index-1);\r\n		  			}\r\n		  			jQuery(\"#praiseInfo\").attr(\"title\",\"".toCharArray();
    _jsp_string113 = "\");\r\n					jQuery(\"#praiseInfo\").removeClass('praiseInfo');\r\n					jQuery(\"#praiseInfo\").addClass('praiseInfo_hot');\r\n					jQuery(\"#praiseCountSpan\").removeClass('praiseSpan');\r\n					jQuery(\"#praiseCountSpan\").addClass('praiseSpan_hot');\r\n					\r\n					jQuery(\"#praiseInfo\").text(\"".toCharArray();
    _jsp_string154 = "\r\n\r\nfunction flashChecker() {\r\n	var hasFlash = 0; //\u662f\u5426\u5b89\u88c5\u4e86flash\r\n	var flashVersion = 0; //flash\u7248\u672c\r\n	//var isIE = /*@cc_on!@*/0; //\u662f\u5426IE\u6d4f\u89c8\u5668\r\n	var isIE = ".toCharArray();
    _jsp_string373 = "top:".toCharArray();
    _jsp_string50 = "\r\n<LINK href=\"/js/jquery/jquery_dialog_wev8.css\" type=text/css rel=STYLESHEET>\r\n<script type=\"text/javascript\" src=\"/wui/common/jquery/jquery.min_wev8.js\"></script>\r\n<script type=\"text/javascript\" language=\"javascript\" src=\"/js/jquery/jquery_dialog_wev8.js\"></script>\r\n\r\n<script src=\"/social/js/drageasy/drageasy.js\"></script>\r\n<script type=\"text/javascript\" src=\"/social/js/bootstrap/js/bootstrap.js\"></script>\r\n<script type=\"text/javascript\" src=\"/social/im/js/IMUtil_wev8.js\"></script>\r\n\r\n<script type=\"text/javascript\" src=\"/social/js/imcarousel/imcarousel.js\"></script>\r\n<script type=\"text/javascript\" language=\"javascript\">\r\nfunction ReloadOpenerByDialogClose() {\r\n    ".toCharArray();
    _jsp_string391 = "\r\n		<!-- \u6587\u6863\u56de\u590d\u680f start -->\r\n		<div id=\"divReplay\" class=\"e8_propTab\" style=\"display:none;width:100%;height:100%;\">\r\n			<DIV style=\"width:100%; height:100%; overflow: visible\" class=\"x-panel-body x-panel-body-noheader x-panel-body-noborder\">\r\n				".toCharArray();
    _jsp_string229 = "\">\r\n	<input type=hidden name=ownerid value=\"".toCharArray();
    _jsp_string160 = "\";\r\n		try\r\n		{\r\n			var e8tabcontainer = jQuery(\"div[_e8tabcontainer='true']\",parent.document);\r\n			if(e8tabcontainer.length > 0) \r\n			{\r\n				favuri = escape(parent.window.location.pathname);\r\n			}\r\n			//alert(fav_uri+\"  \"+fav_querystring)\r\n		}\r\n		catch(e)\r\n		{\r\n			\r\n		}\r\n		favuri = escape(favuri); \r\n		return favuri;\r\n	}\r\n	function setFavQueryString()\r\n	{\r\n		var favquerystring = \"".toCharArray();
    _jsp_string486 = "\";	\r\n	}\r\n	\r\n	function afterSelectAccVersion(e,datas,params,name){\r\n		if(datas){			\r\n			if(datas.id!=\"\"){\r\n				window.location=\"DocDspExt.jsp?id=".toCharArray();
    _jsp_string191 = "\r\n		if(parent.jQuery(\"#divWfTextTab\").parent().hasClass(\"current\")){\r\n			return;\r\n		}\r\n		if(typeof(changePageMenuDiaplay)==\"function\"){\r\n			changePageMenuDiaplay(2);\r\n		}\r\n        focus_e = _menuDocument.activeElement;\r\n        var evt = e?e:(_menuWindow.event?_menuWindow.event:null);\r\n        var target = null;\r\n        if(_menuWindow.event){\r\n        	target = evt.srcElement;\r\n        }else{\r\n        	target = evt.target;\r\n        }\r\n        var exceptTop = 0;\r\n        if(jQuery(target).closest(\"div.e8_boxhead\").length==0 && __isParentPage){\r\n        	exceptTop = 60;\r\n        }\r\n		var rightedge=_menuDocument.body.clientWidth-evt.clientX\r\n		var bottomedge=_menuDocument.body.clientHeight-evt.clientY\r\n		var scrolltop =  get_scrollTop_of_body();\r\n		if(__isParentPage){\r\n			scrolltop = 0;\r\n		}\r\n		if(rightedge>evt.clientX){\r\n			jQuery(rightMenuStr,_menuDocument).css(\"left\",_menuDocument.body.clientWidth-rightedge);\r\n		}else{\r\n			jQuery(rightMenuStr,_menuDocument).css(\"left\",evt.clientX-_menuDocument.getElementById(\"rightMenu\").offsetWidth);\r\n		}\r\n		if(bottomedge>evt.clientY){\r\n			jQuery(rightMenuStr,_menuDocument).css(\"top\",evt.clientY+scrolltop+exceptTop);\r\n		}else{\r\n			jQuery(rightMenuStr,_menuDocument).css(\"top\",_menuDocument.body.clientHeight+scrolltop-bottomedge+exceptTop);\r\n		}\r\n		if(_menuDocument.getElementById(\"rightMenu\").offsetHeight>bottomedge){\r\n			    if(evt.clientY>(_menuDocument.body.clientHeight/2)){//\u5f53\u9875\u9762\u9ad8\u5ea6\u5c0f\u4e8e\u83dc\u5355\u9ad8\u5ea6\uff0c\u90a3\u4e48\u5728\u9875\u9762\u7684\u4e0a\u9762\u4e8c\u5206\u4e4b\u4e00\u7684\u5730\u65b9\u70b9\u51fb\uff0c\u83dc\u5355\u663e\u793a\u4e0a\u9762\u90e8\u5206\uff0c\u5728\u9875\u9762\u4e0b\u9762\u90e8\u5206\u70b9\u51fb\uff0c\u83dc\u5355\u663e\u793a\u4e0b\u9762\u90e8\u5206\r\n					jQuery(rightMenuStr,_menuDocument).css(\"top\",_menuDocument.body.clientHeight+scrolltop-_menuDocument.getElementById(\"rightMenu\").offsetHeight+exceptTop);\r\n			    }\r\n		}\r\n\r\n		_menuDocument.getElementById(\"rightMenu\").style.visibility=\"visible\";\r\n		jQuery(rightMenuStr,_menuDocument).show();	\r\n		try{\r\n			evt.stopPropagation();\r\n		}catch(e){\r\n			evt.cancelBubble = true\r\n			evt.returnValue = false; \r\n		}\r\n		return false;\r\n}\r\nfunction get_scrollTop_of_body(){ \r\n        var scrollTop; \r\n        if(typeof _menuWindow.pageYOffset != 'undefined'){\r\n            scrollTop = _menuWindow.pageYOffset; \r\n        }else if(typeof _menuDocument.compatMode != 'undefined' && _menuDocument.compatMode != 'BackCompat')        { \r\n            scrollTop = _menuDocument.documentElement.scrollTop; \r\n        }else if(typeof _menuDocument.body != 'undefined'){ \r\n            scrollTop = _menuDocument.body.scrollTop; \r\n        } \r\n        return scrollTop; \r\n}\r\nfunction hideRightClickMenu(){\r\n	if(jQuery(\"#modeTitle\",_menuWindow.parent._menuDocument).length>0){\r\n		jQuery(\"#modeTitle\",_menuWindow.parent._menuDocument).parent().css(\"display\",\"none\");\r\n	}			\r\n	".toCharArray();
    _jsp_string265 = ">\r\n        <input type=hidden name=\"requestname\" value=".toCharArray();
    _jsp_string155 = "; //\u662f\u5426IE\u6d4f\u89c8\u5668\r\n	if (isIE) {\r\n		var swf = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');\r\n		if (swf) {\r\n			hasFlash = 1;\r\n			VSwf = swf.GetVariable(\"$version\");\r\n			flashVersion = parseInt(VSwf.split(\" \")[1].split(\",\")[0]);\r\n		}\r\n	} else {\r\n		if (navigator.plugins && navigator.plugins.length > 0) {\r\n			var swf = navigator.plugins[\"Shockwave Flash\"];\r\n			if (swf) {\r\n				hasFlash = 1;\r\n				var words = swf.description.split(\" \");\r\n				for ( var i = 0; i < words.length; ++i) {\r\n					if (isNaN(parseInt(words[i])))\r\n						continue;\r\n					flashVersion = parseInt(words[i]);\r\n				}\r\n			}\r\n		}\r\n	}\r\n	return {\r\n		f :hasFlash,\r\n		v :flashVersion\r\n	};\r\n}\r\nvar fls = flashChecker();\r\nvar flashversion = 0;\r\nif (fls.f) {\r\n	flashversion = fls.v;\r\n}\r\nif (flashversion < 9){\r\n	//alert(\"".toCharArray();
    _jsp_string23 = "\";\r\n					diag.show();\r\n			        return false;\r\n	    		}\r\n	    		else if(response_flag=='2') {\r\n	    			flag_msg = '".toCharArray();
    _jsp_string104 = "\",\r\n        	mouldID:\"".toCharArray();
    _jsp_string347 = "\r\n						<a href=\"javaScript:openhrm(".toCharArray();
    _jsp_string280 = "</textarea>\r\n\r\n<div style=\"position: absolute; left: 0; top: 0; width:100%;height:100%;\">\r\n<span id=\"replaceAcc\" style=\"display:inline-block;height:21px;padding-left:0!important;padding-right:0!important;position:absolute;z-index:99;\"></span>\r\n<div id=\"divContentTab\" style=\"width:100%;height:100%;\">\r\n       <table id=\"topTitle\" cellpadding=\"0\" cellspacing=\"0\">\r\n			<tr>\r\n				<td>\r\n				</td>\r\n				<td class=\"rightSearchSpan\" style=\"text-align:right;\">\r\n				".toCharArray();
    _jsp_string69 = "\r\n\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string485 = "\"+\"&canDownload=".toCharArray();
    _jsp_string461 = "\";\r\n		}\r\n		if(tab==\"divViewLog\"&&has_logListIfrm==0){\r\n			has_logListIfrm=1;\r\n			document.getElementById(\"logListIfrm\").src=\"".toCharArray();
    _jsp_string490 = "\r\n    	try{\r\n        jQuery('#rightMenu').remove();\r\n        jQuery(\"body\",window.parent.parent.frames[\"workflowtext\"].document).mouseenter(function(){\r\n            window.parent.parent.document.getElementById('rightMenu').style.visibility=\"hidden\";\r\n            window.parent.parent.document.getElementById('rightMenu').style.display=\"none\";\r\n        });\r\n    	}catch(e){}\r\n    ".toCharArray();
    _jsp_string327 = "\r\n	</div>\r\n	<div class=\"e8_box demo2\">\r\n    	<div class=\"e8_boxhead\" style=\"".toCharArray();
    _jsp_string125 = "\r\n\r\n</head>\r\n\r\n<body class=\"ext-ie ext-ie8 x-border-layout-ct\" scroll=\"no\" onunload=\"UnLoad()\" oncontextmenu=\"doNothing()\">    \r\n".toCharArray();
    _jsp_string405 = "</SPAN></SPAN>\r\n		</EM>\r\n		</A>\r\n		</LI>\r\n		\r\n		<LI id=divAccATab class=\" \"  onclick=\"onActiveTab('divAcc');\">\r\n		<A class=x-tab-strip-close onclick=\"return false;\"></A>\r\n		<A class=x-tab-right onclick=\"return false;\" href=\"#\">\r\n		<EM class=x-tab-left>\r\n		<SPAN class=x-tab-strip-inner><SPAN class=\"x-tab-strip-text \" id=\"divAccATabTitle\"><script type=\"text/javascript\">document.write(wmsg.doc.acc + '(".toCharArray();
    _jsp_string351 = "</a>\r\n					".toCharArray();
    _jsp_string266 = ">\r\n        <input type=hidden name=\"manager\" value=".toCharArray();
    _jsp_string196 = "\r\n	_menuDocument.getElementById(\"rightMenu\").className = \"clickRightMenu\";\r\n	".toCharArray();
    _jsp_string53 = "\r\n".toCharArray();
    _jsp_string423 = "\";	\r\n	var parentids=\"".toCharArray();
    _jsp_string10 = "\r\n<script language=\"javascript\" type=\"text/javascript\" src=\"/FCKEditor/swfobject_wev8.js\"></script>\r\n\r\n".toCharArray();
    _jsp_string420 = "\r\n	var isFromWfSN = ".toCharArray();
    _jsp_string260 = "\r\n        <input type=hidden name=\"isremark\" >\r\n        <input type=hidden name=\"nodeid\" value=".toCharArray();
    _jsp_string156 = "!\");\r\n}\r\n\r\n</script>\r\n\r\n<div id=\"divStatus\" style=\"display:none\"></div>\r\n<div id=\"warn\">\r\n	<table width=\"100%\" height=\"100%\"><tr><td align=\"right\" style=\"width:110px;\"><img style=\"vertical-align:middle;\" src='/images/ecology8/addWorkflow_wev8.png'></img></td><td align=\"left\"><label style=\"margin-left: 5px;font-size:12px;\">".toCharArray();
    _jsp_string419 = ";\r\n	var isFromWfTH = ".toCharArray();
    _jsp_string153 = "\";\r\n					//parent.location.href=\"/docs/docs/DocDsp.jsp?isFromAccessory=true&id=\"+_docid+\"&versionId=\"+_versionid+\"&imagefileId=\"+_imagefileid;	\r\n				}\r\n				\r\n			},				\r\n			upload_complete_handler : function(file){\r\n			  try {\r\n					if (this.getStats().files_queued === 0) {\r\n						jQuery(\"#fsUploadProgress_\"+indexid).html(\"\"); //\u6e05\u7a7a\u4e0a\u4f20\u8fdb\u5ea6\u6761 \r\n					} 	\r\n				} catch (ex) { alert(ex); }\r\n			}\r\n		};\r\n		oUploader = new SWFUpload(settings);\r\n	} catch(e){alert(e)}\r\n	return oUploader;\r\n}\r\n\r\n".toCharArray();
    _jsp_string470 = "\r\n		document.getElementById(\"divViewLog\").style.display='none';\r\n		".toCharArray();
    _jsp_string49 = "\r\n\r\n<!--WUI -->\r\n".toCharArray();
    _jsp_string397 = "\r\n			\r\n		".toCharArray();
    _jsp_string285 = "\"></input>\r\n    					".toCharArray();
    _jsp_string205 = "\r\n		<script type=\"text/javascript\">\r\n\r\n			jQuery(\"#divTopMenu\").hide();\r\n			jQuery(\"#rightMenu\",_menuDocument).hide();\r\n		\r\n		</script>\r\n		".toCharArray();
    _jsp_string182 = "hidden".toCharArray();
    _jsp_string140 = "\"==\".xlsx\"){\r\n		file_types=\"*.xls;*.xlsx\";		\r\n	} else if(\"".toCharArray();
    _jsp_string137 = "\"==\".doc\"||\"".toCharArray();
    _jsp_string253 = "\">\r\n	\r\n    <input type=hidden id=topage name=topage value='".toCharArray();
    _jsp_string40 = "\";\r\n   if(!confirm(str)){\r\n       return false;\r\n   }\r\n       return true;\r\n } \r\n\r\nfunction issubmit(){\r\n	var str = \"".toCharArray();
    _jsp_string277 = "\">\r\n	<input type=\"hidden\" name=\"docmodule\" value=\"".toCharArray();
    _jsp_string430 = "\";\r\n	var meetingid=\"".toCharArray();
    _jsp_string78 = "\r\n		    <script language=javascript>\r\n				location=\"/docs/pdfview/web/sysRemind.jsp\";	\r\n		    </script> \r\n".toCharArray();
    _jsp_string439 = "\";\r\n	var relationable=false;\r\n	var pagename=\"docdspext\";	\r\n	var requestid=\"".toCharArray();
    _jsp_string371 = "\" style=\"POSITION:absolute;width:0;height:0;".toCharArray();
    _jsp_string134 = "\" method=\"post\">\r\n<!--\u8be5\u53c2\u6570\u5fc5\u987b\u4f5c\u4e3aForm\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570,\u5e76\u4e14\u4e0d\u80fd\u5728\u5176\u4ed6\u5730\u65b9\u8c03\u7528\uff0c\u7528\u4e8e\u89e3\u51b3\u5728IE6.0\u4e2d\u8f93\u5165\u00b7\u8fd9\u4e2a\u7279\u6b8a\u7b26\u53f7\u5b58\u5728\u7684\u95ee\u9898-->\r\n<INPUT TYPE=\"hidden\" id=\"docIdErrorError\" NAME=\"docIdErrorError\" value=\"\">\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string22 = "\";\r\n					//diag.InvokeElementId=\"pageOverlay\"\r\n					diag.URL = \"/wui/theme/ecology7/page/loginSmall.jsp?username=".toCharArray();
    _jsp_string390 = "\r\n			<iframe id=\"e8DocAccIfrm\" style=\"border:none;\" frameborder=\"0\" width=\"100%\" height=\"100%\"></iframe>\r\n			</DIV>\r\n		</div>\r\n		<!-- \u6587\u6863\u9644\u4ef6\u680f end -->\r\n		".toCharArray();
    _jsp_string365 = "\r\n    	</ul>\r\n	<div style=\"clear:left\"></div>\r\n	\r\n		<div id=\"rightBox\" class=\"e8_rightBox\"></div>\r\n    	</div>\r\n		</div>\r\n		</div>\r\n	    <div class=\"tab_box _synergyBox\">\r\n	        <div style=\"height:100%;\">\r\n	\r\n	<div id=\"divContent\" style=\"width:100%;overflow:hidden;\">\r\n		\r\n		<iframe id=\"e8shadowifrm\" name=\"e8shadowifrm\" frameborder=\"none\" scrolling=\"no\" style=\"".toCharArray();
    _jsp_string288 = "\r\n								<input type=button class=\"e8_btn_top\" onclick=\"javascript:onSave();\" value=\"".toCharArray();
    _jsp_string415 = "\r\n		\r\n		<LI class=x-tab-edge></LI>\r\n		<DIV class=x-clear></DIV></UL></DIV></DIV>\r\n		<DIV style=\"float:right;right:0px;position:absolute;top:3px;\" class=\"x-tab-panel-footer-noborder\">\r\n			<DIV id=divPropTileIcon class=\"x-tool x-tool-expand-south \" onclick=\"onExpandOrCollapse();\">&nbsp;</DIV>\r\n		</DIV>\r\n		<div style=\"clear:both;\"></div>\r\n	</div>\r\n	<div id=\"e8_shadow\"></div>\r\n	</div>\r\n	".toCharArray();
    _jsp_string221 = "&nbsp;:&nbsp;&nbsp;&nbsp;</span>\r\n										<span class=\"STYLE61\" id=\"result4\"></span>\r\n									</td>\r\n								</tr>\r\n								<tr>\r\n									<td style=\"WORD-WRAP: break-word;TEXT-VALIGN: left;word-break:break-all;\">\r\n										<span class=\"STYLE6\">".toCharArray();
    _jsp_string450 = ";\r\n	var message21658 = \"".toCharArray();
    _jsp_string67 = " \r\n".toCharArray();
    _jsp_string29 = "')) {\r\n				    lenck = false;\r\n				    break;\r\n			    }\r\n		    }\r\n		    if(lenck==false) return false;\r\n	    }\r\n	    catch(e) {}\r\n	    ".toCharArray();
    _jsp_string330 = "\");'>\r\n		    			<span style=\"overflow:hidden;white-space:nowrap;text-overflow:ellipsis;\">".toCharArray();
    _jsp_string87 = "&olddocid=".toCharArray();
    _jsp_string331 = "</span>\r\n		    		</a>\r\n	    		</li>\r\n    		".toCharArray();
    _jsp_string82 = "\r\n		    <script language=javascript>\r\n		        if(confirm(\"".toCharArray();
    _jsp_string129 = "\">\r\n    <input type=hidden name=docsubject value=\"".toCharArray();
    _jsp_string58 = "\r\n<meta http-equiv=\"".toCharArray();
    _jsp_string359 = "\r\n				  		<span id=\"noPraise\" style=\"line-height: 40px;margin-left: 20px;margin-right: 20px;display:none;\">".toCharArray();
    _jsp_string81 = "\";\r\n		window.close();\r\n		</script>\r\n		".toCharArray();
    _jsp_string382 = "\"></OBJECT>\r\n						</div>\r\n					</td>\r\n				</tr>\r\n			".toCharArray();
    _jsp_string148 = "',\r\n		        \"operation\":'replacefile'\r\n		    },        \r\n			upload_url: upload_url,\r\n			file_size_limit : maxsize+\" MB\",\r\n			file_types : file_types,\r\n			file_types_description : \"All Files\",\r\n			file_upload_limit : \"1\",\r\n			file_queue_limit : \"0\",\r\n			custom_settings : {\r\n		    	progressTarget : \"fsUploadProgress_\"+indexid\r\n			},\r\n			debug: false,\r\n			\r\n			button_image_url : \"\",	// Relative to the SWF file\r\n			button_placeholder_id : \"btnSelectedAcc_\"+indexid,\r\n	\r\n			button_width: 66,\r\n			button_height: button_height,\r\n			button_text : \"<span style='opacity:0;'>&nbsp;</span>\", \r\n			button_text_style : '.button { font-family: Helvetica, Arial, sans-serif; font-size: 12pt;color:#1d76a4 } .buttonSmall { font-size: 10pt; }',\r\n			button_text_top_padding: 0,\r\n			button_text_left_padding: 18,\r\n				\r\n			button_window_mode: SWFUpload.WINDOW_MODE.TRANSPARENT,\r\n			button_cursor: SWFUpload.CURSOR.HAND,\r\n			\r\n			file_queued_handler : fileQueued,\r\n			file_queue_error_handler : fileQueueError,				\r\n			file_dialog_complete_handler : function(numFilesSelected, numFilesQueued){		\r\n				if (numFilesSelected > 0) {\r\n					   try{\r\n					   		//e8showAjaxTips(\"\u6b63\u5728\u4e0a\u4f20\uff0c\u8bf7\u7a0d\u5019...\",true);\r\n							   jQuery(\"#fsUploadProgress_\"+indexid).show();\r\n							   if(jQuery(\"#replaceFileBtn\").length>0){\r\n					   				//jQuery(\"#fsUploadProgress_\"+indexid).css(\"left\",jQuery(\"#uploadDiv\").offset().left-jQuery(\"#fsUploadProgress_\"+indexid).width());\r\n					   			}\r\n							   this.startUpload();\r\n					   }catch(e){\r\n					   }		\r\n					   \r\n					   //fileDialogComplete\r\n				}\r\n			},\r\n			upload_start_handler : uploadStart,\r\n			upload_progress_handler : uploadProgress,			\r\n			upload_error_handler : uploadError,\r\n			queue_complete_handler : queueComplete,\r\n	\r\n			upload_success_handler : function (file, server_data) {\r\n				\r\n				server_data=jQuery.trim(server_data);\r\n				//alert(server_data);\r\n				var returndatas=server_data.split(\",\");\r\n				var _returnstatus=returndatas[0];\r\n				var _docid=returndatas[1];\r\n				var _isExt=returndatas[2];\r\n				var _versionid=returndatas[3];\r\n				var _imagefileid=returndatas[4];\r\n				\r\n				if(\"empty\"==_returnstatus){\r\n					return;	\r\n				}\r\n				\r\n				if(\"error\"==_returnstatus){\r\n					alert(\"".toCharArray();
    _jsp_string429 = "\";\r\n\r\n	var showType=\"view\";\r\n	var coworkid=\"".toCharArray();
    _jsp_string292 = "\r\n\r\n						".toCharArray();
    _jsp_string446 = "\r\n				jQuery(\"#WebOffice\").height(divContentHeight+87);\r\n			".toCharArray();
    _jsp_string60 = ",transition=".toCharArray();
    _jsp_string59 = "\" content=\"revealTrans(duration=".toCharArray();
    _jsp_string203 = ";\r\n    if(isEnableExtranetHelp==1){\r\n    	//operationPage = \"/formmode/apps/ktree/ktreeHelp.jsp\";\r\n    	operationPage = '".toCharArray();
    _jsp_string349 = "\" title=\"".toCharArray();
    _jsp_string489 = "\";\r\n			}\r\n		}	\r\n	}\r\n\r\nfunction doNothing(){  \r\n    window.event.returnValue=false;  \r\n    return false;\r\n}\r\n	jQuery(document).ready(\r\n		function(){\r\n\r\n    ".toCharArray();
    _jsp_string180 = "px\">\r\n</iframe>\r\n</div>\r\n".toCharArray();
    _jsp_string225 = "\">\r\n    <input type=hidden name=imagefileId value=\"".toCharArray();
    _jsp_string151 = "\";\r\n				} else {\r\n					parent.location.href=\"/docs/docs/DocDspExt.jsp?isFromAccessory=true&openFirstAss=".toCharArray();
    _jsp_string28 = "','".toCharArray();
    _jsp_string24 = "';\r\n	    		}\r\n	    		//\u4e3b\u4ece\u5e10\u6237\u7279\u6b8a\u5904\u7406 by alan for TD10156\r\n	    		if(response_flag=='3') {\r\n	    			flag_msg = '".toCharArray();
    _jsp_string224 = "\">\r\n    <input type=hidden name=docid value=\"".toCharArray();
    _jsp_string189 = "\r\n\r\n\r\nfunction showRightClickMenuByHand(_left,_top){\r\n	if(__isParentPage){\r\n		_top += 60;\r\n		_top -= jQuery(document).scrollTop();\r\n	}\r\n	jQuery(\"#rightMenu\",_menuDocument).css(\"left\", _left);\r\n	jQuery(\"#rightMenu\",_menuDocument).css(\"top\", _top);\r\n	jQuery(\"#rightMenu\",_menuDocument).css(\"visibility\", \"visible\");\r\n	jQuery(\"#rightMenu\",_menuDocument).show();	\r\n}\r\n\r\nvar focus_e;\r\nfunction showRightClickMenu(e){\r\n		".toCharArray();
    _jsp_string187 = "\r\n</script>\r\n<script language=\"JavaScript\" defer>\r\nonSetRightMenu();\r\n\r\n//alert(_menuDocument.body.onload);\r\n//alert(_menuWindow.onload);\r\n\r\nfunction onSetRightMenu(){\r\n	var objRightMenuDiv = _menuDocument.getElementById(\"rightMenu\");\r\n	var objMenuDiv = _menuDocument.getElementById(\"divTopMenu\");\r\n	var objhasTopTitleExtInput = _menuDocument.getElementById(\"hasTopTitleExtInput\");\r\n	var toolbarmenudiv = parent._menuDocument.getElementById(\"toolbarmenudiv\");\r\n	if(needShow==true && objMenuDiv==null && objhasTopTitleExtInput==null&&toolbarmenudiv!=null){\r\n		jQuery(objRightMenuDiv).hide();\r\n		objRightMenuDiv.style.visibility = \"hidden\";\r\n		objRightMenuDiv.style.position = \"absolute\";\r\n		//objRightMenuDiv.style.height = \"".toCharArray();
    _jsp_string458 = "\";\r\n		}\r\n		if(tab==\"divReplay\"&&has_replyInfoIfrm==0){\r\n			has_replyInfoIfrm=1;\r\n			document.getElementById(\"replyInfoIfrm\").src=\"".toCharArray();
    _jsp_string217 = "&nbsp;:&nbsp;&nbsp;&nbsp;</span>\r\n										<span class=\"STYLE61\" id=\"result10\"></span>\r\n									</td>\r\n								</tr>\r\n								<tr>\r\n									<td style=\"WORD-WRAP: break-word;TEXT-VALIGN: left;word-break:break-all;\">\r\n										<span class=\"STYLE6\">".toCharArray();
    _jsp_string248 = "\">\r\n	<input type=hidden id=doccreaterid name=doccreaterid value=\"".toCharArray();
    _jsp_string406 = ")');</script></SPAN></SPAN>\r\n		</EM>\r\n		</A>\r\n		</LI>\r\n		\r\n		".toCharArray();
    _jsp_string162 = "\r\n<input type=\"hidden\" id=\"needShow\" name=\"needShow\" value=\"".toCharArray();
    _jsp_string66 = "\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string408 = ")');</script></SPAN></SPAN>\r\n		</EM>\r\n		</A>\r\n		</LI>\r\n		".toCharArray();
    _jsp_string39 = "\");\r\n						}\r\n						return false;\r\n					}\r\n				}\r\n			}\r\n		}\r\n	}\r\n	return true;\r\n}\r\n\r\nfunction isdel(){\r\n	var str = \"".toCharArray();
    _jsp_string308 = "\" onclick=\"useTempletCancel()\" value=\"".toCharArray();
    _jsp_string333 = "\r\n    		<li>\r\n    		<div style=\"float: left;\"><span>".toCharArray();
    _jsp_string424 = "\";\r\n	var docTitle=\"".toCharArray();
    _jsp_string409 = "\r\n		\r\n		<LI id=divShareATab class=\" \"  onclick=\"onActiveTab('divShare');\">\r\n		<A class=x-tab-strip-close onclick=\"return false;\"></A>\r\n		<A class=x-tab-right onclick=\"return false;\" href=\"#\">\r\n		<EM class=x-tab-left>\r\n		<SPAN class=x-tab-strip-inner><SPAN class=\"x-tab-strip-text \"><script type=\"text/javascript\">document.write(wmsg.doc.share);</script></SPAN></SPAN>\r\n		</EM>\r\n		</A>\r\n		</LI>\r\n		".toCharArray();
    _jsp_string247 = "\">\r\n	<input type=hidden id=financeid name=financeid value=\"".toCharArray();
    _jsp_string195 = ";\r\n	".toCharArray();
    _jsp_string463 = "\";\r\n		}\r\n		if(tab==\"divMark\"&&has_markListIfrm==0){\r\n			has_markListIfrm=1;\r\n			document.getElementById(\"markListIfrm\").src=\"".toCharArray();
    _jsp_string388 = "\r\n					</td>\r\n				</tr>\r\n\r\n			</table>\r\n		</div>\r\n		\r\n		<!-- \u6587\u6863\u5c5e\u6027\u680f start -->\r\n		<div id=\"divProp\" class=\"e8_propTab\" style=\"display:none;width:100%;height:100%;\">\r\n			<DIV style=\"width:100%; height:100%; overflow: visible\" class=\"x-panel-body x-panel-body-noheader x-panel-body-noborder\">\r\n				".toCharArray();
    _jsp_string276 = "\">\r\n	<input type=\"hidden\" name=\"invalidationdate\" value=\"".toCharArray();
    _jsp_string107 = "\";\r\n		 if(canReply) {\r\n			  if(isUseNewReply){\r\n			  	 	var isPraise = \"".toCharArray();
    _jsp_string403 = "\r\n	<div style=\"position:relative;\">\r\n	<div class=\"e8_weavertab\" id=\"divTab\" style=\"width:100%;position:relative;\">\r\n\r\n		<DIV style=\"WIDTH: 100%;\" class=\"x-tab-panel-footer x-tab-panel-footer-noborder\">\r\n		<DIV class=x-tab-strip-spacer></DIV>\r\n		<DIV class=x-tab-strip-wrap>\r\n		<UL class=\"x-tab-strip x-tab-strip-bottom\">\r\n		\r\n		<LI id=divContentInfoATab class=\"e8_weavertab_li x-tab-strip-active\" onclick=\"onActiveTab('divContentInfo');\">\r\n		<A class=x-tab-strip-close onclick=\"return false;\"></A>\r\n		<A class=x-tab-right onclick=\"return false;\" href=\"#\">\r\n		<EM class=x-tab-left>\r\n		<SPAN class=x-tab-strip-inner><SPAN class=\"x-tab-strip-text \">".toCharArray();
    _jsp_string193 = "\r\n}\r\n\r\nvar isIEBrowser =\"".toCharArray();
    _jsp_string398 = "\r\n		<!-- \u6587\u6863\u6253\u5206\u680f start -->\r\n		<div id=\"divMark\" class=\"e8_propTab\" style=\"display:none;width:100%;height:100%;\">\r\n			<DIV style=\"width:100%; height:100%; overflow: visible;border:none;\" class=\"x-tab-panel-body x-tab-panel-body-noheader x-tab-panel-body-noborder x-tab-panel-body-bottom\">\r\n			<iframe id=\"markListIfrm\" style=\"border:none;\" frameborder=\"0\" width=\"100%\" height=\"100%\"></iframe>\r\n			</DIV>\r\n		</div>\r\n		<!-- \u6587\u6863\u6253\u5206\u680f end -->\r\n		".toCharArray();
    _jsp_string2 = "\r\n\r\n".toCharArray();
    _jsp_string477 = "\r\n		document.getElementById(\"divMarkATab\").className = \"\";\r\n		".toCharArray();
    _jsp_string164 = "\";\r\n	var bodyWidth = _menuWindow._menuDocument.body.offsetWidth;\r\n	var menuCountLine = bodyWidth/".toCharArray();
    _jsp_string451 = "\";\r\n	var message21700 = \"".toCharArray();
  }
}
